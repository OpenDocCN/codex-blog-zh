<html>
<head>
<title>SMS and Email sending in python Using AWS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用AWS在python中发送短信和电子邮件</h1>
<blockquote>原文：<a href="https://medium.com/codex/sms-and-email-sending-in-python-using-aws-a81df27fc210?source=collection_archive---------1-----------------------#2021-03-16">https://medium.com/codex/sms-and-email-sending-in-python-using-aws-a81df27fc210?source=collection_archive---------1-----------------------#2021-03-16</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/ba7be0b9316738b90c64504c1421883c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*7ehEa3P2h6sZtGIW.jpg"/></div></div></figure><p id="b759" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">有时，您希望在python应用程序触发某个动作或事件时发送短信和电子邮件。在正常情况下，我们可以使用带有python <code class="du jo jp jq jr b"><a class="ae js" href="https://docs.python.org/3/library/smtplib.html" rel="noopener ugc nofollow" target="_blank">smtplib</a> </code>模块的Gmail帐户发送电子邮件，但它有每天发送电子邮件的限制。有许多服务可以让你有计划地发送短信和电子邮件。其中比较流行的是<a class="ae js" href="https://www.twilio.com/" rel="noopener ugc nofollow" target="_blank"> Twilio </a>，他们有一个很棒的API和一个很容易使用的python客户端。</p><p id="080f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">另一种选择是使用亚马逊的<a class="ae js" href="https://aws.amazon.com/sns/" rel="noopener ugc nofollow" target="_blank">简单通知服务</a> (SNS)和<a class="ae js" href="http://aws.amazon.com/ses/" rel="noopener ugc nofollow" target="_blank">简单邮件服务</a> (SES)分别发送短信和邮件。你也可以使用社交网站发送电子邮件，但社交网站的工作方式类似于你订阅的邮件群，以便接收与用户相关的内容。</p><h2 id="170b" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jb ke kf kg jf kh ki kj jj kk kl km kn bi translated">先决条件</h2><p id="228c" class="pw-post-body-paragraph iq ir hi is b it ko iv iw ix kp iz ja jb kq jd je jf kr jh ji jj ks jl jm jn hb bi translated">首要要求是一个AWS帐户和一个经过验证的电子邮件地址来发送电子邮件。还要从amazon帐户下载AWS访问密钥和秘密密钥，以便对交易进行身份验证。</p><p id="cc68" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">第二部分是亚马逊的python SDK<a class="ae js" href="https://aws.amazon.com/sdk-for-python/" rel="noopener ugc nofollow" target="_blank">boto 3</a>，它有助于将您的Python应用程序、库或脚本与AWS服务集成，包括亚马逊S3、亚马逊EC2、亚马逊DynamoDB等等。</p><pre class="kt ku kv kw fd kx jr ky kz aw la bi"><span id="b658" class="jt ju hi jr b fi lb lc l ld le">pip install boto3</span></pre><p id="82ad" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">发送短信</strong></p><pre class="kt ku kv kw fd kx jr ky kz aw la bi"><span id="1677" class="jt ju hi jr b fi lb lc l ld le">import boto3<br/># Create an SNS client<br/>client = boto3.client(<br/>    "sns",<br/>    aws_access_key_id="YOUR ACCES KEY",<br/>    aws_secret_access_key="YOUR SECRET KEY",<br/>    region_name="us-east-1"<br/>)<br/># Send your sms message.<br/>client.publish(<br/>    PhoneNumber="+12223334444",<br/>    Message="Hello World!"<br/>)</span></pre><p id="5c5c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">发送电子邮件</strong></p><pre class="kt ku kv kw fd kx jr ky kz aw la bi"><span id="66e9" class="jt ju hi jr b fi lb lc l ld le">email_ses_client = boto3.client(<br/>            "ses",<br/>            aws_access_key_id="YOUR ACCES KEY",<br/>            aws_secret_access_key="YOUR SECRET KEY",<br/>           region_name="us-east-1"<br/>           )<br/># The email body for recipients with non-HTML email clients.<br/>email_body_text = "email body text here"</span><span id="b773" class="jt ju hi jr b fi lf lc l ld le"># The HTML body of the email.<br/>email_body_html = "email html contents"<br/>            </span><span id="11bd" class="jt ju hi jr b fi lf lc l ld le"># The character encoding for the email.<br/>email_charset = "UTF-8"<br/>email_msg = MIMEMultipart('mixed')<br/># Add subject, from and to lines.<br/>email_msg['Subject'] = "subject"<br/>email_msg['From'] = "AWS verified sender email id"<br/>email_msg['To'] = ', '.join(email to list)<br/>email_msg['Cc'] = ', '.join(email Cc list)<br/>email_msg['Bcc'] = ', '.join(email bcc list)</span><span id="103e" class="jt ju hi jr b fi lf lc l ld le">email_msg_body = MIMEMultipart('alternative')<br/>textpart = MIMEText(email_body_text.encode(email_charset), 'plain', email_charset)<br/>htmlpart = MIMEText(email_body_html.encode(email_charset), 'html', email_charset)<br/># Add the text and HTML parts to the child container.<br/>email_msg_body.attach(textpart)<br/>email_msg_body.attach(htmlpart)</span><span id="620f" class="jt ju hi jr b fi lf lc l ld le"># Attach the multipart/alternative child container to the multipart/mixed<br/># parent container.<br/>email_msg.attach(email_msg_body)</span><span id="0024" class="jt ju hi jr b fi lf lc l ld le">if not os.path.exists(Attachment file):<br/>     print("Attachment file does not exists")<br/> else:<br/>     # Define the attachment part and encode it using<br/>     MIMEApplication.email_attachment = IMEApplication(open(Attachment file path, 'rb').read())   <br/>     file_name = Path(Attachment file path).name<br/>                email_attachment.add_header('Content-Disposition',          'attachment', filename=file_name)<br/>     # Add the attachment to the parent container.<br/>     email_msg.attach(email_attachment)</span><span id="f87d" class="jt ju hi jr b fi lf lc l ld le">try:<br/>    # Provide the contents of the email.<br/>    response = email_ses_client.send_raw_email(<br/>                    Source=email_msg['From'],<br/>                    Destinations= email to list + emaom cc list + email bcc list,<br/>                    RawMessage={<br/>                        'Data': email_msg.as_string(),<br/>                    }<br/>                )<br/>            # Display an error if something goes wrong.<br/>            except ClientError as e:<br/>                print(e.response['Error']['Message'])<br/>            except EndpointConnectionError as exp:<br/>                print(exp)<br/>            except ConnectionError as exp:<br/>                print(exp)<br/>            except:<br/>                print("Unknown Exception(AWS SES) while sending Email")<br/>            else:<br/>                print(response['MessageId'])</span></pre><p id="c3b5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您需要将AWS SES帐户移出沙盒，以便发送电子邮件而无需验证。所有新的AWS SES帐户首先在一个测试环境(沙箱)下，所以你只能发送电子邮件<strong class="is hj">到</strong>验证的电子邮件地址和域，并且在24小时内最多可以发送200条消息。</p></div></div>    
</body>
</html>