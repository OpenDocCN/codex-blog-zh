<html>
<head>
<title>How to Combine Audio in Swift and Programmatically Get Music From iTunes/Music Library on Mac</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">å¦‚ä½•åœ¨Swiftä¸­ç»„åˆéŸ³é¢‘ï¼Œå¹¶ä»¥ç¼–ç¨‹æ–¹å¼ä»Macä¸Šçš„iTunes/éŸ³ä¹åº“è·å–éŸ³ä¹</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/codex/how-to-combine-audio-in-swift-and-programmatically-get-music-from-itunes-music-library-on-mac-6c1df23fa679?source=collection_archive---------25-----------------------#2022-10-28">https://medium.com/codex/how-to-combine-audio-in-swift-and-programmatically-get-music-from-itunes-music-library-on-mac-6c1df23fa679?source=collection_archive---------25-----------------------#2022-10-28</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="5847" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ä¸Swiftä¸­çš„å¤§å¤šæ•°ä¸œè¥¿ä¸åŒï¼Œåˆå¹¶éŸ³è½¨æ˜¯ä¸€ä¸ªç›¸å½“å¤æ‚çš„è¿‡ç¨‹ã€‚</p><p id="794b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ä¸€ä¸ªå¾ˆå¥½çš„èµ·ç‚¹æ˜¯é˜…è¯»Greg Cervenyå…³äºè¿™ä¸ªè¯é¢˜çš„æ–‡ç« ã€‚ç„¶è€Œï¼Œåœ¨è¿™ç¯‡çŸ­æ–‡ä¸­ï¼Œæˆ‘æƒ³è¯´æ˜æˆ‘æ˜¯å¦‚ä½•åšåˆ°çš„ï¼Œå¹¶ä»æˆ‘çš„Macä¸Šåˆå¹¶MP3æ’­æ”¾åˆ—è¡¨ã€‚<a class="ae jd" href="https://github.com/carlosmbe/Mac-iTunes-Music-Playlist-Exporter" rel="noopener ugc nofollow" target="_blank">è¿™æ˜¯å®Œæ•´çš„é¡¹ç›®</a>ã€‚</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/58b5470e19eb5fe1cb03a4c74da11371.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*541t2qmakKA0F7Atxudv-A.jpeg"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">ç…§ç‰‡ç”±<a class="ae jd" href="https://unsplash.com/@schluditsch?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">ä¸¹å°¼å°”Â·æ–½é²è¿ª</a>åœ¨<a class="ae jd" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>æ‹æ‘„</figcaption></figure><h2 id="fe13" class="ju jv hi bd jw jx jy jz ka kb kc kd ke iq kf kg kh iu ki kj kk iy kl km kn ko bi translated">ç»„åˆéŸ³é¢‘</h2><p id="78d8" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">é¦–å…ˆï¼Œåœ¨å¤„ç†åª’ä½“æ—¶ï¼Œæˆ‘ä»¬ä¼šæƒ³è¦å¯¼å…¥<a class="ae jd" href="https://developer.apple.com/av-foundation/" rel="noopener ugc nofollow" target="_blank"> AVFoundation </a>ã€‚</p><pre class="jf jg jh ji fd ku kv kw bn kx ky bi"><span id="7336" class="kz jv hi kv b be la lb l lc ld">import AVFoundation</span></pre><p id="13b2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">å…¶æ¬¡ï¼ŒåŸºäºGregçš„ä»£ç ï¼Œæˆ‘ä»¬å°†ä¸º<strong class="ih hj">AVMutableCompositionTrack</strong>ç¼–å†™ä¸€ä¸ªæ‰©å±•ï¼Œç®€åŒ–é™„åŠ éŸ³è½¨ã€‚</p><pre class="jf jg jh ji fd ku kv kw bn kx ky bi"><span id="af59" class="kz jv hi kv b be la lb l lc ld">extension AVMutableCompositionTrack {<br/>  func append(url: URL) {<br/>    let newAsset = AVURLAsset(url: url)<br/>    let range = CMTimeRangeMake(start: CMTime.zero, duration: newAsset.duration)<br/>    let end = timeRange.end<br/>      if let track = newAsset.tracks(withMediaType: AVMediaType.audio).first {<br/>      try! insertTimeRange(range, of: track, at: end)<br/>       }  else{<br/>print("ERROR - Appending")<br/>       }<br/>    }<br/>}</span></pre><p id="ef69" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ç°åœ¨å®Œæˆäº†ã€‚æˆ‘ä»¬éœ€è¦ç¼–å†™ä¸€ä¸ªå‡½æ•°æ¥è·å–éŸ³é¢‘æ–‡ä»¶å¹¶å¯¼å‡ºå®ƒä»¬ã€‚å‡è®¾æ‚¨å·²ç»æœ‰äº†è¦ç»„åˆçš„æ­Œæ›²çš„URLåˆ—è¡¨ï¼Œä»£ç åº”è¯¥å¦‚ä¸‹æ‰€ç¤ºã€‚</p><pre class="jf jg jh ji fd ku kv kw bn kx ky bi"><span id="f719" class="kz jv hi kv b be la lb l lc ld">var arrayOfSongPaths = [URL?]()<br/><br/>func combineSongs(){    <br/>    let composition = AVMutableComposition()<br/>    let compositionAudioTrack = composition.addMutableTrack(withMediaType: AVMediaType.audio, preferredTrackID: kCMPersistentTrackID_Invalid)<br/>    <br/>    for path in arrayOfSongPaths{<br/>        compositionAudioTrack!.append(url: path!)<br/>    }<br/>    <br/>    //Built the path like this but you can use any path you want. Just remember to handle permissions.<br/>    let documentDirectoryURL = FileManager.default.urls(for: .documentDirectory, in: .userDomainMask).first! as NSURL<br/>    let destinationURL = documentDirectoryURL.appendingPathComponent(" resultMerge.m4a")! as URL<br/>    <br/>    if let assetExport = AVAssetExportSession(asset: composition, presetName: AVAssetExportPresetAppleM4A) {<br/>      assetExport.outputFileType = AVFileType.m4a<br/>        assetExport.outputURL = destinationURL<br/>        <br/>        assetExport.exportAsynchronously( completionHandler:    {<br/>            //You don't NEED to write these switch cases but they strongly help to debug<br/>            switch assetExport.status {<br/>                <br/>            case AVAssetExportSession.Status.failed:<br/>                print("failed \(assetExport.error)")<br/>            case AVAssetExportSession.Status.cancelled:<br/>                print("cancelled \(assetExport.error)")<br/>            case AVAssetExportSession.Status.unknown:<br/>                print("unknown\(assetExport.error)")<br/>            case AVAssetExportSession.Status.waiting:<br/>                print("waiting\(assetExport.error)")<br/>            case AVAssetExportSession.Status.exporting:<br/>                print("exporting\(assetExport.error)")<br/>                <br/>            default:<br/>                print("COMPLETED YAY!!!")<br/>                NSWorkspace.shared.open(documentDirectoryURL as URL)<br/>            }<br/>            <br/>        })<br/>    }//asset export end<br/>    <br/>}</span></pre><p id="0167" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æ­å–œä½ ã€‚å¦‚æœä¸€åˆ‡éƒ½ç¼–è¯‘å’Œè¿è¡Œï¼ŒFinderåº”è¯¥ä¼šæ‰“å¼€ï¼Œå‘æ‚¨æ˜¾ç¤ºä¸€ä¸ªm4aï¼Œå…¶ä¸­åŒ…å«æ‰€æœ‰éŸ³é¢‘æ–‡ä»¶ã€‚</p><h1 id="d25f" class="le jv hi bd jw lf lg lh ka li lj lk ke ll lm ln kh lo lp lq kk lr ls lt kn lu bi translated">ä»MacéŸ³ä¹åº“è·å–æœ¬åœ°éŸ³ä¹</h1><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lv"><img src="../Images/c68e7a0ebdca5ebcf1a118fd383f67bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q1iqDCp7XeOykGOoSDQ_og.jpeg"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated"><a class="ae jd" href="https://unsplash.com/@wesson?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">å¨æ£®ç‹</a>åœ¨<a class="ae jd" href="https://unsplash.com/s/photos/mac?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>ä¸Šçš„ç…§ç‰‡</figcaption></figure><p id="f4a1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">å¦‚æœæ‚¨æƒ³å°†iTunes/Musicä¸­çš„æ’­æ”¾åˆ—è¡¨ç¼–è¾‘æˆä¸€ä¸ªéŸ³é¢‘æ–‡ä»¶ã€‚è¿™éƒ¨åˆ†æ˜¯ç»™ä½ çš„ã€‚</p><p id="4fdc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">é¦–å…ˆï¼Œå¯¼å…¥iTunesLibraryã€‚</p><pre class="jf jg jh ji fd ku kv kw bn kx ky bi"><span id="26a3" class="kz jv hi kv b be la lb l lc ld">import iTunesLibrary</span></pre><p id="788e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">å…¶æ¬¡ï¼Œæˆ‘ä»¬å¸Œæœ›è·å¾—ç”¨æˆ·åº“ä¸­çš„æ‰€æœ‰æ’­æ”¾åˆ—è¡¨ã€‚</p><pre class="jf jg jh ji fd ku kv kw bn kx ky bi"><span id="e0b5" class="kz jv hi kv b be la lb l lc ld">let library = try! ITLibrary(apiVersion: "1.1")<br/>let playlists = library.allPlaylists</span></pre><p id="18ed" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">å‡è®¾æ‚¨çŸ¥é“æƒ³è¦çš„æ’­æ”¾åˆ—è¡¨çš„åç§°ã€‚ä½ å¯ä»¥é€šè¿‡è¿™ä¸ªåŠŸèƒ½è·å¾—æ‰€æœ‰æ­Œæ›²çš„ç½‘å€ã€‚</p><pre class="jf jg jh ji fd ku kv kw bn kx ky bi"><span id="26b3" class="kz jv hi kv b be la lb l lc ld">func getPlaylistsData(for funcPlaylistName: String?){<br/> <br/>   guard let funcPlaylistName = funcPlaylistName else{<br/>      return<br/>    }<br/>  var stuffIWant: ITLibPlaylist {<br/>    for item in playlists{<br/>      if item.name == funcPlaylistName{<br/>          return item<br/>          }<br/>        }<br/>      return playlists[0] //Just in case in the loop fails<br/>    }<br/><br/>  for song in stuffIWant.items{<br/>    arrayOfSongPaths.append(song.location)<br/>     }<br/>}</span></pre><p id="51e7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ğŸŠæ­å–œä½ ã€‚ä½ å®Œäº†ã€‚å¹²æ¯ğŸ‰</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es lw"><img src="../Images/6ebf1dfd405a097458a734cedc989bc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:322/1*Oy4O6wRApWU-q7Jm1TUw8Q.gif"/></div></figure></div></div>    
</body>
</html>