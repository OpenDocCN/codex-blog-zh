<html>
<head>
<title>Simplifying Kubernetes Deployments with Helm Package Manager</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Helm Package Manager简化Kubernetes部署</h1>
<blockquote>原文：<a href="https://medium.com/codex/simplifying-kubernetes-deployments-with-helm-package-manager-bf834c51818d?source=collection_archive---------0-----------------------#2022-09-10">https://medium.com/codex/simplifying-kubernetes-deployments-with-helm-package-manager-bf834c51818d?source=collection_archive---------0-----------------------#2022-09-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/c9899e96288ca96ee67dd960426a1b07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VK-gt4gFpRIV5s2kUlydJg.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图片来源:iStockPhoto.com</figcaption></figure><p id="8cb7" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">Kubernetes在最近几年获得了很大的发展，它已经成为业界部署容器化应用程序的事实上的标准。Kubernetes作为一个容器编排器，为您抽象了许多复杂性，但是随着应用程序的增长，Kubernetes集群上的应用程序部署和发布管理变得更加繁琐。</p><p id="67b7" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我们通常使用普通的Kubernetes清单——YAML文件来将我们的应用程序及其资源部署到Kubernetes集群。从版本控制的角度来看，我们可以将您的YAML文件保存在Git存储库中，但是没有可靠的方法来正确地对它们进行版本控制。此外，从可重用性的角度来看，使用动态配置选项生成清单文件可能是至关重要的。</p><p id="6578" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这就是赫尔姆大放异彩的地方。Helm允许您在终端中简单地执行几个命令，您就可以很好地部署Kubernetes了！</p><p id="9b87" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在本文中，我们将尝试介绍Helm的核心概念，以及Helm如何简化Kubernetes的部署和发布管理。</p><h1 id="bc2b" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">什么是头盔？</h1><h2 id="a95b" class="kq jt hi bd ju kr ks kt jy ku kv kw kc jf kx ky kg jj kz la kk jn lb lc ko ld bi translated">掌舵<a class="ae le" href="http://localhost:3002/pages/csharm33/payer-tech-leadership-academy/blog/helm#helm" rel="noopener ugc nofollow" target="_blank"> </a></h2><p id="74d6" class="pw-post-body-paragraph iu iv hi iw b ix lf iz ja jb lg jd je jf lh jh ji jj li jl jm jn lj jp jq jr hb bi translated">Helm是一个包管理器，用于Kubernetes集群上的应用程序部署和发布管理。它类似于APT、YUM、NPM和YARN package managers。它不仅是Kubernetes部署的包管理器，而且还是Kubernetes部署/发布管理工具。</p><blockquote class="lk ll lm"><p id="b87e" class="iu iv ln iw b ix iy iz ja jb jc jd je lo jg jh ji lp jk jl jm lq jo jp jq jr hb bi translated">Helm帮助您管理Kubernetes应用程序——Helm图表帮助您定义、安装和升级最复杂的Kubernetes应用程序。Helm是查找、共享和使用为Kubernetes构建的软件的最佳方式。Helm是CNCF的一个毕业项目，由Helm社区维护。来源——【https://helm.sh/ T4】</p></blockquote><h2 id="7e7d" class="kq jt hi bd ju kr ks kt jy ku kv kw kc jf kx ky kg jj kz la kk jn lb lc ko ld bi translated">Helm2架构</h2><blockquote class="lk ll lm"><p id="9c81" class="iu iv ln iw b ix iy iz ja jb jc jd je lo jg jh ji lp jk jl jm lq jo jp jq jr hb bi translated">Helm 2是一个客户端-服务器架构，客户端叫做<code class="du lr ls lt lu b">helm</code>，服务器叫做<code class="du lr ls lt lu b">Tiller</code>。客户端是一个CLI，用户可以与之交互来执行不同的操作，如安装、升级和删除。如下图所示，客户端与Tiller和图表存储库进行交互。Tiller与Kubernetes API服务器交互。它将Helm模板文件呈现到Kubernetes清单文件中，用于通过Kubernetes API对Kubernetes集群进行操作。资料来源——developer.ibm.com</p></blockquote><figure class="lw lx ly lz fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lv"><img src="../Images/652a1e54968a41775b3ca7a957286adc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*pkvS5qmE0dMIGQOP.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图片来源:developer.ibm.com</figcaption></figure><h2 id="8c9e" class="kq jt hi bd ju kr ks kt jy ku kv kw kc jf kx ky kg jj kz la kk jn lb lc ko ld bi translated">Helm3架构</h2><blockquote class="lk ll lm"><p id="61d1" class="iu iv ln iw b ix iy iz ja jb jc jd je lo jg jh ji lp jk jl jm lq jo jp jq jr hb bi translated">Helm 3有一个客户端专用的架构，客户端仍然叫做<code class="du lr ls lt lu b">helm</code>。如下图所示，它的操作类似于Helm 2客户端，但是客户端直接与Kubernetes API服务器进行交互。集群内服务器<code class="du lr ls lt lu b">Tiller</code>现已移除。资料来源——developer.ibm.com</p></blockquote><figure class="lw lx ly lz fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ma"><img src="../Images/c802cb3c775d643f9340e17966a05079.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*GVRgIaAEqGWhwzB4.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图片来源:developer.ibm.com</figcaption></figure><h1 id="eb5a" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">安装舵</h1><p id="efc7" class="pw-post-body-paragraph iu iv hi iw b ix lf iz ja jb lg jd je jf lh jh ji jj li jl jm jn lj jp jq jr hb bi translated">安装舵非常容易。请参考官方发布页面，获取适用于您特定操作系统的最新Helm版本。</p><pre class="lw lx ly lz fd mb lu mc md aw me bi"><span id="98ca" class="kq jt hi lu b fi mf mg l mh mi">https://helm.sh/docs/intro/install/<br/>https://helm.sh/docs/intro/using_helm/</span></pre><h1 id="cc70" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">掌舵图表创建、存储库和部署工作流</h1><p id="bc53" class="pw-post-body-paragraph iu iv hi iw b ix lf iz ja jb lg jd je jf lh jh ji jj li jl jm jn lj jp jq jr hb bi translated">Helm软件包管理器的主要组件…</p><h2 id="bb99" class="kq jt hi bd ju kr ks kt jy ku kv kw kc jf kx ky kg jj kz la kk jn lb lc ko ld bi translated">掌舵图<a class="ae le" href="http://localhost:3002/pages/csharm33/payer-tech-leadership-academy/blog/helm#helm-chart" rel="noopener ugc nofollow" target="_blank">T3</a></h2><p id="8925" class="pw-post-body-paragraph iu iv hi iw b ix lf iz ja jb lg jd je jf lh jh ji jj li jl jm jn lj jp jq jr hb bi translated">创建Kubernetes应用程序的一个实例需要一组信息。</p><h2 id="1756" class="kq jt hi bd ju kr ks kt jy ku kv kw kc jf kx ky kg jj kz la kk jn lb lc ko ld bi translated">配置<a class="ae le" href="http://localhost:3002/pages/csharm33/payer-tech-leadership-academy/blog/helm#config" rel="noopener ugc nofollow" target="_blank">T5】</a></h2><p id="280b" class="pw-post-body-paragraph iu iv hi iw b ix lf iz ja jb lg jd je jf lh jh ji jj li jl jm jn lj jp jq jr hb bi translated">它保存了关于配置的信息，您可以将这些信息合并到一个打包的图表中，以创建一个可发布的对象。</p><h2 id="3211" class="kq jt hi bd ju kr ks kt jy ku kv kw kc jf kx ky kg jj kz la kk jn lb lc ko ld bi translated">舵释放<a class="ae le" href="http://localhost:3002/pages/csharm33/payer-tech-leadership-academy/blog/helm#helm-release" rel="noopener ugc nofollow" target="_blank"> </a></h2><p id="b144" class="pw-post-body-paragraph iu iv hi iw b ix lf iz ja jb lg jd je jf lh jh ji jj li jl jm jn lj jp jq jr hb bi translated">使用特定配置的海图作业实例。</p><h2 id="7868" class="kq jt hi bd ju kr ks kt jy ku kv kw kc jf kx ky kg jj kz la kk jn lb lc ko ld bi translated">掌舵图库<a class="ae le" href="http://localhost:3002/pages/csharm33/payer-tech-leadership-academy/blog/helm#helm-chart-repository" rel="noopener ugc nofollow" target="_blank"> </a></h2><p id="b577" class="pw-post-body-paragraph iu iv hi iw b ix lf iz ja jb lg jd je jf lh jh ji jj li jl jm jn lj jp jq jr hb bi translated">图表存储库是存放索引的HTTP服务器。YAML文件和可选的一些打包图表。当您准备好共享图表时，首选的方法是将它们上传到图表存储库。</p><p id="2592" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">此图描述了舵图的高级工作流程…</p><figure class="lw lx ly lz fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mj"><img src="../Images/678431fe18972e8df7c7285570d6ade2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1368/format:webp/1*UXJsXoIP_5Ttc7TIPCVkiQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图片致谢—hand-on . cloud</figcaption></figure><h1 id="424f" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">舵图表<a class="ae le" href="http://localhost:3002/pages/csharm33/payer-tech-leadership-academy/blog/helm#helm-charts" rel="noopener ugc nofollow" target="_blank"> </a></h1><p id="4c3e" class="pw-post-body-paragraph iu iv hi iw b ix lf iz ja jb lg jd je jf lh jh ji jj li jl jm jn lj jp jq jr hb bi translated">安装舵后，要创建舵图，请运行以下命令…</p><pre class="lw lx ly lz fd mb lu mc md aw me bi"><span id="27f3" class="kq jt hi lu b fi mf mg l mh mi">helm create &lt;Name Of the Chart&gt;<br/>helm create EMP_HELM_CHARTS</span></pre><p id="0b9b" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">运行此命令后，您将获得以下文件夹结构…</p><ul class=""><li id="885b" class="mk ml hi iw b ix iy jb jc jf mm jj mn jn mo jr mp mq mr ms bi translated">顶层EMP_HELM_CHARTS -&gt;文件夹是舵图的名称</li><li id="7087" class="mk ml hi iw b ix mt jb mu jf mv jj mw jn mx jr mp mq mr ms bi translated">Chart.yml -&gt;图表元数据信息</li><li id="5f4f" class="mk ml hi iw b ix mt jb mu jf mv jj mw jn mx jr mp mq mr ms bi translated">价值观。YAML -&gt;模板文件的值</li><li id="ea75" class="mk ml hi iw b ix mt jb mu jf mv jj mw jn mx jr mp mq mr ms bi translated">图表-&gt;文件夹具有图表相关性</li><li id="39ae" class="mk ml hi iw b ix mt jb mu jf mv jj mw jn mx jr mp mq mr ms bi translated">模板-&gt;文件夹中有实际的模板文件(YAML文件模板创建Kubernetes资源，如pod、service等。)</li></ul><p id="d96c" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">此图描述了舵图表的文件夹结构…</p><figure class="lw lx ly lz fd ij er es paragraph-image"><div class="er es my"><img src="../Images/974521d9b6c1aee530e98f3cdd6b828c.png" data-original-src="https://miro.medium.com/v2/resize:fit:746/format:webp/1*raYj3pAq1Tm7RFThXb6yPw.png"/></div></figure><h1 id="fe54" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">舵库<a class="ae le" href="http://localhost:3002/pages/csharm33/payer-tech-leadership-academy/blog/helm#helm-repository" rel="noopener ugc nofollow" target="_blank"> </a></h1><p id="18ab" class="pw-post-body-paragraph iu iv hi iw b ix lf iz ja jb lg jd je jf lh jh ji jj li jl jm jn lj jp jq jr hb bi translated">我们可以创建您的掌舵图表或使用第三方掌舵图表，并将它们添加到掌舵回购中以供以后使用。以下命令可用于向报告添加图表、搜索图表、列表图表、更新图表和删除图表…</p><pre class="lw lx ly lz fd mb lu mc md aw me bi"><span id="968c" class="kq jt hi lu b fi mf mg l mh mi">helm repo list<br/>helm repo search &lt;repo_name&gt;<br/>helm repo add &lt;repo_name&gt; &lt;repo_url&gt;<br/>helm repo update<br/>helm repo remove &lt;repo_name&gt;</span></pre><h1 id="2377" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">升级和回滚<a class="ae le" href="http://localhost:3002/pages/csharm33/payer-tech-leadership-academy/blog/helm#upgrades-and-rollbacks" rel="noopener ugc nofollow" target="_blank"> </a></h1><p id="f782" class="pw-post-body-paragraph iu iv hi iw b ix lf iz ja jb lg jd je jf lh jh ji jj li jl jm jn lj jp jq jr hb bi translated">Helm release management使用以下命令帮助部署、升级和回滚部署:</p><pre class="lw lx ly lz fd mb lu mc md aw me bi"><span id="84ce" class="kq jt hi lu b fi mf mg l mh mi">Helm install &lt;chartname&gt; -f PATH_TO_values.yaml<br/>Helm upgrade &lt;chartname&gt; -f PATH_TO_values.yaml<br/>Helm rollback &lt;chartname&gt;  [REVISION]</span></pre><p id="cc09" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">Helm <code class="du lr ls lt lu b">install</code>命令将使用动态YAML模板文件和1号Helm版本创建Kubernetes资源，同时创建Kubernetes资源。</p><p id="33eb" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">而<code class="du lr ls lt lu b">upgrade</code>和<code class="du lr ls lt lu b">rollback</code>命令将添加/更新/删除Kubernetes资源并创建后续的helm版本。</p><figure class="lw lx ly lz fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mz"><img src="../Images/84b3e50708549457d095a5e4173302a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kGNPR4JjQ-HxT_kXewwqHw.png"/></div></div></figure><p id="ddd8" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">更改将应用于现有部署，而不是创建新的部署并处理回滚到以前版本的操作。</p><p id="8416" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">通过使用定制的<code class="du lr ls lt lu b">values.yaml</code>，相同的掌舵图可以用于跨不同环境的Kubernetes应用程序部署。</p><p id="490c" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><code class="du lr ls lt lu b">values.yaml</code>会因各自的环境而不同。</p><figure class="lw lx ly lz fd ij er es paragraph-image"><div class="er es na"><img src="../Images/ab4727a8cc6798de81bbf013ab2f5d98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/format:webp/1*q20mqMSlyoCp5tcJ3EpS5w.png"/></div></figure><h1 id="e7a8" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">清理资源<a class="ae le" href="http://localhost:3002/pages/csharm33/payer-tech-leadership-academy/blog/helm#cleanup-resources" rel="noopener ugc nofollow" target="_blank"> </a></h1><p id="fdcf" class="pw-post-body-paragraph iu iv hi iw b ix lf iz ja jb lg jd je jf lh jh ji jj li jl jm jn lj jp jq jr hb bi translated">头盔版本包括其生命周期中的<code class="du lr ls lt lu b">delete</code>状态。当你删除一个舵图表，它会删除所有与舵释放相关的资源。</p><pre class="lw lx ly lz fd mb lu mc md aw me bi"><span id="704d" class="kq jt hi lu b fi mf mg l mh mi">helm delete my-helm-release</span></pre><h1 id="443a" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">结论<a class="ae le" href="http://localhost:3002/pages/csharm33/payer-tech-leadership-academy/blog/helm#conclusion" rel="noopener ugc nofollow" target="_blank"> </a></h1><p id="f368" class="pw-post-body-paragraph iu iv hi iw b ix lf iz ja jb lg jd je jf lh jh ji jj li jl jm jn lj jp jq jr hb bi translated">在本文中，我们介绍了Helm如何简化Kubernetes的部署和发布管理。</p><p id="d4ac" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">Helm帮助我们从Kubernetes清单文件中抽象出配置，并使其更加定制化。使用舵图表，可以毫不费力地建立许多堆栈，如詹金斯，普罗米修斯，格拉夫纳等。与通过Kubernetes YAML文件进行的手动部署相比。</p><p id="04ff" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">总的来说，当谈到让Kubernetes部署无缝和快速时，Helm charts肯定会有所帮助。话虽如此，还有一些其他的Kubernetes软件包管理器，如kustomize、kapitan、skallfold等..同样好。</p><h2 id="1302" class="kq jt hi bd ju kr ks kt jy ku kv kw kc jf kx ky kg jj kz la kk jn lb lc ko ld bi translated">这里有一个回购样本来试用Helm… <code class="du lr ls lt lu b"><a class="ae le" href="https://github.com/chanderkant7/employee-apis-helm.git" rel="noopener ugc nofollow" target="_blank">GitHub Repo</a></code></h2><p id="0be6" class="pw-post-body-paragraph iu iv hi iw b ix lf iz ja jb lg jd je jf lh jh ji jj li jl jm jn lj jp jq jr hb bi translated">使用本报告的说明…</p><figure class="lw lx ly lz fd ij"><div class="bz dy l di"><div class="nb nc l"/></div></figure><p id="ad6f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">感谢您的阅读！</strong></p></div></div>    
</body>
</html>