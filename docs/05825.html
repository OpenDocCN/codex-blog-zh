<html>
<head>
<title>End-to-end testing with Cypress, Testing Library</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Cypress进行端到端测试，测试库</h1>
<blockquote>原文：<a href="https://medium.com/codex/end-to-end-testing-with-cypress-testing-library-80339f104957?source=collection_archive---------11-----------------------#2022-03-30">https://medium.com/codex/end-to-end-testing-with-cypress-testing-library-80339f104957?source=collection_archive---------11-----------------------#2022-03-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="5461" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">如果你想用Cypress(一种基于节点的方法，Selenium的替代方案)测试web用户界面，这里是你应该知道的最基本的东西。</h2></div><h1 id="568a" class="iy iz hi bd ja jb jc jd je jf jg jh ji io jj ip jk ir jl is jm iu jn iv jo jp bi translated">1.新项目</h1><p id="475a" class="pw-post-body-paragraph jq jr hi js b jt ju ij jv jw jx im jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">在一个新文件夹中，运行<code class="du km kn ko kp b">npm init</code>并按照步骤操作(有疑问时只需按回车键)。</p><p id="73d4" class="pw-post-body-paragraph jq jr hi js b jt kq ij jv jw kr im jy jz ks kb kc kd kt kf kg kh ku kj kk kl hb bi translated">我的建议是启动一个新的git存储库(<code class="du km kn ko kp b">git init</code>)，这样你就可以在需要的时候撤销它。每一步都是跑一个<code class="du km kn ko kp b">git commit</code>的好时机。从这个<code class="du km kn ko kp b"><a class="ae ix" href="https://git-scm.com/docs/gitignore" rel="noopener ugc nofollow" target="_blank">.gitignore</a></code> <a class="ae ix" href="https://git-scm.com/docs/gitignore" rel="noopener ugc nofollow" target="_blank">文件</a>开始:</p><pre class="kv kw kx ky fd kz kp la lb aw lc bi"><span id="a3fb" class="ld iz hi kp b fi le lf l lg lh">/node_modules<br/>.vscode<br/>.idea</span></pre><h1 id="ff62" class="iy iz hi bd ja jb jc jd je jf jg jh ji io jj ip jk ir jl is jm iu jn iv jo jp bi translated">2.添加柏树</h1><ol class=""><li id="043e" class="li lj hi js b jt ju jw jx jz lk kd ll kh lm kl ln lo lp lq bi translated">运行命令:<code class="du km kn ko kp b">npm install cypress --save-dev</code></li><li id="1f17" class="li lj hi js b jt lr jw ls jz lt kd lu kh lv kl ln lo lp lq bi translated">在<code class="du km kn ko kp b">package.json</code>，将命令(在<code class="du km kn ko kp b">"scripts"</code>下)更改为<code class="du km kn ko kp b">"test": "cypress run --browser chrome --headed"</code></li><li id="95ec" class="li lj hi js b jt lr jw ls jz lt kd lu kh lv kl ln lo lp lq bi translated">在项目的根目录下，为Cypress配置创建一个名为<code class="du km kn ko kp b">cypress.json</code>的空文件，内容为:<code class="du km kn ko kp b">{ "video": false }</code></li><li id="e6a8" class="li lj hi js b jt lr jw ls jz lt kd lu kh lv kl ln lo lp lq bi translated">现在我们需要一个模拟测试来证明目前为止一切正常。用名为<code class="du km kn ko kp b">amazonCart.js</code>的文件创建文件夹结构<code class="du km kn ko kp b">cypress/integration</code>。内容应该是:</li></ol><pre class="kv kw kx ky fd kz kp lw bn lx ly bi"><span id="a742" class="lz iz hi kp b be ma mb l mc lh">describe('Amazon cart test', () =&gt; {<br/>    it('adds to cart', () =&gt; {<br/>        expect(true).to.equal(true);<br/>    })<br/>})</span></pre><p id="6a2d" class="pw-post-body-paragraph jq jr hi js b jt kq ij jv jw kr im jy jz ks kb kc kd kt kf kg kh ku kj kk kl hb bi translated">现在，用<code class="du km kn ko kp b">npm test</code>(或者仅仅是<code class="du km kn ko kp b">npm t</code>)运行测试。您应该看到:<code class="du km kn ko kp b">✔ All specs passed!</code></p><h1 id="ed9f" class="iy iz hi bd ja jb jc jd je jf jg jh ji io jj ip jk ir jl is jm iu jn iv jo jp bi translated">3.添加测试库</h1><p id="0c80" class="pw-post-body-paragraph jq jr hi js b jt ju ij jv jw jx im jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">对我来说，<a class="ae ix" href="https://testing-library.com/" rel="noopener ugc nofollow" target="_blank">测试库</a>是测试web应用或网站时必备的。一方面，它促进了<a class="ae ix" rel="noopener" href="/codex/decoupling-tests-from-the-implementation-interfaces-5842380f9656">测试与HTML细节的完全分离，比如id和类</a>(这是一个<a class="ae ix" rel="noopener" href="/codex/anti-patterns-of-automated-software-testing-b396283a4cb6">反模式，只是为了测试</a>。另一方面，它有助于编写有利于<a class="ae ix" href="https://en.wikipedia.org/wiki/Web_accessibility" rel="noopener ugc nofollow" target="_blank">可访问性</a>和<a class="ae ix" href="https://en.wikipedia.org/wiki/Search_engine_optimization" rel="noopener ugc nofollow" target="_blank"> SEO </a>的<a class="ae ix" href="https://en.wikipedia.org/wiki/Semantic_HTML" rel="noopener ugc nofollow" target="_blank">语义HTML </a>。如果你不能很容易地找到某样东西，用户怎么可能做到呢？屏幕阅读器如何处理糟糕的HTML？内置选择器像用户一样查找元素。</p><figure class="kv kw kx ky fd md"><div class="bz dy l di"><div class="me mf l"/></div></figure><p id="796b" class="pw-post-body-paragraph jq jr hi js b jt kq ij jv jw kr im jy jz ks kb kc kd kt kf kg kh ku kj kk kl hb bi translated">让我们用<code class="du km kn ko kp b">npm install @testing-library/cypress --save-dev</code>添加Cypress版本的测试库</p><p id="8aa7" class="pw-post-body-paragraph jq jr hi js b jt kq ij jv jw kr im jy jz ks kb kc kd kt kf kg kh ku kj kk kl hb bi translated">将此行添加到项目的<code class="du km kn ko kp b">cypress/support/commands.js</code>:</p><pre class="kv kw kx ky fd kz kp lw bn lx ly bi"><span id="2be4" class="lz iz hi kp b be ma mb l mc lh">import '@testing-library/cypress/add-commands';</span></pre><p id="07a6" class="pw-post-body-paragraph jq jr hi js b jt kq ij jv jw kr im jy jz ks kb kc kd kt kf kg kh ku kj kk kl hb bi translated">让我们通过改变<code class="du km kn ko kp b">cypress/integration/amazonCart.js</code>来试验一下用于测试库的<a class="ae ix" href="https://testing-library.com/docs/cypress-testing-library/intro/" rel="noopener ugc nofollow" target="_blank"> Cypress:</a></p><pre class="kv kw kx ky fd kz kp lw bn lx ly bi"><span id="8279" class="lz iz hi kp b be ma mb l mc lh">describe('Amazon cart test', () =&gt; {<br/>    it('adds to cart', () =&gt; {<br/>        cy.visit("https://amazon.com")<br/>        cy.findByRole('textbox', {name: /search/i})<br/>          .type("kindle").type("{enter}")<br/>    })<br/>})</span></pre><p id="41f2" class="pw-post-body-paragraph jq jr hi js b jt kq ij jv jw kr im jy jz ks kb kc kd kt kf kg kh ku kj kk kl hb bi translated"><code class="du km kn ko kp b">findByRole</code>是测试库的一个例子。由于这个文本框没有标签，我们不得不求助于角色方法。我推荐阅读关于测试库查询的官方页面。</p><p id="36f6" class="pw-post-body-paragraph jq jr hi js b jt kq ij jv jw kr im jy jz ks kb kc kd kt kf kg kh ku kj kk kl hb bi translated">现在，用<code class="du km kn ko kp b">npm t</code>再次运行测试，看看结果:</p><figure class="kv kw kx ky fd md er es paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="er es mg"><img src="../Images/29086ac8c7b347c3755490733ce37c2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mNbALwkPBMhmJL0FEGQfBg.png"/></div></div></figure><p id="01ee" class="pw-post-body-paragraph jq jr hi js b jt kq ij jv jw kr im jy jz ks kb kc kd kt kf kg kh ku kj kk kl hb bi translated"><strong class="js hj"> ✔所有规格通过！</strong></p></div></div>    
</body>
</html>