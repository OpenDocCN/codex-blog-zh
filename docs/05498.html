<html>
<head>
<title>Creating an NFT Smart Contract from Scratch</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从头开始创建NFT智能合同</h1>
<blockquote>原文：<a href="https://medium.com/codex/creating-an-nft-smart-contract-from-scratch-eaf4f83ef558?source=collection_archive---------3-----------------------#2022-03-05">https://medium.com/codex/creating-an-nft-smart-contract-from-scratch-eaf4f83ef558?source=collection_archive---------3-----------------------#2022-03-05</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="6c9e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">为区块链以太坊(或多边形)创建NFT智能合约。</em></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/92241a49b8286fffc67d62e572f57b1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oUP_SkBxUpfYqsOhe41XZQ.jpeg"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">图片由<a class="ae ju" href="https://unsplash.com/@dvlden?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">内纳德·诺瓦科维奇</a>在<a class="ae ju" href="https://unsplash.com/s/photos/ethereum?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</figcaption></figure><p id="af01" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于一些人来说，NFT是一个非常辛辣的话题。但关于人们对它的看法，这是一个非常有趣的话题，可以用于伟大的事情(如分散的证券交易所)。区块链技术仍然是相当新的，各公司刚刚进入这一领域。</p><p id="867b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">那么，一个开发者如何才能试着分一杯羹呢？我们可以创建自己的项目，学习Solidity(Polygon和Ethereum上智能合约的语言)，并构建可能会让世界变得更好的惊人dApps。</p><p id="4702" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">本文是为具备一些编程知识的开发人员编写的。一些关于NodeJS / NPM的知识也会有所帮助。坚固性也会用到。为了让你理解，我会尽我所能去了解每一件事。享受吧。</em></p><h1 id="96a2" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">什么是智能合约？</h1><p id="8594" class="pw-post-body-paragraph if ig hi ih b ii kt ik il im ku io ip iq kv is it iu kw iw ix iy kx ja jb jc hb bi translated">简单地说，一个“<a class="ae ju" href="https://ethereum.org/en/developers/docs/smart-contracts/" rel="noopener ugc nofollow" target="_blank">智能契约</a>”，或者仅仅是“契约”就是一个运行在区块链上的程序。索拉纳称之为“程序”，Polygon和以太坊称之为“智能合约”。实际上，它们是一种账户，就像你自己的以太坊地址一样。他们有自己的余额，可以通过网络发送交易。然而，它们不受用户控制。他们是“不可信的”。</p><p id="957c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">用户可以与这些智能合同进行交互。他们也可以阅读代码，看看它做了什么。它们对每个人都一样，默认情况下，不能从区块链中删除。</p><p id="ff11" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如简介中提到的，以太坊的智能合约是用Solidity编写的，Solidity是一种静态类型的语言，具有智能合约的一些附加功能，如<code class="du ky kz la lb b">address</code>和<code class="du ky kz la lb b">payable</code>类型。</p></div><div class="ab cl lc ld gp le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="hb hc hd he hf"><h1 id="afb0" class="jv jw hi bd jx jy lj ka kb kc lk ke kf kg ll ki kj kk lm km kn ko ln kq kr ks bi translated">什么是NFT？</h1><p id="0c34" class="pw-post-body-paragraph if ig hi ih b ii kt ik il im ku io ip iq kv is it iu kw iw ix iy kx ja jb jc hb bi translated">NFT是不可替换的令牌。常被描述为类似于AAPL这样的股票。然而，这是半假的。股票具有相同的倍数，例如，公司A可能有6000万股，这些股票完全相同，它们是半可替代的。</p><p id="1c57" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是NFT是不可替代的。只能存在一个副本。所以它更类似于艺术。只有一个蒙娜丽莎，也只有一个<em class="jd">隐朋克#1234 </em>。它们是集合的一部分，但是每一个令牌仍然是唯一的。</p><p id="45ae" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">NFT也可以在其中存储所有权，并且可以包含比标准所说的更多的功能。一个简单的合同可以让用户铸造新的代币，转让它们，并烧掉它们。您的智能合约可能还具有更改令牌的功能(例如更改数字宠物的名称)。</p><p id="6f30" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">本质上，NFT只是你需要实现的一组标准的<a class="ae ju" href="https://ethereum.org/en/developers/docs/standards/tokens/erc-721/" rel="noopener ugc nofollow" target="_blank">，它们可以选择性地包含你为它编程的任何东西。</a></p><p id="c46d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">它们也被称为ERC-721合同。这是因为它首先被提交到以太坊改进提案(EIP)网站。因此，当这个提议被接受时，EIP-721就变成了ERC-721。它们定义了智能合约将实现的特定接口和功能。</p><h1 id="fa0d" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">ERC-721标准</h1><p id="d62a" class="pw-post-body-paragraph if ig hi ih b ii kt ik il im ku io ip iq kv is it iu kw iw ix iy kx ja jb jc hb bi translated">ERC-721标准和其他一些小功能是我们将要实现的。让我们看看<em class="jd">标准到底定义了什么</em>。</p><p id="ced6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我链接到的网站OpenZeppelin是一个非常有用的网站，可以提供文档和一些标准的信息。它们还提供了契约，您可以通过导入它们并根据自己的需要覆盖它们来使用它们。如果你想深入阅读完整的建议，你需要去EIPS的网站。</p><p id="7410" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在OZ上，我们可以看到很多ERC721和IERC721的提及。IERC721是我们实现的<em class="jd">接口</em>。它定义了函数名、参数、返回类型以及它应该包含的变量和映射。它还实现了ERC165，你可以在这里阅读<a class="ae ju" rel="noopener" href="/quick-programming/what-is-erc165-and-why-you-should-use-it-d0641a2f29e5"/>。</p><p id="77b9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将首先关注IERC721。它有几个看起来非常相似的函数和重载函数，我们就不详细介绍了，因为它们和非重载函数做的是一样的。我们来看看函数。</p><ul class=""><li id="c827" class="lo lp hi ih b ii ij im in iq lq iu lr iy ls jc lt lu lv lw bi translated"><code class="du ky kz la lb b"><strong class="ih hj">Constructor()</strong></code>。该构造函数在部署时只调用一次。它可以用来初始化私有变量或其他数据。就像Java或C#中普通的类构造函数一样。它可以有一个空的身体。</li><li id="0748" class="lo lp hi ih b ii lx im ly iq lz iu ma iy mb jc lt lu lv lw bi translated"><code class="du ky kz la lb b"><strong class="ih hj">BalanceOf()</strong></code>。该函数将返回特定地址拥有的令牌数。</li><li id="3db9" class="lo lp hi ih b ii lx im ly iq lz iu ma iy mb jc lt lu lv lw bi translated"><code class="du ky kz la lb b"><strong class="ih hj">OwnerOf()</strong></code>。它返回特定<code class="du ky kz la lb b">tokenId</code>的所有者的地址。比如:“谁拥有CryptoPunk #1234？”。</li><li id="2fc2" class="lo lp hi ih b ii lx im ly iq lz iu ma iy mb jc lt lu lv lw bi translated"><code class="du ky kz la lb b"><strong class="ih hj">SafeTransferFrom()</strong></code>。这个和它的非安全对应物用于将令牌从一个地址传送到下一个地址。您还需要添加您想要转移的令牌的<code class="du ky kz la lb b">tokenId</code>。</li><li id="200b" class="lo lp hi ih b ii lx im ly iq lz iu ma iy mb jc lt lu lv lw bi translated">所有的<code class="du ky kz la lb b"><strong class="ih hj">approve()</strong></code>功能。这些都<em class="jd">批准</em>一个你输入的地址来替你管理代币。他们可以转让代币。这通常用于标记代币或在OpenSea等市场上出售代币。</li><li id="2587" class="lo lp hi ih b ii lx im ly iq lz iu ma iy mb jc lt lu lv lw bi translated"><code class="du ky kz la lb b"><strong class="ih hj">SupportsInterface()</strong></code>。这是给ERC165的。你可以在这里阅读<a class="ae ju" rel="noopener" href="/quick-programming/what-is-erc165-and-why-you-should-use-it-d0641a2f29e5">。但是你现在不用担心了。</a></li></ul><p id="3d33" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">虽然这是有效的NFT契约唯一需要实现的东西，但是OpenZeppelin的ERC721契约还包含一些我们也将使用的函数。最值得注意的是:</p><ul class=""><li id="f629" class="lo lp hi ih b ii ij im in iq lq iu lr iy ls jc lt lu lv lw bi translated"><code class="du ky kz la lb b"><strong class="ih hj">_safeMint()</strong></code>，这是用户将从你的合同中调用的主要功能。它允许你(或用户)铸造新的令牌。您几乎总是会添加更多的功能，比如检查用户是否被允许铸造令牌。</li><li id="c374" class="lo lp hi ih b ii lx im ly iq lz iu ma iy mb jc lt lu lv lw bi translated"><code class="du ky kz la lb b"><strong class="ih hj">tokenURI</strong></code>。<code class="du ky kz la lb b">tokenURI</code>存储关于令牌的信息。它通常是一个到JSON文件的IPFS链接，该文件存储了令牌的名称和图像。像OpenSea这样的市场调用这个函数来获取关于您的令牌的所有信息。</li><li id="020c" class="lo lp hi ih b ii lx im ly iq lz iu ma iy mb jc lt lu lv lw bi translated"><code class="du ky kz la lb b"><strong class="ih hj">_baseURI</strong></code>T18。默认情况下不会实现<code class="du ky kz la lb b">_baseURI</code>，但是它通过提供URI的基础来增加<code class="du ky kz la lb b">tokenURI</code>的功能。例如，每个令牌可能存储在IPFS的一个文件夹中。将整个链接存储在每个令牌中是没有意义的，相反，您可以简单地将<code class="du ky kz la lb b">tokenId</code>附加到<code class="du ky kz la lb b">baseURI</code>来创建<code class="du ky kz la lb b">tokenURI</code>。</li></ul><p id="8ef1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这基本上是我们需要实现的一切，然而，如果你想用这个契约开发一个dApp，我们可能想从其他OpenZeppelin契约中添加一些更有用的函数，如<a class="ae ju" href="https://docs.openzeppelin.com/contracts/4.x/api/token/erc721#ERC721Enumerable" rel="noopener ugc nofollow" target="_blank"> ERC721Enumerable </a>。</p><h2 id="228e" class="mc jw hi bd jx md me mf kb mg mh mi kf iq mj mk kj iu ml mm kn iy mn mo kr mp bi translated">ERC 721可数</h2><p id="347a" class="pw-post-body-paragraph if ig hi ih b ii kt ik il im ku io ip iq kv is it iu kw iw ix iy kx ja jb jc hb bi translated">ERC721Enumerable增加了一些有用的函数，可以更容易地获得关于令牌的特定数据，而无需对区块链进行1000次<code class="du ky kz la lb b">view</code>调用。它增加了以下功能。</p><ul class=""><li id="e124" class="lo lp hi ih b ii ij im in iq lq iu lr iy ls jc lt lu lv lw bi translated"><code class="du ky kz la lb b"><strong class="ih hj">TokenOfOwnerByIndex()</strong></code>。这在所有者持有多个代币的情况下非常有用。例如，它返回第7个令牌地址<code class="du ky kz la lb b">0xabc...</code>持有。</li><li id="ed4a" class="lo lp hi ih b ii lx im ly iq lz iu ma iy mb jc lt lu lv lw bi translated"><code class="du ky kz la lb b"><strong class="ih hj">TotalSupply()</strong></code>。它返回合同当前拥有的令牌总数。如果铸造了10000个代币，那就是10000个。</li><li id="5027" class="lo lp hi ih b ii lx im ly iq lz iu ma iy mb jc lt lu lv lw bi translated"><code class="du ky kz la lb b"><strong class="ih hj">TokenByIndex()</strong></code>返回通过索引检索到的令牌的<code class="du ky kz la lb b">tokenId</code>。虽然大多数时候指数和<code class="du ky kz la lb b">tokenId</code>是相同的。</li><li id="dd26" class="lo lp hi ih b ii lx im ly iq lz iu ma iy mb jc lt lu lv lw bi translated"><code class="du ky kz la lb b"><strong class="ih hj">_beforeTokenTransfer</strong></code>在任何令牌传输(包括铸造和刻录)之前调用。目前我们不需要担心这个。</li></ul><p id="ebe1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在<a class="ae ju" href="https://docs.openzeppelin.com/contracts/4.x/api/token/erc721" rel="noopener ugc nofollow" target="_blank"> OpenZeppelin </a>上的ERC721还有很多其他变体。如果你想的话，你可以自己去查看，但是我们现在不需要详细讨论。我只想告诉你，它们是存在的，而且非常有用。</p></div><div class="ab cl lc ld gp le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="hb hc hd he hf"><h1 id="05a2" class="jv jw hi bd jx jy lj ka kb kc lk ke kf kg ll ki kj kk lm km kn ko ln kq kr ks bi translated">我之前提到过多边形，它是什么？</h1><p id="a84a" class="pw-post-body-paragraph if ig hi ih b ii kt ik il im ku io ip iq kv is it iu kw iw ix iy kx ja jb jc hb bi translated">多边形和以太坊一样，是一个区块链，你可以在上面创建智能合约。它比以太坊上的智能合约便宜得多，而且目前更环保，因为Polygon是风险证明，而以太坊是更老派的工作证明。</p><p id="4c0d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">这两个</strong>的代码完全相同，唯一的区别是ChainId和部署它们所需的参数。它们都使用Solidity，并且都可以使用相同的地址<strong class="ih hj">访问像MetaMask这样的钱包。这使得它非常适合业余爱好项目，而学习更严重的项目。</strong></p></div><div class="ab cl lc ld gp le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="hb hc hd he hf"><h1 id="dfde" class="jv jw hi bd jx jy lj ka kb kc lk ke kf kg ll ki kj kk lm km kn ko ln kq kr ks bi translated">创建智能合同</h1><p id="83b5" class="pw-post-body-paragraph if ig hi ih b ii kt ik il im ku io ip iq kv is it iu kw iw ix iy kx ja jb jc hb bi translated">您可以通过几种不同的方式创建智能合同。对于较大的项目，您可能希望建立一个良好的工作空间，正如我们下面将要做的。但如果你只想运行智能合约，玩一玩，可以用Remix。</p><h2 id="51ed" class="mc jw hi bd jx md me mf kb mg mh mi kf iq mj mk kj iu ml mm kn iy mn mo kr mp bi translated">再搅拌</h2><p id="8c39" class="pw-post-body-paragraph if ig hi ih b ii kt ik il im ku io ip iq kv is it iu kw iw ix iy kx ja jb jc hb bi translated">虽然我们不打算使用Remix ，但它是一个很棒的智能合约开发在线集成开发环境。它允许您轻松地测试新事物，而无需在测试网上重新部署契约。它允许您在JavaScript VM中进行测试。你可以在我写的另一篇文章中读到更多。</p><div class="mq mr ez fb ms mt"><a rel="noopener follow" target="_blank" href="/codex/how-to-test-a-smart-contract-with-remix-b2e9669997dd"><div class="mu ab dw"><div class="mv ab mw cl cj mx"><h2 class="bd hj fi z dy my ea eb mz ed ef hh bi translated">如何用Remix测试智能合约</h2><div class="na l"><h3 class="bd b fi z dy my ea eb mz ed ef dx translated">无需部署到测试网即可轻松测试。</h3></div><div class="nb l"><p class="bd b fp z dy my ea eb mz ed ef dx translated">medium.com</p></div></div><div class="nc l"><div class="nd l ne nf ng nc nh jo mt"/></div></div></a></div><p id="47c4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你决定使用Remix，直接跳到本文的Solidity编码部分。你不会错过这个项目太多，但它可能是好的学习安全帽或松露在未来更大的项目。</p><h2 id="31ab" class="mc jw hi bd jx md me mf kb mg mh mi kf iq mj mk kj iu ml mm kn iy mn mo kr mp bi translated">设置安全帽</h2><p id="6f28" class="pw-post-body-paragraph if ig hi ih b ii kt ik il im ku io ip iq kv is it iu kw iw ix iy kx ja jb jc hb bi translated">要创建智能合同，我们需要设置一些工具。有几种方法可以做到这一点，比如使用Remix，但我将使用<a class="ae ju" href="https://hardhat.org/" rel="noopener ugc nofollow" target="_blank"> HardHat </a>。HardHat是一个工具，它将帮助我们在未来以编程方式部署和测试我们的智能合约。可以使用NodeJS的包管理器<a class="ae ju" href="https://npmjs.com/" rel="noopener ugc nofollow" target="_blank"> NPM </a>将其作为一个包下载。</p><p id="df02" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">安装NPM后，为项目创建一个文件夹。名字不重要。接下来，打开命令行，分别输入以下命令。</p><pre class="jf jg jh ji fd ni lb nj nk aw nl bi"><span id="3483" class="mc jw hi lb b fi nm nn l no np">npm init -y<br/>npm install --save-dev hardhat</span></pre><p id="ebdc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第一个命令初始化一个新的节点项目，第二个命令只为这个项目安装hard hat<strong class="ih hj"/>。请注意，安装HardHat可能需要几分钟时间，它有很多依赖项。</p><p id="456c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">运行<code class="du ky kz la lb b">npx hardhat</code>，选择<code class="du ky kz la lb b">Create an empty hardhat config file</code>。这将创建一个<code class="du ky kz la lb b">hardhat.config.js</code>文件，您可以在其中设置Solidity编译器设置、部署设置等等。</p><p id="d1e1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我们编写了智能契约之后，您可以使用<code class="du ky kz la lb b">npx hardhat compile</code>来编译它。现在我们已经拥有了一切，让我们从简单的部分开始，即可靠性代码。</p><h2 id="1c26" class="mc jw hi bd jx md me mf kb mg mh mi kf iq mj mk kj iu ml mm kn iy mn mo kr mp bi translated">坚固性代码</h2><p id="45e6" class="pw-post-body-paragraph if ig hi ih b ii kt ik il im ku io ip iq kv is it iu kw iw ix iy kx ja jb jc hb bi translated">现在，我们终于可以创建实际的智能合约了。谢天谢地，对我们来说，这是相当简单的，即使没有深刻理解ERC-721标准，或知识的可靠性语言。<strong class="ih hj">因为我们可以使用</strong><a class="ae ju" href="https://docs.openzeppelin.com/contracts/4.x/api/token/erc721" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj">open zeppelin</strong></a><strong class="ih hj">的智能合约来导入大部分功能</strong>而不用写任何东西。</p><p id="ef51" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">许多大项目都使用OpenZeppelin的合同。它允许我们将注意力集中在整个项目上，而不是实现我们可以从互联网上抓取的功能。这和使用其他语言的库或包是一样的。</p><p id="0214" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以通过运行以下命令，使用NPM安装OpenZeppelin的合同。</p><pre class="jf jg jh ji fd ni lb nj nk aw nl bi"><span id="a627" class="mc jw hi lb b fi nm nn l no np">npm i @openzeppelin/contracts</span></pre><p id="465d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你可以在 <code class="du ky kz la lb b"><em class="jd">node_modules</em></code> <em class="jd">文件夹里找到它们，有兴趣的话可以去看看。不过，我们只打算导入它们。</em></p><p id="9ebc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">创建一个名为<code class="du ky kz la lb b">contracts</code>的文件夹，并在其中创建一个扩展名为<code class="du ky kz la lb b">.sol</code>的文件。这将是我们的智能合同。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="nq nr l"/></div></figure><p id="b83e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这几行代码是NFT智能合约的基础。我们从OpenZeppelin导入ERC721Enumerable，并用我们的令牌名和缩写调用它的构造函数。我们还将<code class="du ky kz la lb b">pragma solidity 0.7.3</code>匹配到可以在<code class="du ky kz la lb b">hardhat.config.js</code>文件中找到的Solidity版本。</p><p id="8f80" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">注意，我们导入了ERC721Enumerable，但是只调用了ERC721Enumerable导入的ERC721的构造函数。</em></p><p id="dc7f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们现在可以添加一些覆盖铸造功能所需的变量。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="nq nr l"/></div></figure><p id="a389" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们设置了合同可以创建的最大令牌数，当然，还有每个令牌的价格。我们从来自ERC721Enumerable的<code class="du ky kz la lb b">totaSupply</code>中获得我们将要铸造的令牌的<code class="du ky kz la lb b">tokenId</code>。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="nq nr l"/></div></figure><p id="3b6a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您现在已经创建了一个非常简单的NFT契约。你现在可以添加更多的功能，覆盖你特定用例的功能，或者只是运行<code class="du ky kz la lb b">npx hardhat compile</code>来尝试编译它。</p><p id="507f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你得到错误的实体版本，你可能需要更新你的配置文件，如下所示。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="nq nr l"/></div></figure><p id="b8b2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可以添加/修改编译器，以确保包含所有合同使用的每个版本。然后它应该没有任何问题地编译。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es ns"><img src="../Images/9efaacb3122b93e65b786676561ed37b.png" data-original-src="https://miro.medium.com/v2/resize:fit:644/format:webp/1*Sz3lxUKvrb21wiYfSrB2QQ.png"/></div></figure><p id="2f25" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">恭喜你！你在这篇文章的底部。我希望到目前为止你已经学到了很多，我也希望你能用这些知识来构建令人惊叹的项目。如果你想了解接下来的步骤，我建议你看看下面的进一步阅读部分。</p><h1 id="0440" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">进一步阅读</h1><ul class=""><li id="0bd9" class="lo lp hi ih b ii kt im ku iq nt iu nu iy nv jc lt lu lv lw bi translated"><a class="ae ju" rel="noopener" href="/codex/how-to-test-a-smart-contract-with-remix-b2e9669997dd">使用Remix测试智能合约</a></li><li id="b34c" class="lo lp hi ih b ii lx im ly iq lz iu ma iy mb jc lt lu lv lw bi translated"><a class="ae ju" rel="noopener" href="/codex/testing-a-smart-contract-with-hardhat-️-b7edd925891">使用HardHat测试智能合约</a></li><li id="da79" class="lo lp hi ih b ii lx im ly iq lz iu ma iy mb jc lt lu lv lw bi translated"><a class="ae ju" rel="noopener" href="/quick-programming/how-to-deploy-a-smart-contract-using-remix-9e270b253249">部署带有Remix的智能合约</a></li><li id="69c0" class="lo lp hi ih b ii lx im ly iq lz iu ma iy mb jc lt lu lv lw bi translated"><a class="ae ju" rel="noopener" href="/quick-programming/how-to-deploy-a-smart-contract-with-hardhat-45e0a6ffdb4c">使用HardHat部署智能合同</a></li><li id="2008" class="lo lp hi ih b ii lx im ly iq lz iu ma iy mb jc lt lu lv lw bi translated"><a class="ae ju" rel="noopener" href="/codex/creating-a-basic-dapp-with-web3-and-nextjs-2ee94af06517">用Web3和NextJS创建一个基本的dApp</a></li></ul></div><div class="ab cl lc ld gp le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="hb hc hd he hf"><h1 id="c026" class="jv jw hi bd jx jy lj ka kb kc lk ke kf kg ll ki kj kk lm km kn ko ln kq kr ks bi translated">结论</h1><p id="4b60" class="pw-post-body-paragraph if ig hi ih b ii kt ik il im ku io ip iq kv is it iu kw iw ix iy kx ja jb jc hb bi translated">我们现在已经创建了一个简单的智能合同，它完全实现了ERC-721标准。查看延伸阅读部分，了解后续步骤，如使用Remix或HardHat测试和部署您的合同。</p><p id="2889" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">非常感谢您的阅读，祝您度过美好的一天。</p><p id="f49a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae ju" href="https://mbvissers.medium.com/membership" rel="noopener">考虑通过成为中级会员来支持我。它帮了我大忙，不会花你任何额外的费用，而且你可以阅读尽可能多的中等文章！</a></p><p id="71fd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在<a class="ae ju" href="https://twitter.com/0xmbvissers" rel="noopener ugc nofollow" target="_blank"> Twitter </a>和<a class="ae ju" href="https://gm.xyz/u/mbvissers.eth" rel="noopener ugc nofollow" target="_blank"> gm.xyz </a>上关注我，以跟上我的项目。</p><p id="47f1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">查看<a class="ae ju" href="https://kangaroomob.io/" rel="noopener ugc nofollow" target="_blank">袋鼠黑帮</a> NFT项目。</p><p id="5626" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">检查多边形上的<a class="ae ju" href="https://www.pixel-pizzas.com/" rel="noopener ugc nofollow" target="_blank">像素披萨</a>。</p></div></div>    
</body>
</html>