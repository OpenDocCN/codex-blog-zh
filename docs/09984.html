<html>
<head>
<title>ShardingSphere-on-Cloud &amp; Pisanix replace Sidecar for a true cloud-native experience</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">sharding sphere-on-Cloud &amp; Pisanix取代Sidecar，实现真正的云原生体验</h1>
<blockquote>原文：<a href="https://medium.com/codex/shardingsphere-on-cloud-pisanix-replace-sidecar-for-a-true-cloud-native-experience-bb48ebef71b4?source=collection_archive---------8-----------------------#2022-11-24">https://medium.com/codex/shardingsphere-on-cloud-pisanix-replace-sidecar-for-a-true-cloud-native-experience-bb48ebef71b4?source=collection_archive---------8-----------------------#2022-11-24</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><h1 id="3a63" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">背景</h1><p id="6c2f" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">有一段时间，我们的很多博文都显示<a class="ae kb" href="https://shardingsphere.apache.org/" rel="noopener ugc nofollow" target="_blank"><strong class="jf hj">sharding sphere</strong></a><strong class="jf hj">由三个独立的产品组成:</strong><a class="ae kb" href="https://shardingsphere.apache.org/document/current/en/overview/#shardingsphere-jdbc" rel="noopener ugc nofollow" target="_blank"><strong class="jf hj">sharding sphere-JDBC</strong></a><strong class="jf hj">、</strong><a class="ae kb" href="https://shardingsphere.apache.org/document/current/en/quick-start/shardingsphere-proxy-quick-start/" rel="noopener ugc nofollow" target="_blank"><strong class="jf hj">sharding sphere-Proxy</strong></a><strong class="jf hj">和ShardingSphere-Sidecar。</strong></p><p id="8c31" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">随着ShardingSphere变得越来越流行，JDBC和Proxy已经在许多生产环境中使用，但是Sidecar的状态仍然是“<strong class="jf hj">规划中”</strong>。您可能已经在我们的GitHub <code class="du kh ki kj kk b">READ ME</code>或我们的网站上注意到了这一点。</p><p id="6ee5" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">随着云原生数据库的发展势头越来越猛，许多企业选择使用云上的数据库或云原生数据库。这对ShardingSphere-Sidecar来说是一个绝佳的机会，它在<a class="ae kb" href="https://kubernetes.io/" rel="noopener ugc nofollow" target="_blank"><strong class="jf hj">Kubernetes</strong></a>中被定位为<strong class="jf hj">云原生数据库代理。</strong></p><p id="01fb" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">然而，你们中的一些人可能已经注意到，任何关于Sidecar的内容都已经从ShardingSphere的最新文档中消失了。ShardingSphere-Sidecar取消了吗？ShardingSphere的云原生未来会是什么样子？接下来是。</p><h1 id="c0fb" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">ShardingSphere对云有什么计划？</h1><h2 id="3392" class="kl ig hi bd ih km kn ko il kp kq kr ip jo ks kt it js ku kv ix jw kw kx jb ky bi translated">停止R&amp;D的ShardingSphere-Sidecar</h2><p id="5fcf" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">就ShardingSphere用户而言，ShardingSphere-JDBC和ShardingSphere-Proxy已经可以满足大部分需求。ShardingSphere-Sidecar与它们的唯一区别在于部署形式。JDBC和代理在功能上是相同的，但各有独特的优势。</p><p id="e896" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">ShardingSphere-JDBC被定位为一个轻量级Java框架，在Java JDBC层提供额外的服务。客户端直接连接到数据库，它以<code class="du kh ki kj kk b">jar</code>的形式提供服务，不需要额外的部署和依赖。它可以看作是一个增强的JDBC驱动程序，完全兼容JDBC和各种ORM框架。它的目标是开发人员，拥有更高的性能。</p><p id="a385" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">ShardingSphere-Proxy是一个透明的数据库代理，通过实现数据库二进制协议来支持异构语言。目前提供了<a class="ae kb" href="https://www.mysql.com/" rel="noopener ugc nofollow" target="_blank"> MySQL </a>和<a class="ae kb" href="https://www.postgresql.org/" rel="noopener ugc nofollow" target="_blank"> PostgreSQL </a>协议。然而，代理在数据库和前端应用层之间增加了一个网关，这将部分降低性能。</p><p id="da27" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated"><strong class="jf hj">我们的社区建议用户采用混合部署模式，允许JDBC和代理互补，最大限度地发挥ShardingSphere在性能、可用性和异构支持方面的优势。</strong></p><figure class="la lb lc ld fd le er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es kz"><img src="../Images/c7ae964deae56be573de9d7611ec56de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V1X0HQAAlb2MivIwYpDFbA.png"/></div></div></figure><p id="d033" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">正如你所看到的，这对ShardingSphere-Sidecar来说有点尴尬:JDBC和代理适用于大多数场景、环境和业务，可以相互补充，给Sidecar留下的创新空间很小。从社区及其用户的角度来看，Sidecar更像是部署模式的扩展，它不能从整体上增强ShardingSphere。</p><p id="a25b" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated"><strong class="jf hj">考虑到以上因素，为ShardingSphere开发一个可以在Kubernetes环境中轻松使用和运行的补丁工具更有效率。这样，用户可以在云原生环境中部署和使用ShardingSphere，同时为ShardingSphere社区节省研发时间。</strong></p><h2 id="4305" class="kl ig hi bd ih km kn ko il kp kq kr ip jo ks kt it js ku kv ix jw kw kx jb ky bi translated">ShardingSphere的云解决方案:<a class="ae kb" href="https://github.com/apache/shardingsphere-on-cloud" rel="noopener ugc nofollow" target="_blank"> ShardingSphere-On-Cloud </a></h2><blockquote class="ll lm ln"><p id="a6e4" class="jd je lo jf b jg kc ji jj jk kd jm jn lp ke jq jr lq kf ju jv lr kg jy jz ka hb bi translated"><em class="hi"> ShardingSphere-on-Cloud是基于ShardingSphere的全面系统升级。</em></p></blockquote><p id="ad87" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">ShardingSphere-Sidecar诞生于Kubernetes繁荣时期。当时，越来越多的企业试图采用云原生概念。ShardingSphere社区也不例外。</p><p id="7afc" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">我们提出了ShardingSphere-Sidecar来促进数据领域的云原生转换。然而，由于JDBC和代理已经足够成熟，可以处理大多数场景中的数据治理，因此没有必要让ShardingSphere完全是云原生的。</p><p id="4e0d" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">Sidecar确实可以在某些场景中发挥很大的作用，但这并不意味着我们必须为每个组件创建一个Sidecar版本。ShardingSphere正在研究如何在充分整合云计算概念后，提出一个基于真实云原生场景的解决方案。这就是ShardingSphere-on-Cloud的诞生。</p><p id="7e5b" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated"><a class="ae kb" href="https://github.com/apache/shardingsphere-on-cloud" rel="noopener ugc nofollow" target="_blank">云上ShardingSphere</a>能够在Kubernetes环境中部署和迁移sharding sphere。在<a class="ae kb" href="https://aws.amazon.com/cloudformation/" rel="noopener ugc nofollow" target="_blank"> AWS CloudFormation </a>、<a class="ae kb" href="https://helm.sh/" rel="noopener ugc nofollow" target="_blank"> Helm </a>、Operator和Terraform(即将推出)等工具的帮助下，它提供了在云原生环境中快速部署、更高的可观测性、安全性和迁移以及高可用性部署的最佳实践。</p><blockquote class="ll lm ln"><p id="72b7" class="jd je lo jf b jg kc ji jj jk kd jm jn lp ke jq jr lq kf ju jv lr kg jy jz ka hb bi translated"><em class="hi">详情请参考</em> <a class="ae kb" rel="noopener" href="/codex/database-plus-embracing-the-cloud-shardingsphere-on-cloud-solution-released-29916290ad06?source=your_stories_page-------------------------------------"> <strong class="jf hj">数据库加拥抱云:ShardingSphere-on-Cloud解决方案发布</strong> </a> <em class="hi">。</em></p></blockquote><h2 id="305f" class="kl ig hi bd ih km kn ko il kp kq kr ip jo ks kt it js ku kv ix jw kw kx jb ky bi translated">通过<a class="ae kb" href="https://www.pisanix.io/" rel="noopener ugc nofollow" target="_blank"> Pisanix </a>实现切割球侧车的视觉</h2><p id="ae14" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated"><strong class="jf hj">为什么我们要开发一个新的面向云原生场景中数据治理的开源项目？</strong></p><p id="3b8c" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">我们的社区一直在思考ShardingSphere和<a class="ae kb" rel="noopener" href="/faun/database-mesh-2-0-database-governance-in-a-cloud-native-environment-ac24080349eb?source=your_stories_page-------------------------------------">数据库网格</a>概念的定位。</p><p id="46e6" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">在社区内，我们在不同的阶段对边车持有不同的观点。一开始，社区希望使用Sidecar来管理云数据问题。随着社区对云原生和云数据管理流程的深入了解，ShardingSphere-Sidecar的局限性也逐渐暴露出来。</p><p id="9c07" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">ShardingSphere-Sidecar只是云原生环境下ShardingSphere的一种部署模式，所以只能解决单一问题。它无法帮助ShardingSphere为企业开发一个成熟的云原生解决方案。</p><p id="51e8" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated"><strong class="jf hj">因此，我们需要在云原生系统中重新设计一个具有更高适应性、可用性和敏捷性的开源产品，以弥补ShardingSphere在云数据治理方面的限制。</strong></p><p id="119d" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">这就是为什么我们在SphereEx的一些社区成员开发了Pisanix，一个基于数据库网格概念的云原生数据治理工具。它可以提供SQL感知流量治理、运行时面向资源的管理和DBRE等功能。</p><h2 id="b200" class="kl ig hi bd ih km kn ko il kp kq kr ip jo ks kt it js ku kv ix jw kw kx jb ky bi translated">Pisanix和ShardingSphere-Sidecar一样吗？</h2><p id="ffd7" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">ShardingSphere-Sidecar和Pisanix传达了对数据库网格的不同理解。它们在以下几个方面是不同的。</p><ul class=""><li id="3d23" class="ls lt hi jf b jg kc jk kd jo lu js lv jw lw ka lx ly lz ma bi translated"><strong class="jf hj">不同的设计理念:</strong>JDBC&amp;代理的设计理念是Database Plus，在多个数据源之上增加一个接口，进行统一治理和增强。Pisanix代表了数据库网格概念的具体实践，为云原生场景中的应用程序带来了高效、流畅的数据库开发。</li><li id="75fb" class="ls lt hi jf b jg mb jk mc jo md js me jw mf ka lx ly lz ma bi translated"><strong class="jf hj">不同的语言生态系统:</strong> JDBC是单独用Java开发的。由于Java受到众多企业级社区用户和开发人员的欢迎，JDBC可以很容易地应用于Java开发的应用程序。相比较而言，Pisanix是在<a class="ae kb" href="https://www.rust-lang.org/" rel="noopener ugc nofollow" target="_blank"> Rust </a>开发的，用来提高接入层的可靠性和效率。</li></ul><p id="dda6" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">尽管有一些小的不同，但它们都面向云原生数据基础设施。这也是Database Mesh通过实施云原生DBRE的长期期望。</p><p id="41fa" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">在部署方式上，Pisanix和ShardingSphere-Sidecar都可以以Sidecar的形式部署业务应用，为开发者提供标准的协议接入。此外，Pisanix与ShardingSphere生态系统高度兼容。可以用ShardingSphere-Proxy连接MySQL的相同方式将Pisanix连接到ShardingSphere-Proxy。</p><p id="85f1" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">简而言之，ShardingSphere在Database Plus概念下为开发者和应用程序呈现了一个完整的数据库表单。Pisanix也是为了同样的目的而设计的。通过云数据流量入口Pisanix，用户可以使用ShardingSphere-Proxy作为数据库，探索云原生环境下的协作模式。</p><p id="82e1" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">但是，它们属于独立的产品线。Pisanix从一开始就遵循数据库网状概念，通过<strong class="jf hj">本地数据库、统一配置和管理、多协议支持和云原生架构</strong>四个方面实现高性能扩展。</p><p id="daa5" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">Pisanix只是统一云上数据库类型的第一步，Sidecar只是一种部署形式。</p><blockquote class="ll lm ln"><p id="85cc" class="jd je lo jf b jg kc ji jj jk kd jm jn lp ke jq jr lq kf ju jv lr kg jy jz ka hb bi translated"><em class="hi">不同数据库的协议和DevOps特性各不相同，重点在于抽象出标准的治理行为。</em></p></blockquote><p id="5a1e" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">与Pisanix不同，ShardingSphere生态系统不仅可以通过协议访问，而且ShardingSphere-JDBC可以更方便地被Java应用程序使用。</p><p id="b3ba" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">它的自然兼容性保持了功能的完整性，优化了资源利用并提供了终极性能，开发人员可以从业务的角度随意配置数据治理。同时，通过将ShardingSphere与底层数据库相结合，用户可以在应用程序端部署强大的计算能力，将原来的单一数据库转变为高性能的分布式数据库，优化资源分配，提供高性价比的解决方案。</p><p id="e5b0" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">总之，ShardingSphere和Pisanix一起为社区用户提供了两种解决方案。对于想要在Kubernetes环境中部署ShardingSphere的用户来说，ShardingSphere-on-Cloud就足够了，ShardingSphere的其他功能与在本地使用时完全相同。</p><p id="53d0" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated"><strong class="jf hj">对于希望在云原生场景下实现上层数据库统一流量治理的用户来说，Pisanix是更好的选择。</strong></p><p id="ad7d" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">与ShardingSphere-Sidecar相比，ShardingSphere-on-Cloud结合Pisanix更加有效和方便。</p><p id="a171" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated"><a class="ae kb" href="https://shardingsphere.apache.org/" rel="noopener ugc nofollow" target="_blank"> <strong class="jf hj"> ShardingSphere官网</strong> </a></p><p id="df26" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated"><a class="ae kb" href="https://www.database-mesh.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="jf hj">数据库网格官网</strong> </a></p><p id="8bec" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated"><a class="ae kb" href="https://www.pisanix.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="jf hj"> Pisanix官网</strong> </a></p></div></div>    
</body>
</html>