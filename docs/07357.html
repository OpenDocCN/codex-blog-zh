<html>
<head>
<title>Basics of serverless functions by the example of Azure Functions + Hands on</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">以Azure Functions + Hands on为例，介绍无服务器功能的基础知识</h1>
<blockquote>原文：<a href="https://medium.com/codex/basics-of-serverless-functions-by-the-example-of-azure-functions-hands-on-2de0e9a13d03?source=collection_archive---------8-----------------------#2022-06-12">https://medium.com/codex/basics-of-serverless-functions-by-the-example-of-azure-functions-hands-on-2de0e9a13d03?source=collection_archive---------8-----------------------#2022-06-12</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/51e18ed36802c310be9016484fae571f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*SKjgVEDhs0CzajyV"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">用Azure函数演示无服务器函数</figcaption></figure><p id="640a" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi js translated">云计算的最大优势之一是能够根据您的需求开启和关闭您的计算资源。这有不同的种类。IaaS服务，如虚拟机，在不使用时会自动关闭(例如，30分钟不使用后会关闭)。此外，还有PaaS服务数据库(例如Azure SQL ),它们只在有查询传入时才启动计算资源。</p><p id="9d9f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><em class="kb">请记住，无服务器并不意味着云服务不托管在任何服务器上。没有服务器运行代码是不行的。无服务器只是一个抽象层，由云提供商提供给你。这使得您不必考虑底层的服务器基础设施。你只需要交付你的代码，云供应商管理底层基础设施。</em></p><h1 id="8f1d" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">无服务器功能</h1><p id="a806" class="pw-post-body-paragraph iu iv hi iw b ix la iz ja jb lb jd je jf lc jh ji jj ld jl jm jn le jp jq jr hb bi translated">这些无服务器的云资源还伴随着无服务器的功能，这是一种非常轻量级的托管代码的方式。有时它们不被称为PaaS，而是被称为FaaS(功能即服务)。这些服务不同于之前命名的两种类型的服务，它们是从头开始构建的，旨在尽可能高效地满足您的计算需求。它们可以在几秒钟内启动，也可以在几秒钟内终止其计算资源，并且几乎可以无限扩展。在AWS中，它们被称为Lambdas，在GCP云函数中，但为了获得这些函数的更详细的概述，我们将Azure函数作为重点。</p><h2 id="c756" class="lf kd hi bd ke lg lh li ki lj lk ll km jf lm ln kq jj lo lp ku jn lq lr ky ls bi translated">Azure函数</h2><p id="5dd9" class="pw-post-body-paragraph iu iv hi iw b ix la iz ja jb lb jd je jf lc jh ji jj ld jl jm jn le jp jq jr hb bi translated">Azure函数允许你在短时间内运行代码，就像其他无服务器的函数一样。在最常见的托管(我们稍后会详细讨论这个话题)计划的情况下，消费计划的最大运行时间是10分钟，而默认是5分钟。如前所述，使用这些功能的好处是，如果真的使用了这些功能，你只需要向你的云提供商(在我们的例子中是Azure)付费。此外，底层服务正在管理您的所有扩展需求，因此您不必担心。</p><h2 id="e684" class="lf kd hi bd ke lg lh li ki lj lk ll km jf lm ln kq jj lo lp ku jn lq lr ky ls bi translated">支持的语言</h2><p id="455f" class="pw-post-body-paragraph iu iv hi iw b ix la iz ja jb lb jd je jf lc jh ji jj ld jl jm jn le jp jq jr hb bi translated">没有用特定语言实际编写代码，就没有代码执行。幸运的是，Azure functions提供了<a class="ae lt" href="https://docs.microsoft.com/en-us/azure/azure-functions/supported-languages" rel="noopener ugc nofollow" target="_blank">多种不同的语言</a>来支持你喜欢的工作方式。支持的语言列表包括:</p><ul class=""><li id="f00f" class="lu lv hi iw b ix iy jb jc jf lw jj lx jn ly jr lz ma mb mc bi translated">C#</li><li id="15c8" class="lu lv hi iw b ix md jb me jf mf jj mg jn mh jr lz ma mb mc bi translated">计算机编程语言</li><li id="ed4b" class="lu lv hi iw b ix md jb me jf mf jj mg jn mh jr lz ma mb mc bi translated">java描述语言</li><li id="ff8a" class="lu lv hi iw b ix md jb me jf mf jj mg jn mh jr lz ma mb mc bi translated">以打字打的文件</li><li id="69a7" class="lu lv hi iw b ix md jb me jf mf jj mg jn mh jr lz ma mb mc bi translated">Java 语言(一种计算机语言，尤用于创建网站)</li></ul><h2 id="a7fe" class="lf kd hi bd ke lg lh li ki lj lk ll km jf lm ln kq jj lo lp ku jn lq lr ky ls bi translated">托管计划</h2><p id="85a1" class="pw-post-body-paragraph iu iv hi iw b ix la iz ja jb lb jd je jf lc jh ji jj ld jl jm jn le jp jq jr hb bi translated">此外，你需要确定一个适当的方式来托管你的功能。你可以在以下不同的Azure功能托管计划中进行选择，以获得最大收益。</p><p id="cb5a" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">消费</strong> <strong class="iw hj">计划:</strong>这个计划最纯粹的形式是无服务器的。您无法控制函数的扩展方式，它会自己做所有的事情。你也可能会遇到所谓的“冷启动”问题。因为您的函数需要在执行代码之前启动，所以不可能立即执行。此外，这个计划中的函数不能运行超过10分钟，而默认的最大运行时间是5分钟。</p><p id="42a5" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">高级计划:</strong>与消费计划非常相似，但具有提供预警功能的特点。这些解决了冷启动问题。但是请记住，这意味着您的函数的一些实例总是在运行，因此会产生成本。此外，这些函数使您能够在不同的计算配置之间进行选择，以尽可能好地满足代码的要求。此外，您还可以获得虚拟网络的支持，您的功能几乎可以不间断地运行(默认值设置为30分钟)</p><p id="685b" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">专用计划:</strong>专用计划与Azure WebApp中的App服务计划相同。您可以精确控制底层计算基础架构以及扩展设置。这个托管计划最适合长时间运行的应用程序。</p><h2 id="fee9" class="lf kd hi bd ke lg lh li ki lj lk ll km jf lm ln kq jj lo lp ku jn lq lr ky ls bi translated"><strong class="ak">触发器</strong></h2><p id="cd6f" class="pw-post-body-paragraph iu iv hi iw b ix la iz ja jb lb jd je jf lc jh ji jj ld jl jm jn le jp jq jr hb bi translated"><a class="ae lt" href="https://docs.microsoft.com/en-us/azure/azure-functions/functions-triggers-bindings?tabs=csharp" rel="noopener ugc nofollow" target="_blank">触发器</a>使功能运行，每个功能都有一个触发器。以下是Azure Functions提供的触发器的非详尽列表:</p><ul class=""><li id="e7ee" class="lu lv hi iw b ix iy jb jc jf lw jj lx jn ly jr lz ma mb mc bi translated">Http触发器</li><li id="8128" class="lu lv hi iw b ix md jb me jf mf jj mg jn mh jr lz ma mb mc bi translated">卡夫卡</li><li id="4d4f" class="lu lv hi iw b ix md jb me jf mf jj mg jn mh jr lz ma mb mc bi translated">活动中心</li><li id="a102" class="lu lv hi iw b ix md jb me jf mf jj mg jn mh jr lz ma mb mc bi translated">宇宙数据库</li><li id="ec06" class="lu lv hi iw b ix md jb me jf mf jj mg jn mh jr lz ma mb mc bi translated">存储帐户</li><li id="fbd2" class="lu lv hi iw b ix md jb me jf mf jj mg jn mh jr lz ma mb mc bi translated">网钩</li></ul><p id="b9c0" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">还有绑定的概念，我会在另一个故事中详细解释。</p><h1 id="32dd" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">演示</h1><p id="0490" class="pw-post-body-paragraph iu iv hi iw b ix la iz ja jb lb jd je jf lc jh ji jj ld jl jm jn le jp jq jr hb bi translated">关于如何部署Azure函数的小教程无疑是对它们最好的理解。我将向您展示如何使用Azure门户创建一个可以由HTTP调用触发的Azure函数，如何在Azure门户内部更改代码以及如何调用该函数。我会选择C#作为我的编程语言，但是代码会非常简单，每个人都能理解。唯一的先决条件是Azure订阅。你也可以在本地开发功能，但这将是以后另一个故事的主题。现在来看看这个小演示:</p><p id="d5a4" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">首先，你必须登录Azure门户网站，然后搜索功能。在那里你选择功能应用。</p><figure class="mj mk ml mm fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mi"><img src="../Images/16b95c2684dbe79d0702c343546841ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2jaji03g-IxuI5vTfrrPjw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">搜索功能</figcaption></figure><p id="e222" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">然后你必须创建一个函数。</p><figure class="mj mk ml mm fd ij er es paragraph-image"><div class="er es mn"><img src="../Images/2149f72c1905e46233867f7258c7241e.png" data-original-src="https://miro.medium.com/v2/resize:fit:902/format:webp/1*qeZmMgxhfTLCvADzxfMrdw.png"/></div></figure><p id="abd1" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在这里，您可以选择功能的配置。选择您的首选订阅，获取一个资源组或创建一个新的资源组，并为您的功能选择一个唯一的名称。(对所有Azure函数名称全局唯一)</p><p id="92db" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">之后，你可以选择是使用代码还是docker容器，你的运行时栈(语言)，版本以及函数应该存放的区域。对于操作系统，你可以在Linux和Windows之间选择，但只有Windows支持在Azure门户内编辑你的代码。之后，你可以选择一个消费计划，这就是你开始所需要的。现在只需按下review + create。在其他选项卡中，您可以控制功能的存储位置(存储帐户)、虚拟网络设置和用于监控的应用洞察(强烈建议用于生产工作负载)。虽然这些都是值得考虑的，但对于这个简单的演示来说并不需要。</p><figure class="mj mk ml mm fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mo"><img src="../Images/bd93e78a847e2506dfecf5aef9cfb2b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M0wWmfd3u7Rx5vQQVHczAA.png"/></div></div></figure><p id="0cc4" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">并再次按创建。</p><figure class="mj mk ml mm fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mp"><img src="../Images/aa2934636802ed8e660c52c39b5f107e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IP3NempzWbJPd4xmQRGdkw.png"/></div></div></figure><p id="943e" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在你应该看到类似这样的东西，你可以看到Azure创建你的服务的进度。</p><figure class="mj mk ml mm fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mq"><img src="../Images/4935a10d6932112ccefd48281867a621.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o6k50Yz4Y4qLTsQwm509jA.png"/></div></div></figure><p id="d292" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在您得到资源已部署的通知后，您可以转到您选择的资源组，并单击您新创建的Azure函数。</p><figure class="mj mk ml mm fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mr"><img src="../Images/526d5e36e537846e6daaaf6870045d8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3M-uRZG-R9Utk5osGX7-jw.png"/></div></div></figure><p id="0871" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在您的资源中，您需要转到Functions并单击Create。</p><figure class="mj mk ml mm fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ms"><img src="../Images/de0a595f4932cbc0db9a97561a2a215d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1rF6RRLdN0-ysHaCj21mbA.png"/></div></div></figure><p id="6984" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这里需要设置以下内容:在门户中开发(默认)，HTTP触发器作为模板，您的函数的名称和授权级别。为了简单起见，我们采用匿名方式，这是通常不推荐的it生产工作流。现在你点击Create，你的第一个函数就生成了。</p><figure class="mj mk ml mm fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mt"><img src="../Images/c90f2f25707a5b7ce9a9d6696acd5eac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*seSJCuLqwKEXgMWKZSAhsw.png"/></div></div></figure><p id="2817" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在这里你可以点击Code + Test，我们可以看到Azure提供的样板代码。当您的函数被调用时，它记录一些内容，将来自HTTP请求的数据存储到names变量中，并返回一个OkObjectResult和一个包含名称的响应消息(如果提供的话)。要测试您的函数，您可以单击获取函数URL按钮并复制URL。</p><figure class="mj mk ml mm fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mu"><img src="../Images/01d865528c47b682571305b7c239cad1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jW8MzFcBMQ0adMADshtmDA.png"/></div></div></figure><p id="f460" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">将此URL粘贴到您的浏览器中，您会看到以下内容:</p><figure class="mj mk ml mm fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mv"><img src="../Images/cfbd4e937e84c235a1f57991739124a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*StT6vYRA61a97A8t-4XUTA.png"/></div></div></figure><p id="b871" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我们也可以像这样在URL的末尾添加名称，然后得到另一个响应。</p><figure class="mj mk ml mm fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mw"><img src="../Images/8616ae14c5b5b313c70e1bf1e7dd5572.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_OuUzzJQ4H2Yfw2DqK_j-Q.png"/></div></div></figure><p id="d6cb" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">重要！</strong>演示结束后删除您的资源。我们没有正确保护我们的环境，如果您的功能保持活动状态，有人可能会调用它们并导致您的订阅费用。要做到这一点，只需选择资源组中的所有相关资源，然后单击delete按钮并确认删除。</p><figure class="mj mk ml mm fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mx"><img src="../Images/30e11bc43db1ea90b54db784fef7c2ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PV4084vXcRB5vanATUwzOQ.png"/></div></div></figure><h1 id="079e" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">结论</h1><p id="f4cd" class="pw-post-body-paragraph iu iv hi iw b ix la iz ja jb lb jd je jf lc jh ji jj ld jl jm jn le jp jq jr hb bi translated">我希望这能帮助你从整体上理解函数，尤其是Azure函数。在接下来的几周/几个月里，我会写更多关于Azure函数的主题，并在本文中链接它们。我想谈谈以下几个话题:</p><div class="my mz ez fb na nb"><a rel="noopener follow" target="_blank" href="/codex/azure-functions-bindings-and-triggers-explained-by-an-example-using-c-229c18295f02"><div class="nc ab dw"><div class="nd ab ne cl cj nf"><h2 class="bd hj fi z dy ng ea eb nh ed ef hh bi translated">Azure函数——通过一个使用C#的例子解释绑定和触发器</h2><div class="ni l"><h3 class="bd b fi z dy ng ea eb nh ed ef dx translated">与其他服务/应用程序的自动化交互是使用Azure功能的主要好处之一。这是…</h3></div><div class="nj l"><p class="bd b fp z dy ng ea eb nh ed ef dx translated">medium.com</p></div></div><div class="nk l"><div class="nl l nm nn no nk np io nb"/></div></div></a></div><ul class=""><li id="59e3" class="lu lv hi iw b ix iy jb jc jf lw jj lx jn ly jr lz ma mb mc bi translated">用VS代码在本地开发Azure函数</li><li id="a761" class="lu lv hi iw b ix md jb me jf mf jj mg jn mh jr lz ma mb mc bi translated">在Azure DevOps中使用CI/CD部署Azure功能</li><li id="d062" class="lu lv hi iw b ix md jb me jf mf jj mg jn mh jr lz ma mb mc bi translated">在Azure函数中处理来自Azure key vault的秘密</li><li id="3c35" class="lu lv hi iw b ix md jb me jf mf jj mg jn mh jr lz ma mb mc bi translated">认证和授权</li><li id="18e2" class="lu lv hi iw b ix md jb me jf mf jj mg jn mh jr lz ma mb mc bi translated">在容器中运行Azure函数</li></ul><p id="a8ae" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">所以如果你对这个话题感兴趣，敬请关注！</p></div></div>    
</body>
</html>