<html>
<head>
<title>I Created a Python Script To Control my ROKU TV</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我创建了一个Python脚本来控制我的ROKU电视</h1>
<blockquote>原文：<a href="https://medium.com/codex/i-created-a-python-script-to-control-my-roku-tv-d8fb0217308?source=collection_archive---------9-----------------------#2022-08-09">https://medium.com/codex/i-created-a-python-script-to-control-my-roku-tv-d8fb0217308?source=collection_archive---------9-----------------------#2022-08-09</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/c9f05e7f2200bf462c3040bda13ee7b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HsZeH6fibKa5DPzMf0tKNg.jpeg"/></div></div></figure><h1 id="f054" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">前言</h1><p id="3890" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">对于那些不知道什么是Roku电视的人来说，这是一种带有软件的电视，可以播放不同的流行流媒体服务，如网飞，Hulu，Disney+等服务。你也可以下载一个应用程序到你的手机上，它可以控制音量、频道、视频输出和屏幕上的移动。虽然我确实发现这个应用程序非常有用，但我经常会发现自己把手从笔记本电脑上拿开，用手机上的应用程序与它互动。因此，就像软件开发人员一样，我创建了一个可以与电视互动的CLI(命令行界面)。这样我就可以更容易地使用这个设备。在这篇文章中，我真的想谈谈我从对产品一无所知到能够通过命令行操作它的过程。</p><p id="6e31" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated"><strong class="jq hj">哦，还有，我将只谈论我如何发现如何使用ROKU设备和脚本中的逻辑部分，GUI和CLI部分将在另一篇文章中讨论。</strong></p><h1 id="f2ca" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">首先，我必须弄清楚它是如何工作的。</h1><p id="9874" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">起初，我不知道Roku平台是如何工作的，所以我用简单的谷歌搜索进行了调查，比如，Roku是如何工作的？Roku如何与app交互？有Roku开发者页面吗？经过几次搜索，我终于找到了这个网页</p><p id="e6f7" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated"><a class="ae kr" href="https://developer.roku.com/docs/developer-program/debugging/external-control-api.md" rel="noopener ugc nofollow" target="_blank">https://developer . Roku . com/docs/developer-program/debugging/external-control-API . MD</a></p><p id="3015" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">这是开发者谈论ECP的一页，该协议允许通过局域网控制设备。经过进一步调查，我发现这些设备可以通过使用特定的URL路由向正确的套接字(套接字表示IP地址和端口号)发出空POST请求来控制。例如，假设您的设备套接字是199.111.255.9:1234，要使设备增加音量，您可以向该套接字发出post请求，URL以VolumeUp结尾。这里有一个例子，我让一个Roku设备增加音量，向下导航，另一个导航回家。我将使用Linux命令curl来实现这一点。</p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="89e7" class="lb ir hi kx b fi lc ld l le lf">curl -d '' "http://199.111.255.9:1234/keypress/VolumeUp"</span><span id="c362" class="lb ir hi kx b fi lg ld l le lf">curl -d '' "http://199.111.255.9:1234/keypress/Down"</span><span id="2f49" class="lb ir hi kx b fi lg ld l le lf">curl -d '' "http://199.111.255.9:1234/keypress/Home"</span></pre><p id="5718" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">如你所见，使用curl和-d标志，控制Roku设备真的很容易。还要注意，post请求的主体中没有任何内容。</p><h1 id="8eef" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">现在是时候构建CLI了！</h1><p id="a34a" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">现在我们知道了如何通过网络控制ROKU电视，是时候让它在python脚本中工作了。这样，我就不必经常单独使用curl命令来操作电视了。</p><p id="ffd8" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">首先，我想想出让一切正常工作的逻辑。我想创建一个概念证明，所以我从创建命令并确保它们工作开始。我决定在python类中创建方法，然后将该类绑定到一个变量以便于访问。我还想使用try，除了用于简单故障排除的语句。总而言之，我最后想出了这个。</p><figure class="ks kt ku kv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lh"><img src="../Images/0735d811ad89f56ab27b5dbb926c8371.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z_EA4qqsL9UutedIUEF9kg.png"/></div></div></figure><p id="ed34" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">我需要导入OS命令，因为CURL依赖于Linux操作系统。然后，我将该类初始化为一个变量，使用该方法，它工作了！从这里开始，整个过程变得简单了。</p><h1 id="6687" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">简单！现在我将添加更多的命令和类属性。</h1><p id="5b99" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">现在我们已经证明了我们的概念证明，一切都变得简单了，我只需添加更多的命令来实现我想要ROKU设备做的事情，如移动和音量。我还想在类中添加引用设备IP地址和端口的属性。总之，看起来是这样的。我觉得很好很整洁。</p><figure class="ks kt ku kv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lh"><img src="../Images/6782be0ebfec6e84d45fe8cced262455.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hlXbnsCLVO6Lclun12V0Zg.png"/></div></div></figure><h1 id="bbf8" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">是时候结束一切了。</h1><p id="bcae" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">现在大部分逻辑都完成了，是时候将类绑定到变量并使其运行了。首先，我创建了一个名为my_device的变量，并把它赋给了这个类，同时像这样给出了Ip地址和端口号的参数。</p><p id="85d1" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated"><code class="du li lj lk kx b">my_device = Roku ('112.111.647.9', '1234')</code></p><p id="a78b" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">就像我说的，我只想回顾一下使用这项技术的发现，以及我是如何让它与python一起工作的。如果你有兴趣看完整的源代码，我在下面附上了GUI和CLI的链接。</p><h1 id="522d" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">谢谢你看我的文章！</h1><p id="ae46" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">这个项目的源代码包含一个实际的CLI和我创建的GUI。我只想回顾一下准系统项目和这里的主要逻辑。</p><p id="8523" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated"><strong class="jq hj">另外，你可以在</strong> <a class="ae kr" href="https://github.com/Davidfree2/roku_tv" rel="noopener ugc nofollow" target="_blank"> <strong class="jq hj">大卫自由2/roku </strong> </a> <strong class="jq hj"> _tv </strong>这里查看</p><p id="13d3" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">一如既往地感谢您的阅读！我希望你觉得这篇文章很有趣，并在这个过程中学到了一些东西。如果你觉得我遗漏了什么，请在下面评论，或者直接给我发消息。如果你觉得这篇文章内容丰富，也留下你的关注吧！:)</p><h1 id="464d" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">我最近在忙什么。</h1><p id="d6f6" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">我的名字大卫和我已经从事软件web开发大约两年了。大多是自由职业者的工作。我知道Python，JavaScript，Bash，CSS，HTML，PostgreSQL，MongoDB，还有很多其他的技术。如果你想联系我，请到davidesquerra.com来找我。在这个网站上，你可以直接给我发短信或电子邮件。就像我上面说的感谢阅读:)。</p></div></div>    
</body>
</html>