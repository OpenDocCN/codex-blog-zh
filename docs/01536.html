<html>
<head>
<title>Survival Analysis: Part II</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">生存分析:第二部分</h1>
<blockquote>原文：<a href="https://medium.com/codex/survival-analysis-part-ii-ddbbae048d3f?source=collection_archive---------11-----------------------#2021-05-10">https://medium.com/codex/survival-analysis-part-ii-ddbbae048d3f?source=collection_archive---------11-----------------------#2021-05-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/bc3be673f0dd6ade976d9cd250283858.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*AMHAHYwEFBjzwQq9"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">凯尔·格伦在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="9edb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在本帖中，我们将回顾如何将我们在<a class="ae iu" rel="noopener" href="/mlearning-ai/survival-analysis-part-i-7a84fd270644">第一部分</a>中讨论的生存情节和模型付诸实践，学习中最有趣的部分是它的实际实施。首先，让我们看看我们的数据集并理解。</p><p id="120d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这个数据集是关于前列腺癌的:</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jt"><img src="../Images/cdbc0e52ef05e0d515706bb93554e9b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oH0I9s2JO7X0XHRYPe9_Tg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">数据集的前几行</figcaption></figure><p id="e5a0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">列的详细信息:</p><ul class=""><li id="6e4a" class="jy jz hi ix b iy iz jc jd jg ka jk kb jo kc js kd ke kf kg bi translated"><strong class="ix hj">患者:</strong>患者的唯一id</li><li id="1a53" class="jy jz hi ix b iy kh jc ki jg kj jk kk jo kl js kd ke kf kg bi translated"><strong class="ix hj">治疗:</strong>治疗有1型和2型两种。</li><li id="3157" class="jy jz hi ix b iy kh jc ki jg kj jk kk jo kl js kd ke kf kg bi translated"><strong class="ix hj">状态:</strong>包含数据的数据帧中事件状态的状态称为前列腺癌。</li><li id="17af" class="jy jz hi ix b iy kh jc ki jg kj jk kk jo kl js kd ke kf kg bi translated"><strong class="ix hj">时间:</strong>时间以一个时间分量进入状态列。</li><li id="b009" class="jy jz hi ix b iy kh jc ki jg kj jk kk jo kl js kd ke kf kg bi translated"><strong class="ix hj">年龄</strong>是患者的年龄。</li><li id="8cc5" class="jy jz hi ix b iy kh jc ki jg kj jk kk jo kl js kd ke kf kg bi translated"><strong class="ix hj">大小:</strong>癌瘤大小。</li></ul><p id="04ab" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我在R中执行分析，为了生存分析，我们需要安装某些库:</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jt"><img src="../Images/3eeae1362cc1df7dcb49fd0a1229c974.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vam_8QPEsF66RwPKkj0CVA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">在r中安装所需的库。</figcaption></figure><p id="e55e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们来看看时间和状态，</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jt"><img src="../Images/972c3f0822be6472ddb352f9775dc85e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K7vi2l7ejy0UGB0cCxvI6Q.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">surv函数的结果</figcaption></figure><p id="59a2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">从上面，我们看到一些观察结果的末尾有一个加号，加号表示删截。这是一个标准的操作程序和生存分析，状态栏用0或1表示。1将事件编码为0表示审查遵循该约定，并相应地标记数据。</p><ol class=""><li id="b96c" class="jy jz hi ix b iy iz jc jd jg ka jk kb jo kc js km ke kf kg bi translated"><strong class="ix hj">卡普兰·迈耶情节</strong></li></ol><p id="6174" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这个生存适应模型。我们不能直接打包成一个图来得到卡普兰迈耶图。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jt"><img src="../Images/5d84689f11730fee8b37f9c6c33359d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IXYivNsKqflGO78OTyew1g.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">卡普兰·迈耶图代码</figcaption></figure><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jt"><img src="../Images/220913633ebfaaa1e03636f8228335b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U_uGwHLbVNkz-SIJ_f0WUg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">前列腺癌卡普兰迈耶图</figcaption></figure><ul class=""><li id="0c13" class="jy jz hi ix b iy iz jc jd jg ka jk kb jo kc js kd ke kf kg bi translated">时间显示在<em class="kn"> x轴</em>上。生存概率显示在<em class="kn"> y轴</em>上，以月为单位。我们有审查事件，用这些符号表示。</li><li id="1185" class="jy jz hi ix b iy kh jc ki jg kj jk kk jo kl js kd ke kf kg bi translated">我们将这种影响添加到图中，因为我们设置了标记时间为真，我们用这些步骤表示死亡事件，每一步都显示存活概率的下降。</li><li id="0e71" class="jy jz hi ix b iy kh jc ki jg kj jk kk jo kl js kd ke kf kg bi translated">该图也有95%的置信区间。因为上下波段实际上是整个图。</li></ul><p id="c859" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> 2。分层卡普兰迈耶图</strong></p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jt"><img src="../Images/d20138ac3e4e1732925099422dda2033.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U_h8tdoq8FlXXeogrh5njg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">前列腺癌的分层Kaplan Meier图</figcaption></figure><ul class=""><li id="5273" class="jy jz hi ix b iy iz jc jd jg ka jk kb jo kc js kd ke kf kg bi translated">我们可以容易地识别哪条线属于哪个处理组。在这种情况下，很明显治疗2有更好的生存机会。</li><li id="2c9b" class="jy jz hi ix b iy kh jc ki jg kj jk kk jo kl js kd ke kf kg bi translated">例如，在40个月时，治疗组1已经低至大约70%的存活率，而替代组仍然高达95%。</li><li id="9ba8" class="jy jz hi ix b iy kh jc ki jg kj jk kk jo kl js kd ke kf kg bi translated">现在，大约65个月后，曲线彼此接近，概率相等。此外，注意治疗1的置信区间相当宽。</li></ul><p id="e853" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">3.<strong class="ix hj">对数秩检验</strong></p><p id="90fb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">当我们实际上想知道两个治疗组之间是否有显著的生存差异时。这些组在治疗栏中进行标识。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jt"><img src="../Images/938ea5965ca705e0714100d5eef47fc9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l9jxxufIw138E0okimaOpw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">对数秩检验的Survdif函数</figcaption></figure><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jt"><img src="../Images/1750cbe3369626c64f68fe1e354495ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9P9BCn9LlCOG1G0vdkv93A.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">日志等级的结果</figcaption></figure><ul class=""><li id="09de" class="jy jz hi ix b iy iz jc jd jg ka jk kb jo kc js kd ke kf kg bi translated">在这种情况下，p值不重要。这意味着我们必须坚持零假设，即两个治疗组的存活率没有差异。</li><li id="22ea" class="jy jz hi ix b iy kh jc ki jg kj jk kk jo kl js kd ke kf kg bi translated">我们得到了每组的受试者总数。我们得到每组观察到的事件数量，以及从观察到的数量得到的预期事件。</li><li id="ad61" class="jy jz hi ix b iy kh jc ki jg kj jk kk jo kl js kd ke kf kg bi translated">现在从prost$treatment开始，我们计算每组的卡方统计量以及每组的方差。</li><li id="2167" class="jy jz hi ix b iy kh jc ki jg kj jk kk jo kl js kd ke kf kg bi translated">所以我们可以看到，实际上比较这两组的生存概率是相当简单的</li></ul><p id="1ee8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">4.<strong class="ix hj"> Cox比例风险模型和参数模型</strong></p><p id="6a09" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Cox比例风险方法的最终目的是注意我们数据集中的不同因素(协变量)如何影响感兴趣的事件。</p><ul class=""><li id="469c" class="jy jz hi ix b iy iz jc jd jg ka jk kb jo kc js kd ke kf kg bi translated"><strong class="ix hj"> <em class="kn">危险率</em> </strong>:事件发生所需时间的概率估计。</li><li id="9e74" class="jy jz hi ix b iy kh jc ki jg kj jk kk jo kl js kd ke kf kg bi translated"><strong class="ix hj"> <em class="kn">协变量:</em> </strong>确实存在影响事件发生概率的外部因素。在比例风险模型中，这些外部因素被称为协方差。</li><li id="a2ab" class="jy jz hi ix b iy kh jc ki jg kj jk kk jo kl js kd ke kf kg bi translated"><strong class="ix hj"> <em class="kn">一致性:</em> </strong>它告诉我们从两个随机选择的观察值中选择一个风险较高的观察值的正确几率。</li><li id="d914" class="jy jz hi ix b iy kh jc ki jg kj jk kk jo kl js kd ke kf kg bi translated">现在简而言之，我们希望尽可能接近一致。低于零点五的都是很差的型号。</li><li id="e5cf" class="jy jz hi ix b iy kh jc ki jg kj jk kk jo kl js kd ke kf kg bi translated">exp(bi)值称为危险比(HR)。HR大于1表明，随着ith协变量的值增加，事件风险增加，因此生存时间减少。</li></ul><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es ko"><img src="../Images/19f40e034a0ecccc1b640576cd5fa813.png" data-original-src="https://miro.medium.com/v2/resize:fit:1316/format:webp/1*h8nzzA-kANL83kBwMMWV8w.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">风险比的影响</figcaption></figure><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kp"><img src="../Images/d2c8db116cd2b970e595b101b671530c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p7i5nKLpHAcwuxtSPSjviQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">Cox比例风险模型的结果</figcaption></figure><ul class=""><li id="629e" class="jy jz hi ix b iy iz jc jd jg ka jk kb jo kc js kd ke kf kg bi translated">从我们的Cox模型中，如果我们检查汇总输出，我们首先会看到模型公式和事件数与观察总数的对比。</li><li id="e3da" class="jy jz hi ix b iy kh jc ki jg kj jk kk jo kl js kd ke kf kg bi translated">我们在这里有所有的协方差，包括它们的模型系数，对墙壁的预测和显著性。</li><li id="e845" class="jy jz hi ix b iy kh jc ki jg kj jk kk jo kl js kd ke kf kg bi translated">带有p值的星表明这些协方差对模型是重要的。</li><li id="9734" class="jy jz hi ix b iy kh jc ki jg kj jk kk jo kl js kd ke kf kg bi translated">在我们的例子中，我们有两个重要的变量H size和index，特别是因为index变量对模型很重要。</li><li id="219e" class="jy jz hi ix b iy kh jc ki jg kj jk kk jo kl js kd ke kf kg bi translated">这些信息实际上非常有趣，因为有了这些信息，我们可以简化模型，并可能从模型中消除不感兴趣的协方差。</li></ul><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kq"><img src="../Images/8b55d8fef84c7863e09082cce13f555f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l43_6LI667132wMzxyXBpw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">人力资源的卡普兰迈耶图</figcaption></figure><p id="3364" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> 5。生存树</strong></p><ul class=""><li id="6e34" class="jy jz hi ix b iy iz jc jd jg ka jk kb jo kc js kd ke kf kg bi translated">生存分析之类的学科生存树是根据生存数据拟合的决策树，它允许使用协方差，就像在Cox比例风险回归模型中一样。</li><li id="1c5b" class="jy jz hi ix b iy kh jc ki jg kj jk kk jo kl js kd ke kf kg bi translated">结果我们实际上是在模拟我们的生存概率，你们中的很多人已经知道决策树，或者至少已经清楚地看到了它们。</li><li id="2ee8" class="jy jz hi ix b iy kh jc ki jg kj jk kk jo kl js kd ke kf kg bi translated">通常，您会看到这种决策树的可视化表示本质上是一个类似流程图的结构，其中每个内部节点代表一个选定变量的测试。</li><li id="b58a" class="jy jz hi ix b iy kh jc ki jg kj jk kk jo kl js kd ke kf kg bi translated">我们必须在x轴上加上时间，y轴上是平均存活概率。</li></ul><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jt"><img src="../Images/a5321f417b53542054bde939d20a8799.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bgvsiTnhEOqBLZialn_jPw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">生存树的Ranger函数</figcaption></figure><p id="99b9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">y轴是生存概率，x轴是以月为单位的时间。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kr"><img src="../Images/df457bc63032452e1f7a1e4d2bc64f8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SGzhc2VhVb7c3gMOXTqnmg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">基于树的模型的生存曲线</figcaption></figure><p id="40dd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">前列腺癌数据集的生存研究到此结束。希望已经为你阐明了生存分析的原理。</p><p id="1d5a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">希望这有所帮助:)如果你喜欢我的帖子，请关注我。请随时留下任何澄清或问题的意见。快乐学习😃</p><p id="ee88" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">随意连接:<a class="ae iu" href="https://www.linkedin.com/in/afaf-athar-183621105/" rel="noopener ugc nofollow" target="_blank"> <em class="kn"> LinkedIn </em> </a></p></div></div>    
</body>
</html>