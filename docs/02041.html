<html>
<head>
<title>Netlify CMS for Jekyll Site</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Jekyll站点的Netlify CMS</h1>
<blockquote>原文：<a href="https://medium.com/codex/netlify-cms-for-jekyll-site-31f728ac61c7?source=collection_archive---------5-----------------------#2021-06-25">https://medium.com/codex/netlify-cms-for-jekyll-site-31f728ac61c7?source=collection_archive---------5-----------------------#2021-06-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="4e18" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">设置和配置概述</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/ed2d32b7df0a5cad7ec058f8d73ebf85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ZPL4Zrppht99tdA2"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">图片来源:<a class="ae jt" href="https://commons.wikimedia.org/wiki/File:Netlify_CMS_logo.svg" rel="noopener ugc nofollow" target="_blank">维基共享资源</a></figcaption></figure><h2 id="64b7" class="ju jv hi bd jw jx jy jz ka kb kc kd ke iq kf kg kh iu ki kj kk iy kl km kn ko bi translated">易于集成</h2><p id="127e" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">Netlify CMS是一个很好的选择，可以创建一个可定制的模板来编辑Jekyll站点上的内容。这是一个开源的React应用程序，提供了编辑和添加文本和/或媒体到您的站点的功能，并提供了实时预览。通过UI小部件和插件，有各种各样的定制选项。</p><p id="c2e4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一旦您的Netlify站点连接到您的项目的GitHub repo，您还可以预览pull请求和CMS编辑器页面。</p><h2 id="3913" class="ju jv hi bd jw jx jy jz ka kb kc kd ke iq kf kg kh iu ki kj kk iy kl km kn ko bi translated">配置</h2><p id="361f" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">最快的入门方法是使用一个<a class="ae jt" href="https://www.netlifycms.org/docs/start-with-a-template/" rel="noopener ugc nofollow" target="_blank">模板</a>。然而，如果你已经有了一个现有的网站，你会想要按照这个<a class="ae jt" href="https://www.netlifycms.org/docs/add-to-your-site" rel="noopener ugc nofollow" target="_blank">教程</a>来熟悉这个过程。在本文中，我们将扩展其中包含的概念和步骤。</p><p id="e961" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在深入研究之前，请确保您的Netlify站点已连接到您项目的repo。您可以登录您的Netlify帐户，选择您正在工作的当前站点，单击左侧的Build &amp; Deploy选项卡，并将GitHub repo URL添加到Build settings中的Repository字段。</p><p id="52d4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在那里，继续将“jekyll build”添加到构建命令字段，并将“_site/”添加到发布目录。因为静态站点的内容是在每次提供之前生成的，所以我们希望在用户导航到您的站点时运行jekyll build命令。发布目录告诉Netlify从哪个文件夹读取站点内容。_site文件夹是一个自动生成的文件夹，包含处理Jekyll Liquid和显示我们的站点内容所需的所有源代码。</p><p id="eb8a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了让其他用户能够访问CMS编辑器，我们需要调整Identity部分的一些设置。默认情况下，在当前计费周期内，您最多可以有1，000个活动用户。在注册首选项下，您可以选择保持注册开放，这意味着任何人都可以创建一个电子邮件帐户，并登录到网站进行更改。一个更安全的选择是让注册只邀请，这将允许您通过电子邮件发送邀请给一组选定的人。你可以在这里阅读更多关于添加身份用户<a class="ae jt" href="https://docs.netlify.com/visitor-access/identity/registration-login/#registration-forms" rel="noopener ugc nofollow" target="_blank">的细节。</a></p><h2 id="3186" class="ju jv hi bd jw jx jy jz ka kb kc kd ke iq kf kg kh iu ki kj kk iy kl km kn ko bi translated">源代码格式</h2><p id="4e73" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">此时，我们需要对源代码进行一些修改。你要做的第一件事是确保你的项目使用标准的Jekyll站点文件结构。你可以在这里阅读更多关于Jekyll的文档。你也可以看看我以前的博客，<a class="ae jt" href="https://lauren-cun.medium.com/create-a-static-site-with-jekyll-b223b0e063c3" rel="noopener">用Jekyll </a>创建一个静态站点了解更多细节。</p><p id="4e28" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，在根目录下需要一个admin文件夹，其中包含一个index.html和config.yml文件。在index.html内部，您将需要添加一些类似如下的代码来为您的CMS编辑器创建一个UI。</p><pre class="je jf jg jh fd ku kv kw kx aw ky bi"><span id="5e93" class="ju jv hi kv b fi kz la l lb lc">&lt;!doctype html&gt;<br/>&lt;html&gt;<br/>&lt;head&gt;<br/>  &lt;meta charset="utf-8" /&gt;<br/>  &lt;meta name="viewport" content="width=device-width, initial-scale=1.0" /&gt;<br/>  &lt;title&gt;Site Content Manager&lt;/title&gt;<br/>  &lt;script src="https://identity.netlify.com/v1/netlify-identity-widget.js"&gt;&lt;/script&gt;<br/>&lt;/head&gt;</span><span id="3eb8" class="ju jv hi kv b fi ld la l lb lc">&lt;body&gt;<br/>&lt;!-- Include the script that builds page and powers Netlify CMS --&gt;<br/>  &lt;script src="https://unpkg.com/netlify-cms@^2.0.0/dist/netlify-cms.js"&gt;&lt;/script&gt;<br/>&lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="3f19" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">config.yml是我们存放一些后端配置以及您希望能够编辑的内容的详细信息的地方。该文件的开头通常如下所示:</p><pre class="je jf jg jh fd ku kv kw kx aw ky bi"><span id="9b3d" class="ju jv hi kv b fi kz la l lb lc">backend:<br/>  name: git-gateway<br/>  branch: master<br/>  identity_url: "https://yoursite.com/.netlify/identity"<br/>  gateway_url: "https://yoursite.com/.netlify/git"<br/>  squash_merges: true<br/><br/>publish_mode: editorial_workflow<br/>media_folder: "assets/img/uploads"<br/><br/>site_url: https://yoursite.com<br/>logo_url: https://yoursite.com/assets/img/logo.svg</span></pre><p id="8cd3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">需要注意的是，YAML对缩进的要求非常严格。如果您没有正确地缩进，您肯定会遇到一些语法错误，并且无法访问编辑器。</p><p id="aaa9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">描述后端的顶部链接了保存项目repo的Netlify git-gateway，定义了部署分支、身份和网关url。</p><p id="119e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">将发布模式设置为编辑工作流允许我们在将这些更改提交到实时站点之前，将草稿保存为GitHub中的拉请求。</p><p id="9142" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">媒体文件夹定义了可以在CMS中查看、删除和添加图像和其他资产的位置。确保它指向源代码中存储资产的文件夹。</p><p id="c97a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">授权用户可以通过将/admin添加到网站的主页url来访问CMS编辑器。由于用户登录到CMS后的默认行为是导航回站点的主页，所以我们想在项目根目录下的index.html中添加一个脚本，在授权用户登录时将浏览器窗口推送到编辑器。</p><pre class="je jf jg jh fd ku kv kw kx aw ky bi"><span id="91ed" class="ju jv hi kv b fi kz la l lb lc">&lt;script&gt;<br/>  if (window.netlifyIdentity) {<br/>    window.netlifyIdentity.on("init", user =&gt; {<br/>      if (!user) {<br/>        window.netlifyIdentity.on("login", () =&gt; {<br/>          document.location.href = "/admin/";<br/>        });<br/>      }<br/>    });<br/>  }<br/>&lt;/script&gt;</span></pre><h2 id="9136" class="ju jv hi bd jw jx jy jz ka kb kc kd ke iq kf kg kh iu ki kj kk iy kl km kn ko bi translated">映射可编辑内容</h2><p id="e6b1" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">现在，您应该能够登录并查看CMS编辑器页面了。然而，您可能会注意到没有可编辑的字段，也没有显示预览。这是因为我们还没有完成在config.yml文件中映射可编辑内容的重要工作。</p><p id="dda0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">希望您已经阅读了关于文件结构的Jekyll文档，并且至少对文章、页面和集合的概念有一点熟悉。我们将使用现有帖子、页面和收藏的标签来编辑前端内容以及添加新数据。</p><p id="8351" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面是一个示例，说明如何在config.yml文件中，在之前编写的配置设置下，为博客文章设置可编辑的内容。</p><pre class="je jf jg jh fd ku kv kw kx aw ky bi"><span id="bb8e" class="ju jv hi kv b fi kz la l lb lc">collections:  <br/> - name: "blog"    <br/>   label: "Blog"    <br/>   folder: "_posts/"    <br/>   create: true # Allow users to create new documents  <br/>   slug: "{{year}}-{{month}}-{{day}}-{{slug}}"<br/>   editor:      <br/>    preview: false    <br/>   fields: # The fields for each document, usually in front matter         <br/>     - { label: "Layout", <br/>         name: "layout", <br/>         widget: "hidden", <br/>         default: "post" }      <br/>     - { label: "Title", name: "title", widget: "string" }      <br/>     - { label: "Publish Date", name: "date", widget: "datetime" }      <br/>     - { label: "Author",          <br/>         name: "author",          <br/>         widget: "relation",          <br/>         collection: "authors",          <br/>         displayFields: [display_name],          <br/>         searchFields: [display_name],          <br/>         valueField: "name", }      <br/>      - { label: "Body", name: "body", widget: "markdown" }</span></pre><p id="9153" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">小部件定义了我们在一个字段中期望的内容类型。例如，如果您使用一个图像小部件，那么该字段中会出现一个框，其中有一个按钮供用户上传图像。relation小部件从另一个集合中获取信息。你可以在这里找到可用小工具<a class="ae jt" href="https://www.netlifycms.org/docs/widgets/#list" rel="noopener ugc nofollow" target="_blank">的完整列表。</a></p><h2 id="9f18" class="ju jv hi bd jw jx jy jz ka kb kc kd ke iq kf kg kh iu ki kj kk iy kl km kn ko bi translated">额外资源</h2><p id="b961" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">Netlify提供了相当多的关于设置CMS的文档。他们甚至提供与现有Jekyll网站<a class="ae jt" href="https://www.netlifycms.org/docs/jekyll/" rel="noopener ugc nofollow" target="_blank">整合的指南。和往常一样，我鼓励您更深入地阅读文档，并做一些教程来接触源代码示例。最好的学习方法是实践！下面再给你一些参考，供你探讨。</a></p></div><div class="ab cl le lf gp lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="hb hc hd he hf"><p id="0b84" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jt" href="https://cms-demo.netlify.com/#/collections/kitchenSink" rel="noopener ugc nofollow" target="_blank"> <em class="ll"> Netlify CMS演示</em> </a></p><p id="aa99" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jt" href="https://github.com/adamwatters/jekyll-tutorial-with-netlify-cms" rel="noopener ugc nofollow" target="_blank"> <em class="ll"> Jekyll教程带Netlify CMS库</em> </a></p><p id="b703" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jt" href="https://github.com/NickStees/jekyll-cms" rel="noopener ugc nofollow" target="_blank"> <em class="ll"> Jekyll CMS源代码示例</em> </a></p><p id="ce8f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jt" href="https://www.dwolla.com/updates/implementing-netlify-cms/" rel="noopener ugc nofollow" target="_blank"><em class="ll">3天后实施CMS</em></a></p></div></div>    
</body>
</html>