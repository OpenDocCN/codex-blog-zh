<html>
<head>
<title>Deploying a Kotlin app to Heroku (a Slack bot)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">å°†Kotlinåº”ç”¨ç¨‹åºéƒ¨ç½²åˆ°Heroku(ä¸€ä¸ªSlackæœºå™¨äºº)</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/codex/creating-a-slack-bot-kotlin-and-deploying-it-in-heroku-32f884e39bea?source=collection_archive---------8-----------------------#2022-05-19">https://medium.com/codex/creating-a-slack-bot-kotlin-and-deploying-it-in-heroku-32f884e39bea?source=collection_archive---------8-----------------------#2022-05-19</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="96dc" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">è¿™æ˜¯åˆ›å»ºå’Œéƒ¨ç½²å›å¤Slackå‘½ä»¤çš„åº”ç”¨ç¨‹åºæ‰€éœ€çš„æœ€ä½è¦æ±‚ã€‚</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/f5a26f273f6225f50773636c1c9cbab6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*VM9P4DjjNwwcVyKx"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">ç…§ç‰‡ç”±<a class="ae jn" href="https://unsplash.com/es/@brett_jordan?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">å¸ƒé›·ç‰¹Â·ä¹”ä¸¹</a>åœ¨<a class="ae jn" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>ä¸Šæ‹æ‘„</figcaption></figure><p id="5201" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">ğŸ“<em class="kk">æ‚¨å¯èƒ½è¿˜æƒ³å­¦ä¹ å¦‚ä½•å°†Kotlinåº”ç”¨ç¨‹åºéƒ¨ç½²åˆ°Railway </em>  <em class="kk">ã€‚</em></p><h1 id="851b" class="kl km hi bd kn ko kp kq kr ks kt ku kv io kw ip kx ir ky is kz iu la iv lb lc bi translated">1.åˆå§‹åŒ–é¡¹ç›®</h1><ol class=""><li id="4586" class="ld le hi jq b jr lf ju lg jx lh kb li kf lj kj lk ll lm ln bi translated"><a class="ae jn" href="https://lsoares.medium.com/kotlin-gradle-junit-starter-project-a113a2cc9cbb" rel="noopener"> <strong class="jq hj">åˆ›å»ºæ–°çš„Kotliné¡¹ç›®</strong> </a> <strong class="jq hj">ã€‚</strong></li><li id="2e08" class="ld le hi jq b jr lo ju lp jx lq kb lr kf ls kj lk ll lm ln bi translated">å¦‚æœä½ è¿˜æ²¡æœ‰åš<code class="du lt lu lv lw b">git init</code>ï¼Œä½ åº”è¯¥ç°åœ¨å°±åšã€‚Herokuéœ€è¦Gitï¼Œè¿™æ ·ä½ å°±å¯ä»¥è½»æ¾åœ°å°†å®ƒéƒ¨ç½²åˆ°Herokuã€‚</li><li id="6862" class="ld le hi jq b jr lo ju lp jx lq kb lr kf ls kj lk ll lm ln bi translated">ç¡®ä¿åœ¨æ ¹ç›®å½•ä¸‹æœ‰ä¸€ä¸ª<code class="du lt lu lv lw b">.gitignore</code>æ–‡ä»¶ï¼ŒåŒ…å«:</li></ol><pre class="iy iz ja jb fd lx lw ly lz aw ma bi"><span id="35e2" class="mb km hi lw b fi mc md l me mf">/.gradle<br/>/.idea<br/>/build</span></pre><h1 id="77ae" class="kl km hi bd kn ko kp kq kr ks kt ku kv io kw ip kx ir ky is kz iu la iv lb lc bi translated">2.Herokuåº”ç”¨ç¨‹åº</h1><p id="6d80" class="pw-post-body-paragraph jo jp hi jq b jr lf ij jt ju lg im jw jx mg jz ka kb mh kd ke kf mi kh ki kj hb bi translated">æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªHerokuåº”ç”¨ç¨‹åºï¼Œä¸ºä¹‹å‰åˆ›å»ºçš„Kotlinåº”ç”¨ç¨‹åºæä¾›æœåŠ¡ã€‚è¿™æ˜¯åŸºäºå®˜æ–¹çš„è‹±é›„æ–‡çŒ®ã€‚</p><ol class=""><li id="3807" class="ld le hi jq b jr js ju jv jx mj kb mk kf ml kj lk ll lm ln bi translated">å®‰è£…Heroku CLI ã€‚è¿™æä¾›äº†ä¸€ç§ä¸Herokuäº’åŠ¨çš„å¿«æ·æ–¹å¼â€”â€”ä½¿ç”¨ç»ˆç«¯ã€‚</li><li id="2e60" class="ld le hi jq b jr lo ju lp jx lq kb lr kf ls kj lk ll lm ln bi translated">é€šè¿‡è¿è¡Œåˆ›å»ºä¸€ä¸ªHeroku APP:<br/><code class="du lt lu lv lw b">heroku apps:create <strong class="jq hj">HEROKU_APP_NAME</strong></code><br/><em class="kk">Heroku _ APP _ NAMEéœ€è¦å”¯ä¸€ã€‚è¿™å°†æŠŠå½“å‰çš„Gitå­˜å‚¨åº“ç»‘å®šåˆ°Herokuåº”ç”¨ç¨‹åºã€‚å¯ä»¥åœ¨</em> <a class="ae jn" href="https://dashboard.heroku.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="jq hj"> <em class="kk"> Herokuä»ªè¡¨ç›˜</em> </strong> </a> <em class="kk">ç¡®è®¤appå­˜åœ¨ã€‚æ‚¨å¯ä»¥é€šè¿‡åœ¨ç»ˆç«¯ä¸­è¿è¡Œ</em> <code class="du lt lu lv lw b"><em class="kk">git remote -v</em></code> <em class="kk">æ¥æ£€æŸ¥Gitçš„è®¾ç½®ã€‚</em></li><li id="c676" class="ld le hi jq b jr lo ju lp jx lq kb lr kf ls kj lk ll lm ln bi translated">åœ¨Kotlin appçš„æ ¹æ–‡ä»¶å¤¹ä¸‹ï¼Œåˆ›å»ºä¸€ä¸ªåä¸º<code class="du lt lu lv lw b">Procfile</code>çš„æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹:<br/> <code class="du lt lu lv lw b">web: java -jar build/libs/<strong class="jq hj">PROJ_ID</strong>-1.0-SNAPSHOT-all.jar</code> <br/>(è¦è·å–<code class="du lt lu lv lw b">PROJ_ID</code>ï¼Œå‹¾é€‰<code class="du lt lu lv lw b">settings.gradle.kts</code>)ã€‚<br/> <em class="kk">è¿™ä»£è¡¨Herokuè¿è¡Œä»¥å¯åŠ¨webåº”ç”¨ç¨‹åºçš„å‘½ä»¤ã€‚</em></li><li id="429f" class="ld le hi jq b jr lo ju lp jx lq kb lr kf ls kj lk ll lm ln bi translated"><em class="kk"> Herokuéœ€è¦ä¸€ä¸ª</em> <code class="du lt lu lv lw b"><em class="kk">stage</em></code> <em class="kk">ç›®æ ‡ã€‚</em>åœ¨<code class="du lt lu lv lw b">build.gradle.kts</code>çš„åº•éƒ¨ï¼Œæ·»åŠ :</li></ol><pre class="iy iz ja jb fd lx lw mm bn mn mo bi"><span id="1571" class="mp km hi lw b be mq mr l ms mf">task("stage") {<br/>    dependsOn("shadowJar")<br/>}</span></pre><h1 id="bb89" class="kl km hi bd kn ko kp kq kr ks kt ku kv io kw ip kx ir ky is kz iu la iv lb lc bi translated">3.æ¾å¼›èºæ “åº”ç”¨ç¨‹åº</h1><ol class=""><li id="e9fa" class="ld le hi jq b jr lf ju lg jx lh kb li kf lj kj lk ll lm ln bi translated">å°†ä»¥ä¸‹ä¾èµ–é¡¹æ·»åŠ åˆ°<code class="du lt lu lv lw b">build.gradle.kts</code>:</li></ol><pre class="iy iz ja jb fd lx lw mm bn mn mo bi"><span id="de9c" class="mp km hi lw b be mq mr l ms mf">dependencies {<br/>  implementation("org.slf4j:slf4j-simple:1.+") <br/>  implementation("com.slack.api:bolt:1.+")<br/>  implementation("com.slack.api:bolt-servlet:1.+")<br/>  implementation("com.slack.api:bolt-jetty:1.+")<br/>}</span></pre><p id="1ba7" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">2.æ·»åŠ Gradle Shadow <code class="du lt lu lv lw b">build.gradle.kts</code> ( <em class="kk">è¿™å°†å…è®¸åˆ›å»ºä¸€ä¸ªå•ç‹¬çš„fat jarï¼Œç¨åå¯ä»¥åœ¨Heroku </em>ä¸­è¿è¡Œ):</p><pre class="iy iz ja jb fd lx lw mm bn mn mo bi"><span id="9d37" class="mp km hi lw b be mq mr l ms mf">plugins {<br/>   id("com.github.johnrengelman.shadow") version "7.+"<br/>   application<br/>}<br/>// at the bottom:<br/>application {<br/>    mainClass.set("SlackMainKt")<br/>}</span></pre><p id="ee02" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">ğŸ“<em class="kk">æ‚¨å¯èƒ½éœ€è¦å•å‡»IDEä¸­æ–‡ä»¶å³ä¸Šè§’çš„æŒ‰é’®æ¥åˆ·æ–°Gradleã€‚</em></p><p id="29a4" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">3.åœ¨<code class="du lt lu lv lw b">src/main/kotlin/SlackMain.kt</code>ï¼Œæ”¾:</p><pre class="iy iz ja jb fd lx lw mm bn mn mo bi"><span id="4bc4" class="mp km hi lw b be mq mr l ms mf">fun main() {<br/>   val app = App()<br/>   app.command("/hello") { _, _ -&gt;<br/>      Response.ok("world")<br/>   }<br/>   SlackAppServer(app, getenv("PORT")?.toInt() ?: 8080)<br/>       .start()<br/>}</span></pre><p id="4368" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">ğŸ“<code class="du lt lu lv lw b"><em class="kk">PORT</em></code> <em class="kk">æ˜¯Herokuæä¾›çš„ç¯å¢ƒå˜é‡ã€‚å®ƒä»£è¡¨Herokuå…¬å¼€çš„ç«¯å£ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦åœ¨è¯¥ç«¯å£æä¾›æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºã€‚</em></p><p id="caa7" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">4.æäº¤æ‰€æœ‰æœ¬åœ°Gitæ›´æ”¹ã€‚</p><p id="f5d1" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">5.è¿è¡Œ<code class="du lt lu lv lw b">git push heroku</code>å°†appéƒ¨ç½²åˆ°Herokuä¸­(<em class="kk">å…¶å®ç¬¬ä¸€æ¬¡æ¨é€éœ€è¦å¦å¤–ä¸€ä¸ªå‘½ä»¤ï¼Œä½†æ˜¯æ¶ˆæ¯ä¼šå‘Šè¯‰æ˜¯å“ªä¸ª</em>)ã€‚</p><h1 id="3abf" class="kl km hi bd kn ko kp kq kr ks kt ku kv io kw ip kx ir ky is kz iu la iv lb lc bi translated">4.æ¾å¼›åº”ç”¨ç¨‹åºé…ç½®</h1><p id="81fd" class="pw-post-body-paragraph jo jp hi jq b jr lf ij jt ju lg im jw jx mg jz ka kb mh kd ke kf mi kh ki kj hb bi translated"><em class="kk">åŸºäºå®˜æ–¹æ–‡æ¡£:</em> <a class="ae jn" href="https://api.slack.com/start/building/bolt-java" rel="noopener ugc nofollow" target="_blank"> <em class="kk">ç”¨Boltæ­å»ºapp for Java</em></a><em class="kk"/><a class="ae jn" href="https://slack.dev/java-slack-sdk/guides/getting-started-with-bolt" rel="noopener ugc nofollow" target="_blank"><em class="kk">å…¥é—¨Bolt </em> </a> <em class="kk">ã€‚</em></p><ol class=""><li id="ed71" class="ld le hi jq b jr js ju jv jx mj kb mk kf ml kj lk ll lm ln bi translated">è¿›å…¥<a class="ae jn" href="https://api.slack.com/apps" rel="noopener ugc nofollow" target="_blank"> <strong class="jq hj">æ¾å¼›åº”ç”¨</strong> </a>ç‚¹å‡»â€œåˆ›å»ºæ–°åº”ç”¨â€ã€‚</li><li id="1666" class="ld le hi jq b jr lo ju lp jx lq kb lr kf ls kj lk ll lm ln bi translated">é€‰æ‹©â€œä»å¤´å¼€å§‹â€,å•å‡»â€œä¸‹ä¸€æ­¥â€,å‘½ååº”ç”¨ç¨‹åºï¼Œå°†å…¶åˆ†é…åˆ°å·¥ä½œåŒºã€‚</li><li id="a86d" class="ld le hi jq b jr lo ju lp jx lq kb lr kf ls kj lk ll lm ln bi translated">åœ¨å·¦ä¾§èœå•ä¸­ï¼Œè½¬åˆ°â€œOAuth &amp; Permissionsâ€ï¼Œæ»šåŠ¨åˆ°â€œScopesâ€ï¼Œæ·»åŠ <code class="du lt lu lv lw b">chat:write</code>ã€‚</li><li id="4091" class="ld le hi jq b jr lo ju lp jx lq kb lr kf ls kj lk ll lm ln bi translated">åœ¨èœå•ä¸­ï¼Œå•å‡»â€œæ–œæ å‘½ä»¤â€Ï…â€œåˆ›å»ºæ–°å‘½ä»¤â€ã€‚</li><li id="dfd0" class="ld le hi jq b jr lo ju lp jx lq kb lr kf ls kj lk ll lm ln bi translated">ç”¨<br/> <strong class="jq hj">å‘½ä»¤</strong> : <code class="du lt lu lv lw b">hello<br/></code> <strong class="jq hj">è¯·æ±‚URL </strong> : <code class="du lt lu lv lw b">BASE_APP_URL/slack/events<br/></code>è·å–<code class="du lt lu lv lw b">BASE_APP_URL</code>ï¼Œåœ¨ç»ˆç«¯è¿è¡Œ<code class="du lt lu lv lw b">heroku apps:info</code>(å°±æ˜¯<code class="du lt lu lv lw b">Web URL</code>)ã€‚<br/> <strong class="jq hj">ç®€çŸ­æè¿°</strong> : <code class="du lt lu lv lw b">hello world<br/></code>ä¿å­˜æ›´æ”¹ã€‚</li><li id="148e" class="ld le hi jq b jr lo ju lp jx lq kb lr kf ls kj lk ll lm ln bi translated"><em class="kk">æˆ‘ä»¬éœ€è¦å°†Slackç¯å¢ƒå˜é‡ä»Slack UIå¤åˆ¶åˆ°Herokuã€‚</em>è¦åšåˆ°:è¿›å…¥â€œåŸºæœ¬ä¿¡æ¯â€Ï…â€œAppå‡­æ®â€Ï…â€œç­¾çº¦ç§˜ç¬ˆâ€Ï…ç‚¹å‡»â€œæ˜¾ç¤ºâ€Ï…å¤åˆ¶å³å¯ã€‚è¿›å…¥<a class="ae jn" href="https://dashboard.heroku.com/" rel="noopener ugc nofollow" target="_blank"> Heroku Dashboard </a>é€‰æ‹©å·²åˆ›å»ºçš„åº”ç”¨ç¨‹åºâ–½â€œSettingsâ€â–½â€œReveal Config Varsâ€â–½æ·»åŠ ä¸€ä¸ªåä¸º<code class="du lt lu lv lw b">SLACK_SIGNING_SECRET</code>çš„æ–°åº”ç”¨ç¨‹åºï¼Œä½¿ç”¨ä¹‹å‰å¤åˆ¶çš„å€¼ã€‚</li><li id="760a" class="ld le hi jq b jr lo ju lp jx lq kb lr kf ls kj lk ll lm ln bi translated">è¿”å›Slack UIï¼Œè½¬åˆ°â€œOAuth &amp; Permissionsâ€ï¼Œå•å‡»â€œInstall to Workspaceâ€æŒ‰é’®ï¼Œå¤åˆ¶â€œBot User OAuth Tokenâ€å¤„çš„å€¼ã€‚è¿”å›Herokuåˆ›å»ºå¦ä¸€ä¸ªåä¸º<code class="du lt lu lv lw b">SLACK_BOT_TOKEN</code>çš„ç¯å¢ƒå˜é‡ï¼Œç²˜è´´å¤åˆ¶çš„å€¼ã€‚</li><li id="c666" class="ld le hi jq b jr lo ju lp jx lq kb lr kf ls kj lk ll lm ln bi translated"><em class="kk">è¯¥æµ‹è¯•appäº†ï¼</em>è½¬åˆ°æ¾å¼›æœ¬èº«â–¶åœ¨ä»»æ„é¢‘é“é”®å…¥<code class="du lt lu lv lw b">/hello</code>æŒ‰å›è½¦é”®ï¼›ä½ åº”è¯¥å¾—åˆ°<code class="du lt lu lv lw b">world</code>ä½œä¸ºå›å¤ã€‚</li></ol><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mt"><img src="../Images/90728d81fa605c0657afd7569d9c9951.png" data-original-src="https://miro.medium.com/v2/resize:fit:388/format:webp/1*_u3TKlYAKfb36tICY-x95g.png"/></div></figure><p id="601e" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">ğŸ“<em class="kk">å¦‚æœæœ‰é—®é¢˜ï¼Œå¯ä»¥åœ¨ç»ˆç«¯ä¸­è°ƒç”¨</em> <code class="du lt lu lv lw b"><em class="kk">heroku logs --tail</em></code> <em class="kk">ã€‚</em></p></div><div class="ab cl mu mv gp mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="hb hc hd he hf"><div class="iy iz ja jb fd nb"><a href="https://github.com/lsoares/slack-bot-kotlin-sample" rel="noopener  ugc nofollow" target="_blank"><div class="nc ab dw"><div class="nd ab ne cl cj nf"><h2 class="bd hj fi z dy ng ea eb nh ed ef hh bi translated">GitHub-lsoares/slack-bot-kot Lin-sample</h2><div class="ni l"><h3 class="bd b fi z dy ng ea eb nh ed ef dx translated">æ­¤æ—¶æ‚¨ä¸èƒ½æ‰§è¡Œè¯¥æ“ä½œã€‚æ‚¨å·²ä½¿ç”¨å¦ä¸€ä¸ªæ ‡ç­¾é¡µæˆ–çª—å£ç™»å½•ã€‚æ‚¨å·²åœ¨å¦ä¸€ä¸ªé€‰é¡¹å¡ä¸­æ³¨é”€ï¼Œæˆ–è€…â€¦</h3></div><div class="nj l"><p class="bd b fp z dy ng ea eb nh ed ef dx translated">github.com</p></div></div><div class="nk l"><div class="nl l nm nn no nk np jh nb"/></div></div></a></div></div></div>    
</body>
</html>