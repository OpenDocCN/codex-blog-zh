<html>
<head>
<title>8-Week SQL Challenge — Danny’s Diner Week #1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为期8周的SQL挑战—丹尼餐厅第1周</h1>
<blockquote>原文：<a href="https://medium.com/codex/8-week-sql-challenge-dannys-diner-week-1-49709bef08cd?source=collection_archive---------4-----------------------#2022-06-11">https://medium.com/codex/8-week-sql-challenge-dannys-diner-week-1-49709bef08cd?source=collection_archive---------4-----------------------#2022-06-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="7c46" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">马得已经开始了一个非常有趣的为期8周的SQL挑战，这是为SQL初学者或有经验的SQL用户。每周，你会有一个案例研究和一些问题。</p><p id="41bf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你想加入这个挑战，这里有链接:<a class="ae jd" href="https://8weeksqlchallenge.com/case-study-1/" rel="noopener ugc nofollow" target="_blank">https://8weeksqlchallenge.com/case-study-1/</a>。</p><p id="0b62" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">**此处可在线购买马得官方答案:【https://www.datawithdanny.com/courses/serious-sql】T2* *</p></div><div class="ab cl je jf gp jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="hb hc hd he hf"><p id="83eb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第一周的案例研究是丹尼的餐馆—</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es jl"><img src="../Images/ddbcd44501e92583f5e076a0b82f7586.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a8yQ1Ac-kbwncw_oVigorA.png"/></div></div><figcaption class="jx jy et er es jz ka bd b be z dx translated">来自:【https://8weeksqlchallenge.com/case-study-1/ T4】</figcaption></figure><p id="8949" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是表格之间的关系—</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es kb"><img src="../Images/1132ecca9b579ea6ec744fefc1b74cb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fK-pmlBoc9GigAjVdneWLg.png"/></div></div><figcaption class="jx jy et er es jz ka bd b be z dx translated">来自:<a class="ae jd" href="https://8weeksqlchallenge.com/case-study-1/" rel="noopener ugc nofollow" target="_blank">https://8weeksqlchallenge.com/case-study-1/</a></figcaption></figure></div><div class="ab cl je jf gp jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="hb hc hd he hf"><p id="a585" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这些是案例研究问题:</p><ol class=""><li id="c637" class="kc kd hi ih b ii ij im in iq ke iu kf iy kg jc kh ki kj kk bi translated">每位顾客在餐厅消费的总额是多少？</li><li id="ce74" class="kc kd hi ih b ii kl im km iq kn iu ko iy kp jc kh ki kj kk bi translated">每位顾客光顾餐厅有多少天了？</li><li id="4524" class="kc kd hi ih b ii kl im km iq kn iu ko iy kp jc kh ki kj kk bi translated">每位顾客从菜单上购买的第一个项目是什么？</li><li id="ccae" class="kc kd hi ih b ii kl im km iq kn iu ko iy kp jc kh ki kj kk bi translated">菜单上购买最多的项目是什么？所有顾客购买了多少次？</li><li id="2995" class="kc kd hi ih b ii kl im km iq kn iu ko iy kp jc kh ki kj kk bi translated">每位顾客最喜欢的商品是什么？</li><li id="2d32" class="kc kd hi ih b ii kl im km iq kn iu ko iy kp jc kh ki kj kk bi translated">顾客成为会员后最先购买的物品是什么？</li><li id="572a" class="kc kd hi ih b ii kl im km iq kn iu ko iy kp jc kh ki kj kk bi translated">顾客在成为会员之前购买了哪件商品？</li><li id="8b1b" class="kc kd hi ih b ii kl im km iq kn iu ko iy kp jc kh ki kj kk bi translated">每位会员在成为会员前的总物品和消费金额是多少？</li><li id="b188" class="kc kd hi ih b ii kl im km iq kn iu ko iy kp jc kh ki kj kk bi translated">如果每消费1美元相当于10个积分，寿司有2倍的积分乘数——每个顾客会有多少个积分？</li><li id="f0d7" class="kc kd hi ih b ii kl im km iq kn iu ko iy kp jc kh ki kj kk bi translated">在客户加入计划后的第一周(包括他们的加入日期),他们在所有项目上都获得了2x积分，不仅仅是寿司——客户A和B在1月底获得了多少积分？</li></ol></div><div class="ab cl je jf gp jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="hb hc hd he hf"><p id="e20a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面是我如何编写查询的，我将使用PostgreSQL v13。由于我没有购买官方答案，这些结果是我理解问题的方式，它不是官方答案。</p><p id="af7d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您发现了任何错误或认为有改进的潜力，请留下您的评论或联系我。谢谢:)</p></div><div class="ab cl je jf gp jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="hb hc hd he hf"><ol class=""><li id="5274" class="kc kd hi ih b ii ij im in iq ke iu kf iy kg jc kh ki kj kk bi translated">每位顾客在餐厅消费的总额是多少？</li></ol><pre class="jm jn jo jp fd kr ks kt ku aw kv bi"><span id="b6b1" class="kw kx hi ks b fi ky kz l la lb">SELECT customer_id , SUM(price) AS total_spent<br/>FROM dannys_diner.sales s<br/>JOIN dannys_diner.menu m <br/>ON s.product_id = m.product_id<br/>GROUP BY customer_id<br/>ORDER BY customer_id;</span></pre><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es lc"><img src="../Images/f9d10872f5f82bc2a1f9ee0390d8cba0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Wo49wmrIbskM7P_NH_WTBA.png"/></div></div><figcaption class="jx jy et er es jz ka bd b be z dx translated">结果</figcaption></figure><p id="9308" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.每位顾客光顾餐厅有多少天了？</p><pre class="jm jn jo jp fd kr ks kt ku aw kv bi"><span id="5ea6" class="kw kx hi ks b fi ky kz l la lb">SELECT customer_id , COUNT(DISTINCT(order_date)) AS date<br/>FROM dannys_diner.sales s<br/>JOIN dannys_diner.menu m <br/>ON s.product_id = m.product_id<br/>GROUP BY customer_id;</span></pre><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es ld"><img src="../Images/50d7452c4c3c627948afafe9fe5f0d32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5ZqAFj3X69XFTmneRPFNnw.png"/></div></div><figcaption class="jx jy et er es jz ka bd b be z dx translated">结果</figcaption></figure><p id="05e3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3.每位顾客从菜单上购买的第一个项目是什么？</p><pre class="jm jn jo jp fd kr ks kt ku aw kv bi"><span id="cbf5" class="kw kx hi ks b fi ky kz l la lb">WITH<br/> first_purchase<br/>AS<br/> (<br/>  SELECT<br/>   s.customer_id,<br/>   s.order_date,<br/>   m.product_name,<br/>   DENSE_RANK() OVER(PARTITION BY s.customer_id <br/>          ORDER BY s.order_date) AS rank<br/>  FROM dannys_diner.sales s<br/>  LEFT JOIN dannys_diner.menu m <br/>  ON s.product_id = m.product_id<br/>  LEFT JOIN dannys_diner.members ms <br/>  ON s.customer_id = ms.customer_id<br/> )<br/>SELECT <br/> customer_id,<br/> product_name, <br/> order_date<br/>FROM first_purchase<br/>WHERE rank = 1<br/>GROUP BY customer_id, product_name, order_date;</span></pre><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es lc"><img src="../Images/fda4b3fa35f3c047147d5cb73d3c28fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IZ8E9h0oOBP0QdpzAYpf0g.png"/></div></div><figcaption class="jx jy et er es jz ka bd b be z dx translated">结果</figcaption></figure><p id="d228" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">4.菜单上购买最多的项目是什么？所有顾客购买了多少次？</p><pre class="jm jn jo jp fd kr ks kt ku aw kv bi"><span id="6d96" class="kw kx hi ks b fi ky kz l la lb">SELECT m.product_name, COUNT(order_date)<br/>FROM dannys_diner.sales s<br/>JOIN dannys_diner.menu m <br/>ON s.product_id = m.product_id<br/>GROUP BY product_name<br/>ORDER BY COUNT(order_date) DESC<br/>LIMIT 1;</span></pre><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es lc"><img src="../Images/34df856c533a8cd059ab3feb75d63c36.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TYBccuFQa9Uph8xtxwdSqg.png"/></div></div><figcaption class="jx jy et er es jz ka bd b be z dx translated">结果</figcaption></figure><p id="8f6e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">5.每位顾客最喜欢的商品是什么？</p><pre class="jm jn jo jp fd kr ks kt ku aw kv bi"><span id="b79f" class="kw kx hi ks b fi ky kz l la lb">WITH<br/> popular_item<br/>AS<br/> (<br/>SELECT s.customer_id, m.product_name,COUNT(m.product_name) AS order_count,<br/>DENSE_RANK() OVER (PARTITION BY s.customer_id ORDER BY COUNT(m.product_name) DESC) AS rank<br/>FROM dannys_diner.sales s<br/>JOIN dannys_diner.menu m<br/>ON s.product_id = m.product_id<br/>GROUP BY s.customer_id, m.product_name<br/>)</span><span id="9075" class="kw kx hi ks b fi le kz l la lb">SELECT customer_id, product_name<br/>FROM popular_item<br/>WHERE RANK = 1;</span></pre><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es lc"><img src="../Images/2731262dc8fc96d1b90b21d166822a03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w_Ewtz1D7bGPUV17BoFnqg.png"/></div></div><figcaption class="jx jy et er es jz ka bd b be z dx translated">结果</figcaption></figure><p id="7541" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">6.顾客成为会员后最先购买的物品是什么？</p><pre class="jm jn jo jp fd kr ks kt ku aw kv bi"><span id="8881" class="kw kx hi ks b fi ky kz l la lb">WITH<br/> first_member_purchase<br/>AS<br/> (<br/> SELECT<br/> s.customer_id, s.product_id, s.order_date, ms.join_date,<br/> DENSE_RANK() OVER(PARTITION BY s.customer_id <br/> ORDER BY s.order_date) AS rank<br/> FROM dannys_diner.sales s<br/> INNER JOIN dannys_diner.members ms <br/> ON s.customer_id = ms.customer_id<br/> WHERE s.order_date &gt;= ms.join_date <br/> )<br/>SELECT customer_id, product_name, order_date<br/>FROM first_member_purchase fmp<br/>INNER JOIN dannys_diner.menu m <br/>ON fmp.product_id = m.product_id<br/>WHERE rank = 1<br/>ORDER BY customer_id;</span></pre><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es lc"><img src="../Images/7b4f42e74099c91bbc6e72feace94df5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f6HNSlnr4pFZJsuj0bJD9g.png"/></div></div><figcaption class="jx jy et er es jz ka bd b be z dx translated">结果</figcaption></figure><p id="bed8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">7.顾客在成为会员之前购买了哪件商品？</p><pre class="jm jn jo jp fd kr ks kt ku aw kv bi"><span id="d01b" class="kw kx hi ks b fi ky kz l la lb">WITH<br/> first_member_purchase<br/>AS<br/> (<br/>  SELECT<br/>   s.customer_id, s.product_id, s.order_date, ms.join_date,<br/>   DENSE_RANK() OVER(PARTITION BY s.customer_id <br/>          ORDER BY s.order_date DESC) AS rank<br/>  FROM dannys_diner.sales s<br/>  INNER JOIN dannys_diner.members ms <br/>  ON s.customer_id = ms.customer_id<br/>  WHERE s.order_date &lt; ms.join_date <br/> )<br/>SELECT <br/> customer_id, product_name, order_date<br/>FROM first_member_purchase fmp<br/>INNER JOIN dannys_diner.menu m <br/>ON fmp.product_id = m.product_id<br/>WHERE rank = 1<br/>ORDER BY customer_id;</span></pre><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es ld"><img src="../Images/4083fa4d0d77150f6415f87b818d9360.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w3GR7yzhP7iiJ4NZBbTmQw.png"/></div></div><figcaption class="jx jy et er es jz ka bd b be z dx translated">结果</figcaption></figure><p id="ac4e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">8.每位会员在成为会员前的总物品和消费金额是多少？</p><pre class="jm jn jo jp fd kr ks kt ku aw kv bi"><span id="4f9c" class="kw kx hi ks b fi ky kz l la lb">SELECT <br/> s.customer_id,SUM(price)<br/>FROM dannys_diner.sales s <br/>INNER JOIN dannys_diner.menu m <br/>ON s.product_id = m.product_id<br/>INNER JOIN dannys_diner.members ms<br/>ON s.customer_id = ms.customer_id<br/>WHERE s.order_date &lt; ms.join_date<br/>GROUP BY s.customer_id<br/>ORDER BY s.customer_id;</span></pre><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es lc"><img src="../Images/51dd5abe859316cb322ad5e780a14e7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yenG7-kyZpqD8hFe9SfqSw.png"/></div></div><figcaption class="jx jy et er es jz ka bd b be z dx translated">结果</figcaption></figure><p id="ceb8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">9.如果每消费1美元相当于10个积分，寿司有2倍的积分乘数——每个顾客会有多少个积分？</p><pre class="jm jn jo jp fd kr ks kt ku aw kv bi"><span id="e092" class="kw kx hi ks b fi ky kz l la lb">SELECT <br/> customer_id, SUM(points)<br/>FROM <br/>(<br/>SELECT customer_id, <br/>  CASE WHEN m.product_name = 'sushi' THEN price*20 ELSE price*10 END AS points<br/>FROM dannys_diner.sales s<br/>INNER JOIN dannys_diner.menu m<br/>ON s.product_id = m.product_id<br/>) AS total_points<br/>GROUP BY customer_id<br/>ORDER BY customer_id;</span></pre><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es lc"><img src="../Images/6786b5a38e034bdbddcad68acf151f33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tbCiFjqgDd1csvKR1KzK0g.png"/></div></div><figcaption class="jx jy et er es jz ka bd b be z dx translated">结果</figcaption></figure><p id="8bf4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">10.在客户加入计划后的第一周(包括他们的加入日期),他们在所有项目上都获得了2x积分，不仅仅是寿司——客户A和B在1月底获得了多少积分？</p><pre class="jm jn jo jp fd kr ks kt ku aw kv bi"><span id="1af9" class="kw kx hi ks b fi ky kz l la lb">WITH<br/> first_week_program<br/>AS<br/> (<br/>  SELECT<br/>   s.customer_id, <br/>   CASE WHEN m.product_name = 'sushi' AND<br/>    s.order_date BETWEEN ms.join_date + CAST(-1 || 'day' AS INTERVAL) and <br/>    ms.join_date + cast(6 || 'day' AS INTERVAL) THEN m.price*20<br/>   WHEN product_name = 'sushi' OR<br/>    s.order_date BETWEEN ms.join_date + CAST(-1 || 'day' AS INTERVAL) <br/>   AND<br/>   ms.join_date + CAST(6 || 'day' AS INTERVAL) THEN m.price*20<br/>   ELSE m.price*10 END AS points<br/>  FROM dannys_diner.members ms<br/>  LEFT JOIN dannys_diner.sales s <br/>  ON s.customer_id = ms.customer_id<br/>  LEFT JOIN dannys_diner.menu m <br/>  ON s.product_id = m.product_id<br/>  WHERE s.order_date &lt;= '20210131'<br/> )<br/>SELECT customer_id, SUM(points) points<br/>FROM first_week_program<br/>GROUP BY customer_id;</span></pre><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es ld"><img src="../Images/acd6f7d501bfc4f724f147fc82fb0cbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y-KsjJOQPLefKgYll0RqDQ.png"/></div></div><figcaption class="jx jy et er es jz ka bd b be z dx translated">结果</figcaption></figure></div><div class="ab cl je jf gp jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="hb hc hd he hf"><p id="9487" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">额外问题</p><ol class=""><li id="e67a" class="kc kd hi ih b ii ij im in iq ke iu kf iy kg jc kh ki kj kk bi translated">使用可用数据重新创建下表输出:</li></ol><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es lf"><img src="../Images/a4f7fa20e2c1348755cd62154c715e88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ihKP_I56LgJJr7egf8T6UA.png"/></div></div><figcaption class="jx jy et er es jz ka bd b be z dx translated">来自:【https://8weeksqlchallenge.com/case-study-1/ T2】</figcaption></figure><pre class="jm jn jo jp fd kr ks kt ku aw kv bi"><span id="41f5" class="kw kx hi ks b fi ky kz l la lb">SELECT s.customer_id, s.order_date, m.product_name, m.price,<br/>CASE<br/> WHEN ms.join_date &gt; s.order_date THEN 'N'<br/> WHEN ms.join_date &lt;= s.order_date THEN 'Y'<br/> ELSE 'N'<br/> END AS member<br/>FROM dannys_diner.sales AS s<br/>LEFT JOIN dannys_diner.menu AS m<br/> ON s.product_id = m.product_id<br/>LEFT JOIN dannys_diner.members AS ms<br/> ON s.customer_id = ms.customer_id;</span></pre><p id="9dfb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.Danny还需要关于客户产品的<code class="du lg lh li ks b">ranking</code>的进一步信息，但是他故意不需要非会员购买的排名，所以他希望当客户还不是忠诚度计划的一部分时，记录的值为空<code class="du lg lh li ks b">ranking</code>。</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es lj"><img src="../Images/0feeb577e242055fd17fb1a412385b75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U2iY8gd6SByvBOGoI5rFWQ.png"/></div></div><figcaption class="jx jy et er es jz ka bd b be z dx translated">来自:【https://8weeksqlchallenge.com/case-study-1/ T4】</figcaption></figure><pre class="jm jn jo jp fd kr ks kt ku aw kv bi"><span id="d96a" class="kw kx hi ks b fi ky kz l la lb">WITH summary AS<br/>(<br/>SELECT s.customer_id, s.order_date, m.product_name, m.price,<br/>CASE<br/> WHEN ms.join_date &gt; s.order_date THEN 'N'<br/> WHEN ms.join_date &lt;= s.order_date THEN 'Y'<br/> ELSE 'N' END AS member<br/>FROM dannys_diner.sales AS s<br/>LEFT JOIN dannys_diner.menu AS m<br/> ON s.product_id = m.product_id<br/>LEFT JOIN dannys_diner.members AS ms<br/> ON s.customer_id = ms.customer_id<br/>  )<br/>  <br/> SELECT *, CASE WHEN member = 'N' THEN NULL ELSE RANK() OVER(PARTITION BY customer_id,member ORDER BY order_date)<br/> END AS ranking<br/> FROM summary</span></pre></div><div class="ab cl je jf gp jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="hb hc hd he hf"><p id="075b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我为它做了一个桌面仪表盘，希望丹尼的餐馆能继续发展！你可以在这里和它互动:<a class="ae jd" href="https://public.tableau.com/app/profile/yunchenwu#!/?newProfile=&amp;activeTab=0" rel="noopener ugc nofollow" target="_blank">https://public.tableau.com/app/profile/yunchenwu#!/?newProfile= &amp; activeTab=0 </a></p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es lk"><img src="../Images/3d49ee74a8cb060a3adc627487d98df3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eZN92y-mIGMyopkFN_1bPA.png"/></div></div></figure></div><div class="ab cl je jf gp jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="hb hc hd he hf"><p id="b008" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="kq">查看其他媒体作者对马得为期8周的SQL挑战赛第1周</em> </strong>的SQL查询</p><p id="6569" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ll lm ge" href="https://medium.com/u/85a16e906d26?source=post_page-----49709bef08cd--------------------------------" rel="noopener" target="_blank"> <strong class="ih hj"> <em class="kq">黄</em> </strong> </a></p><p id="e30b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ll lm ge" href="https://medium.com/u/3a868671baeb?source=post_page-----49709bef08cd--------------------------------" rel="noopener" target="_blank"><strong class="ih hj"><em class="kq"/></strong></a></p><p id="864e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ll lm ge" href="https://medium.com/u/e4e5c3630003?source=post_page-----49709bef08cd--------------------------------" rel="noopener" target="_blank"> <strong class="ih hj"> <em class="kq">奥尔昆阿然</em> </strong> </a></p><p id="f357" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ll lm ge" href="https://medium.com/u/8078da1f619c?source=post_page-----49709bef08cd--------------------------------" rel="noopener" target="_blank"> <strong class="ih hj"> <em class="kq">比拉帕</em> </strong> </a></p></div></div>    
</body>
</html>