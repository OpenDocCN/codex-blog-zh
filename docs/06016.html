<html>
<head>
<title>Is Machine Learning Capable of Predicting Popularity of a Song?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习有能力预测一首歌的受欢迎程度吗？</h1>
<blockquote>原文：<a href="https://medium.com/codex/is-machine-learning-capable-of-predicting-popularity-of-a-song-a7b6dad4ac39?source=collection_archive---------11-----------------------#2022-04-06">https://medium.com/codex/is-machine-learning-capable-of-predicting-popularity-of-a-song-a7b6dad4ac39?source=collection_archive---------11-----------------------#2022-04-06</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/66ca13ebc47203807d0a2c9e07d496b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iND_l7BL2viPIYFja6z3Wg.jpeg"/></div></div></figure><p id="4726" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi jo translated">音乐是我们生活中不可或缺的一部分；它决定了我们一天或任何时刻的心情。这是几乎每个人都能体会和享受的东西，除非你患有<a class="ae jx" href="https://mappingignorance.org/2018/07/02/musical-anhedonia-not-everyone-likes-music/" rel="noopener ugc nofollow" target="_blank"> <strong class="is hj">音乐快感缺失</strong> </a> <strong class="is hj"> :( <br/> </strong>作为一名吉他手，我总是好奇是什么让一首歌像病毒一样传播。幸运的是，我们出生在一个大多数事情都可以测量的时代，这使得预测一个事件发生的概率变得很容易。</p><p id="d5f5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这个项目中，我试图从上个世纪发行的歌曲中汲取灵感，并预测一首歌是否会流行。用于此分析的数据集来自Spotify应用程序，可在Kaggle上获得。</p><p id="30d0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">作为典型的机器学习过程，执行以下步骤。<br/>加载库<br/>加载数据集<br/>数据清理<br/>探索性数据分析<br/>将数据分成训练和测试<br/>特征缩放<br/>训练模型<br/>模型选择</p><h1 id="d5a0" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated"><strong class="ak">加载库</strong></h1><figure class="kx ky kz la fd ij er es paragraph-image"><div class="er es kw"><img src="../Images/78f9b8a64e876f7848f48c0b2040d366.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/format:webp/1*IRsd_5heRuHulxmDLKmiyw.png"/></div></figure><h1 id="05d7" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated"><strong class="ak">加载数据集</strong></h1><p id="a500" class="pw-post-body-paragraph iq ir hi is b it lb iv iw ix lc iz ja jb ld jd je jf le jh ji jj lf jl jm jn hb bi translated">数据集包含20个特征，这些特征基于歌曲的流行度、技术/音乐参数(如响度、能量、音调等)来识别歌曲。</p><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lg"><img src="../Images/7f848ea9fbc40669889cee44ef76552e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UP9SeHLxZ1kr00ecBhwOhA.png"/></div></div></figure><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lh"><img src="../Images/5b4f38ee3b731a9ac6630000dbdba19b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WXcPNTT-AwnGY7EpZeYTcg.png"/></div></div></figure><h1 id="2022" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated"><strong class="ak">数据清理</strong></h1><p id="b930" class="pw-post-body-paragraph iq ir hi is b it lb iv iw ix lc iz ja jb ld jd je jf le jh ji jj lf jl jm jn hb bi translated"><strong class="is hj">空值:</strong>数据集包含71个空值，由于与整个数据集相比不重要而被丢弃(&lt; 1%)。</p><p id="6bfe" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">不必要的特征:</strong>id、id_artists、artists和name等特征被删除，因为它们不能提供任何重要的信息。</p><p id="93f7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">自定义列:</strong>创建“Popularity_Class”列，该列将用作对歌曲是否流行进行分类的目标变量。</p><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es li"><img src="../Images/1a92fc1eea0857e1da1aa096ebed7446.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9qnftT_wRymb6o1LQ48k1Q.png"/></div></div></figure><h1 id="9fd2" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated"><strong class="ak">探索性数据分析</strong></h1><p id="ef5b" class="pw-post-body-paragraph iq ir hi is b it lb iv iw ix lc iz ja jb ld jd je jf le jh ji jj lf jl jm jn hb bi translated"><strong class="is hj">历年平均歌曲时长:</strong></p><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lj"><img src="../Images/4ca36f9338a60c5459d30e40655c2769.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZHVOHT5Hi8aoC4-erYgliw.png"/></div></div></figure><p id="a81f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">从上面的视频中可以看出，在1960年代末和1980年代初，歌曲时长有所增加；这可能是由于技术革命，如磁带、光盘和互联网的发明。</p><p id="b46a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">另一方面，在过去几年中，平均歌曲持续时间有所下降<strong class="is hj">，其可能的原因可能是由于内容的选择性、<a class="ae jx" href="https://www.ceralytics.com/what-is-content-shock/" rel="noopener ugc nofollow" target="_blank"> <strong class="is hj">内容冲击</strong> </a>等各种原因导致用户的注意力持续时间下降。</strong></p><blockquote class="lk"><p id="c923" class="ll lm hi bd ln lo lp lq lr ls lt jn dx translated">但是歌曲时长减少的主要原因被认为是艺术家的收入方式。如今，艺术家通过Spotify、亚马逊音乐(Amazon music)等应用获得报酬，基于流媒体，而不是传统的按EP/专辑付费的系统(即在卡带/CD时代)。阅读这篇有趣的文章由<a class="ae jx" href="https://www.theverge.com/2019/5/28/18642978/music-streaming-spotify-song-length-distribution-production-switched-on-pop-vergecast-interview" rel="noopener ugc nofollow" target="_blank"> <strong class="ak">濒临</strong> </a></p></blockquote><p id="c2f7" class="pw-post-body-paragraph iq ir hi is b it lu iv iw ix lv iz ja jb lw jd je jf lx jh ji jj ly jl jm jn hb bi translated"><strong class="is hj">关联热图<br/> </strong>关联提供了两个特征之间关系的强度。“特征1”和“特征2”之间的正相关意味着随着“特征1”的增加/减少；特征2’也分别增加/减少。</p><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lz"><img src="../Images/0548cf939e7d73f9a33783516c1c463d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*scZWVZx7X1W7dZtyR_xaXA.png"/></div></div></figure><p id="b157" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">从上面观察到的一些强相关性是<br/>能量和响度(+) <br/>能量和声音(-) <br/>可跳舞性和价(+)</p><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ma"><img src="../Images/7e390a1bc1529b90b841dfbded0cb0fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zS9sUk9e-kCsJT9hj5G86A.png"/></div></div><figcaption class="mb mc et er es md me bd b be z dx translated">能量与声音</figcaption></figure><h1 id="f8e1" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">列车测试分离</h1><p id="6715" class="pw-post-body-paragraph iq ir hi is b it lb iv iw ix lc iz ja jb ld jd je jf le jh ji jj lf jl jm jn hb bi translated">出于建模的目的，我考虑了2000年以后发行的歌曲，因为它与今天更相关，并且考虑到数据量，不会破坏IDE。</p><blockquote class="lk"><p id="abf4" class="ll lm hi bd ln lo lp lq lr ls lt jn dx translated">从sklearn.model_selection导入train_test_split <br/> xtrain，xtest，ytrain，ytest= train_test_split(x，y，test_size=0.2，random_state=0)</p></blockquote><h1 id="d574" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj mf kl km kn mg kp kq kr mh kt ku kv bi translated">特征缩放</h1><p id="2d3e" class="pw-post-body-paragraph iq ir hi is b it lb iv iw ix lc iz ja jb ld jd je jf le jh ji jj lf jl jm jn hb bi translated">为了在固定比例上标准化特征，执行特征缩放。<br/>用于训练模型的两种算法(即逻辑回归和K最近邻)需要对独立特征进行缩放。</p><blockquote class="lk"><p id="447b" class="ll lm hi bd ln lo lp lq lr ls lt jn dx translated">从sklearn .预处理导入standard scaler<br/>scaler = standard scaler()<br/>xtrain = scaler . fit _ transform(xtrain)</p></blockquote><h1 id="9088" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj mf kl km kn mg kp kq kr mh kt ku kv bi translated">培训模型</h1><p id="b96a" class="pw-post-body-paragraph iq ir hi is b it lb iv iw ix lc iz ja jb ld jd je jf le jh ji jj lf jl jm jn hb bi translated">我对以下三个模型的数据进行了训练<br/>逻辑回归<br/>K近邻<br/>随机森林</p><h2 id="1ddf" class="mi jz hi bd ka mj mk ml ke mm mn mo ki jb mp mq km jf mr ms kq jj mt mu ku mv bi translated">逻辑回归</h2><p id="2041" class="pw-post-body-paragraph iq ir hi is b it lb iv iw ix lc iz ja jb ld jd je jf le jh ji jj lf jl jm jn hb bi translated">逻辑回归是在因变量为二分变量时进行的分析。逻辑回归用于描述数据，并解释一个因变量与一个或多个名义变量、序数变量、区间变量或比率水平自变量之间的关系。</p><figure class="kx ky kz la fd ij er es paragraph-image"><div class="er es mw"><img src="../Images/c1c3b1a1e968d2edc45383d98b37d6d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:918/format:webp/1*ugajreFk4x1U5v2On-TE2A.png"/></div></figure><h2 id="115c" class="mi jz hi bd ka mj mk ml ke mm mn mo ki jb mp mq km jf mr ms kq jj mt mu ku mv bi translated">k-最近邻</h2><p id="aaae" class="pw-post-body-paragraph iq ir hi is b it lb iv iw ix lc iz ja jb ld jd je jf le jh ji jj lf jl jm jn hb bi translated">k-最近邻算法是一种监督学习分类器，它使用邻近性来进行分类。它脱离了可以在彼此附近找到相似点的假设。</p><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mx"><img src="../Images/0262e2789a9ee2177826fcfba34b94ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*yQ0jDPcja3wAGqV3.jpeg"/></div></div></figure><p id="a926" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">由于模型中存在高维度，我使用了曼哈顿距离(即p=1)而不是欧几里德距离，并将邻居设置为5，以从计算角度保持计算简单。</p><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es my"><img src="../Images/92b38865c7611b16be15fa66b1c484fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iZ9Q50S8YAncKWglEAo0JA.png"/></div></div></figure><h2 id="c944" class="mi jz hi bd ka mj mk ml ke mm mn mo ki jb mp mq km jf mr ms kq jj mt mu ku mv bi translated">随机森林</h2><p id="0c9c" class="pw-post-body-paragraph iq ir hi is b it lb iv iw ix lc iz ja jb ld jd je jf le jh ji jj lf jl jm jn hb bi translated">这是一种基于系综树的学习算法。随机森林分类器是从随机选择的训练集子集得到的一组决策树。它聚集来自不同决策树<strong class="is hj"> </strong>的投票来决定测试对象的最终类。</p><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mz"><img src="../Images/610a68d33dfbce591a542bffdfdb91cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*rPzA9qbpt7hkzJl_.jpeg"/></div></div></figure><p id="05a4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">同样，为了简化计算，通过“基尼”指数来计算杂质，并且树的数量(n _估计量)被设置为100。</p><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es na"><img src="../Images/b94600286daf58af6b2a1d4c3d6065ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZdNt8aw607h1W_d0iAZLdQ.png"/></div></div></figure><p id="c5cf" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">模型精度:</strong></p><figure class="kx ky kz la fd ij er es paragraph-image"><div class="er es nb"><img src="../Images/de22ffdfbc19f7b513c9a1947b6c3c8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:656/format:webp/1*ExvvouPIdRJiLPN8dG6_Ww.png"/></div></figure><h1 id="443b" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">型号选择</h1><p id="d822" class="pw-post-body-paragraph iq ir hi is b it lb iv iw ix lc iz ja jb ld jd je jf le jh ji jj lf jl jm jn hb bi translated">上述模型是在设定的随机状态下训练的，即(random_state=0)。为了检查任何随机数据集的所有模型的准确性是否过度拟合，我们需要计算交叉验证分数。</p><p id="8bbd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">交叉验证<br/> </strong>交叉验证提供分类器泛化能力的信息，特别是分类器的预期误差范围。</p><p id="26f8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">基本上，它通过在不同的随机数据集上训练模型来计算精确度，并进一步给出平均精确度。</p><figure class="kx ky kz la fd ij er es paragraph-image"><div class="ab fe cl nc"><img src="../Images/b284e07184674c734b78d46de37b28a2.png" data-original-src="https://miro.medium.com/v2/format:webp/1*1RPHQk-xpKMInxkEd1qFyg.png"/></div></figure><p id="1cf1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">“cv”是交叉验证迭代，基本上是在不同的随机数据集上训练模型的迭代次数。</p><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nd"><img src="../Images/65df629a59bfa69f0f7d7859beb24ba0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NntXsTdXEto1jkiz2rGl0w.png"/></div></div></figure><p id="fd42" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">从上面的准确度结果可以明显看出<strong class="is hj">随机森林</strong>算法是一个更好的音轨流行度分类器。</p><blockquote class="lk"><p id="541c" class="ll lm hi bd ln lo lp lq lr ls lt jn dx translated">可以得出结论，机器学习模型能够使用各种特征对音轨的流行度进行分类。</p></blockquote></div></div>    
</body>
</html>