<html>
<head>
<title>An Introduction to Automated Market Making</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">自动做市介绍</h1>
<blockquote>原文：<a href="https://medium.com/codex/an-introduction-to-automated-market-making-994bc76c61f4?source=collection_archive---------4-----------------------#2022-09-01">https://medium.com/codex/an-introduction-to-automated-market-making-994bc76c61f4?source=collection_archive---------4-----------------------#2022-09-01</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/fa09af9ba383335fe9d04677571b23d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J1WtW92HtCE6jMZEEZ0HCQ.jpeg"/></div></div></figure><p id="adcc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">前言:下面这篇文章旨在巩固知识，因为我了解自动化做市。如果任何信息是不正确的，部分不正确的，或不完整的，我竭诚欢迎您的投入。</p><p id="570f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">目的:</strong>本文旨在介绍自动做市商(AMM)的概念，及其与分散金融的相关性。</p><p id="eae1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">文章结构:</strong>在这篇文章中，我们将涵盖以下概念:</p><ul class=""><li id="0089" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated">流动性池，因为它们有助于代币交易</li><li id="6ae2" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">XYK定价模型，因为它与自动化资产定价相关</li><li id="6f20" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">XYK定价带来的潜在问题</li></ul><h2 id="856d" class="kc kd hi bd ke kf kg kh ki kj kk kl km jb kn ko kp jf kq kr ks jj kt ku kv kw bi translated">太久了，没看</h2><ul class=""><li id="c332" class="jo jp hi is b it kx ix ky jb kz jf la jj lb jn jt ju jv jw bi translated"><strong class="is hj">流动性池</strong>是智能合约的代币余额。促进交易包括提供商定数量的代币X，为此，您将获得代币Y的补偿。在这种情况下，代币X的余额将增加所提供的数量，代币Y的余额将减少所收到的数量。</li><li id="fef7" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated"><strong class="is hj"> XYK定价</strong>规定，一旦提供流动性，代币总数X乘以代币总数Y必须始终等于一个常数值。利用这个属性，可以推导出交易的成本。</li><li id="ed4e" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated"><strong class="is hj">自动做市商问题</strong>包括价格影响和滑点。当交易者互换代币时，每一次互换实际上都改变了标的代币的价格。与交易金额相关的流动性池越深，交易对代币价格的影响就越小。</li></ul><h1 id="fdcb" class="lc kd hi bd ke ld le lf ki lg lh li km lj lk ll kp lm ln lo ks lp lq lr kv ls bi translated">基础</h1><p id="ccfe" class="pw-post-body-paragraph iq ir hi is b it kx iv iw ix ky iz ja jb lt jd je jf lu jh ji jj lv jl jm jn hb bi translated"><strong class="is hj">分散资产交易所(dex)</strong>是<em class="lw">分散金融</em>生态系统中不可或缺的组成部分。它们是开放的、无需许可的软件系统，能够实现数字资产的自动化、分散化交易。这些软件系统由智能合同组成，与任何智能合同一样，它们的持续运行取决于为网络提供计算的独立实体。换句话说，一旦部署，契约是不可变的，并且它们不受集中实体的控制。从这个意义上说，分散的交易所可以被认为是公共产品。</p><p id="1f51" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">举例:</strong>让我们假设你有一些乙醚(ETH)，你想用其中的一些去换一些<a class="ae lx" href="https://www.vitadao.com/" rel="noopener ugc nofollow" target="_blank">维他道</a> ERC-20代币(VITA)。根据基本原则，为了进行这种交易，VITA代币必须存在，并且当前的所有者必须愿意卖给你一些来交换你的ETH。换句话说，一定有一个假设的VITA代币子集可以用于你的交易。进入流动性池。</p><h1 id="4e90" class="lc kd hi bd ke ld le lf ki lg lh li km lj lk ll kp lm ln lo ks lp lq lr kv ls bi translated">流动性池</h1><p id="5c63" class="pw-post-body-paragraph iq ir hi is b it kx iv iw ix ky iz ja jb lt jd je jf lu jh ji jj lv jl jm jn hb bi translated">流动性池只是智能合约上的象征性余额。使用上面的示例，可以创建一个智能合同，并最初提供一个ETH余额和一个VITA余额。假设ETH天平的总价值等于VITA天平的总价值，将这些天平配对在一起。换句话说，ETH余额和VITA余额都占合同价值的50%。这些余额提供了便利交易所必需的可用代币。</p><p id="373f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">图1: </strong></p><figure class="lz ma mb mc fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ly"><img src="../Images/873624fafe5f7ea4931e51377f4e7b01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qe3X9zYVMObv5lXZDzbeMA.jpeg"/></div></div><figcaption class="md me et er es mf mg bd b be z dx translated">可视化的流动性池。</figcaption></figure><p id="75ea" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">鉴于上述流动性池对，可以说VITA是根据ETH定价的→“购买一个VITA令牌需要多少ETH？”反过来也是如此:ETH以VITA定价→“我需要多少VITA令牌才能购买一个ETH？”。根据另一个令牌，即时令牌价格由<em class="lw"> XYK定价模型</em>指定，我们将在下面深入讨论。如果交易者同意合约的当前VITA价格(根据ETH)，那么为了促进交易，他必须向合约发送指定数量的ETH，为此他将被自动授予指定数量的VITA。换句话说，交易者发送ETH，作为回报，他的账户会收到之前约定数量的VITA令牌(加减滑点，我们将在下面介绍),所有这些都没有中介——分散融资！</p><p id="5aec" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">鉴于上述交易，需要注意的是，通过用ETH交换VITA，ETH的总量增加了(根据交易者发送的量)，而VITA的总量减少了(根据交易者收到的VITA的量)。请记住，该模型假设令牌1的池(ETH)的总价值始终等于令牌2的池(VITA)的总价值。这意味着这笔交易实际上转移了VITA在ETH方面的价格；下一个交易者将不得不为1维他支付更多的ETH。这种由单一交易引起的价格变化被称为交易的<a class="ae lx" href="https://help.1inch.io/en/articles/4585109-what-is-price-impact-vs-price-slippage-in-defi" rel="noopener ugc nofollow" target="_blank"> <em class="lw">价格影响</em> </a>。价格变化有多大？输入XYK定价。</p><h1 id="f2b3" class="lc kd hi bd ke ld le lf ki lg lh li km lj lk ll kp lm ln lo ks lp lq lr kv ls bi translated">XYK定价模型</h1><p id="d0ba" class="pw-post-body-paragraph iq ir hi is b it kx iv iw ix ky iz ja jb lt jd je jf lu jh ji jj lv jl jm jn hb bi translated">XYK定价模型是一种计算代币价格的机制。它指出，一旦提供了流动性，<em class="lw">池1 </em>中的代币总数乘以<em class="lw">池2 </em>中的代币总数等于某个常数，由此可以导出代币价格。</p><figure class="lz ma mb mc fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mh"><img src="../Images/6a44fe8c31208f83cdbe6dd487d76c89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wCyC6W-Y5K3fbe9Y6-oWhg.png"/></div></div></figure><ul class=""><li id="9127" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated"><em class="lw"> x = </em> <em class="lw">池1中的令牌总数</em></li><li id="9313" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">y = <em class="lw">池2中的令牌总数</em></li><li id="99d5" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated"><em class="lw">k = x和y的乘积；它用于计算令牌成本，我们将在下面看到</em></li></ul><p id="d3ce" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">图二:</strong></p><figure class="lz ma mb mc fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mi"><img src="../Images/a7a160baca139717964bc429247f4bea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W1A7cyBF2HbswNWtZwKKJQ.png"/></div></div></figure><p id="0485" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">从上面可以看出，从自动做市商处购买VITA代币的行为改变了这些代币的价格(0.01 ETH → 0.04 ETH)。这种关系可以通过图3中的下图来可视化:</p><p id="3ede" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">图3: </strong></p><figure class="lz ma mb mc fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mj"><img src="../Images/e2c9116d9b3897031088709dc0645101.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MNTHom1hcnFzZR6Tzd7cnQ.png"/></div></div><figcaption class="md me et er es mf mg bd b be z dx translated">XYK定价曲线，可视化。该图仅用于说明目的；它并不代表上面的ETH-VITA示例。<a class="ae lx" href="https://github.com/cucupac/defi" rel="noopener ugc nofollow" target="_blank">这个图的代码可以在Github </a>上查看。</figcaption></figure><p id="461d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">上图描绘了由事务触发的从<strong class="is hj"><em class="lw">【t₁】</em></strong>到<strong class="is hj"><em class="lw">【t₂】</em></strong>的状态变化，由此<strong class="is hj"><em class="lw">δx</em></strong>令牌被花费以获得<strong class="is hj"><em class="lw">δy</em></strong>令牌。现在，当前往<strong class="is hj"> <em class="lw"> T₂ </em> </strong>到<strong class="is hj"> <em class="lw"> T₃ </em> </strong>时，请注意，再次支付<strong class="is hj"><em class="lw">δx</em></strong>代币将产生数量少得多的y代币——随着时间的推移购买更多的y代币，y代币会变得更贵。鉴于由<em class="lw"> XYK定价模型</em>促成的交易会改变基础资产的合约内价格，在任何给定时间，合约价格都有可能与其他交易所的价格不同步。这种价格差异为交易者创造了套利机会，迫使合约价格与整体市场价格相匹配。</p><h1 id="11ad" class="lc kd hi bd ke ld le lf ki lg lh li km lj lk ll kp lm ln lo ks lp lq lr kv ls bi translated">XYK定价的潜在问题</h1><h2 id="40d8" class="kc kd hi bd ke kf kg kh ki kj kk kl km jb kn ko kp jf kq kr ks jj kt ku kv kw bi translated">价格影响</h2><p id="7b51" class="pw-post-body-paragraph iq ir hi is b it kx iv iw ix ky iz ja jb lt jd je jf lu jh ji jj lv jl jm jn hb bi translated">如上所述，每一次互换都改变了标的证券的价格。根据<strong class="is hj"><em class="lw"/></strong>【₁】<strong class="is hj"><em class="lw">(x</em></strong>₁<strong class="is hj"><em class="lw">，y</em></strong>₁<strong class="is hj"><em class="lw">)</em></strong>在定价曲线上的位置以及流动性池的<em class="lw">深度</em>，大宗交易可以对代币的价格产生实质性影响。一个<em class="lw">深</em>的流动性池要求<strong class="is hj"> <em class="lw"> X </em> </strong>和<strong class="is hj"> <em class="lw"> Y </em> </strong>相对于大多数互换的规模而言都很大。换句话说，当<strong class="is hj"> <em class="lw"> X </em> </strong>和<em class="lw"/>Y分别比<strong class="is hj"><em class="lw">δX</em></strong>和<strong class="is hj"><em class="lw">δY</em></strong>大时，价格影响小。</p><h2 id="51f7" class="kc kd hi bd ke kf kg kh ki kj kk kl km jb kn ko kp jf kq kr ks jj kt ku kv kw bi translated"><strong class="ak">滑移</strong></h2><p id="4b81" class="pw-post-body-paragraph iq ir hi is b it kx iv iw ix ky iz ja jb lt jd je jf lu jh ji jj lv jl jm jn hb bi translated"><a class="ae lx" href="https://help.1inch.io/en/articles/4585109-what-is-price-impact-vs-price-slippage-in-defi" rel="noopener ugc nofollow" target="_blank">滑点</a>是指从你提交交易到你的交易在区块链执行的这段时间内，其他交易者对价格的综合影响。与价格影响类似，深度流动性池有助于减轻滑点。如果合计的<strong class="is hj"><em class="lw">δX</em></strong>s和<strong class="is hj"><em class="lw">δY</em></strong>s(与每笔交易相关联的一对<strong class="is hj"><em class="lw">δX</em></strong>和<strong class="is hj"><em class="lw">δY</em></strong>)与<strong class="is hj"> <em class="lw"> X </em> </strong>和<strong class="is hj"><em class="lw">Y</em></strong>(X和Y代币的总量)相比较小，那么滑点将成比例地较小。相反，如果流动性池较浅，总交易活动有可能对交易提交和交易执行之间的代币价格产生较大影响。</p><h2 id="3061" class="kc kd hi bd ke kf kg kh ki kj kk kl km jb kn ko kp jf kq kr ks jj kt ku kv kw bi translated">非永久性损失</h2><p id="1398" class="pw-post-body-paragraph iq ir hi is b it kx iv iw ix ky iz ja jb lt jd je jf lu jh ji jj lv jl jm jn hb bi translated">当提取时您的流动性池基于百分比的份额的<strong class="is hj">值比您在提取时存入</strong>的代币 <strong class="is hj">数量的<strong class="is hj">值少<em class="lw"/>时，发生非永久性损失，如果您从未存入代币并持有代币。尽管您将获得流动资金池中的公平份额(无论您提供的比例是多少)，但在提款时，您可能会获得不同数量的X和Y代币。换句话说，持有代币可能比将代币提供给流动性池更好。通过一个例子可以最好地理解这个概念:</strong></strong></p><p id="f47a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">示例:</strong>给定上面的ETH-VITA示例，假设:</p><ul class=""><li id="c093" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated">你将1 ETH和100 VITA存入流动资金池。</li><li id="5f80" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">存款后，流动资金池有10个ETH和1，000个VITA →您拥有该池的10%。</li></ul><figure class="lz ma mb mc fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mk"><img src="../Images/2ef5452c5466e100129ffd1b94cc4024.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ImA1myyM0ZgGoE5rl7fgzA.png"/></div></div><figcaption class="md me et er es mf mg bd b be z dx translated">这张图片的灵感来自币安写的一篇关于短暂损失的伟大文章。</figcaption></figure><p id="3cef" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">更正式地说，非永久性损失可以定义为:</p><figure class="lz ma mb mc fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ml"><img src="../Images/fac221512acc829619b020992609207f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*48W8I9ECcSJHD0bvWioYwg.png"/></div></div><figcaption class="md me et er es mf mg bd b be z dx translated">这项工作的灵感来自于Ryan Tian的文章，关于池流动性的XYK模型。</figcaption></figure><p id="a5a0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对于那些感兴趣的人，我将把它留给你继续探索非永久性损失的数学。</p><h1 id="ba50" class="lc kd hi bd ke ld le lf ki lg lh li km lj lk ll kp lm ln lo ks lp lq lr kv ls bi translated">结论</h1><p id="d7c6" class="pw-post-body-paragraph iq ir hi is b it kx iv iw ix ky iz ja jb lt jd je jf lu jh ji jj lv jl jm jn hb bi translated">我真诚地希望自动化做市商和XYK定价模型在读完这篇文章后会变得更有意义。如果您想了解最新的以太坊和Web3知识，请随时订阅<a class="ae lx" href="https://adamcuc.substack.com/" rel="noopener ugc nofollow" target="_blank">我的简讯</a>！此外，如果你愿意捐款支持我的写作，请在<strong class="is hj"> cucupac.eth </strong>随意捐款；每一点都非常感谢！谢谢你。</p></div></div>    
</body>
</html>