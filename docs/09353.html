<html>
<head>
<title>Python Pandas Tutorial — 5</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python熊猫教程— 5</h1>
<blockquote>原文：<a href="https://medium.com/codex/python-pandas-tutorial-5-c695ba8d3f6d?source=collection_archive---------12-----------------------#2022-10-14">https://medium.com/codex/python-pandas-tutorial-5-c695ba8d3f6d?source=collection_archive---------12-----------------------#2022-10-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="86a9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">本教程将介绍更新行和列——修改数据帧中的数据。</p><p id="5591" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是我们使用字典创建的数据框。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/dbf2013aab952b494a51b3aac956971d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1070/format:webp/1*AryxPAHaZTjiwjzm7MbY9w.png"/></div></figure><p id="b182" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们想将列名从first更新为first_name。要完成这个动作，熊猫有几种可能的方法。下面是几个例子。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es jl"><img src="../Images/e148d338c22beadb6def19311eb47990.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LHfAI8laaFs4PluGmzK1MA.png"/></div></div></figure><p id="97a7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本例中，我们为数据框分配了一个新的列名，当我们为所有列传递值时，这将起作用，但是如果我们想更新一些列，那么我们必须使用“rename”方法。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es jq"><img src="../Images/58e7cd520702a0d7e258d4b945e7a4d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lXwV157IeTgsuVTGknMhug.png"/></div></div></figure><p id="a404" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在rename方法中，我们需要将列名作为键-值对传递，旧值应该在左边传递，新值应该在右边传递。如果我们希望更改在数据框中生效，还需要传递inplace = True。</p><p id="7173" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果我们需要将所有列的名称都改为大写或小写，为了达到同样的目的，我们可以使用列表压缩。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es jr"><img src="../Images/108b4b95bf69ab64af9d6ff084e7ee57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UD4aNcDMWDYILSSknHKRKA.png"/></div></div></figure><p id="67d0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">此外，如果我们想在列名中用空格替换' _ '，反之亦然，那么我们可以使用' str.replace '方法来实现同样的目的。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es js"><img src="../Images/3e148db050dd0b4b0ca7a9c5c2ce0c38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WwSgzf0vCZ7BAgn85ukqPg.png"/></div></div></figure><p id="513d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在下一个例子中，我们将更新行中的值，有几种方法可以执行这个操作，所以让我们逐个检查。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es jt"><img src="../Images/2eee95a7ba33b2402ca950167ff86099.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wqWFVL-TlEay0dZXzuCczQ.png"/></div></div></figure><p id="ef0a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这里，首先，我们使用条件标识了行，然后传递新值，并在第二行中更新。</p><p id="38e9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">此外，如果我们只想更新几个值，而不是整行，那么我们可以在“loc”中指定列和新值。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es ju"><img src="../Images/c93626577db7bc872a3b1eee919287e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1Z8-2f2Gezv1TTn1rzZx5g.png"/></div></div></figure><p id="1d84" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">此外，我们还有一个方法“at”来更新行中的单个值，我们也可以使用“loc”来更新。但是我更喜欢用‘loc’而不是‘at’。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jv"><img src="../Images/6ca0b36b1aac5330700cf8df6ba537a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1318/format:webp/1*ILi3dkdsDuunnVH7F-Sr8g.png"/></div></figure><p id="ef5e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，如果我们想要更新多行，在Pandas中有多种可能的方法，我们将从一个简单的方法开始，而不是寻找更高级的方法。假设我们希望所有的电子邮件地址都转换成小写，下面是同样的例子。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jw"><img src="../Images/e922c99593838683d47f7774737fc59c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1394/format:webp/1*MXgdy8dvB33hovPm9aPKRA.png"/></div></figure><p id="c51b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们已经找到了所有的电子邮件值，并使用' str.lower()'方法将它们转换为小写。</p><p id="f89f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们将介绍一种用于更新数据框或数据系列的更高级的方法。</p><ol class=""><li id="037e" class="jx jy hi ih b ii ij im in iq jz iu ka iy kb jc kc kd ke kf bi translated"><strong class="ih hj"> apply() </strong> — Pandas.apply允许用户传递一个函数，并将其应用于Pandas系列的每个值。它适用于数据帧和序列，但两者的行为是不同的。让我们检查几个带有系列的示例，然后我们将讨论数据框架。</li></ol><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kg"><img src="../Images/fb151480bbf9f958e88cad2fe0eb9b82.png" data-original-src="https://miro.medium.com/v2/resize:fit:940/format:webp/1*jurl9d31ao4q5bqX1Aziqg.png"/></div></figure><p id="9d6e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里，我们将“len”函数应用于email列，它返回每个值的长度，而不是预定义的函数，我们可以创建自己的函数，并使用apply()传递相同的函数。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es kh"><img src="../Images/fe591c9391039f069aed3abba941ef2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C0pJ5CGrMfvJGbT88L5DCQ.png"/></div></div></figure><p id="ccc2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们制作了一个将值转换为大写字母的函数，我们在序列中传递相同的值，它以大写字母返回值，但在数据框中没有更新，为了更新相同的值，需要在左侧传递列名。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es ki"><img src="../Images/ae6a2b0e667c5d71c4f65d1d63219f9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WTGaxLHQIRgvzuXLwpI8qA.png"/></div></div></figure><p id="5d31" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">同样，对于简单的需求，我们也可以用apply()传递lambda函数。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kj"><img src="../Images/745604ed36cadeddd67a185468d55293.png" data-original-src="https://miro.medium.com/v2/resize:fit:1324/format:webp/1*7r8aT7QWAYxnBEDrngo0bg.png"/></div></figure><p id="93b0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们在数据框中使用apply()方法并验证结果。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kk"><img src="../Images/fa48c9e0a78a76b61e3e75522f940c9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:914/format:webp/1*3Nc2K1thc1tGwIXwSGnrCA.png"/></div></figure><p id="c7c1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里，我们得到的结果有点出乎意料，它不是得到数据框中每个值的长度，而是返回列和列中存在的元素数量。</p><p id="ee03" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">所以序列中的apply()函数应用序列中的每个值，数据帧中的apply()函数应用数据帧的每个序列。</strong></p><p id="25df" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.<strong class="ih hj">apply map()</strong>—apply map()函数用于将函数应用于数据帧，不适用于序列。下面用applymap()检查len()函数示例。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kl"><img src="../Images/2418746afe8253c93db8b0369aba338a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1060/format:webp/1*bZfKqv6h_kAq4PsezBAg4w.png"/></div></figure><p id="b27c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，现在它对数据框的每个值应用一个函数并提供结果。同样，我们也可以使用applymap()尝试lower()或upper()示例。</p><p id="94d7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3.<strong class="ih hj"> map() — </strong> map()仅适用于系列，用于将系列值替换为其他值。让我们看看下面的例子。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es jt"><img src="../Images/fbbb25d298a65030965c157651d678c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tXy1kbqhplSVh5WO5Cot7w.png"/></div></div></figure><p id="610d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这个例子中，我们替换了第一个名字系列中的两个值，但是这里要注意的一点是，我们没有替换的第三个值被转换为NaN，意思是不是一个数字，这实际上是我们不想要的。我们希望替换这两个值，并保持第三个值不变。为了实现同样的代替map()，我们可以使用replace()方法。</p><p id="96aa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">4.<strong class="ih hj"> replace() </strong> — replace()用于将数据帧的值动态替换为其他值。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es km"><img src="../Images/518d7ac5e81bb35fcf8c4eb7e6bbae7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Yp7U0nR52AHz6BnVqSNISg.png"/></div></div></figure><p id="563b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在下一篇博客中，我们将讨论在数据框中添加/移除行。</p></div></div>    
</body>
</html>