# 中处理错误的几种方法。网

> 原文：<https://medium.com/codex/a-few-ways-to-handle-errors-in-net-d101dc5295a7?source=collection_archive---------5----------------------->

错误处理始终是应用程序的重要组成部分。当处理一些业务逻辑请求时，总是需要让用户知道执行结果是成功还是失败。

假设用户向您发送了一个端点请求，您有一个处理该请求的服务，但是由于业务验证失败了。处理这种情况最简单的方法是创建一个响应模型，在该模型中输入错误和执行结果的状态，以确定它是成功还是失败。

我给你举个简单的例子。

假设我们有一个 ExampleController.cs，其中有一个**测试**端点。

在测试方法中，我们调用 CreateAsync 方法来处理请求。

让我们假设我们有一些业务验证要做，其中一个失败了，控制器需要被通知这个错误以返回适当的状态代码给调用者。正如您在上面看到的，我们已经创建了一个 ExampleResponse 类，它包含控制器返回状态代码所需的所有信息。

但是如果我们的代码库增长了，我们最终会变成一团泥。这也会使开发变得更加困难。

让我们看看另一种解决方案。

避免重复代码的一个更好的方法是，我们可以创建一个泛型类，将数据与执行结果状态分开。

下面是结果类的一个例子。

如您所见，数据模型和执行结果是分离的。这样，我们不需要向数据模型添加额外的属性。此外，我们可以为我们的服务创建一个抽象类，在这里我们可以处理结果类的创建。

在上面的例子中，我们已经创建了可以在前面的服务中使用的基本服务。

我们可以重构 ExampleService

现在，您可以轻松地添加更多验证并阅读代码。

但是如果你想在另一个方法中使用现有的方法呢？使用上面的解决方案，您将会有很多不必要的验证。此外，还为控制器创建了 result 类来通知客户机执行结果。一旦你使用了现有的方法，你就必须保持它。首先，你必须检查它是否有任何故障。如果失败，您必须将结果错误传递给当前方法。解决这个问题的更好的方法是使用异常。

有许多方法可以实现上述解决方案。例如，您可以从一个方法中抛出一个异常，或者拥有一个具有适当方法的抽象类。我更喜欢使用抽象类；因为它更容易阅读和使用。

首先，让我们重构我们的基础服务。

我们已经从服务中删除了 Succeeded 方法，因为我们没有 result 类。如果成功，我们可以直接返回数据。此外，为了可读性，我在这里使用了泛型方法。在我们的 ExampleService 中，其他一切都将保持不变。您可以在控制器或中间件中处理异常。

一些足智多谋的链接:

1.  [https://github.com/gnaeus/OperationResult](https://github.com/gnaeus/OperationResult)
2.  [https://docs . Microsoft . com/en-us/aspnet/core/we b-API/handle-errors](https://docs.microsoft.com/en-us/aspnet/core/web-api/handle-errors?view=aspnetcore-5.0)