# å¤šå…ƒçº¿æ€§å›å½’

> åŸæ–‡ï¼š<https://medium.com/codex/linear-regression-on-multiple-variables-1893e4d940b1?source=collection_archive---------8----------------------->

![](img/3095f639872efc226aa9ce9e04fbe3a7.png)

å¸ƒè±å…‹Â·æƒ å‹’åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) ä¸Šæ‹æ‘„çš„ç…§ç‰‡

ç†è§£åœ¨ sci-kit è¿™æ ·çš„æµè¡Œåº“çš„å¹•åå‘ç”Ÿäº†ä»€ä¹ˆæ¥å®ç°å„ç§æœºå™¨å­¦ä¹ ç®—æ³•ï¼Œæ˜¯ä»»ä½•æ•°æ®ç§‘å­¦å®¶æ—…ç¨‹ä¸­æœ€å›°éš¾çš„éƒ¨åˆ†ä¹‹ä¸€ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»Šå¤©æƒ³åˆ°äº†å¦ä¸€ä¸ªæœºå™¨å­¦ä¹ ç®—æ³•ã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†æ·±å…¥äº†è§£è¿™ç§æ–¹æ³•ï¼Œå¯¹å…¶è¿›è¡Œç¼–ç ï¼Œç„¶åå°†å…¶ä½œä¸ºé¢„æµ‹æ¨¡å‹æ¥åº”ç”¨ã€‚

## ä»€ä¹ˆæ˜¯å¤šå…ƒçº¿æ€§å›å½’ï¼Ÿ

å¤šå˜é‡çº¿æ€§å›å½’(å¯¹å¤šä¸ªå˜é‡çš„çº¿æ€§å›å½’)ç±»ä¼¼äºç®€å•çº¿æ€§å›å½’æ¨¡å‹æˆ–å•å˜é‡çº¿æ€§å›å½’æ¨¡å‹ *(* [***ç‚¹å‡»æ­¤å¤„***](/codex/linear-regression-on-single-variable-f35e6a73dab6) *(å¦‚æœä½ è¿˜æ²¡æœ‰æŸ¥çœ‹æˆ‘å…³äºå•å˜é‡çº¿æ€§å›å½’çš„åšå®¢çš„è¯)*ï¼Œä½†æ˜¯ç”±äºæœ‰å¤šä¸ªè‡ªå˜é‡è´¡çŒ®äºå› å˜é‡ï¼Œå¯¼è‡´è¦è®¡ç®—è®¸å¤šç³»æ•°ï¼Œå¹¶ä¸”ç”±äºé¢å¤–çš„å˜é‡è€Œå¯¼è‡´æ›´å¤æ‚çš„è®¡ç®—ã€‚

## æ¨¡å‹è¡¨ç¤º

![](img/76c03893994f5a624054455713fea3d4.png)

è®°å·

![](img/b2cfa559af359e657f520464a9aa3e17.png)

## åŠ è½½æ•°æ®

å‡è®¾ä½ æ­£åœ¨å‡ºå”®ä½ çš„æˆ¿å­ï¼Œä½ æƒ³çŸ¥é“ä¸€ä¸ªå¥½çš„å¸‚åœºä»·æ ¼æ˜¯å¤šå°‘ã€‚ä¸€ç§æ–¹æ³•æ˜¯é¦–å…ˆæ”¶é›†æœ€è¿‘å‡ºå”®çš„æˆ¿å±‹ä¿¡æ¯ï¼Œå¹¶åˆ¶ä½œä¸€ä¸ªæˆ¿ä»·æ¨¡å‹ã€‚è€ƒè™‘ä¸€ä¸ªåŒ…å«ä¿„å‹’å†ˆå·æ³¢ç‰¹å…°æˆ¿ä»·çš„æ•°æ®é›†ã€‚

è®©æˆ‘ä»¬å¯¼å…¥æ‰€éœ€çš„åº“å¹¶å°†æ•°æ®é›†åŠ è½½åˆ° Pandas æ•°æ®æ¡†æ¶ä¸­:

```
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
```

```
house_data = pd.read_csv('ex1data2.txt', header=None)
house_data.head()
```

![](img/d195858130cbd1c93e7b7d12a77722ab.png)

è¾“å‡º:house_data.head()

è¿™é‡Œçš„ ***ç¬¬ä¸€æ *** æ˜¯ çš„ ***é¢ç§¯(å¹³æ–¹è‹±å°º)ï¼Œç¬¬ ***ç¬¬äºŒæ *** æ˜¯ ***å§å®¤æ•°*** ï¼Œ ***ç¬¬ä¸‰æ *** æ˜¯ ***æˆ¿ä»·*** ã€‚è¿™é‡Œ n = 2 ( **å³**æˆ¿é—´çš„å¤§å°å’Œæ•°é‡)***

```
house_data.describe()
```

![](img/f8918ef89fc8a4b2c57fd5e671ab875c.png)

è¾“å‡º:data.describe()

## ç‰¹å¾æ ‡å‡†åŒ–

åœ¨æˆ‘ä»¬ç€æ‰‹è§£å†³ä¸€ä¸ªé—®é¢˜ä¹‹å‰ï¼Œæˆ‘ä»¬å¿…é¡»é¦–å…ˆæ£€æŸ¥å’Œåˆ†ææ•°æ®ã€‚è¿™ä¸€æ­¥ä¹ä¸€çœ‹ä¼¼ä¹å¾ˆç®€å•ï¼Œä½†å¦‚æœæ²¡æœ‰æ­£ç¡®å®Œæˆï¼Œå®ƒä¼šéå¸¸ç—›è‹¦ã€‚

æ•°æ®è§„èŒƒåŒ–(ç‰¹å¾ç¼©æ”¾)çš„ç›®çš„æ˜¯ä»€ä¹ˆï¼Ÿ
è¿™æ˜¯å› ä¸ºæˆ‘ä»¬çš„ä¸€äº›ç‰¹æ€§å¯èƒ½åœ¨ 0â€“1 èŒƒå›´å†…ï¼Œè€Œå…¶ä»–ç‰¹æ€§å¯èƒ½åœ¨ 0â€“1000 èŒƒå›´å†…ã€‚å¦‚æœæ‚¨æŒ‰åŸæ ·è¾“å…¥æ•°æ®ï¼Œæ‚¨å¯èƒ½ä¼šé‡åˆ°ä¸åˆé€‚çš„é£é™©ã€‚

![](img/aa1960b3770fd201b5c24a7786c1f1af.png)

æ— ç‰¹å¾ç¼©æ”¾

ä»ä¸Šé¢çš„å›¾åƒä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœæ²¡æœ‰ç‰¹å¾ç¼©æ”¾ï¼Œæˆ‘ä»¬çš„è½®å»“å°†è¢«æ‹‰é•¿ï¼Œå¯¼è‡´æ¢¯åº¦ä¸‹é™è¿‡ç¨‹åœ¨å¤§é‡è¿­ä»£åæ‰¾åˆ°æœ€å°å€¼ï¼Œå‡æ…¢äº†æˆ‘ä»¬çš„æ–¹æ³•ï¼Œæœ‰æ—¶å¾ˆéš¾è¯†åˆ«æœ€å°å€¼ã€‚

![](img/3dce34e3af9190d996f82e160d1810b2.png)

ä½¿ç”¨ç‰¹å¾ç¼©æ”¾

ä»ä¸Šå›¾æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œç‰¹å¾ç¼©æ”¾åï¼Œæ¢¯åº¦ä¸‹é™ä»¥è¾ƒå°‘çš„æ­¥æ•°æ‰¾åˆ°æœ€å°å€¼ã€‚è¿™åŠ å¿«äº†æˆ‘ä»¬çš„ç®—æ³•ã€‚

æˆ‘ä»¬å°†ä½¿ç”¨**å‡å€¼å½’ä¸€åŒ–**ä»¥ç›¸ä¼¼çš„æ¯”ä¾‹ç¼©æ”¾æˆ‘ä»¬çš„ç‰¹å¾ï¼Œ

å°† xáµ¢æ›¿æ¢ä¸º xáµ¢-Î¼áµ¢ï¼Œä½¿ç‰¹å¾çš„å¹³å‡å€¼çº¦ä¸ºé›¶(ä¸é€‚ç”¨äº xâ‚€)

![](img/e6ec83b8fc0e0053652eef0710664efc.png)

å‡å€¼å½’ä¸€åŒ–

ç¤ºä¾‹:

![](img/1f57e24689f9f2f15be16fbf7e02c8b0.png)

ç‰¹å¾ç¼©æ”¾å‰

![](img/63b85aeec9b3ebf62340f558e217f1d4.png)

ç‰¹å¾ç¼©æ”¾å

```
def featureNormalize(X):
    mean = np.mean(X, axis=0)
    std = np.std(X, axis=0)

    X_norm = (X - mean)/std
    return X_norm, mean, stdmod_house_data = house_data.values
m2 = len(mod_house_data[:, 2])
X2 = mod_house_data[:, :2].reshape(m2, 2)
y2 = mod_house_data[:, 2].reshape(m2, 1)X2, mu, sigma = featureNormalize(X2)
X2 = np.column_stack((np.ones((m2, 1)), X2))
```

![](img/4b04090b34a14d7c409b9b2d203fad55.png)

æ ‡å‡†åŒ–å

## å¤šå…ƒå›å½’å‡è®¾

åœ¨å¤šå…ƒå›å½’ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å¤šä¸ªå˜é‡æ¥é¢„æµ‹è¾“å‡ºï¼Œå› æ­¤æˆ‘ä»¬çš„å‡è®¾æ˜¯ï¼Œ

![](img/ab676e24ddbcb5032270572ed0276c2d.png)

å‡è®¾

è¿™é‡Œï¼Œ **Î¸áµ—(Theta è½¬ç½®)**æ˜¯åŒ…å«Î¸áµ¢(â„â¿âºçš„å¤§å°ï¼Œn =ç‰¹å¾æ•°/åˆ—æ•°)æ‰€æœ‰å€¼çš„è¡Œå‘é‡ï¼Œ **X** (æ³¨:è¿™é‡Œâ€œxâ€ä»£è¡¨çŸ©é˜µæˆ–åˆ—å‘é‡)æ˜¯åŒ…å« **xáµ¢** æ‰€æœ‰å€¼çš„åˆ—å‘é‡(â„â¿âºçš„å¤§å°)(æ³¨:è¿™é‡Œ'xáµ¢'ä»£è¡¨æ•°æ®é›†ä¸­çš„æ¯ä¸€åˆ—)ã€‚

## ä»·å€¼å‡½æ•°

ç›®æ ‡æ˜¯è®¾ç½®å‚æ•°ï¼Œä½¿ h(x)æ¥è¿‘æ¯ä¸ª x çš„ y å€¼ã€‚ä¾‹å¦‚ï¼Œé€‰æ‹©Î¸â‚€å’ŒÎ¸â‚ï¼Œä½¿ h(x)æ¥è¿‘æ¯ä¸ª x çš„ y å€¼ã€‚
è¯¥æ¡ä»¶å¯ä»¥ç”¨æ•°å­—è¡¨ç¤ºå¦‚ä¸‹:

![](img/beb4b30704bb600e78b4a39ba18cbc7c.png)

ä»·å€¼å‡½æ•°

äº†è§£æ›´å¤šå…³äºä»£ä»·å‡½æ•°çš„çŸ¥è¯†( [***ç‚¹å‡»æ­¤å¤„***](/codex/linear-regression-on-single-variable-f35e6a73dab6)**äº†è§£æˆ‘ä¸Šä¸€ç¯‡æ–‡ç« ä¸­æ›´å¤šå…³äºä»£ä»·å‡½æ•°çš„çŸ¥è¯†)ã€‚**

```
*def compute_cost(X, y, theta):
    m = len(y)
    h_theta = X.dot(theta)
    J = 1/(2*m) * np.sum((h_theta-y)**2)
    return Jtheta2 = np.zeros((3, 1))
compute_cost(X2,y2,theta2)*
```

## *å¤šå…ƒå›å½’çš„æ¢¯åº¦ä¸‹é™*

*åœ¨æˆ‘ä»¬ä¹‹å‰çš„æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å·²ç»åœ¨å•å˜é‡å›å½’ä¸Šå®ç°äº†æ¢¯åº¦ä¸‹é™ã€‚ç°åœ¨å”¯ä¸€çš„åŒºåˆ«å°±æ˜¯ matrix X é‡Œå¤šäº†ä¸€ä¸ªç‰¹å¾(æƒ³äº†è§£æ›´å¤šæ¸å˜ä¸‹é™ [***ç‚¹å‡»è¿™é‡Œ***](/codex/linear-regression-on-single-variable-f35e6a73dab6) )*

*![](img/88856982c0f0fa6139bd40c8652cf42b.png)*

*æ›´æ–°è§„åˆ™*

## *é€‰æ‹©å­¦ä¹ ç‡*

*Alpha æˆ–å­¦ä¹ ç‡å†³å®šäº†ç®—æ³•è¾¾åˆ°æœ€å°æˆæœ¬å€¼(å³ï¼Œç»™å‡ºæœ€å°æˆæœ¬å€¼çš„å‚æ•°å€¼)æ‰€éœ€çš„æ­¥é•¿ã€‚*

*ç°åœ¨ï¼Œæˆ‘ä»¬å°†ä¸ºæ•°æ®é›†å°è¯•ä¸åŒçš„å­¦ä¹ é€Ÿç‡ï¼Œå¹¶æ‰¾åˆ°ä¸€ä¸ªå¿«é€Ÿæ”¶æ•›çš„å­¦ä¹ é€Ÿç‡ã€‚*

*![](img/9980aa3bf4cc55ac9e61972f604d3d4f.png)*

*å½“Î±è¾ƒå°æ—¶ï¼Œæ¢¯åº¦ä¸‹é™éœ€è¦æ›´å¤šçš„æ—¶é—´æ¥æ”¶æ•›ï¼Œè€Œå½“Î±è¾ƒå¤§æ—¶ï¼Œæ¢¯åº¦ä¸‹é™ä¼šè¿‡å†²è€Œæ— æ³•æ”¶æ•›ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å°è¯•ä¸åŒçš„Î±å€¼æ¥æ‰¾åˆ°ä¸€ä¸ªå¥½çš„å­¦ä¹ ç‡(Î±)ã€‚æˆ‘å»ºè®®å°è¯•å¯¹æ•°æ ‡åº¦ä¸Šçš„Î±å€¼ï¼Œå¤§çº¦æ˜¯å‰ä¸€å€¼çš„ 3 å€(å³ 0.3ã€0.1ã€0.03ã€0.01 ç­‰)ã€‚*

```
*lr = [0.01, 0.03, 0.09, 0.1, 0.3, 0.9]
J_histories = []
for x in lr:
    theta2, J_history = gradientDescent(X=X2, y=y2, theta=theta2, alpha=x, n_iters=100, graph=False)
    J_histories.append(J_history)*
```

*é’ˆå¯¹ä¸åŒçš„å­¦ä¹ é€Ÿç‡å¯è§†åŒ– J(Î¸),*

```
*len_J = len(J_histories[0])
for x in range(len(lr)):
    plt.plot(J_histories[x], label=lr[x])
plt.xlabel("No. of Iterations")
plt.ylabel("J(theta)")
plt.title("Cost function using Gradient Descent")
plt.title('Learning rates')
plt.legend(loc=1)*
```

*![](img/f7d800fa42b4a91e50d13249d4382ada.png)*

*J(Î¸)è¡¨ç¤ºä¸åŒçš„å­¦ä¹ é€Ÿç‡(Î±)*

*ä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼ŒÎ±=0.01 æ˜¯ä¸é”™çš„é€‰æ‹©ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ä½¿ç”¨ 0.01 ä½œä¸ºå­¦ä¹ ç‡æ¥è®­ç»ƒæˆ‘ä»¬çš„æ¨¡å‹ã€‚*

```
*theta2, J_history2 = gradientDescent(X2, y2, theta2, 0.01, 400)
print(f"h(x) ={round(theta2[0,0],2)}+{round(theta2[1,0],2)}x1 + {round(theta2[2,0],2)}x2")*
```

*![](img/2ae5e9c71e420d10b0926f6d31be2442.png)*

## *é¢„è¨€*

*å…¬å¼ä¿æŒä¸å˜ï¼Œ*

*![](img/0bdf4089e85cd7bc880713c38209a879.png)*

```
*def predict(X, theta):
    predictions = np.dot(theta.T, X)
    return predictions[0]*
```

*åœ¨ä½¿ç”¨å®ƒè¿›è¡Œé¢„æµ‹ä¹‹å‰ï¼Œä¸è¦å¿˜è®°å¯¹å€¼è¿›è¡Œå½’ä¸€åŒ–ï¼Œ*

```
*x_sample = featureNormalize(np.array([1650, 3]))[0]
x_sample = np.append(np.ones(1),x_sample)
predict3 = predict(x_sample, theta2)
print(fâ€For size of house = 1650, Number of bedroom = 3, we predict a house value of ${round(predict3,0)}â€)*
```

*è¾“å‡º:å¯¹äºæˆ¿å±‹å¤§å°= 1650ï¼Œå§å®¤æ•°é‡= 3ï¼Œæˆ‘ä»¬é¢„æµ‹æˆ¿å±‹ä»·å€¼ä¸º 430447.0 ç¾å…ƒ*

## *ç»“è®º*

*ä»Šå¤©ï¼Œæˆ‘ä»¬çœ‹åˆ°äº†å‡è®¾ã€æˆæœ¬å‡½æ•°å’Œå¤šå˜é‡å›å½’çš„æ¢¯åº¦ä¸‹é™èƒŒåçš„æ¦‚å¿µã€‚ç„¶åä½¿ç”¨ python çš„ numpyã€pandas å’Œ matplotlib ä»å¤´å¼€å§‹åˆ›å»ºå®ƒã€‚æ•°æ®é›†å’Œæœ€ç»ˆä»£ç ä¸Šä¼ åˆ° githubã€‚*

*ç‚¹å‡»è¿™é‡ŒæŸ¥çœ‹[çº¿æ€§å›å½’](https://github.com/jagajith23/Andrew-Ng-s-Machine-Learning-in-Python/tree/gh-pages/Linear%20Regression)ã€‚*

# *å¦‚æœä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œé‚£ä¹ˆçœ‹çœ‹æˆ‘åœ¨è¿™ä¸ªç³»åˆ—ä¸­çš„å…¶ä»–æ–‡ç« *

## *1.[ä»€ä¹ˆæ˜¯æœºå™¨å­¦ä¹ ï¼Ÿ](/@jagajith23/what-is-machine-learning-daeac9a2ceca)*

## *2.[æœºå™¨å­¦ä¹ æœ‰å“ªäº›ç±»å‹ï¼Ÿ](/codex/what-are-the-types-of-machine-learning-53360b7db8b4)*

## *3.[ä¸€å…ƒçº¿æ€§å›å½’](/codex/linear-regression-on-single-variable-f35e6a73dab6)*

## *4.[é€»è¾‘å›å½’](/@jagajith23/logistic-regression-eee2fd028ffd)*

## *5.[ä»€ä¹ˆæ˜¯ç¥ç»ç½‘ç»œï¼Ÿ](/@jagajith23/what-are-neural-networks-3a0965e2ebfb)*

## *6.[ä½¿ç”¨ç¥ç»ç½‘ç»œçš„æ•°å­—åˆ†ç±»å™¨](/@jagajith23/digit-classifier-using-neural-networks-ad17749a8f00)*

## *7.[åˆ©ç”¨ K å‡å€¼èšç±»è¿›è¡Œå›¾åƒå‹ç¼©](/@jagajith23/image-compression-with-k-means-clustering-48e989055729)*

## *8.[ä½¿ç”¨ PCA å¯¹äººè„¸è¿›è¡Œé™ç»´](/@jagajith23/dimensionality-reduction-on-face-using-pca-e3fec3bb4cee)*

## *9.[ä½¿ç”¨å¼‚å¸¸æ£€æµ‹æ¥æ£€æµ‹ç½‘ç»œä¸Šçš„æ•…éšœæœåŠ¡å™¨](https://jagajith23.medium.com/detect-failing-servers-on-a-network-using-anomaly-detection-1c447bc8a46a)*

# *æœ€ååšçš„äº‹*

*å¦‚æœä½ å–œæ¬¢æˆ‘çš„æ–‡ç« ï¼Œè¯·é¼“æŒğŸ‘ä¸€ä¸ªè¿½éšè€…ä¼šæ˜¯ğŸ“ˆå›å½’çš„å’Œåª’ä½“å®£ä¼ è¿™ç¯‡æ–‡ç« æ˜¯æœ‰å¸®åŠ©çš„ï¼Œè¿™æ ·å…¶ä»–äººä¹Ÿå¯ä»¥é˜…è¯»å®ƒã€‚æˆ‘æ˜¯ Jagajithï¼Œæˆ‘ä¼šåœ¨ä¸‹ä¸€ä¸ªé‡ŒæŠ“ä½ä½ ã€‚*