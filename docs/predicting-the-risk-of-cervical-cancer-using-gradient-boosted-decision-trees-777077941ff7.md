# ä½¿ç”¨æ¢¯åº¦å¢å¼ºå†³ç­–æ ‘é¢„æµ‹å®«é¢ˆç™Œé£é™©

> åŸæ–‡ï¼š<https://medium.com/codex/predicting-the-risk-of-cervical-cancer-using-gradient-boosted-decision-trees-777077941ff7?source=collection_archive---------5----------------------->

![](img/8ab40e438c57a5d7e9fe291a27cf6f66.png)

[æ¥æº](https://www.sciencellonline.com/human-cervical-epithelial-cells.html)

**æ¯å¹´ï¼Œåœ¨ç¾å›½æœ¬åœŸæœ‰è¶…è¿‡ 13 ä¸‡åå¥³æ€§**è¢«è¯Šæ–­æ‚£æœ‰å®«é¢ˆç™Œï¼Œå…¶ä¸­è¶…è¿‡ 4000 åå¥³æ€§å°†æ­»äºè¯¥ç–¾ç—…ã€‚

å®«é¢ˆç™Œæ˜¯å…¨çƒå¥³æ€§ç¬¬å››å¤§å¸¸è§ç™Œç—‡ï¼Œä½†ç”±äºå®ƒä¼šéšç€æ—¶é—´çš„æ¨ç§»è€Œå‘å±•ï¼Œå®ƒä¹Ÿæ˜¯æœ€*å¯é¢„é˜²çš„ç™Œç—‡ç±»å‹ä¹‹ä¸€ã€‚*

å°½ç®¡å¤šç§å› ç´ éƒ½å¯èƒ½å¯¼è‡´ä¸ªäººæ‚£å®«é¢ˆç™Œï¼Œä½†æˆ‘ä»¬æ²¡æœ‰æ ‡å‡†çš„æ–¹æ³•æ¥è¯Šæ–­æœ‰æ‚£å®«é¢ˆç™Œé£é™©çš„å¥³æ€§ã€‚

ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬çŸ¥é“ä¸€åæœç”¨å£æœé¿å­•è¯å¹¶ç»å¸¸å¸çƒŸçš„å¦‡å¥³æœ‰æ‚£å®«é¢ˆç™Œçš„é£é™©ï¼Œå¥¹å°†èƒ½å¤Ÿæ¶ˆé™¤è¿™äº›é£é™©å› ç´ å¹¶æ”¹å˜å¥¹çš„ç”Ÿæ´»æ–¹å¼ä»¥é™åˆ¶å¥¹æ‚£å®«é¢ˆç™Œçš„æœºä¼šã€‚

é€šè¿‡åˆ©ç”¨**æœºå™¨å­¦ä¹ **ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å»ºç«‹é£é™©é¢„æµ‹æ¨¡å‹æ¥å¤§å¹…å‡å°‘è¢«è¯Šæ–­æ‚£æœ‰å®«é¢ˆç™Œå’Œæ­»äºå®«é¢ˆç™Œçš„å¥³æ€§äººæ•°ã€‚

ä¸ºäº†å»ºç«‹å®«é¢ˆç™Œçš„é£é™©é¢„æµ‹æ¨¡å‹ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨æç«¯æ¢¯åº¦å¢å¼ºç®—æ³•ï¼Œä¹Ÿç§°ä¸º **XGBoost ç®—æ³•ã€‚**

## äº†è§£ XGBoost ç®—æ³•

XGBoost ç®—æ³•æ˜¯ä¸€ä¸ªæœ‰ç”¨çš„ç®—æ³•ï¼Œå› ä¸ºå®ƒå¯ä»¥ç”¨äºå›å½’å’Œåˆ†ç±»ä»»åŠ¡ã€‚å®ƒä½¿ç”¨ç›‘ç£å­¦ä¹ å’Œæ¢¯åº¦æ¨è¿›ï¼Œè¿™æ„å‘³ç€å®ƒä»¥å¤šå†³ç­–æ ‘çš„å½¢å¼äº§ç”Ÿé¢„æµ‹æ¨¡å‹ã€‚

![](img/953c785aa84097e1e62decd8cc25cbc0.png)

[æ¥æº](https://analyticsindiamag.com/xgboost-internal-working-to-make-decision-trees-and-deduce-predictions/)

è¯¥ç®—æ³•é€šè¿‡ä»ä»¥å‰æ¨¡å‹é¢„æµ‹ä¸­çš„é”™è¯¯ä¸­å­¦ä¹ æ¥å®ç°æ›´å¥½çš„æœªæ¥é¢„æµ‹ã€‚å®ƒä»¥è¿ç»­çš„æ–¹å¼è®­ç»ƒå¼±æ¨¡å‹ã€‚å®ƒæ ¹æ®è®­ç»ƒæ•°æ®å»ºç«‹åˆæ­¥æ¨¡å‹ï¼Œå¹¶æ ¹æ®**æ®‹å·®**æˆ–ç¬¬ä¸€ä¸ªæ¨¡å‹çš„é”™è¯¯å»ºç«‹ç¬¬äºŒä¸ªæ¨¡å‹ã€‚é‡å¤æ­¤è¿‡ç¨‹ï¼Œç›´åˆ°åˆ›å»ºäº†æœ€å¤§æ•°é‡çš„æ¨¡å‹ï¼Œæˆ–è€…ç›´åˆ°æ¨¡å‹æä¾›äº†å‡†ç¡®çš„é¢„æµ‹ã€‚

åœ¨è¿™ä¸ªé¡¹ç›®ä¸­ï¼Œæ¨¡å‹å°†è¢«è¾“å…¥è¾“å…¥ç‰¹å¾ï¼ŒåŒ…æ‹¬ä¸ªäººçš„å¹´é¾„ã€æ€€å­•æ¬¡æ•°ã€å¸çƒŸé¢‘ç‡ã€å®«å†…èŠ‚è‚²å™¨(IUD)çš„å­˜åœ¨ï¼Œä»¥åŠä»–ä»¬æ˜¯å¦æ‚£æœ‰æ€§ç—…ï¼Œå¹¶å°†è¢«å‘ŠçŸ¥è¯¥å¦‡å¥³æ˜¯å¦åº”è¯¥æ¥å—æ´»æ£€ä»¥æ£€æŸ¥å®«é¢ˆç™Œçš„å­˜åœ¨ã€‚å¦‚æœå¥¹è¢«å‘ŠçŸ¥æ¥å—æ´»æ£€ï¼Œä½†æ²¡æœ‰å®«é¢ˆç™Œï¼Œå¥¹ä¼šçŸ¥é“è‡ªå·±å¯èƒ½æœ‰é£é™©ï¼Œå¹¶å¯ä»¥ç›¸åº”åœ°é‡‡å–è¡ŒåŠ¨ï¼Œä»¥å°†é£é™©é™è‡³æœ€ä½ã€‚

ä¸ºäº†è¿™ä¸ªé¡¹ç›®ï¼Œæˆ‘ä½¿ç”¨äº† 2017 å¹´çš„æ•°æ®é›†,è¯¥æ•°æ®é›†æ”¶é›†äº†å§”å†…ç‘æ‹‰åŠ æ‹‰åŠ æ–¯çš„åŠ æ‹‰åŠ æ–¯å¤§å­¦åŒ»é™¢(Hospital Universitario de Caracas)çš„å¥³æ€§ä¿¡æ¯ã€‚è¯¥æ•°æ®é›†åŒ…å« 858 åæ‚£è€…çš„äººå£ç»Ÿè®¡ä¿¡æ¯ã€ä¹ æƒ¯å’ŒåŒ»ç–—è®°å½•ã€‚

# 1.å¯¼å…¥åº“å’Œæ•°æ®é›†

![](img/6da1f830acff6ce01b98eeb7d2a81d02.png)

æ„å»ºæ¨¡å‹çš„ç¬¬ä¸€æ­¥æ˜¯å°†æˆ‘ä»¬çš„åº“å’Œæ•°æ®é›†å¯¼å…¥åˆ°æˆ‘ä»¬çš„ Jupyter ç¬”è®°æœ¬ä¸­ã€‚

> **pandas** :æœ€æµè¡Œçš„ python åº“ï¼Œç”¨äºæ•°æ®æ“ä½œå’Œåˆ†æã€‚åœ¨è¿™ä¸ªé¡¹ç›®ä¸­ï¼Œå®ƒä¸»è¦ç”¨äºæ•°æ®å¸§æ“ä½œã€‚
> 
> **NumPy** :ä¸€ä¸ª python åº“ï¼Œæä¾›å¯¹å¤§å‹å¤šç»´æ•°ç»„å’ŒçŸ©é˜µçš„æ”¯æŒï¼Œå¹¶å…·æœ‰é«˜çº§æ•°å­¦å‡½æ•°æ¥å¸®åŠ©æ“ä½œå’Œæ“çºµè¿™äº›æ•°ç»„ã€‚
> 
> **seaborn** å’Œ **matplotlib.pyplot** :ç”¨äºæ•°æ®å¯è§†åŒ–ã€‚
> 
> **plotly** :ç”¨äºäº¤äº’å¼æ•°æ®å¯è§†åŒ–ã€‚

ä¸€æ—¦æˆ‘ä»¬å®‰è£…äº†åº“ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ pandas å¯¼å…¥æ•°æ®é›†ã€‚æ•°æ®é›†åº”ä¿å­˜ä¸º CSV æ–‡ä»¶ã€‚ä¸‹è½½æˆ‘çš„æ•°æ®é›†æ—¶ï¼Œæˆ‘å°†å…¶å‘½åä¸ºâ€œå­å®«é¢ˆ _ ç™Œç—‡. csvâ€ï¼Œå¹¶èƒ½å¤Ÿå¯¼å…¥å®ƒï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚

```
cancer_df = pd.read_csv('cervical_cancer.csv')
```

# 2.æ¢ç´¢æ€§æ•°æ®åˆ†æ

è¿›è¡Œæ¢ç´¢æ€§æ•°æ®åˆ†æå¯¹äºæ¶ˆé™¤æ•°æ®é›†ä¸­çš„ä¸ä¸€è‡´æ€§è‡³å…³é‡è¦ï¼›å®ƒéœ€è¦åˆ é™¤é‡å¤ï¼Œçº æ­£é”™è¯¯ï¼Œå¹¶å¤„ç†ä¸¢å¤±çš„å€¼ã€‚

åœ¨é¡¹ç›®çš„è¿™ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†å¯è§†åŒ–æˆ‘ä»¬çš„æ•°æ®å¹¶åˆ é™¤ç©ºå€¼ã€‚

![](img/dbe2343ee90e0a3e7800322457262b83.png)

é¦–å…ˆï¼Œæˆ‘ä»¬æƒ³ä»æ•°æ®å¸§ä¸­è·å–ä¿¡æ¯ã€‚å½“æˆ‘ä»¬è¿è¡Œ *cancer_df.info( )* æ—¶ï¼Œæˆ‘ä»¬åº”è¯¥å¾—åˆ°ä¸€ä¸ªè¡¨ï¼Œå®ƒæ˜¾ç¤ºäº†æˆ‘ä»¬æœ‰å¤šå°‘æ¡ç›®(æˆ‘ä»¬æœ‰æ•°æ®çš„æ‚£è€…)å’Œ 36 åˆ—ï¼Œå®ƒä»¬æ˜¾ç¤ºäº†æˆ‘ä»¬çš„ä¸åŒç‰¹å¾ï¼Œä»ä¸ªä½“çš„å¹´é¾„åˆ°ä»–ä»¬çš„æ€§ç—…è¯Šæ–­æ•°é‡ã€‚

æˆ‘ä»¬è¿˜å¯ä»¥çœ‹åˆ°æ‰€æœ‰çš„åŠŸèƒ½éƒ½æœ‰éç©ºè®¡æ•°ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥çœ‹åˆ°ä¸åŒåŠŸèƒ½çš„æ•°æ®ç±»å‹ã€‚å¤§å¤šæ•°æ˜¯å¯¹è±¡ï¼Œç¨åæˆ‘ä»¬éœ€è¦å°†å®ƒä»¬è½¬æ¢æˆæ•°å€¼ã€‚

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡è¿è¡Œ *cancer_df.describe( )* è·å¾—ä¸€äº›å…³äºæˆ‘ä»¬çš„æ•°æ®å¸§çš„ç»Ÿè®¡ä¿¡æ¯ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ‚£è€…çš„å¹³å‡å¹´é¾„çº¦ä¸º 26.8 å²ã€‚

ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬åªçœ‹ dataframe è€Œä¸æè¿°å®ƒï¼Œé€šè¿‡åªè¿è¡Œ *cancer_dfï¼Œ*æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸¤åˆ—ä¸‹é¢æœ‰é—®å·ï¼›â€œSTDs:è‡ªé¦–æ¬¡è¯Šæ–­ä»¥æ¥çš„æ—¶é—´â€å’Œâ€œSTDs:è‡ªä¸Šæ¬¡è¯Šæ–­ä»¥æ¥çš„æ—¶é—´â€

è¿™äº›é—®å·æ˜¯ç¼ºå¤±æ•°æ®æˆ–ç©ºæ•°æ®çš„å ä½ç¬¦ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦å°†é—®å·æ›¿æ¢ä¸º *NaN* ï¼Œæ„æ€æ˜¯â€œä¸æ˜¯ä¸€ä¸ªæ•°å­—â€ï¼Œä»¥è¡¨ç¤ºå®ƒæ˜¯ä¸€ä¸ªç©ºå€¼ã€‚

```
cancer_df = cancer_df.replace('?', np.nan)
cancer_df
```

æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡çœŸå€¼æˆ–å‡å€¼æ¥å¯è§†åŒ–æˆ‘ä»¬çš„æ•°æ®æ¡†æ¶ï¼Œè¿™å°†å…è®¸æˆ‘ä»¬ç»˜åˆ¶çƒ­å›¾ï¼Œå¹¶æŸ¥çœ‹æ•´ä¸ªæ•°æ®ä¸­çš„ç©ºå€¼ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿è¡Œ *cancer_df.isnull()æ¥åšåˆ°è¿™ä¸€ç‚¹ã€‚*

æ•°æ®ä¸­å”¯ä¸€çš„ç©ºå€¼è¡¨ç¤ºä¸ºâ€œçœŸâ€ï¼Œè€Œéç©ºå€¼è¡¨ç¤ºä¸ºâ€œå‡â€

ä¸ºäº†å¯è§†åŒ–æˆ‘ä»¬æ•°æ®ä¸­çš„ç©ºå€¼ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ç»™å®šçš„ç‰¹æ€§ç»˜åˆ¶ä¸€ä¸ªæ•°æ®å¸§çš„**çƒ­å›¾**ã€‚æˆ‘ä»¬å¯ä»¥å°†çƒ­å›¾è®¾ç½®ä¸º 20x 20 çš„ç½‘æ ¼ã€‚ç™½è‰²éƒ¨åˆ†æ˜¾ç¤ºæ•°æ®ä¸­çš„ç©ºå€¼ã€‚

![](img/80ecc2e93cac816680bfb8aa97e5074c.png)![](img/b92b5ec697695c983e6646e6f98fcab8.png)

å¦‚çƒ­å›¾æ‰€ç¤º,â€œSTDs: Time since first diagnosisâ€å’Œâ€œSTDs: Time since last diagnosisâ€åŠŸèƒ½æœ‰è®¸å¤šç©ºå€¼ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ä»æ•°æ®ä¸­åˆ é™¤è¿™äº›åŠŸèƒ½ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬çš„æ•°æ®ä¸­å°†æœ‰ 34 åˆ—ï¼Œè€Œä¸æ˜¯ 36 åˆ—ã€‚

```
cancer_df = cancer_df.drop(columns = ['STDs: Time since first diagnosis, 'STDs: Time since last diagnosis'])cancer_df
```

æˆ‘ä»¬è¿˜éœ€è¦å°†æˆ‘ä»¬çš„æ•°æ®ä»å¯¹è±¡æ•°æ®ç±»å‹è½¬æ¢ä¸ºæ•°å€¼ï¼Œå› ä¸ºå¤§å¤šæ•°è¦ç´ éƒ½å­˜å‚¨ä¸ºå¯¹è±¡æ•°æ®ç±»å‹ã€‚

```
cancer_df = cancer_df.apply(pd.to_numeric)
cancer_df.info()
```

æ—¢ç„¶æˆ‘ä»¬çš„æ•°æ®å®Œå…¨ç”±æ•°å€¼ç»„æˆï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿è¡Œ *cancer_df.mean()æ¥æŸ¥çœ‹æ‰€æœ‰ç‰¹å¾çš„å¹³å‡å€¼ã€‚*

ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å¹³å‡å€¼æ›¿æ¢ä»»ä½•å…¶ä»–ç©ºå€¼ã€‚

```
cancer_df = cancer_df.fillna(cancer_df.mean())
cancer_df
```

# 3.æ•°æ®å¯è§†åŒ–

åœ¨è¿™ä¸€æ­¥ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è¿›ä¸€æ­¥å¯è§†åŒ–æ•°æ®ï¼Œä»¥æ‰¾åˆ°ç‰¹å¾ä¹‹é—´çš„ç›¸å…³æ€§ã€‚

ç¬¬ä¸€æ­¥æ˜¯è·å¾—ç›¸å…³çŸ©é˜µ:

```
corr_matrix = cancer_df.corr()
corr_matrix
```

ä¸€æ—¦æˆ‘ä»¬è¿™æ ·åšäº†ï¼Œæˆ‘ä»¬å¯ä»¥ç»˜åˆ¶å®ƒ:

```
plt.figure(figsize = (30, 30))
sns.heatmap(corr_matrix, annot = True)
plt.show()
```

(30ï¼Œ30)åˆ›å»ºäº†ä¸€ä¸ªæ›´å¤§çš„çƒ­å›¾ï¼Œä»¥ç¡®ä¿æ‰€æœ‰æ•°æ®éƒ½æ˜¯å¯è§çš„ï¼Œå¹¶ä¸”é€‚åˆçƒ­å›¾ï¼Œè€Œ *annot = True* ï¼Œå‘æˆ‘ä»¬æ˜¾ç¤ºçƒ­å›¾ä¸­çš„æ•°å€¼ã€‚ç»˜åˆ¶æ—¶ï¼Œå®ƒå°†å¦‚ä¸‹æ‰€ç¤º:

![](img/09ae904d3bd2e52dea63aacd2433588d.png)

è¯¥çŸ©é˜µæ˜¾ç¤ºäº†æ•°æ®é›†ä¸­æ‰€æœ‰è¦ç´ ä¹‹é—´çš„ç›¸å…³æ€§æˆ–å½±å“ã€‚æœ€æ¥è¿‘ 1(ç™½è‰²)çš„å€¼è¡¨ç¤ºæ¥è¿‘å®Œç¾çš„ç›¸å…³æ€§ï¼Œæœ€æ¥è¿‘ 0(ç´«è‰²)çš„å€¼è¡¨ç¤ºå‡ ä¹æ²¡æœ‰ç›¸å…³æ€§ï¼Œè´Ÿå€¼(æœ€æš—)è¡¨ç¤ºç›¸åçš„ç›¸å…³æ€§ã€‚

å¦‚æ‚¨æ‰€è§ï¼Œæœ‰ä¸€æ¡ç™½è‰²çš„å€¼çš„å¯¹è§’çº¿ï¼Œçœ‹èµ·æ¥å…·æœ‰å®Œç¾çš„ç›¸å…³æ€§ï¼Œå› ä¸ºç›¸åŒçš„è¦ç´ åœ¨ x è½´å’Œ y è½´ä¸Šå¯¹é½ï¼Œå¹¶ä¸”ç›¸åŒçš„è¦ç´ ä¸è‡ªèº«å…·æœ‰å®Œç¾çš„ç›¸å…³æ€§ã€‚

# 4.åœ¨æ¨¡å‹è®­ç»ƒä¹‹å‰å‡†å¤‡æ•°æ®

ä¸‹ä¸€æ­¥æ˜¯åœ¨è®­ç»ƒæ¨¡å‹ä¹‹å‰å‡†å¤‡æˆ‘ä»¬çš„æ•°æ®ã€‚

æ­£å¦‚æˆ‘ä»¬åœ¨å‰é¢æè¿°æ•°æ®æ—¶æ‰€çœ‹åˆ°çš„ï¼Œæ•°æ®ä¸­çš„æœ€åå››ä¸ªç‰¹å¾æ˜¯â€œHinselmanâ€ã€â€œSchillerâ€ã€â€œCitologyâ€å’Œâ€œBiopsyâ€ã€‚æ‰€æœ‰è¿™å››ä¸ªç‰¹æ€§éƒ½æ˜¯ä¸åŒçš„è¯Šæ–­æŒ‡æ ‡ã€‚ä½†æ˜¯ï¼Œç”±äºæˆ‘ä»¬åªæ˜¯å°è¯•è®­ç»ƒç®—æ³•æ¥é¢„æµ‹ç›®æ ‡å˜é‡æ´»æ£€ï¼Œå› æ­¤æˆ‘ä»¬åªéœ€è¦é€‰æ‹©è¯¥åˆ—ä½œä¸ºæˆ‘ä»¬çš„ç›®æ ‡è¾“å‡ºã€‚

```
target_df = cancer_df['Biopsy']
input_df = cancer_df.drop(columns = ['Biopsy'])
```

ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥æ£€æŸ¥æˆ‘ä»¬çš„ç›®æ ‡å½¢çŠ¶ï¼Œå®ƒæ˜¯ 858ï¼Œæˆ–è€…(858)ï¼Œæ­£å¦‚æˆ‘ä»¬æ‰€é¢„æœŸçš„ï¼Œå› ä¸ºæˆ‘ä»¬æœ‰æ¥è‡ª 858 ä¸ªæ‚£è€…çš„æ•°æ®ã€‚ç„¶åï¼Œæˆ‘ä»¬æƒ³è¦æ£€æŸ¥è¾“å…¥å½¢çŠ¶ï¼Œæˆ‘ä»¬å¾—åˆ°(858ï¼Œ33)ï¼Œå› ä¸ºæˆ‘ä»¬æœ‰ 858 è¡Œå’Œ 33 åˆ—ã€‚

![](img/89dbc7428ea6899e1f5adf5ba6d793c2.png)

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ NumPy å°†è¾“å…¥å’Œè¾“å‡ºè½¬æ¢æˆâ€œfloat32â€æ ¼å¼ã€‚ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿è¡Œ *y.shape* æ¥é‡å¡‘è¾“å‡ºçš„æ•°ç»„ï¼Œä»¥ç¡®ä¿å®ƒæ˜¯åˆé€‚çš„ã€‚

```
x = np.array(input_df).astype('float32')
y = np.array(target_df).astype('float32')
```

åœ¨å°†æ•°æ®è¾“å…¥æ¨¡å‹ä¹‹å‰ï¼Œå‡†å¤‡æ•°æ®çš„ä¸‹ä¸€æ­¥æ˜¯ç¼©æ”¾æ•°æ®ï¼Œä¸ºæ­¤æˆ‘ä»¬éœ€è¦å¯¼å…¥ **scikit-learn** ï¼Œè¿™æ˜¯ä¸€ä¸ªåŒ…å«å„ç§åˆ†ç±»ã€å›å½’å’Œèšç±»ç®—æ³•çš„ Python åº“ã€‚

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ sci-kit learn æ¥è§„èŒƒåŒ–æˆ‘ä»¬çš„è¾“å…¥æ•°æ®æˆ–æˆ‘ä»¬çš„ç‰¹å¾ï¼Œå› æ­¤æˆ‘ä»¬å¸Œæœ›å¯¼å…¥ StandardScaler å’Œ MinMaxScalerã€‚

æˆ‘ä»¬è¿˜æƒ³ä»æˆ‘ä»¬çš„ç±»â€œStandardScalerâ€ä¸­å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡â€œscalerâ€ç„¶åï¼Œæˆ‘ä»¬å¸Œæœ›å¯¹æˆ‘ä»¬çš„å¯¹è±¡åº”ç”¨â€œfit_transformâ€æ–¹æ³•ï¼Œè¿™ä¸ªå¯¹è±¡æ˜¯â€œscalerâ€ï¼Œå¹¶å°†å…¶ä¼ é€’ç»™ Xï¼Œä»¥ç”Ÿæˆä¸€ä¸ªè¾“å‡ºï¼Œè¿™æ˜¯ X çš„ç¼©æ”¾ç‰ˆæœ¬ã€‚

```
**from** sklearn.processing **import** StandardScaler, MinMaxScaler
scaler = StandardScaler()
X = scaler.fit_transform(X)
```

è®­ç»ƒæ¨¡å‹ä¹‹å‰çš„æœ€åä¸€æ­¥æ˜¯å°†å…¶åˆ†æˆä¸‰ä¸ªç±»åˆ«ï¼Œè®­ç»ƒæ•°æ®ã€éªŒè¯æ•°æ®å’Œæµ‹è¯•æ•°æ®ã€‚

**è®­ç»ƒæ•°æ®**ä»…ç”¨äºè®­ç»ƒæ¨¡å‹ã€‚æˆ‘ä»¬åªéœ€å°†æ•°æ®è¾“å…¥æ¨¡å‹ï¼Œè¿™æ ·å®ƒå°±å¯ä»¥äº†è§£è¾“å…¥å’Œè¾“å‡ºä¹‹é—´çš„å…³ç³»ã€‚

åœ¨å¯¹æ¨¡å‹è¿›è¡Œå®šå‹æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›ç¡®ä¿æ¨¡å‹ä¸ä¼šè¿‡åº¦æ‹Ÿåˆå®šå‹æ•°æ®ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨**éªŒè¯æ•°æ®**å¹¶å°†å…¶è¾“å…¥åˆ°æ¨¡å‹ä¸­ï¼Œå› ä¸ºå®ƒä»¥å‰ä»æœªè§è¿‡éªŒè¯æ•°æ®ã€‚

æˆ‘ä»¬å¸Œæœ›è®­ç»ƒå’ŒéªŒè¯æ•°æ®çš„è¯¯å·®éƒ½ä¸‹é™ã€‚æˆ‘ä»¬å¸Œæœ›æ¨¡å‹èƒ½å¤Ÿæ¦‚æ‹¬ï¼Œè€Œä¸æ˜¯è®°å¿†ã€‚

ç„¶è€Œï¼Œå¦‚æœæˆ‘ä»¬çœ‹åˆ°è®­ç»ƒæ•°æ®ä¸Šçš„è¯¯å·®ä¸‹é™ï¼Œè€ŒéªŒè¯æ•°æ®ä¸Šçš„è¯¯å·®ä¸Šå‡ï¼Œè¿™æ„å‘³ç€æ¨¡å‹å¯¹è®­ç»ƒæ•°æ®è¿‡åº¦æ‹Ÿåˆï¼Œæ— æ³•è¿›è¡Œå½’çº³ã€‚

**æµ‹è¯•æ•°æ®**åœ¨æ¨¡å‹è®­ç»ƒåä½¿ç”¨ã€‚åœ¨æˆ‘ä»¬å®Œæˆè®­ç»ƒå’Œè¿­ä»£ä¹‹åï¼Œæˆ‘ä»¬å°†æµ‹è¯•æ•°æ®æä¾›ç»™æ¨¡å‹ã€‚æ¨¡å‹åœ¨è®­ç»ƒæœŸé—´å°†æ°¸è¿œä¸ä¼šçœ‹åˆ°æµ‹è¯•æ•°æ®ã€‚

```
**from** sklearn.model_selection **import** train_test_splitX_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.2)
X_test, X_val, y_test, y_val = train_test_split(X, y, test_size = 0.5)
```

æˆ‘ä»¬çš„è®­ç»ƒå’Œæµ‹è¯•æ•°æ®ä¸­çš„ 0.2 æ„å‘³ç€æˆ‘ä»¬çš„æ•°æ®æœ‰ 20%æ˜¯ç”¨äºæµ‹è¯•çš„ï¼Œ80%ä¼šç”¨äºè®­ç»ƒã€‚

æµ‹è¯•æ•°æ®é›†è¿›ä¸€æ­¥åˆ†ä¸ºéªŒè¯å’Œæµ‹è¯•ç±»åˆ«ã€‚æ­£å¦‚æˆ‘ä»¬æ‰€çœ‹åˆ°çš„ï¼Œ50%çš„æ•°æ®è¿›å…¥æµ‹è¯•é›†ï¼Œå…¶ä½™çš„è¿›å…¥éªŒè¯é›†ã€‚

# 5.è®­ç»ƒå’Œè¯„ä¼°æ¨¡å‹

ä¸ºäº†è®­ç»ƒå’Œè¯„ä¼°æ¨¡å‹ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦é€šè¿‡è¿è¡Œä»¥ä¸‹ä»£ç æ¥å®‰è£… xgboost:

```
!pip install xgboost
```

ç„¶åæˆ‘ä»¬è¦*å°† xgboost å¯¼å…¥ä¸º xgb* ã€‚ä¸€æ—¦æˆ‘ä»¬è¿™æ ·åšäº†ï¼Œæˆ‘ä»¬å°±å¯ä»¥è®­ç»ƒ xgboost åˆ†ç±»æ¨¡å‹ã€‚

æˆ‘ä»¬å¯ä»¥å°†å­¦ä¹ ç‡è®¾å®šä¸º 0.1ï¼Œå› ä¸ºè¿™å¯èƒ½æ˜¯æˆ‘ä»¬ç³»ç»Ÿçš„ä¸€ä¸ªå¾ˆå¥½çš„èµ·ç‚¹ã€‚æˆ‘ä»¬è¿˜å¯ä»¥å°†åˆ†ç±»æ ‘çš„æœŸæœ›æ·±åº¦æŒ‡å®šä¸º 5ï¼Œè¿™æ˜¯ä»å†³ç­–æ ‘çš„åº•éƒ¨åˆ°æ ¹çš„æœ€é•¿è·¯å¾„ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬è¿˜å¯ä»¥æŒ‡å®šä¼°è®¡å™¨çš„æ•°é‡æˆ–æˆ‘ä»¬å°†è¦ä½¿ç”¨çš„æ¨¡å‹çš„æ•°é‡ã€‚æˆ‘ä»¬å¯ä»¥å°†ä¼°è®¡æ•°è®¾ç½®ä¸º 10ã€‚

å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥æ˜¾è‘—å¢åŠ æ ‘çš„æ·±åº¦å’Œä¼°è®¡å™¨çš„æ•°é‡ã€‚ç„¶è€Œï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬çš„æ¨¡å‹å˜å¾—æ›´åŠ å¤æ‚ã€‚å¯èƒ½å‡ºç°çš„ä¸€ä¸ªé—®é¢˜æ˜¯è®­ç»ƒæ•°æ®çš„è¿‡åº¦æ‹Ÿåˆã€‚è¯¥æ¨¡å‹å¯èƒ½åœ¨è®­ç»ƒæ•°æ®ä¸Šè¡¨ç°å¾ˆå¥½ï¼Œè€Œåœ¨æµ‹è¯•æ•°æ®ä¸Šè¡¨ç°å¾ˆå·®ã€‚

åœ¨å»ºç«‹äº†æˆ‘ä»¬çš„å­¦ä¹ ç‡å’Œä¼°è®¡æ•°ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥æ‹Ÿåˆæ¨¡å‹ï¼Œå¹¶ä¼ é€’æˆ‘ä»¬çš„è®­ç»ƒæ•°æ®ï¼Œ *X_trainï¼Œy_trainã€‚*åœ¨è¿è¡Œä»£ç å—ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„æ¨¡å‹å·²ç»è¢«è®­ç»ƒå¥½äº†ã€‚

```
**import** xgboost **as** xgb
model = xgb.XGBClassifier(learning_rate = 0.1, max_depth = 5, n_estimators = 10)
```

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æµ‹è¯•æ•°æ®é›†é¢„æµ‹è®­ç»ƒæ¨¡å‹çš„å¾—åˆ†ã€‚ã€‚æˆ‘ä»¬è¿˜æƒ³åœ¨æˆ‘ä»¬çš„æµ‹è¯•æ•°æ®ä¸Šç»˜åˆ¶æ¨¡å‹çš„å‡†ç¡®æ€§ï¼Œè¿™æ˜¯æ¨¡å‹ä»æœªè§è¿‡çš„ã€‚

![](img/bdba77f07aea0aaf010de9652bc6a3e4.png)

è¿è¡Œä»£ç åï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œåœ¨æˆ‘ä»¬çš„è®­ç»ƒæ•°æ®ä¸Šï¼Œæˆ‘ä»¬å·²ç»è¾¾åˆ°äº† **97%çš„å‡†ç¡®ç‡**ã€‚æˆ‘ä»¬å¯ä»¥å¯¹æµ‹è¯•æ•°æ®é‡å¤åŒæ ·çš„è¿‡ç¨‹:

![](img/1c866ca55390b075cb63482caa54dbb3.png)

è¿è¡Œä»£ç åï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„æ¨¡å‹åœ¨æµ‹è¯•æ•°æ®ä¸Šè¾¾åˆ°äº† **94%çš„å‡†ç¡®ç‡**ã€‚é‰´äºè¯¥æ¨¡å‹ä»¥å‰ä»æœªè§è¿‡è¿™äº›æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥è¯´è¯¥æ¨¡å‹è¡¨ç°å¾—ç›¸å½“å¥½ã€‚

è¾¾åˆ°è¿™ä¸ªå‡†ç¡®ç‡åï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­ç»˜åˆ¶ä¸€ä¸ªåˆ†ç±»æŠ¥å‘Šå’Œæ··æ·†çŸ©é˜µï¼Œå®ƒæ˜¾ç¤ºäº†æ¨¡å‹å“ªé‡Œåšå¾—å¥½ï¼Œå“ªé‡Œåšå¾—å·®ã€‚

![](img/628d10ed5540c52d3d678f51a411918f.png)![](img/912639460ef9ceea84f06f07d81f0738.png)

è¿™å°±æ˜¯ä½ è¦çš„ã€‚ä¸€ç§å®«é¢ˆç™Œé£é™©é¢„æµ‹æ¨¡å‹ï¼Œå¯ä»¥æ¥å—æ‚£è€…çš„ä¿¡æ¯å¹¶æ˜¾ç¤ºä»–ä»¬æ‚£å®«é¢ˆç™Œçš„é£é™©ã€‚å¦‚æœä½ æƒ³æ›´æ·±å…¥åœ°äº†è§£è¿™ä¸ªé¡¹ç›®æ˜¯å¦‚ä½•è¿›è¡Œçš„ï¼Œè¯·æŸ¥çœ‹æˆ‘ç”¨è¿‡çš„[è¯¾ç¨‹](https://www.coursera.org/projects/cervical-cancer-risk-prediction-using-machine-learning)ï¼Œä»¥åŠ[æˆ‘å…³äºè¿™ä¸ªé¡¹ç›®çš„è§†é¢‘](https://www.youtube.com/watch?v=Tdmx0aTHOIc)ï¼

> éå¸¸æ„Ÿè°¢æ‚¨é˜…è¯»è¿™ç¯‡æ–‡ç« ï¼å¦‚æœä½ ä»è¿™ç¯‡æ–‡ç« ä¸­å­¦åˆ°äº†ä»€ä¹ˆï¼Œè¯·åˆ†äº«ï¼ä¸€å®šè¦æŠŠ[è·Ÿæˆ‘](https://linktr.ee/manasigajjalapurna)è”ç³»èµ·æ¥ï¼Œç•™ä¸‹è¿™ç¯‡æ–‡ç« ä¸€ä¸ªæŒå£°ğŸ‘å¦‚æœä½ å–œæ¬¢çš„è¯ï¼

## æ¥æº:

[](https://machinelearningmastery.com/extreme-gradient-boosting-ensemble-in-python/) [## Python -æœºå™¨å­¦ä¹ æŒæ¡ä¸­çš„æç«¯æ¢¯åº¦æ¨è¿›(XGBoost)é›†æˆ

### extreme Gradient Boosting(XGBoost)æ˜¯ä¸€ä¸ªå¼€æºåº“ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªé«˜æ•ˆçš„å®ç°â€¦

machinelearningmastery.com](https://machinelearningmastery.com/extreme-gradient-boosting-ensemble-in-python/) [](https://xgboost.readthedocs.io/en/latest/tutorials/model.html) [## å¢å¼ºæ ‘ç®€ä»‹- xgboost 1.5.0-dev æ–‡æ¡£

### XGBoost ä»£è¡¨â€œæç«¯æ¢¯åº¦å¢å¼ºâ€ï¼Œå…¶ä¸­æœ¯è¯­â€œæ¢¯åº¦å¢å¼ºâ€æºäºè®ºæ–‡ Greedyâ€¦

xgboost.readthedocs.io](https://xgboost.readthedocs.io/en/latest/tutorials/model.html)