<html>
<head>
<title>Stop Using RecyclerView.Adapter</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">停止使用RecyclerView。适配器</h1>
<blockquote>原文：<a href="https://medium.com/codex/stop-using-recyclerview-adapter-27c77666512b?source=collection_archive---------0-----------------------#2022-07-14">https://medium.com/codex/stop-using-recyclerview-adapter-27c77666512b?source=collection_archive---------0-----------------------#2022-07-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="ea51" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">通过3个简单的步骤迁移到您的RecyclerView的ListAdapter。</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/4a4b953e187ebaaee7b704e15c042047.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*M1Tv1zwEwc2VQ3dH"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">格伦·卡斯滕斯-彼得斯在<a class="ae jn" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="f401" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">将你的<code class="du kk kl km kn b">RecyclerView.Adapter</code>类迁移到<code class="du kk kl km kn b">ListAdapter</code>只有3个简单的步骤。</p><h1 id="04b7" class="ko kp hi bd kq kr ks kt ku kv kw kx ky io kz ip la ir lb is lc iu ld iv le lf bi translated">为什么以及何时应该迁移？</h1><p id="0985" class="pw-post-body-paragraph jo jp hi jq b jr lg ij jt ju lh im jw jx li jz ka kb lj kd ke kf lk kh ki kj hb bi translated">当您有一个需要随时间不断变化的回收器视图时，您需要使用ListAdapter。默认情况下，更改列表项的RecyclerView实现是低效的。作为开发人员，我们需要寻找高效的解决方案。</p><h2 id="4ce1" class="ll kp hi bd kq lm ln lo ku lp lq lr ky jx ls lt la kb lu lv lc kf lw lx le ly bi translated">什么是困难？</h2><p id="153e" class="pw-post-body-paragraph jo jp hi jq b jr lg ij jt ju lh im jw jx li jz ka kb lj kd ke kf lk kh ki kj hb bi translated">Google提出了一个名为<code class="du kk kl km kn b">DiffUtil</code>的类，它将当前已有的列表与新提交的列表进行比较；它只在屏幕上改变必要的用户界面。然而，这增加了已经很复杂的样板代码，因此，我们可以使用<code class="du kk kl km kn b">ListAdapter</code>来减少样板代码。</p><h1 id="bab5" class="ko kp hi bd kq kr ks kt ku kv kw kx ky io kz ip la ir lb is lc iu ld iv le lf bi translated">#0 —开始使用</h1><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lz ma l"/></div></figure><p id="46bf" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这是您在这里看到的传统RecyclerView适配器。我们将修改这个类，改为使用<code class="du kk kl km kn b">ListAdapter</code>。</p><h1 id="626f" class="ko kp hi bd kq kr ks kt ku kv kw kx ky io kz ip la ir lb is lc iu ld iv le lf bi translated">#1 —创建DiffUtil回调</h1><p id="9dad" class="pw-post-body-paragraph jo jp hi jq b jr lg ij jt ju lh im jw jx li jz ka kb lj kd ke kf lk kh ki kj hb bi translated">如前所述，我们需要使用DiffUtil来有效地比较列表。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lz ma l"/></div></figure><p id="79b5" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我们可以从创建接口的静态匿名对象开始。这里我们有两个功能:</p><ol class=""><li id="2d69" class="mb mc hi jq b jr js ju jv jx md kb me kf mf kj mg mh mi mj bi translated"><code class="du kk kl km kn b">areItemsTheSame</code> —如果我们比较的项目相同，此函数返回true。我们通常通过比较模态的主键来做到这一点。</li><li id="cefe" class="mb mc hi jq b jr mk ju ml jx mm kb mn kf mo kj mg mh mi mj bi translated"><code class="du kk kl km kn b">areContentsTheSame</code> —如果项目的其他属性相同，此函数返回true。这将检查项目本身是否有任何内部更改。</li></ol><h1 id="bf54" class="ko kp hi bd kq kr ks kt ku kv kw kx ky io kz ip la ir lb is lc iu ld iv le lf bi translated">#2 —替换继承的类</h1><p id="345e" class="pw-post-body-paragraph jo jp hi jq b jr lg ij jt ju lh im jw jx li jz ka kb lj kd ke kf lk kh ki kj hb bi translated">现在我们可以将<code class="du kk kl km kn b">RecyclerView.Adapter</code>替换为<code class="du kk kl km kn b">ListAdapter</code>。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lz ma l"/></div></figure><p id="5e5f" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我们在父构造函数中传递<code class="du kk kl km kn b">DiffUtil</code>的对象。我们已经成功地将我们的类迁移到了一个<code class="du kk kl km kn b">ListAdapter</code>；然而，我们的代码仍然不是我们所需要的。</p><h1 id="f239" class="ko kp hi bd kq kr ks kt ku kv kw kx ky io kz ip la ir lb is lc iu ld iv le lf bi translated">#3 —添加最后的润色。</h1><p id="afc5" class="pw-post-body-paragraph jo jp hi jq b jr lg ij jt ju lh im jw jx li jz ka kb lj kd ke kf lk kh ki kj hb bi translated">既然您正在使用<code class="du kk kl km kn b">ListAdapter</code>，那么利用我们从中获得的能力是有意义的。</p><ol class=""><li id="3403" class="mb mc hi jq b jr js ju jv jx md kb me kf mf kj mg mh mi mj bi translated">您可以移除<code class="du kk kl km kn b">getItemCount</code>功能。<code class="du kk kl km kn b">ListAdapter</code>为您实现。</li><li id="7f11" class="mb mc hi jq b jr mk ju ml jx mm kb mn kf mo kj mg mh mi mj bi translated">如下图所示替换<code class="du kk kl km kn b">list</code>属性。</li><li id="f840" class="mb mc hi jq b jr mk ju ml jx mm kb mn kf mo kj mg mh mi mj bi translated">将<code class="du kk kl km kn b">list[position]</code>改为<code class="du kk kl km kn b">getItem(position)</code>。</li></ol><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lz ma l"/></div></figure><h1 id="4eb2" class="ko kp hi bd kq kr ks kt ku kv kw kx ky io kz ip la ir lb is lc iu ld iv le lf bi translated">结论</h1><p id="53c8" class="pw-post-body-paragraph jo jp hi jq b jr lg ij jt ju lh im jw jx li jz ka kb lj kd ke kf lk kh ki kj hb bi translated">通过一些小的改动，并遵循这三个简单的步骤，您可以显著提高应用程序的性能。<code class="du kk kl km kn b">ListAdapter</code>固有地使用了<code class="du kk kl km kn b">RecyclerView.Adapter</code>并使其性能更好。如果你的列表不断变化，那么使用<code class="du kk kl km kn b">ListAdapter</code>总是一个好的选择。</p></div><div class="ab cl mp mq gp mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="hb hc hd he hf"><p id="f430" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我希望你喜欢读我的文章，并学到了一些东西。谢谢大家！✌️</p><pre class="iy iz ja jb fd mw kn mx my aw mz bi"><span id="2f34" class="ll kp hi kn b fi na nb l nc nd"><strong class="kn hj">Want to connect?</strong></span><span id="9131" class="ll kp hi kn b fi ne nb l nc nd">My <a class="ae jn" href="https://github.com/cybercoder-naj" rel="noopener ugc nofollow" target="_blank">GitHub</a> profile.<br/>My <a class="ae jn" href="https://cybercoder-naj.github.io" rel="noopener ugc nofollow" target="_blank">Portfolio</a> website.</span></pre></div></div>    
</body>
</html>