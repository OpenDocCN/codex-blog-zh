<html>
<head>
<title>💪Deploying Progress Sitefinity CMS in Azure using Bicep</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">💪使用Bicep在Azure中部署Progress Sitefinity CMS</h1>
<blockquote>原文：<a href="https://medium.com/codex/deploying-progress-sitefinity-cms-in-azure-using-bicep-90380de8a106?source=collection_archive---------8-----------------------#2021-10-13">https://medium.com/codex/deploying-progress-sitefinity-cms-in-azure-using-bicep-90380de8a106?source=collection_archive---------8-----------------------#2021-10-13</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="c91e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">通过Azure Bicep使用基础设施即代码快速部署灵活的CMS平台。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/361d04dd88655f09cdb16904e8f04f05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EDmBs5p9lB-Mn5mJWHzWeg.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">使用Bicep在Azure中部署Progress Sitefinity CMS</figcaption></figure></div><div class="ab cl jt ju gp jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="hb hc hd he hf"><p id="5b9b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="ka"> Progress Sitefinity </em>是一款PaaS模式的现代CMS，可为商业专业人士提供直观的web内容管理、强大的CMS开发环境和丰富的最终用户体验。</p><p id="35f2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">本文将回顾我们如何使用Bicep在Azure中部署这个平台，Bicep是一种新的领域特定语言(DSL)，它使用声明性语法来部署Azure资源。</p><h2 id="2c7d" class="kb kc hi bd kd ke kf kg kh ki kj kk kl iq km kn ko iu kp kq kr iy ks kt ku kv bi translated">先决条件:</h2><ul class=""><li id="0625" class="kw kx hi ih b ii ky im kz iq la iu lb iy lc jc ld le lf lg bi translated">有效的Azure订阅</li><li id="86f1" class="kw kx hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">具有所有者/贡献者角色的用户</li><li id="fff8" class="kw kx hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">Azure订阅中的资源组</li><li id="2c04" class="kw kx hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">Bicep安装在您的本地机器上</li><li id="8625" class="kw kx hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">Azure PowerShell安装在您的本地计算机上</li></ul><p id="b91f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">那么我们可以用Progress Sitefinity做什么呢？Progress Sitefinity是一个CMS，您可以在Azure中部署它，创建个性化网站、客户和合作伙伴门户、电子商务商店，并实现跨渠道活动管理。</p><h1 id="bd56" class="lm kc hi bd kd ln lo lp kh lq lr ls kl lt lu lv ko lw lx ly kr lz ma mb ku mc bi translated">进展网站定义架构参考。</h1><p id="d6b7" class="pw-post-body-paragraph if ig hi ih b ii ky ik il im kz io ip iq md is it iu me iw ix iy mf ja jb jc hb bi translated">下图显示了Azure中Progress Sitefinity的高级概述:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mg"><img src="../Images/1b24e28b2b3656bd9e430189f1ef5b24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AjDcmJcG_7xEgiPKVGt5oQ.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">Progress Sitefinity — Azure参考架构</figcaption></figure><p id="e31d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">本文旨在向您展示如何使用Bicep在Azure中部署该解决方案的基本组件。所以我们来研究肱二头肌的档案。</p><h1 id="25ff" class="lm kc hi bd kd ln lo lp kh lq lr ls kl lt lu lv ko lw lx ly kr lz ma mb ku mc bi translated">用于部署进度Sitefinity的Azure Bicep文件。</h1><p id="3e97" class="pw-post-body-paragraph if ig hi ih b ii ky ik il im kz io ip iq md is it iu me iw ix iy mf ja jb jc hb bi translated">我们将在Bicep文件中定义以下参数</p><ul class=""><li id="fe5e" class="kw kx hi ih b ii ij im in iq mh iu mi iy mj jc ld le lf lg bi translated"><em class="ka">网站名称</em>:这是网站的名称</li><li id="7da8" class="kw kx hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated"><em class="ka">位置</em>:所有资源的位置</li><li id="7f1b" class="kw kx hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated"><em class="ka"> hostingPlanName </em>:这是App服务计划</li><li id="71d0" class="kw kx hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated"><em class="ka"> appServicePlanInstances </em>:这是应用服务计划实例数</li><li id="0d79" class="kw kx hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated"><em class="ka"> appServicePlanTier </em>:这是应用服务计划的定价层</li><li id="dab4" class="kw kx hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated"><em class="ka">SQL server name</em>:SQL Azure DB服务器名称</li><li id="3fe8" class="kw kx hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated"><em class="ka">administrator log in</em>:SQL Server实例的用户管理员</li><li id="ace2" class="kw kx hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated"><em class="ka">管理员登录密码</em>:密码</li><li id="6374" class="kw kx hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated"><em class="ka">数据库名</em>:SQL数据库名</li></ul><p id="108e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面的代码显示了Bicep文件中参数的定义:</p><pre class="je jf jg jh fd mk ml mm mn aw mo bi"><span id="848d" class="kb kc hi ml b fi mp mq l mr ms"><a class="ae mt" href="http://twitter.com/description" rel="noopener ugc nofollow" target="_blank">@description</a>('Name of Azure Website')<br/>param siteName string</span><span id="05bc" class="kb kc hi ml b fi mu mq l mr ms">@description('Location for all resources.')<br/>param location string = resourceGroup().location</span><span id="7550" class="kb kc hi ml b fi mu mq l mr ms">@description('Name of Azure App Service Plan')<br/>param hostingPlanName string</span><span id="ed74" class="kb kc hi ml b fi mu mq l mr ms">@minValue(1)<br/>@maxValue(3)<br/>@description('App Service Plan\'s instance count')<br/>param appServicePlanInstances int = 1</span><span id="4f44" class="kb kc hi ml b fi mu mq l mr ms">@description('App Service Plan\'s pricing tier.')<br/>param appServicePlanTier string = 'S3'</span><span id="00eb" class="kb kc hi ml b fi mu mq l mr ms">@description('SQL Azure DB Server name')<br/>param sqlServerName string</span><span id="a00d" class="kb kc hi ml b fi mu mq l mr ms">@description('SQL Azure DB administrator username')<br/>param administratorLogin string</span><span id="8ef2" class="kb kc hi ml b fi mu mq l mr ms">@description('SQL Azure DB administrator password')<br/>@secure()<br/>param administratorLoginPassword string</span><span id="5f65" class="kb kc hi ml b fi mu mq l mr ms">@description('Database name')<br/>param databaseName string</span></pre><p id="d132" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们将定义数据库资源，包括SQL服务器、SQL数据库和防火墙规则:</p><pre class="je jf jg jh fd mk ml mm mn aw mo bi"><span id="830e" class="kb kc hi ml b fi mp mq l mr ms">resource sqlServerName_resource 'Microsoft.Sql/servers@2014-04-01' = {<br/>  name: sqlServerName<br/>  location: location<br/>  properties: {<br/>    administratorLogin: administratorLogin<br/>    administratorLoginPassword: administratorLoginPassword<br/>  }<br/>}</span><span id="4143" class="kb kc hi ml b fi mu mq l mr ms">resource sqlServerName_databaseName 'Microsoft.Sql/servers/databases@2014-04-01' = {<br/>  parent: sqlServerName_resource<br/>  name: databaseName<br/>  location: location<br/>  properties: {<br/>    edition: 'Standard'<br/>    collation: 'SQL_Latin1_General_CP1_CI_AS'<br/>    maxSizeBytes: '21474836480'<br/>    requestedServiceObjectiveId: '455330e1-00cd-488b-b5fa-177c226f28b7'<br/>  }<br/>}</span><span id="a762" class="kb kc hi ml b fi mu mq l mr ms">resource sqlServerName_AllowAllWindowsAzureIps 'Microsoft.Sql/servers/firewallrules@2014-04-01' = {<br/>  parent: sqlServerName_resource<br/>  name: 'AllowAllWindowsAzureIps'<br/>  <br/>  properties: {<br/>    endIpAddress: '0.0.0.0'<br/>    startIpAddress: '0.0.0.0'<br/>  }<br/>}</span></pre><p id="df20" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下一步是定义web组件，包括服务器群和网站:</p><pre class="je jf jg jh fd mk ml mm mn aw mo bi"><span id="efc9" class="kb kc hi ml b fi mp mq l mr ms">resource hostingPlanName_resource 'Microsoft.Web/serverfarms@2021-01-01' = {<br/>  name: hostingPlanName<br/>  location: location<br/>  sku: {<br/>    name: appServicePlanTier<br/>    capacity: appServicePlanInstances<br/>  }<br/>}</span><span id="6dd0" class="kb kc hi ml b fi mu mq l mr ms">resource siteName_resource 'Microsoft.Web/sites@2021-01-01' = {<br/>  name: siteName<br/>  location: resourceGroup().location<br/>  tags: {<br/>    'hidden-related:/subscriptions/${subscription().subscriptionId}/resourcegroups/${resourceGroup().name}/providers/Microsoft.Web/serverfarms/${hostingPlanName}': 'empty'<br/>  }<br/>  properties: {<br/>    <br/>    serverFarmId: '/subscriptions/${subscription().subscriptionId}/resourcegroups/${resourceGroup().name}/providers/Microsoft.Web/serverfarms/${hostingPlanName}'<br/>  }<br/>  dependsOn: [<br/>    hostingPlanName_resource<br/>  ]<br/>}</span></pre><p id="f516" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，我们将定义站点的源代码控制和配置:</p><pre class="je jf jg jh fd mk ml mm mn aw mo bi"><span id="6b54" class="kb kc hi ml b fi mp mq l mr ms">resource siteName_web 'Microsoft.Web/Sites/sourcecontrols@2015-08-01' = {<br/>  parent: siteName_resource<br/>  location: location<br/>  name: 'web'<br/>  properties: {<br/>    repoUrl: '<a class="ae mt" href="https://github.com/Sitefinity/azure-sample-app'" rel="noopener ugc nofollow" target="_blank">https://github.com/Sitefinity/azure-sample-app'</a><br/>    branch: 'master'<br/>    isManualIntegration: true<br/>  }<br/>}</span><span id="cf85" class="kb kc hi ml b fi mu mq l mr ms">resource siteName_connectionstrings 'Microsoft.Web/sites/config@2021-01-01' = {<br/>  parent: siteName_resource<br/>  name: 'connectionstrings'<br/>  properties: {<br/>    defaultConnection: {<br/>     <br/>      value: 'Data Source=tcp:${sqlServerName_resource.properties.fullyQualifiedDomainName},1433;Initial Catalog=${databaseName};User Id=${administratorLogin}@${sqlServerName};Password=${administratorLoginPassword};'<br/>      type: 'SQLAzure'<br/>    }<br/>  }<br/>  dependsOn: [<br/>    siteName_web<br/>    sqlServerName_databaseName<br/>  ]<br/>}</span><span id="12b4" class="kb kc hi ml b fi mu mq l mr ms">resource siteName_appsettings 'Microsoft.Web/sites/config@2021-01-01' = {<br/>  parent: siteName_resource<br/>  name: 'appsettings'<br/>  <br/>  properties: {<br/>    'sf-env:ConnectionStringParams:defaultConnection': 'Backend=azure'<br/>    'sf-env:ConnectionStringName': 'defaultConnection'<br/>  }<br/>}</span></pre><p id="d8b0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以下是在Azure中部署Progress Sitefinity CMS的完整Bicep文件:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="mv mw l"/></div></figure><h1 id="f181" class="lm kc hi bd kd ln lo lp kh lq lr ls kl lt lu lv ko lw lx ly kr lz ma mb ku mc bi translated">在Azure中部署Sitefinity CMS</h1><p id="b3c8" class="pw-post-body-paragraph if ig hi ih b ii ky ik il im kz io ip iq md is it iu me iw ix iy mf ja jb jc hb bi translated">我们将使用下面的代码来部署上面的Bicep模板:</p><pre class="je jf jg jh fd mk ml mm mn aw mo bi"><span id="496c" class="kb kc hi ml b fi mp mq l mr ms">$date = Get-Date -Format "MM-dd-yyyy"<br/>$deploymentName = "AzInsiderDeployment"+"$date"</span><span id="dd3a" class="kb kc hi ml b fi mu mq l mr ms">New-AzResourceGroupDeployment -Name $deploymentName -ResourceGroupName progress-sitefinity -TemplateFile .\main.bicep -c</span></pre><p id="515e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">注您可以选择创建一个参数文件，并在部署时传递它们。在这种情况下，我们将在部署时手动传递参数，如下所示:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mx"><img src="../Images/a44438ea2347e05f6ae71c7b2ebaa8d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0lViBqJ31JqqyujAtSFYAA.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">进度站点限定—部署预览</figcaption></figure><p id="ca77" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后，我们将预览部署，如下所示:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es my"><img src="../Images/69929e8a105b0c761f551ecd367704d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ObOcz1uhKcdcxdX9H1bDqg.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">进度站点限定—部署预览</figcaption></figure><p id="82fc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一旦验证完成，我们就可以执行部署了。部署需要几分钟才能完成。</p><p id="168d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下图显示了部署的输出:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mz"><img src="../Images/6bc6f038293cb46e5015f3d06747699c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J0r8HCOeiKGIUIdVCiUjfA.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">进度站点有限性—部署输出</figcaption></figure><p id="b854" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们现在可以进入Azure门户网站并获取网站的URL。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es na"><img src="../Images/4a0102848614f63ea7c1c93c6dbda7ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FqD9JwtelNUAJqZCmN0ogA.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">进度网站有限性—网站URL</figcaption></figure><p id="2a67" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">导航到应用服务的URL后，您应该会看到下面的屏幕:</p><ul class=""><li id="d334" class="kw kx hi ih b ii ij im in iq mh iu mi iy mj jc ld le lf lg bi translated">注意:第一次加载可能需要几秒钟。</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es nb"><img src="../Images/21570072cdc7a4eec3aa8f4a86bbccae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*su4bAokuxXHWmf-6UGJJvw.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">进度站点定义屏幕</figcaption></figure><p id="3b41" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后就可以申请执照，开始在平台上工作了。</p><p id="3fda" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可以在这里找到带有示例的GitHub库来定制您的解决方案:<a class="ae mt" href="https://github.com/Sitefinity/azure-sample-app" rel="noopener ugc nofollow" target="_blank">https://github.com/Sitefinity/azure-sample-app</a></p><p id="a5ea" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae mt" href="http://eepurl.com/gKmLdf" rel="noopener ugc nofollow" target="_blank"> <em class="ka">在此加入</em><strong class="ih hj"><em class="ka">azin sider</em></strong><em class="ka">邮箱列表。</em>T11】</a></p><p id="1cf0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="ka">-戴夫·r</em></p></div></div>    
</body>
</html>