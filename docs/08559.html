<html>
<head>
<title>Automating Google Sheets Reports</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">自动化Google Sheets报告</h1>
<blockquote>原文：<a href="https://medium.com/codex/automating-google-sheets-reports-309ac1f0ed77?source=collection_archive---------3-----------------------#2022-08-17">https://medium.com/codex/automating-google-sheets-reports-309ac1f0ed77?source=collection_archive---------3-----------------------#2022-08-17</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="24e0" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">简化公式，减少繁琐的手动报告更新</h2></div><p id="b811" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这一次，我想分享一些Google Sheets公式，它们像魔法一样有效。让我们开始吧！</p><p id="b6bb" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">场景:</strong></p><p id="2bd2" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在下个月的每个月初，将有一个月摄取到Excel文件中的“原始”表，目标是有一个财务汇总表，作为自动更新的月末报告。因此，在2022年1月1日，2021年12月的数据将被自动获取，因此我们需要一个自动化的GSheet报告，以避免每月初的人工操作。</p><p id="aba6" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">原始表单:</strong></p><figure class="ju jv jw jx fd jy er es paragraph-image"><div class="er es jt"><img src="../Images/c3410d4e330473fa7a9e9ae8dc2e7f40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1102/format:webp/1*jT_zbed9NuXp2nUvgp-Alg.png"/></div><figcaption class="kb kc et er es kd ke bd b be z dx translated">作者的原始表单</figcaption></figure><p id="9f49" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">下面是一个简单的原始数据示例，包含日期、商品名称、售出商品、每件商品的价格和COGS。</p><ol class=""><li id="ea13" class="kf kg hi iz b ja jb jd je jg kh jk ki jo kj js kk kl km kn bi translated"><a class="ae ko" href="https://support.google.com/docs/answer/3093275?hl=en" rel="noopener ugc nofollow" target="_blank"> <strong class="iz hj">数组公式</strong> </a></li></ol><p id="b315" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">首先，我们想在现有数据旁边添加一个收入列，Item Sold * Price per Item然而，如果我们使用简单的<strong class="iz hj"> =D2 * E2 </strong>公式，我们将不得不在每次有新的数据行时更新工作表。</p><p id="24be" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了自动化，我们可以在编辑第一行中的公式时按Ctrl+Shift+Enter，并使用<a class="ae ko" href="https://support.google.com/docs/answer/3093275?hl=en" rel="noopener ugc nofollow" target="_blank"> ARRAYFORMULA </a>函数。不要忘记在最后添加<strong class="iz hj">:列</strong>,使其成为一个数组公式而不是单个单元格公式(例如，D2:D而不是D2 ),它将自动用公式结果填充列中的下面单元格。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div class="er es kp"><img src="../Images/cdd8e3c60b68efa28ccfe9a19c5a798a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1302/format:webp/1*GiygbKKCLNIMMx5q8X6F5Q.png"/></div><figcaption class="kb kc et er es kd ke bd b be z dx translated">作者的数组公式示例</figcaption></figure><p id="6131" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">但是，请注意，它会用公式填充列的每个单元格，这可能会留下不需要的结果，如下面的0:</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div class="er es kq"><img src="../Images/527b6b8442f462018704af0345d649e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1312/format:webp/1*IM2utIr8MpeavLoIN-wl5g.png"/></div><figcaption class="kb kc et er es kd ke bd b be z dx translated">作者对数组公式错误的说明</figcaption></figure><p id="7cf3" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了避免这种情况，我们可以添加一个IF条件，如下所示:</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div class="er es kr"><img src="../Images/64fe7160676fb05000651dc5bcaaf712.png" data-original-src="https://miro.medium.com/v2/resize:fit:1282/format:webp/1*RxlxK996i5KAPjSRlVQowA.png"/></div><figcaption class="kb kc et er es kd ke bd b be z dx translated">作者修改的数组公式示例</figcaption></figure><p id="78ec" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">数组公式可以很好地处理大量的函数，比如SUMIFS()、YEAR()、IF()等。所以一定要探索它们！</p><p id="ad54" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这种情况下，我们还将添加年份和毛利列。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es ks"><img src="../Images/44557f9582e3f0505e85adf76fa9fa8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h05KJ7f2X-WV_-590tqDGA.png"/></div></div><figcaption class="kb kc et er es kd ke bd b be z dx translated">作者使用Year函数的数组公式示例</figcaption></figure><p id="79a1" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj"> 2。</strong><a class="ae ko" href="https://support.google.com/docs/answer/3094013?hl=en" rel="noopener ugc nofollow" target="_blank"><strong class="iz hj">MAX</strong></a><strong class="iz hj">&amp;</strong><a class="ae ko" href="https://support.google.com/docs/answer/3093044?hl=en" rel="noopener ugc nofollow" target="_blank"><strong class="iz hj">EOMONTH</strong></a></p><p id="9330" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">一旦我们完成了原始数据，就该设计总结报告了。为简单起见，我们将使用下面的设计，它按项目名称、月份和年份报告所有指标。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es kx"><img src="../Images/4408c6523ad92e518475f1de3ed6220b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jtL3Wlk9Qnnh0oTiJyXwkQ.png"/></div></div><figcaption class="kb kc et er es kd ke bd b be z dx translated">作者设计的摘要报告</figcaption></figure><p id="64bf" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">其次，我们希望更新第1行中显示的月份。为此，我们可以使用<a class="ae ko" href="https://support.google.com/docs/answer/3094013?hl=en" rel="noopener ugc nofollow" target="_blank"> MAX </a>()函数从原始数据中获取最近的日期。</p><p id="692b" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">对于其他列，我们可以使用<a class="ae ko" href="https://support.google.com/docs/answer/3093044?hl=en" rel="noopener ugc nofollow" target="_blank"> EOMONTH </a>()公式，因为我们希望每个月的最后一个日期落在一个月之前，因此-1是它左边的日期。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es ky"><img src="../Images/0cabb01b1877f333a37e43ee6c1c9ae4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SYN5RXGGd4vYe3ILUx4-Bw.png"/></div></div><figcaption class="kb kc et er es kd ke bd b be z dx translated">作者的每月函数示例</figcaption></figure><p id="b73b" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj"> 3。</strong><a class="ae ko" href="https://support.google.com/docs/answer/3238496?hl=en" rel="noopener ugc nofollow" target="_blank"><strong class="iz hj"/></a></p><p id="671c" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">接下来，为了填充报表，将使用<a class="ae ko" href="https://support.google.com/docs/answer/3238496?hl=en" rel="noopener ugc nofollow" target="_blank"> SUMIFS </a>()而不是SUM()，因为有多个条件，包括获得总和的正确月份和项目名称。例如，对于单元格C3，我们希望仅获取2022-06-30和鞋类的销售项目的总和。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es kz"><img src="../Images/86428178b479fffbb08039f9d1adaa25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xMmDDVZ77oybAs-6DSZehw.png"/></div></div><figcaption class="kb kc et er es kd ke bd b be z dx translated">作者的SUMIFS函数示例</figcaption></figure><p id="68a3" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最后，我们可以添加月环比和年同比的简单计算来进行趋势分析。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es la"><img src="../Images/fd1551b129089ebb1ab46ae8c28c284c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EkstK_-vkm_ph5rkrX9p8g.png"/></div></div><figcaption class="kb kc et er es kd ke bd b be z dx translated">作者逐月计算示例</figcaption></figure><p id="c31c" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">加成:</strong> <a class="ae ko" href="https://support.google.com/docs/answer/3093340?hl=en" rel="noopener ugc nofollow" target="_blank"> <strong class="iz hj">导入范围</strong> </a></p><p id="26b4" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果您需要从另一个工作表、外部或多个Google工作表源获取原始数据，这个函数非常有用，因为它会导入整个列，并且与源列完全相同，因此不需要更新。</p><p id="a3eb" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">举例来说，日期和项目名称列从<em class="lb">原始表</em>导入到<em class="lb">原始表</em>的副本中。永远记住要加上" "，否则公式就不起作用。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es lc"><img src="../Images/30736d061bbfb84c83528d8aae4cf2fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8Ji-zqBqruuZ248qDyW8Fw.png"/></div></div><figcaption class="kb kc et er es kd ke bd b be z dx translated">作者的Importrange函数示例</figcaption></figure><p id="a007" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">手动更改和更新报告可能是非常累人和平凡的工作。因此，让我们尝试有效地减少浪费，并将其自动化。</p></div><div class="ab cl ld le gp lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="hb hc hd he hf"><p id="2aa6" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="lb">如有任何疑问，可通过</em><a class="ae ko" href="https://www.linkedin.com/in/sharon-regina/" rel="noopener ugc nofollow" target="_blank"><em class="lb">LinkedIn</em></a><em class="lb">联系我。希望这篇文章能帮助你减少无关紧要的浪费，并去做其他创造价值的工作:)。</em></p></div></div>    
</body>
</html>