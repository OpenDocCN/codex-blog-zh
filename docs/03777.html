<html>
<head>
<title>Creating a FARM Stack Dev Environment with Docker Compose — Part 3 of 3: React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Docker Compose创建场堆栈开发环境—第3部分，共3部分:反应</h1>
<blockquote>原文：<a href="https://medium.com/codex/creating-a-farm-stack-dev-environment-with-docker-compose-part-3-of-3-react-123bfa8f187a?source=collection_archive---------3-----------------------#2021-09-24">https://medium.com/codex/creating-a-farm-stack-dev-environment-with-docker-compose-part-3-of-3-react-123bfa8f187a?source=collection_archive---------3-----------------------#2021-09-24</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/6917de2c8e0dc456b372aff147deb553.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*aGnLvSUPsxgvvai8lxbpBA.jpeg"/></div></figure><h1 id="90c8" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">介绍</h1><p id="1bb7" class="pw-post-body-paragraph jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated">这是使用Docker Compose创建Python FastAPI、React和MongoDB (FARM)堆栈开发环境系列的最后一部分。我将回顾docker-compose.yml文件的新增内容。我还会添加一个部分，用于打包并分发给你的队友。尽管这意味着本地开发，但是如果您希望确保您的队友拥有不同的MongoDB凭证，我将向您展示如何在Docker Compose中使用环境变量，这样您就不必在您的包或Git存储库中包含您的凭证。</p><p id="ad9b" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">这个资源库的React部分是从React“入门”网站(<a class="ae kn" href="https://create-react-app.dev/docs/getting-started/" rel="noopener ugc nofollow" target="_blank">https://create-react-app.dev/docs/getting-started/</a>)上的starter应用程序开始的。我将回顾一下为与FastAPI服务器通信而添加的组件。此外，您将看到用于加载FastAPI结果数据的添加的HTML表单和表格。</p><h2 id="f3a4" class="ko in hi bd io kp kq kr is ks kt ku iw jv kv kw ja jz kx ky je kd kz la ji lb bi translated">本系列的前几部分</h2><p id="d591" class="pw-post-body-paragraph jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated">如果您错过了本系列的第一和第二部分，您可以查看位于<a class="ae kn" rel="noopener" href="/codex/farm-stack-with-docker-compose-part-1-mongodb-54cc65e31636">https://medium . com/codex/farm-stack-with-docker-compose-part-1-MongoDB-54c c65 e 31636</a>的FARM栈的MongoDB部分，以及位于<a class="ae kn" rel="noopener" href="/codex/creating-a-farm-stack-dev-environment-with-docker-compose-part-2-of-3-fastapi-9ee7ab644809">https://medium . com/codex/creating-a-FARM-stack-dev-environment-with-docker-compose-part-2-of-3-FastAPI-9eeapi的FARM栈的FastAPI部分</a></p><h1 id="27da" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">运行群组堆栈</h1><p id="ecb6" class="pw-post-body-paragraph jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated">要运行FARM堆栈并直接进入React站点，请在下面键入Docker Compose命令。请注意，您必须添加一个“.”。env "文件和MongoDB凭证添加到项目的根目录。要了解更多信息，请阅读本文的“分发包”一节。</p><pre class="lc ld le lf fd lg lh li lj aw lk bi"><span id="5609" class="ko in hi lh b fi ll lm l ln lo">docker-compose up</span></pre><p id="e987" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">Docker Compose开发栈运行后，将你的浏览器定向到<a class="ae kn" href="http://0.0.0.0:3000" rel="noopener ugc nofollow" target="_blank"> http://0.0.0.0:3000 </a>。您将看到在MongoDB数据库中搜索漫画问题的web表单。</p><figure class="lc ld le lf fd ij er es paragraph-image"><div class="er es lp"><img src="../Images/25d39c916bd33bb4471d5e5e9ef03062.png" data-original-src="https://miro.medium.com/v2/resize:fit:1022/0*0qkK2FPd57ilNsM-"/></div></figure><h1 id="78e3" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">FastAPI附加功能</h1><p id="a994" class="pw-post-body-paragraph jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated">当从React前端与场堆栈中的FastAPI服务通信时，您可能会收到如下错误。这可能因您使用的浏览器而异。</p><blockquote class="lq lr ls"><p id="1f57" class="jk jl lt jm b jn ki jp jq jr kj jt ju lu kk jx jy lv kl kb kc lw km kf kg kh hb bi translated">CORS策略已阻止从源“http://localhost:3000”访问位于“http://0 . 0 . 0 . 0:8000/comics/Black % 20 panther/15”的XMLHttpRequest:请求的资源上不存在“Access-Control-Allow-Origin”标头。</p></blockquote><p id="c4c1" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">这是大多数现代网络浏览器抛出的“跨源资源共享”(CORS)错误。</p><p id="1637" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">您的浏览器针对0.0.0.0:3000或localhost:3000发送的CORS检查将失败。CORS检查失败，因为FastAPI URL 0.0.0.0:8000因端口不同而不同。默认情况下，FastAPI服务器不会将“Access-Control-Allow-Origin”头发送回浏览器。更新的浏览器可能会拒绝从FastAPI服务加载资源。</p><p id="0f18" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">您必须使用模块“CORSMiddleware”“CORSMiddleware”模块允许您添加原始URL，以满足现代浏览器的标题要求。在您的情况下，必须添加0.0.0.0:3000和localhost:3000。可以在以下位置找到该文档。</p><p id="8997" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated"><a class="ae kn" href="https://fastapi.tiangolo.com/tutorial/cors/?h=%20cors#use-corsmiddleware" rel="noopener ugc nofollow" target="_blank">https://fastapi.tiangolo.com/tutorial/cors/?h = % 20 CORS # use-CORS middleware</a></p><p id="7d1f" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">以下步骤允许您的FastAPI服务向浏览器返回有效的CORS头。</p><ol class=""><li id="b746" class="lx ly hi jm b jn ki jr kj jv lz jz ma kd mb kh mc md me mf bi translated">打开“fastapi/app”目录中的main.py文件</li><li id="eb70" class="lx ly hi jm b jn mg jr mh jv mi jz mj kd mk kh mc md me mf bi translated">添加导入行“from fastapi . middleware . CORS import CORS middleware”</li><li id="f661" class="lx ly hi jm b jn mg jr mh jv mi jz mj kd mk kh mc md me mf bi translated">创建一个名为origins的列表，并将字符串“http://0.0.0.0:3000”和“http://localhost:3000”添加到列表中</li><li id="9df5" class="lx ly hi jm b jn mg jr mh jv mi jz mj kd mk kh mc md me mf bi translated">调用app.add_middleware，将模块“CORSMiddleware”作为第一个参数，并将参数“allow_origins”设置为上一步中创建的“origins”变量</li></ol><div class="ml mm ez fb mn mo"><a href="https://github.com/chupati/farm-part-3/blob/main/fastapi/app/main.py" rel="noopener  ugc nofollow" target="_blank"><div class="mp ab dw"><div class="mq ab mr cl cj ms"><h2 class="bd hj fi z dy mt ea eb mu ed ef hh bi translated">farm-part-3/main.py位于main chupati/farm-part-3</h2><div class="mv l"><h3 class="bd b fi z dy mt ea eb mu ed ef dx translated">构建一个农场堆栈。第三部分。React包含在这个堆栈中。- farm-part-3/main.py位于main chupati/farm-part-3</h3></div><div class="mw l"><p class="bd b fp z dy mt ea eb mu ed ef dx translated">github.com</p></div></div><div class="mx l"><div class="my l mz na nb mx nc ik mo"/></div></div></a></div><pre class="lc ld le lf fd lg lh li lj aw lk bi"><span id="fc57" class="ko in hi lh b fi ll lm l ln lo">origins = [<br/>    "http://0.0.0.0:3000",<br/>    "http://localhost:3000"<br/>]</span><span id="17c7" class="ko in hi lh b fi nd lm l ln lo">app = FastAPI()<br/>app.add_middleware(<br/>    CORSMiddleware,<br/>    allow_origins=origins,<br/>    allow_credentials=True,<br/>    allow_methods=["*"],<br/>    allow_headers=["*"],<br/>)</span></pre><p id="e7bc" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">有关CORS的更多信息，请查看Mozilla开发者网站上的CORS文档。<br/>的<a class="ae kn" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS" rel="noopener ugc nofollow" target="_blank">https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS</a>的栈是</p><h1 id="e582" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">Docker编写配置文件</h1><p id="516d" class="pw-post-body-paragraph jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated">栈的React部分的构建文件只有四行。</p><ul class=""><li id="30d9" class="lx ly hi jm b jn ki jr kj jv lz jz ma kd mb kh ne md me mf bi translated">第1行确保安装了运行React的节点</li><li id="e718" class="lx ly hi jm b jn mg jr mh jv mi jz mj kd mk kh ne md me mf bi translated">下一行将工作目录设置为“/app”</li><li id="f1e1" class="lx ly hi jm b jn mg jr mh jv mi jz mj kd mk kh ne md me mf bi translated">网络浏览器必须暴露端口3000</li><li id="5788" class="lx ly hi jm b jn mg jr mh jv mi jz mj kd mk kh ne md me mf bi translated">最后一行确保安装了必要的包，并启动了React应用程序</li></ul><p id="ede5" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated"><strong class="jm hj"> Docker构建文件“react . Docker File”</strong></p><div class="ml mm ez fb mn mo"><a href="https://github.com/chupati/farm-part-3/blob/main/react.dockerfile" rel="noopener  ugc nofollow" target="_blank"><div class="mp ab dw"><div class="mq ab mr cl cj ms"><h2 class="bd hj fi z dy mt ea eb mu ed ef hh bi translated">main Chu pati/farm-part-3/react . docker file</h2><div class="mv l"><h3 class="bd b fi z dy mt ea eb mu ed ef dx translated">构建一个农场堆栈。第三部分。React包含在这个堆栈中。-farm-part-3/react . docker file at main…</h3></div><div class="mw l"><p class="bd b fp z dy mt ea eb mu ed ef dx translated">github.com</p></div></div><div class="mx l"><div class="nf l mz na nb mx nc ik mo"/></div></div></a></div><pre class="lc ld le lf fd lg lh li lj aw lk bi"><span id="e202" class="ko in hi lh b fi ll lm l ln lo">from node:14.17.5<br/>WORKDIR /app<br/>EXPOSE 3000<br/>CMD npm install -l; npm start</span></pre><p id="f53e" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">“react”部分被添加到docker-compose文件中。文件夹“farm-react”映射到工作目录“/app”，容器端口3000映射到主机端口3000。</p><p id="211c" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated"><strong class="jm hj"> docker-compose.yml "react "部分</strong>堆栈是</p><div class="ml mm ez fb mn mo"><a href="https://github.com/chupati/farm-part-3/blob/main/docker-compose.yml" rel="noopener  ugc nofollow" target="_blank"><div class="mp ab dw"><div class="mq ab mr cl cj ms"><h2 class="bd hj fi z dy mt ea eb mu ed ef hh bi translated">main chupati的farm-part-3/docker-compose . yml/farm-part-3</h2><div class="mv l"><h3 class="bd b fi z dy mt ea eb mu ed ef dx translated">构建一个农场堆栈。第三部分。React包含在这个堆栈中。-farm-part-3/docker-compose . yml at main…</h3></div><div class="mw l"><p class="bd b fp z dy mt ea eb mu ed ef dx translated">github.com</p></div></div><div class="mx l"><div class="ng l mz na nb mx nc ik mo"/></div></div></a></div><pre class="lc ld le lf fd lg lh li lj aw lk bi"><span id="f4f1" class="ko in hi lh b fi ll lm l ln lo">react:<br/>    build:<br/>      context: ./<br/>      dockerfile: react.dockerfile<br/>    volumes:<br/>      - './farm-react:/app'<br/>    ports:<br/>      - 3000:3000</span></pre><p id="d738" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">除了添加到“docker-compose.yml”文件中的“react”部分之外，还有用于MongoDB凭证的环境变量，这与本系列前面部分中添加的硬编码凭证相反。这将在后面的“分发包”章节中讨论。</p><h1 id="18c4" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">反应表单组件</h1><p id="ea21" class="pw-post-body-paragraph jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated">这个项目的React部分最初是用React starter示例项目创建的。我添加了一个表单组件来展示与FastAPI服务器通信的示例。我喜欢使用Axios处理web请求，所以你可以在节点包管理器中看到这个包。</p><p id="1d04" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated"><a class="ae kn" href="https://github.com/facebook/create-react-app" rel="noopener ugc nofollow" target="_blank">https://github.com/facebook/create-react-app</a></p><h2 id="15bd" class="ko in hi bd io kp kq kr is ks kt ku iw jv kv kw ja jz kx ky je kd kz la ji lb bi translated">反应项目相关性</h2><p id="484e" class="pw-post-body-paragraph jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated">依赖项可以在farm-react/package.json中找到，代码可以在下面的GitHub位置找到。</p><div class="ml mm ez fb mn mo"><a href="https://github.com/chupati/farm-part-3/blob/main/farm-react/package.json" rel="noopener  ugc nofollow" target="_blank"><div class="mp ab dw"><div class="mq ab mr cl cj ms"><h2 class="bd hj fi z dy mt ea eb mu ed ef hh bi translated">main Chu pati/farm-part-3/package . JSON</h2><div class="mv l"><h3 class="bd b fi z dy mt ea eb mu ed ef dx translated">构建一个农场堆栈。第三部分。React包含在这个堆栈中。-main Chu pati/farm-part-3/package . JSON</h3></div><div class="mw l"><p class="bd b fp z dy mt ea eb mu ed ef dx translated">github.com</p></div></div><div class="mx l"><div class="nh l mz na nb mx nc ik mo"/></div></div></a></div><ul class=""><li id="6036" class="lx ly hi jm b jn ki jr kj jv lz jz ma kd mb kh ne md me mf bi translated">Axios:我在“farm-react/package.json”的“依赖项”部分添加了“axios: ^.21.1”</li></ul><h1 id="3ef6" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">主反应页面代码</h1><p id="d0ea" class="pw-post-body-paragraph jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated">我更新了create-react-app页面“farm-react/src/App.js ”,添加了从FastAPI服务器查询的表单，并在页面底部的表格中显示结果。</p><div class="ml mm ez fb mn mo"><a href="https://github.com/chupati/farm-part-3/blob/main/farm-react/src/App.js" rel="noopener  ugc nofollow" target="_blank"><div class="mp ab dw"><div class="mq ab mr cl cj ms"><h2 class="bd hj fi z dy mt ea eb mu ed ef hh bi translated">main Chu pati/farm-part-3/app . js</h2><div class="mv l"><h3 class="bd b fi z dy mt ea eb mu ed ef dx translated">构建一个农场堆栈。第三部分。React包含在这个堆栈中。-main Chu pati/farm-part-3/app . js</h3></div><div class="mw l"><p class="bd b fp z dy mt ea eb mu ed ef dx translated">github.com</p></div></div><div class="mx l"><div class="ni l mz na nb mx nc ik mo"/></div></div></a></div><pre class="lc ld le lf fd lg lh li lj aw lk bi"><span id="c672" class="ko in hi lh b fi ll lm l ln lo">import logo from './logo.svg';<br/>import './App.css';<br/>import {useState} from "react";<br/>import axios from "axios";</span><span id="9445" class="ko in hi lh b fi nd lm l ln lo">function App() {<br/>  const [comicBookTitle, setComicBookTitle] = useState("");<br/>  const [comicBookIssueNumber, setComicBookIssueNumber] = useState("");<br/>  const [comicsList, setComicsList] = useState([]);<br/>  const comicSearchHandler = async () =&gt; {<br/>    const response = await axios.get("<a class="ae kn" href="http://0.0.0.0:8000/comics/" rel="noopener ugc nofollow" target="_blank">http://0.0.0.0:8000/comics/</a>" + comicBookTitle + "/" + comicBookIssueNumber);<br/>    console.log(comicsList);<br/>    console.log(response.data);<br/>    setComicsList(response.data);<br/>    console.log(comicsList);<br/>  };</span><span id="da88" class="ko in hi lh b fi nd lm l ln lo">const handleComicTitleChange = (event) =&gt; {<br/>    setComicBookTitle(event.target.value);Example .env File<br/>  };</span><span id="48f3" class="ko in hi lh b fi nd lm l ln lo">const handleComicBookIssueNumber = (event) =&gt; {<br/>    setComicBookIssueNumber(event.target.value);<br/>  };<br/>  return (<br/>    &lt;div className="App"&gt;<br/>      &lt;header className="App-header"&gt;<br/>        &lt;img src={logo} className="App-logo" alt="logo" /&gt;<br/>        &lt;p&gt;<br/>          Edit &lt;code&gt;src/App.js&lt;/code&gt; and save to reload.<br/>        &lt;/p&gt;<br/>        &lt;a<br/>          className="App-link"<br/>          href="<a class="ae kn" href="https://reactjs.org" rel="noopener ugc nofollow" target="_blank">https://reactjs.org</a>"<br/>          target="_blank"<br/>          rel="noopener noreferrer"<br/>        &gt;<br/>          Learn React<br/>        &lt;/a&gt;<br/>        &lt;h1&gt;Comic Book API Form&lt;/h1&gt;<br/>        &lt;form&gt;<br/>          &lt;label htmlFor="comicBookTitleInput"&gt;Comic Book Title:&lt;/label&gt;&lt;br/&gt;<br/>          &lt;input type="text" name="comicBookTitleInput" id="comicBookTitleInput" value={comicBookTitle} onChange={handleComicTitleChange}/&gt;&lt;br/&gt;<br/>          &lt;label htmlFor="comicBookIssueNumberInput"&gt;Issue Number:&lt;/label&gt;&lt;br/&gt;<br/>          &lt;input type="text"  name="comicBookIssueNumberInput" id="comicBookIssueNumberInput" value={comicBookIssueNumber} onChange={handleComicBookIssueNumber}/&gt;&lt;br/&gt;<br/>        &lt;/form&gt;&lt;br/&gt;<br/>        &lt;button id="comicBookSearch" onClick={comicSearchHandler}&gt;Search&lt;/button&gt;<br/>        &lt;h2&gt;Search Results&lt;/h2&gt;<br/>        &lt;table&gt;<br/>          &lt;thead&gt;<br/>          &lt;tr&gt;<br/>            &lt;th&gt;Publisher Name&lt;/th&gt;<br/>            &lt;th&gt;Title&lt;/th&gt;<br/>            &lt;th&gt;Issue&lt;/th&gt;<br/>            &lt;th&gt;Publish Date&lt;/th&gt;<br/>          &lt;/tr&gt;<br/>          &lt;/thead&gt;<br/>          &lt;tbody&gt;<br/>          {comicsList.map((comicBook, key) =&gt;<br/>            &lt;tr key={key}&gt;<br/>                &lt;td&gt;{comicBook.publisher_name}&lt;/td&gt;<br/>                &lt;td&gt;{comicBook.series_name}&lt;/td&gt;<br/>                &lt;td&gt;{comicBook.number}&lt;/td&gt;<br/>                &lt;td&gt;{comicBook.on_sale_date}&lt;/td&gt;<br/>              &lt;/tr&gt;<br/>            )}<br/>          &lt;/tbody&gt;<br/>        &lt;/table&gt;<br/>      &lt;/header&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span><span id="d163" class="ko in hi lh b fi nd lm l ln lo">export default App;</span></pre><h2 id="daab" class="ko in hi bd io kp kq kr is ks kt ku iw jv kv kw ja jz kx ky je kd kz la ji lb bi translated">导入Axios</h2><p id="4d0d" class="pw-post-body-paragraph jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated">您必须使用以下代码行导入“Axios”包。</p><pre class="lc ld le lf fd lg lh li lj aw lk bi"><span id="3029" class="ko in hi lh b fi ll lm l ln lo">import axios from "axios";</span></pre><h2 id="b91c" class="ko in hi bd io kp kq kr is ks kt ku iw jv kv kw ja jz kx ky je kd kz la ji lb bi translated">设置React应用程序状态属性</h2><p id="fe75" class="pw-post-body-paragraph jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated">用下面几行将应用程序状态属性添加到React应用程序的“app”函数中。这些属性表示将从FastAPI服务器返回的数据。属性数据将被填充到添加到React应用程序的HTML表中。</p><pre class="lc ld le lf fd lg lh li lj aw lk bi"><span id="e854" class="ko in hi lh b fi ll lm l ln lo">const [comicBookTitle, setComicBookTitle] = useState("");<br/>const [comicBookIssueNumber, setComicBookIssueNumber] = useState("");<br/>const [comicsList, setComicsList] = useState([]);</span></pre><h2 id="6e24" class="ko in hi bd io kp kq kr is ks kt ku iw jv kv kw ja jz kx ky je kd kz la ji lb bi translated">添加FastAPI GET请求和搜索表单处理程序</h2><p id="8f50" class="pw-post-body-paragraph jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated">在“App”函数中添加一个表单搜索处理程序“comicSearchHandler”要调用FastAPI服务器，使用“await axios.get”创建一个GET请求。注意“0.0.0.0:8000”是硬编码的。但这很可能是一个环境变量。出于简单和演示的目的，FastAPI服务器URL是硬编码的。调用“await axios.get”提供了获取所请求的漫画数据的功能。</p><p id="ac4a" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">属性“comicBookTitle”和“comicBookIssueNumber”用于创建GET请求中使用的URL。</p><pre class="lc ld le lf fd lg lh li lj aw lk bi"><span id="b302" class="ko in hi lh b fi ll lm l ln lo">const comicSearchHandler = async () =&gt; {<br/>  const response = await axios.get("<a class="ae kn" href="http://0.0.0.0:8000/comics/" rel="noopener ugc nofollow" target="_blank">http://0.0.0.0:8000/comics/</a>" + comicBookTitle + "/" + comicBookIssueNumber);<br/>  console.log(comicsList);<br/>  console.log(response.data);<br/>  setComicsList(response.data);<br/>  console.log(comicsList);<br/>};</span></pre><h2 id="3e9b" class="ko in hi bd io kp kq kr is ks kt ku iw jv kv kw ja jz kx ky je kd kz la ji lb bi translated">在输入框改变时更新应用程序状态</h2><p id="2853" class="pw-post-body-paragraph jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated">添加变量“handleComicTitleChange”和“handleComicBookIssueNumber”来处理对表单文本输入框的任何更改。</p><p id="596d" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">属性“comicBookTitle”和“comicBookIssueNumber”用分配给变量“handleComicTitleChange”和“handleComicBookIssueNumber”的处理程序更新</p><pre class="lc ld le lf fd lg lh li lj aw lk bi"><span id="0642" class="ko in hi lh b fi ll lm l ln lo">const handleComicTitleChange = (event) =&gt; {<br/>  setComicBookTitle(event.target.value);<br/>};<br/>const handleComicBookIssueNumber = (event) =&gt; {<br/>  setComicBookIssueNumber(event.target.value);<br/>};</span></pre><h2 id="0900" class="ko in hi bd io kp kq kr is ks kt ku iw jv kv kw ja jz kx ky je kd kz la ji lb bi translated">创建搜索表单并设置变更处理程序</h2><p id="9a45" class="pw-post-body-paragraph jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated">添加一个HTML表单来输入漫画书标题、漫画书发行号，并包含一个搜索按钮。</p><p id="cc7e" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">对于输入字段“comicBookTitleInput”和“comicBookIssueNumberInput”，处理程序“handleComicTitleChange”和“handleComicBookIssueNumber”被设置为“onChange”属性</p><p id="83bf" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">将按钮“comicBookSearch”的“onClick”属性设置为“comicSearchHandler”</p><pre class="lc ld le lf fd lg lh li lj aw lk bi"><span id="fbd9" class="ko in hi lh b fi ll lm l ln lo">&lt;form&gt;<br/>  &lt;label htmlFor="comicBookTitleInput"&gt;Comic Book Title:&lt;/label&gt;&lt;br/&gt;<br/>  &lt;input type="text" name="comicBookTitleInput" id="comicBookTitleInput" value={comicBookTitle} onChange=,{handleComicTitleChange}/&gt;&lt;br/&gt;<br/>  &lt;label htmlFor="comicBookIssueNumberInput"&gt;Issue Number:&lt;/label&gt;&lt;br/&gt;<br/>  &lt;input type="text" name="comicBookIssueNumberInput" id="comicBookIssueNumberInput" value={comicBookIssueNumber} onChange={handleComicBookIssueNumber}/&gt;&lt;br/&gt;<br/>&lt;/form&gt;<br/>&lt;button id="comicBookSearch" onClick={comicSearchHandler}&gt;Search&lt;/button&gt;</span></pre><h2 id="1402" class="ko in hi bd io kp kq kr is ks kt ku iw jv kv kw ja jz kx ky je kd kz la ji lb bi translated">添加结果表</h2><p id="8dcc" class="pw-post-body-paragraph jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated">添加的表将用于加载FastAPI调用结果数据。表数据被加载到上面讨论的“comicSearchHandler”中。每个行单元格都映射到FastAPI服务在“comicSearchHandler”GET请求中返回的JSON数据。“comicsList.map”是用于通过“comicsList”属性进行迭代的机制。</p><pre class="lc ld le lf fd lg lh li lj aw lk bi"><span id="9ae2" class="ko in hi lh b fi ll lm l ln lo">&lt;table&gt;<br/>  &lt;thead&gt;<br/>    &lt;tr&gt;<br/>      &lt;th&gt;Publisher Name&lt;/th&gt;<br/>      &lt;th&gt;Title&lt;/th&gt;<br/>      &lt;th&gt;Issue&lt;/th&gt;<br/>      &lt;th&gt;Publish Date&lt;/th&gt;<br/>    &lt;/tr&gt;<br/>  &lt;/thead&gt;<br/>  &lt;tbody&gt;<br/>{comicsList.map((comicBook, key) =&gt;<br/>    &lt;tr key={key}&gt;<br/>      &lt;td&gt;{comicBook.publisher_name}&lt;/td&gt;<br/>      &lt;td&gt;{comicBook.series_name}&lt;/td&gt;<br/>      &lt;td&gt;{comicBook.number}&lt;/td&gt;<br/>      &lt;td&gt;{comicBook.on_sale_date}&lt;/td&gt;<br/>    &lt;/tr&gt;<br/>)}<br/>  &lt;/tbody&gt;<br/>&lt;/table&gt;</span></pre><h1 id="cf2f" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">用于分发的包装</h1><p id="f549" class="pw-post-body-paragraph jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated">在本系列的前几部分中，可以在docker-compose文件中找到硬编码的MongoDB凭证。如果您希望将它分发给队友，但不希望他们使用与您相同的凭证，您可以使用名为“. env”的环境变量配置文件。env "文件，并使用在。env "文件，如果它存在的话。可以加”。婀“到了”。git ignore“git存储库的文件，以便”。env "文件不包含在您的存储库中。</p><p id="cf5c" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">要引用“docker-compose.yml”文件中的环境变量，请键入“$”字符，并将环境变量插入到大括号“{}”中例如，如果要引用环境变量“MONGO_USER”，请键入“${MONGO_USER}”</p><p id="febf" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated"><strong class="jm hj">举例。环境文件</strong></p><pre class="lc ld le lf fd lg lh li lj aw lk bi"><span id="6798" class="ko in hi lh b fi ll lm l ln lo">MONGO_USER=root<br/>MONGO_PASSWORD=OTNmYTdjYmZkMjE5ZmYzODg0MDZiYWJh</span></pre><p id="0b94" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated"><strong class="jm hj"> Docker-compose.yml环境变量在“mongo”部分</strong></p><pre class="lc ld le lf fd lg lh li lj aw lk bi"><span id="01d9" class="ko in hi lh b fi ll lm l ln lo">mongo:<br/>  image: mongo<br/>  restart: always<br/>  environment:<br/>    MONGO_INITDB_ROOT_USERNAME: ${MONGO_USER}<br/>    MONGO_INITDB_ROOT_PASSWORD: ${MONGO_PASSWORD}<br/>  volumes:<br/>    - ./data/mongo:/data/db<br/>    - ./data/mongo-init:/docker-entrypoint-initdb.d<br/>  ports:<br/>    - "27017:27017"</span></pre><h1 id="8b58" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">结论</h1><p id="5a7f" class="pw-post-body-paragraph jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated">现在Docker构建栈已经完成，您可以使用“docker-compose up”命令运行栈。</p><p id="c4a3" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">将您的网络浏览器指向“https://0.0.0.0:3000”，您将看到“漫画API表单”</p><p id="3b96" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">输入带有发行号的漫画书名，例如“黑豹”和“15”。点击“搜索”您将在表单下方看到加载的结果。</p><figure class="lc ld le lf fd ij er es paragraph-image"><div role="button" tabindex="0" class="nk nl di nm bf nn"><div class="er es nj"><img src="../Images/c391c86fca4fa85cb89918e10a9fc699.png" data-original-src="https://miro.medium.com/v2/resize:fit:1368/0*5Nsybi1cN8ukIufD"/></div></div></figure><figure class="lc ld le lf fd ij er es paragraph-image"><div role="button" tabindex="0" class="nk nl di nm bf nn"><div class="er es no"><img src="../Images/9b58110923d8ee66aa898b855a45eb17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*tCgI8XxoI_IcH5HV"/></div></div></figure><p id="e52b" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">我希望本系列对您有所帮助，并且现在能够快速启动您的农场栈进行开发。您还应该能够将您的农场堆栈分发给您的队友，而不会危及本地农场堆栈的安全。</p></div></div>    
</body>
</html>