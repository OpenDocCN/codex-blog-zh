<html>
<head>
<title>A Spring Cloud Compatible Service Mesh</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Spring云兼容服务网格</h1>
<blockquote>原文：<a href="https://medium.com/codex/a-spring-cloud-compatible-service-mesh-6ce58c571012?source=collection_archive---------3-----------------------#2021-08-24">https://medium.com/codex/a-spring-cloud-compatible-service-mesh-6ce58c571012?source=collection_archive---------3-----------------------#2021-08-24</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><h1 id="3779" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">背景</h1><p id="eaa4" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">目前，市场上的服务网格技术大多用于解决微服务系统架构下的服务管理和治理问题，主要包括以下子系统:</p><p id="a1ea" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">交通调度系统</strong></p><ul class=""><li id="e4b5" class="kg kh hi jf b jg kb jk kc jo ki js kj jw kk ka kl km kn ko bi translated"><strong class="jf hj">服务注册和发现系统</strong></li><li id="333f" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated"><strong class="jf hj">流量路由</strong>，A/B测试，蓝绿色部署，金丝雀部署(全路径流量着色和标记)</li><li id="150d" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated"><strong class="jf hj">东西交通边车。</strong>流量劫持，如<a class="ae ku" href="https://istio.io/" rel="noopener ugc nofollow" target="_blank"> Istio </a>，非流量劫持，阿里巴巴开源<a class="ae ku" href="https://mosn.io/docs/concept/traffic-hijack/" rel="noopener ugc nofollow" target="_blank"> MOSN </a></li><li id="465a" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated"><strong class="jf hj">服务实例负载均衡</strong>(轮询/加权轮询/一致哈希/随机等。)</li></ul><p id="a942" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">弹性&amp;容错系统</strong></p><ul class=""><li id="7c33" class="kg kh hi jf b jg kb jk kc jo ki js kj jw kk ka kl km kn ko bi translated"><strong class="jf hj">限速</strong>。限制传入请求的速率。</li><li id="7d4b" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated"><strong class="jf hj">断路器</strong>。当一个系统陷入严重困境时，快速失败比让客户等待更好。</li><li id="6387" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated"><strong class="jf hj">重试</strong>。许多故障都是暂时的，经过短暂的延迟后可能会自行纠正。</li><li id="21a4" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated"><strong class="jf hj">超时控制。超过一定的等待间隔，成功的结果是不可能的。</strong></li><li id="00df" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated"><strong class="jf hj">健康检查</strong>。确定服务是否正常。</li><li id="9c00" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated"><strong class="jf hj">缓存</strong>。某些比例的请求可能是相似的。</li></ul><p id="901d" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">观察系统</strong></p><ul class=""><li id="c69b" class="kg kh hi jf b jg kb jk kc jo ki js kj jw kk ka kl km kn ko bi translated"><strong class="jf hj">分布式跟踪</strong>。比如Zipkin，Jaeger，OpenTracing等。</li><li id="7f75" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated"><strong class="jf hj">流量指标</strong>。例如服务等待时间/错误率/请求总数/请求错误代码分布</li><li id="f88d" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated"><strong class="jf hj">日志</strong>。例如访问日志、错误日志、系统日志等。</li></ul><p id="f411" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">安全系统</strong></p><ul class=""><li id="edd3" class="kg kh hi jf b jg kb jk kc jo ki js kj jw kk ka kl km kn ko bi translated"><strong class="jf hj">认证</strong>。例如mTLS，访问服务的特权</li><li id="9a55" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated"><strong class="jf hj">授权</strong>。确定该服务是否有权访问其他服务</li><li id="44b0" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated"><strong class="jf hj">加密</strong>。服务间通信加密</li></ul><h1 id="40ba" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">问题</h1><p id="1aab" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">目前，市场上的服务网格大多基于Kubernetes解决方案。此外，它提供了一个非侵入性的跨语言级别的解决方案。我们认为目前市场上的解决方案存在以下问题:</p><ul class=""><li id="3b6a" class="kg kh hi jf b jg kb jk kc jo ki js kj jw kk ka kl km kn ko bi translated"><strong class="jf hj">缺乏完整的服务内部观察能力</strong>。从服务级别的角度来看。不仅收集应用程序指标(如吞吐量、延迟、错误率等)，还需要了解服务如何访问数据库、缓存、消息队列等。此外，它还包含相应的跟踪日志。所有的指标和日志必须相互关联。</li><li id="e6c3" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated"><strong class="jf hj">金丝雀的部署太简单、太天真，不实际。</strong>真正的canary部署应该能够基于由特定标签标记的特定用户来执行。金丝雀流量不仅需要从北到南，还需要从东到西传递给整个服务。</li><li id="ba27" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated">【Java社区的迁移问题。尤其是Spring Cloud与基于Kubernetes的服务网格有着完全不同的架构。要迁移它，它必须放弃spring云解决方案，如服务注册中心&amp;发现、配置管理、弹性&amp;容错等等。然而，Spring Cloud比当前的服务网格更成熟，也更有企业精神。</li><li id="b270" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated"><strong class="jf hj">复杂的开发环境</strong>。与spring云开发相比，当前的服务网格与Kubernetes紧密耦合，因此，如果开发人员需要调试/测试他们的代码，他们需要一个Kubernetes环境。</li><li id="a2d1" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated"><strong class="jf hj">基于“iptables”的流量劫持不是一个有效的解决方案</strong>。IPTABLE有效率问题，会消耗太多内核资源。并且很难维护和排除故障。</li></ul><h1 id="d3bf" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">比较</h1><p id="f287" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">显然，Spring Cloud和Service Mesh各有优缺点。如果我们能够将它们结合起来，允许用户利用这两种解决方案的能力，我们就可以拥有最大的能力。</p><p id="9f4e" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">下表是Spring云和Service Mesh的对比。</p><figure class="kw kx ky kz fd la er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es kv"><img src="../Images/d28ea512cebfc2262319a219dad1fd48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AWc1HwjqMqTZNRyUPXYihw.png"/></div></div></figure><p id="34c9" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">从上表的对比中，我们就能明白其中的利弊。然而，工程是我们每天都要面对的一种权衡。这种比较可能是不公平的，因为Service Mesh需要解决一个跨语言、跨平台的解决方案，但是Spring Cloud只是一个基于Java的应用级解决方案。</p><p id="6780" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">换句话说，Service Mesh的通用性要在它的一些能力上妥协，Spring Cloud的专业性可以在它自己的领域里专攻。</p><p id="c08a" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">我们认为可能会有一个解决方案，人们不需要做出非黑即白的决定，尤其是在Spring Cloud和基于Kubernetes的服务网格之间的困境。</p><p id="c0d0" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">此外，Java和Spring是如此强大和成熟，以至于许多企业在他们的关键业务中广泛深入地使用Java，例如金融、电子商务、电信、制造、零售等等。Java社区拥有最流行和最大的生态系统，我们认为服务网格应该与之兼容。</p><p id="2223" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">因此，我们决定开发一种新型的服务网格，它可以由Kubernetes编排，但可以与Spring Cloud完全兼容。换句话说，spring云应用可以无成本地平滑迁移到服务网格。</p><h1 id="8d4b" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">易网</h1><p id="f4fa" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated"><a class="ae ku" href="https://github.com/megaease/easemesh" rel="noopener ugc nofollow" target="_blank"> EaseMesh </a>是一个兼容Spring Cloud生态系统的服务网格。它使用<a class="ae ku" href="https://github.com/megaease/easegress" rel="noopener ugc nofollow" target="_blank"> Easegress </a>(参考<a class="ae ku" href="https://megaease.medium.com/the-next-generation-service-gateway-7cf4bd50c9bd" rel="noopener">下一代服务网关</a>)作为边站和流量网关，使用<a class="ae ku" href="https://github.com/megaease/easeagent" rel="noopener ugc nofollow" target="_blank"> EaseAgnet </a>作为服务内部监控的JavaAgent。</p><p id="7f11" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">Sidecar和JavaAgent都是非侵入性技术，换句话说，Ease Mesh可以在不修改一行源代码的情况下将Spring Cloud应用程序迁移到service mesh，并且整个架构已经被赋予了全功能的服务治理、弹性设计和完整的可观察性。</p><p id="707a" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">下图显示了一个示例。</p><figure class="kw kx ky kz fd la er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es lh"><img src="../Images/f6a5f728d9307cf04b8221db78a7a6f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ZSnoY_6Q4ghIHxU5"/></div></div><figcaption class="li lj et er es lk ll bd b be z dx translated">来源:<a class="ae ku" href="https://github.com/megaease/easemesh/blob/main/imgs/topology-migration.png" rel="noopener ugc nofollow" target="_blank">https://github . com/mega ease/ease mesh/blob/main/imgs/topology-migration . png</a></figcaption></figure><p id="89f0" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">在左侧，图表显示了“<a class="ae ku" href="https://github.com/spring-petclinic/spring-petclinic-cloud" rel="noopener ugc nofollow" target="_blank"> Spring Cloud PetClinic </a>”微服务示例。这是Spring Cloud系列，包括Spring Cloud Gateway、Spring Cloud断路器、Spring Cloud Config、Spring Cloud Sleuth、Resilience4j、Micrometer和Spring Cloud网飞技术堆栈中的Eureka服务发现。</p><p id="6e0b" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">通过使用Eash Mesh的Kubernetes CRD(自定义资源定义)，只需几个命令行，整个Spring云应用程序就迁移到了服务网格。</p><p id="1bcd" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">服务发现、配置管理、流量调度、弹性和容错边盘、全栈监控(指标、日志、跟踪)和全栈canary部署都已完成。(上图的右边部分显示了架构)</p><p id="7baf" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">现在，让我们浏览一下细节:</p><p id="a868" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">自动组装sidecar和JavaAgent。</strong>通过使用Kubernetes CRD，很容易透明地将sidecar和JavaAgent安装到Java应用程序中。</p><p id="f932" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj"> Eash Mesh使用Easegress进行服务治理</strong>。Easegress带来了以下主要特性。</p><ul class=""><li id="0c74" class="kg kh hi jf b jg kb jk kc jo ki js kj jw kk ka kl km kn ko bi translated"><strong class="jf hj">应用级服务发现</strong>——完全兼容Java的服务注册和发现——Eureka、Console、Nacos等。</li><li id="9aa4" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated"><strong class="jf hj">筏共识。Easegress有一个内置的Raft协议，主节点将是服务注册和发现，从节点将是sidecar。</strong></li><li id="68c1" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated"><strong class="jf hj">弹性设计</strong>。Easegress从Java移植了[resilience 4j](https://github . com/resilience 4j/resilience 4j)到Go，所以，它带来了那些容错功能——比如断路器、限速器、重试等等。</li><li id="c76c" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated"><strong class="jf hj">交通编排</strong>。Easegress可以着色南北和东西交通，并同步整个集群。这可以进行集群范围的canary部署。</li></ul><p id="5b60" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">智能流量劫持</strong>。与其他服务网格使用“iptables”劫持流量不同，Ease Mesh只是将服务发现端点重新配置/劫持到sidecar，并且Ease Mesh将sidecar IP地址(127.0.0.1)作为远程服务返回。sidecar负责真正的服务发现和远程通信。这种解决方案不会带来任何网络复杂性。</p><p id="9584" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">下图显示了该架构</p><figure class="kw kx ky kz fd la er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es lh"><img src="../Images/1eed7669641c002e30b5c9abecfb0ca2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*hQuddSYPmh70xFnm"/></div></div><figcaption class="li lj et er es lk ll bd b be z dx translated">来源:<a class="ae ku" href="https://github.com/megaease/easemesh/blob/main/imgs/architecture.png" rel="noopener ugc nofollow" target="_blank">https://github . com/mega ease/ease mesh/blob/main/imgs/architecture . png</a></figcaption></figure><p id="a8de" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">更多细节，请参考GitHub repo—<a class="ae ku" href="https://github.com/megaease/easemesh" rel="noopener ugc nofollow" target="_blank">https://github.com/megaease/easemesh</a>，它在Apache 2.0许可下。</p><p id="d2e4" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">借助Spring Cloud和Kubernetes的优势，使用成熟的企业级架构管理、编排和监控Java应用程序是零成本的。</p><p id="867a" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">除此之外，我们还可以提供许多先进的企业解决方案。</p><h1 id="f59c" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">金丝雀部署</h1><p id="5eaf" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">第一件事是金丝雀部署，金丝雀部署是一项技术，我们可以限制新版本的功能只能由某些用户看到，这可以降低风险。要做好金丝雀发布，我们需要以下特性:</p><ul class=""><li id="f5cb" class="kg kh hi jf b jg kb jk kc jo ki js kj jw kk ka kl km kn ko bi translated"><strong class="jf hj">用户标签:</strong>一种定义用户标签的机制，用于识别用户是否是金丝雀。好标签必须使用用户端数据，如用户代理、Cookie、用户令牌、位置等。</li><li id="6d78" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated"><strong class="jf hj">服务版本发现</strong>:我们需要管理服务版本，并了解哪个版本适用于canary用户。</li><li id="2510" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated"><strong class="jf hj">流量调度</strong>:网关可以检查用户，并将请求路由到正确的服务实例。</li></ul><p id="c83f" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">有了EaseMesh，我们可以轻松地完成这一点，而无需任何代码更改。您可以查看这个演示文档，了解如何做到这一点。<a class="ae ku" href="https://github.com/megaease/easemesh#72-canary-deployment" rel="noopener ugc nofollow" target="_blank">https://github.com/megaease/easemesh#72-canary-deployment</a></p><figure class="kw kx ky kz fd la er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es lm"><img src="../Images/f77f764ea443524904d1553f0a6e92c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*sXzof508mjUD1g95"/></div></div><figcaption class="li lj et er es lk ll bd b be z dx translated">来源:<a class="ae ku" href="https://github.com/megaease/easemesh/blob/main/imgs/canary-deployment.png" rel="noopener ugc nofollow" target="_blank">https://github . com/mega ease/ease mesh/blob/main/imgs/canary-deployment . png</a></figcaption></figure><h1 id="f7be" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">生产性能测试</h1><p id="d41e" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">第二件事是在产品上运行性能测试。</p><p id="ae2b" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">在微服务架构中，建立一个与生产环境相同的完整环境来对整个站点进行性能测试的成本很高。因此，如果我们能够在生产中运行性能测试，那将是非常棒的。</p><p id="243a" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">然而，在生产上运行性能测试可能会非常具有挑战性，这就需要我们解决以下问题。</p><ul class=""><li id="26bb" class="kg kh hi jf b jg kb jk kc jo ki js kj jw kk ka kl km kn ko bi translated"><strong class="jf hj">不会冲击真正的客户</strong>。性能测试会消耗大量资源，会对我们的客户产生很大影响。</li><li id="cbd9" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated"><strong class="jf hj">测试数据可以轻松清理</strong>。性能测试会带来大量的数据，这些数据需要被清理。</li></ul><p id="963e" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">使用EaseMesh，我们可以做以下事情。</p><ul class=""><li id="c867" class="kg kh hi jf b jg kb jk kc jo ki js kj jw kk ka kl km kn ko bi translated">为所有服务部署影子服务。</li><li id="519d" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated">镜像所有的中间件，比如数据库、队列、缓存系统。</li><li id="d1b7" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated">使用JavaAgent或Sidecar劫持到镜像中间件的流量。</li><li id="da8b" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated">将性能测试流量调度到影子服务。</li></ul><p id="6b5d" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">下图显示了EaseMesh如何实现这一点。</p><figure class="kw kx ky kz fd la er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es ln"><img src="../Images/617ce7e52988c43bba9260420fcd33b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*KBsa1JQ-p-hXjijB"/></div></div></figure><p id="fed0" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">我们可以看到以下作品对EaseMesh有所帮助:</p><ul class=""><li id="e0a9" class="kg kh hi jf b jg kb jk kc jo ki js kj jw kk ka kl km kn ko bi translated">首先，我们可以克隆这些服务所依赖的所有中间件(数据库、队列、缓存等)，我们称之为“影子中间件”</li><li id="28c9" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated">其次，EashMesh为所有的服务部署测试服务，我们称之为“影子服务”。</li><li id="81a5" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated">然后，EaseMesh将影子服务的中间件访问重定向到“影子中间件”</li><li id="84f7" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated">然后，EaseMesh将测试流量调度到影子服务和影子中间件。</li><li id="46c2" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated">最后，我们可以安全轻松地移除所有的“影子服务”和“影子中间件”。</li></ul><p id="ed4f" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">无需修改任何源代码，EaseMesh为生产环境下的性能测试带来了完美的解决方案，而且方便、简单、安全。</p><p id="869a" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">此外，我们可以用Ease Mesh做越来越多这样的事情，我们期待着您对这个新服务Mesh的建议或关注，甚至帮助我们把它做得更好。请随时在我们的Github—<a class="ae ku" href="https://github.com/megaease/easemesh" rel="noopener ugc nofollow" target="_blank">https://github.com/megaease/easemesh</a>中提出问题或贡献代码</p></div></div>    
</body>
</html>