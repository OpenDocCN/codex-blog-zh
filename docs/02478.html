<html>
<head>
<title>Graphing the Louvre</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">绘制卢浮宫</h1>
<blockquote>原文：<a href="https://medium.com/codex/graphing-the-louvre-9a531123eca3?source=collection_archive---------11-----------------------#2021-07-22">https://medium.com/codex/graphing-the-louvre-9a531123eca3?source=collection_archive---------11-----------------------#2021-07-22</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/52f97ad0de85398d7a44dc7a593f00ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*RnbgZph8mbK6Y0qs"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">米卡·鲍梅斯特在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="dc51" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi jt translated"><span class="l ju jv jw bm jx jy jz ka kb di"> T </span>何<a class="ae iu" href="https://en.wikipedia.org/wiki/Louvre" rel="noopener ugc nofollow" target="_blank">卢浮宫</a> <a class="ae iu" href="https://www.france24.com/en/culture/20210326-louvre-museum-makes-its-entire-collection-available-online" rel="noopener ugc nofollow" target="_blank">数字化</a>超过48万(！)的艺术作品，并在今年早些时候通过一个在线收藏数据库提供这些作品。从那以后，我就一直在关注这个系列，想把它们拼凑成一个图表。</p><p id="ae4b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在我的同事Tom Geudens@Neo4j对json摘录的帮助下(在撰写本文时，还没有发现像<a class="ae iu" href="https://github.com/metmuseum/openaccess" rel="noopener ugc nofollow" target="_blank"> this </a> one这样的开放访问)，我将带您一步步了解如何将JSON摘录吸收到<a class="ae iu" href="https://neo4j.com/" rel="noopener ugc nofollow" target="_blank"> Neo4j </a>(版本。4.3+).</p><blockquote class="kc kd ke"><p id="016f" class="iv iw kf ix b iy iz ja jb jc jd je jf kg jh ji jj kh jl jm jn ki jp jq jr js hb bi translated">注意:这篇文章假设你对Neo4j和图形数据库有基本的了解。抓取网页的过程不在这篇博文的讨论范围之内。这也使得一篇冗长的文章充满了代码~密码。</p></blockquote></div><div class="ab cl kj kk gp kl" role="separator"><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko"/></div><div class="hb hc hd he hf"><p id="7adb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">卢浮宫的480，000多件展品中的每一件都由一个<a class="ae iu" href="https://www.wikidata.org/wiki/Property:P9394" rel="noopener ugc nofollow" target="_blank"> ARK ID </a>唯一标识，并带有一个统一的json结构，如下所示；</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kq"><img src="../Images/b27574fef74cacf84a161f489a31afc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vG_p0tn95RrK756IP4yOjQ.png"/></div></div></figure><p id="abc4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，json摘录被组织成1000个文件系统文件夹，每个文件夹包含大约400多个json文档，构成了我们讨论的所有卢浮宫集合。我们从接受大部分json结构开始(除了大型文本描述属性，比如书目、展览等。)作为标记为“Exhibit”的节点，在某个点(<em class="kf">即绘画、素描&amp;版画、雕塑、家具、纺织品、珠宝&amp;服饰、文字&amp;铭文、物品</em>。</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="5fb7" class="la lb hi kw b fi lc ld l le lf">CREATE CONSTRAINT exhibitArkID ON (e:Exhibit) ASSERT e.arkID IS UNIQUE;</span><span id="af57" class="la lb hi kw b fi lg ld l le lf">CALL apoc.periodic.iterate(<br/>"UNWIND range(0,999) AS item<br/>WITH 'file:///Users/Priya_Jacob/Documents/neo4j43/neo4j-enterprise-4.3.0/import/louvre_collection_json/'+ apoc.text.lpad(toString(item),3,'0') AS f<br/>RETURN f",<br/>"CALL apoc.cypher.run('CALL apoc.load.directory(\"*.json\", $file, {recursive:false}) YIELD value AS url WITH \"file://\" + replace(url,\"\\\\\\\\\",\"/\") AS url CALL apoc.load.json(url) YIELD value RETURN value AS row',{file:f}) YIELD value  <br/>WITH value.row AS row<br/>MERGE (e:Exhibit {arkID:trim(row.arkId)})<br/>SET <br/>e.collection = trim(row.collection),<br/>e.category = CASE WHEN NOT row.index = [] THEN [x IN row.index.category | trim(x.value)] ELSE NULL END,<br/>e.relatedWork = CASE WHEN NOT row.relatedWork = [] THEN [x IN row.relatedWork | SPLIT(x.objectUrl,'/')[-1]] ELSE NULL END,<br/>e.modified = CASE WHEN NOT trim(row.modified) = '' THEN trim(row.modified) ELSE NULL END,<br/>e.inventoryNumber = CASE WHEN NOT row.objectNumber = [] THEN [x IN row.objectNumber | trim(x.value)] ELSE NULL END,<br/>e.description = CASE WHEN NOT trim(row.description) = '' THEN trim(row.description) ELSE NULL END,<br/>e.dateOfDiscovery = CASE WHEN NOT trim(row.dateOfDiscovery) = '' THEN trim(row.dateOfDiscovery) ELSE NULL END,<br/>e.title = CASE WHEN NOT trim(row.title) = '' THEN trim(row.title) ELSE NULL END,<br/>e.objectType = CASE WHEN NOT trim(row.objectType) = '' THEN trim(row.objectType) ELSE NULL END,<br/>e.placeOfCreation = CASE WHEN NOT trim(row.placeOfCreation) = '' THEN trim(row.placeOfCreation) ELSE NULL END,<br/>e.provenance = CASE WHEN NOT trim(row.provenance) = '' THEN trim(row.provenance) ELSE NULL END,<br/>e.heldBy = CASE WHEN NOT trim(row.heldBy) = '' THEN trim(row.heldBy) ELSE NULL END,<br/>e.longTermLoanTo = CASE WHEN NOT trim(row.longTermLoanTo) = '' THEN trim(row.longTermLoanTo) ELSE NULL END,<br/>e.namesAndTitles = CASE WHEN NOT trim(row.namesAndTitles) = '' THEN trim(row.namesAndTitles) ELSE NULL END,<br/>e.denominationTitle = CASE WHEN NOT trim(row.denominationTitle) = '' THEN trim(row.denominationTitle) ELSE NULL END,<br/>e.shape = CASE WHEN NOT trim(row.shape) = '' THEN trim(row.shape) ELSE NULL END,<br/>e.titleComplement = CASE WHEN NOT trim(row.titleComplement) = '' THEN trim(row.titleComplement) ELSE NULL END,<br/>e.inscriptions = CASE WHEN NOT trim(row.inscriptions) = '' THEN trim(row.inscriptions) ELSE NULL END,<br/>e.placeOfDiscovery = CASE WHEN NOT trim(row.placeOfDiscovery) = '' THEN trim(row.placeOfDiscovery) ELSE NULL END,<br/>e.technic = CASE WHEN NOT row.index = [] THEN [x IN row.index.technic | trim(x.value)] ELSE NULL END,<br/>e.period = CASE WHEN NOT row.index = [] THEN [x IN row.index.period | trim(x.value)] ELSE NULL END,<br/>e.material = CASE WHEN NOT row.index = [] THEN [x IN row.index.material | trim(x.value)] ELSE NULL END,<br/>e.feature = CASE WHEN NOT row.index = [] THEN [x IN row.index.description | trim(x.value)] ELSE NULL END,<br/>e.inscriptionType = CASE WHEN NOT row.index = [] THEN [x IN row.index.inscriptionType | trim(x.value)] ELSE NULL END,<br/>e.place = CASE WHEN NOT row.index = [] THEN [x IN row.index.place | trim(x.value)] ELSE NULL END,<br/>e.nameAndTitle = CASE WHEN NOT row.index = [] THEN [x IN row.index.nameAndTitle | trim(x.value)] ELSE NULL END,<br/>e.denomination = CASE WHEN NOT row.index = [] THEN [x IN row.index.denomination | trim(x.value)] ELSE NULL END,<br/>e.materialsAndTechniques = CASE WHEN NOT trim(row.materialsAndTechniques) = '' THEN trim(row.materialsAndTechniques) ELSE NULL END,<br/>e.room = CASE WHEN NOT trim(row.room) = '' THEN trim(row.room) ELSE NULL END,<br/>e.currentLocation = CASE WHEN NOT trim(row.currentLocation) = '' THEN trim(row.currentLocation) ELSE NULL END,<br/>e.displayDateCreated = CASE WHEN NOT trim(row.displayDateCreated) = '' THEN trim(row.displayDateCreated) ELSE NULL END,<br/>e.onomastics = CASE WHEN NOT trim(row.onomastics) = '' THEN trim(row.onomastics) ELSE NULL END<br/>",<br/>{batchSize:1, parallel:true}<br/>)</span></pre><p id="1895" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在撰写本文时，我们粗略地检查了一下，看看这些数字是否与卢浮宫收藏页面上的4，82，438个列表相符(因为该网站是一个“正在进行中的工作”，来自持续的存储库更新，是博物馆文档工作的一部分)。</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lh"><img src="../Images/e4aedcced9e0048ba69ae23fa1d5ecff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h3Ne6AOT-gKTfR7duL5jtQ.png"/></div></div></figure><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="fab6" class="la lb hi kw b fi lc ld l le lf">MATCH (n:Exhibit)<br/>RETURN n.collection AS collection, COUNT(n) AS cnt<br/>ORDER BY cnt DESC</span></pre><p id="a170" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">接下来，我们引入每个展览的创作者，这是一个带有艺术家标签、维基数据标识符、链接、属性和来源(日期和地点)的地图列表。</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es li"><img src="../Images/8a4900776e2aa2dd1ed9232410f62e36.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZSSr8glE2FGhZ4pkGnQ7lw.png"/></div></div></figure><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="d971" class="la lb hi kw b fi lc ld l le lf">CALL apoc.periodic.iterate(<br/>"UNWIND range(0,999) AS item<br/>WITH 'file:///Users/Priya_Jacob/Documents/neo4j43/neo4j-enterprise-4.3.0/import/louvre_collection_json/'+ apoc.text.lpad(toString(item),3,'0') AS f<br/>RETURN f",<br/>"CALL apoc.cypher.run('CALL apoc.load.directory(\"*.json\", $file, {recursive:false}) YIELD value AS url WITH \"file://\" + replace(url,\"\\\\\\\\\",\"/\") AS url CALL apoc.load.json(url) YIELD value RETURN value AS row',{file:f}) YIELD value  <br/>WITH value.row AS row<br/>MATCH (e:Exhibit {arkID:trim(row.arkId)})<br/>WITH e, row AS row WHERE NOT row.creator = []<br/>WITH e, row.creator AS l, range(0,size(row.creator)-1) AS nl<br/>UNWIND nl AS n<br/>WITH e, <br/>COLLECT(CASE WHEN NOT l[n].label = '' THEN  l[n].label ELSE '' END) AS labels, <br/>COLLECT(CASE WHEN NOT l[n].wikidata = '' THEN l[n].wikidata ELSE '' END) AS wikidata, <br/>COLLECT(CASE WHEN NOT l[n].linkType = '' THEN l[n].linkType ELSE '' END) AS linkTypes, <br/>COLLECT(CASE WHEN NOT l[n].attributionLevel = '' THEN l[n].attributionLevel ELSE '' END) AS attributionLevels,</span><span id="2b92" class="la lb hi kw b fi lg ld l le lf">COLLECT(CASE WHEN size([y IN [x IN CASE WHEN NOT l[n].dates = [] THEN range(0,size(l[n].dates)-1) ELSE [] END | CASE WHEN l[n].dates[x].type = 'date de naissance' THEN l[n].dates[x].date END] WHERE y IS NOT NULL|y])=0 THEN '' ELSE [y IN [x IN CASE WHEN NOT l[n].dates = [] THEN range(0,size(l[n].dates)-1) ELSE [] END | CASE WHEN l[n].dates[x].type = 'date de naissance' THEN l[n].dates[x].date END] WHERE y IS NOT NULL|y][0] END) AS dob,</span><span id="21a6" class="la lb hi kw b fi lg ld l le lf">COLLECT(CASE WHEN size([y IN [x IN CASE WHEN NOT l[n].dates = [] THEN range(0,size(l[n].dates)-1) ELSE [] END | CASE WHEN l[n].dates[x].type = 'date de naissance' THEN l[n].dates[x].place END] WHERE y IS NOT NULL|y])=0 THEN '' ELSE [y IN [x IN CASE WHEN NOT l[n].dates = [] THEN range(0,size(l[n].dates)-1) ELSE [] END | CASE WHEN l[n].dates[x].type = 'date de naissance' THEN l[n].dates[x].place END] WHERE y IS NOT NULL|y][0] END) AS pob,</span><span id="5b46" class="la lb hi kw b fi lg ld l le lf">COLLECT(CASE WHEN size([y IN [x IN CASE WHEN NOT l[n].dates = [] THEN range(0,size(l[n].dates)-1) ELSE [] END | CASE WHEN l[n].dates[x].type = 'date de mort' THEN l[n].dates[x].date END] WHERE y IS NOT NULL|y])=0 THEN '' ELSE [y IN [x IN CASE WHEN NOT l[n].dates = [] THEN range(0,size(l[n].dates)-1) ELSE [] END | CASE WHEN l[n].dates[x].type = 'date de mort' THEN l[n].dates[x].date END] WHERE y IS NOT NULL|y][0] END) AS dod,</span><span id="03bb" class="la lb hi kw b fi lg ld l le lf">COLLECT(CASE WHEN size([y IN [x IN CASE WHEN NOT l[n].dates = [] THEN range(0,size(l[n].dates)-1) ELSE [] END | CASE WHEN l[n].dates[x].type = 'date de mort' THEN l[n].dates[x].place END] WHERE y IS NOT NULL|y])=0 THEN '' ELSE [y IN [x IN CASE WHEN NOT l[n].dates = [] THEN range(0,size(l[n].dates)-1) ELSE [] END | CASE WHEN l[n].dates[x].type = 'date de mort' THEN l[n].dates[x].place END] WHERE y IS NOT NULL|y][0] END) AS pod</span><span id="c519" class="la lb hi kw b fi lg ld l le lf">SET e.creatorLabel = labels, <br/>e.creatorWikiData = wikidata, <br/>e.creatorLinkType = linkTypes, <br/>e.creatorAttributionLevel = attributionLevels,<br/>e.creatorDOB = dob,<br/>e.creatorPOB = pob,<br/>e.creatorDOD = dod,<br/>e.creatorPOD = pod<br/>",<br/>{batchSize:1, parallel:true}<br/>)</span></pre><p id="6d19" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，事实证明，我没有法语通信，因此很难理解大多数不明显的文学作品的意思，没有有效的方法将手头的文集翻译成英语，我选择的语言。因此，我求助于维基数据来寻找更多的信息，这将解决我的部分问题。现在，我以前从未使用过<a class="ae iu" href="https://www.w3.org/RDF/" rel="noopener ugc nofollow" target="_blank"> RDFs </a>，因此我发现自己很想使用SPARQL进行查询。在这篇文章的最后，我会提供一些帮助我顺利通过的参考资料。你要注意的是，维基数据并没有在卢浮宫的每一个展览中都提到<em class="kf">，所以我不得不将就一下关于10K的，这还不算太糟，考虑到这些应该会在大众投票或熟悉度中排名，因为它们首先被人类或机器记录下来。</em></p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="92e8" class="la lb hi kw b fi lc ld l le lf">SELECT (COUNT(DISTINCT ?ark) AS ?cnt)<br/>WHERE {<br/>    ?item wdt:P9394 ?ark .<br/>}</span></pre><p id="fdcd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我开始编写这个查询，但是不知道SPARQL包中的所有技巧，我不得不分解它以防止超时。因此，本质上，我试图阅读展品的附加信息(用英语)，如标签、描述、别名、流派、材料、描述、运动和主题以及URI维基百科(你知道，为了后代)。</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="7c9f" class="la lb hi kw b fi lc ld l le lf">SELECT ?ark <br/>(GROUP_CONCAT(DISTINCT(?item); separator = ";") AS ?uri)<br/>(GROUP_CONCAT(DISTINCT(?itemLabel); separator = ";") AS ?label)<br/>(GROUP_CONCAT(DISTINCT(?itemDescription); separator = ";") AS ?description)<br/>(GROUP_CONCAT(DISTINCT(?itemGenreLabel); separator = ";") AS ?genre)<br/>(GROUP_CONCAT(DISTINCT(?itemMaterialLabel); separator = ";") AS ?material)<br/>(GROUP_CONCAT(DISTINCT(?itemDepictLabel); separator = ";") AS ?depiction)<br/>(GROUP_CONCAT(DISTINCT(?itemSubjectLabel); separator = ";") AS ?subject)<br/>(GROUP_CONCAT(DISTINCT(?itemMovementLabel); separator = ";") AS ?movement)<br/>(GROUP_CONCAT(DISTINCT(?itemAltLabel); separator = ";") AS ?alias)<br/>WHERE {<br/>    ?item wdt:P9394 ?ark .<br/>    OPTIONAL {<br/>      ?item rdfs:label ?itemLabel .<br/>      FILTER (lang(?itemLabel) = 'en') .<br/>    }<br/>    OPTIONAL {<br/>      ?item schema:description ?itemDescription .<br/>      FILTER (lang(?itemDescription) = 'en') .    <br/>    }<br/>    OPTIONAL {<br/>      ?item wdt:P135 ?itemMovement .<br/>      ?itemMovement rdfs:label ?itemMovementLabel .<br/>      FILTER (lang(?itemMovementLabel) = 'en') .<br/>      }<br/>    OPTIONAL {<br/>      ?item wdt:P921 ?itemSubject .<br/>      ?itemSubject rdfs:label ?itemSubjectLabel .<br/>      FILTER (lang(?itemSubjectLabel) = 'en') .<br/>      }<br/>    OPTIONAL {<br/>      ?item wdt:P180 ?itemDepict .<br/>      ?itemDepict rdfs:label ?itemDepictLabel .<br/>      FILTER (lang(?itemDepictLabel) = 'en') .<br/>      }<br/>    OPTIONAL {<br/>      ?item wdt:P186 ?itemMaterial .<br/>      ?itemMaterial rdfs:label ?itemMaterialLabel .<br/>      FILTER (lang(?itemMaterialLabel) = 'en') .<br/>      }<br/>    OPTIONAL {<br/>      ?item wdt:P136 ?itemGenre .<br/>      ?itemGenre rdfs:label ?itemGenreLabel .<br/>      FILTER (lang(?itemGenreLabel) = 'en') .<br/>      }<br/>    OPTIONAL {<br/>      ?item skos:altLabel ?itemAltLabel .<br/>      FILTER (lang(?itemAltLabel) = 'en') .<br/>     }<br/>}<br/>GROUP BY ?ark</span></pre><p id="12bf" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">样本输出(确实运行了)；</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lj"><img src="../Images/21440f07ac9934547478a4faa7b8539a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-Mwh4E4MejXMqHwJyxlShQ.png"/></div></div></figure><p id="b38f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">上面的查询显然是低效的，因为我必须在短时间内进行查询才能更新“Exhibit”节点。</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="e1ed" class="la lb hi kw b fi lc ld l le lf">//update wikiURI<br/>CALL apoc.periodic.iterate(<br/>'WITH<br/>"SELECT ?ark <br/>(GROUP_CONCAT(DISTINCT(?item); separator = \';\') AS ?uri)<br/>WHERE {<br/>    ?item wdt:P9394 ?ark .<br/>}<br/>GROUP BY ?ark" AS query<br/>CALL apoc.load.jsonParams("<a class="ae iu" href="http://query.wikidata.org/sparql?format=json&amp;query=" rel="noopener ugc nofollow" target="_blank">http://query.wikidata.org/sparql?format=json&amp;query=</a>" + apoc.text.urlencode(query), {}, null) <br/>YIELD value <br/>RETURN value',<br/>'WITH value.results.bindings AS arks<br/>UNWIND arks AS ark<br/>WITH \'cl\'+ark.ark.value AS ark, ark.uri.value AS uri<br/>MATCH (e:Exhibit {arkID:ark})<br/>SET e.wikiURI = uri',<br/>{batchSize:100, parallel:true}<br/>)</span><span id="7a33" class="la lb hi kw b fi lg ld l le lf">//update wikiLabel<br/>CALL apoc.periodic.iterate(<br/>'WITH<br/>"SELECT ?ark <br/>(GROUP_CONCAT(DISTINCT(?itemLabel); separator = \';\') AS ?label)<br/>WHERE {<br/>    ?item wdt:P9394 ?ark .<br/>    ?item rdfs:label ?itemLabel .<br/>    FILTER (lang(?itemLabel) = \'en\') .<br/>    }<br/>GROUP BY ?ark" AS query<br/>CALL apoc.load.jsonParams("<a class="ae iu" href="http://query.wikidata.org/sparql?format=json&amp;query=" rel="noopener ugc nofollow" target="_blank">http://query.wikidata.org/sparql?format=json&amp;query=</a>" + apoc.text.urlencode(query), {}, null) <br/>YIELD value <br/>RETURN value',<br/>'WITH value.results.bindings AS arks<br/>UNWIND arks AS ark<br/>WITH \'cl\'+ark.ark.value AS ark, ark.label.value AS label<br/>MATCH (e:Exhibit {arkID:ark})<br/>SET e.wikiLabel = label',<br/>{batchSize:100, parallel:true}<br/>)</span><span id="a105" class="la lb hi kw b fi lg ld l le lf">//update wikiDescription<br/>CALL apoc.periodic.iterate(<br/>'WITH<br/>"SELECT ?ark <br/>(GROUP_CONCAT(DISTINCT(?itemDescription); separator = \';\') AS ?description)<br/>WHERE {<br/>    ?item wdt:P9394 ?ark .<br/>    ?item schema:description ?itemDescription .<br/>    FILTER (lang(?itemDescription) = \'en\') .    <br/>}<br/>GROUP BY ?ark" AS query<br/>CALL apoc.load.jsonParams("<a class="ae iu" href="http://query.wikidata.org/sparql?format=json&amp;query=" rel="noopener ugc nofollow" target="_blank">http://query.wikidata.org/sparql?format=json&amp;query=</a>" + apoc.text.urlencode(query), {}, null) <br/>YIELD value <br/>RETURN value',<br/>'WITH value.results.bindings AS arks<br/>UNWIND arks AS ark<br/>WITH \'cl\'+ark.ark.value AS ark, ark.description.value AS description<br/>MATCH (e:Exhibit {arkID:ark})<br/>SET e.wikiDescription = description',<br/>{batchSize:100, parallel:true}<br/>)</span><span id="ed29" class="la lb hi kw b fi lg ld l le lf">//update wikiGenre<br/>CALL apoc.periodic.iterate(<br/>'WITH<br/>"SELECT ?ark <br/>(GROUP_CONCAT(DISTINCT(?itemGenreLabel); separator = \';\') AS ?genre)<br/>WHERE {<br/>    ?item wdt:P9394 ?ark .<br/>    ?item wdt:P136 ?itemGenre .<br/>    ?itemGenre rdfs:label ?itemGenreLabel .<br/>    FILTER (lang(?itemGenreLabel) = \'en\') .<br/>}<br/>GROUP BY ?ark" AS query<br/>CALL apoc.load.jsonParams("<a class="ae iu" href="http://query.wikidata.org/sparql?format=json&amp;query=" rel="noopener ugc nofollow" target="_blank">http://query.wikidata.org/sparql?format=json&amp;query=</a>" + apoc.text.urlencode(query), {}, null) <br/>YIELD value <br/>RETURN value',<br/>'WITH value.results.bindings AS arks<br/>UNWIND arks AS ark<br/>WITH \'cl\'+ark.ark.value AS ark, ark.genre.value AS genre<br/>MATCH (e:Exhibit {arkID:ark})<br/>SET e.wikiGenre = genre',<br/>{batchSize:100, parallel:true}<br/>)</span><span id="3aaf" class="la lb hi kw b fi lg ld l le lf">//update wikiMaterial<br/>CALL apoc.periodic.iterate(<br/>'WITH<br/>"SELECT ?ark <br/>(GROUP_CONCAT(DISTINCT(?itemMaterialLabel); separator = \';\') AS ?material)<br/>WHERE {<br/>    ?item wdt:P9394 ?ark .<br/>    ?item wdt:P186 ?itemMaterial .<br/>    ?itemMaterial rdfs:label ?itemMaterialLabel .<br/>    FILTER (lang(?itemMaterialLabel) = \'fr\') .<br/>    }<br/>GROUP BY ?ark" AS query<br/>CALL apoc.load.jsonParams("<a class="ae iu" href="http://query.wikidata.org/sparql?format=json&amp;query=" rel="noopener ugc nofollow" target="_blank">http://query.wikidata.org/sparql?format=json&amp;query=</a>" + apoc.text.urlencode(query), {}, null) <br/>YIELD value <br/>RETURN value',<br/>'WITH value.results.bindings AS arks<br/>UNWIND arks AS ark<br/>WITH \'cl\'+ark.ark.value AS ark, ark.material.value AS material<br/>MATCH (e:Exhibit {arkID:ark})<br/>SET e.wikiMaterial = material',<br/>{batchSize:100, parallel:true}<br/>)</span><span id="86bd" class="la lb hi kw b fi lg ld l le lf">//update wikiDepiction<br/>CALL apoc.periodic.iterate(<br/>'WITH<br/>"SELECT ?ark <br/>(GROUP_CONCAT(DISTINCT(?itemDepictLabel); separator = \';\') AS ?depiction)<br/>WHERE {<br/>    ?item wdt:P9394 ?ark .<br/>    ?item wdt:P180 ?itemDepict .<br/>    ?itemDepict rdfs:label ?itemDepictLabel .<br/>    FILTER (lang(?itemDepictLabel) = \'en\') .<br/>    }<br/>GROUP BY ?ark" AS query<br/>CALL apoc.load.jsonParams("<a class="ae iu" href="http://query.wikidata.org/sparql?format=json&amp;query=" rel="noopener ugc nofollow" target="_blank">http://query.wikidata.org/sparql?format=json&amp;query=</a>" + apoc.text.urlencode(query), {}, null) <br/>YIELD value <br/>RETURN value',<br/>'WITH value.results.bindings AS arks<br/>UNWIND arks AS ark<br/>WITH \'cl\'+ark.ark.value AS ark, ark.depiction.value AS depiction<br/>MATCH (e:Exhibit {arkID:ark})<br/>SET e.wikiDepiction = depiction',<br/>{batchSize:100, parallel:true}<br/>)</span><span id="5f61" class="la lb hi kw b fi lg ld l le lf">//update wikiSubject<br/>CALL apoc.periodic.iterate(<br/>'WITH<br/>"SELECT ?ark <br/>(GROUP_CONCAT(DISTINCT(?itemSubjectLabel); separator = \';\') AS ?subject)<br/>WHERE {<br/>    ?item wdt:P9394 ?ark .<br/>    ?item wdt:P921 ?itemSubject .<br/>    ?itemSubject rdfs:label ?itemSubjectLabel .<br/>    FILTER (lang(?itemSubjectLabel) = \'en\') .<br/>}<br/>GROUP BY ?ark" AS query<br/>CALL apoc.load.jsonParams("<a class="ae iu" href="http://query.wikidata.org/sparql?format=json&amp;query=" rel="noopener ugc nofollow" target="_blank">http://query.wikidata.org/sparql?format=json&amp;query=</a>" + apoc.text.urlencode(query), {}, null) <br/>YIELD value <br/>RETURN value',<br/>'WITH value.results.bindings AS arks<br/>UNWIND arks AS ark<br/>WITH \'cl\'+ark.ark.value AS ark, ark.subject.value AS subject<br/>MATCH (e:Exhibit {arkID:ark})<br/>SET e.wikiSubject = subject',<br/>{batchSize:100, parallel:true}<br/>)</span><span id="6a11" class="la lb hi kw b fi lg ld l le lf">//update wikiMovement<br/>CALL apoc.periodic.iterate(<br/>'WITH<br/>"SELECT ?ark <br/>(GROUP_CONCAT(DISTINCT(?itemMovementLabel); separator = \';\') AS ?movement)<br/>WHERE {<br/>    ?item wdt:P9394 ?ark .<br/>    ?item wdt:P135 ?itemMovement .<br/>    ?itemMovement rdfs:label ?itemMovementLabel .<br/>    FILTER (lang(?itemMovementLabel) = \'en\') .<br/>}<br/>GROUP BY ?ark" AS query<br/>CALL apoc.load.jsonParams("<a class="ae iu" href="http://query.wikidata.org/sparql?format=json&amp;query=" rel="noopener ugc nofollow" target="_blank">http://query.wikidata.org/sparql?format=json&amp;query=</a>" + apoc.text.urlencode(query), {}, null) <br/>YIELD value <br/>RETURN value',<br/>'WITH value.results.bindings AS arks<br/>UNWIND arks AS ark<br/>WITH \'cl\'+ark.ark.value AS ark, ark.movement.value AS movement<br/>MATCH (e:Exhibit {arkID:ark})<br/>SET e.wikiMovement = movement',<br/>{batchSize:100, parallel:true}<br/>)</span><span id="912f" class="la lb hi kw b fi lg ld l le lf">//update wikiAlias<br/>CALL apoc.periodic.iterate(<br/>'WITH<br/>"SELECT ?ark <br/>(GROUP_CONCAT(DISTINCT(?itemAltLabel); separator = \';\') AS ?alias)<br/>WHERE {<br/>    ?item wdt:P9394 ?ark .<br/>    ?item skos:altLabel ?itemAltLabel .<br/>    FILTER (lang(?itemAltLabel) = \'en\') .<br/>}<br/>GROUP BY ?ark" AS query<br/>CALL apoc.load.jsonParams("<a class="ae iu" href="http://query.wikidata.org/sparql?format=json&amp;query=" rel="noopener ugc nofollow" target="_blank">http://query.wikidata.org/sparql?format=json&amp;query=</a>" + apoc.text.urlencode(query), {}, null) <br/>YIELD value <br/>RETURN value',<br/>'WITH value.results.bindings AS arks<br/>UNWIND arks AS ark<br/>WITH \'cl\'+ark.ark.value AS ark, ark.alias.value AS alias<br/>MATCH (e:Exhibit {arkID:ark})<br/>SET e.wikiAlias = alias',<br/>{batchSize:100, parallel:true}<br/>)</span></pre><p id="8233" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在“展示”节点上引入所有需要的属性后，在此阶段进行快速属性数据分析。</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="3bfb" class="la lb hi kw b fi lc ld l le lf">MATCH (n:Exhibit)<br/>WITH n, KEYS(n) AS l<br/>UNWIND l AS i<br/>RETURN i, COUNT(n) AS cnt<br/>ORDER BY cnt DESC</span></pre><p id="ffcf" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">接下来，我们准备通过扩大我们的标签足迹来进一步拓展业务。我们首先定义我们的模式，以确保没有节点重复，然后创建额外的节点和关系。</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="2c8a" class="la lb hi kw b fi lc ld l le lf">CREATE CONSTRAINT collection ON (c:Collection) ASSERT c.collection IS UNIQUE;<br/>CREATE CONSTRAINT category ON (c:Category) ASSERT c.category IS UNIQUE;<br/>CREATE CONSTRAINT objectType ON (o:ObjectType) ASSERT o.objectType IS UNIQUE;<br/>CREATE CONSTRAINT shape ON (s:Shape) ASSERT s.shape IS UNIQUE;<br/>CREATE CONSTRAINT provenance ON (p:Provenance) ASSERT p.provenance IS UNIQUE;<br/>CREATE CONSTRAINT technique ON (t:Technique) ASSERT t.technique IS UNIQUE;<br/>CREATE CONSTRAINT material ON (m:Material) ASSERT m.material IS UNIQUE;<br/>CREATE CONSTRAINT feature ON (f:Feature) ASSERT f.feature IS UNIQUE;<br/>CREATE CONSTRAINT inscriptionType ON (i:InscriptionType) ASSERT i.inscriptionType IS UNIQUE;<br/>CREATE CONSTRAINT place ON (p:Place) ASSERT p.place IS UNIQUE;<br/>CREATE CONSTRAINT period ON (p:Period) ASSERT p.period IS UNIQUE;<br/>CREATE CONSTRAINT room ON (r:Room) ASSERT r.room IS UNIQUE;<br/>CREATE CONSTRAINT genre ON (g:Genre) ASSERT g.genre IS UNIQUE;<br/>CREATE CONSTRAINT element ON (d:Depiction) ASSERT d.element IS UNIQUE;<br/>CREATE CONSTRAINT subject ON (s:Subject) ASSERT s.subject IS UNIQUE;<br/>CREATE CONSTRAINT movement ON (m:Movement) ASSERT m.movement IS UNIQUE;</span><span id="3fc9" class="la lb hi kw b fi lg ld l le lf">CALL apoc.periodic.iterate(<br/>"MATCH (e:Exhibit)<br/>RETURN e",<br/>"WITH e</span><span id="08ef" class="la lb hi kw b fi lg ld l le lf">FOREACH ( x IN CASE WHEN e.collection IS NOT NULL THEN [1] ELSE [] END | MERGE (cn:Collection {collection:toUpper(trim(e.collection))}) MERGE (e)-[:COLLECTION]-&gt;(cn) )</span><span id="ec0e" class="la lb hi kw b fi lg ld l le lf">FOREACH ( x IN CASE WHEN e.category IS NOT NULL THEN [1] ELSE [] END | FOREACH ( y IN e.category | MERGE (cy:Category {category:toUpper(trim(y))}) MERGE (e)-[:CATEGORY]-&gt;(cy) ) )</span><span id="39ac" class="la lb hi kw b fi lg ld l le lf">FOREACH ( x IN CASE WHEN e.relatedWork IS NOT NULL THEN [1] ELSE [] END | FOREACH ( y IN e.relatedWork | MERGE (oth:Exhibit {arkID:trim(y)}) MERGE (e)-[:ASSOCIATION]-&gt;(oth) ) )</span><span id="d9e4" class="la lb hi kw b fi lg ld l le lf">FOREACH ( x IN CASE WHEN e.objectType IS NOT NULL THEN [1] ELSE [] END | FOREACH ( y IN SPLIT(e.objectType,';') | MERGE (oe:ObjectType {objectType:toUpper(trim(y))}) MERGE (e)-[:OBJECT_TYPE]-&gt;(oe) ) )</span><span id="2e93" class="la lb hi kw b fi lg ld l le lf">FOREACH ( x IN CASE WHEN e.shape IS NOT NULL THEN [1] ELSE [] END | MERGE (se:Shape {shape:toUpper(trim(e.shape))}) MERGE (e)-[:SHAPE]-&gt;(se) )</span><span id="9e34" class="la lb hi kw b fi lg ld l le lf">FOREACH ( x IN CASE WHEN e.provenance IS NOT NULL THEN [1] ELSE [] END | FOREACH ( y IN SPLIT(e.provenance,';') | MERGE (pe:Provenance {provenance:toUpper(trim(y))}) MERGE (e)-[:PROVENANCE]-&gt;(pe) ) )</span><span id="b270" class="la lb hi kw b fi lg ld l le lf">FOREACH ( x IN CASE WHEN e.technic IS NOT NULL THEN [1] ELSE [] END | FOREACH ( y IN e.technic | MERGE (te:Technique {technique:toUpper(trim(y))}) MERGE (e)-[:TECHNIQUE]-&gt;(te) ) )</span><span id="398d" class="la lb hi kw b fi lg ld l le lf">FOREACH ( x IN CASE WHEN e.material IS NOT NULL THEN [1] ELSE [] END | FOREACH ( y IN e.material | MERGE (ml:Material {material:toUpper(trim(y))}) MERGE (e)-[:MATERIAL]-&gt;(ml) ) )</span><span id="7454" class="la lb hi kw b fi lg ld l le lf">FOREACH ( x IN CASE WHEN e.feature IS NOT NULL THEN [1] ELSE [] END | FOREACH ( y IN e.feature | MERGE (fe:Feature {feature:toUpper(trim(y))}) MERGE (e)-[:FEATURE]-&gt;(fe) ) )</span><span id="872b" class="la lb hi kw b fi lg ld l le lf">FOREACH ( x IN CASE WHEN e.inscriptionType IS NOT NULL THEN [1] ELSE [] END | FOREACH ( y IN e.inscriptionType | MERGE (ie:InscriptionType {inscriptionType:toUpper(trim(y))}) MERGE (e)-[:INSCRIPTION_TYPE]-&gt;(ie) ) )</span><span id="6cfc" class="la lb hi kw b fi lg ld l le lf">FOREACH ( x IN CASE WHEN e.place IS NOT NULL THEN [1] ELSE [] END | FOREACH ( y IN e.place | MERGE (pe:Place {place:toUpper(trim(y))}) MERGE (e)-[:PLACE]-&gt;(pe) ) )</span><span id="22e2" class="la lb hi kw b fi lg ld l le lf">FOREACH ( x IN CASE WHEN e.period IS NOT NULL THEN [1] ELSE [] END | FOREACH ( y IN e.period | MERGE (pd:Period {period:toUpper(trim(y))}) MERGE (e)-[:PERIOD]-&gt;(pd) ) )</span><span id="1797" class="la lb hi kw b fi lg ld l le lf">FOREACH ( x IN CASE WHEN e.room IS NOT NULL THEN [1] ELSE [] END | MERGE (rm:Room {room:toUpper(trim(e.room))}) MERGE (e)-[:ROOM]-&gt;(rm) )</span><span id="59f5" class="la lb hi kw b fi lg ld l le lf">FOREACH ( x IN CASE WHEN e.wikiGenre IS NOT NULL THEN [1] ELSE [] END | FOREACH ( y IN SPLIT(e.wikiGenre,';') | MERGE (ge:Genre {genre:toUpper(trim(y))}) MERGE (e)-[:GENRE]-&gt;(ge) ) )</span><span id="b9f3" class="la lb hi kw b fi lg ld l le lf">FOREACH ( x IN CASE WHEN e.wikiMaterial IS NOT NULL THEN [1] ELSE [] END | FOREACH ( y IN SPLIT(e.wikiMaterial,';') | MERGE (wml:Material {material:toUpper(trim(y))}) MERGE (e)-[:MATERIAL]-&gt;(wml) ) )</span><span id="3027" class="la lb hi kw b fi lg ld l le lf">FOREACH ( x IN CASE WHEN e.wikiDepiction IS NOT NULL THEN [1] ELSE [] END | FOREACH ( y IN SPLIT(e.wikiDepiction,';') | MERGE (dn:Depiction {element:toUpper(trim(y))}) MERGE (e)-[:DEPICTION]-&gt;(dn) ) )</span><span id="21ae" class="la lb hi kw b fi lg ld l le lf">FOREACH ( x IN CASE WHEN e.wikiSubject IS NOT NULL THEN [1] ELSE [] END | FOREACH ( y IN SPLIT(e.wikiSubject,';') | MERGE (st:Subject {subject:toUpper(trim(y))}) MERGE (e)-[:SUBJECT]-&gt;(st) ) )</span><span id="f8dc" class="la lb hi kw b fi lg ld l le lf">FOREACH ( x IN CASE WHEN e.wikiMovement IS NOT NULL THEN [1] ELSE [] END | FOREACH ( y IN SPLIT(e.wikiMovement,';') | MERGE (mt:Movement {movement:toUpper(trim(y))}) MERGE (e)-[:MOVEMENT]-&gt;(mt) ) )<br/>",<br/>{batchSize:1000, parallel:false}<br/>)</span></pre><p id="693b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">大多数展品都附有“当前位置”,知道并记录了位置。现在，这个“地点”很可能在卢浮宫境内，也可能在国外，在国内。对于在卢浮宫内<em class="kf">的一个“房间”中的每个展品，或者在卢浮宫</em>中发现“当前位置”的地方，我们用“卢浮宫”来标记它，对于其他所有东西，我们保留它原来的“当前位置”标记。</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="4811" class="la lb hi kw b fi lc ld l le lf">//link location<br/>CREATE CONSTRAINT location ON (l:Location) ASSERT l.location IS UNIQUE;</span><span id="365a" class="la lb hi kw b fi lg ld l le lf">CREATE INDEX exhibitRoom FOR (e:Exhibit) ON (e.room);<br/>CREATE INDEX exhibitCurrentLocation FOR (e:Exhibit) ON (e.currentLocation);</span><span id="1029" class="la lb hi kw b fi lg ld l le lf">-- set the current location to Musée du Louvre where room present <br/>MATCH (e:Exhibit)<br/>WHERE e.room IS NOT NULL<br/>MERGE (l:Location {location:toUpper('Musée du Louvre')})<br/>MERGE (e)-[:LOCATION]-&gt;(l)</span><span id="43a2" class="la lb hi kw b fi lg ld l le lf">-- set the current location to Musée du Louvre where room NULL and current location contains Musée du Louvre<br/>MATCH (e:Exhibit)<br/>WHERE e.room IS NULL AND e.currentLocation CONTAINS 'Musée du Louvre'<br/>MERGE (l:Location {location:toUpper('Musée du Louvre')})<br/>MERGE (e)-[:LOCATION]-&gt;(l)</span><span id="8f36" class="la lb hi kw b fi lg ld l le lf">-- set current location to current location for everything else<br/>CALL apoc.periodic.iterate(<br/>"MATCH (e:Exhibit)<br/>WHERE e.room IS NULL AND e.currentLocation IS NOT NULL AND NOT e.currentLocation CONTAINS 'Musée du Louvre'<br/>RETURN e",<br/>"MERGE (l:Location {location:toUpper(trim(e.currentLocation))})<br/>MERGE (e)-[:LOCATION]-&gt;(l)",<br/>{batchSize:1000, parallel:false})</span><span id="12de" class="la lb hi kw b fi lg ld l le lf">-- current location not known<br/>MATCH (n:Exhibit)<br/>WHERE size((n)-[:LOCATION]-&gt;()) = 0<br/>RETURN COLLECT(DISTINCT n.currentLocation), COLLECT(DISTINCT n.heldBy), COLLECT(DISTINCT n.longTermLoanTo)</span></pre><p id="b849" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">接下来，我们确定每个展品的“持有”和“租赁”权限，这意味着虽然一件展品可能被卢浮宫收藏，但它很可能被长期租赁给另一家机构。这些收藏品也反映了其他机构租给卢浮宫的展品。</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="a01d" class="la lb hi kw b fi lc ld l le lf">//link holding and leasing authority <br/>CREATE CONSTRAINT authority ON (a:Authority) ASSERT a.authority IS UNIQUE;</span><span id="54e0" class="la lb hi kw b fi lg ld l le lf">CREATE INDEX exhibitHeldBy FOR (e:Exhibit) ON (e.heldBy);<br/>CREATE INDEX exhibitLongTermLoanTo FOR (e:Exhibit) ON (e.longTermLoanTo);</span><span id="b0df" class="la lb hi kw b fi lg ld l le lf">-- set the authority to Musée du Louvre where longTermLoanTo/heldBy contains Musée du Louvre <br/>CALL apoc.periodic.iterate(<br/>"MATCH (e:Exhibit) <br/>WHERE e.heldBy CONTAINS 'Musée du Louvre'<br/>RETURN e",<br/>"MERGE (a:Authority {authority:toUpper('Musée du Louvre')})<br/>MERGE (e)-[:HOLDING]-&gt;(a)",<br/>{batchSize:1000, parallel:false})</span><span id="8c74" class="la lb hi kw b fi lg ld l le lf">CALL apoc.periodic.iterate(<br/>"MATCH (e:Exhibit)<br/>WHERE e.longTermLoanTo CONTAINS 'Musée du Louvre'<br/>RETURN e",<br/>"MERGE (a:Authority {authority:toUpper('Musée du Louvre')})<br/>MERGE (e)-[:LEASE]-&gt;(a)",<br/>{batchSize:1000, parallel:false})</span><span id="5b31" class="la lb hi kw b fi lg ld l le lf">-- set the authority to longTermLoanTo/heldBy where longTermLoanTo/heldBy does not contain Musée du Louvre<br/>CALL apoc.periodic.iterate(<br/>"MATCH (e:Exhibit)<br/>WHERE NOT e.heldBy CONTAINS 'Musée du Louvre'<br/>RETURN e",<br/>"MERGE (a:Authority {authority:toUpper(trim(e.heldBy))})<br/>MERGE (e)-[:HOLDING]-&gt;(a)",<br/>{batchSize:1000, parallel:false})</span><span id="b9e7" class="la lb hi kw b fi lg ld l le lf">CALL apoc.periodic.iterate(<br/>"MATCH (e:Exhibit)<br/>WHERE NOT e.longTermLoanTo CONTAINS 'Musée du Louvre'<br/>RETURN e",<br/>"MERGE (a:Authority {authority:toUpper(trim(e.longTermLoanTo))})<br/>MERGE (e)-[:LEASE]-&gt;(a)",<br/>{batchSize:1000, parallel:false})</span></pre><p id="e4da" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最后，我们把创作者和他们的艺术作品联系起来！这在很大程度上是最具挑战性的部分，因为没有像样的方法来识别人和地方，两者都是可互换的<strong class="ix hj">关联</strong>(学校/工作室/圈子、随从/模仿/流派/时期/认同/归因于等)。)和<strong class="ix hj">归因</strong>(当前/原始/古代/库存/其他等。)到他们的作品中，在json结构中。</p><p id="c89e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">几幅插图；</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="1f59" class="la lb hi kw b fi lc ld l le lf">[<br/>{<br/>  "creatorRole": "",<br/>  "attributedYear": "",<br/>  "attributedBy": "",<br/>  "doubt": "",<br/>  "linkType": "École de",<br/>  "label": "Italie",<br/>  "authenticationType": "",<br/>  "attributionLevel": "Attribution actuelle",<br/>  "wikidata": ""<br/>}<br/>,<br/>{<br/>  "creatorRole": "",<br/>  "attributedYear": "",<br/>  "attributedBy": "",<br/>  "doubt": "",<br/>  "linkType": "Attribué à",<br/>  "dates": [<br/>    {<br/>      "date": "1698",<br/>      "place": "Florence",<br/>      "type": "date de mort"<br/>    },<br/>    {<br/>      "date": "1611",<br/>      "place": "Florence",<br/>      "type": "date de naissance"<br/>    }<br/>  ],<br/>  "label": "Pignoni, Simone",<br/>  "authenticationType": "",<br/>  "attributionLevel": "Attribution actuelle",<br/>  "wikidata": "Q963528"<br/>}<br/>,<br/>{<br/>  "creatorRole": "",<br/>  "attributedYear": "",<br/>  "attributedBy": "",<br/>  "doubt": "",<br/>  "linkType": "",<br/>  "dates": [<br/>    {<br/>      "date": "1657",<br/>      "place": "Gênes",<br/>      "type": "date de mort"<br/>    },<br/>    {<br/>      "date": "1632",<br/>      "place": "Gênes",<br/>      "type": "date de naissance"<br/>    }<br/>  ],<br/>  "label": "Biscaino, Bartolommeo",<br/>  "authenticationType": "",<br/>  "attributionLevel": "Ancienne Attribution",<br/>  "wikidata": "Q2886080"<br/>}<br/>]</span></pre><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lk"><img src="../Images/a43ff28743711887c8edd87dfc844dc2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IxKxNjIahKvmz8wWZPqrsQ.png"/></div></div></figure><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="0fdb" class="la lb hi kw b fi lc ld l le lf">[<br/>{<br/>  "creatorRole": "",<br/>  "attributedYear": "",<br/>  "attributedBy": "",<br/>  "doubt": "",<br/>  "linkType": "École de",<br/>  "dates": [<br/>    {<br/>      "date": "1516",<br/>      "place": "Venise",<br/>      "type": "date de mort"<br/>    },<br/>    {<br/>      "date": "vers 1430/1435",<br/>      "place": "Venise",<br/>      "type": "date de naissance"<br/>    }<br/>  ],<br/>  "label": "Bellini, Giovanni",<br/>  "authenticationType": "",<br/>  "attributionLevel": "Attribution actuelle",<br/>  "wikidata": "Q17169"<br/>}<br/>,<br/>{<br/>  "creatorRole": "",<br/>  "attributedYear": "",<br/>  "attributedBy": "",<br/>  "doubt": "",<br/>  "linkType": "École de",<br/>  "label": "Italie",<br/>  "authenticationType": "",<br/>  "attributionLevel": "Attribution actuelle",<br/>  "wikidata": ""<br/>}<br/>,<br/>{<br/>  "creatorRole": "",<br/>  "attributedYear": "",<br/>  "attributedBy": "",<br/>  "doubt": "",<br/>  "linkType": "",<br/>  "dates": [<br/>    {<br/>      "date": "1516",<br/>      "place": "Venise",<br/>      "type": "date de mort"<br/>    },<br/>    {<br/>      "date": "vers 1430/1435",<br/>      "place": "Venise",<br/>      "type": "date de naissance"<br/>    }<br/>  ],<br/>  "label": "Bellini, Giovanni",<br/>  "authenticationType": "",<br/>  "attributionLevel": "Inventorié Comme",<br/>  "wikidata": "Q17169"<br/>}<br/>,<br/>{<br/>  "creatorRole": "",<br/>  "attributedYear": "",<br/>  "attributedBy": "",<br/>  "doubt": "",<br/>  "linkType": "Attribué à",<br/>  "dates": [<br/>    {<br/>      "date": "1554",<br/>      "place": "Venise",<br/>      "type": "date de mort"<br/>    },<br/>    {<br/>      "date": "vers 1470",<br/>      "place": "Trévise",<br/>      "type": "date de naissance"<br/>    }<br/>  ],<br/>  "label": "Bissolo, Francesco",<br/>  "authenticationType": "",<br/>  "attributionLevel": "Ancienne Attribution",<br/>  "wikidata": "Q2566320"<br/>}<br/>]</span></pre><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ll"><img src="../Images/f5317a9018c586a3d25f4c5557677d25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lwypHBkswDoyQwAjC8Du-w.png"/></div></div></figure><p id="eeb0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">所以，跟着走。我们从简单的规则开始，逐步走向复杂。</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="4845" class="la lb hi kw b fi lc ld l le lf">//link creators<br/>CREATE CONSTRAINT artistName ON (a:Artist) ASSERT a.name IS UNIQUE;</span><span id="5196" class="la lb hi kw b fi lg ld l le lf">//map labels with a wiki entity reference<br/>CALL apoc.periodic.iterate(<br/>"MATCH (e:Exhibit) WHERE size([z IN e.creatorLabel WHERE NOT size(trim(z))=0]) &gt; 0 RETURN e",<br/>"WITH e FOREACH ( y IN [x IN range(0,size(e.creatorLabel)-1) WHERE NOT size(trim(e.creatorLabel[x])) = 0 AND NOT size(trim(e.creatorWikiData[x])) = 0|x] | MERGE (a:Artist {name:toUpper(trim(e.creatorLabel[y]))}) SET a.wikiID = trim(e.creatorWikiData[y]), a.dateOfBirth = CASE WHEN NOT trim(e.creatorDOB[y]) = '' THEN trim(e.creatorDOB[y]) ELSE a.dateOfBirth END, a.placeOfBirth = CASE WHEN NOT trim(e.creatorPOB[y]) = '' THEN trim(e.creatorPOB[y]) ELSE a.placeOfBirth END, a.dateOfDeath = CASE WHEN NOT trim(e.creatorDOD[y]) = '' THEN trim(e.creatorDOD[y]) ELSE a.dateOfDeath END, a.placeOfDeath = CASE WHEN NOT trim(e.creatorPOD[y]) = '' THEN trim(e.creatorPOD[y]) ELSE a.placeOfDeath END MERGE (e)-[:CREATOR]-&gt;(a) )",<br/>{batchSize:1000, parallel:false}<br/>)</span><span id="ab6d" class="la lb hi kw b fi lg ld l le lf">//map labels that are comma separated supposedly meant to signify names<br/>CALL apoc.periodic.iterate(<br/>"MATCH (e:Exhibit) WHERE size([z IN e.creatorLabel WHERE NOT size(trim(z))=0]) &gt; 0 RETURN e",<br/>"WITH e FOREACH ( y IN [x IN range(0,size(e.creatorLabel)-1) WHERE size(trim(e.creatorWikiData[x])) = 0 AND trim(e.creatorLabel[x]) CONTAINS ',' |x] | MERGE (a:Artist {name:toUpper(trim(e.creatorLabel[y]))}) SET a.dateOfBirth = CASE WHEN NOT trim(e.creatorDOB[y]) = '' THEN trim(e.creatorDOB[y]) ELSE a.dateOfBirth END, a.placeOfBirth = CASE WHEN NOT trim(e.creatorPOB[y]) = '' THEN trim(e.creatorPOB[y]) ELSE a.placeOfBirth END, a.dateOfDeath = CASE WHEN NOT trim(e.creatorDOD[y]) = '' THEN trim(e.creatorDOD[y]) ELSE a.dateOfDeath END, a.placeOfDeath = CASE WHEN NOT trim(e.creatorPOD[y]) = '' THEN trim(e.creatorPOD[y]) ELSE a.placeOfDeath END MERGE (e)-[:CREATOR]-&gt;(a) )",<br/>{batchSize:1000, parallel:false}<br/>)</span><span id="7e59" class="la lb hi kw b fi lg ld l le lf">//from the rest, map below titles &amp; generalizations to anonymous<br/>ANONYME<br/>maître/MAITRE<br/>peintre/painter<br/>potier</span><span id="fd0a" class="la lb hi kw b fi lg ld l le lf">CALL apoc.periodic.iterate(<br/>"MATCH (e:Exhibit) WHERE size([z IN e.creatorLabel WHERE NOT size(trim(z))=0]) &gt; 0 RETURN e",<br/>"WITH e FOREACH ( y IN [x IN range(0,size(e.creatorLabel)-1) WHERE size(trim(e.creatorWikiData[x])) = 0 AND (toUpper(trim(e.creatorLabel[x])) CONTAINS 'ANONYME' OR toLower(trim(e.creatorLabel[x])) CONTAINS 'maître' OR toUpper(trim(e.creatorLabel[x])) CONTAINS 'MAITRE' OR toLower(trim(e.creatorLabel[x])) CONTAINS 'peintre' OR toLower(trim(e.creatorLabel[x])) CONTAINS 'painter' OR toLower(trim(e.creatorLabel[x])) CONTAINS 'potier')|x] | MERGE (a:Artist {name:'ANONYME'}) MERGE (e)-[:CREATOR]-&gt;(a) )",<br/>{batchSize:1000, parallel:false}<br/>)</span></pre><p id="99ca" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，我们的任务仍然是从剩下的地图中识别来自不同地方的人。我们再一次求助于维基数据，用法语列出国家，然后我们可以用它从我们的数据中删除。不完全是清教徒式的执行实体识别的方式，但这种方式目前可以完成工作。</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="d3a0" class="la lb hi kw b fi lc ld l le lf">//retain class/family/series/group/manufacturer/atelier<br/>//eliminate countries (incl. "pay", French for country)</span><span id="5c17" class="la lb hi kw b fi lg ld l le lf">//create countries<br/>CREATE CONSTRAINT countryURI IF NOT EXISTS ON (c:Country) ASSERT (c.uri) IS UNIQUE;</span><span id="6615" class="la lb hi kw b fi lg ld l le lf">WITH <br/>"SELECT ?country ?countryENLabel ?countryFRLabel WHERE {<br/>    ?country wdt:P31 wd:Q6256 .<br/>    OPTIONAL {<br/>    ?country rdfs:label ?countryENLabel .<br/>    FILTER (lang(?countryENLabel) = 'en') .<br/>    }<br/>    OPTIONAL {<br/>    ?country rdfs:label ?countryFRLabel .<br/>    FILTER (lang(?countryFRLabel) = 'fr') .<br/>    }<br/>}<br/>ORDER BY ?countryENLabel" AS query<br/>CALL apoc.load.jsonParams("<a class="ae iu" href="http://query.wikidata.org/sparql?format=json&amp;query=" rel="noopener ugc nofollow" target="_blank">http://query.wikidata.org/sparql?format=json&amp;query=</a>" + apoc.text.urlencode(query), {}, null) <br/>YIELD value <br/>WITH value.results.bindings AS countries<br/>UNWIND countries AS country<br/>WITH country.country.value AS uri, country.countryENLabel.value AS countryEN, country.countryFRLabel.value AS countryFR<br/>MERGE (c:Country {uri:uri})<br/>SET c.countryEN = countryEN,<br/>c.countryFR = countryFR</span><span id="eff4" class="la lb hi kw b fi lg ld l le lf">//eliminate places from attributions<br/>CALL apoc.periodic.iterate(<br/>"<br/>MATCH (c:Country) WHERE c.countryFR IS NOT NULL<br/>WITH COLLECT(toUpper(trim(c.countryFR))) AS l   <br/>MATCH (e:Exhibit) WHERE size([z IN e.creatorLabel WHERE NOT size(trim(z))=0]) &gt; 0 AND size((e)-[:CREATOR]-&gt;()) = 0 <br/>RETURN l, e",<br/>"<br/>WITH l, e <br/>FOREACH ( y IN [x IN range(0,size(e.creatorLabel)-1) WHERE (NOT trim(e.creatorLabel[x]) = '') AND (NOT toUpper(trim(e.creatorLabel[x])) CONTAINS 'PAY') AND (size([i IN l WHERE toUpper(trim(e.creatorLabel[x])) CONTAINS i|i])=0)|x] | MERGE (a:Artist {name:toUpper(trim(e.creatorLabel[y]))}) SET a.dateOfBirth = CASE WHEN NOT trim(e.creatorDOB[y]) = '' THEN trim(e.creatorDOB[y]) ELSE a.dateOfBirth END, a.placeOfBirth = CASE WHEN NOT trim(e.creatorPOB[y]) = '' THEN trim(e.creatorPOB[y]) ELSE a.placeOfBirth END, a.dateOfDeath = CASE WHEN NOT trim(e.creatorDOD[y]) = '' THEN trim(e.creatorDOD[y]) ELSE a.dateOfDeath END, a.placeOfDeath = CASE WHEN NOT trim(e.creatorPOD[y]) = '' THEN trim(e.creatorPOD[y]) ELSE a.placeOfDeath END MERGE (e)-[:CREATOR]-&gt;(a) )",<br/>{batchSize:1000, parallel:false}<br/>)</span><span id="72ca" class="la lb hi kw b fi lg ld l le lf">//finally map those creators with a wiki entity reference but missing label<br/>CALL apoc.periodic.iterate(<br/>"MATCH (e:Exhibit) WHERE size([z IN e.creatorLabel WHERE NOT size(trim(z))=0]) &gt; 0 RETURN e",<br/>"WITH e FOREACH ( y IN [x IN range(0,size(e.creatorLabel)-1) WHERE size(trim(e.creatorLabel[x])) = 0 AND NOT size(trim(e.creatorWikiData[x])) = 0|x] | MERGE (a:Artist {name:toUpper(trim(e.creatorWikiData[y]))}) SET a.wikiID = trim(e.creatorWikiData[y]), a.dateOfBirth = CASE WHEN NOT trim(e.creatorDOB[y]) = '' THEN trim(e.creatorDOB[y]) ELSE a.dateOfBirth END, a.placeOfBirth = CASE WHEN NOT trim(e.creatorPOB[y]) = '' THEN trim(e.creatorPOB[y]) ELSE a.placeOfBirth END, a.dateOfDeath = CASE WHEN NOT trim(e.creatorDOD[y]) = '' THEN trim(e.creatorDOD[y]) ELSE a.dateOfDeath END, a.placeOfDeath = CASE WHEN NOT trim(e.creatorPOD[y]) = '' THEN trim(e.creatorPOD[y]) ELSE a.placeOfDeath END MERGE (e)-[:CREATOR]-&gt;(a) )",<br/>{batchSize:1000, parallel:false}<br/>)</span><span id="63fa" class="la lb hi kw b fi lg ld l le lf">//delete incorrect references to countries made from comma separated text mappings earlier<br/>MATCH (a:Artist)<br/>WHERE a.name CONTAINS 'PAYS-BAS'<br/>DETACH DELETE a</span></pre><p id="8e22" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">…那一刻，当你认为你完成了，但你还没有完全读“艺术家”歧义(<strong class="ix hj">叹息</strong>)。我们将不得不模糊匹配并标记<em class="kf">我们认为我们知道</em>是潜在的重复。</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="d698" class="la lb hi kw b fi lc ld l le lf">MATCH (n:Artist), (m:Artist)<br/>WHERE n.name &lt;&gt; m.name AND apoc.text.clean(n.name) = apoc.text.clean(m.name)<br/>RETURN n.name, n.wikiID, n.dateOfBirth, n.placeOfBirth, n.dateOfDeath, n.placeOfDeath, size(()-[:CREATOR]-&gt;(n)) AS worksOfArt<br/>ORDER BY n.name</span></pre><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lm"><img src="../Images/a032f6cd1124aa5a34ddd6e60840ee02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZcgS5Nv0WwgH9ozI06_9MA.png"/></div></div></figure><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="4f27" class="la lb hi kw b fi lc ld l le lf">//fuzzy match and associate potential duplicates<br/>MATCH (n:Artist), (m:Artist)<br/>WHERE n.name &lt;&gt; m.name AND apoc.text.clean(n.name) = apoc.text.clean(m.name)<br/>AND ((n.wikiID = m.wikiID) OR (n.wikiID IS NULL AND m.wikiID IS NULL) OR (n.wikiID IS NULL AND m.wikiID IS NOT NULL) OR (n.wikiID IS NOT NULL AND m.wikiID IS NULL))<br/>WITH n, m<br/>ORDER BY n.name<br/>WITH n, COLLECT(m) AS l<br/>FOREACH (x IN l | MERGE (n)-[:ARTIST_FUZZY_MATCH]-(x))</span><span id="e82d" class="la lb hi kw b fi lg ld l le lf">//query total works of art by artists with potential duplicates<br/>MATCH p=(:Artist)-[:ARTIST_FUZZY_MATCH*1..]-&gt;(:Artist)<br/>WITH p, [x IN NODES(p)][0] AS startNode, [x IN NODES(p)][-1] AS endNode<br/>WHERE NOT EXISTS (()-[:ARTIST_FUZZY_MATCH]-&gt;(startNode)) AND NOT EXISTS ((endNode)-[:ARTIST_FUZZY_MATCH]-&gt;())<br/>WITH apoc.coll.sort([x IN NODES(p)|x.name]) AS l<br/>WITH l[0] AS artist, apoc.coll.toSet(apoc.coll.flatten(COLLECT(l[1..]))) AS matches<br/>WITH artist, [artist]+matches AS l, matches AS `fuzzy-match`<br/>RETURN artist, toInteger(apoc.coll.sum([x IN l | size(()-[:CREATOR]-&gt;(:Artist {name:x}))])) AS worksOfArt, `fuzzy-match`<br/>ORDER BY artist</span></pre><p id="cae2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">比如说；</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ln"><img src="../Images/fd25494a0ee4679c27ab814001f236a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xfoAJyixlhysU-dLwRd2wA.png"/></div></div></figure><p id="9812" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，我们完全可以决定<a class="ae iu" href="https://neo4j.com/labs/apoc/4.2/graph-updates/graph-refactoring/merge-nodes/" rel="noopener ugc nofollow" target="_blank"> <strong class="ix hj">合并</strong> </a>潜在的重复“艺术家”节点，但我决定让它们保持原样，因为首先，我们不太确定它们是如何被卢浮宫映射的，其次，合并时必须组合节点属性，然后能够无缝地查询/处理它们的整个过程并不容易。此外，我们所做的所有标记都是最佳情况估计，因为它显然没有考虑到这种情况；</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lo"><img src="../Images/7ba0fc3a12ed0fedd8216f7decad61f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oBICwhHrHQS8USEl2l7S_g.png"/></div></div></figure><p id="2845" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">或者这个；</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lp"><img src="../Images/8fb630e4d2c85f1bfdb907cb2dc11a32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DmMHhilK6QCcOmlaoO50zg.png"/></div></div></figure><p id="78b5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最后，可悲的是，仍然没有被映射的是…不是我们<em class="kf">顺便说一下</em>成功消除的地方，而是人们聪明地伪装成这样。它本质上涉及到梳理混合物，以消除不相关的东西。由于这是一个相对较小的数字(150+)，我们选择继续前进，假设我们已经绘制了大多数重要人物的地图。</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="642f" class="la lb hi kw b fi lc ld l le lf">//what did not map<br/>MATCH (e:Exhibit) WHERE size([z IN e.creatorLabel <br/>WHERE NOT size(trim(z))=0]) &gt; 0 AND size((e)-[:CREATOR]-&gt;()) = 0<br/>UNWIND e.creatorLabel AS i<br/>WITH DISTINCT i <br/>ORDER BY i<br/>RETURN COUNT(i), COLLECT(i)</span></pre><p id="ec05" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">由于卢浮宫的摘录并没有说很多关于艺术家的事情，所以这是一个很好的主意来扩充我们所拥有的，另外从维基数据中，如果我们手头有维基数据实体参考的话。我感兴趣的是艺术家的国籍、职业、运动、流派和影响者。</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="9431" class="la lb hi kw b fi lc ld l le lf">CALL apoc.periodic.iterate(<br/>'MATCH (a:Artist)<br/>WHERE a.wikiID IS NOT NULL<br/>RETURN a',<br/>'WITH a,<br/>"SELECT ?item      <br/>(GROUP_CONCAT(DISTINCT(?itemCountryLabel); separator = \';\') AS ?country)<br/>(GROUP_CONCAT(DISTINCT(?itemOccupationLabel); separator = \';\') AS ?occupation)<br/>(GROUP_CONCAT(DISTINCT(?itemMovementLabel); separator = \';\') AS ?movement)<br/>(GROUP_CONCAT(DISTINCT(?itemGenreLabel); separator = \';\') AS ?genre)<br/>(GROUP_CONCAT(DISTINCT(?itemStudent); separator = \';\') AS ?student)<br/>(GROUP_CONCAT(DISTINCT(?itemStudentOf); separator = \';\') AS ?studentOf)<br/>WHERE {<br/>    VALUES ?item { wd:"+ a.wikiID +" }<br/>    OPTIONAL {<br/>      ?item wdt:P27 ?itemCountry .<br/>      ?itemCountry rdfs:label ?itemCountryLabel .<br/>      FILTER (lang(?itemCountryLabel) = \'en\') .<br/>      }<br/>    OPTIONAL {<br/>      ?item wdt:P106 ?itemOccupation .<br/>      ?itemOccupation rdfs:label ?itemOccupationLabel .<br/>      FILTER (lang(?itemOccupationLabel) = \'en\') .<br/>      }  <br/>    OPTIONAL {<br/>      ?item wdt:P135 ?itemMovement .<br/>      ?itemMovement rdfs:label ?itemMovementLabel .<br/>      FILTER (lang(?itemMovementLabel) = \'en\') .<br/>      }  <br/>    OPTIONAL {<br/>      ?item wdt:P136 ?itemGenre .<br/>      ?itemGenre rdfs:label ?itemGenreLabel .<br/>      FILTER (lang(?itemGenreLabel) = \'en\') .<br/>      }<br/>    OPTIONAL {<br/>      ?item wdt:P802 ?itemStudent .<br/>      }   <br/>    OPTIONAL {<br/>      ?item wdt:P1066 ?itemStudentOf .<br/>      }    <br/>} GROUP BY ?item" AS query<br/>CALL apoc.load.jsonParams("<a class="ae iu" href="http://query.wikidata.org/sparql?format=json&amp;query=" rel="noopener ugc nofollow" target="_blank">http://query.wikidata.org/sparql?format=json&amp;query=</a>" + apoc.text.urlencode(query), {}, null) <br/>YIELD value <br/>WITH a, value.results.bindings AS artists<br/>UNWIND artists AS artist<br/>WITH a, artist.country.value AS country, <br/>artist.occupation.value AS occupation, <br/>artist.movement.value AS movement, <br/>artist.genre.value AS genre, <br/>artist.student.value AS student, <br/>artist.studentOf.value AS studentOf<br/>SET<br/>a.wikiCountryCitizenship = CASE WHEN NOT country = \'\' THEN country ELSE NULL END,<br/>a.wikiOccupation = CASE WHEN NOT occupation = \'\' THEN occupation ELSE NULL END,<br/>a.wikiMovement = CASE WHEN NOT movement = \'\' THEN movement ELSE NULL END,<br/>a.wikiGenre = CASE WHEN NOT genre = \'\' THEN genre ELSE NULL END,<br/>a.wikiStudent = CASE WHEN NOT student = \'\' THEN student ELSE NULL END,<br/>a.wikiStudentOf = CASE WHEN NOT studentOf = \'\' THEN studentOf ELSE NULL END',<br/>{batchSize:10, parallel:true}<br/>)</span></pre><p id="47f6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，我遇到了一个HTTP 429错误，它与在一个时间范围内读取太多请求有关。如果是这样的话，我们需要进一步限定我们的要求。</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lq"><img src="../Images/e983ef6610e482bf55909d6f834ce6ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tC68btj6SoZW7jZgIEBjSA.png"/></div></div></figure><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="b5a7" class="la lb hi kw b fi lc ld l le lf">MATCH (a:Artist)<br/>WHERE a.wikiID IS NOT NULL<br/>FOREACH ( x IN CASE WHEN a.wikiOccupation IS NOT NULL THEN [1] ELSE [] END | FOREACH ( y IN SPLIT(a.wikiOccupation,';') | MERGE (o:Occupation {occupation:toUpper(trim(y))}) MERGE (a)-[:OCCUPATION]-&gt;(o) ) )<br/>FOREACH ( x IN CASE WHEN a.wikiMovement IS NOT NULL THEN [1] ELSE [] END | FOREACH ( y IN SPLIT(a.wikiMovement,';') | MERGE (m:Movement {movement:toUpper(trim(y))}) MERGE (a)-[:MOVEMENT]-&gt;(m) ) )<br/>FOREACH ( x IN CASE WHEN a.wikiGenre IS NOT NULL THEN [1] ELSE [] END | FOREACH ( y IN SPLIT(a.wikiGenre,';') | MERGE (g:Genre {genre:toUpper(trim(y))}) MERGE (a)-[:GENRE]-&gt;(g) ) )</span><span id="7b52" class="la lb hi kw b fi lg ld l le lf">MATCH (a:Artist)<br/>WHERE a.wikiID IS NOT NULL AND a.wikiCountryCitizenship IS NOT NULL<br/>WITH a, SPLIT(a.wikiCountryCitizenship,';') AS countries<br/>UNWIND countries AS country<br/>MATCH (c:Country)<br/>WHERE toUpper(trim(c.countryEN)) = toUpper(trim(country)) <br/>MERGE (a)-[:COUNTRY]-&gt;(c)</span><span id="92e0" class="la lb hi kw b fi lg ld l le lf">MATCH (a:Artist)<br/>WHERE a.wikiID IS NOT NULL AND a.wikiStudent IS NOT NULL<br/>WITH a, [x IN SPLIT(a.wikiStudent,';')|SPLIT(x,'/')[-1]] AS students<br/>UNWIND students AS student<br/>MATCH (s:Artist {wikiID:toUpper(trim(student))})<br/>MERGE (s)-[:TEACHER]-&gt;(a)</span><span id="374a" class="la lb hi kw b fi lg ld l le lf">MATCH (a:Artist)<br/>WHERE a.wikiID IS NOT NULL AND a.wikiStudentOf IS NOT NULL<br/>WITH a, [x IN SPLIT(a.wikiStudentOf,';')|SPLIT(x,'/')[-1]] AS teachers<br/>UNWIND teachers AS teacher<br/>MATCH (t:Artist {wikiID:toUpper(trim(teacher))})<br/>MERGE (a)-[:TEACHER]-&gt;(t)</span></pre><p id="f590" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">仔细观察来自卢浮宫json摘录的“特征”数据和来自维基数据的“描述”数据(我们确实用它们额外丰富了“展示”节点)，我认为它们可能意味着相同的事情。同样的观察也适用于卢浮宫json摘录中的“周期”和维基数据中的“运动”数据。当你的<em class="kf">唯一的</em>所谓的单一事实来源无法提供时，从可信的外部来源填补缺失的数据可能是值得的。在我们的案例中，我们看到维基数据记录了“运动”，而展览中的“时期”却不见了。</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="47dd" class="la lb hi kw b fi lc ld l le lf">MATCH (n:Exhibit)<br/>WHERE n.wikiMovement IS NOT NULL AND n.period IS NULL<br/>RETURN COUNT(n)</span></pre><p id="7e5d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，由于“运动”节点数据是英语语言，它们的法语翻译看起来与法语语言的“时期”数据不完全一致，我们可以尽可能使用模糊匹配将法语翻译及其别名从维基数据映射到“时期”节点数据。</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lr"><img src="../Images/15a609c023cccddba58511bfee4a09c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t6rY5jP_7wsRczp2QH6MDg.png"/></div></div></figure><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="3924" class="la lb hi kw b fi lc ld l le lf">//fetch the translations for movements<br/>CALL apoc.periodic.iterate(<br/>'WITH<br/>"SELECT DISTINCT ?itemMovementLabelEN ?itemMovementLabelFR <br/>(GROUP_CONCAT(DISTINCT(?itemAltLabelFR); separator = \';\') AS ?aliasFR)<br/>WHERE {<br/>    ?item wdt:P9394 ?ark .<br/>    ?item wdt:P135 ?itemMovement .<br/>    ?itemMovement rdfs:label ?itemMovementLabelEN .<br/>    FILTER (lang(?itemMovementLabelEN) = \'en\') .<br/>    OPTIONAL {<br/>      ?itemMovement rdfs:label ?itemMovementLabelFR .<br/>      FILTER (lang(?itemMovementLabelFR) = \'fr\') .<br/>    }<br/>    OPTIONAL {<br/>      ?itemMovement skos:altLabel ?itemAltLabelFR .<br/>      FILTER (lang(?itemAltLabelFR) = \'fr\') .<br/>    }<br/>}<br/>GROUP BY ?itemMovementLabelEN ?itemMovementLabelFR" AS query<br/>CALL apoc.load.jsonParams("<a class="ae iu" href="http://query.wikidata.org/sparql?format=json&amp;query=" rel="noopener ugc nofollow" target="_blank">http://query.wikidata.org/sparql?format=json&amp;query=</a>" + apoc.text.urlencode(query), {}, null) <br/>YIELD value <br/>RETURN value',<br/>'WITH value.results.bindings AS movements<br/>UNWIND movements AS movement<br/>WITH toUpper(trim(movement.itemMovementLabelEN.value)) AS movementEN, toUpper(trim(movement.itemMovementLabelFR.value)) AS movementFR, toUpper(trim(movement.aliasFR.value)) AS aliasFR<br/>MATCH (m:Movement {movement:movementEN})<br/>SET m.movementFR = movementFR,<br/>m.aliasFR = CASE WHEN NOT aliasFR = \'\' THEN aliasFR ELSE NULL end',<br/>{batchSize:10, parallel:true}<br/>)</span><span id="c03b" class="la lb hi kw b fi lg ld l le lf">//fuzzy match movements with periods<br/>MATCH (p:Period)<br/>WITH p<br/>MATCH (m:Movement)<br/>WITH p, m, [m.movementFR]+SPLIT(m.aliasFR,';') AS l<br/>WITH p, m, [x IN l WHERE (apoc.text.levenshteinSimilarity(x, p.period) + apoc.text.sorensenDiceSimilarity(x, p.period))/2 &gt; 0.6|x] AS i<br/>WHERE size(i) &gt; 0<br/>RETURN p.period AS period, apoc.coll.flatten(COLLECT([m.movementFR]+SPLIT(m.aliasFR,';'))) AS movements</span></pre><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ls"><img src="../Images/f9cb2324885477d0606602220e93336f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DDHV_4pcrwifTXQ9yZMVxw.png"/></div></div></figure><p id="8407" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">好吧，除了少数例外(我们可以稍后手动清理)，现在看起来确实令人满意，所以我们可以继续将两者联系起来。</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="84f7" class="la lb hi kw b fi lc ld l le lf">MATCH (p:Period)<br/>WITH p<br/>MATCH (m:Movement)<br/>WITH p, m, [m.movementFR]+SPLIT(m.aliasFR,';') AS l<br/>WITH p, m, [x IN l WHERE (apoc.text.levenshteinSimilarity(x, p.period) + apoc.text.sorensenDiceSimilarity(x, p.period))/2 &gt; 0.6|x] AS i<br/>WHERE size(i) &gt; 0<br/>MERGE (m)-[:FUZZY_MATCH]-&gt;(p)</span></pre><p id="800f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">接下来，我们来看看json摘录中的“特征”和维基数据外部丰富的“描述”之间的相似性。我们确实有这样的情况，一个展品缺少json摘录中的“特征”,但在维基数据中有记录的“描述”。</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="6df3" class="la lb hi kw b fi lc ld l le lf">MATCH (n:Exhibit)<br/>WHERE n.wikiDepiction IS NOT NULL AND n.feature IS NULL<br/>RETURN COUNT(n)</span></pre><p id="acd8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">假设它们是相同的，我们将“描述”添加到“特征”语料库，并将展示重新映射到“特征”,以查看我们可以解释多少额外的缺失参考。</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="95a9" class="la lb hi kw b fi lc ld l le lf">//fetch the translation for depictions<br/>CALL apoc.periodic.iterate(<br/>'WITH<br/>"SELECT ?ark <br/>(GROUP_CONCAT(DISTINCT(?itemDepictLabel); separator = \';\') AS ?depiction)<br/>WHERE {<br/>    ?item wdt:P9394 ?ark .<br/>    ?item wdt:P180 ?itemDepict .<br/>    ?itemDepict rdfs:label ?itemDepictLabel .<br/>    FILTER (lang(?itemDepictLabel) = \'fr\') .<br/>    }<br/>GROUP BY ?ark" AS query<br/>CALL apoc.load.jsonParams("<a class="ae iu" href="http://query.wikidata.org/sparql?format=json&amp;query=" rel="noopener ugc nofollow" target="_blank">http://query.wikidata.org/sparql?format=json&amp;query=</a>" + apoc.text.urlencode(query), {}, null) <br/>YIELD value <br/>RETURN value',<br/>'WITH value.results.bindings AS arks<br/>UNWIND arks AS ark<br/>WITH \'cl\'+ark.ark.value AS ark, ark.depiction.value AS depiction<br/>MATCH (e:Exhibit {arkID:ark})<br/>SET e.wikiDepictionFR = depiction',<br/>{batchSize:100, parallel:true}<br/>)</span><span id="741d" class="la lb hi kw b fi lg ld l le lf">//map the missing features to exhibits<br/>CALL apoc.periodic.iterate(<br/>"MATCH (e:Exhibit)<br/>RETURN e",<br/>"<br/>WITH e<br/>FOREACH ( x IN CASE WHEN e.wikiDepictionFR IS NOT NULL THEN [1] ELSE [] END | FOREACH ( y IN SPLIT(e.wikiDepictionFR,';') | MERGE (fe:Feature {feature:toUpper(trim(y))}) MERGE (e)-[:FEATURE]-&gt;(fe) ) )<br/>",<br/>{batchSize:1000, parallel:false}<br/>)</span></pre><p id="3766" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">继续，如果你还不知道的话，卢浮宫不只是在法国，而是在全世界！在法国，有“尤金·德拉克洛瓦国家博物馆”、“卢浮宫透镜”和“卢浮宫保护中心”，它们是卢浮宫的延伸，而“阿布扎比卢浮宫”是法国和阿联酋前所未有的合作的结果，也是法国在海外最大的文化项目。</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lt"><img src="../Images/efe43073cd98b2306c236952f0c2c97e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3rJNWhUDz6iEAo61qoY9Mg.png"/></div></div></figure><p id="593d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这意味着，我们必须检查我们的位置地图，看看它是否全部加起来。<em class="kf">顺便说一下</em>(组织技能和免费午餐到此为止)。所以有工作要做。</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="d066" class="la lb hi kw b fi lc ld l le lf">-- update louvre lens' locations to "LOUVRE-LENS"<br/>MATCH (lens:Location {location:'LOUVRE-LENS'})<br/>MATCH (e:Exhibit)-[r:LOCATION]-&gt;(l:Location)<br/>WHERE l &lt;&gt; lens AND l.location CONTAINS 'LOUVRE-LENS' <br/>WITH e, r, lens<br/>MERGE (e)-[:LOCATION]-&gt;(lens)<br/>DELETE r</span><span id="047a" class="la lb hi kw b fi lg ld l le lf">MATCH (l:Location)<br/>WHERE l.location CONTAINS 'LOUVRE-LENS' AND NOT l.location = 'LOUVRE-LENS'<br/>DELETE l</span><span id="e534" class="la lb hi kw b fi lg ld l le lf">MATCH (e:Exhibit)-[:LOCATION]-&gt;(l:Location)<br/>WHERE l.location CONTAINS 'LOUVRE-LENS' <br/>RETURN l.location, COUNT(e)</span><span id="5a33" class="la lb hi kw b fi lg ld l le lf">-- update delacroix locations to "MUSÉE NATIONAL EUGÈNE DELACROIX"<br/>MATCH (d:Location {location:'MUSÉE NATIONAL EUGÈNE DELACROIX'})<br/>MATCH (e:Exhibit)-[r:LOCATION]-&gt;(l:Location)<br/>WHERE l &lt;&gt; d AND l.location CONTAINS 'DELACROIX' <br/>WITH e, r, d<br/>MERGE (e)-[:LOCATION]-&gt;(d)<br/>DELETE r</span><span id="172a" class="la lb hi kw b fi lg ld l le lf">MATCH (l:Location)<br/>WHERE l.location CONTAINS 'DELACROIX' AND NOT l.location = 'MUSÉE NATIONAL EUGÈNE DELACROIX'<br/>DELETE l</span><span id="d55d" class="la lb hi kw b fi lg ld l le lf">MATCH (e:Exhibit)-[:LOCATION]-&gt;(l:Location)<br/>WHERE l.location CONTAINS 'DELACROIX' <br/>RETURN l.location, COUNT(e)</span></pre><p id="dc5a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这就是标记库存的样子。现在，这些加起来与上述场地预测不符，可能是因为超过180，000件艺术品的“当前位置”被归类为“未曝光”。我们可以进一步求助于展品的“持有”和“租赁”权限，但不能确定其“当前位置”。所以我们到此为止。</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lu"><img src="../Images/b9fbfea5226a1756b73485c7aab23672.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RkXuqCegw2RI7InX57rTPQ.png"/></div></div></figure><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="c5aa" class="la lb hi kw b fi lc ld l le lf">MATCH (e:Exhibit)-[:LOCATION]-&gt;(l:Location)<br/>WHERE NOT l.location CONTAINS 'LOUVRE' AND NOT l.location CONTAINS 'DELACROIX'<br/>RETURN l.location, COUNT(e)</span><span id="12e9" class="la lb hi kw b fi lg ld l le lf">MATCH (e:Exhibit)-[:LOCATION]-&gt;(l:Location {location:'NON EXPOSÉ'})<br/>MATCH (e)-[r]-&gt;(a:Authority)<br/>WHERE a.authority CONTAINS 'LOUVRE' OR a.authority CONTAINS 'DELACROIX'<br/>RETURN a.authority AS authority, TYPE(r) AS type, COUNT(e) AS cnt<br/>ORDER BY cnt DESC, authority</span></pre><p id="68d4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最后，我们按照卢浮宫收藏网站上描述的类别给每件展品贴上标签。由于json摘录中没有父类别标记，唯一的方法是从卢浮宫收藏页面下载按“类别”过滤的csv摘录，其中基本包含标题、艺术家、时间线和收藏详细信息中的ark ID。通过匹配ark ID，我们可以标记“Exhibit”节点，以符合卢浮宫收藏页面上的“Category”编号。为了节省时间和减少痛苦，我就不做这个练习了。<em class="kf">其他要做的事情是从展览创作地&amp;发现地/艺术家出生地&amp;死亡地检查“地点”，圈出未映射的艺术家并将其映射到他们的创作作品，删除与运动参考无关的时期。</em></p><p id="4e0b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">好吧！至此，我们已经很好地解释了我们一直在寻找连接的数据。或者至少，我们尝试过。</p><p id="9e7b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">外卖？这是我的。<br/> -真实世界的数据很少以可供消费的形式出现，请准备好在早期投入时间进行数据管理<br/> -你的分析准确性取决于你的数据<br/> -使用可信的外部来源(如维基数据)填补缺失的参考文献/数据；如果对Google足够好，对你也足够好<br/> - Neo4j可以通过内置和扩展的库支持来处理数据转换；随意利用(这里使用的APOC库必须是Neo4j工具箱中的一个工具)</p></div><div class="ab cl kj kk gp kl" role="separator"><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko"/></div><div class="hb hc hd he hf"><p id="455b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在怎么办？如果你已经来了<strong class="ix hj"> <em class="kf">这个</em> </strong>远(而那个<strong class="ix hj"> <em class="kf">是</em> </strong>整个九码为<strong class="ix hj"> <em class="kf">一个</em> </strong>部分的1个系列)，请继续关注我打算对卢浮宫合集做些什么！</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lv"><img src="../Images/11ce55b464f6e3b73ca2baf11c71d570.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aBsIWZmRA4S9UF_pomZVgQ.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">Igor Miske在Unsplash上拍摄的照片</figcaption></figure><p id="0c98" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">参考资料:</p><p id="008b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><a class="ae iu" href="https://schema.org/VisualArtwork" rel="noopener ugc nofollow" target="_blank">https://schema.org/VisualArtwork</a><br/><a class="ae iu" href="https://www.w3.org/TR/rdf-schema/" rel="noopener ugc nofollow" target="_blank">https://www.w3.org/TR/rdf-schema/</a><br/><a class="ae iu" href="https://www.wikidata.org/wiki/Wikidata:Relation_between_properties_in_RDF_and_in_Wikidata" rel="noopener ugc nofollow" target="_blank">https://www . wiki data . org/wiki/Wikidata:Relation _ between _ properties _ in _ RDF _ and _ in _ wiki data</a><br/><a class="ae iu" href="https://www.wikidata.org/wiki/Wikidata:SPARQL_query_service/query_optimization" rel="noopener ugc nofollow" target="_blank">https://www . wiki data . org/wiki/wiki data:SPARQL _ query _ service/query _ optimization</a><br/><a class="ae iu" href="https://www.wikidata.org/wiki/Wikidata:SPARQL_query_service/suggestions#Performance_surprises" rel="noopener ugc nofollow" target="_blank">https://www . wiki data . org/wiki/wiki data:SPARQL _ query</a></p><p id="ec2b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><a class="ae iu" href="https://www.louvre.fr/en" rel="noopener ugc nofollow" target="_blank">https://www.louvre.fr/en</a></p></div></div>    
</body>
</html>