<html>
<head>
<title>Apache Kafka Series [Part 1]: Introduction to Apache Kafka</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">阿帕奇卡夫卡系列[第一部分]:阿帕奇卡夫卡简介</h1>
<blockquote>原文：<a href="https://medium.com/codex/apache-kafka-series-part-1-introduction-to-apache-kafka-9b890832002?source=collection_archive---------3-----------------------#2021-07-17">https://medium.com/codex/apache-kafka-series-part-1-introduction-to-apache-kafka-9b890832002?source=collection_archive---------3-----------------------#2021-07-17</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="781f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">多亏了微服务，发展格局已经发生了变化。它们通过消除共享数据库层之类的依赖性来提高开发人员的灵活性。然而，您的开发人员正在创建的分布式应用程序将需要某种形式的数据共享集成。同步方法是最流行的集成选项之一，它使用应用程序编程接口(API)在用户之间传递数据。</p><p id="fb9d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">异步技术是第二个集成选项，它需要在中间存储库中复制数据。这就是Apache Kafka的用武之地，它将来自其他开发团队的数据流填充到数据存储中，以便可以在许多团队和应用程序之间共享。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/6e2cf4725352e0e0ab850a36d99727d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:900/format:webp/0*jf4hP_N_ObzkozPX.png"/></div></figure><blockquote class="jl jm jn"><p id="cd39" class="if ig jo ih b ii ij ik il im in io ip jp ir is it jq iv iw ix jr iz ja jb jc hb bi translated">Apache Kafka是一个开源的分布式发布-订阅消息传递平台，专门用于处理实时流数据，以实现快速、可扩展的操作。</p></blockquote><p id="e5e9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">换句话说，它同时移动大量的数据——不仅仅是从一个地方移动到另一个地方，还可以从那个地方移动到你需要的任何地方。</p><p id="b856" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">它最初是一个LinkedIn内部系统，旨在每天处理数万亿条消息，但后来发展成为一个开源数据流解决方案，具有用于许多商业目的的应用程序。</p><h1 id="bc8c" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">什么时候用阿帕奇卡夫卡？</h1><p id="3625" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">因为Apache Kafka是专门为实时日志流设计的，所以它适用于需要以下条件的应用程序:</p><ul class=""><li id="a4f1" class="kv kw hi ih b ii ij im in iq kx iu ky iy kz jc la lb lc ld bi translated">独立组件之间可靠的数据交换</li><li id="23bc" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc la lb lc ld bi translated">随着应用程序需求的变化划分消息传递工作负载的能力</li><li id="f4f5" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc la lb lc ld bi translated">用于数据处理的实时流</li><li id="1f21" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc la lb lc ld bi translated">对数据/消息重放的本机支持</li></ul><h1 id="405f" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">它是如何工作的？</h1><p id="a64f" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">Kafka结合了排队和发布-订阅这两种消息传递模型的优点，为用户提供了这两种模型的优点。数据处理可以通过排队在众多消费者实例之间进行分割，这使得它具有高度的可伸缩性。另一方面，传统的队列不是多用户的。尽管发布-订阅方法是多订阅方的，但它不能用于在多个工作进程之间分配工作，因为每个消息都被发送到每个订阅方。为了连接这两个系统，Kafka采用了分区日志架构。</p><p id="671b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">日志是记录的有序集合，这些记录被组织成对应于不同订户的段或分区。这意味着订阅同一主题的众多订阅者可以被分配到不同的分区，从而实现更大的可伸缩性。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="er es lj"><img src="../Images/a12218ba2fec689d4b42fba098636812.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*cWqlsZv6m0UliZBE.png"/></div></div></figure><h1 id="0f79" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">阿帕奇卡夫卡的主要成分是什么？</h1><ul class=""><li id="79b0" class="kv kw hi ih b ii kq im kr iq lo iu lp iy lq jc la lb lc ld bi translated">在发布/订阅消息传递中，主题是一个相当普遍的概念。主题是一个可寻址的抽象，用于展示对Apache Kafka和其他消息传递平台中特定数据流(一系列记录/消息)的兴趣。主题是一个抽象层，应用程序用它来表明对某个数据流的兴趣。可以发布和订阅。</li><li id="1a40" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc la lb lc ld bi translated"><strong class="ih hj">分区</strong>:Apache Kafka中的主题可以分成分区，分区是一系列的顺序队列。通过重复追加这些段来形成顺序提交日志。Kafka系统中的每个记录/消息都有一个顺序ID，称为偏移量，用于标识某个分区中的消息或记录。</li><li id="af57" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc la lb lc ld bi translated"><strong class="ih hj">生产者</strong>:Apache Kafka中生产者的概念类似于大多数消息系统。数据生产者(记录/消息)指定特定记录/消息应该发布的主题(数据流)。因为分区用于提高可伸缩性，所以生产者可以选择将给定的记录/消息发布到哪个分区。生产者不需要标识一个分区，通过这样做，主题分区之间的负载平衡可以以循环方式执行。</li><li id="1ba8" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc la lb lc ld bi translated">消费者:消费者是Kafka中处理记录/消息的实体。可以将使用者设置为独立完成自己的任务，或者与其他使用者协作完成特定的工作负载(负载平衡)。消费者根据他们所属的消费者组来管理他们的任务处理。通过使用消费者组名称，可以将消费者分组到一个消费者组中。通过使用一个消费者组名称，可以在单个流程内、跨多个流程、甚至跨多个系统划分消费者。使用者可以使用使用者组名称来平衡整个使用者集(许多使用者具有相同的使用者组名称)中的记录/消息消耗，或者单独处理每个记录/消息(多个使用者具有唯一的使用者组名称)，其中订阅某个主题/分区的每个使用者都可以获得要处理的消息。</li></ul><h1 id="27d4" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">从本地机器上的Apache Kafka开始</h1><p id="ad9e" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">他们说学习的最好方法是去做。在本节中，我们将了解如何在本地机器上运行单节点Kafka集群，以及如何通过Kafka CLI进行生产和消费。</p><h2 id="2717" class="lr jt hi bd ju ls lt lu jy lv lw lx kc iq ly lz kg iu ma mb kk iy mc md ko me bi translated">启动集群</h2><ul class=""><li id="3ad9" class="kv kw hi ih b ii kq im kr iq lo iu lp iy lq jc la lb lc ld bi translated">首先从官方下载页面<a class="ae mf" href="https://kafka.apache.org/downloads" rel="noopener ugc nofollow" target="_blank">下载最新的Apache Kafka二进制文件。</a></li><li id="a551" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc la lb lc ld bi translated">把它提取出来。(对于windows用户，如果您稍后收到“输入行太长”错误，请将其解压缩到C: drive或其中的一个文件夹中，但不要解压缩到一个长的嵌套目录中)。</li><li id="e724" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc la lb lc ld bi translated">转到解压缩文件夹中的<strong class="ih hj"> <em class="jo"> config </em> </strong>目录，编辑<strong class="ih hj"><em class="jo">server . properties .</em></strong>将默认情况下会被注释掉的<strong class="ih hj"> <em class="jo"> listeners </em> </strong>属性更改为下面的内容，其余部分保持不变。</li></ul><pre class="je jf jg jh fd mg mh mi mj aw mk bi"><span id="65fc" class="lr jt hi mh b fi ml mm l mn mo">listeners=PLAINTEXT://localhost:9092</span></pre><ul class=""><li id="b369" class="kv kw hi ih b ii ij im in iq kx iu ky iy kz jc la lb lc ld bi translated">现在打开windows的<strong class="ih hj"> <em class="jo"> bin/windows/ </em> </strong>目录下的终端，Linux或Mac的<strong class="ih hj"> <em class="jo"> bin/ </em> </strong>目录下的终端。</li></ul><p id="7c7b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">注意:我将使用通过bat文件运行的windows命令。但是如果您使用的是Linux或Mac，请从bin目录运行shell文件，并相应地更改参数的相对路径。</p><ul class=""><li id="abb8" class="kv kw hi ih b ii ij im in iq kx iu ky iy kz jc la lb lc ld bi translated">在<strong class="ih hj"> <em class="jo"> windows/ </em> </strong>目录下运行以下命令，首先启动zookeeper。</li></ul><pre class="je jf jg jh fd mg mh mi mj aw mk bi"><span id="292f" class="lr jt hi mh b fi ml mm l mn mo">&gt;zookeeper-server-start.bat ..\..\config\zookeeper.properties</span></pre><ul class=""><li id="cc13" class="kv kw hi ih b ii ij im in iq kx iu ky iy kz jc la lb lc ld bi translated">然后使用下面的命令启动Kafka代理。</li></ul><pre class="je jf jg jh fd mg mh mi mj aw mk bi"><span id="b32b" class="lr jt hi mh b fi ml mm l mn mo">&gt;kafka-server-start.bat ..\..\config\server.properties</span></pre><p id="5ae2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果一切顺利，您将看到输出，即记录了一个新的控制器以及您的代理连接字符串，如下所示。</p><pre class="je jf jg jh fd mg mh mi mj aw mk bi"><span id="a2df" class="lr jt hi mh b fi ml mm l mn mo">INFO [broker-0-to-controller-send-thread]: Recorded new controller, from now on will use broker localhost:9092 (id: 0 rack: null) (kafka.server.BrokerToControllerRequestThread)</span></pre><p id="2edc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">就是这样！您的代理现在运行在localhost:9092上，zookeeper运行在localhost:2181上，这是它们的默认配置。您可以分别在它们的属性文件中更改它。</p><h2 id="e957" class="lr jt hi bd ju ls lt lu jy lv lw lx kc iq ly lz kg iu ma mb kk iy mc md ko me bi translated">创建一个主题并从中产生/消费</h2><ul class=""><li id="c07f" class="kv kw hi ih b ii kq im kr iq lo iu lp iy lq jc la lb lc ld bi translated">在同一目录中打开另一个终端。</li><li id="3049" class="kv kw hi ih b ii le im lf iq lg iu lh iy li jc la lb lc ld bi translated">我们将使用以下命令使用<strong class="ih hj"> <em class="jo"> kafka-topics </em> </strong>脚本来创建一个主题。本主题将有一个复制因子1(复制因子用于防止由于多节点群集中的代理故障而丢失数据)和一个分区，以简化使用。</li></ul><pre class="je jf jg jh fd mg mh mi mj aw mk bi"><span id="3243" class="lr jt hi mh b fi ml mm l mn mo">&gt;kafka-topics.bat --create --zookeeper localhost:2181 --replication-factor 1 --partitions 1 --topic MyFirstTopic</span></pre><p id="13c5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您将看到一个“<em class="jo">创建的主题MyFirstTopic。</em>“主题创建成功时的消息。在Kafka控制台中，您还可以看到为分区myfirstopic-0创建了一个新日志及其属性。</p><ul class=""><li id="6096" class="kv kw hi ih b ii ij im in iq kx iu ky iy kz jc la lb lc ld bi translated">现在，既然我们已经有了我们的主题，我们将使用下面的命令生成一些消息给它，该命令使用了<strong class="ih hj"><em class="jo">Kafka-console-producer</em></strong>脚本。</li></ul><pre class="je jf jg jh fd mg mh mi mj aw mk bi"><span id="7d54" class="lr jt hi mh b fi ml mm l mn mo">&gt;kafka-console-producer.bat --broker-list localhost:9092 --producer.config ..\..\config\producer.properties --topic MyFirstTopic</span></pre><p id="cc4d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您看到光标闪烁的“&gt;”，则您现在处于生产窗口中。写下任何消息并按下回车键，该消息将被发布到您的主题中。</p><ul class=""><li id="55b1" class="kv kw hi ih b ii ij im in iq kx iu ky iy kz jc la lb lc ld bi translated">消息生成后，您可以使用以下命令使用<strong class="ih hj"><em class="jo">Kafka-控制台-消费者脚本</em> </strong>来消费它。</li></ul><pre class="je jf jg jh fd mg mh mi mj aw mk bi"><span id="0057" class="lr jt hi mh b fi ml mm l mn mo">&gt;kafka-console-consumer.bat --bootstrap-server localhost:9092 --consumer.config ..\..\config\consumer.properties --topic MyFirstTopic --from-beginning</span></pre><p id="0255" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">“-from-beginning”属性是可选的，仅在使用者希望从头开始阅读每条消息时使用。</p><p id="4ad2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">就是这样！您现在将看到您生成的消息。</p><p id="6e7d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您希望看到消息被实时处理，请打开单独的生产者和消费者终端，这样您就可以看到消息在您生产它们时就被消费了。</p><h1 id="c7f2" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">结论</h1><p id="f3d2" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">现在你对什么是阿帕奇卡夫卡有了基本的了解，我们为什么需要它，我们如何开始使用它。</p><p id="035b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本系列的下一部分中，我们将看到如果我们想在生产中使用Apache Kafka，我们有哪些安全选项，因为我们在本文中创建的集群还没有准备好用于生产级应用程序。我们还将研究如何决定何时使用哪个安全选项以及为什么使用。</p><p id="f1ce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在那之前，再见，祝你好运！</p></div></div>    
</body>
</html>