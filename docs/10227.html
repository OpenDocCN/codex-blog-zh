<html>
<head>
<title>Matplotlib Tutorial — 9</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Matplotlib教程— 9</h1>
<blockquote>原文：<a href="https://medium.com/codex/matplotlib-tutorial-9-fe1166e57aed?source=collection_archive---------13-----------------------#2022-12-13">https://medium.com/codex/matplotlib-tutorial-9-fe1166e57aed?source=collection_archive---------13-----------------------#2022-12-13</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="2eca" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">本教程将涵盖实时绘制实时数据。</p><p id="b37e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当使用传感器、不断从API提取数据或拥有经常更新的文件时，您可能希望实时分析数据。</p><p id="002f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了绘制实时数据，我们将使用matplotlib中的FuncAnimation()。</p><p id="1f5f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们理解下面的代码，然后我们将导入FuncAnimation()来绘制实时数据。</p><pre class="jd je jf jg fd jh ji jj bn jk jl bi"><span id="f9a0" class="jm jn hi ji b be jo jp l jq jr">import random<br/>from itertools import count<br/>import pandas as pd<br/>import matplotlib.pyplot as plt<br/><br/>plt.style.use('fivethirtyeight')<br/><br/>x_vals = [0, 1, 2, 3, 4, 5]<br/>y_vals = [0, 1, 3, 2, 3, 5]<br/><br/>plt.plot(x_vals, y_vals)</span></pre><p id="0729" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里，我们有用X和Y值绘制线图的基本代码，但是如果我们想对X和Y轴都使用动态值，我们可以使用下面的函数来代替静态值。</p><pre class="jd je jf jg fd jh ji jj bn jk jl bi"><span id="e80f" class="jm jn hi ji b be jo jp l jq jr">index = count()<br/><br/>def animate(i):<br/>    x_vals.append(next(index))<br/>    y_vals.append(random.randint(0, 5))</span></pre><p id="b5ad" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这个函数中，我们使用计数函数，每次将X值增加1，对于Y轴，我们使用1到5之间的随机值。</p><p id="0db3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们从matplotlib导入FuncAnimation()，并使用动态值来绘制数据。</p><pre class="jd je jf jg fd jh ji jj bn jk jl bi"><span id="b3c5" class="jm jn hi ji b be jo jp l jq jr">import random<br/>from itertools import count<br/>import pandas as pd<br/>import matplotlib.pyplot as plt<br/>from matplotlib.animation import  FuncAnimation<br/><br/>plt.style.use('fivethirtyeight')<br/><br/>x_vals = []<br/>y_vals = []<br/>index = count()<br/><br/>def animate(i):<br/>    x_vals.append(next(index))<br/>    y_vals.append(random.randint(0, 5))<br/>    plt.cla()<br/>    plt.plot(x_vals,y_vals)<br/><br/>ani = FuncAnimation(plt.gcf(),animate,interval=1000)<br/><br/>plt.tight_layout()<br/>plt.show()</span></pre><p id="a211" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这里，我们已经导入了FuncAnimation，创建了一个变量ani，并传递了三个参数，第一个是gcf()，这意味着获取当前数字，第二个是我们正在传递的函数，在这里我们生成值并绘制图形，interval表示它将在什么时间间隔内运行该函数，这里我传递了1000，这意味着它将每秒运行一次。</p><p id="5da9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">plt.cla()用于在每次运行该函数时清除图形，否则它每次都会重叠线条。所以我们将运行这段代码，每秒钟得到一个动态图。</p><figure class="jd je jf jg fd jt er es paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="er es js"><img src="../Images/1105f3de5f8b23e16abf89c5c8602868.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tJxo9A2DgcqtP9UFAa0c1A.png"/></div></div></figure><p id="013a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，了解了具有实时数据的真实示例，我已经创建了一个脚本，该脚本将生成数据并将其连续写入CSV，我们将使用该CSV来绘制图表，因此我将快速浏览一下用于更新CSV的脚本。</p><pre class="jd je jf jg fd jh ji jj bn jk jl bi"><span id="b9a6" class="jm jn hi ji b be jo jp l jq jr">import csv<br/>import random<br/>import time<br/><br/>x_value = 0<br/>total_1 = 1000<br/>total_2 = 1000<br/><br/>fieldnames = ["x_value", "total_1", "total_2"]<br/><br/><br/>with open('data.csv', 'w') as csv_file:<br/>    csv_writer = csv.DictWriter(csv_file, fieldnames=fieldnames)<br/>    csv_writer.writeheader()<br/><br/>while True:<br/><br/>    with open('data.csv', 'a') as csv_file:<br/>        csv_writer = csv.DictWriter(csv_file, fieldnames=fieldnames)<br/><br/>        info = {<br/>            "x_value": x_value,<br/>            "total_1": total_1,<br/>            "total_2": total_2<br/>        }<br/><br/>        csv_writer.writerow(info)<br/>        print(x_value, total_1, total_2)<br/><br/>        x_value += 1<br/>        total_1 = total_1 + random.randint(-6, 8)<br/>        total_2 = total_2 + random.randint(-5, 6)<br/><br/>    time.sleep(1)</span></pre><p id="9de1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我使用CSV模块打开一个CSV文件，添加三列X_value、total_1和total_2，现在在一个无限while循环中，使用csv_writer将这些值追加到CSV文件中，最后，我将x_value的值加1，将随机值添加到total_1和total_2。</p><p id="b06f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们将在代码中读取CSV并绘制数据。</p><pre class="jd je jf jg fd jh ji jj bn jk jl bi"><span id="1253" class="jm jn hi ji b be jo jp l jq jr">import random<br/>from itertools import count<br/>import pandas as pd<br/>import matplotlib.pyplot as plt<br/>from matplotlib.animation import  FuncAnimation<br/><br/>plt.style.use('fivethirtyeight')<br/><br/><br/>index = count()<br/><br/>def animate(i):<br/>    data = pd.read_csv('data_random.csv')<br/>    x = data['x_value']<br/>    y1 = data['total_1']<br/>    y2 = data['total_2']<br/>    plt.cla()<br/>    plt.plot(x,y1,label = 'Label 1')<br/>    plt.plot(x,y2,label = 'Label 2')<br/>    plt.legend()<br/><br/>ani = FuncAnimation(plt.gcf(),animate,interval=1000)<br/><br/>plt.tight_layout()<br/>plt.show()</span></pre><figure class="jd je jf jg fd jt er es paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="er es ka"><img src="../Images/0e5a0bdb0402323ed5433106793374a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p_I9AHek_fi26Hg5eVUPcg.png"/></div></div></figure><p id="06f5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面是代码和数据表的GitHub链接。</p><p id="8a50" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae kb" href="https://github.com/vivalka/Matplotlib-Tutorials/tree/main/Tutorial_9" rel="noopener ugc nofollow" target="_blank">https://github . com/vival ka/Matplotlib-Tutorials/tree/main/Tutorial _ 9</a></p><p id="0e0a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在下一个教程将涵盖子图。</p></div></div>    
</body>
</html>