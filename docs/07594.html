<html>
<head>
<title>React: How to create and use custom hooks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React:如何创建和使用定制钩子</h1>
<blockquote>原文：<a href="https://medium.com/codex/react-how-to-create-and-use-custom-hooks-aab531e5ddf9?source=collection_archive---------9-----------------------#2022-06-19">https://medium.com/codex/react-how-to-create-and-use-custom-hooks-aab531e5ddf9?source=collection_archive---------9-----------------------#2022-06-19</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="7256" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">钩子是React中执行各种任务的内置函数。例如，<code class="du jd je jf jg b">useState()</code>挂钩用于存储和设置组件中的值，而<code class="du jd je jf jg b">useEffect()</code>挂钩会在依赖数组中的任何值发生变化时导致组件重新呈现，等等。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es jh"><img src="../Images/13c28873176b6cc51ed71ebfd2a3ce02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WB88t0lXIjtM3cxxrX29QA.png"/></div></div></figure><p id="0c5c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">不包含复杂功能的简单spa不需要后端服务器。例如，如果你设计了一个应用程序来跟踪用户的工资和支出，并计算他们的税收，React应用程序本身可以为你计算。</p><pre class="ji jj jk jl fd jt jg ju jv aw jw bi"><span id="6cf5" class="jx jy hi jg b fi jz ka l kb kc">💡 <em class="kd">SPA = Single Page Application</em></span></pre><p id="458e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是，因为React主要是一个前端框架，任何后端逻辑似乎都不适合它的架构，显然您应该避免代码重复之类的代码味道——这就是定制钩子的用武之地。</p><p id="4cca" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在你的应用中使用定制钩子的<strong class="ih hj">主要原因</strong>是当你需要<strong class="ih hj">开发带有生成<strong class="ih hj">有价值数据</strong>的逻辑的模块</strong>时。与实际产品密切相关的逻辑<strong class="ih hj">的输出在这里被称为“有价值的”。</strong></p><p id="3eb6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">例如，如果您从数据数组中过滤出一些元素，您可以在组件标题中使用它:</p><pre class="ji jj jk jl fd jt jg ju jv aw jw bi"><span id="9643" class="jx jy hi jg b fi jz ka l kb kc">❗️ <strong class="jg hj">THIS IS NOT PRODUCT LOGIC, THIS IS SIMPLE UI LOGIC</strong></span><span id="784c" class="jx jy hi jg b fi ke ka l kb kc">const Component = () =&gt; {</span><span id="a8fc" class="jx jy hi jg b fi ke ka l kb kc">  const data = fetched data...<br/>  const filteredData = data.filter(item =&gt; item.id)</span><span id="7858" class="jx jy hi jg b fi ke ka l kb kc">  return(<br/>    &lt;div&gt;<br/>      {filteredData.map(item =&gt; (<br/>        &lt;p&gt;{item.name}&lt;/p&gt;<br/>      ))}<br/>    &lt;/div&gt;<br/>  )<br/>}</span><span id="2219" class="jx jy hi jg b fi ke ka l kb kc">export default Component</span></pre><p id="df2f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是，如果您需要获取某些用户数据，比如收入和支出，并将其转换为税收数据，就像上面的例子一样，这将是产品逻辑，您需要使用自定义挂钩。</p><p id="c7fa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，把你的定制钩子放在你的应用程序的架构中。对我来说，理想的位置是:</p><pre class="ji jj jk jl fd jt jg ju jv aw jw bi"><span id="1f2b" class="jx jy hi jg b fi jz ka l kb kc">src/hooks</span></pre><p id="8496" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在创建您的第一个自定义钩子文件，它将为您计算税款:</p><pre class="ji jj jk jl fd jt jg ju jv aw jw bi"><span id="435c" class="jx jy hi jg b fi jz ka l kb kc">src/hooks/useTax.ts</span></pre><p id="02fb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当然，我们将在这里使用TypeScript。你的定制钩子将看起来像任何其他函数React文件，除了它不返回JSX，它将返回数据。</p><pre class="ji jj jk jl fd jt jg ju jv aw jw bi"><span id="5226" class="jx jy hi jg b fi jz ka l kb kc">💡 <em class="kd">JSX = JavaScript XML, it allows us to write HTML in React</em></span></pre><p id="06cd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下一步是构建<code class="du jd je jf jg b">useTax()</code>钩子的基本框架:</p><pre class="ji jj jk jl fd jt jg ju jv aw jw bi"><span id="a183" class="jx jy hi jg b fi jz ka l kb kc">✅ <strong class="jg hj">THIS WILL BE YOUR PRODUCT LOGIC, SHOULD BE IN THE CUSTOM HOOK</strong></span><span id="9249" class="jx jy hi jg b fi ke ka l kb kc">const useTax = () =&gt; {<br/>  type Taxes = {<br/>    federal: number,<br/>    medicare: number,<br/>    socialSecurity: number<br/>  }<br/>  const [result, setResult] = useState&lt;Taxes | null&gt;(null)<br/>  return result<br/>}</span><span id="374f" class="jx jy hi jg b fi ke ka l kb kc">export default useTax</span></pre><p id="1384" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们有了一个全功能的定制钩子。我们可以在任何想用的地方导入和使用，但是没有数据和逻辑是没有用的，所以我们来补充一些数据和计算:</p><pre class="ji jj jk jl fd jt jg ju jv aw jw bi"><span id="34fd" class="jx jy hi jg b fi jz ka l kb kc">✅ <strong class="jg hj">THIS IS YOUR FINAL PRODUCT LOGIC, SHOULD BE IN THE CUSTOM HOOK</strong></span><span id="80e5" class="jx jy hi jg b fi ke ka l kb kc">const useTax = () =&gt; {<br/>  type Taxes = {<br/>    federal: number,<br/>    medicare: number,<br/>    socialSecurity: number<br/>  }<br/>  const [result, setResult] = useState&lt;Taxes | null&gt;(null)</span><span id="99fb" class="jx jy hi jg b fi ke ka l kb kc">  const incomes = fetch incomes...<br/>  const expenses = fetch expenses...</span><span id="d534" class="jx jy hi jg b fi ke ka l kb kc">  useEffect(() =&gt; {<br/>    if (!incomes || !expenses) return setResult(null)<br/>    const federal = calculate federal tax...<br/>    const medicare = calculate medicare tax...<br/>    const socialSecurity = calculate social security tax...<br/>    setResult({ federal, medicare, socialSecurity })<br/>  }, [incomes, expenses])</span><span id="1a2a" class="jx jy hi jg b fi ke ka l kb kc">  return result<br/>}</span><span id="ac66" class="jx jy hi jg b fi ke ka l kb kc">export default useTax</span></pre><p id="6a8a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这就是全部了。您可以在任何组件中单独使用导入的钩子，因为它负责获取数据，计算不同的值，并用<code class="du jd je jf jg b">useEffect()</code>更新它们。</p><pre class="ji jj jk jl fd jt jg ju jv aw jw bi"><span id="5bae" class="jx jy hi jg b fi jz ka l kb kc">✅ <strong class="jg hj">NONE OF THE PRODUCT LOGIC IMPLEMENTED IN THE UI COMPONENT</strong></span><span id="6506" class="jx jy hi jg b fi ke ka l kb kc">import useTax from "../hooks/useTax"</span><span id="b1d5" class="jx jy hi jg b fi ke ka l kb kc">const Component = () =&gt; {</span><span id="7b3d" class="jx jy hi jg b fi ke ka l kb kc">  const taxes = useTax()</span><span id="3f8b" class="jx jy hi jg b fi ke ka l kb kc">  return(<br/>    &lt;div&gt;<br/>      &lt;p&gt;Federal tax: {taxes.federal} USD&lt;/p&gt;<br/>      &lt;p&gt;Medicare tax: {taxes.medicare} USD&lt;/p&gt;<br/>      &lt;p&gt;Social security tax: {taxes.socialSecurity} USD&lt;/p&gt;<br/>    &lt;/div&gt;<br/>  )</span><span id="cd84" class="jx jy hi jg b fi ke ka l kb kc">}</span><span id="11d7" class="jx jy hi jg b fi ke ka l kb kc">export default Component</span></pre></div><div class="ab cl kf kg gp kh" role="separator"><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk"/></div><div class="hb hc hd he hf"><p id="ccd3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">👋我希望这篇文章对你寻找新的学习材料有用。感谢您花时间阅读这篇文章！</p><p id="b1d3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你可以请我喝杯咖啡来支持我:https://www.buymeacoffee.com/daanworks</p><p id="d646" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">📯订阅我的电子邮件列表，如果你想在未来读到更多这样的故事，请在这里或在Twitter上关注我！</p></div></div>    
</body>
</html>