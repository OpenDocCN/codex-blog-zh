# ç”¨ Webpack5 å°† Monolith Laravel + VueJS åˆ†éš”ä¸ºåç«¯å’Œå‰ç«¯

> åŸæ–‡ï¼š<https://medium.com/codex/separating-monolith-laravel-vuejs-to-backend-and-frontend-with-webpack5-e34956b936d1?source=collection_archive---------0----------------------->

![](img/7629faf988b4eb93236751402b591867.png)

ä»æ•´ä½“åˆ°åç«¯â€”å‰ç«¯çš„å»è€¦

æˆ‘ä»¬åœ¨[ç‰¹ä¼¦æˆˆ](https://trengo.com)å†³å®šå°† Monolith æ¶æ„åˆ†ä¸ºåç«¯å’Œå‰ç«¯ï¼Œæˆ‘å¾ˆè£å¹¸è¿™æ ·åšã€‚å½“ç„¶è¿™å–å†³äºé¡¹ç›®çš„æ½œåŠ›ï¼Œæˆ‘ç›¸ä¿¡äº†è§£æˆ‘ä»¬å¦‚ä½•å‘ç°å…”å­æ´ä»¥åŠå¦‚ä½•è§£å†³å®ƒä»¬æ˜¯å¾ˆæœ‰ç”¨çš„ã€‚
æˆ‘æ˜¯å°¼ç›ï¼Œæ¬¢è¿æ¥åˆ°æˆ‘çš„åšå®¢ã€‚

# é—®é¢˜æ˜¯

è¿™å–å†³äºä½ å’Œä½ çš„å›¢é˜Ÿç»“æ„æ¥å¤„ç† Monolith æ¶æ„æˆ–åç«¯å‰ç«¯æˆ–å¾®å‰ç«¯ç­‰ã€‚æˆ‘ä¸æ‰“ç®—è§£é‡Šåˆ©å¼Šï¼Œä½†å¦‚æœä½ å†³å®šå°†ä½ çš„ Laravel+Vuejs Monolith åˆ†æˆåç«¯å’Œå‰ç«¯ï¼Œè¿™å°†æ˜¯ä¸€ç¯‡é€‚åˆä½ çš„å¥½æ–‡ç« ã€‚
å¦‚æœä½ æœ‰ä¸€ä¸ªæ•´ä½“æ¶æ„ï¼Œå¾ˆå¯èƒ½ä½ æœ‰ä¸€ä¸ªä¼šåœ¨å¤§å›¢é˜Ÿä¸­å¼•èµ·æ··ä¹±çš„å•ä¸€æŠ¥å‘Šã€‚ä» CI/CD å’ŒæŠ€æœ¯è§’åº¦æ¥çœ‹ï¼Œæ‹¥æœ‰å•ç‹¬çš„å­˜å‚¨åº“å°†éå¸¸æœ‰å¸®åŠ©ã€‚

# è§£å†³æ–¹æ³•

ä½ ä¼šæœç´¢çš„ç¬¬ä¸€ä¸ªçŸ­è¯­æ˜¯â€œ[æˆ‘èƒ½æŠŠ Vue.js å‰ç«¯å’Œ Laravel åç«¯å®Œå…¨åˆ†å¼€å—](https://laracasts.com/discuss/channels/laravel/can-i-completely-separate-vuejs-front-end-to-laravel-back-end)â€ï¼Œç­”æ¡ˆæ˜¯â€œå¯ä»¥â€ï¼Œä½†æ˜¯æ€ä¹ˆåšå‘¢ï¼Ÿ
æˆ‘ä»¬æ‰¾åˆ°äº†å››ç§è§£å†³æ–¹æ¡ˆ:
ç”¨ **Webpack5** åˆ†ç¦»â€”ç”¨ Vite åˆ†ç¦»â€”ç”¨ **Webpack4** åˆ†ç¦»â€”ç”¨ **Laravel-mix** æœ¬èº«åˆ†ç¦»ã€‚
è¿™é‡Œæœ‰åˆ©å¼Šï¼Œæˆ‘ä¼šè§£é‡Šæˆ‘ä»¬ä¸ºä»€ä¹ˆé€‰æ‹© Webpack5ï¼Œä½†è¿™å®Œå…¨å–å†³äºä½ ã€‚

## æ‹‰å‹’ç»´å°”-ç±³å…‹æ–¯

å½“æˆ‘ä»¬ä¸æ‰“ç®—ä½¿ç”¨å…¶ä¸­çš„å¤§éƒ¨åˆ†åŠŸèƒ½æ—¶ï¼Œç”¨ Laravel-mix åˆ†ç¦» Monolith æ¶æ„æ˜¯æ²¡æœ‰ç”¨çš„ã€‚Laravel-Mix æ˜¯éå¸¸å¼ºå¤§çš„ï¼Œåªæœ‰å½“ä½ æ‰“ç®—ç”¨ Laravel å¼€å‘ä¸€ä¸ªæ•´ä½“åº”ç”¨ç¨‹åºçš„æ—¶å€™ã€‚å¤§é‡çš„ Webpack é…ç½®ï¼Œè¿™æ˜¯éå¸¸è€—æ—¶çš„é…ç½®ï¼Œè€Œä¸”ä½ ä¸èƒ½åœ¨å°†æ¥è‡ªå·±å°†ä½ çš„ Webpack ç‰ˆæœ¬ä» 4 å‡çº§åˆ° 5 æˆ– 5 åˆ° 6ï¼Œç›´åˆ° Laravel-Mix ç»™å‡ºæ›´æ–°ï¼Œè¿™æ„å‘³ç€ä½ ä¸èƒ½ç”¨æœ€æ–°çš„æŠ€æœ¯æ›´æ–°ã€‚

## **ç½‘ç»œåŒ… 4**

ç”¨ Laravel-Mix ä»£æ›¿ Webpack æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„è§£å†³æ–¹æ¡ˆï¼Œä½†æ˜¯ç”¨å“ªä¸ªç‰ˆæœ¬å‘¢ï¼Ÿæ­£å¦‚ Webpack æ‰€è¯´ï¼Œå¦‚æœä½ æƒ³æ‹¥æœ‰ä¸€ä¸ªå¯æ‰§è¡Œçš„åº”ç”¨ç¨‹åºï¼Œè¯·å§‹ç»ˆå°è¯•ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬ã€‚Webpack 4 å¯¹æ¨¡å—è”åˆç­‰æ–°æŠ€æœ¯æœ‰å¤ªå¤šçš„å¹²æ‰°ï¼Œsass-loader@11.0.0 å’Œ vue@2.6.12 ä¹‹é—´çš„å†²çªä¼šæŠ›å‡º this.getOptions()åœ¨ Webpack 5 ä¸­å¤„ç†çš„é”™è¯¯ï¼Œç­‰ç­‰â€¦â€¦å¦‚æœä½ å…³å¿ƒåº”ç”¨ç¨‹åºæ›´æ–°ï¼Œæˆ‘å¼ºçƒˆå»ºè®®é€‰æ‹©å…¶ä»–é€‰é¡¹ã€‚

## è½»å¿«åœ°

ä¹Ÿè®¸ä½ å¬è¯´è¿‡ [Vite](https://vitejs.dev) ï¼Œ

> Vite æ˜¯ä¸€ä¸ªæ„å»ºå·¥å…·ï¼Œæ—¨åœ¨ä¸ºç°ä»£ web é¡¹ç›®æä¾›æ›´å¿«ã€æ›´ç²¾ç®€çš„å¼€å‘ä½“éªŒ

æˆ‘å¯¹ Vite æœ‰å¾ˆå¥½çš„ä½“éªŒï¼Œå®ƒå¸®åŠ©æˆ‘å¾ˆè½»æ¾åœ°é…ç½®æˆ‘çš„åº”ç”¨ç¨‹åºã€‚ä½†æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬çš„ Vue é¡¹ç›®æ²¡æœ‰é€‰æ‹©å®ƒå‘¢ï¼Ÿ

> æ³¨æ„:å¦‚æœä½ æœ‰ä¸€ä¸ªè·¯çº¿åˆ—è¡¨ã€‚js å®ƒå°†å°è¯•åœ¨å¼€å‘æ¨¡å¼ä¸‹å»ºç«‹æ‰€æœ‰çš„è·¯çº¿ï¼Œå–å†³äºä½ çš„é¡¹ç›®ï¼Œè¿™å°†éœ€è¦å¾ˆå¤šåˆ†é’Ÿã€‚

Vite è¿˜ä¸æˆç†Ÿï¼Œä½ ä¸èƒ½æŒ‡æœ›å®ƒè¿›å…¥ç”Ÿäº§æ¨¡å¼(2022)ã€‚ä½ ä¸èƒ½å¦è®¤ Vite çš„æ€§èƒ½ï¼Œä½†å¯¹äºé—ç•™ä»£ç å’Œç»“æ„ï¼Œä½ å°†é¢ä¸´ä¸€äº›æ›´å¤§çš„é—®é¢˜ã€‚å¦‚æœæ‚¨æƒ³äº«å—å®ƒçš„å¼ºå¤§åŠŸèƒ½ï¼Œä½¿ç”¨åŠ¨æ€å¯¼å…¥æ¥å¸®åŠ©ä»£ç æ‹†åˆ†å’Œ SplitChunk ä¼šæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æŠ€å·§ã€‚é‰´äº Vite å¦‚æ­¤å¼ºå¤§ï¼Œå®ƒä¸é€‚åˆæˆ‘ä»¬çš„é¡¹ç›®å’Œé—ç•™ç»“æ„ï¼Œä½†å¦‚æœæˆ‘æƒ³ä»å¤´å¼€å§‹ä¸€ä¸ªæ–°é¡¹ç›®ï¼Œæˆ‘è‚¯å®šä¼šä½¿ç”¨ Viteã€‚

# ç½‘ç»œåŒ… 5

ä»¤äººæ¬£æ…°çš„æ˜¯æœ‰å„ç§å„æ ·çš„å›¾ä¹¦é¦†å¯ä¾›é€‰æ‹©ã€‚Webpack 5 æ˜¯åŸºäºæˆ‘ä»¬é¡¹ç›®çš„æœ€å¥½çš„åº“ï¼Œè¿™æ˜¯ä¸€ä¸ªå¤§é¡¹ç›®ï¼Œåœ¨ Laravel-Mix ä¸Šæœ‰å¾ˆå¤šé…ç½®ï¼Œéœ€è¦è¿ç§»åˆ°æ–°çš„ bundlerã€‚
æˆ‘ä»¬ä¸ä¼šå¯¹ PostCss æˆ–æ†ç»‘ router.js æœ‰ä»»ä½•é—®é¢˜ï¼Œå½“ç„¶ï¼ŒWebpack HMR(çƒ­æ¨¡å—é‡æ–°åŠ è½½)ä¸æ˜¯å¾ˆå¿«ï¼Œå› ä¸ºå®ƒä½¿ç”¨ socket.js ä½¿å…¶å®æ—¶ï¼Œä½†æˆ‘ä¼šå‘æ‚¨å±•ç¤ºå®ƒæ¯” Laravel-Mix 5 å¿«ä¸¤å€ã€‚

# é€æ­¥åœ°

æ˜¯æ—¶å€™æ·±å…¥ä»£ç å¹¶æ‰¾åˆ°å…”å­æ´äº†ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å¿…é¡»æ‰¾åˆ°æ‰€æœ‰çš„æŒ‘æˆ˜ï¼Œæ‰¾åˆ°è§£å†³å®ƒä»¬çš„æ–¹æ³•ã€‚æˆ‘ä¼šæ ¹æ®æˆ‘çš„ç»éªŒåˆ—ä¸¾ä¸€äº›å¯èƒ½æ€§ã€‚

## æˆ‘æ­£åœ¨ä½¿ç”¨ Laravel è·¯çº¿ï¼Œè€Œä¸æ˜¯ä¼‘æ¯

æˆ‘å¼ºçƒˆå»ºè®®é¦–å…ˆè¿ç§»åˆ° RESTï¼Œè¿™æ˜¯è¿ç§»ä¸­æœ€é‡è¦çš„éƒ¨åˆ†ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªâ€œ/authenticate/loginâ€è·¯ç”±æ¥å¤„ç†ç”¨æˆ·ç™»å½•è¿‡ç¨‹ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæœ€å¥½çš„æ–¹æ³•æ˜¯å°†å…¶è¿ç§»åˆ°â€œ/api/authenticate/loginâ€ä¸­ï¼Œè¯¥è·¯ç”±å°†æ¥å— JSON å‚æ•°å¹¶å“åº” JSONã€‚å¦‚æœæ‚¨çš„æ•´ä¸ªåº”ç”¨ç¨‹åºæ²¡æœ‰å¤„äº REST çŠ¶æ€ï¼Œé‚£ä¹ˆè®©æˆ‘ä»¬åœ¨æ‚¨çš„ä»»åŠ¡ç®¡ç†ç³»ç»Ÿä¸­åˆ›å»ºä¸€ä¸ªå¸¦æœ‰â€œcriticalâ€æ ‡è®°çš„é‡æ„å¡ã€‚

## æˆ‘æœ‰ä¸€ä¸ªâ€œindex.blade.phpâ€è€Œä¸æ˜¯ index.html

æˆ‘ä»¬å°†ç¨åç”¨ Webpack å¤„ç†å®ƒï¼Œå”¯ä¸€çš„äº‹æƒ…æ˜¯å°†æ•´ä¸ªæ–‡ä»¶å¤åˆ¶/ç²˜è´´åˆ°ä¸€ä¸ªæ–°çš„ index.html ä¸­ï¼Œå°±æ˜¯è¿™æ ·ï¼Œè®© Webpack å¤„ç†å®ƒã€‚

## å¦‚ä½•å¤„ç†ç¯å¢ƒï¼Ÿ

æ‰€æœ‰â€œenvâ€å˜é‡å°†ä»â€œimport.meta.EnvNameâ€æ›´æ”¹ä¸ºâ€œprocess.env.EnvNameâ€ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å¿…é¡»æ›¿æ¢æ‰€æœ‰å˜é‡å¹¶åˆ›å»ºä¸€ä¸ªâ€ã€‚envâ€æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«æ‰€éœ€çš„å˜é‡ã€‚

## â€œè¿›å£â€æ–¹å¼å‘¢ï¼Ÿ

ä»…æ›¿æ¢â€œå¯¼å…¥(â€¦)â€ã€‚é»˜è®¤â€œwithâ€è¦æ±‚(â€¦)ã€‚â€œé»˜è®¤â€ã€‚

## æˆ‘ä»¬çš„ä»£ç åº“ä¼šæ”¹å˜å—ï¼Ÿ

å½“ç„¶ä¸æ˜¯ï¼Œå¦‚æœä½ æœ‰ä¸€ä¸ªæ ‡å‡†çš„ä»£ç åº“ï¼Œä½ å°±ä¸ä¼šæœ‰é—®é¢˜ã€‚

# å¦‚ä½•åœ¨ Vuejs 2 ä¸Šé…ç½® Webpack5ï¼Ÿ

è¿™éå¸¸ç®€å•ï¼Œæˆ‘å¼ºçƒˆå»ºè®®å°†â€œå¼€å‘â€å’Œâ€œç”Ÿäº§â€é…ç½®åˆ†ç¦»ï¼Œè¿™æ ·æ‚¨å°±å¯ä»¥æ›´å¥½åœ°æ§åˆ¶æ¯ä¸ªç¯å¢ƒé…ç½®ã€‚è¿™ä¸¤ä¸ªç¯å¢ƒä¹‹é—´æœ‰å†²çªæ˜¯å¾ˆå¸¸è§çš„ã€‚
è®©æˆ‘ä»¬ä»åˆ›å»ºä¸€ä¸ªåä¸ºä½ çš„åº”ç”¨ç¨‹åºçš„æ–°ç›®å½•å¼€å§‹ï¼Œå¹¶åˆ›å»ºå¦‚ä¸‹çš„ç›®å½•ç»“æ„:

```
.
|-- README.md
|-- package.json
|-- public
|-- src
-- webpack
    |-- paths.js
    |-- webpack.common.js
    |-- webpack.config.dev.js
    `-- webpack.config.prod.js
```

æ˜¯æ—¶å€™å®‰è£…ä¾èµ–é¡¹äº†ã€‚

```
npm i -D @webpack-cli/serve clean-webpack-plugin compression-webpack-plugin copy-webpack-plugin css-minimizer-webpack-plugin dotenv-webpack html-webpack-plugin optimize-css-assets-webpack-plugin speed-measure-webpack-plugin terser-webpack-plugin webpack webpack-bundle-analyzer webpack-cli webpack-dev-server webpack-hot-middleware webpack-merge css-loader vue-loader esbuild-loader 
```

æˆ‘è¯•ç€å®‰è£…äº†æ‰€æœ‰çš„ devDependenciesï¼Œå¦‚æœå…¶ä¸­ä¸€äº›æ²¡æœ‰å®‰è£…ï¼Œæˆ‘ä»¬ä¼šç»§ç»­å®‰è£…ã€‚
ç°åœ¨æˆ‘ä»¬æ¥çœ‹çœ‹â€œwebpack.common.jsâ€æ˜¯ä»€ä¹ˆæ ·å­çš„ã€‚

å®ƒå¤ªé•¿äº†ï¼Œæ˜¯çš„ï¼Œæˆ‘çŸ¥é“ï¼Œæˆ‘ä¸æ‰“ç®—è§£é‡ŠåŠ è½½å™¨ï¼Œå› ä¸ºä½ å¯ä»¥åœ¨ Medium æˆ–ä»–ä»¬çš„ Git åº“ä¸­æ‰¾åˆ°å®ƒä»¬ï¼Œå› æ­¤ï¼Œå¦‚æœæœ‰å¿…è¦ï¼Œæˆ‘è¯•å›¾æ·»åŠ æ³¨é‡Šï¼Œä½†è®©æˆ‘ä»¬å¿«é€Ÿå›é¡¾ä¸€ä¸‹ã€‚

**SpeedMeasurePlugin** :è¿™ä¸ªæ’ä»¶å°†å¸®åŠ©æˆ‘ä»¬æµ‹é‡ Webpack çš„æ€§èƒ½ã€‚æ‰¾å‡ºå“ªä¸€ä¸ªåŠ è½½ç¨‹åºç¼ºä¹æ€§èƒ½æ˜¯éå¸¸æœ‰ç”¨çš„ã€‚æˆ‘ä»¬åº”è¯¥ç”¨å®ƒæ¥åŒ…è£…æˆ‘ä»¬çš„é…ç½®ã€‚

æ¡ç›®:æ¡ç›®åº”è¯¥æŒ‡å‘è¿è¡Œ Vuejs åº”ç”¨ç¨‹åºçš„ä¸» javascript æ–‡ä»¶ã€‚

**æä¾›æ’ä»¶**:

> è‡ªåŠ¨åŠ è½½æ¨¡å—ï¼Œè€Œä¸æ˜¯åˆ°å¤„`import`æˆ–`require`å®ƒä»¬ã€‚

å¦‚æœæ‚¨æ­£åœ¨ä½¿ç”¨ä¸€ä¸ªä¸‹åˆ’çº¿åº“ï¼Œå¦‚â€œlodashâ€æˆ–â€œJquery â€,å®ƒæœ‰ä¸€ä¸ªç‰¹æ®Šçš„è¯­æ³•ï¼Œå¯¹äº Webpack æ¥è¯´æ˜¯ä¸å¸¸è§çš„ï¼Œå¹¶ä¸”æ²¡æœ‰å¯¼å…¥åˆ°æ–‡ä»¶ä¸­ï¼Œé‚£ä¹ˆæ‚¨å¿…é¡»åœ¨è¿™ä¸ªæ’ä»¶ä¸­æä¾›å®ƒä»¬ã€‚

è¿™ä¸ªæ’ä»¶å¯¹æˆ‘ä»¬æ¥è¯´éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºæˆ‘ä»¬æœ‰æ¥è‡ªâ€œLaravelâ€çš„â€œpublicâ€æ–‡ä»¶å¤¹ï¼Œåœ¨è§£è€¦åæˆ‘ä»¬å°†éœ€è¦å®ƒã€‚å¦‚æ‚¨æ‰€çŸ¥ï¼ŒLaravel-mix å·²ç»â€œå…¬å¼€â€è¿æ¥åˆ°â€œVuejsâ€åº”ç”¨ç¨‹åºã€‚å› æ­¤ï¼Œåœ¨è¿ç§»åï¼Œæ²¡æœ‰ä¸€ä¸ªå›¾åƒæˆ–ä»»ä½•èµ„äº§ä¼šæ­£ç¡®åŠ è½½ï¼Œå› ä¸º Webpack æ— æ³•è®¿é—®â€œpublicâ€æ–‡ä»¶å¤¹(åœ¨æ–‡ä»¶å¤¹èŒƒå›´ä¹‹å¤–)ï¼Œè¯¥æ’ä»¶å°†å°è¯•å»ºç«‹æ­¤è¿æ¥ã€‚

**ESBuild** :æ˜¯æ—¶å€™ç”¨ ES-build æ›¿æ¢ babel-loader æ¥åŠ é€Ÿæˆ‘ä»¬çš„ Webpack æ„å»ºäº†ã€‚ä¸å†è§£é‡Šï¼Œæˆ‘ä»¬æ¥çœ‹æ–‡æ¡£:[https://github.com/privatenumber/esbuild-loader](https://github.com/privatenumber/esbuild-loader)

æˆ‘ä»¬ç°åœ¨å¾ˆå¥½ï¼Œè®©æˆ‘ä»¬ç»§ç»­å‘å±•ã€‚å®ƒæ˜¯å¦‚æ­¤ç®€å•ã€‚

å› ä¸ºå¤ªç®€å•äº†ï¼Œæˆ‘åªæƒ³è§£é‡Šä¸€ä¸‹ HotModuleReplacementPlugin å’Œ source-mapã€‚

**HotModuleReplacementPlugin**:æˆ–è€… HMR æ˜¯ä¸€ä¸ªæ’ä»¶ï¼Œå½“æˆ‘ä»¬åœ¨ IDE ä¸­ä¿å­˜æˆ‘ä»¬çš„æ›´æ”¹æ—¶ï¼Œå®ƒä¼šé‡æ–°åŠ è½½é¡µé¢ï¼Œä¸å…¶ä»–è§‚å¯Ÿå™¨ç›¸å…³çš„å¥½å¤„æ˜¯çŠ¶æ€æŒä¹…æ€§ï¼Œè¿™æ„å‘³ç€æ¯æ¬¡é‡æ–°åŠ è½½åï¼Œæ‚¨çš„çŠ¶æ€éƒ½ä¼šä¿æŒï¼Œå› ä¸ºæ’ä»¶åªä¼šé‡æ–°åŠ è½½ç‰¹å®šçš„å’Œç›¸å…³çš„ DOMã€‚

**devtool** :å¯èƒ½ä¸€å¼€å§‹å¹¶ä¸æ˜¯é‚£ä¹ˆæ¸…æ¥šã€‚è®©æˆ‘ä»¬çœ‹çœ‹ Webpack æ–‡æ¡£ä¸­çš„ Devtool æ˜¯ä»€ä¹ˆã€‚

> `source-map-loader`ä»æ‰€æœ‰ JavaScript æ¡ç›®ä¸­æå–ç°æœ‰çš„æºæ˜ å°„ã€‚è¿™æ—¢åŒ…æ‹¬å†…åµŒçš„æºåœ°å›¾ï¼Œä¹ŸåŒ…æ‹¬é€šè¿‡ URL é“¾æ¥çš„æºåœ°å›¾ã€‚æ‰€æœ‰çš„æºåœ°å›¾æ•°æ®éƒ½ä¼ é€’ç»™ webpackï¼ŒæŒ‰ç…§ [webpack.config.js](https://webpack.js.org/configuration/) ä¸­`devtool`é€‰é¡¹æŒ‡å®šçš„[æºåœ°å›¾æ ·å¼](https://webpack.js.org/configuration/devtool/)è¿›è¡Œå¤„ç†ã€‚

æœ€å¸¸ç”¨çš„æ˜¯åœ¨æµè§ˆå™¨ä¸­è°ƒè¯•ä»£ç ï¼Œæºæ˜ å°„è¿˜ä¸æ˜¯å¯è½¬æ¢çš„ï¼Œä½ å¯ä»¥åœ¨å…¶ä¸­çœ‹åˆ°ä½ çš„ Vuejs ä»£ç ï¼Œæ‰¾åˆ°å“ªä¸ªéƒ¨åˆ†æœ‰ bugã€‚å› ä¸ºå®ƒä¼šé™ä½æ€§èƒ½ï¼Œæ‰€ä»¥æœ€ä½³å®è·µæ˜¯åªè®©å®ƒå¤„äºå¼€å‘æ¨¡å¼ã€‚ä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°ä¸åŒæ¥æºåœ°å›¾çš„åˆ—è¡¨:[https://webpack.js.org/configuration/devtool/](https://webpack.js.org/configuration/devtool/)

æˆ‘æ›´å–œæ¬¢ä½¿ç”¨â€œå†…è”æºä»£ç å›¾â€,å®ƒä¼šç»™æˆ‘è¶³å¤Ÿçš„ç»†èŠ‚ï¼Œå¹¶ä¼šå¢åŠ æˆ‘åœ¨å¼€å‘æ¨¡å¼ä¸‹çš„æ„å»ºå’Œé‡å»ºæ—¶é—´ã€‚

ç”Ÿäº§è¿™ä¹ˆåˆºæ¿€ï¼Ÿæ‰€ä»¥æˆ‘ä»¬èµ°å§ã€‚

é¦–å…ˆï¼Œæ‚¨ä¼šçœ‹åˆ° devtool æ˜¯å‡çš„ï¼Œåœ¨ç”Ÿäº§ä¸­ä¸æä¾›å¯è°ƒè¯•ç‰ˆæœ¬æ˜¯æœ‰æ„ä¹‰çš„ï¼Œå› ä¸ºè¿™å°†å¢åŠ åŒ…çš„å¤§å°ã€æ„å»ºæ—¶é—´ï¼Œå¹¶ä¸”å®¢æˆ·ç«¯ä¹Ÿä¸éœ€è¦å®ƒã€‚

**splitChunks** :åœ¨ä¼˜åŒ–é˜¶æ®µï¼Œæˆ‘ä»¬ä½¿ç”¨ splitChunksï¼Œé€šè¿‡å°†æ†ç»‘åŒ…åˆ†å‰²æˆç‹¬ç«‹çš„æ¨¡å—ï¼Œ[https://webpack.js.org/plugins/split-chunks-plugin/](https://webpack.js.org/plugins/split-chunks-plugin/)

**TerserPlugin** :ä»»ä½•äººéƒ½çŸ¥é“ Terser æ’ä»¶ä¼šå½±å“æ€§èƒ½ï¼ŒTerser ä½¿ç”¨äº†å¾ˆå¤šç®—æ³•æ¥å°½å¯èƒ½åœ°å°† javascript ä»£ç ç²¾ç®€åˆ°æœ€ç²¾ç®€çš„ç‰ˆæœ¬ã€‚[https://webpack.js.org/plugins/terser-webpack-plugin/](https://webpack.js.org/plugins/terser-webpack-plugin/)

å”¯ä¸€ç•™ä¸‹çš„æ˜¯ paths.js

```
const paths = require('path')

module.exports = {
// Source files
src: paths.resolve(__dirname, '../src'),

// Production build files
build: paths.resolve(__dirname, '../dist'),

// Static files that get copied to build folder
public: paths.resolve(__dirname, '../public'),
}
```

è¿™å¤ªç®€å•äº†ï¼Œä¸éœ€è¦è§£é‡Šã€‚ğŸ˜„

å¤§éƒ¨åˆ†éƒ½å®Œæˆäº†ï¼Œè®©æˆ‘ä»¬ä¿®æ”¹æˆ‘ä»¬çš„ package.json

```
"scripts": {
  "dev": "webpack server --mode=development --config ./webpack/webpack.config.dev.js",
  "build": "webpack --mode=production --config ./webpack/webpack.config.prod.js",
  "serve:dev": "pm2 start ecosystem.config.js --env development",
  "serve:prod": "pm2 start ecosystem.config.js --env production"
},
```

å¾ˆæ˜æ˜¾ï¼Œåªæœ‰æˆ‘æƒ³è§£é‡Šä¸€ä¸‹â€œå‘çƒ:dev å’Œ prodâ€ã€‚æˆ‘æ›´å–œæ¬¢ä½¿ç”¨ PM2 ä½œä¸ºæˆ‘ä»¬çš„è¿‡ç¨‹ç®¡ç†å™¨ï¼Œå¦‚æœä½ ä¸ç†Ÿæ‚‰å®ƒï¼Œæˆ‘ä¼šå¼ºçƒˆå»ºè®®çœ‹çœ‹å®ƒçš„æ–‡æ¡£:[https://pm2.keymetrics.io/.](https://pm2.keymetrics.io/.)â€œç”Ÿæ€ç³»ç»Ÿ.é…ç½®. jsâ€æ˜¯ PM2 çš„ä¸»è¦é…ç½®æ–‡ä»¶ï¼Œç”¨äºå®šä¹‰ç”Ÿäº§æˆ–å¼€å‘çš„ä¸åŒè¡Œä¸ºï¼Œä½ å¯ä»¥é€šè¿‡è¿è¡Œâ€œserve:devâ€åœ¨æœ¬åœ°æœºå™¨ä¸Šæ£€æŸ¥æ„å»ºçš„é¡¹ç›®ï¼Œå®ƒå®é™…ä¸Šä¸ç”Ÿäº§ç›¸åŒï¼Œå°½é‡ä½¿å¼€å‘å’Œç”Ÿäº§ç¯å¢ƒç›¸åŒä»¥å‡å°‘é”™è¯¯æ˜¯éå¸¸é‡è¦çš„ã€‚

**ç”Ÿæ€ç³»ç»Ÿ. config.js**

```
module.exports = {
    script: 'serve',
env_development: {
    NODE_ENV: 'development',
    PM2_SERVE_PATH: './dist',
    PM2_SERVE_PORT: 3000,
    PM2_SERVE_SPA: 'true',
},
env_production: {
    NODE_ENV: 'production',
    PM2_SERVE_PATH: './dist',
    PM2_SERVE_PORT: 8080,
    PM2_SERVE_SPA: 'true',
},
deploy: {
        development: {
          host: ['localhost', '127.0.0.1'],
        },
        production: {
          host: ['production.domain', 'production IPAddress'],
        },
    },
};
```

# æ˜¯æ—¶å€™å¤„ç†æ•°å­—äº†

ç°åœ¨æ˜¯æ—¶å€™ç”¨å½“å‰çš„ Laravel-mix é¡¹ç›®æ¥å›é¡¾æ–° Webpack é…ç½®çš„åŸºå‡†äº†ã€‚å½“ç„¶å’Œä½ çš„é¡¹ç›®æœ‰å…³ã€‚è¿™äº›åŸºå‡†æµ‹è¯•ä¸ä¸€ä¸ªæœ‰å¾ˆå¤šæ–‡ä»¶çš„å¤§é¡¹ç›®æœ‰å…³ã€‚

**Laravel æ··éŸ³åˆ¶ä½œæ—¶é—´â€” 3.30 åˆ†é’Ÿ**

![](img/2f1b349f6ca87f6ccc688c7c3c00f50f.png)

**Webpack5 æ„å»ºæ—¶é—´â€” 1.9461 åˆ†é’Ÿ**

![](img/2265ee8ca251834ccf05dd717578678a.png)

ä½ å¯ä»¥çœ‹åˆ°å®ƒå‡ ä¹å¿«äº†ä¸¤å€ã€‚ä½†æ˜¯è¿™ä¸æ˜¯å”¯ä¸€çš„åŸºå‡†ï¼Œæˆ‘è¿˜æœ‰å¦ä¸€ä¸ªæœ‰è¶£çš„è¿è¡Œæµ‹è¯•åŸºå‡†

**Laravel-mix â€” 6.44 ç§’**

![](img/4c1ba3f707ab3a836137375aafad503e.png)

**web pack 5â€“3.318 ç§’**

![](img/cc6382496a16a1da5d6b5c1d019c3ac3.png)

ç»“æœåŒä¸Šã€‚è¿™äº›å˜åŒ–è®©æˆ‘ä»¬åœ¨ç‰¹ä¼¦æˆˆæœ‰äº†æ›´å¥½çš„è¡¨ç°ã€‚

# ç»“è®º

é€‰æ‹©æœ€å¥½çš„æ¨¡å—æ†ç»‘å™¨å–å†³äºæ‚¨çš„é¡¹ç›®ï¼Œæ²¡æœ‰ç‰¹å®šçš„æ–¹æ³•æ¥æé«˜æ‚¨çš„é¡¹ç›®æ€§èƒ½ï¼Œå¯¹äºæŸäº›é¡¹ç›®ï¼ŒLaravel-mix æ˜¯æœ€å¥½çš„ï¼Œæˆ–è€…å¯èƒ½æ˜¯ Viteã€‚æœ€é‡è¦çš„æ˜¯äº†è§£ä½ çš„é¡¹ç›®å’Œé‡Œé¢çš„å…”å­æ´ã€‚ä¾‹å¦‚ï¼Œåœ¨ Laravel Monolith é¡¹ç›®ä¸­ï¼Œå¦‚æœæ‚¨ä½¿ç”¨ç›´æ¥è·¯ç”±å™¨ï¼Œå¦‚:â€œè®¤è¯/å¿˜è®°å¯†ç â€ï¼Œæ‚¨å¿…é¡»å°†å…¶æ›´æ”¹ä¸º REST APIï¼Œå¹¶ä½¿ç”¨ JWT æˆ–å…¶ä»–åŠ å¯†å¤„ç†ä¸€åˆ‡ã€‚

**ä¸€ä»¶é‡è¦çš„äº‹æƒ…**æ˜¯å°†æ•´ä¸ª master.blade.php å¤åˆ¶åˆ°ä¸» html æ¨¡æ¿æ–°ç»“æ„ä¸­çš„â€œpublic/index.htmlâ€ä¸­ã€‚
æ²¡æœ‰åˆ«çš„äº‹è¦æï¼Œå¥½å¥½äº«å—ä½ çš„ç¼–ç å§ğŸ˜‰