<html>
<head>
<title>CI/CD for Azure Synapse Analytics Pipelines with Azure DevOps yaml pipelines (Part 1)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Azure Synapse分析管道与Azure DevOps yaml管道的CI/CD(第1部分)</h1>
<blockquote>原文：<a href="https://medium.com/codex/ci-cd-for-azure-synapse-analytics-pipelines-with-azure-devops-yaml-pipelines-ef0933b4ac4a?source=collection_archive---------3-----------------------#2022-06-29">https://medium.com/codex/ci-cd-for-azure-synapse-analytics-pipelines-with-azure-devops-yaml-pipelines-ef0933b4ac4a?source=collection_archive---------3-----------------------#2022-06-29</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="b595" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这个小故事中，我将向您展示如何使用Azure DevOps实现Synapse Analytics CI/CD管道。这也非常类似于Azure Data Factory的方法，但不是100%相同。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/cd9758cb1c7574d4280a2deb38527a51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5mD68kZCXp4v0got"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">丹尼尔·肖斯塔克在<a class="ae jt" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="b907" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="ju">与此同时，有一种新的更好的方法来实现本文的目标，你可以在这里找到更多详细信息</em> <a class="ae jt" href="https://graflinger.medium.com/new-approach-ci-cd-for-synapse-analytics-pipelines-with-azure-devops-yaml-pipelines-part-1-1-b7f73255bab5" rel="noopener"> <em class="ju">新方法——使用Azure DevOps yaml管道的Synapse分析管道的CI/CD(第1.1部分)|作者Stefan Graf | 2023年2月| Medium </em> </a></p><h2 id="ac8c" class="jv jw hi bd jx jy jz ka kb kc kd ke kf iq kg kh ki iu kj kk kl iy km kn ko kp bi translated">背景</h2><p id="9209" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">在我们开始之前，我们需要澄清一些关于CI/CD管道如何工作的基本概念。这将是Synapse Analytics提供的Azure回购集成的基础。这使我们能够将Synapse工作区连接到Azure DevOps或GitHub(企业)repos。</p><p id="c618" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您所需要做的就是通过提供关于您的回购的基本信息来创建git连接，然后您就可以开始了。这种Git集成将取代标准的“Synapse live”代码管理。此外，您需要定义两个不同的分支，协作分支(很可能是您的主分支，您的代码的最新稳定版本位于其中)和发布分支(默认情况下称为workspace_publish，这是一个由系统自动创建的分支，您的代码以ARM模板样式的方式位于其中)。</p><p id="22d5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是要注意，根据<a class="ae jt" href="https://docs.microsoft.com/en-us/azure/synapse-analytics/cicd/continuous-integration-delivery" rel="noopener ugc nofollow" target="_blank">微软文档</a>，Synapse不再是像ADF那样的纯ARM模板。这意味着我们必须使用另一种方式来部署它，因为简单地部署ARM模板将不再有效。</p><h2 id="2b34" class="jv jw hi bd jx jy jz ka kb kc kd ke kf iq kg kh ki iu kj kk kl iy km kn ko kp bi translated">CI/CD方法</h2><p id="8e89" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">如何使用Azure Synapse处理CI/CD的方法与您的标准方法有很大不同。唯一可以用来部署代码的分支是发布分支(workspace_publish)。在您完成任何更改后，当您在Synapse UI中按下publish时，将会创建/更新该分支。</p><p id="6ed5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">实际的工作分支是协作分支(主分支)，其中集成了所有的拉请求以实现新的特性。这也是你自动化出版的基础。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kv"><img src="../Images/cf70d3f6a8374b1e0b1e3ebf488a71fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P33OkvoZY9I6EOdFb_JwrQ.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">CI/CD概念突触</figcaption></figure><h1 id="7c28" class="kw jw hi bd jx kx ky kz kb la lb lc kf ld le lf ki lg lh li kl lj lk ll ko lm bi translated">Azure DevOps yaml管道</h1><h2 id="4c06" class="jv jw hi bd jx jy jz ka kb kc kd ke kf iq kg kh ki iu kj kk kl iy km kn ko kp bi translated">海峡群岛</h2><p id="3e9d" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">构建工作已经基本完成，因为一切都已经准备好作为部署就绪的解决方案。这就是为什么你只需要为了可追溯性和可重用性的目的而打包你的代码。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ln lo l"/></div></figure><h2 id="50ec" class="jv jw hi bd jx jy jz ka kb kc kd ke kf iq kg kh ki iu kj kk kl iy km kn ko kp bi translated">激光唱片</h2><p id="1d41" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">这个任务也非常简单，因为您可以使用一个名为“Synapse workspace deployment@2”的预定义任务。在这里，您只需要插入您的目标Synapse工作区，通过服务连接(订阅)进行身份验证。此外，你需要打开你的触发器来进行一个干净的构建，但是在Azure DevOps中也有一个预构建任务可以使用，名为“toggle-triggers-dev@2”。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ln lo l"/></div></figure><h2 id="a44a" class="jv jw hi bd jx jy jz ka kb kc kd ke kf iq kg kh ki iu kj kk kl iy km kn ko kp bi translated">CI/CD放在一起</h2><p id="71c9" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">现在两者都放在一个完全工作的yaml管道中。请记住，windows vm是必需的，因为我们正在使用的这些预定义任务是基于Powershell脚本的，对我来说，这些脚本在Ubuntu机器上不工作。当一个新的Synapse模板发布到我们的发布分支时，触发器总是被触发。</p><p id="4f65" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请记住，这里的一切都发生在我们的workspace_publish分支中。这意味着您的管道也需要从这个分支手动启动。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ln lo l"/></div></figure><h2 id="d4ea" class="jv jw hi bd jx jy jz ka kb kc kd ke kf iq kg kh ki iu kj kk kl iy km kn ko kp bi translated">结论</h2><p id="a44f" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">这个故事应该使您能够以一种更稳定的方式使用Synapse，并在后台运行CI/CD管道。</p></div></div>    
</body>
</html>