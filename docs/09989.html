<html>
<head>
<title>Understanding Operating System (Part 3)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">理解操作系统(第三部分)</h1>
<blockquote>原文：<a href="https://medium.com/codex/understanding-operating-system-part-3-7df85242cce5?source=collection_archive---------13-----------------------#2022-11-24">https://medium.com/codex/understanding-operating-system-part-3-7df85242cce5?source=collection_archive---------13-----------------------#2022-11-24</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="0c1c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi jd translated">从，我们理解的操作系统系列再回来。在上一篇文章中，我们详细介绍了计算机系统是如何构造和分层的，并简要介绍了Linux操作系统。在今天的节目中，我将讲述计算机系统的物理状态和内核的概念，它们是如何工作的，以及为什么它们是操作系统的重要组成部分。</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es jm"><img src="../Images/8d997b7d203fc67602007ee033c17b20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RB9oBFgwue546RwxTai-Kw.png"/></div></div><figcaption class="jy jz et er es ka kb bd b be z dx translated">图片bypixabay</figcaption></figure><h2 id="3e8f" class="kc kd hi bd ke kf kg kh ki kj kk kl km iq kn ko kp iu kq kr ks iy kt ku kv kw bi translated"><strong class="ak">概述</strong></h2><ul class=""><li id="df40" class="kx ky hi ih b ii kz im la iq lb iu lc iy ld jc le lf lg lh bi translated"><strong class="ih hj">多道程序设计&amp;硬件要求</strong></li><li id="39af" class="kx ky hi ih b ii li im lj iq lk iu ll iy lm jc le lf lg lh bi translated"><strong class="ih hj"> CPU特权模式</strong></li><li id="db1c" class="kx ky hi ih b ii li im lj iq lk iu ll iy lm jc le lf lg lh bi translated"><strong class="ih hj"> X86保护环</strong></li><li id="f2c5" class="kx ky hi ih b ii li im lj iq lk iu ll iy lm jc le lf lg lh bi translated"><strong class="ih hj">模式开关</strong></li><li id="9d2e" class="kx ky hi ih b ii li im lj iq lk iu ll iy lm jc le lf lg lh bi translated"><strong class="ih hj">中断</strong></li></ul><h2 id="a33d" class="kc kd hi bd ke kf kg kh ki kj kk kl km iq kn ko kp iu kq kr ks iy kt ku kv kw bi translated"><strong class="ak">多道程序和硬件要求</strong></h2><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es jm"><img src="../Images/e5ac573db514a2de6c9d1d8a7becd557.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*gTg-azw2vQ-6VEQo.jpg"/></div></div><figcaption class="jy jz et er es ka kb bd b be z dx translated">图片由pixabay提供</figcaption></figure><p id="49da" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">多道程序设计是同时运行多个进程。多道程序的工作原理是CPU在进程间切换的速度足够快，以使所有进程同时运行。从技术上讲，一个系统中的CPU一次只能运行一个程序(进程)。过去，CPU只能处理一个进程，但技术进步使CPU的处理速度变得非常快，这就造成了所有进程同时运行的错觉。然而，也有一些现代的CPU被编程为一次只运行一个进程。</p><p id="d746" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">功能齐全的操作系统也需要硬件才能正常运行。操作系统需要CPU内部的某些硬件要求，如中断机制、时钟和CPU特权模式。</p><h2 id="83b8" class="kc kd hi bd ke kf kg kh ki kj kk kl km iq kn ko kp iu kq kr ks iy kt ku kv kw bi translated">中断机制</h2><p id="2c79" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq ln is it iu lo iw ix iy lp ja jb jc hb bi translated">CPU中需要一种中断机制，以便在事件发生时能够抢占正在运行的进程。</p><h2 id="4acc" class="kc kd hi bd ke kf kg kh ki kj kk kl km iq kn ko kp iu kq kr ks iy kt ku kv kw bi translated">时钟</h2><p id="e90f" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq ln is it iu lo iw ix iy lp ja jb jc hb bi translated">时钟用于确定程序已经运行了多长时间。</p><h2 id="b827" class="kc kd hi bd ke kf kg kh ki kj kk kl km iq kn ko kp iu kq kr ks iy kt ku kv kw bi translated">CPU特权模式</h2><p id="c0e4" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq ln is it iu lo iw ix iy lp ja jb jc hb bi translated">CPU也有隔离内核和用户的壁垒，所以非特权用户无法访问操作系统的内核。该模块中有两种模式:管理员模式和用户模式。</p><p id="a131" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">管理员模式(内核模式)</strong></p><p id="7456" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">管理模式也称为内核模式，因为它有权直接访问内核来修改、编辑、删除和安装各种功能和进程。在这种模式下，CPU启用所有可用的指令，并赋予操作系统内核访问系统上所有内存的能力。通过给操作系统内核更多的指令和特权，内核现在可以控制整个系统的内存。</p><p id="c8e1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">用户模式</strong></p><p id="c4f9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">用户模式受到很大的限制，因为在计算机系统上有特权。用户模式与管理员模式相反，用户模式是为非管理员用户或只是临时访问计算机的客人设计的。与管理模式不同，CPU禁用所有特权指令，并且大多数直接访问系统内存的操作都受到限制。用户正在使用的程序必须对操作系统执行系统调用(SCI ),以请求内存和其他所需的系统资源。CPU内部的这个特性可以有效地隔离用户进程，防止它们干扰内核。</p><h2 id="25dd" class="kc kd hi bd ke kf kg kh ki kj kk kl km iq kn ko kp iu kq kr ks iy kt ku kv kw bi translated">X86保护环</h2><figure class="jn jo jp jq fd jr er es paragraph-image"><div class="er es lq"><img src="../Images/076b8978805b5be53a3e676cb2489d00.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/0*Eqlos-rsLGtpwgUg"/></div><figcaption class="jy jz et er es ka kb bd b be z dx translated">维基百科在CC许可下提供的图片</figcaption></figure><p id="5269" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">X86保护环也是由操作系统实施的另一组保护层，用于限制对内核内部的访问。从环0到环3总共有4个环。从图中可以看出，ring 0拥有最多的特权，从技术上来说，它位于内核级。Ring 0可以访问所有的内存，执行所有的CPU指令。环3是用户空间层，在这些限制访问的环中，它的特权最少。实际上，大多数操作系统只使用环0和环3。但是OS/2操作系统有一个例外。</p><p id="d8b7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">管理程序模式</strong></p><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es lr"><img src="../Images/bb12daf8d1550a7ffa6c1b44601b18e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lG33BdQOxQVi3L0xtD1Sxw.png"/></div></div><figcaption class="jy jz et er es ka kb bd b be z dx translated">作者图片</figcaption></figure><p id="55b5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">随着虚拟机的日益普及，虚拟机管理程序模式的使用比过去更多。管理程序模式是低于环0的额外特权级别，管理程序模式也称为环1。管理程序模式支持允许多个操作系统共享同一处理器的指令。这给我们带来了在一台计算机运行时使用多个操作系统的能力。启用虚拟机管理程序模式需要虚拟机管理程序软件。一些流行的虚拟机管理程序软件实例是Vmware和Oracle VirtualBox。</p><p id="6982" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">模式开关</strong></p><p id="c58e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">CPU根据控制计算机的用户切换用户、内核或管理程序模式。如果CPU从内核得到一个需要模式切换来执行某个进程的信号，它将执行模式切换，但是与其他CPU功能相比，模式切换功能可能是一个较慢的操作，但是这也取决于您的硬件的能力。系统中发生模式切换的另一种情况也是执行中断的结果。中断可以分为两组:</p><h2 id="409e" class="kc kd hi bd ke kf kg kh ki kj kk kl km iq kn ko kp iu kq kr ks iy kt ku kv kw bi translated">非自愿的</h2><p id="2186" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq ln is it iu lo iw ix iy lp ja jb jc hb bi translated">非自愿中断是由操作系统之外的外部进程引起的。有两种非自愿中断:I/O中断和时钟中断。I/O中断是来自键盘或鼠标等输入/输出设备的中断信号。当一个进程正在运行时，如果用户移动/按下鼠标或在键盘上键入一个单词，就会发生I/O中断。时钟中断是基于时间的中断信号，来自主板上的定时器。如果某个进程被编程为在特定时间运行X操作，则可能发生时钟中断。</p><h2 id="7775" class="kc kd hi bd ke kf kg kh ki kj kk kl km iq kn ko kp iu kq kr ks iy kt ku kv kw bi translated">自愿的</h2><p id="db40" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq ln is it iu lo iw ix iy lp ja jb jc hb bi translated">自愿中断只存在于软件(进程)内部，与非自愿中断不同，它不是来自硬件。两种类型的自愿中断包括系统调用和异常。系统调用也称为系统调用接口(SCI)，这是一种用户空间与内核通信的协议。在这种情况下，系统调用被当作中断。异常也是由正在运行的进程产生的中断。如果存在segfault(一种分段错误),则会触发异常，seg fault是一种保护功能，如果软件试图通过实现代码来访问内核，这可能是进程内部的错误或程序本身的恶意活动的结果。异常中的另一个事件也可能发生，如果一个程序试图执行一个非法操作，在这种情况下被零除错误。如果硬件与计算机内存冲突，或者用户试图执行非法操作(如用0除一个数),就会发生被零除错误。</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div class="er es ls"><img src="../Images/d8bb560ce5fb365f9136775e9d1e3016.png" data-original-src="https://miro.medium.com/v2/resize:fit:796/0*j5cAJHJZYHw25aS-"/></div><figcaption class="jy jz et er es ka kb bd b be z dx translated">作者图片</figcaption></figure><p id="a5a8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这些是关于中断与计算机系统关系的一切。CPU为检测中断请求和处理中断提供硬件机制和逻辑支持。</p><p id="eb2e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这就是我们理解操作系统系列的一切。我希望我们解释操作系统的连载文章确实帮助了您理解操作系统一般是如何工作的。这是我们这个系列的最后一篇文章。感谢你的朗读！</p><p id="96be" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">参考:</strong></p><ul class=""><li id="9ef1" class="kx ky hi ih b ii ij im in iq lt iu lu iy lv jc le lf lg lh bi translated">SILBERSCHATZ，a .，GALVIN，P.B .和GAGNE，G. (2012) <em class="lw">操作系统概念，第10版</em>。</li><li id="75ac" class="kx ky hi ih b ii li im lj iq lk iu ll iy lm jc le lf lg lh bi translated">维基百科贡献者(2021) <em class="lw"> CPU模式</em>。可用地点:<a class="ae lx" href="https://en.wikipedia.org/wiki/CPU_modes" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/CPU_modes</a>。</li><li id="77fb" class="kx ky hi ih b ii li im lj iq lk iu ll iy lm jc le lf lg lh bi translated">维基百科投稿人(2022) <em class="lw">保护环</em>。可在:<a class="ae lx" href="https://en.wikipedia.org/wiki/Protection_ring" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/Protection_ring</a>买到。</li><li id="367a" class="kx ky hi ih b ii li im lj iq lk iu ll iy lm jc le lf lg lh bi translated">GeeksforGeeks (2020) <em class="lw">中断和异常</em>。可在:<a class="ae lx" href="https://www.geeksforgeeks.org/interrupts-and-exceptions/" rel="noopener ugc nofollow" target="_blank">https://www.geeksforgeeks.org/interrupts-and-exceptions/</a>买到。</li><li id="1512" class="kx ky hi ih b ii li im lj iq lk iu ll iy lm jc le lf lg lh bi translated">计算机希望(2020) <em class="lw">如何修复一个除数或被零除的错误</em>。地点:【https://www.computerhope.com/issues/ch000396.htm. T2】</li></ul></div></div>    
</body>
</html>