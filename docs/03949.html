<html>
<head>
<title>Tackling the Kaggle COVID Detection Challenge with Lightning Flash and IceVision</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用闪电和IceVision应对Kaggle COVID检测挑战</h1>
<blockquote>原文：<a href="https://medium.com/codex/tackle-covid-detection-with-lightning-flash-and-icevision-3f66f28c24ac?source=collection_archive---------5-----------------------#2021-10-10">https://medium.com/codex/tackle-covid-detection-with-lightning-flash-and-icevision-3f66f28c24ac?source=collection_archive---------5-----------------------#2021-10-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/a8ef387dcd9519d99f9562d6589e9d99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oBlGOT6aLGhFA6nPF0TLfQ.jpeg"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">来自<a class="ae hv" href="https://www.pexels.com/photo/doctor-pointing-x-ray-result-beside-man-wearing-black-suit-2182972/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> Pexels </a>的<a class="ae hv" href="https://www.pexels.com/@linkedin?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> LinkedIn销售导航员</a>的插图照片。</figcaption></figure><div class=""/><div class=""><h2 id="9807" class="pw-subtitle-paragraph iv hx hy bd b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm dx translated">这篇文章介绍了我们如何使用<a class="ae hv" href="https://lightning-flash.readthedocs.io/en/stable" rel="noopener ugc nofollow" target="_blank">闪电</a>及其对<a class="ae hv" href="https://airctic.com" rel="noopener ugc nofollow" target="_blank"> IceVision的</a>丰富模型和主干集合的新支持来应对卡格尔using费沙比奥-RSNA·新冠肺炎探测挑战。</h2></div><p id="7951" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">目标检测是一项计算机视觉任务，旨在检测和分类场景或图像中的单个目标。有各种用于对象检测的模型架构，但是两种最常见的是区域提议(例如，快速/更快的RCNN)和一次性检测(例如，SSD、YOLO)。</p></div><div class="ab cl kj kk gp kl" role="separator"><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko"/></div><div class="hb hc hd he hf"><p id="9bcc" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><a class="ae hv" href="https://lightning-flash.readthedocs.io/en/stable/" rel="noopener ugc nofollow" target="_blank"> Lightning Flash </a>团队最近发布了一个与<a class="ae hv" href="https://airctic.com/" rel="noopener ugc nofollow" target="_blank"> IceVision </a>对象检测库的新的令人兴奋的集成，它支持几十个新的最先进的主干，可以进行微调，只需几行代码就可以进行推理。</p><div class="hh hi ez fb hj kq"><a href="https://lightning-flash.readthedocs.io/en/stable/reference/object_detection.html" rel="noopener  ugc nofollow" target="_blank"><div class="kr ab dw"><div class="ks ab kt cl cj ku"><h2 class="bd hz fi z dy kv ea eb kw ed ef hx bi translated">对象检测- Flash文档</h2><div class="kx l"><h3 class="bd b fi z dy kv ea eb kw ed ef dx translated">对象检测是识别图像中的对象及其相关类和边界框的任务。和…</h3></div><div class="ky l"><p class="bd b fp z dy kv ea eb kw ed ef dx translated">闪电闪电. readthedocs.io</p></div></div></div></a></div><p id="fcc5" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">我们参加了<a class="ae hv" href="https://www.kaggle.com/c/siim-covid19-detection" rel="noopener ugc nofollow" target="_blank"> Kaggle: COVID19检测/分类</a>挑战，以展示新的集成，该集成展示了来自6000多名患者的真实且具有挑战性的CT扫描数据集。</p><p id="de9e" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">检验我们的Kaggle内核— <a class="ae hv" href="https://www.kaggle.com/jirkaborovec/covid-detection-with-lightning-flash" rel="noopener ugc nofollow" target="_blank"> <strong class="jp hz">用闪电⚡️进行COVID检测</strong> </a></p><div class="hh hi ez fb hj kq"><a href="https://www.kaggle.com/jirkaborovec/covid-detection-with-lightning-flash" rel="noopener  ugc nofollow" target="_blank"><div class="kr ab dw"><div class="ks ab kt cl cj ku"><h2 class="bd hz fi z dy kv ea eb kw ed ef hx bi translated">闪电⚡️的Covid探测</h2><div class="kx l"><h3 class="bd b fi z dy kv ea eb kw ed ef dx translated">使用Kaggle笔记本探索和运行机器学习代码|使用来自SIIM-费沙比奥-RSNA新冠肺炎检测公司的数据</h3></div><div class="ky l"><p class="bd b fp z dy kv ea eb kw ed ef dx translated">www.kaggle.com</p></div></div><div class="kz l"><div class="la l lb lc ld kz le hp kq"/></div></div></a></div><blockquote class="lf lg lh"><p id="637f" class="jn jo li jp b jq jr iz js jt ju jc jv lj jx jy jz lk kb kc kd ll kf kg kh ki hb bi translated">所有的代码快照和可视化都是这个示例库的一部分，可以作为<code class="du lm ln lo lp b">pip install <a class="ae hv" href="https://github.com/Borda/kaggle_COVID-detection/archive/refs/heads/main.zip" rel="noopener ugc nofollow" target="_blank">https://github.com/Borda/kaggle_COVID-detection/archive/refs/heads/main.zip</a></code>安装</p></blockquote><h1 id="58db" class="lq lr hy bd ls lt lu lv lw lx ly lz ma je mb jf mc jh md ji me jk mf jl mg mh bi translated">COVID检测挑战</h1><p id="af40" class="pw-post-body-paragraph jn jo hy jp b jq mi iz js jt mj jc jv jw mk jy jz ka ml kc kd ke mm kg kh ki hb bi translated">最近的<a class="ae hv" href="https://www.kaggle.com/c/siim-covid19-detection" rel="noopener ugc nofollow" target="_blank"> Kaggle: COVID19检测/分类</a>旨在促进医学筛查，并最终协助医学专家/医生做出诊断。挑战是混合图像分类/目标检测任务。首先，您需要确定给定的CT扫描是否具有四种<a class="ae hv" href="https://www.kaggle.com/c/siim-covid19-detection/data" rel="noopener ugc nofollow" target="_blank">异常</a>之一，然后提供一组边界框来指示<a class="ae hv" href="https://www.kaggle.com/c/siim-covid19-detection/data" rel="noopener ugc nofollow" target="_blank">异常</a>出现的位置，以证明诊断的合理性。</p><p id="8220" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">虽然该任务被呈现为混合检测和分类任务，但是它也可以被建模为传统的对象检测问题，其中图像类别由检测到的<a class="ae hv" href="https://www.kaggle.com/c/siim-covid19-detection/data" rel="noopener ugc nofollow" target="_blank">异常</a>的大多数类别的集合来确定。</p><figure class="mo mp mq mr fd hk er es paragraph-image"><div class="er es mn"><img src="../Images/797a4d4114f61f016a2b4dfccbe4d48e.png" data-original-src="https://miro.medium.com/v2/resize:fit:804/format:webp/1*vlWw37McASsQKEmSEhwUbA.png"/></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">训练数据集上的标签分布。</figcaption></figure><p id="51ad" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">一项<strong class="jp hz">研究</strong>代表一名独特的匿名患者，接受一次<a class="ae hv" href="https://en.wikipedia.org/wiki/CT_scan" rel="noopener ugc nofollow" target="_blank">计算机断层扫描<strong class="jp hz">扫描</strong> </a>。单个DICOM图像应代表每次扫描。值得注意的是，一些带注释的图像被意外地不完全标记。这些图像和它们的注释后来被复制和修复，正如<a class="ae hv" href="https://www.kaggle.com/c/siim-covid19-detection/discussion/246597" rel="noopener ugc nofollow" target="_blank">在这个帖子中讨论的</a>。作为挑战的一部分，在训练之前，需要从数据集中过滤掉不完整的注释和重复的图像。</p><p id="f842" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">注释存储在两个独立的CSV表中。第一个表包含表示每个图像的异常类别的独热编码，第二个表包含图像中所有边界框(如果有的话)的列表。</p><h2 id="16da" class="ms lr hy bd ls mt mu mv lw mw mx my ma jw mz na mc ka nb nc me ke nd ne mg nf bi translated">加载带注释的DICOM图像</h2><p id="87cf" class="pw-post-body-paragraph jn jo hy jp b jq mi iz js jt mj jc jv jw mk jy jz ka ml kc kd ke mm kg kh ki hb bi translated">CT扫描在一个<a class="ae hv" href="https://en.wikipedia.org/wiki/DICOM" rel="noopener ugc nofollow" target="_blank"> DICOM </a>文件中提供，包括一个带有一些元数据和压缩图像位图的标题。</p><p id="bab1" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">对于加载图像数据，我们使用<code class="du lm ln lo lp b"><a class="ae hv" href="https://github.com/pydicom/pydicom" rel="noopener ugc nofollow" target="_blank">pydicom</a></code>包，参见下面的<a class="ae hv" href="https://gist.github.com/Borda/0c4afc86db7d273da257914ff8a03d41" rel="noopener ugc nofollow" target="_blank">示例代码如何做:</a></p><figure class="mo mp mq mr fd hk"><div class="bz dy l di"><div class="ng nh l"/></div></figure><p id="f0d7" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">加载图像后，我们根据研究ID合并了两个注释表。上面的代码显示了每个类的几个扫描示例，并绘制了边界框(如果它们在元数据中可用的话):</p><figure class="mo mp mq mr fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ni"><img src="../Images/3ea4f8e6a420f07e5613b91c1a5c86af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FaWZon1sYqMHtZ5DbU1wnQ.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">每个类(行)的几个样本的可视化，带有来自注释的着色检测边界框。</figcaption></figure><p id="7a96" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">正如所料，在负扫描中没有边界框。更有趣的是，大多数阳性扫描每次扫描包含不止一个检测。</p><h2 id="d0d5" class="ms lr hy bd ls mt mu mv lw mw mx my ma jw mz na mc ka nb nc me ke nd ne mg nf bi translated">关于检测和标记之间关系的附加观察</h2><p id="675e" class="pw-post-body-paragraph jn jo hy jp b jq mi iz js jt mj jc jv jw mk jy jz ka ml kc kd ke mm kg kh ki hb bi translated">让我们从计算带注释的包围盒的角度来看一下数据集。正如你从每类样本中看到的，有一些阳性病例没有检测到任何新冠肺炎。</p><p id="aec6" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">下图显示了每个给定类的每个图像中有多少个边界框。最后，这个观察结果可以用在最终的聚合启发式算法中。</p><figure class="mo mp mq mr fd hk er es paragraph-image"><div class="er es nj"><img src="../Images/32cbb643dae35ce477e6d1ea24a3312e.png" data-original-src="https://miro.medium.com/v2/resize:fit:902/format:webp/1*HhYOAoUZEj_IYqYUrjiB4w.png"/></div></figure><p id="35de" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">下面的饼图显示了不同研究中注释异常的分布。正如所料，没有包含边界框注释的阴性研究。</p><figure class="mo mp mq mr fd hk er es paragraph-image"><div class="er es nk"><img src="../Images/d81f881f97700e97026151a4363031e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:780/format:webp/1*_IrtHSonZqVg2YNiogkVfw.png"/></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">根据每个图像的注释编号或1+检测来标记直方图。</figcaption></figure><p id="d034" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">然而，包含异常的图像中有5%缺少边界框注释。这意味着，虽然我们可以使用对象检测来估计给定的图像类别，但这些有噪声的图像将使得用这种方法完美地模拟任务变得具有挑战性，这解释了为什么许多人使用混合图像分类/对象检测方法。</p><h2 id="bc20" class="ms lr hy bd ls mt mu mv lw mw mx my ma jw mz na mc ka nb nc me ke nd ne mg nf bi translated">带效率检测的闪存基线</h2><p id="1839" class="pw-post-body-paragraph jn jo hy jp b jq mi iz js jt mj jc jv jw mk jy jz ka ml kc kd ke mm kg kh ki hb bi translated"><a class="ae hv" href="https://github.com/PyTorchLightning/lightning-flash" rel="noopener ugc nofollow" target="_blank"> Flash </a>是一个人工智能工厂，用于快速原型制作、基线、微调和深度学习，解决商业和科学问题。它建立在强大的<a class="ae hv" href="https://pytorchlightning.ai/" rel="noopener ugc nofollow" target="_blank"> Pytorch Lightning </a>库之上，便于大规模训练。</p><p id="fc75" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在Flash对象检测中，使用两个关键参数<strong class="jp hz">主干</strong>和<strong class="jp hz">头部</strong>初始化模型，这两个参数来自模型架构/组合:</p><ul class=""><li id="fb50" class="nl nm hy jp b jq jr jt ju jw nn ka no ke np ki nq nr ns nt bi translated"><strong class="jp hz">主干</strong> —预训练的分类网络，如ResNet50、EffieientNet，用于对象检测模型中的特征提取。</li><li id="1ff4" class="nl nm hy jp b jq nu jt nv jw nw ka nx ke ny ki nq nr ns nt bi translated"><strong class="jp hz"> Head </strong> —定义对象检测器的架构，如Faster-RCNN、RetinaNet等。</li></ul><div class="hh hi ez fb hj kq"><a href="https://lightning-flash.readthedocs.io/en/latest/reference/object_detection.html" rel="noopener  ugc nofollow" target="_blank"><div class="kr ab dw"><div class="ks ab kt cl cj ku"><h2 class="bd hz fi z dy kv ea eb kw ed ef hx bi translated">对象检测— Flash文档</h2><div class="kx l"><h3 class="bd b fi z dy kv ea eb kw ed ef dx translated">对象检测任务识别图像中特定类别的对象的实例。目标探测器是…</h3></div><div class="ky l"><p class="bd b fp z dy kv ea eb kw ed ef dx translated">闪电闪电. readthedocs.io</p></div></div></div></a></div><p id="ce61" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">让我们用一个<a class="ae hv" href="https://ai.googleblog.com/2019/05/efficientnet-improving-accuracy-and.html" rel="noopener ugc nofollow" target="_blank"> EfficientNet </a>主干来看看EfficientDet head的模式，以便更好地理解这些论点。</p><figure class="mo mp mq mr fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es nz"><img src="../Images/bbf79179f6e953fb4b589df26893f85c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*iUHs0kerQKQ8mpfC.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">高效Det架构。EfficientDet使用<a class="ae hv" href="https://ai.googleblog.com/2019/05/efficientnet-improving-accuracy-and.html" rel="noopener ugc nofollow" target="_blank">efficient net</a>；来源:<a class="ae hv" href="http://ai.googleblog.com/2020/04/efficientdet-towards-scalable-and.html" rel="noopener ugc nofollow" target="_blank"> EfficientDet:实现可扩展的高效对象检测</a>。</figcaption></figure><p id="5f48" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">有了Flash，我们只需要几行代码就可以在我们的竞争数据集上微调最先进的方法，如<a class="ae hv" href="https://arxiv.org/abs/1911.09070" rel="noopener ugc nofollow" target="_blank"> EfficientDet </a>。你需要做的就是将Kaggle对象检测标签转换为COCO格式，设置模型和训练参数，然后开始训练…</p><h2 id="1257" class="ms lr hy bd ls mt mu mv lw mw mx my ma jw mz na mc ka nb nc me ke nd ne mg nf bi translated">1.将数据集转换为COCO格式</h2><p id="8a3e" class="pw-post-body-paragraph jn jo hy jp b jq mi iz js jt mj jc jv jw mk jy jz ka ml kc kd ke mm kg kh ki hb bi translated">在实践中使用完美的注释是非常罕见的，而且通常只出现在标准/基准数据集。IceVision和Flash集成目前使用<a class="ae hv" href="https://www.immersivelimit.com/tutorials/create-coco-annotations-from-scratch" rel="noopener ugc nofollow" target="_blank"> COCO数据集格式。</a>COCO格式由一个包含原始图像的文件夹和一个JSON注释文件组成，其中包含以下元数据:</p><ol class=""><li id="0b11" class="nl nm hy jp b jq jr jt ju jw nn ka no ke np ki oa nr ns nt bi translated">数据集中每个图像的相对图像路径和大小</li><li id="afb2" class="nl nm hy jp b jq nu jt nv jw nw ka nx ke ny ki oa nr ns nt bi translated">每个图像的边界框及其类别索引的列表</li><li id="6b71" class="nl nm hy jp b jq nu jt nv jw nw ka nx ke ny ki oa nr ns nt bi translated">边界框类索引和标签之间的映射</li></ol><p id="b102" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在COCO中，边界框包括图像中右上角的坐标以及边界框的宽度和高度。我们需要编写一个自定义脚本来完成从比赛注释到COCO格式的转换。这些步骤在提供的<a class="ae hv" href="https://github.com/Borda/kaggle_COVID-detection/blob/main/notebooks/COVID-detection-with-Lightning-Flash.ipynb" rel="noopener ugc nofollow" target="_blank">笔记本</a>中有描述，代码可以在提供的<a class="ae hv" href="https://github.com/Borda/kaggle_COVID-detection" rel="noopener ugc nofollow" target="_blank">资源库</a>中找到。</p><h2 id="403e" class="ms lr hy bd ls mt mu mv lw mw mx my ma jw mz na mc ka nb nc me ke nd ne mg nf bi translated">2.创建数据模块</h2><p id="c98b" class="pw-post-body-paragraph jn jo hy jp b jq mi iz js jt mj jc jv jw mk jy jz ka ml kc kd ke mm kg kh ki hb bi translated">在Flash中，<code class="du lm ln lo lp b">from_coco</code>方法加载在最后一步中创建的COCO图像和注释文件。我们可以提供一个<code class="du lm ln lo lp b">batch_size</code>来充分利用我们的GPU，并提供一个<code class="du lm ln lo lp b">image_size</code>来为我们的模型调整图像的大小。</p><figure class="mo mp mq mr fd hk er es paragraph-image"><a href="https://github.com/Borda/kaggle_COVID-detection/blob/03727f3ba4fbed889e4668db80fc4ad580e78dcc/kaggle_covid/cli_main.py#L18-25"><div class="er es ob"><img src="../Images/e7ec03adc03b6746cc3e4fecf4cd5fa1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_-5bNyEpzVVzS82NG78IuA.png"/></div></a><figcaption class="hr hs et er es ht hu bd b be z dx translated">来自Flash对象检测任务培训脚本的代码片段。</figcaption></figure><h2 id="2f22" class="ms lr hy bd ls mt mu mv lw mw mx my ma jw mz na mc ka nb nc me ke nd ne mg nf bi translated">3.构建任务</h2><p id="1b5e" class="pw-post-body-paragraph jn jo hy jp b jq mi iz js jt mj jc jv jw mk jy jz ka ml kc kd ke mm kg kh ki hb bi translated">为了构建对象检测任务，我们选择模型骨干。在本例中，我们使用最先进的EfficientDet和EfficientNet D5主干网。我们通过实验将学习率设置为<code class="du lm ln lo lp b">1e-5</code>，我们可以使用<a class="ae hv" href="https://optuna.org/" rel="noopener ugc nofollow" target="_blank"> Optuma </a>或<a class="ae hv" href="https://docs.grid.ai/products/run-run-and-sweep-github-files" rel="noopener ugc nofollow" target="_blank"> Grid.ai </a>进行超参数搜索来优化该值。</p><figure class="mo mp mq mr fd hk er es paragraph-image"><a href="https://github.com/Borda/kaggle_COVID-detection/blob/03727f3ba4fbed889e4668db80fc4ad580e78dcc/kaggle_covid/cli_main.py#L27-L35"><div class="er es ob"><img src="../Images/f33a5fae40053ad11ef1172eaf37e0e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1wZm_de9c75kdRo7fEVghQ.png"/></div></a><figcaption class="hr hs et er es ht hu bd b be z dx translated">来自培训脚本的代码<a class="ae hv" href="https://github.com/Borda/kaggle_COVID-detection/blob/03727f3ba4fbed889e4668db80fc4ad580e78dcc/kaggle_covid/cli_main.py#L27-L35" rel="noopener ugc nofollow" target="_blank">片段</a>。</figcaption></figure><h2 id="a46e" class="ms lr hy bd ls mt mu mv lw mw mx my ma jw mz na mc ka nb nc me ke nd ne mg nf bi translated">4.创建教练并微调模型</h2><p id="6996" class="pw-post-body-paragraph jn jo hy jp b jq mi iz js jt mj jc jv jw mk jy jz ka ml kc kd ke mm kg kh ki hb bi translated">闪电侠的<code class="du lm ln lo lp b">Trainer</code>继承了闪电的<code class="du lm ln lo lp b">Trainer</code>，使我们能够有效地利用所有我们知道和喜爱的教练旗帜。为了进行训练，我们使用方法<code class="du lm ln lo lp b">finetune</code>，它采用一个参数<code class="du lm ln lo lp b">strategy</code>来配置微调过程。例如，下面的<code class="du lm ln lo lp b">freeze_unfreeze</code>策略冻结了前10个时期的骨干，以便只更新头部，然后将训练扩展到整个模型。</p><figure class="mo mp mq mr fd hk er es paragraph-image"><a href="https://github.com/Borda/kaggle_COVID-detection/blob/03727f3ba4fbed889e4668db80fc4ad580e78dcc/kaggle_covid/cli_main.py#L37-L48"><div class="er es ob"><img src="../Images/c1b1d528950b33bd991442a0a6916964.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P9syIMZ6Wylp_zL6Clf0lQ.png"/></div></a><figcaption class="hr hs et er es ht hu bd b be z dx translated">来自培训脚本的代码片段。</figcaption></figure><p id="4f75" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">使用内置的Tensorboard logger，我们可以实时观察训练过程，看看训练损失是如何减少的。</p><figure class="mo mp mq mr fd hk er es paragraph-image"><div class="er es oc"><img src="../Images/2ee4c8e15a1be74d1d5d0c5379b3577b.png" data-original-src="https://miro.medium.com/v2/resize:fit:756/format:webp/1*g8dd0gYkyikhpzgtP6tukQ.png"/></div></figure><p id="195e" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在训练结束时，我们保存微调后的模型，以便我们可以进行推断。</p><h2 id="7997" class="ms lr hy bd ls mt mu mv lw mw mx my ma jw mz na mc ka nb nc me ke nd ne mg nf bi translated">5.加载模型并运行预测</h2><p id="0161" class="pw-post-body-paragraph jn jo hy jp b jq mi iz js jt mj jc jv jw mk jy jz ka ml kc kd ke mm kg kh ki hb bi translated">现在我们有了一个训练有素的模型。是时候评估我们模特的表现了。以下代码显示了Flash如何从文件中加载预训练模型并根据测试数据集进行预测的简单用例:</p><figure class="mo mp mq mr fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ob"><img src="../Images/6c5f8000e5070a2a91847d9c7866f698.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C9ouAibPMwJrt86LVWHckA.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">预测脚本的代码片段。</figcaption></figure><p id="f0e6" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">你有它；在本文中，您学习了如何</p><ol class=""><li id="4f1d" class="nl nm hy jp b jq jr jt ju jw nn ka no ke np ki oa nr ns nt bi translated">对对象检测数据集执行探索性数据分析。</li><li id="6dd3" class="nl nm hy jp b jq nu jt nv jw nw ka nx ke ny ki oa nr ns nt bi translated">使用Flash和IceVision训练端到端的先进对象检测模型。</li><li id="7bb7" class="nl nm hy jp b jq nu jt nv jw nw ka nx ke ny ki oa nr ns nt bi translated">评估经过训练的模型，为<a class="ae hv" href="https://www.kaggle.com/c/siim-covid19-detection" rel="noopener ugc nofollow" target="_blank"> Kaggle: COVID19检测/分类</a>挑战生成Kaggle提交。</li></ol><p id="39b5" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">敬请关注以下有闪电有闪光的故事！</p><div class="hh hi ez fb hj kq"><a href="https://devblog.pytorchlightning.ai/flash-0-5-your-pytorch-ai-factory-81b172ff0d76" rel="noopener  ugc nofollow" target="_blank"><div class="kr ab dw"><div class="ks ab kt cl cj ku"><h2 class="bd hz fi z dy kv ea eb kw ed ef hx bi translated">Flash 0.5 —您的PyTorch AI工厂！</h2><div class="kx l"><h3 class="bd b fi z dy kv ea eb kw ed ef dx translated">新的令人兴奋的集成，8个新任务，Torch ORT支持，Flash Zero，等等。</h3></div><div class="ky l"><p class="bd b fp z dy kv ea eb kw ed ef dx translated">devblog.pytorchlightning.ai</p></div></div><div class="kz l"><div class="od l lb lc ld kz le hp kq"/></div></div></a></div><p id="e12e" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><strong class="jp hz"> <em class="li">对更酷的Pytorch闪电集成感兴趣？<br/>关注我，加入我们牛逼的</em> </strong> <a class="ae hv" href="https://join.slack.com/t/pytorch-lightning/shared_invite/zt-pw5v393p-qRaDgEk24~EjiZNBpSQFgQ" rel="noopener ugc nofollow" target="_blank"> <strong class="jp hz"> <em class="li">懈怠</em> </strong> </a> <strong class="jp hz"> <em class="li">社区！</em> </strong></p></div><div class="ab cl kj kk gp kl" role="separator"><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko"/></div><div class="hb hc hd he hf"><h1 id="d20b" class="lq lr hy bd ls lt oe lv lw lx of lz ma je og jf mc jh oh ji me jk oi jl mg mh bi translated">关于作者</h1><p id="66a4" class="pw-post-body-paragraph jn jo hy jp b jq mi iz js jt mj jc jv jw mk jy jz ka ml kc kd ke mm kg kh ki hb bi translated">Jirka Borovec拥有CTU大学的计算机视觉博士学位。他已经在几家IT创业公司和公司从事机器学习和数据科学工作几年了。他喜欢探索有趣的世界问题，用最先进的技术解决它们，并开发开源项目。</p></div></div>    
</body>
</html>