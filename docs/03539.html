<html>
<head>
<title>Google Speech-To-Text API Tutorial with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python的Google语音转文本API教程</h1>
<blockquote>原文：<a href="https://medium.com/codex/google-speech-to-text-api-tutorial-with-python-2e049ae3f525?source=collection_archive---------2-----------------------#2021-09-08">https://medium.com/codex/google-speech-to-text-api-tutorial-with-python-2e049ae3f525?source=collection_archive---------2-----------------------#2021-09-08</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/632538278ec2d4e4768d5391da87240c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/0*GZM4aMrNlWSqjVXU.png"/></div></figure><p id="c6e4" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">最近，我有机会探索最伟大的深度学习算法之一，语音转文本，用于我公司的项目，以转录音频语音并删除敏感和个人数据。</p><p id="b14d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">如果你和我一样是第一次使用google API，我将带你了解一下，我保证通过这篇文章你将能够使用google API。</p></div><div class="ab cl jk jl gp jm" role="separator"><span class="jn bw bk jo jp jq"/><span class="jn bw bk jo jp jq"/><span class="jn bw bk jo jp"/></div><div class="hb hc hd he hf"><h2 id="310b" class="jr js hi bd jt ju jv jw jx jy jz ka kb ix kc kd ke jb kf kg kh jf ki kj kk kl bi translated">什么是API？根据维基百科的API是</h2><blockquote class="km"><p id="8b46" class="kn ko hi bd kp kq kr ks kt ku kv jj dx translated">“一个<strong class="ak">应用编程接口</strong> ( <strong class="ak"> API </strong>)是<a class="ae kw" href="https://en.wikipedia.org/wiki/Computer" rel="noopener ugc nofollow" target="_blank">计算机</a>之间或者<a class="ae kw" href="https://en.wikipedia.org/wiki/Computer_program" rel="noopener ugc nofollow" target="_blank">计算机程序</a>之间的连接。它是一种软件<a class="ae kw" href="https://en.wikipedia.org/wiki/Interface_(computing)" rel="noopener ugc nofollow" target="_blank">接口</a>，为其他<a class="ae kw" href="https://en.wikipedia.org/wiki/Software" rel="noopener ugc nofollow" target="_blank">软件</a>提供服务。<a class="ae kw" href="https://en.wikipedia.org/wiki/API#cite_note-1" rel="noopener ugc nofollow" target="_blank">【1】</a>描述如何构建这种连接或接口的文档或标准称为<em class="kx"> API规范</em>。符合这个标准的计算机系统被称为<em class="kx">实现</em>或<em class="kx">公开</em>一个API。术语API既可以指规范，也可以指实现。</p></blockquote><p id="f09a" class="pw-post-body-paragraph im in hi io b ip ky ir is it kz iv iw ix la iz ja jb lb jd je jf lc jh ji jj hb bi translated">简单来说，就是通过把你的电脑连接到他们的电脑上，请求使用那个特定的软件(API)来使用其他的软件(API)。是的，谷歌允许每个人以价格交换或免费借用或租赁他们的API。如果我们想在上使用这项服务，我们可以简单地访问他们的网站并免费测试，但如果你想使用它来与你的程序或代码集成，你需要在谷歌云平台上注册。</p><p id="821b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">首先你必须去这个网站:<a class="ae kw" href="http://cloud.google.com" rel="noopener ugc nofollow" target="_blank">cloud.google.com</a></p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es ld"><img src="../Images/5afff045cb7b2321ddf31df9d6d27efa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nU3OLOhq0bpX9AV18cUNrg.png"/></div></div></figure><p id="98c8" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">第一个云平台定时器。云平台是指基于互联网的数据中心的服务器的操作系统和硬件。它允许软件和硬件产品远程大规模共存。把云平台想象成一个地方，你可以把你的代码放在那里工作，而不用担心服务器、维护等等。但在本文中，我们使用云是为了借用他们的语音转文本软件和他们的计算能力来操作我们计算机上的语音转文本API。</p><h1 id="4b03" class="lm js hi bd jt ln lo lp jx lq lr ls kb lt lu lv ke lw lx ly kh lz ma mb kk mc bi translated">进入谷歌云平台</h1><p id="0dc1" class="pw-post-body-paragraph im in hi io b ip md ir is it me iv iw ix mf iz ja jb mg jd je jf mh jh ji jj hb bi translated">要进入他们的谷歌云平台，点击“<strong class="io hj">转到控制台</strong>按钮。你将进入GCP的登陆页面。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es ld"><img src="../Images/8f9911dce7cd517aa20e4aa19bf1b9ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rNKQ6wbhShE_Y0_rb3X5LQ.png"/></div></div></figure><p id="9115" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">此页面是GCP使用情况的汇总页面，包括API、计费和项目。在使用他们的任何服务之前，你必须在谷歌服务的gmail账户上设置你的信用卡。但在这里，你不需要担心价格，因为GCP会给你300美元的使用信用，如果超过免费信用，不会自动使用你的信用卡。</p><p id="e59b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">要在GCP使用API，首先要点击右边的<strong class="io hj">API和服务</strong>。你会找到这个页面，点击<strong class="io hj">库</strong>来搜索你要找的API。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es mi"><img src="../Images/ab109ec2134839e39cdcfafda847bee5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jUsOrfEn-zSZZh8pySsOlQ.png"/></div></div></figure><h2 id="282e" class="jr js hi bd jt ju jv jw jx jy jz ka kb ix kc kd ke jb kf kg kh jf ki kj kk kl bi translated">搜索云语音转文本API</h2><p id="1cf8" class="pw-post-body-paragraph im in hi io b ip md ir is it me iv iw ix mf iz ja jb mg jd je jf mh jh ji jj hb bi translated">起初，它会显示蓝色按钮为<strong class="io hj">启用</strong>，点击后，它将允许您的帐户连接到API。然后它将变为<strong class="io hj">管理</strong>现在您已经访问了google API的一个步骤。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es mj"><img src="../Images/32f59d027d0ab19c7bdd379be8028e7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*higVyis1Ru0SXgi7eHapCQ.png"/></div></div></figure><p id="3fcc" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">为了在API中使用GCP，您必须做的最后一件事是获取凭证密钥。返回到<strong class="io hj">API和服务页面</strong>并点击<strong class="io hj">凭证<br/> </strong>现在点击您的<strong class="io hj">服务账户</strong>。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es mk"><img src="../Images/fbf76987cda314685781ad1f0673cb09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fC5GtTFl47FKEnegSIT8_Q.png"/></div></div></figure><p id="15c3" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">#现在我很敏感地分享以下细节的图片。<br/>我不会显示图片来访问和创建凭证。</p><h1 id="8e39" class="lm js hi bd jt ln lo lp jx lq lr ls kb lt lu lv ke lw lx ly kh lz ma mb kk mc bi translated">如何获得谷歌服务帐户凭证</h1><p id="2c12" class="pw-post-body-paragraph im in hi io b ip md ir is it me iv iw ix mf iz ja jb mg jd je jf mh jh ji jj hb bi translated">进入<strong class="io hj">服务账户</strong>页面后，</p><ol class=""><li id="7806" class="ml mm hi io b ip iq it iu ix mn jb mo jf mp jj mq mr ms mt bi translated">你点击<strong class="io hj">键</strong>标签</li><li id="e5fd" class="ml mm hi io b ip mu it mv ix mw jb mx jf my jj mq mr ms mt bi translated">点击<strong class="io hj">添加密钥</strong>并选择<strong class="io hj">创建新密钥</strong></li><li id="486a" class="ml mm hi io b ip mu it mv ix mw jb mx jf my jj mq mr ms mt bi translated">选择<strong class="io hj"> JSON </strong>以JSON文件的形式下载密钥，用于访问GCP api</li><li id="44c6" class="ml mm hi io b ip mu it mv ix mw jb mx jf my jj mq mr ms mt bi translated">将您的JSON文件保存到google_secret_key.json或您喜欢的其他名称</li></ol><p id="6716" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在您已经做好了一切准备，可以在代码中使用API了。</p><h1 id="9a4c" class="lm js hi bd jt ln lo lp jx lq lr ls kb lt lu lv ke lw lx ly kh lz ma mb kk mc bi translated">python上的云语音转文本API</h1><p id="686c" class="pw-post-body-paragraph im in hi io b ip md ir is it me iv iw ix mf iz ja jb mg jd je jf mh jh ji jj hb bi translated">要使用python中的API，首先你需要为演讲安装谷歌云库。通过在命令行上使用pip安装。</p><pre class="le lf lg lh fd mz na nb nc aw nd bi"><span id="cabd" class="jr js hi na b fi ne nf l ng nh">pip install google-cloud-speech</span></pre><p id="596e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在您正在访问GCP的API，让我们写一些代码。首先，我们导入使用API所需的最少代码。</p><pre class="le lf lg lh fd mz na nb nc aw nd bi"><span id="6d35" class="jr js hi na b fi ne nf l ng nh">from google.cloud import speech<br/>import os<br/>import io</span></pre><p id="3665" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">创建一个客户机实例，用于发送请求API并为API请求设置Google凭证。下面是让您的操作系统知道哪个文件包含google凭证的代码。您必须将凭证文件放在与代码相同的文件夹中，或者设置json文件的路径。</p><pre class="le lf lg lh fd mz na nb nc aw nd bi"><span id="5a54" class="jr js hi na b fi ne nf l ng nh">#setting Google credential<br/>os.environ['GOOGLE_APPLICATION_CREDENTIALS']= 'google_secret_key.json'</span><span id="60c1" class="jr js hi na b fi ni nf l ng nh"># create client instance <br/>client = speech.SpeechClient()</span></pre><p id="01d9" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">阅读音频文件，你可以尝试WAV文件以外的其他音频格式，但为了确保它是可行的，我建议继续使用WAV或MP3格式。如果你想测试和我一样的音频你可以去这个<a class="ae kw" href="https://www.voiptroubleshooter.com/open_speech/american.html" rel="noopener ugc nofollow" target="_blank">开源音频文件</a>。</p><pre class="le lf lg lh fd mz na nb nc aw nd bi"><span id="a230" class="jr js hi na b fi ne nf l ng nh">#the path of your audio file<br/>file_name = "OSR_us_000_0010_8k.wav"</span><span id="a106" class="jr js hi na b fi ni nf l ng nh">with io.open(file_name, "rb") as audio_file:<br/>    content = audio_file.read()<br/>    audio = speech.RecognitionAudio(content=content)</span></pre><p id="e38b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在，要使用语音，首先我们需要设置语音到文本引擎的配置，您可以在<a class="ae kw" href="https://cloud.google.com/speech-to-text/docs/reference/rest/v1/RecognitionConfig" rel="noopener ugc nofollow" target="_blank">这里</a>查看参数。</p><pre class="le lf lg lh fd mz na nb nc aw nd bi"><span id="2370" class="jr js hi na b fi ne nf l ng nh">config = speech.RecognitionConfig(<br/>    encoding=speech.RecognitionConfig.AudioEncoding.LINEAR16,<br/>    enable_automatic_punctuation=True,<br/>    audio_channel_count=2,<br/>    language_code="en-US",<br/>)</span></pre><p id="75f9" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在是我们发送请求到谷歌为我们转录音频的部分</p><pre class="le lf lg lh fd mz na nb nc aw nd bi"><span id="4d0f" class="jr js hi na b fi ne nf l ng nh"># Sends the request to google to transcribe the audio<br/>response = client.recognize(request={"config": config, "audio": audio})</span><span id="152d" class="jr js hi na b fi ni nf l ng nh"># Reads the response<br/>for result in response.results:<br/>    print("Transcript: {}".format(result.alternatives[0].transcript))</span></pre><p id="f549" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">结果的输出如下所示</p><pre class="le lf lg lh fd mz na nb nc aw nd bi"><span id="e6c4" class="jr js hi na b fi ne nf l ng nh">Transcript: The Birch canoes slid on the smooth planks.<br/>Transcript:  Glue the sheet to the dark blue background.<br/>Transcript:  It is easy to tell the death of a well.<br/>Transcript:  These days, a chicken leg is a verb dish.<br/>Transcript:  Rice is often served in round bowls.<br/>Transcript:  The juice of lemons makes find punch.<br/>Transcript:  The box was down beside the park truck.<br/>Transcript:  The Hogs of food shop, corn and garbage.<br/>Transcript:  4 hours of study work Facebook.<br/>Transcript:  A large size in stockings is hard to sell.</span></pre><p id="c89f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我刚刚展示给你的这个方法只适用于小规模音频(<strong class="io hj">小于1分钟的音频或10 MB </strong>)，这样你就可以在你的本地计算机上运行。如果你想运行更长的音频文件，你需要把你的音频文件放在<strong class="io hj">谷歌云存储</strong>中，这是另一个在云上存储数据的API，这样它可以使用更多的计算资源。</p><h1 id="8135" class="lm js hi bd jt ln lo lp jx lq lr ls kb lt lu lv ke lw lx ly kh lz ma mb kk mc bi translated">现在，您已经准备好将语音转文本应用到您的应用程序中，您的代码可以开始使用了！</h1></div></div>    
</body>
</html>