<html>
<head>
<title>Creating Presentable Data Visualization with Altair</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Altair创建可展示的数据可视化</h1>
<blockquote>原文：<a href="https://medium.com/codex/creating-presentable-data-visualization-with-altair-5a3286e697ab?source=collection_archive---------4-----------------------#2021-01-14">https://medium.com/codex/creating-presentable-data-visualization-with-altair-5a3286e697ab?source=collection_archive---------4-----------------------#2021-01-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><h2 id="c433" class="hg hh hi bd b fp hj hk hl hm hn ho dx hp translated" aria-label="kicker paragraph"><a class="ae ge" rel="noopener" href="/">抄本</a></h2><div class=""/><div class=""><h2 id="3ec1" class="pw-subtitle-paragraph io hr hi bd b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf dx translated">使用地热热流数据的案例研究</h2></div><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es jg"><img src="../Images/0b7142e8e9f76cff44c74c604938130c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*vcH8Z_dMpEFbXTi4"/></div></div><figcaption class="js jt et er es ju jv bd b be z dx translated">由<a class="ae jw" href="https://unsplash.com/@austinfarrington?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">奥斯汀·法灵顿</a>在<a class="ae jw" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="a7d4" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi kt translated">ltair是一个python库，主要关注声明性可视化。这个库有一个足够简洁的语法来执行各种可视化。</p><p id="332d" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">Altair与其他可视化库的一个显著区别是，Altair具有一行代码属性，不需要很多代码行来显示各种可视化。</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div class="er es lc"><img src="../Images/2472b7288619eb68155f09189a3238ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:400/format:webp/0*KuoUtMfEQkxRzIkC.png"/></div><figcaption class="js jt et er es ju jv bd b be z dx translated"><strong class="bd ld">图一。</strong>Altair:Python中的声明性可视化</figcaption></figure><p id="9c46" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">在本文中，我们不会详细说明Altair的所有用途。相反，我们将探索一些适用于数据集的有趣功能。</p><h1 id="c1e6" class="le lf hi bd ld lg lh li lj lk ll lm ln ix lo iy lp ja lq jb lr jd ls je lt lu bi translated">安装和数据调节</h1><p id="f4d6" class="pw-post-body-paragraph jx jy hi jz b ka lv is kc kd lw iv kf kg lx ki kj kk ly km kn ko lz kq kr ks hb bi translated">为了获得最佳的可视化体验，请使用Jupyter实验室或Jupyter笔记本IDE。牛郎星安装可以用<code class="du ma mb mc md b">pip install altair</code>完成。</p><p id="a729" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">本文中使用的数据是皇家霍洛威东南亚研究集团<a class="ae jw" href="http://searg.rhul.ac.uk/current-research/" rel="noopener ugc nofollow" target="_blank">的东南地热流量汇编数据的一部分</a>。</p><p id="01f6" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">首先，我们需要导入所需的库，然后检查我们的数据，如下面的代码所示。</p><pre class="jh ji jj jk fd me md mf mg aw mh bi"><span id="c5a5" class="mi lf hi md b fi mj mk l ml mm">import altair as alt<br/>import pandas as pd</span><span id="2e44" class="mi lf hi md b fi mn mk l ml mm">df = pd.read_csv(‘pabum_compile.csv’)</span><span id="4951" class="mi lf hi md b fi mn mk l ml mm">print('our data shape is ' + str(df.shape))<br/>df.head()</span></pre><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es mo"><img src="../Images/e4439796345bb88e4414423d7466cb0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gvYZ1x4rB6Wo119efCXAKQ.png"/></div></div><figcaption class="js jt et er es ju jv bd b be z dx translated"><strong class="bd ld">表1。</strong>地热热流数据集</figcaption></figure><p id="b7ca" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">我们可以看到我们的数据有593行和11列。请注意，深度以英尺为单位，测量温度(测量温度)和计算温度(计算温度)以华氏度为单位，地热梯度(地热梯度)以华氏度/ 100英尺为单位。</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es mp"><img src="../Images/9e0176c9c88077f609b0a17ef8c7d744.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qDhn6rmtnbC8lNmxx7xSgQ.png"/></div></div><figcaption class="js jt et er es ju jv bd b be z dx translated"><strong class="bd ld">表2。</strong> <a class="ae jw" href="https://altair-viz.github.io/user_guide/encoding.html?highlight=data%20types" rel="noopener ugc nofollow" target="_blank">牛郎星</a>中的数据类型编码</figcaption></figure><p id="079d" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">Altair将数据分为几种数据类型(表2)。这些数据类型对于以后的可视化很有用，因为每种数据类型都有不同的可视化特征。</p><h1 id="ea54" class="le lf hi bd ld lg lh li lj lk ll lm ln ix lo iy lp ja lq jb lr jd ls je lt lu bi translated">简单情节</h1><p id="69f2" class="pw-post-body-paragraph jx jy hi jz b ka lv is kc kd lw iv kf kg lx ki kj kk ly km kn ko lz kq kr ks hb bi translated">现在让我们用Altair可视化一个简单的情节。从表3中可以看出，这个库中有许多类型的绘图可供我们选择。然而，在本文中，我们将只使用一个点状图(<code class="du ma mb mc md b">mark_tick ()</code>)、散点图(<code class="du ma mb mc md b">mark_point ()</code>)和条形图(<code class="du ma mb mc md b">mark_bar ()</code>)来可视化我们的数据。</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es mq"><img src="../Images/aec39d5ee39e8cb0b486541a81e0c718.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CChsmqjEaVMGlS2EQH7NqQ.png"/></div></div><figcaption class="js jt et er es ju jv bd b be z dx translated"><strong class="bd ld">表3。</strong> <a class="ae jw" href="https://altair-viz.github.io/user_guide/marks.html" rel="noopener ugc nofollow" target="_blank">牛郎星</a>中的可视化方法</figcaption></figure><p id="cfe8" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">我们将使用“Meas Temp”参数执行第一个简单的绘图技术(<strong class="jz hs"> Tick Plot </strong>)，如以下代码所示。柱状图(<strong class="jz hs">图2 </strong>)是显示数据分布的最简单的可视化技术之一。</p><pre class="jh ji jj jk fd me md mf mg aw mh bi"><span id="deea" class="mi lf hi md b fi mj mk l ml mm">alt.Chart(df).mark_tick().encode(x = ‘Meas Temp’)</span></pre><figure class="jh ji jj jk fd jl er es paragraph-image"><div class="er es mr"><img src="../Images/fb1077c5a27bc3c629715b013bab50a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:824/format:webp/1*4gwtBhHM42SfOrG9Id_vgg.png"/></div><figcaption class="js jt et er es ju jv bd b be z dx translated"><strong class="bd ld">图二。</strong>刻度图可视化</figcaption></figure><p id="912e" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">我们的第二种可视化技术(<strong class="jz hs">散点图</strong>)是用X轴上的参数<strong class="jz hs">、</strong>、<strong class="jz hs">、Y轴上的【计算温度】、<strong class="jz hs">、【地理坡度】作为颜色键</strong>来执行的。</strong></p><pre class="jh ji jj jk fd me md mf mg aw mh bi"><span id="fcfe" class="mi lf hi md b fi mj mk l ml mm">alt.Chart(df).mark_point().encode(x = ’Meas Temp’,y = ’Calc Temp’,color = ‘Geoth Grad:Q’)</span></pre><p id="f1b7" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated"><code class="du ma mb mc md b">Geoth Grad: Q</code>需要指定将数据定义为定量数据类型，以便可视化将显示颜色条，而不是代表名义/序数数据的圆点/圆圈符号。</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div class="er es ms"><img src="../Images/b73801838e020b06eee4eebbb6ae2731.png" data-original-src="https://miro.medium.com/v2/resize:fit:1056/format:webp/1*DpJ_Ln4hSXi6JE9owjK_Yg.png"/></div><figcaption class="js jt et er es ju jv bd b be z dx translated"><strong class="bd ld">图三。</strong>散点图可视化</figcaption></figure><p id="be31" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">我们最后一个简单绘图的技术(柱状图)是通过可视化"<strong class="jz hs">岩石类型"</strong>参数的<code class="du ma mb mc md b">count ()</code>来完成的，如下面的代码所示。</p><pre class="jh ji jj jk fd me md mf mg aw mh bi"><span id="9b07" class="mi lf hi md b fi mj mk l ml mm">alt.Chart(df).mark_bar().encode(y = ’count()’, x = ’Rock Type’)</span></pre><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es mt"><img src="../Images/eb857a95857e039f29197c9f1fc5d585.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YS6bMeJNB-YNjv4ymF-z8w.png"/></div></div><figcaption class="js jt et er es ju jv bd b be z dx translated"><strong class="bd ld">图4 </strong>。条形图可视化</figcaption></figure><p id="6043" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">可以通过显示颜色键来修改条形图，以使其提供更多信息，如下面的代码所示。</p><pre class="jh ji jj jk fd me md mf mg aw mh bi"><span id="6e9f" class="mi lf hi md b fi mj mk l ml mm">alt.Chart(df).mark_bar().encode(y = ’count()’, x = ’Rock Type’, color = ‘Operator’)</span></pre><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es mu"><img src="../Images/9e4bca1e3feb9a33b8898b77383a9b64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sWDZ_vJFira9t4Feg1Hwww.png"/></div></div><figcaption class="js jt et er es ju jv bd b be z dx translated"><strong class="bd ld">图5。</strong>彩色可视化条形图</figcaption></figure><p id="1537" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">从这三个简单的绘图示例可以看出，Altair使用户的可视化变得更加简单，因为它使用了一行代码，并且不需要额外的标记工作。这被称为<strong class="jz hs">声明式可视化。</strong></p><h1 id="c5ea" class="le lf hi bd ld lg lh li lj lk ll lm ln ix lo iy lp ja lq jb lr jd ls je lt lu bi translated">数据转换</h1><p id="b0dc" class="pw-post-body-paragraph jx jy hi jz b ka lv is kc kd lw iv kf kg lx ki kj kk ly km kn ko lz kq kr ks hb bi translated">Altair允许用户执行多种数据转换，如估算数据(<code class="du ma mb mc md b">transform_impute ()</code>)、聚合数据(<code class="du ma mb mc md b">transform_aggregate ()</code>)、过滤数据(<code class="du ma mb mc md b">transform_filter ()</code>)、bin数据(<code class="du ma mb mc md b">transform_bin ()</code>)等。在本文中，我们将使用<code class="du ma mb mc md b">transform_bin ()</code>转换数据，然后使用<code class="du ma mb mc md b">column encoding</code>技术可视化数据，以显示一个包含2个不同支线剧情的剧情。</p><pre class="jh ji jj jk fd me md mf mg aw mh bi"><span id="f3eb" class="mi lf hi md b fi mj mk l ml mm">alt.Chart(df).mark_bar().encode(<br/> alt.X(alt.repeat(“column”), type=’ordinal’),<br/> alt.Y(‘count()’)<br/>).properties(<br/> width=400,<br/> height=200<br/>).repeat(<br/> column=[‘Meas Temp binned’,’Calc Temp binned’]<br/>).transform_bin(<br/> ‘Meas Temp binned’, field = ‘Meas Temp’,bin=alt.Bin(maxbins=10)<br/>).transform_bin(<br/> ‘Calc Temp binned’, field = ‘Calc Temp’,bin=alt.Bin(maxbins=10))</span></pre><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es mv"><img src="../Images/601de2630a7dc28787524ad7bb0bb486.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*28NnuwOvBw6KQyhgNLWTPw.png"/></div></div><figcaption class="js jt et er es ju jv bd b be z dx translated"><strong class="bd ld">图六。</strong>带分箱数据可视化的条形图</figcaption></figure><p id="e752" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated"><code class="du ma mb mc md b">transform_bin ()</code>用于将数据(<strong class="jz hs">“测量温度”和“计算温度”</strong>)划分到指定的区间。该流程旨在呈现更易理解的数据可视化，如图<strong class="jz hs">图6 </strong>所示。</p><h1 id="9549" class="le lf hi bd ld lg lh li lj lk ll lm ln ix lo iy lp ja lq jb lr jd ls je lt lu bi translated">互动情节</h1><p id="d326" class="pw-post-body-paragraph jx jy hi jz b ka lv is kc kd lw iv kf kg lx ki kj kk ly km kn ko lz kq kr ks hb bi translated">交互式剧情是Altair的一个显著特点。这个库可以用最少的约束显示各种交互式支线剧情。凭借这一优势，Altair还可以用于迷你仪表板，以显示/监控日常业务活动。</p><p id="8cdc" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">首先，我们将尝试用两个图例(<code class="du ma mb mc md b">alt.Color ()</code> &amp; <code class="du ma mb mc md b">alt.Size ()</code>)制作一个简单的交互交会图(<code class="du ma mb mc md b">.interactive ()</code>)，如下面的代码所示。</p><pre class="jh ji jj jk fd me md mf mg aw mh bi"><span id="0223" class="mi lf hi md b fi mj mk l ml mm">alt.Chart(df).mark_point().encode(<br/> alt.X(‘Long:Q’, title=’Longitude’,scale = alt.Scale(zero=False)),<br/> alt.Y(‘Lat:Q’, title=’Latitude’,scale = alt.Scale(zero=False)),<br/> alt.Color(‘Meas Temp’,scale = alt.Scale(scheme=’turbo’)),<br/> alt.Size(‘Calc Temp’)<br/>).properties(<br/> width=600,<br/> height=400<br/>).interactive()</span></pre><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es et"><img src="../Images/1f6ddd022354cee6c6129f3bd4820b81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Wz78KL7aWqTort08Q-iLYA.gif"/></div></div><figcaption class="js jt et er es ju jv bd b be z dx translated"><strong class="bd ld">图7。</strong>交互式交会图可视化</figcaption></figure><p id="66b7" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">图7显示了一个带有两个图例(颜色键和点大小)的交互式可视化，我们可以在其中自由缩放和拖动。</p><p id="1dd4" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">接下来，我们将通过结合<code class="du ma mb mc md b">.repeat () </code>和<code class="du ma mb mc md b">.interactive ()</code>编码来进行交互连接，如下面的代码所示。</p><pre class="jh ji jj jk fd me md mf mg aw mh bi"><span id="e77f" class="mi lf hi md b fi mj mk l ml mm">alt.Chart(df).mark_point().encode(<br/> alt.X(alt.repeat(“column”), type=’quantitative’),<br/> alt.Y(alt.repeat(“row”), type=’quantitative’),<br/> color=alt.Color(‘Year:Q’,scale = alt.Scale(scheme = ‘darkblue’))<br/>).properties(<br/> width=200,<br/> height=200<br/>).repeat(<br/> row=[‘Meas Temp’, ‘Calc Temp’],<br/> column=[‘Depth’, ‘Geoth Grad’]<br/>).interactive()</span></pre><figure class="jh ji jj jk fd jl er es paragraph-image"><div class="er es mw"><img src="../Images/79d9b0660889dfeff3774e8b8f79235f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/1*BLAGFl2itu6gTvfIeVVgsA.gif"/></div><figcaption class="js jt et er es ju jv bd b be z dx translated"><strong class="bd ld">图8。</strong>交互式串联图可视化</figcaption></figure><p id="52dd" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated"><strong class="jz hs">图8 </strong>显示我们可以在所有支线剧情上同时进行交互式可视化(拖动和缩放)。</p><p id="3155" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">对于第三个例子，我们将实现一个<code class="du ma mb mc md b">brush</code>技术。这项技术允许我们在子情节中选择某些数据。当这种情况发生时，它将同时选择其他支线剧情中的相同数据。下面的代码还引入了一种编码技术来单独定义x轴。</p><pre class="jh ji jj jk fd me md mf mg aw mh bi"><span id="b1ee" class="mi lf hi md b fi mj mk l ml mm">#interval for selection<br/>#global for applying in every plot<br/>brush = alt.selection(type=’interval’,resolve = ‘global’)</span><span id="0f0a" class="mi lf hi md b fi mn mk l ml mm"># Need to Specify Depth:Q for making the legend into the color bar<br/>yaxis = alt.Chart(df).mark_point().encode(<br/> y=’Geoth Grad’,<br/> color=alt.condition(brush, ‘Depth:Q’, alt.ColorValue(‘lightgray’)),<br/>).add_selection(<br/> brush<br/>).properties(<br/> width=300,<br/> height=300<br/>)</span><span id="052f" class="mi lf hi md b fi mn mk l ml mm">#horizontal concatinating (encode separately)<br/>yaxis.encode(x=’Calc Temp’) | yaxis.encode(x=’Meas Temp’)</span></pre><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es mx"><img src="../Images/a15d3e19e6c105dbe4aedaa614d174b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*bDVd73RFYWcvcDp6_gvHRA.gif"/></div></div><figcaption class="js jt et er es ju jv bd b be z dx translated"><strong class="bd ld">图9。</strong>交互式笔刷选择可视化</figcaption></figure><p id="0832" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">现在，我们将尝试将图9 中<strong class="jz hs">所示的<code class="du ma mb mc md b">brush</code>技术与条形图(<code class="du ma mb mc md b">mark_bar ()</code>)相结合，以产生如图10 </strong>中<strong class="jz hs">所示的信息可视化。</strong></p><pre class="jh ji jj jk fd me md mf mg aw mh bi"><span id="d105" class="mi lf hi md b fi mj mk l ml mm">brush = alt.selection(type=’interval’)</span><span id="56b2" class="mi lf hi md b fi mn mk l ml mm">scat = alt.Chart().mark_point().encode(<br/> alt.X(‘Long:Q’, title=’Longitude’,scale = alt.Scale(zero=False)),<br/> alt.Y(‘Lat:Q’, title=’Latitude’,scale = alt.Scale(zero=False)),<br/> alt.Color(‘Meas Temp’,scale = alt.Scale(scheme=’turbo’)),<br/> alt.Size(‘Calc Temp’)<br/>).properties(<br/> width=420,<br/> height=400<br/>).add_selection(brush)</span><span id="139f" class="mi lf hi md b fi mn mk l ml mm">#transform bin: specify the dummy parameter (Depth_binned) in y axis<br/>#transform with alt.Bin using the parameter in the dataframe (Depth)<br/>bars = alt.Chart().mark_bar().encode(<br/> x=’Depth_binned:O’,<br/> y=’count()’,<br/> color=alt.Color(‘Rock Type’,scale = alt.Scale(scheme=’set1'))<br/>).properties(<br/> height=400<br/>).transform_filter(<br/> brush<br/>).transform_bin(<br/> ‘Depth_binned’, field = ‘Depth’,bin=alt.Bin(maxbins=15))</span><span id="9d37" class="mi lf hi md b fi mn mk l ml mm">alt.hconcat(bars, scat, data=df)</span></pre><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es my"><img src="../Images/cddb95bdb4c2caa0535d00348ed1db68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*U-Y73xi_IOyT7vG2duuzcA.gif"/></div></div><figcaption class="js jt et er es ju jv bd b be z dx translated"><strong class="bd ld">图十。</strong>带刷子可视化的条形图和交会图</figcaption></figure><p id="e55f" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated"><strong class="jz hs">图10 </strong>由两个子图组成:<strong class="jz hs">以<strong class="jz hs">“岩石类型”为色键的“深度”条形图</strong>(左)</strong>和经纬度交会图<strong class="jz hs">(右)</strong>。通过利用交会图中的<code class="du ma mb mc md b">brush</code>技术，我们可以轻松检查所需位置的深度或岩石类型特征。</p><p id="5f7e" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">我们还可以将水平连接技术应用于条形图，以产生一个有趣的迷你仪表盘，如图<strong class="jz hs">图11 </strong>所示。</p><pre class="jh ji jj jk fd me md mf mg aw mh bi"><span id="fb3a" class="mi lf hi md b fi mj mk l ml mm">brush = alt.selection(type=’interval’)</span><span id="9b81" class="mi lf hi md b fi mn mk l ml mm">scat = alt.Chart(df).mark_point().encode(<br/> alt.X(‘Long:Q’, title=’Longitude’,scale = alt.Scale(zero=False)),<br/> alt.Y(‘Lat:Q’, title=’Latitude’,scale = alt.Scale(zero=False)),<br/> alt.Color(‘Meas Temp:Q’,scale = alt.Scale(scheme=’turbo’)),<br/> alt.Size(‘Calc Temp’)<br/>).properties(<br/> width=600,<br/> height=400<br/>).add_selection(brush)</span><span id="d6f5" class="mi lf hi md b fi mn mk l ml mm">bars = alt.Chart(df).mark_bar().encode(<br/> alt.X(alt.repeat(“column”), type=’ordinal’),<br/> alt.Y(‘count()’)<br/>).properties(<br/> width=400,<br/> height=200<br/>).repeat(<br/> column=[‘Meas Temp binned’,’Calc Temp binned’]<br/>).transform_bin(<br/> ‘Meas Temp binned’, field = ‘Meas Temp’,bin=alt.Bin(maxbins=10)<br/>).transform_bin(<br/> ‘Calc Temp binned’, field = ‘Calc Temp’,bin=alt.Bin(maxbins=10)<br/>).transform_filter(brush)</span><span id="7260" class="mi lf hi md b fi mn mk l ml mm">alt.vconcat(scat, bars, data=df)</span></pre><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es mz"><img src="../Images/5ff092dc989730a5b86eddb5a9b2aa62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*odjurcBzCy0Hnmqd6DZHGw.gif"/></div></div><figcaption class="js jt et er es ju jv bd b be z dx translated"><strong class="bd ld">图11。</strong>双条形图和交会图，带刷子可视化</figcaption></figure><p id="1b40" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">我们可以在<strong class="jz hs">图11 </strong>中看到，3个不同的子图(<strong class="jz hs">经纬度交会图、实测温度柱状图和计算温度柱状图</strong>)可以同时可视化并相互作用。</p><p id="a6f2" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">可以得出结论，产生如图10和图11所示的可视化，<strong class="jz hs">只需要4个主线代码</strong> : <code class="du ma mb mc md b">brush</code>、<code class="du ma mb mc md b">scat</code>、<code class="du ma mb mc md b">bars</code>和<code class="du ma mb mc md b">concat</code>。这种技术非常简单明了，可以创建一个信息丰富且优雅的可视化效果。这个好处还可以简化我们对数据的分析，尤其是当我们想要构建一个数据可视化仪表板的时候。</p><h1 id="913f" class="le lf hi bd ld lg lh li lj lk ll lm ln ix lo iy lp ja lq jb lr jd ls je lt lu bi translated">关闭</h1><p id="6ed7" class="pw-post-body-paragraph jx jy hi jz b ka lv is kc kd lw iv kf kg lx ki kj kk ly km kn ko lz kq kr ks hb bi translated">尽管如此，这个库还可以探索许多其他的可视化技术。更详细的解释，你可以在这里查看Altair <a class="ae jw" href="https://altair-viz.github.io/" rel="noopener ugc nofollow" target="_blank">的官方文档。编码快乐！</a></p></div></div>    
</body>
</html>