<html>
<head>
<title>A DIY Reddit sentiment analyzer (of meme stocks)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">一个DIY的Reddit情绪分析器(关于迷因股票)</h1>
<blockquote>原文：<a href="https://medium.com/codex/a-diy-reddit-sentiment-analyzer-of-meme-stocks-335fc1dba7f8?source=collection_archive---------10-----------------------#2022-01-13">https://medium.com/codex/a-diy-reddit-sentiment-analyzer-of-meme-stocks-335fc1dba7f8?source=collection_archive---------10-----------------------#2022-01-13</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="3b9d" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">使用Python将数据从RSS拉入Deephaven</h2></div><p id="9fa8" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">杰克·马尔福德</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es jt"><img src="../Images/e94e3ffee1d2c925a21f555c4fd7f9e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*2yqE49DJQWjTyPLtJrhc3A.gif"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">来源:作者图片</figcaption></figure><p id="a01c" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi kj translated">eddit RSS提要和Python AI是一个强大的组合。有了它们，你可以追踪你所关心的话题的情绪趋势。</p><p id="ed35" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">深海天堂填补了这一空白。你不仅可以探索子编辑的历史，还可以实时跟踪流媒体对话。在本文中，我们提供了一个程序，它将RSS提要吸收到Deephaven表中，并使用易于定制的Python查询执行简单的情感分析。我们打算自己动手编写代码——因为RSS提要是标准化的，所以这些方法可以应用于任何RSS提要，比如那些来源于维基百科、黑客新闻、CNN和播客的提要。</p><p id="e05e" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">继续读下去，看看华尔街赌注以及人们对迷因股票的看法。</p><h1 id="ddc8" class="ks kt hi bd ku kv kw kx ky kz la lb lc io ld ip le ir lf is lg iu lh iv li lj bi translated">从RSS <a class="ae lk" href="https://docs-staging.deephaven.io/deploy-preview/62fea544f40f63e39c15c61788126fba18c07a99/blog/2022/01/13/reddit-sentiment-analysis/#pull-data-from-rss" rel="noopener ugc nofollow" target="_blank">拉数据</a></h1><p id="eaf0" class="pw-post-body-paragraph ix iy hi iz b ja ll ij jc jd lm im jf jg ln ji jj jk lo jm jn jo lp jq jr js hb bi translated">我们如何将数据从一个RSS源拉进Deephaven？Python <a class="ae lk" href="https://pypi.org/project/feedparser/" rel="noopener ugc nofollow" target="_blank"> feedparser包</a>被广泛使用并得到良好支持。它提供了一个方法<code class="du lq lr ls lt b">feedparser.parse()</code>,可以从RSS提要中提取数据。我们可以利用这一点将数据导入深水港。在本例中，我们将从<a class="ae lk" href="https://www.reddit.com/r/wallstreetbets" rel="noopener ugc nofollow" target="_blank">华尔街赌注子编辑</a>中提取信息。</p><pre class="ju jv jw jx fd lu lt lv lw aw lx bi"><span id="a6be" class="ly kt hi lt b fi lz ma l mb mc">import os<br/>os.system("pip install feedparser")</span><span id="defb" class="ly kt hi lt b fi md ma l mb mc">import feedparser</span><span id="67d8" class="ly kt hi lt b fi md ma l mb mc">feed = feedparser.parse("<a class="ae lk" href="https://www.reddit.com/r/wallstreetbets/new/.rss" rel="noopener ugc nofollow" target="_blank">https://www.reddit.com/r/wallstreetbets/new/.rss</a>")</span></pre><p id="0b00" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这为我们提供了当前RSS文件的快照。要查看RSS提要的所有条目，我们可以查看<code class="du lq lr ls lt b">feed.entries</code>变量。</p><pre class="ju jv jw jx fd lu lt lv lw aw lx bi"><span id="c0b9" class="ly kt hi lt b fi lz ma l mb mc">for entry in feed.entries:<br/>    print(entry)</span></pre><h1 id="e224" class="ks kt hi bd ku kv kw kx ky kz la lb lc io ld ip le ir lf is lg iu lh iv li lj bi translated">创建实时表<a class="ae lk" href="https://docs-staging.deephaven.io/deploy-preview/62fea544f40f63e39c15c61788126fba18c07a99/blog/2022/01/13/reddit-sentiment-analysis/#create-a-real-time-table" rel="noopener ugc nofollow" target="_blank"> </a></h1><p id="b87f" class="pw-post-body-paragraph ix iy hi iz b ja ll ij jc jd lm im jf jg ln ji jj jk lo jm jn jo lp jq jr js hb bi translated">现在我们可以看到来自RSS提要的解析数据。为了将这些数据存储到Deephaven中，我们可以使用<a class="ae lk" href="https://docs-staging.deephaven.io/deploy-preview/62fea544f40f63e39c15c61788126fba18c07a99/core/docs/reference/table-operations/create/DynamicTableWriter/" rel="noopener ugc nofollow" target="_blank"> DynamicTableWriter </a>创建一个表并写入其中。</p><p id="a9a4" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们可以从RSS提要中选择任何属性来编写。对于这个例子，我们将只写每个条目的标题。</p><pre class="ju jv jw jx fd lu lt lv lw aw lx bi"><span id="6622" class="ly kt hi lt b fi lz ma l mb mc">from deephaven import DynamicTableWriter, Types as dht</span><span id="9371" class="ly kt hi lt b fi md ma l mb mc">column_names = ["Title"]<br/>column_types = [dht.string]</span><span id="f068" class="ly kt hi lt b fi md ma l mb mc">table_writer = DynamicTableWriter(column_names, column_types)</span><span id="8dd1" class="ly kt hi lt b fi md ma l mb mc">for entry in feed.entries:<br/>    title = entry["title"]<br/>    table_writer.logRow([title])</span><span id="a2fc" class="ly kt hi lt b fi md ma l mb mc">rss_table_titles = table_writer.getTable()</span></pre><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es me"><img src="../Images/02e045b0048051bc89aaba2efe94305c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SfYi1RyPK2cY8bGvKmE8RA.png"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">来源:作者图片</figcaption></figure><h1 id="abcb" class="ks kt hi bd ku kv kw kx ky kz la lb lc io ld ip le ir lf is lg iu lh iv li lj bi translated"><a class="ae lk" href="https://docs-staging.deephaven.io/deploy-preview/62fea544f40f63e39c15c61788126fba18c07a99/blog/2022/01/13/reddit-sentiment-analysis/#analyze-the-data" rel="noopener ugc nofollow" target="_blank">分析数据</a></h1><p id="4c0a" class="pw-post-body-paragraph ix iy hi iz b ja ll ij jc jd lm im jf jg ln ji jj jk lo jm jn jo lp jq jr js hb bi translated">有了包含来自RSS提要的标题的Deephaven表，我们可以利用数据收集有意义的见解。情感分析是分析文本数据最简单的方法之一。</p><p id="c2ef" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在Reddit feeds上执行情感分析可以让你分析特定人群在讨论什么。例如，您可以分析世界新闻子栏目，了解人们对当前全球事件的感受。你也可以说得更具体。可以分析视频游戏上的子主题来查看当前对游戏行业的情绪。如果有现场活动，例如E3，并且您想要获取正在发生的事情的实时信息，这可能特别有用。</p><p id="d6b0" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><a class="ae lk" href="https://www.nltk.org/" rel="noopener ugc nofollow" target="_blank"> Python NLTK包</a>有几种执行情感分析的方法。对于这个例子，我们将使用内置的<code class="du lq lr ls lt b"><a class="ae lk" href="https://www.nltk.org/api/nltk.sentiment.vader.html?highlight=sentimentintensityanalyzer#nltk.sentiment.vader.SentimentIntensityAnalyzer" rel="noopener ugc nofollow" target="_blank">SentimentIntensityAnalyzer</a></code>类。这个类有一个<code class="du lq lr ls lt b"><a class="ae lk" href="https://www.nltk.org/api/nltk.sentiment.vader.html?highlight=sentimentintensityanalyzer#nltk.sentiment.vader.SentimentIntensityAnalyzer.polarity_scores" rel="noopener ugc nofollow" target="_blank">polarity_scores</a></code>方法，返回给定字符串的情感分数。我们将使用一个Deephaven更新查询来将这个方法应用到我们的表中。</p><p id="f149" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">由于<code class="du lq lr ls lt b">polarity_scores</code>方法返回一个Python字典，我们将用一个返回列表的自定义函数包装它。这将使在Deephaven查询中使用这些值变得更加容易。我们还需要将方法调用转换为<code class="du lq lr ls lt b">org.jpy.PyListWrapper</code>类型。这将使Deephaven识别返回的列表。</p><pre class="ju jv jw jx fd lu lt lv lw aw lx bi"><span id="0819" class="ly kt hi lt b fi lz ma l mb mc">os.system("pip install nltk")</span><span id="3b86" class="ly kt hi lt b fi md ma l mb mc">import nltk<br/>nltk.download('vader_lexicon')<br/>from nltk.sentiment import SentimentIntensityAnalyzer</span><span id="b516" class="ly kt hi lt b fi md ma l mb mc">def <em class="mf">classifier_method</em>(classifier):<br/>    def <em class="mf">method</em>(strn):<br/>        sentiment = classifier.polarity_scores(strn)<br/>        return [sentiment["pos"], sentiment["neu"], sentiment["neg"], sentiment["compound"]]<br/>    return method</span><span id="ea1f" class="ly kt hi lt b fi md ma l mb mc">custom_polarity_scores = classifier_method(SentimentIntensityAnalyzer())</span><span id="5828" class="ly kt hi lt b fi md ma l mb mc">rss_table_analyzed = rss_table_titles.update("Sentiment = (org.jpy.PyListWrapper)custom_polarity_scores(Title)",<br/>    "Positive = (double)Sentiment[0]",<br/>    "Neutral = (double)Sentiment[1]",<br/>    "Negative = (double)Sentiment[2]",<br/>    "Compound = (double)Sentiment[3]"<br/>)</span></pre><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es me"><img src="../Images/e331901531743111be186168c86a09f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sIM4SF2dD1skhEZzKcApRQ.png"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">来源:作者图片</figcaption></figure><p id="925a" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在我们有了一个包含我们情感分析的专栏。下一步是生成统计数据。以下查询计算每个值的平均值、中值和标准偏差，以及正分数大于负分数的帖子的百分比。</p><pre class="ju jv jw jx fd lu lt lv lw aw lx bi"><span id="bf56" class="ly kt hi lt b fi lz ma l mb mc">from deephaven import Aggregation as agg, as_list</span><span id="cc26" class="ly kt hi lt b fi md ma l mb mc">agg_list = as_list([<br/>    agg.AggAvg("Avg_Positive = Positive", "Avg_Negative = Negative", "Avg_Neutral = Neutral", "Avg_Compound = Compound"),<br/>    agg.AggMed("Med_Positive = Positive", "Med_Negative = Negative", "Med_Neutral = Neutral", "Med_Compound = Compound"),<br/>    agg.AggStd("Std_Positive = Positive", "Std_Negative = Negative", "Std_Neutral = Neutral", "Std_Compound = Compound"),<br/>])</span><span id="ab65" class="ly kt hi lt b fi md ma l mb mc">rss_table_analyzed_statistics = rss_table_analyzed.aggBy(agg_list)<br/>rss_table_analyzed_positive_percent = rss_table_analyzed.update("PositiveCount = Positive &gt; Negative ? 1 : 0")\<br/>    .aggBy(as_list([agg.AggSum("PositiveCount"), agg.AggCount("TotalCount")]))\<br/>    .update("PositivePercent = PositiveCount / TotalCount")</span></pre><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es me"><img src="../Images/956ba17f16048e7351c5255b2a24f47c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gxKIIXPtoySfnUrsLVwxVw.png"/></div></div></figure><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es me"><img src="../Images/01e2d23053d6c6ef3531eb07eb5ba809.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9JashPHeymVqNGVQnphZMA.png"/></div></div></figure><h1 id="6dc2" class="ks kt hi bd ku kv kw kx ky kz la lb lc io ld ip le ir lf is lg iu lh iv li lj bi translated">根据自己的兴趣定制<a class="ae lk" href="https://docs-staging.deephaven.io/deploy-preview/62fea544f40f63e39c15c61788126fba18c07a99/blog/2022/01/13/reddit-sentiment-analysis/#tailor-to-your-own-interests" rel="noopener ugc nofollow" target="_blank"> </a></h1><p id="a190" class="pw-post-body-paragraph ix iy hi iz b ja ll ij jc jd lm im jf jg ln ji jj jk lo jm jn jo lp jq jr js hb bi translated">这个例子只是触及了RSS提要中丰富信息的皮毛。Deephaven examples repo包含一个<a class="ae lk" href="https://github.com/deephaven-examples/rss-sentiment-analysis" rel="noopener ugc nofollow" target="_blank">更复杂的示例</a>。我们提供了这段代码和扩展示例，作为使用Deephaven和您感兴趣的RSS提要的起点。如有任何问题或反馈，请联系<a class="ae lk" href="https://gitter.im/deephaven/deephaven" rel="noopener ugc nofollow" target="_blank"> Gitter </a>或我们的<a class="ae lk" href="https://github.com/deephaven/deephaven-core/discussions" rel="noopener ugc nofollow" target="_blank"> Github讨论</a>。我们希望收到您的来信。</p></div></div>    
</body>
</html>