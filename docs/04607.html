<html>
<head>
<title>Introduction to Prophet Algorithm</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">先知算法简介</h1>
<blockquote>原文：<a href="https://medium.com/codex/introduction-to-prophet-algorithm-a59e463a6c72?source=collection_archive---------1-----------------------#2021-12-18">https://medium.com/codex/introduction-to-prophet-algorithm-a59e463a6c72?source=collection_archive---------1-----------------------#2021-12-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="edde" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Prophet是一种流行的局部贝叶斯结构时间序列模型。</p><p id="227c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Prophet是一个用R和Python实现的预测程序，它速度很快，提供完全自动化的预测，可以由数据科学家和分析师手动调整。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/f8dc28d8b09c738f21eacac76dd263ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rK6AIMQvk1Pg5K1CzVxSSw.png"/></div></div></figure><h1 id="22e2" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">概观</h1><p id="fb59" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">预测是一项常见的数据科学任务，可帮助组织进行容量规划、目标设定和异常检测。</p><p id="aaa6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">尽管它很重要，但在生成可靠和高质量的预测方面存在严重的挑战，尤其是当存在各种时间序列并且具有时间序列建模专业知识的分析师相对较少时。</p><p id="7d4d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了应对这些挑战，我们描述了一种实用的“大规模”预测方法，该方法将可配置模型与分析师在环性能分析相结合。</p><p id="68cd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">具有可解释参数的模块化回归模型，具有时间序列领域知识的分析师可以直观地调整这些参数。</p><p id="0c63" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">性能分析比较和评估预测程序，并自动标记预测以进行人工审查和调整。</p><p id="fe01" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Prophet是一种基于加法模型预测时间序列数据的过程，在该模型中，非线性趋势与每年、每周和每天的季节性以及假日影响相适应。</p><p id="7fea" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">它最适用于具有强烈季节效应的时间序列和几个季节的历史数据。</p><p id="4c70" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Prophet对缺失数据和趋势变化非常稳健，通常能够很好地处理异常值。</p><p id="ef59" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Prophet是由脸书核心数据科学团队发布的开源软件。</p><h1 id="e960" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">先知如何工作</h1><p id="3bfb" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">Prophet对于以下数据集特别有用:</p><ul class=""><li id="9ab8" class="ks kt hi ih b ii ij im in iq ku iu kv iy kw jc kx ky kz la bi translated">包含更长时间(几个月或几年)的详细历史观察(每小时、每天或每周)</li><li id="9b6e" class="ks kt hi ih b ii lb im lc iq ld iu le iy lf jc kx ky kz la bi translated">具有多重强烈的季节性</li><li id="c8fe" class="ks kt hi ih b ii lb im lc iq ld iu le iy lf jc kx ky kz la bi translated">包括先前已知的重要但不规则的事件</li><li id="7179" class="ks kt hi ih b ii lb im lc iq ld iu le iy lf jc kx ky kz la bi translated">有缺失的数据点或大的异常值</li><li id="eb4a" class="ks kt hi ih b ii lb im lc iq ld iu le iy lf jc kx ky kz la bi translated">具有接近极限的非线性增长趋势。</li></ul><p id="0059" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Prophet是一个具有分段线性或逻辑增长曲线趋势的加性回归模型。它包括使用傅立叶级数建模的年度季节性成分和使用虚拟变量建模的每周季节性成分。</p><p id="f770" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">准确而快速。</strong></p><p id="e371" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在脸书，Prophet被广泛应用于为规划和目标设定提供可靠的预测。先知被发现在大多数情况下比任何其他方法表现更好。这个模型适合<strong class="ih hj"> <em class="lg">斯坦</em> </strong>这样你就能在几秒钟内得到预测。</p><blockquote class="lh li lj"><p id="b088" class="if ig lg ih b ii ij ik il im in io ip lk ir is it ll iv iw ix lm iz ja jb jc hb bi translated">Stan是用于统计建模和高性能统计计算的一流平台。</p></blockquote><p id="e8d9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">全自动</strong></p><p id="42cf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">无需人工操作，即可对杂乱的数据做出合理的预测。Prophet对异常值、缺失数据和时间序列中的剧烈变化非常稳健。</p><p id="c5eb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">可调预测</strong></p><p id="49b3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">prophet程序为用户提供了许多调整预测的可能性。您可以通过添加您的领域知识，使用人类可理解的参数来改进您的预测。</p><p id="7acb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">提供R或Python版本</strong></p><p id="7232" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以用R和Python实现prophet过程，但是它们共享相同的底层Stan代码来进行拟合。使用任何你觉得舒服的语言来获得预测。</p><h1 id="f773" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">Python实现</h1><pre class="je jf jg jh fd ln lo lp lq aw lr bi"><span id="f027" class="ls jq hi lo b fi lt lu l lv lw"># Python<br/>import pandas as pd<br/>from prophet import Prophet</span><span id="3404" class="ls jq hi lo b fi lx lu l lv lw"><strong class="lo hj">df = pd.read_csv('../examples/example_wp_log_peyton_manning.csv')<br/>df.head()</strong></span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ly"><img src="../Images/f24f007a30338639de8e3f3ed91cb352.png" data-original-src="https://miro.medium.com/v2/resize:fit:450/format:webp/1*5bw5aQjygKJpyikwV5SXOQ.png"/></div></figure><p id="ee7e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们通过实例化一个新的<code class="du lz ma mb lo b">Prophet</code>对象来适应这个模型。预测过程的任何设置都被传递到构造函数中。然后你调用它的<code class="du lz ma mb lo b">fit</code>方法，传入历史数据帧。安装需要1-5秒钟。</p><pre class="je jf jg jh fd ln lo lp lq aw lr bi"><span id="ebe3" class="ls jq hi lo b fi lt lu l lv lw"><strong class="lo hj">m = Prophet()<br/>m.fit(df)</strong></span></pre><p id="ddca" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后在一个数据框中进行预测，该数据框中有一列<code class="du lz ma mb lo b">ds</code>包含要进行预测的日期。您可以使用helper方法<code class="du lz ma mb lo b">Prophet.make_future_dataframe</code>获得一个合适的数据帧，该数据帧延伸到未来指定的天数。默认情况下，它还将包括历史中的日期，因此我们将看到模型也是合适的。</p><pre class="je jf jg jh fd ln lo lp lq aw lr bi"><span id="1b39" class="ls jq hi lo b fi lt lu l lv lw"><strong class="lo hj">future = m.make_future_dataframe(periods=365)<br/>future.tail()</strong></span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mc"><img src="../Images/5f65febd06904a314c6696eb651630b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:342/format:webp/1*TnTPntomPDuxU4CwWF2WLg.png"/></div></figure><p id="5e92" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该<code class="du lz ma mb lo b">predict</code>方法将为<code class="du lz ma mb lo b">future</code>中的每一行分配一个预测值，将其命名为<code class="du lz ma mb lo b">yhat</code>。如果您传入历史日期，它将提供样本内拟合。这里的<code class="du lz ma mb lo b">forecast</code>对象是一个新的数据框，包括一个包含预测的列<code class="du lz ma mb lo b">yhat</code>，以及组件和不确定性区间的列。</p><pre class="je jf jg jh fd ln lo lp lq aw lr bi"><span id="3871" class="ls jq hi lo b fi lt lu l lv lw">forecast = m.predict(future)<br/>forecast[['ds', 'yhat', 'yhat_lower', 'yhat_upper']].tail()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es md"><img src="../Images/c4fd53de4c1e7efb0129639cb8b7b502.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*m3FdC33nW1uDnv3CKZXI9Q.png"/></div></figure><p id="6b7c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可以通过调用<code class="du lz ma mb lo b">Prophet.plot</code>方法并传递您的预测数据框来绘制预测。</p><pre class="je jf jg jh fd ln lo lp lq aw lr bi"><span id="bbb3" class="ls jq hi lo b fi lt lu l lv lw">fig1 = m.plot(forecast)</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es me"><img src="../Images/17f53ad3be0fc4c6488905abf650ac5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/1*kPWncmkZJI7G6H6Ncwjn4w.png"/></div></figure><p id="41d6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您想查看预测组件，您可以使用<code class="du lz ma mb lo b">Prophet.plot_components</code>方法。默认情况下，您将看到时间序列的趋势、年季节性和周季节性。如果你包括假期，你也会在这里看到。</p><pre class="je jf jg jh fd ln lo lp lq aw lr bi"><span id="1db8" class="ls jq hi lo b fi lt lu l lv lw">fig2 = m.plot_components(forecast)</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es me"><img src="../Images/afc2fa5abc8ab13a1d113d1f81f0b3a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/0*lny291nm9u9tJlpK.png"/></div></figure><p id="912f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">可以用Plotly创建预测和组件的交互图形。您需要单独安装Plotly 4.0或更高版本，因为默认情况下它不会与prophet一起安装。您还需要安装<code class="du lz ma mb lo b">notebook</code>和<code class="du lz ma mb lo b">ipywidgets</code>软件包。</p><pre class="je jf jg jh fd ln lo lp lq aw lr bi"><span id="6323" class="ls jq hi lo b fi lt lu l lv lw"><strong class="lo hj">from prophet.plot import plot_plotly, plot_components_plotly<br/><br/>plot_plotly(m, forecast)</strong></span><span id="4e63" class="ls jq hi lo b fi lx lu l lv lw">plot_components_plotly(m, forecast)</span></pre><h1 id="cc7f" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">参考</h1><div class="mf mg ez fb mh mi"><a href="https://mc-stan.org/" rel="noopener  ugc nofollow" target="_blank"><div class="mj ab dw"><div class="mk ab ml cl cj mm"><h2 class="bd hj fi z dy mn ea eb mo ed ef hh bi translated">斯坦</h2><div class="mp l"><h3 class="bd b fi z dy mn ea eb mo ed ef dx translated">Stan是用于统计建模和高性能统计计算的一流平台。成千上万的…</h3></div><div class="mq l"><p class="bd b fp z dy mn ea eb mo ed ef dx translated">mc-stan.org</p></div></div><div class="mr l"><div class="ms l mt mu mv mr mw jn mi"/></div></div></a></div><div class="mf mg ez fb mh mi"><a href="https://facebook.github.io/prophet/docs/quick_start.html#python-ap" rel="noopener  ugc nofollow" target="_blank"><div class="mj ab dw"><div class="mk ab ml cl cj mm"><h2 class="bd hj fi z dy mn ea eb mo ed ef hh bi translated">快速启动</h2><div class="mp l"><h3 class="bd b fi z dy mn ea eb mo ed ef dx translated">Prophet遵循sklearn模型API。我们创建一个Prophet类的实例，然后调用它的fit和predict…</h3></div><div class="mq l"><p class="bd b fp z dy mn ea eb mo ed ef dx translated">facebook.github.io</p></div></div><div class="mr l"><div class="mx l mt mu mv mr mw jn mi"/></div></div></a></div><div class="mf mg ez fb mh mi"><a href="https://peerj.com/preprints/3190/" rel="noopener  ugc nofollow" target="_blank"><div class="mj ab dw"><div class="mk ab ml cl cj mm"><h2 class="bd hj fi z dy mn ea eb mo ed ef hh bi translated">大规模预测</h2><div class="mp l"><h3 class="bd b fi z dy mn ea eb mo ed ef dx translated">预测是一项常见的数据科学任务，可帮助组织进行容量规划、目标设定和异常情况预测…</h3></div><div class="mq l"><p class="bd b fp z dy mn ea eb mo ed ef dx translated">peerj.com</p></div></div><div class="mr l"><div class="my l mt mu mv mr mw jn mi"/></div></div></a></div></div><div class="ab cl mz na gp nb" role="separator"><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne"/></div><div class="hb hc hd he hf"><blockquote class="lh li lj"><p id="001d" class="if ig lg ih b ii ij ik il im in io ip lk ir is it ll iv iw ix lm iz ja jb jc hb bi translated">如果你学到了新东西或者喜欢阅读这篇文章，请鼓掌👏并分享给其他人看。也可以随意发表评论。💬</p></blockquote></div></div>    
</body>
</html>