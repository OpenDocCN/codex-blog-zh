<html>
<head>
<title>ACO Architecture: 5 Tips to Auto-CostOptimization on AWS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ACO架构:AWS自动成本优化的5个技巧</h1>
<blockquote>原文：<a href="https://medium.com/codex/aco-architecture-5-tips-to-auto-costoptimization-on-aws-67f026e3abcc?source=collection_archive---------18-----------------------#2021-05-10">https://medium.com/codex/aco-architecture-5-tips-to-auto-costoptimization-on-aws-67f026e3abcc?source=collection_archive---------18-----------------------#2021-05-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="37fd" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">第1部分:ACO架构</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/4dc20c65adb915241ef8955dc8661b11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P9l3yqcWKZy-9CnSkW32PQ.jpeg"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">AACO—AWS上的成本优化</figcaption></figure><p id="5e8f" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">我记得我在AWS的第一笔账单是2016年的5美元，我知道我有一年的免费期😠，我很震惊，因为我确定我只使用了免费服务中包含的服务。</p><p id="b325" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">然而，当我研究我的账单时，我发现我选择了<strong class="jp hj">开发者支持</strong>，并且不包括在免费层中😛。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es kj"><img src="../Images/ee6e11ef052a2c222b5af69742c9f965.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nx5OcpqZ201oPNI8Y3UHuw.jpeg"/></div></div></figure><blockquote class="kk"><p id="41fa" class="kl km hi bd kn ko kp kq kr ks kt ki dx translated">结论:无知是昂贵的😲</p></blockquote></div><div class="ab cl ku kv gp kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="hb hc hd he hf"><p id="7631" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">AWS上的预算是一个如此重要的方面，一个<strong class="jp hj">架构师</strong>必须负责。我们总是可以建议一个好看的架构，将微服务绑定到具有托管服务的无服务器等…💪</p><p id="0310" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">但是如果到了月底账单太高，我们就有问题了😅</p><p id="3dfc" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">架构良好的AWS基于五大支柱:卓越运营、安全性、可靠性、性能效率和<strong class="jp hj">成本优化</strong>。</p><p id="e101" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">我们将在这个故事中讨论第五个。</p></div><div class="ab cl ku kv gp kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="hb hc hd he hf"><p id="37a1" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">更多关于我的故事</p><div class="lb lc ez fb ld le"><a href="https://naoufal-gafa.medium.com/" rel="noopener follow" target="_blank"><div class="lf ab dw"><div class="lg ab lh cl cj li"><h2 class="bd hj fi z dy lj ea eb lk ed ef hh bi translated">纳乌法勒·GAFA-中等</h2><div class="ll l"><h3 class="bd b fi z dy lj ea eb lk ed ef dx translated">作为一名软件架构师或全栈开发人员(有开发背景的人)，我总是害怕…</h3></div><div class="lm l"><p class="bd b fp z dy lj ea eb lk ed ef dx translated">naoufal-gafa.medium.com</p></div></div><div class="ln l"><div class="lo l lp lq lr ln ls jh le"/></div></div></a></div></div><div class="ab cl ku kv gp kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="hb hc hd he hf"><h1 id="a7a1" class="lt lu hi bd lv lw lx ly lz ma mb mc md io me ip mf ir mg is mh iu mi iv mj mk bi translated">成本优化</h1><p id="190f" class="pw-post-body-paragraph jn jo hi jp b jq ml ij js jt mm im jv jw mn jy jz ka mo kc kd ke mp kg kh ki hb bi translated">成本优化支柱侧重于避免不必要的成本。关键主题包括了解和控制资金的支出，选择最合适的资源类型，分析一段时间内的支出，以及在不超支的情况下进行扩展以满足业务需求。</p><p id="20f4" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">AWS已经制定了一份<a class="ae mq" href="https://docs.aws.amazon.com/wellarchitected/latest/cost-optimization-pillar/cost-optimization.html" rel="noopener ugc nofollow" target="_blank">白皮书</a>，对成本优化的最佳实践进行了分组，以帮助公司，但我会像往常一样让它变得简单，我会向您展示一些在您的不同服务中通过使用<strong class="jp hj"> AWS预算</strong>、<strong class="jp hj"> SNS和Lambda实现<strong class="jp hj"> ACO架构(自动成本优化)</strong>进行成本优化的技巧。</strong></p><blockquote class="mr ms mt"><p id="bf3a" class="jn jo mu jp b jq jr ij js jt ju im jv mv jx jy jz mw kb kc kd mx kf kg kh ki hb bi translated">如果你有一个<strong class="jp hj">个人AWS账户</strong>，这个提示会很有效。</p><p id="524a" class="jn jo mu jp b jq jr ij js jt ju im jv mv jx jy jz mw kb kc kd mx kf kg kh ki hb bi translated">如果你属于AWS组织或者你是一家公司，它们是FinOps的其他高级工具</p></blockquote><h1 id="d8ff" class="lt lu hi bd lv lw my ly lz ma mz mc md io na ip mf ir nb is mh iu nc iv mj mk bi translated">实现ACO架构的5个技巧:</h1><p id="1fbb" class="pw-post-body-paragraph jn jo hi jp b jq ml ij js jt mm im jv jw mn jy jz ka mo kc kd ke mp kg kh ki hb bi translated">ACO架构基于一个简单的反射:</p><blockquote class="kk"><p id="d063" class="kl km hi bd kn ko nd ne nf ng nh ki dx translated"><strong class="ak">如果我的花费预算达到我的阈值的X%,我将停止、暂停或其他适当的服务</strong>👌<strong class="ak">。</strong></p></blockquote><p id="961b" class="pw-post-body-paragraph jn jo hi jp b jq ni ij js jt nj im jv jw nk jy jz ka nl kc kd ke nm kg kh ki hb bi translated">你有两个选择:</p><ul class=""><li id="3ba0" class="nn no hi jp b jq jr jt ju jw np ka nq ke nr ki ns nt nu nv bi translated"><strong class="jp hj">成本预算</strong>:基于具体金额。(例如20美元)</li><li id="453f" class="nn no hi jp b jq nw jt nx jw ny ka nz ke oa ki ns nt nu nv bi translated"><strong class="jp hj">使用预算</strong>:基于<strong class="jp hj">服务使用</strong>。(例如Ec2数据传输、ECS Fargat vCPU小时数)</li></ul><p id="73d8" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在这个故事中，我将关注<strong class="jp hj">使用预算</strong></p><h2 id="cf01" class="ob lu hi bd lv oc od oe lz of og oh md jw oi oj mf ka ok ol mh ke om on mj oo bi translated">I -抽象建筑:</h2><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es op"><img src="../Images/dc6a2fc9c72fa4e8d8735019f30132f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3loM43AIuE0h7JESaq9Z6w.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">抽象ACO架构</figcaption></figure><blockquote class="mr ms mt"><p id="420a" class="jn jo mu jp b jq jr ij js jt ju im jv mv jx jy jz mw kb kc kd mx kf kg kh ki hb bi translated"><strong class="jp hj">总结一下这个架构:</strong></p><p id="de60" class="jn jo mu jp b jq jr ij js jt ju im jv mv jx jy jz mw kb kc kd mx kf kg kh ki hb bi translated">我<strong class="jp hj">创建</strong>一个<strong class="jp hj">预算</strong>在我<strong class="jp hj">为我的<strong class="jp hj">使用服务</strong>定义</strong>一个<strong class="jp hj">阈值</strong>到<strong class="jp hj">发送</strong>一个<strong class="jp hj">提醒</strong>到一个<strong class="jp hj">特定的SNS主题</strong>这将<strong class="jp hj">触发</strong>一个<strong class="jp hj"> Lambda </strong>到——停止、暂停或者任何你想要的——<strong class="jp hj">指定服务</strong>。</p></blockquote><h2 id="f82b" class="ob lu hi bd lv oc od oe lz of og oh md jw oi oj mf ka ok ol mh ke om on mj oo bi translated">II - 5实施技巧:</h2><ol class=""><li id="0d8f" class="nn no hi jp b jq ml jt mm jw oq ka or ke os ki ot nt nu nv bi translated">参考您的<strong class="jp hj"> M-1 </strong>(上月…)账单，了解您需要哪些服务来优化成本。</li><li id="11f2" class="nn no hi jp b jq nw jt nx jw ny ka nz ke oa ki ot nt nu nv bi translated">从相关服务中提取<strong class="jp hj">使用类型类别</strong>、<strong class="jp hj">使用类型</strong>和<strong class="jp hj">使用</strong>，如下图所示(M-1 的<strong class="jp hj">账单)。<strong class="jp hj">“我们将在下一个故事中使用它”</strong></strong></li><li id="fa23" class="nn no hi jp b jq nw jt nx jw ny ka nz ke oa ki ot nt nu nv bi translated">创建<strong class="jp hj">预算</strong>并定义阈值——基于您的<strong class="jp hj">使用类型&amp;每月使用量</strong></li><li id="df1c" class="nn no hi jp b jq nw jt nx jw ny ka nz ke oa ki ot nt nu nv bi translated"><strong class="jp hj">向一个<strong class="jp hj"> SNS主题</strong>发送预算提醒</strong>，如果花费的预算达到<strong class="jp hj">定义的阈值</strong>的一个<strong class="jp hj"> X% </strong>时，触发<strong class="jp hj"> </strong>一个<strong class="jp hj">λ</strong>到<strong class="jp hj">停止/暂停</strong>你的<strong class="jp hj">特定服务</strong></li><li id="53e1" class="nn no hi jp b jq nw jt nx jw ny ka nz ke oa ki ot nt nu nv bi translated">将适当的<strong class="jp hj">策略&amp;权限</strong>分配给<strong class="jp hj"> Lambda &amp; SNS主题</strong></li></ol><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ou"><img src="../Images/b5640d760a95a97f300dea92dc461887.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jCFp5trLKJMDPVPlD8cHFA.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">M-1的账单</figcaption></figure><h1 id="784f" class="lt lu hi bd lv lw my ly lz ma mz mc md io na ip mf ir nb is mh iu nc iv mj mk bi translated">结论</h1><p id="ccad" class="pw-post-body-paragraph jn jo hi jp b jq ml ij js jt mm im jv jw mn jy jz ka mo kc kd ke mp kg kh ki hb bi translated">如您所见，自动成本优化的基本实现并不复杂。您可以在您的个人项目中应用这种架构，以避免花费大量资金。</p><p id="d5c6" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在下一篇文章中，我将通过制作一个<strong class="jp hj"> Terraform文件</strong>来用AWS服务<strong class="jp hj">“ECS Fargate容器”</strong>实现这个<strong class="jp hj">抽象ACO架构</strong>，您可以简单地根据自己的需要进行调整和使用。</p><p id="0225" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">对于那些还不知道如何用Terraform和DevOps自动化AWS架构的人，你可以参考我之前的故事:</p><div class="lb lc ez fb ld le"><a href="https://levelup.gitconnected.com/aws-s3m-pattern-terraform-devops-for-a-10-years-child-dac4610017ff" rel="noopener  ugc nofollow" target="_blank"><div class="lf ab dw"><div class="lg ab lh cl cj li"><h2 class="bd hj fi z dy lj ea eb lk ed ef hh bi translated">AWS S3M模式:适用于10岁儿童的Terraform和DevOps</h2><div class="ll l"><h3 class="bd b fi z dy lj ea eb lk ed ef dx translated">第2部分:地形和开发</h3></div><div class="lm l"><p class="bd b fp z dy lj ea eb lk ed ef dx translated">levelup.gitconnected.com</p></div></div><div class="ln l"><div class="ov l lp lq lr ln ls jh le"/></div></div></a></div><p id="5276" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">谢谢你阅读我的故事🙏</p><p id="2fa4" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">如果你喜欢，就分享吧😜如果您有任何意见，或者有什么不清楚的地方，请在我的<a class="ae mq" href="https://www.facebook.com/neogafa" rel="noopener ugc nofollow" target="_blank"> Fb页面</a>、<a class="ae mq" href="https://twitter.com/NaoufalGafa" rel="noopener ugc nofollow" target="_blank"> Twitter </a>或通过<a class="ae mq" href="https://www.elgafa.com/" rel="noopener ugc nofollow" target="_blank">我的网站</a>发表评论或联系我</p></div></div>    
</body>
</html>