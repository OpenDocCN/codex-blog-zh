<html>
<head>
<title>Data Cleaning in Python with NumPy and Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用NumPy和Pandas实现Python中的数据清洗</h1>
<blockquote>原文：<a href="https://medium.com/codex/data-cleaning-in-python-with-numpy-and-pandas-3776f9a6e77f?source=collection_archive---------3-----------------------#2021-07-18">https://medium.com/codex/data-cleaning-in-python-with-numpy-and-pandas-3776f9a6e77f?source=collection_archive---------3-----------------------#2021-07-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/89389cc83787c1194d7431181445de0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*udmy2yge3e4a78hCty5Fxg.jpeg"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">善良好奇的在<a class="ae hv" href="https://unsplash.com/s/photos/bubbles?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的<a class="ae hv" href="https://unsplash.com/@kindandcurious?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"/></figcaption></figure><div class=""/><p id="af5f" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">一个有抱负的、使用python的数据科学家必须学习的第一个实用程序包括numpy和pandas。所有这些都为数据科学家提供了各种各样的工具来应用全面的分析并找到深刻的见解，但是由于内置了如此多的函数和属性，一开始可能很难知道使用哪一个。</p><p id="e5a4" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">一旦数据科学家手中有了好的数据，他们必须首先探索和处理数据，以确保数据便于分析、可视化和机器学习。<a class="ae hv" href="https://numpy.org/doc/stable/reference/generated/numpy.where.html" rel="noopener ugc nofollow" target="_blank">根据Anaconda </a>的一项民意调查，数据科学家45%的时间用于数据准备任务，比如数据清理。您的里程可能会有所不同，但您应该会发现专注于清洁会产生显著的效果，甚至比巧妙的功能工程或繁琐的超参数调整更有效果。</p><p id="bc34" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">下面，我概述了一些基本函数，它们可以完成数据清理中的任何任务。若要开始，首先必须通过导入关键包并读入数据来设置笔记本。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="32f0" class="kc kd hy jy b fi ke kf l kg kh"># import your packages<br/>import numpy as np<br/>import pandas as pd</span><span id="4a67" class="kc kd hy jy b fi ki kf l kg kh"># read in your data<br/>df = pd.read_csv("data/<br/>dataset.csv")</span></pre><h1 id="1d52" class="kj kd hy bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">基本数字和熊猫工具</h1><h2 id="1509" class="kc kd hy bd kk lg lh li ko lj lk ll ks jg lm ln kw jk lo lp la jo lq lr le ls bi translated">首先-检查空值</h2><figure class="jt ju jv jw fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lt"><img src="../Images/776b12efebc2b5f82321f04f64d153bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7T-0FZ0T0qC-aPjr5t5zvA.jpeg"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">照片由<a class="ae hv" href="https://unsplash.com/@hnhmarketing?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">亨特·哈利</a>在<a class="ae hv" href="https://unsplash.com/s/photos/tools?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="de37" class="kc kd hy jy b fi ke kf l kg kh">df.isna().sum()</span></pre><p id="0512" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在任何初始EDA中，检查数据中的空值都是首要任务。还有其他一些熊猫方法，比如<strong class="ix hz">。头()</strong> / <strong class="ix hz">。尾巴()</strong>，<strong class="ix hz">。描述()</strong>和<strong class="ix hz">。info() </strong>，组合使用<strong class="ix hz">。isna() </strong>后跟<strong class="ix hz">。数据框架变量上的sum() </strong>是应该用来检查数据的首要工具之一。它计算每一列中的空值，并报告每一列中缺少值的单元格的总数，这使您可以看到在清理时应该首先注意的地方。</p><h2 id="a45c" class="kc kd hy bd kk lg lh li ko lj lk ll ks jg lm ln kw jk lo lp la jo lq lr le ls bi translated">操作数据类型</h2><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="0279" class="kc kd hy jy b fi ke kf l kg kh">df['date'] = pd.to_datetime(df.date)</span></pre><p id="313c" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Pandas系列有统一的数据类型——稍后会详细介绍。可以用<strong class="ix hz"> df.info() </strong>检查数据帧中每一列内容的数据类型。如果您有一个明确包含日期的列，尝试使用<strong class="ix hz"> pd.to_datetime() </strong>将数据强制转换为适当的日期时间格式。</p><p id="e8a0" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">类似地，如果您注意到一个列包含数字，但是显示非数字对象作为该列的数据类型，尝试通过使用<strong class="ix hz"> pd.to_numeric() </strong>将该列强制转换为int64或float64数据类型。</p><h2 id="60dc" class="kc kd hy bd kk lg lh li ko lj lk ll ks jg lm ln kw jk lo lp la jo lq lr le ls bi translated">更正条件值</h2><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="314a" class="kc kd hy jy b fi ke kf l kg kh">np.where()</span></pre><p id="e963" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hz"> np.where() </strong>是用于数据清理的瑞士军刀多工具。它几乎可以用于数据集上的任何纠正操作。它需要三个参数:</p><figure class="jt ju jv jw fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lu"><img src="../Images/903ab44abd28b3442f013e3abc0e7cad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rx7ieFoK6dGNeuwJNx9hvA.jpeg"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">由<a class="ae hv" href="https://unsplash.com/@pf91_photography?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">帕特里克</a>在<a class="ae hv" href="https://unsplash.com/s/photos/swiss-army-knife?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><ol class=""><li id="1ce4" class="lv lw hy ix b iy iz jc jd jg lx jk ly jo lz js ma mb mc md bi translated">您想要进行的更改必须满足的一个(或多个)条件。</li><li id="058f" class="lv lw hy ix b iy me jc mf jg mg jk mh jo mi js ma mb mc md bi translated">如果满足上述条件，您希望进行的更改的值。</li><li id="81ff" class="lv lw hy ix b iy me jc mf jg mg jk mh jo mi js ma mb mc md bi translated">当上述条件<em class="mj">不满足</em>时应使用的值。</li></ol><p id="c5a2" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">替换空值？你去过了吗？一键编码？你可以用<strong class="ix hz"> np.where() </strong>做到这一点。管理异常值，修复数据输入错误或使相似的条目一致？<strong class="ix hz"> np.where() </strong>整天。</p><h2 id="e7c2" class="kc kd hy bd kk lg lh li ko lj lk ll ks jg lm ln kw jk lo lp la jo lq lr le ls bi translated">删除重复项和错误</h2><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="a1de" class="kc kd hy jy b fi ke kf l kg kh">df.drop(index=21500, inplace=<strong class="jy hz">True</strong>) </span><span id="be0a" class="kc kd hy jy b fi ki kf l kg kh"># The index number may be any integer corresponding to the index of the row you would like to drop.</span></pre><p id="b887" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hz">。drop() </strong> inplace在您想要删除单个行项目时特别有用。每当您识别出明显重复的数据行或错误的数据条目时，请使用此选项。当心仅仅因为你不喜欢内容，或者因为它不符合你的期望而删除行项目——删除行会使你的数据有偏差。</p><h2 id="7c53" class="kc kd hy bd kk lg lh li ko lj lk ll ks jg lm ln kw jk lo lp la jo lq lr le ls bi translated">使用索引数组。应用()和lambda</h2><p id="b9d2" class="pw-post-body-paragraph iv iw hy ix b iy mk ja jb jc ml je jf jg mm ji jj jk mn jm jn jo mo jq jr js hb bi translated">想象一个场景，其中数据集拥有一列，每一行的单元格包含一个项目数组——一个由逗号分隔并用方括号括起来的集合。您希望引用数组中的项目。不幸的是，这样做并不像看起来那么简单。</p><figure class="jt ju jv jw fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mp"><img src="../Images/1dfbf3f2ecd412ecb147975d84dd029f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iB5mKo9MUP9sjR8oPM-RpQ.jpeg"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">照片由<a class="ae hv" href="https://unsplash.com/@thisisengineering?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">该工程在<a class="ae hv" href="https://unsplash.com/s/photos/math?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上绘制</a></figcaption></figure><p id="c9fe" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">通常使用python，可以通过返回列表变量名，后跟包含所需项目索引号的方括号来引用列表或数组的项目。然而，对于pandas，DataFrame列是pandas <em class="mj">系列，</em>锁定统一的数据类型，即包含文本和数值的列会将其内容作为“对象”列出。同样，如果一个列包含类似python列表的数字项。因此，pandas会将一个似乎包含数组或列表的单元格评估为一个对象(或字符串)，并且尝试在数据帧中索引这样的数组或列表会简单地返回字符串索引处的<em class="mj">字符</em>。</p><p id="837a" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果您想避开这个经常令人沮丧的特性(由于与<a class="ae hv" rel="noopener" href="/analytics-vidhya/understanding-vectorization-in-numpy-and-pandas-188b6ebc5398">矢量化</a>相关的原因，它确实是一个特性)，您可以像处理列表一样使用如下表达式来处理对象列内容:</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="55ab" class="kc kd hy jy b fi ke kf l kg kh">df['kcal'] = df.nutrition.apply(<strong class="jy hz">lambda</strong> x: x[1:-1].split(sep=', ')[0])</span><span id="740d" class="kc kd hy jy b fi ki kf l kg kh">df['fat'] = df.nutrition.apply(<strong class="jy hz">lambda</strong> x: x[1:-1].split(sep=', ')[1])</span><span id="cf56" class="kc kd hy jy b fi ki kf l kg kh">df['sugar'] = df.nutrition.apply(<strong class="jy hz">lambda</strong> x: x[1:-1].split(sep=', ')[2])</span></pre><p id="3a67" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这个例子中，我有一个食谱数据集，每行代表一个独特的食谱。数据集有一个“营养”列，每个行项目都有一个浮点数数组。每行数组中该列的第一个数字是食谱的卡路里数，第二个数字是脂肪含量，等等。如果我想将每个食谱的营养统计数据分离到它们自己的列中，我会以上面的方式这样做，为每个营养信息统计数据创建单独的列。</p><h1 id="cd14" class="kj kd hy bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">最后的想法</h1><figure class="jt ju jv jw fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mq"><img src="../Images/2c2ff031289acdfa28ac47596d81b585.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gJqsbM7WiPiGK2YUKt4qJQ.jpeg"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">约书亚·厄尔在<a class="ae hv" href="https://unsplash.com/s/photos/beach-sprint?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><h2 id="2293" class="kc kd hy bd kk lg lh li ko lj lk ll ks jg lm ln kw jk lo lp la jo lq lr le ls bi translated">组织是关键</h2><p id="3bd6" class="pw-post-body-paragraph iv iw hy ix b iy mk ja jb jc ml je jf jg mm ji jj jk mn jm jn jo mo jq jr js hb bi translated">将您的笔记本分成与跨行业数据挖掘标准流程(CRISP-DM)中的步骤相对应的几个部分，可以为查看您的笔记本的任何人提供渐进的工作流程和易读性。此外，确保您的清理过程按照您最初进行更改的顺序进行迭代，这样，当您在重新启动内核后尝试重新运行笔记本单元格时，您就不会从包含数据清理代码的单元格中获得python错误。</p><p id="5273" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Jupyter Notebook的nbextensions对组织非常有用——我总是在打开<strong class="ix hz">目录</strong>(目录)和<strong class="ix hz">可折叠标题</strong>的情况下工作。</p><h2 id="49ba" class="kc kd hy bd kk lg lh li ko lj lk ll ks jg lm ln kw jk lo lp la jo lq lr le ls bi translated">具有可操作性</h2><p id="b5b3" class="pw-post-body-paragraph iv iw hy ix b iy mk ja jb jc ml je jf jg mm ji jj jk mn jm jn jo mo jq jr js hb bi translated">当面对数据似乎不正确的困境时，想想什么行动最有意义，做出适当的改变，并在笔记本上写下你的推理。通常，最重要的事情是做出合理的决定，并继续进行清理和执行分析，而不是陷入决策瘫痪，或花费数小时寻找更多信息来支持您的推理。</p><h1 id="5f1f" class="kj kd hy bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">进一步阅读</h1><p id="16d9" class="pw-post-body-paragraph iv iw hy ix b iy mk ja jb jc ml je jf jg mm ji jj jk mn jm jn jo mo jq jr js hb bi translated">Dean McGrath为<em class="mj">走向数据科学</em>，<a class="ae hv" href="https://towardsdatascience.com/data-cleaning-using-python-pandas-f6fadc433535" rel="noopener" target="_blank">数据清洗使用Python熊猫</a></p><p id="5142" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Neelutiwari负责<em class="mj">分析Vidhya </em>，<a class="ae hv" href="https://www.analyticsvidhya.com/blog/2021/06/data-cleaning-using-pandas/" rel="noopener ugc nofollow" target="_blank">数据清理使用熊猫</a></p></div></div>    
</body>
</html>