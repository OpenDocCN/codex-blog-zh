<html>
<head>
<title>Promises and more…</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">承诺和更多…</h1>
<blockquote>原文：<a href="https://medium.com/codex/promises-and-more-35ca552d593?source=collection_archive---------18-----------------------#2022-05-19">https://medium.com/codex/promises-and-more-35ca552d593?source=collection_archive---------18-----------------------#2022-05-19</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="1408" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">人们经常混淆承诺是异步的。但是它们真的是异步的吗？Promise可以说是JavaScript中异步编程最重要的概念，然而，传递给Promise构造函数的回调的执行是<strong class="ih hj">同步的</strong>。</p><p id="faf8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们用一个例子来理解同样的道理:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/1964db5dbe9f668b88d5f7529de8d887.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VAtgGIVYcXMKBmneYHCHKQ.png"/></div></div></figure><p id="7d0c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">就像你看到的，当函数被调用时，回调传递到同步执行的承诺构造函数<strong class="ih hj"/>，因为它没有等待承诺解决就登录<em class="jp">【但是我是同步的】</em>到控制台。<br/>是<strong class="ih hj"><em class="jp">’。然后异步执行<strong class="ih hj">的</strong></em>链</strong>。</p><p id="083f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这引出了另一个问题！</p><p id="545f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">自<em class="jp">。那么()</em> </strong>块是异步的，它是否期望一个<strong class="ih hj">承诺作为回报</strong> <strong class="ih hj">总是</strong>？</p><p id="ce4c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">答案是<strong class="ih hj">不！</strong></p><p id="3202" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当你启动<strong class="ih hj">时<em class="jp">。然后()</em> </strong>链，然后初始<strong class="ih hj"> <em class="jp">然后</em> </strong>块期待一个承诺的回报，但此后，当你链多个<strong class="ih hj"> <em class="jp">然后</em> </strong>块时，它们<strong class="ih hj"> <em class="jp">可能会也可能不会</em> </strong>收到一个承诺的回报。</p><p id="88ff" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们看一个同样的例子:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jq"><img src="../Images/596e3c304018c4c9f1bdbbb8fa36f665.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uuIJgYChaNL09YeYfcDONw.png"/></div></div></figure><p id="fd7a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们开始了，第二个<strong class="ih hj"> <em class="jp">然后</em> </strong>块，没有得到承诺的回报，但，工作得很好！</p><p id="8da2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们都知道，一个承诺既可以是<strong class="ih hj"> <em class="jp">解决</em> </strong>也可以是<strong class="ih hj"> <em class="jp">拒绝</em> </strong>。这引起了人们的好奇，我们是否可以处理在<strong class="ih hj"> <em class="jp"> try/catch </em> </strong>块中拒绝承诺的情况，或者是否可以强制将<strong class="ih hj"> <em class="jp"> catch </em> </strong>块锁在<strong class="ih hj"> <em class="jp">块之后，然后锁在</em> </strong>块中。</p><p id="8cc2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有什么猜测吗？让我们看看！</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jr"><img src="../Images/b26136e1286e7fb5ecfdc615f6935c52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*olYvlJZQ8o9TTldCAWErwg.png"/></div></div></figure><p id="41b4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jp">预料到这个结果还是有点惊讶？嗯，JS就像生活一样，随时都可能让你大吃一惊。</em></p><p id="7339" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当一个承诺被拒绝时，错误被链中的<em class="jp"> catch块捕获，该链中的承诺被期望作为回报。</em></p><p id="53aa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以，我们不能用<strong class="ih hj"> <em class="jp"> try/catch </em> </strong>来处理被拒绝的承诺？</p><p id="9733" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以！</p><p id="b606" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="jp">异步/恭候</em> </strong>前来救援！</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es js"><img src="../Images/0c4da06c2e3b4c4458c3e899fd5b7d9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I-GNoVjpfYWNCQ_Z4_tRsQ.png"/></div></div></figure><p id="161c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">随着<strong class="ih hj"> <em class="jp"> async/await </em> </strong>的实现，我们确保承诺在那里被解决/拒绝。一旦它被拒绝，<strong class="ih hj"> <em class="jp"> try/catch </em> </strong>的<strong class="ih hj"> <em class="jp"> catch </em> </strong>块处理它，当它返回消息时，<strong class="ih hj"> <em class="jp">然后阻塞</em> </strong>其中<strong class="ih hj"> <em class="jp">期待一个承诺</em> </strong>，从一个<strong class="ih hj"> <em class="jp">异步函数</em> </strong>隐式<strong class="ih hj"> <em class="jp"> </em> </strong>中获取响应，包装在一个<strong class="ih hj"> <em class="jp">中</em></strong></p><p id="37eb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当你在这里的时候，答应我鼓掌？我不是那么好的捕手，所以请不要拒绝！无红利</p><p id="af97" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">干杯！</p></div></div>    
</body>
</html>