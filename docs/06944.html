<html>
<head>
<title>Creating a simple database using Python and SQLite</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python和SQLite创建简单的数据库</h1>
<blockquote>原文：<a href="https://medium.com/codex/creating-a-simple-database-using-python-and-sqlite-349d126253da?source=collection_archive---------3-----------------------#2022-05-21">https://medium.com/codex/creating-a-simple-database-using-python-and-sqlite-349d126253da?source=collection_archive---------3-----------------------#2022-05-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="c092" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">还有如何用熊猫来看它们，它更漂亮</h2></div><p id="bdbd" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最近，我看了卡勒·哈尔登的视频，受到启发，开始做一些事情:</p><figure class="jt ju jv jw fd jx"><div class="bz dy l di"><div class="jy jz l"/></div></figure><p id="aa55" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">虽然我最终没有做出一个令人难以置信的、健壮的和可伸缩的数据库，但我真的想分享一些我在这个短暂的旅程中学到的(随机的)东西。如果你对我的代码有什么要指出的，或者对下一步有什么建议，请给所有的专业程序员积极的、建设性的反馈。</p><p id="e172" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">我的简单数据库模式</strong></p><p id="335a" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">对于这个小任务，我想创建一个数据库来存储我最喜欢的文章以及YouTube视频的链接，我还想给它们标签，这样我就可以根据我想知道的主题搜索它们。我的想法是，不要每次都拿出整个表格自己查找我想要的内容(表格在某些时候可能会变得很大)，而是基于主题缩小搜索范围。</p><p id="20bc" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我还想把表格分成YouTube视频和文章，而不是把它们放在同一个桌子上。这样，我可以进一步将一行分类为视频或文章。当你在做一个真正的数据库设计时，这可能不是完全必要的，但是这不是重点。我只是在记录我学到的我们能做的。</p><p id="239f" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="ka">顺便提一下，我还想说这里使用的链接完全是虚构的。这个想法并不是要创建一个真实链接的数据库，只是为了展示数据库最终是如何工作的。</em></p><p id="54df" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">创建数据库，手动将表格和行插入每个表格</strong></p><p id="f1a8" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这一次我们将使用SQLite 3。我们需要做的就是在文本编辑器中打开一个新文件，并将其保存为一个. sql文件。我把这个叫做“myDB.sql”。然后，我们将用我想要的表填充它。为此，我可以使用SQL命令:</p><pre class="jt ju jv jw fd kb kc kd ke aw kf bi"><span id="4051" class="kg kh hi kc b fi ki kj l kk kl">CREATE TABLE youtubers (youtuber_id int, youtuber_name varchar(255));</span><span id="169f" class="kg kh hi kc b fi km kj l kk kl">CREATE TABLE authors (author_id int, author_name varchar(255));</span><span id="0973" class="kg kh hi kc b fi km kj l kk kl">CREATE TABLE videos (video_id int, video_title varchar(255), video_url varchar(255), youtuber_id int, tag_1 varchar(255), tag_2 varchar(255));</span><span id="5a9b" class="kg kh hi kc b fi km kj l kk kl">CREATE TABLE articles (article_id int, article_title varchar(255), article_url varchar(255), author_id int, tag_1 varchar(255), tag_2 varchar(255));</span></pre><p id="c0df" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这里我们有4个表，因为我想将作者(或YouTuber)信息与文章和视频分开存储。由于每个表中每一行的id都是自己生成的(并不指向现实生活中的任何东西)，我们还可以将它设置为主键并自动递增它，但是由于我们并不打算在这个项目中学习如何输入数据(只是如何用已经建立的内容创建一个数据库)，所以让我们把它留到下一篇文章中。</p><p id="38bf" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">此外，对于每个视频或文章，我们不会一遍又一遍地重写作者或YouTuber的名称，而是用youtuber_id或author_id来表示它们。通过这种方式，将来您还可以通过添加新列，在各自的表格中添加更多关于您最喜爱的YouTuber或作者的信息，而不会因为更多的冗余数据而使视频和/或文章表格越来越大。</p><p id="6f42" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">同样为了简单起见，标题、URL和标签将被设置为<em class="ka"> varchar(255) </em>，因为此时无论。</p><p id="7ba4" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们开始用信息填充表格。作为一名苹果粉丝，我将把以下内容插入我的数据库:</p><ul class=""><li id="6ed6" class="kn ko hi iz b ja jb jd je jg kp jk kq jo kr js ks kt ku kv bi translated">科技YouTube<strong class="iz hj">MKBHD</strong>和<strong class="iz hj">谢霆锋</strong></li><li id="51b6" class="kn ko hi iz b ja kw jd kx jg ky jk kz jo la js ks kt ku kv bi translated">由<strong class="iz hj"> 9to5Mac </strong>和<strong class="iz hj">苹果内幕</strong>撰写的文章</li><li id="63cc" class="kn ko hi iz b ja kw jd kx jg ky jk kz jo la js ks kt ku kv bi translated">对于每一个YouTuber(或作者)，2篇关于以下产品的文章(或视频):iPhone，iPad，MacBook，Apple Watch和AirTags</li></ul><p id="30ee" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们可以将它添加到刚刚创建的myDB.sql文件中:</p><pre class="jt ju jv jw fd kb kc kd ke aw kf bi"><span id="6fb0" class="kg kh hi kc b fi ki kj l kk kl">INSERT INTO youtubers VALUES (1, "MKBHD");<br/>INSERT INTO youtubers VALUES (2, "Justin Tse");</span><span id="13c4" class="kg kh hi kc b fi km kj l kk kl">INSERT INTO authors VALUES (1, "9to5Mac");<br/>INSERT INTO authors VALUES (2, "Apple Insider");</span><span id="dc20" class="kg kh hi kc b fi km kj l kk kl">INSERT INTO videos VALUES (1, "MKBHD iPhone 13 Pro review", "<a class="ae lb" href="http://www.youtube.com/mkbhd/iphone13pro" rel="noopener ugc nofollow" target="_blank">www.youtube.com/mkbhd/iphone13pro</a>", 1, "apple", "iphone");<br/>INSERT INTO videos VALUES (2, "MKBHD iPad Pro review", "<a class="ae lb" href="http://www.youtube.com/mkbhd/ipadpro" rel="noopener ugc nofollow" target="_blank">www.youtube.com/mkbhd/ipadpro</a>", 1, "apple", "ipad");<br/>INSERT INTO videos VALUES (3, "MKBHD Macbook M1 Pro review", "<a class="ae lb" href="http://www.youtube.com/mkbhd/macbookpro" rel="noopener ugc nofollow" target="_blank">www.youtube.com/mkbhd/macbookpro</a>", 1, "apple", "macbook");<br/>INSERT INTO videos VALUES (4, "MKBHD Apple Watch 7 review", "<a class="ae lb" href="http://www.youtube.com/mkbhd/applewatch7" rel="noopener ugc nofollow" target="_blank">www.youtube.com/mkbhd/applewatch7</a>", 1, "apple", "apple watch");<br/>INSERT INTO videos VALUES (5, "MKBHD Airtags review", "<a class="ae lb" href="http://www.youtube.com/mkbhd/airtags" rel="noopener ugc nofollow" target="_blank">www.youtube.com/mkbhd/airtags</a>", 1, "apple", "airtags");<br/>INSERT INTO videos VALUES (6, "Justin Tse iPhone 13 Pro review", "<a class="ae lb" href="http://www.youtube.com/justintse/iphone13pro" rel="noopener ugc nofollow" target="_blank">www.youtube.com/justintse/iphone13pro</a>", 2, "apple", "iphone");<br/>INSERT INTO videos VALUES (7, "Justin Tse iPad Pro review", "<a class="ae lb" href="http://www.youtube.com/justintse/ipadpro" rel="noopener ugc nofollow" target="_blank">www.youtube.com/justintse/ipadpro</a>", 2, "apple", "ipad");<br/>INSERT INTO videos VALUES (8, "Justin Tse Macbook M1 Pro review", "<a class="ae lb" href="http://www.youtube.com/justintse/macbookpro" rel="noopener ugc nofollow" target="_blank">www.youtube.com/justintse/macbookpro</a>", 2, "apple", "macbook");<br/>INSERT INTO videos VALUES (9, "Justin Tse Apple Watch 7 review", "<a class="ae lb" href="http://www.youtube.com/justintse/applewatch7" rel="noopener ugc nofollow" target="_blank">www.youtube.com/justintse/applewatch7</a>", 2, "apple", "apple watch");<br/>INSERT INTO videos VALUES (10, "Justin Tse Airtags review", "<a class="ae lb" href="http://www.youtube.com/justintse/airtags" rel="noopener ugc nofollow" target="_blank">www.youtube.com/justintse/airtags</a>", 2, "apple", "airtags");</span><span id="4dba" class="kg kh hi kc b fi km kj l kk kl">INSERT INTO articles VALUES (1, "9to5Mac iPhone 13 Pro review", "<a class="ae lb" href="http://www.9to5mac.com/iphone13pro" rel="noopener ugc nofollow" target="_blank">www.9to5mac.com/iphone13pro</a>", 1, "apple", "iphone");<br/>INSERT INTO articles VALUES (1, "9to5Mac iPad Pro review", "<a class="ae lb" href="http://www.9to5mac.com/ipadpro" rel="noopener ugc nofollow" target="_blank">www.9to5mac.com/ipadpro</a>", 1, "apple", "ipad");<br/>INSERT INTO articles VALUES (1, "9to5Mac Macbook M1 Pro review", "<a class="ae lb" href="http://www.9to5mac.com/macbookpro" rel="noopener ugc nofollow" target="_blank">www.9to5mac.com/macbookpro</a>", 1, "apple", "macbook");<br/>INSERT INTO articles VALUES (1, "9to5Mac Apple Watch 7 review", "<a class="ae lb" href="http://www.9to5mac.com/applewatch7" rel="noopener ugc nofollow" target="_blank">www.9to5mac.com/applewatch7</a>", 1, "apple", "apple watch");<br/>INSERT INTO articles VALUES (1, "9to5Mac Airtags review", "<a class="ae lb" href="http://www.9to5mac.com/airtags" rel="noopener ugc nofollow" target="_blank">www.9to5mac.com/airtags</a>", 1, "apple", "airtags");<br/>INSERT INTO articles VALUES (1, "AppleInsider iPhone 13 Pro review", "<a class="ae lb" href="http://www.appleinsider.com/iphone13pro" rel="noopener ugc nofollow" target="_blank">www.appleinsider.com/iphone13pro</a>", 2, "apple", "iphone");<br/>INSERT INTO articles VALUES (1, "AppleInsider iPad Pro review", "<a class="ae lb" href="http://www.appleinsider.com/ipadpro" rel="noopener ugc nofollow" target="_blank">www.appleinsider.com/ipadpro</a>", 2, "apple", "ipad");<br/>INSERT INTO articles VALUES (1, "AppleInsider Macbook M1 Pro review", "<a class="ae lb" href="http://www.appleinsider.com/macbookpro" rel="noopener ugc nofollow" target="_blank">www.appleinsider.com/macbookpro</a>", 2, "apple", "macbook");<br/>INSERT INTO articles VALUES (1, "AppleInsider Apple Watch 7 review", "<a class="ae lb" href="http://www.appleinsider.com/applewatch7" rel="noopener ugc nofollow" target="_blank">www.appleinsider.com/applewatch7</a>", 2, "apple", "apple watch");<br/>INSERT INTO articles VALUES (1, "AppleInsider Airtags review", "<a class="ae lb" href="http://www.appleinsider.com/airtags" rel="noopener ugc nofollow" target="_blank">www.appleinsider.com/airtags</a>", 2, "apple", "airtag");</span></pre><p id="92a7" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">相当单调乏味的工作，但它会让我们得到一个简单的数据库，我们可以随时使用它。最后一步是运行这个SQL脚本并立即创建数据库。转到您的终端和<em class="ka"> cd </em>到您的脚本的位置，并运行以下命令:</p><pre class="jt ju jv jw fd kb kc kd ke aw kf bi"><span id="b277" class="kg kh hi kc b fi ki kj l kk kl">sqlite3 myDB.db &lt; myDB.sql</span></pre><p id="e2b0" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">假设一切运行完美，那”。db”文件基本上就是您的数据库。</p><p id="2d22" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">您可以立即执行SELECT命令从该数据库中提取数据，有两种方法可以做到这一点。首先，您可以直接在终端上完成，如下所示:</p><pre class="jt ju jv jw fd kb kc kd ke aw kf bi"><span id="58e5" class="kg kh hi kc b fi ki kj l kk kl">sqlite3 myDB.db 'SELECT * FROM videos;'</span></pre><p id="1446" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">或者你可以创造另一个。sql文件，并像创建数据库时一样运行它，类似于:</p><pre class="jt ju jv jw fd kb kc kd ke aw kf bi"><span id="cb62" class="kg kh hi kc b fi ki kj l kk kl">sqlite3 myDB.db &lt; mySearchQueries.sql</span></pre><p id="38e6" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">但是我将直接使用Pandas和Jupyter Lab，因为这比在终端上查看输出结果更漂亮。</p><p id="079c" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">第一步:导入库，连接到数据库</strong></p><p id="1725" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这次我们真的只需要熊猫和sqlite3。还有，让我们马上连接到数据库</p><pre class="jt ju jv jw fd kb kc kd ke aw kf bi"><span id="bf06" class="kg kh hi kc b fi ki kj l kk kl">import pandas as pd<br/>import sqlite3 as sql</span><span id="db35" class="kg kh hi kc b fi km kj l kk kl"># Connect to the database file <br/>conn = sql.connect("myDB.db")</span></pre><p id="2c68" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">第二步:让我们执行所有不同种类的选择命令</strong></p><p id="3abe" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">使用我们刚刚建立的连接，我们可以让pandas读取一个SQL命令并在数据库上执行它，然后输出我们想要的结果。例如，查看我的视频列表会是这样的:</p><pre class="jt ju jv jw fd kb kc kd ke aw kf bi"><span id="d931" class="kg kh hi kc b fi ki kj l kk kl">videos = pd.read_sql("SELECT * FROM videos", conn)</span></pre><p id="f30e" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">输出如下:</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="er es lc"><img src="../Images/cf050c6f13890ce0f303ebd9b23c4a61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0a3rO4brWs-NcNuVD1U6Cg.png"/></div></div></figure><p id="0a14" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">此时，它基本上只是使用SQL命令，并将它们放在pandas.read_sql()命令下。我将列出我在这篇文章中举的例子。</p><p id="9e68" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">使用标签上的特定关键词搜索视频(比如iPhone):</p><pre class="jt ju jv jw fd kb kc kd ke aw kf bi"><span id="ab43" class="kg kh hi kc b fi ki kj l kk kl">keyword = "iphone"</span><span id="b816" class="kg kh hi kc b fi km kj l kk kl">iphone_videos = pd.read_sql("SELECT youtubers.youtuber_name as YouTuber, videos.video_title as Video_Title, videos.video_url as Video_URL FROM youtubers INNER JOIN videos ON youtubers.youtuber_id = videos.youtuber_id WHERE videos.tag_2 = '%s'" % keyword, conn)</span></pre><p id="9fb4" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">正如在数据库模式中提到的，实际的video表没有YouTuber信息(只有它们的关联id可以与YouTuber表进行比较)。因此，我需要在videos和YouTubers表之间执行一个简单的连接，引用youtuberid。</p><p id="32c1" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">结果:</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="er es lj"><img src="../Images/94a1ba8d1f4b10d48071302a1ba8c56b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vB4Rpm3InlCM0j3gGOGH2A.png"/></div></div></figure><p id="d4dc" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">通过在标题中搜索特定的关键字，我也可以从上面得到相同的精确结果。同样，在这个阶段，它与SQL命令有更多的关系</p><pre class="jt ju jv jw fd kb kc kd ke aw kf bi"><span id="d6c6" class="kg kh hi kc b fi ki kj l kk kl">title_search_query = "SELECT youtubers.youtuber_name as youtuber, videos.video_title as title, videos.video_url as url FROM youtubers INNER JOIN videos ON youtubers.youtuber_id = videos.youtuber_id WHERE videos.video_title LIKE '%iPhone%'"</span><span id="06c9" class="kg kh hi kc b fi km kj l kk kl">iphone_videos = pd.read_sql(title_search_query, conn)</span></pre><p id="2824" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">结果:</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="er es lj"><img src="../Images/302bab0db703081d8450aaca8556a1a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pl1BE2vD8LtZHZ7WL3XjZw.png"/></div></div></figure><p id="4527" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果我既想要标题上的特定关键字，又想要特定的YouTuber，该怎么办？我可以在我的SQL命令中使用和</p><pre class="jt ju jv jw fd kb kc kd ke aw kf bi"><span id="8cfa" class="kg kh hi kc b fi ki kj l kk kl">title_search_query = "SELECT youtubers.youtuber_name as youtuber, videos.video_title as title, videos.video_url as url FROM youtubers INNER JOIN videos ON youtubers.youtuber_id = videos.youtuber_id WHERE videos.video_title LIKE '%iPhone%' AND videos.youtuber_id = 1"</span><span id="3430" class="kg kh hi kc b fi km kj l kk kl">iphone_videos = pd.DataFrame(pd.read_sql(title_search_query, conn))</span></pre><p id="4817" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">结果:</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="er es lj"><img src="../Images/3d015dd31d92525d2870911874ae40d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TD_0eiN4s6zP0br9JY9zwA.png"/></div></div></figure><p id="b384" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最后，如果您注意到我们只是在玩视频表，而完全忽略了文章表。比方说，今天我想查阅我的数据库中关于某个特定标签的所有文章和视频。我想创建一个函数，它会提示我在数据库中搜索什么，并输出所有相关的结果。按照上面我们在不同的SELECT命令上所做的尝试，我们可以使用它来创建一个函数来完成这个任务。</p><p id="8fd0" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">首先，这个函数接收一个搜索词，并返回我数据库中的文章和视频。视频行将包含YouTuber名称、视频标题和视频URL，文章行将包含作者名称、文章标题及其URL(我们可以使用之前使用的SQL JOIN命令)。</p><p id="95d2" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最后，他们会将它输出为单独的表格(一个用于视频，一个用于列)，这对我来说很容易看到。带注释的完整代码如下:</p><pre class="jt ju jv jw fd kb kc kd ke aw kf bi"><span id="cbd9" class="kg kh hi kc b fi ki kj l kk kl">def search_resources():<br/>    <br/>    # Input a search term<br/>    <br/>    term = input("Enter Search Term: ")<br/>    <br/>    # SQL query to get the relevant videos based on search term <br/>    <br/>    video_query = "SELECT youtubers.youtuber_name as YouTuber, videos.video_title as Video_Title, videos.video_url as Video_URL FROM youtubers INNER JOIN videos ON youtubers.youtuber_id = videos.youtuber_id WHERE videos.tag_2 = '%s'"<br/>    video_db_search = pd.read_sql(video_query % term, conn)<br/>    <br/>    # SQL query to get the relevant videos based on search term <br/>    <br/>    article_query = "SELECT authors.author_name as Author, articles.article_title as Article_Title, articles.article_url as Article_URL FROM authors INNER JOIN articles ON authors.author_id = articles.author_id WHERE articles.tag_2 = '%s'"<br/>    article_db_search = pd.read_sql(article_query % term, conn)<br/>    <br/>    # Display them<br/>    <br/>    return display(video_db_search, article_db_search)</span></pre><p id="2073" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们看看当我们尝试它的时候会发生什么。假设今天我想为iPad查看我保存在数据库中的所有资源。输出如下所示:</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="er es lk"><img src="../Images/2529c4f3b271b50819e17cb8fbe923a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KAlPjKwBuTGvR650LG0spg.png"/></div></div></figure><p id="0dd7" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这是一个愚蠢的数据库，但我确实很享受制作它的过程，以及我在这个过程中学到的一些随机的东西。顺便说一下，下面是一个很好的资源来学习如何使用熊猫来连接表格:</p><div class="ll lm ez fb ln lo"><a href="https://brettromero.com/pandas-joining-tables/" rel="noopener  ugc nofollow" target="_blank"><div class="lp ab dw"><div class="lq ab lr cl cj ls"><h2 class="bd hj fi z dy lt ea eb lu ed ef hh bi translated">熊猫:连接表格</h2><div class="lv l"><h3 class="bd b fi z dy lt ea eb lu ed ef dx translated">本文是使用Python数据处理库pandas的一系列实用指南的一部分。要查看视图…</h3></div><div class="lw l"><p class="bd b fp z dy lt ea eb lu ed ef dx translated">brettromero.com</p></div></div><div class="lx l"><div class="ly l lz ma mb lx mc lh lo"/></div></div></a></div></div></div>    
</body>
</html>