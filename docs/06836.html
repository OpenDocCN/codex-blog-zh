<html>
<head>
<title>Creating Custom Plotly Dash Components</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">创建自定义Plotly Dash组件</h1>
<blockquote>原文：<a href="https://medium.com/codex/creating-custom-plotly-dash-components-933b405abd21?source=collection_archive---------1-----------------------#2022-05-16">https://medium.com/codex/creating-custom-plotly-dash-components-933b405abd21?source=collection_archive---------1-----------------------#2022-05-16</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/8fb736df2e7e73c17240304ea837d581.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*XWdPMrDamUCDZHDL"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated"><a class="ae hv" href="https://unsplash.com/@chrisliverani?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">克里斯·利维拉尼</a>在<a class="ae hv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><div class=""/><div class=""><h2 id="276a" class="pw-subtitle-paragraph iv hx hy bd b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm dx translated">通过在Python中使用React</h2></div><p id="f9a2" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">你好。在本文中，我将告诉你我们如何在Plotly Dash中创建自己的组件。您可以使用下面的链接访问我创建的repo来测试这个过程。</p><div class="hh hi ez fb hj kj"><a href="https://github.com/mebaysan/CustomDashReactComponent" rel="noopener  ugc nofollow" target="_blank"><div class="kk ab dw"><div class="kl ab km cl cj kn"><h2 class="bd hz fi z dy ko ea eb kp ed ef hx bi translated">GitHub—mebaysan/CustomDashReactComponent</h2><div class="kq l"><h3 class="bd b fi z dy ko ea eb kp ed ef dx translated">嗨，现在我需要在React中创建自定义组件，因为我的工作。为了做到这一点，我已经学会了…</h3></div><div class="kr l"><p class="bd b fp z dy ko ea eb kp ed ef dx translated">github.com</p></div></div><div class="ks l"><div class="kt l ku kv kw ks kx hp kj"/></div></div></a></div><figure class="kz la lb lc fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ky"><img src="../Images/7d7b88c22e2f85a442c1f98c345bc344.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LQVdeHBqgLVCueOmG2Ds0w.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">作者图片</figcaption></figure><h1 id="c910" class="ld le hy bd lf lg lh li lj lk ll lm ln je lo jf lp jh lq ji lr jk ls jl lt lu bi translated">介绍</h1><p id="039b" class="pw-post-body-paragraph jn jo hy jp b jq lv iz js jt lw jc jv jw lx jy jz ka ly kc kd ke lz kg kh ki hb bi translated">这里有一篇由Plotly编写的<a class="ae hv" href="https://dash.plotly.com/react-for-python-developers" rel="noopener ugc nofollow" target="_blank">有据可查的文章</a>来创建你的组件。然而，我将直接从使用<a class="ae hv" href="https://github.com/plotly/dash-component-boilerplate" rel="noopener ugc nofollow" target="_blank">样板文件</a>创建一个定制项目开始。我将解释核心概念并创建一个定制组件来展示我们如何做到这一点。</p><h1 id="290c" class="ld le hy bd lf lg lh li lj lk ll lm ln je lo jf lp jh lq ji lr jk ls jl lt lu bi translated">创造工作环境</h1><p id="2c17" class="pw-post-body-paragraph jn jo hy jp b jq lv iz js jt lw jc jv jw lx jy jz ka ly kc kd ke lz kg kh ki hb bi translated">我将创建一个虚拟环境并安装需求，然后使用<code class="du ma mb mc md b">cookiecutter</code>创建一个项目。</p><pre class="kz la lb lc fd me md mf mg aw mh bi"><span id="3b28" class="mi le hy md b fi mj mk l ml mm">python3 -m virtualenv venv</span><span id="977a" class="mi le hy md b fi mn mk l ml mm">source venv/bin/activate</span><span id="6845" class="mi le hy md b fi mn mk l ml mm">pip install <!-- -->cookiecutter</span><span id="772d" class="mi le hy md b fi mn mk l ml mm">cookiecutter gh:plotly/dash-component-boilerplate</span></pre><figure class="kz la lb lc fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mo"><img src="../Images/bab338a60273b23b794195f149e93820.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p8DtLDP6U2xUGyFQqZ3ztw.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">作者图片</figcaption></figure><h1 id="d46e" class="ld le hy bd lf lg lh li lj lk ll lm ln je lo jf lp jh lq ji lr jk ls jl lt lu bi translated">文件夹结构</h1><ul class=""><li id="26f1" class="mp mq hy jp b jq lv jt lw jw mr ka ms ke mt ki mu mv mw mx bi translated">我们在<code class="du ma mb mc md b">/src/lib/components/*.react.js</code>文件中开发我们的组件</li><li id="a3bb" class="mp mq hy jp b jq my jt mz jw na ka nb ke nc ki mu mv mw mx bi translated">我们可以使用<code class="du ma mb mc md b">/src/demo/App.js</code>文件(一个React应用程序)来测试我们的组件</li><li id="4d3a" class="mp mq hy jp b jq my jt mz jw na ka nb ke nc ki mu mv mw mx bi translated">*我们必须使用<code class="du ma mb mc md b">Component.propTypes={}</code>指出道具</li><li id="c68e" class="mp mq hy jp b jq my jt mz jw na ka nb ke nc ki mu mv mw mx bi translated">*我们必须使用<code class="du ma mb mc md b">setProps</code>道具将我们的定制组件与Dash回调绑定。如果我们想从Dash组件中更新我们的组件，我们必须使用<code class="du ma mb mc md b">setProps</code>属性。</li><li id="57f3" class="mp mq hy jp b jq my jt mz jw na ka nb ke nc ki mu mv mw mx bi translated">*我们必须导入和导出我们在。/src/lib/index.js <code class="du ma mb mc md b">./src/lib/index.js</code>文件</li></ul><h1 id="de8d" class="ld le hy bd lf lg lh li lj lk ll lm ln je lo jf lp jh lq ji lr jk ls jl lt lu bi translated">开始创建组件</h1><p id="d020" class="pw-post-body-paragraph jn jo hy jp b jq lv iz js jt lw jc jv jw lx jy jz ka ly kc kd ke lz kg kh ki hb bi translated">我将在项目文件夹中找到我的终端，然后安装需求。</p><pre class="kz la lb lc fd me md mf mg aw mh bi"><span id="0524" class="mi le hy md b fi mj mk l ml mm">cd custom_baysan_components</span><span id="321c" class="mi le hy md b fi mn mk l ml mm">pip install -r requirements.txt</span></pre><p id="1e15" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">我将在<code class="du ma mb mc md b">src/lib/components</code>文件夹中创建<code class="du ma mb mc md b">MyTextInput.react.js</code>文件。该组件创建一个简单的文本输入和一个<code class="du ma mb mc md b">p</code>元素。当我们在文本输入中写入内容时，<code class="du ma mb mc md b">p</code>元素会自动更新。</p><pre class="kz la lb lc fd me md mf mg aw mh bi"><span id="d580" class="mi le hy md b fi mj mk l ml mm">import React, {useState} <em class="nd">from</em> 'react';</span><span id="347f" class="mi le hy md b fi mn mk l ml mm">import PropTypes <em class="nd">from</em> 'prop-types';</span><span id="68e5" class="mi le hy md b fi mn mk l ml mm"><em class="nd">/**</em></span><span id="0c78" class="mi le hy md b fi mn mk l ml mm"><em class="nd">* MyTextInput is an example component.</em></span><span id="d8f7" class="mi le hy md b fi mn mk l ml mm"><em class="nd">* It takes a property, `label`, and</em></span><span id="b46f" class="mi le hy md b fi mn mk l ml mm"><em class="nd">* displays it.</em></span><span id="3b53" class="mi le hy md b fi mn mk l ml mm"><em class="nd">* It renders an input with the property `value`</em></span><span id="20e3" class="mi le hy md b fi mn mk l ml mm"><em class="nd">* which is editable by the user.</em></span><span id="c067" class="mi le hy md b fi mn mk l ml mm"><em class="nd">*/</em></span><span id="fe3d" class="mi le hy md b fi mn mk l ml mm">const MyTextInput = (props) =&gt; {</span><span id="a688" class="mi le hy md b fi mn mk l ml mm">const [value, setValue] = useState(props.value);</span><span id="c280" class="mi le hy md b fi mn mk l ml mm">const updateValue = (e) =&gt; {</span><span id="180c" class="mi le hy md b fi mn mk l ml mm">setValue(e.target.value);</span><span id="3a64" class="mi le hy md b fi mn mk l ml mm">props.setProps({value: e.target.value});</span><span id="b3e8" class="mi le hy md b fi mn mk l ml mm">};</span><span id="7cb3" class="mi le hy md b fi mn mk l ml mm">return (</span><span id="8174" class="mi le hy md b fi mn mk l ml mm">&lt;&gt;</span><span id="64e3" class="mi le hy md b fi mn mk l ml mm">{<em class="nd">/* &lt;label&gt;{props.label != null ? props.label : 'DEFAULT LABEL'}&lt;/label&gt; */</em>}</span><span id="fdd7" class="mi le hy md b fi mn mk l ml mm">&lt;label&gt;{props.label}&lt;/label&gt;</span><span id="923b" class="mi le hy md b fi mn mk l ml mm">&lt;br /&gt;</span><span id="63e4" class="mi le hy md b fi mn mk l ml mm">&lt;input</span><span id="ff32" class="mi le hy md b fi mn mk l ml mm"><em class="nd">value</em>={props.setProps ? props.value : value}</span><span id="fe94" class="mi le hy md b fi mn mk l ml mm"><em class="nd">onChange</em>={updateValue}</span><span id="8966" class="mi le hy md b fi mn mk l ml mm">/&gt;</span><span id="48e8" class="mi le hy md b fi mn mk l ml mm">&lt;p&gt;{value}&lt;/p&gt;</span><span id="4957" class="mi le hy md b fi mn mk l ml mm">&lt;/&gt;</span><span id="0705" class="mi le hy md b fi mn mk l ml mm">);</span><span id="6d08" class="mi le hy md b fi mn mk l ml mm">};</span><span id="6c2f" class="mi le hy md b fi mn mk l ml mm">MyTextInput.defaultProps = {</span><span id="671c" class="mi le hy md b fi mn mk l ml mm">label: 'Default Label with defaultProps',</span><span id="87b8" class="mi le hy md b fi mn mk l ml mm">};</span><span id="bfe4" class="mi le hy md b fi mn mk l ml mm">MyTextInput.propTypes = {</span><span id="ea0c" class="mi le hy md b fi mn mk l ml mm"><em class="nd">/**</em></span><span id="bd20" class="mi le hy md b fi mn mk l ml mm"><em class="nd">* The ID used to identify this component in Dash callbacks.</em></span><span id="c7a7" class="mi le hy md b fi mn mk l ml mm"><em class="nd">*/</em></span><span id="8903" class="mi le hy md b fi mn mk l ml mm">id: PropTypes.string,</span><span id="8d93" class="mi le hy md b fi mn mk l ml mm"><em class="nd">/**</em></span><span id="1f85" class="mi le hy md b fi mn mk l ml mm"><em class="nd">* The label used to show above of the input</em></span><span id="a695" class="mi le hy md b fi mn mk l ml mm"><em class="nd">*/</em></span><span id="f096" class="mi le hy md b fi mn mk l ml mm">label: PropTypes.string,</span><span id="3315" class="mi le hy md b fi mn mk l ml mm"><em class="nd">/**</em></span><span id="77d8" class="mi le hy md b fi mn mk l ml mm"><em class="nd">* The value used to set the default value for the input</em></span><span id="da4c" class="mi le hy md b fi mn mk l ml mm"><em class="nd">*/</em></span><span id="cbf0" class="mi le hy md b fi mn mk l ml mm">value: PropTypes.string,</span><span id="a9f1" class="mi le hy md b fi mn mk l ml mm">};</span><span id="3bb0" class="mi le hy md b fi mn mk l ml mm">export default MyTextInput;</span></pre><h2 id="c602" class="mi le hy bd lf ne nf ng lj nh ni nj ln jw nk nl lp ka nm nn lr ke no np lt nq bi translated">属性:Pythonic中最重要的领域</h2><p id="6a00" class="pw-post-body-paragraph jn jo hy jp b jq lv iz js jt lw jc jv jw lx jy jz ka ly kc kd ke lz kg kh ki hb bi translated">如果我们不指出组件的每个属性，Dash会给我们一个错误，并且不会将我们的React组件转换成Python类。为了处理这个问题，我们必须像下面这样定义每个属性。此外，我们可以通过使用注释行为他们编写文档。</p><pre class="kz la lb lc fd me md mf mg aw mh bi"><span id="1e44" class="mi le hy md b fi mj mk l ml mm">MyTextInput.propTypes = {</span><span id="0975" class="mi le hy md b fi mn mk l ml mm"><em class="nd">/**</em></span><span id="a9aa" class="mi le hy md b fi mn mk l ml mm"><em class="nd">* The ID used to identify this component in Dash callbacks.</em></span><span id="f2b4" class="mi le hy md b fi mn mk l ml mm"><em class="nd">*/</em></span><span id="6108" class="mi le hy md b fi mn mk l ml mm">id: PropTypes.string,</span><span id="de6f" class="mi le hy md b fi mn mk l ml mm"><em class="nd">/**</em></span><span id="0b76" class="mi le hy md b fi mn mk l ml mm"><em class="nd">* The label used to show above of the input</em></span><span id="b7e0" class="mi le hy md b fi mn mk l ml mm"><em class="nd">*/</em></span><span id="91b9" class="mi le hy md b fi mn mk l ml mm">label: PropTypes.string,</span><span id="d103" class="mi le hy md b fi mn mk l ml mm"><em class="nd">/**</em></span><span id="43b8" class="mi le hy md b fi mn mk l ml mm"><em class="nd">* The value used to set the default value for the input</em></span><span id="a172" class="mi le hy md b fi mn mk l ml mm"><em class="nd">*/</em></span><span id="b2da" class="mi le hy md b fi mn mk l ml mm">value: PropTypes.string,</span><span id="64f0" class="mi le hy md b fi mn mk l ml mm">};</span></pre><p id="159f" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">此外，我们可以为属性创建默认值。如果我们这样定义，就不必给出Python中定义的属性。</p><pre class="kz la lb lc fd me md mf mg aw mh bi"><span id="f716" class="mi le hy md b fi mj mk l ml mm">MyTextInput.defaultProps = {</span><span id="c22b" class="mi le hy md b fi mn mk l ml mm">label: 'Default Label with defaultProps',</span><span id="781f" class="mi le hy md b fi mn mk l ml mm">};</span></pre><h2 id="a0ec" class="mi le hy bd lf ne nf ng lj nh ni nj ln jw nk nl lp ka nm nn lr ke no np lt nq bi translated">注册组件</h2><p id="660f" class="pw-post-body-paragraph jn jo hy jp b jq lv iz js jt lw jc jv jw lx jy jz ka ly kc kd ke lz kg kh ki hb bi translated">我们需要导入和导出我们在<code class="du ma mb mc md b">src/index.js</code>文件中创建的组件。否则，我们不能将组件转换成Python类。</p><pre class="kz la lb lc fd me md mf mg aw mh bi"><span id="971f" class="mi le hy md b fi mj mk l ml mm"><em class="nd">/* eslint-disable import/prefer-default-export */</em></span><span id="f04c" class="mi le hy md b fi mn mk l ml mm">import MyTextInput <em class="nd">from</em> "./components/MyTextInput.react";</span><span id="fdae" class="mi le hy md b fi mn mk l ml mm">export {</span><span id="732e" class="mi le hy md b fi mn mk l ml mm">MyTextInput</span><span id="8ce7" class="mi le hy md b fi mn mk l ml mm">};</span></pre><h1 id="4137" class="ld le hy bd lf lg lh li lj lk ll lm ln je lo jf lp jh lq ji lr jk ls jl lt lu bi translated">生成组件</h1><p id="743d" class="pw-post-body-paragraph jn jo hy jp b jq lv iz js jt lw jc jv jw lx jy jz ka ly kc kd ke lz kg kh ki hb bi translated">我们准备将组件转换为Python类(Dash组件)。我们使用<code class="du ma mb mc md b">npm run build</code>命令将React组件转换成Python类。</p><pre class="kz la lb lc fd me md mf mg aw mh bi"><span id="db66" class="mi le hy md b fi mj mk l ml mm">npm run build</span></pre><figure class="kz la lb lc fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es nr"><img src="../Images/cd99366d1002ddb0d704414a66aa81dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*127wpkKzoPSBgRN7pnenOA.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">作者图片</figcaption></figure><p id="4480" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">然后，组件将自动转换成Python类，放在<code class="du ma mb mc md b">custom_baysan_component</code>文件下。</p><figure class="kz la lb lc fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ns"><img src="../Images/8a39553b0944a59b348942b1065ad22d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zuh8BNsbTo0IYMonb0Wj6Q.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">作者图片</figcaption></figure><h1 id="a755" class="ld le hy bd lf lg lh li lj lk ll lm ln je lo jf lp jh lq ji lr jk ls jl lt lu bi translated">使用组件</h1><p id="0c77" class="pw-post-body-paragraph jn jo hy jp b jq lv iz js jt lw jc jv jw lx jy jz ka ly kc kd ke lz kg kh ki hb bi translated">为了测试组件，在<code class="du ma mb mc md b">usage.py</code>文件中有一个基本的Dash应用程序。我将从由<code class="du ma mb mc md b">npm run build</code>命令创建的Python模块中导入组件。</p><pre class="kz la lb lc fd me md mf mg aw mh bi"><span id="2624" class="mi le hy md b fi mj mk l ml mm">from custom_baysan_components.MyTextInput import MyTextInput</span></pre><p id="a06c" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">将会有一个与我们使用<code class="du ma mb mc md b">cookiecutter</code>创建的项目同名的Python包。</p><figure class="kz la lb lc fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es nt"><img src="../Images/27daf568e74c7e382f27c98c6efe4f20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fIM04UGZE_Vm9Sk-_L5bKg.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">作者图片</figcaption></figure><p id="5cf3" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">这是代码的输出。</p><figure class="kz la lb lc fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es nu"><img src="../Images/9a7e39b68ff030f2d168d0bd49807342.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gOWklTK3p0Sv89LtuudH3A.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">作者图片</figcaption></figure><h1 id="5194" class="ld le hy bd lf lg lh li lj lk ll lm ln je lo jf lp jh lq ji lr jk ls jl lt lu bi translated">最后</h1><p id="846b" class="pw-post-body-paragraph jn jo hy jp b jq lv iz js jt lw jc jv jw lx jy jz ka ly kc kd ke lz kg kh ki hb bi translated">希望这是有帮助的，你喜欢它。我没有深究什么是React或者React中有什么钩子之类的基本话题。因为它们不是这个故事的目标。此外，你可以在下面的报告中找到另一个关于使用蚂蚁设计图表的例子。</p><div class="hh hi ez fb hj kj"><a href="https://github.com/mebaysan/CustomDashReactComponent" rel="noopener  ugc nofollow" target="_blank"><div class="kk ab dw"><div class="kl ab km cl cj kn"><h2 class="bd hz fi z dy ko ea eb kp ed ef hx bi translated">GitHub-mebaysan/CustomDashReactComponent</h2><div class="kq l"><h3 class="bd b fi z dy ko ea eb kp ed ef dx translated">嗨，现在我需要在React中创建自定义组件，因为我的工作。为了做到这一点，我已经学会了…</h3></div><div class="kr l"><p class="bd b fp z dy ko ea eb kp ed ef dx translated">github.com</p></div></div><div class="ks l"><div class="nv l ku kv kw ks kx hp kj"/></div></div></a></div><p id="b737" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">问候。</p></div></div>    
</body>
</html>