<html>
<head>
<title>An Email Bot for the Masses</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">面向大众的电子邮件机器人</h1>
<blockquote>原文：<a href="https://medium.com/codex/an-email-bot-for-the-masses-173efbc4e307?source=collection_archive---------2-----------------------#2021-02-26">https://medium.com/codex/an-email-bot-for-the-masses-173efbc4e307?source=collection_archive---------2-----------------------#2021-02-26</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><h2 id="4551" class="hg hh hi bd b fp hj hk hl hm hn ho dx hp translated" aria-label="kicker paragraph"><a class="ae ge" href="http://medium.com/codex" rel="noopener">法典</a></h2><div class=""/><div class=""><h2 id="7ab9" class="pw-subtitle-paragraph io hr hi bd b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf dx translated">一点硒元素的知识是如何大有帮助的</h2></div><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es jg"><img src="../Images/41cfb12b8768f2ad946b7273b7e34977.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*AcO_Cu8OJc9HPnlc"/></div></div><figcaption class="js jt et er es ju jv bd b be z dx translated">照片由<a class="ae jw" href="https://unsplash.com/@siora18?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Siora摄影</a>在<a class="ae jw" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure></div><div class="ab cl jx jy gp jz" role="separator"><span class="ka bw bk kb kc kd"/><span class="ka bw bk kb kc kd"/><span class="ka bw bk kb kc"/></div><div class="hb hc hd he hf"><h2 id="01d6" class="ke kf hi bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ho bi translated">什么是机器人？</h2><p id="f24c" class="pw-post-body-paragraph lb lc hi ld b le lf is lg lh li iv lj kp lk ll lm kt ln lo lp kx lq lr ls lt hb bi translated">bot是一种与web元素(来自网站、web应用程序等的元素)交互的程序。).这让它看起来像是一个真实的人在使用某个web应用程序，但实际上，它实际上是一个程序。机器人可以用来测试网站功能，在应用程序中为用户提供信息，以及生成对话消息(聊天机器人)。</p><h2 id="64e8" class="ke kf hi bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ho bi translated">硒是什么？</h2><p id="0dec" class="pw-post-body-paragraph lb lc hi ld b le lf is lg lh li iv lj kp lk ll lm kt ln lo lp kx lq lr ls lt hb bi translated">Selenium是一个测试web应用程序功能的框架。Selenium有许多方法可以执行类似人类的过程。点击按钮和在输入字段中输入数据只是实现的一些事情。有些库和框架只支持单一的编程语言(比如BeautifulSoup只支持Python)。然而，Selenium可以跨多种语言使用。这些语言包括:Python、Java、C#、JavaScript和Ruby。</p></div><div class="ab cl jx jy gp jz" role="separator"><span class="ka bw bk kb kc kd"/><span class="ka bw bk kb kc kd"/><span class="ka bw bk kb kc"/></div><div class="hb hc hd he hf"><h2 id="9102" class="ke kf hi bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ho bi translated">电子邮件机器人解释</h2><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es lu"><img src="../Images/10bffffce75036ba7718d3bb5977c49e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VoMUsUh4ObF18eqwuIPEDA.png"/></div></div><figcaption class="js jt et er es ju jv bd b be z dx translated">作者图片</figcaption></figure><p id="cf2d" class="pw-post-body-paragraph lb lc hi ld b le lv is lg lh lw iv lj kp lx ll lm kt ly lo lp kx lz lr ls lt hb bi translated">本文中详细描述的机器人主要关注发送电子邮件(一个电子邮件机器人)。Outlook将是派生实现的首选电子邮件。我将使用Python和Selenium框架来创建所需的电子邮件机器人。上图显示了Outlook电子邮件<strong class="ld hs">登录</strong>页面的URL。这个URL被用作机器人执行其功能的起点。</p><p id="2d81" class="pw-post-body-paragraph lb lc hi ld b le lv is lg lh lw iv lj kp lx ll lm kt ly lo lp kx lz lr ls lt hb bi translated">发送电子邮件是一个可以自动化的过程。可自动化的任务包括:输入您的电子邮件地址、密码，并为您撰写的电子邮件编写适当的详细信息。除了获取正常信息，还有其他事情需要解决。</p><p id="ff5e" class="pw-post-body-paragraph lb lc hi ld b le lv is lg lh lw iv lj kp lx ll lm kt ly lo lp kx lz lr ls lt hb bi translated">机器人通常被编写来再现个人如何自然地与一些网页或应用程序交互。因此，我们还需要考虑在尝试发送电子邮件时会被点击的任何按钮。在Outlook的情况下，我们需要点击<strong class="ld hs">下一个</strong>、<strong class="ld hs">签到</strong>、<strong class="ld hs">新消息</strong>和<strong class="ld hs">发送</strong>按钮。</p><h2 id="7646" class="ke kf hi bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ho bi translated">需要硒方法</h2><ul class=""><li id="bbef" class="ma mb hi ld b le lf lh li kp mc kt md kx me lt mf mg mh mi bi translated">单击()</li><li id="286e" class="ma mb hi ld b le mj lh mk kp ml kt mm kx mn lt mf mg mh mi bi translated">发送键()</li><li id="8887" class="ma mb hi ld b le mj lh mk kp ml kt mm kx mn lt mf mg mh mi bi translated">直到()</li><li id="9f12" class="ma mb hi ld b le mj lh mk kp ml kt mm kx mn lt mf mg mh mi bi translated">find_element_by_xpath()</li></ul><p id="6ea9" class="pw-post-body-paragraph lb lc hi ld b le lv is lg lh lw iv lj kp lx ll lm kt ly lo lp kx lz lr ls lt hb bi translated">以上四种方法构成了这个构建的主要部分。</p><p id="a854" class="pw-post-body-paragraph lb lc hi ld b le lv is lg lh lw iv lj kp lx ll lm kt ly lo lp kx lz lr ls lt hb bi translated">click()方法允许您单击web元素。当编写一个机器人时，我们必须为我们试图点击的元素找到正确的标识。如果没有确定核心元素，那么我们的bot将无法正常工作。</p><p id="29ca" class="pw-post-body-paragraph lb lc hi ld b le lv is lg lh lw iv lj kp lx ll lm kt ly lo lp kx lz lr ls lt hb bi translated">send_keys()可用于执行按键操作。我们可以给send_keys()参数来按enter、tab和箭头键(以及许多其他键)。也可以使用此方法将字符串发送到输入字段。这是将send_keys()整合到电子邮件机器人中的主要方式。</p><p id="f11f" class="pw-post-body-paragraph lb lc hi ld b le lv is lg lh lw iv lj kp lx ll lm kt ly lo lp kx lz lr ls lt hb bi translated">直到()被WebDriverWait对象调用。WebDriverWait接受驱动程序的参数和等待某事发生的时间(以秒为单位)。until()与我们希望达到的某些标准结合使用。有些web元素在我们想要点击它们的时候可能还没有完全加载。可以调用element_to_be_clickable(要单击的web元素)作为until方法的参数。这将确保我们在web元素(作为element_to_be_clickable()的参数给出)变为可点击之前，等待一段指定的时间(由WebDriverWait对象的秒数参数决定)。</p><p id="159b" class="pw-post-body-paragraph lb lc hi ld b le lv is lg lh lw iv lj kp lx ll lm kt ly lo lp kx lz lr ls lt hb bi translated">find_element_by_xpath()方法允许我们设置定位特定web元素的规范。Selenium还提供了通过id和类名搜索元素的方法。然而，find_element_by_xpath()在指定不常用的HTML元素和属性时提供了更多的自由。</p><p id="bb73" class="pw-post-body-paragraph lb lc hi ld b le lv is lg lh lw iv lj kp lx ll lm kt ly lo lp kx lz lr ls lt hb bi translated">我还想提一下Chrome()和get()方法。虽然这些方法没有构成bot的主要功能，但它们仍然值得一提。</p><p id="dfa9" class="pw-post-body-paragraph lb lc hi ld b le lv is lg lh lw iv lj kp lx ll lm kt ly lo lp kx lz lr ls lt hb bi translated">Chrome()创建了一个Chrome web驱动的实例。Selenium使用web驱动程序来与相应的浏览器交互。在执行下面的电子邮件机器人之前，需要下载驱动程序。Selenium支持许多不同的浏览器(Chrome、Firefox、Internet Explorer等)。).</p><p id="e264" class="pw-post-body-paragraph lb lc hi ld b le lv is lg lh lw iv lj kp lx ll lm kt ly lo lp kx lz lr ls lt hb bi translated">get()将创建一个新的web浏览器实例。作为此方法的参数提供的URL将在新的浏览器实例中打开。</p></div><div class="ab cl jx jy gp jz" role="separator"><span class="ka bw bk kb kc kd"/><span class="ka bw bk kb kc kd"/><span class="ka bw bk kb kc"/></div><div class="hb hc hd he hf"><h2 id="711a" class="ke kf hi bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ho bi translated">电子邮件机器人实现</h2><figure class="jh ji jj jk fd jl"><div class="bz dy l di"><div class="mo mp l"/></div></figure><p id="f789" class="pw-post-body-paragraph lb lc hi ld b le lv is lg lh lw iv lj kp lx ll lm kt ly lo lp kx lz lr ls lt hb bi translated">注意:上面的实现将Options()对象作为参数传递给Chrome()方法。这是用来摆脱不必要的信息栏和弹出窗口。</p><p id="4bc3" class="pw-post-body-paragraph lb lc hi ld b le lv is lg lh lw iv lj kp lx ll lm kt ly lo lp kx lz lr ls lt hb bi translated">该代码可细分如下:</p><ul class=""><li id="1de8" class="ma mb hi ld b le lv lh lw kp mq kt mr kx ms lt mf mg mh mi bi translated">打开Outlook登录页面</li><li id="41b0" class="ma mb hi ld b le mj lh mk kp ml kt mm kx mn lt mf mg mh mi bi translated">将您的电子邮件发送到电子邮件输入字段</li><li id="7935" class="ma mb hi ld b le mj lh mk kp ml kt mm kx mn lt mf mg mh mi bi translated">点击<strong class="ld hs">下一个</strong>按钮</li><li id="3149" class="ma mb hi ld b le mj lh mk kp ml kt mm kx mn lt mf mg mh mi bi translated">将您的密码发送到密码输入字段</li><li id="5781" class="ma mb hi ld b le mj lh mk kp ml kt mm kx mn lt mf mg mh mi bi translated">点击<strong class="ld hs">签到</strong>按钮</li><li id="35e1" class="ma mb hi ld b le mj lh mk kp ml kt mm kx mn lt mf mg mh mi bi translated">点击<strong class="ld hs">新消息</strong>按钮</li><li id="1e15" class="ma mb hi ld b le mj lh mk kp ml kt mm kx mn lt mf mg mh mi bi translated">将收到消息的电子邮件发送到“收件人”输入字段</li><li id="6a51" class="ma mb hi ld b le mj lh mk kp ml kt mm kx mn lt mf mg mh mi bi translated">将文本发送到主题输入字段</li><li id="c608" class="ma mb hi ld b le mj lh mk kp ml kt mm kx mn lt mf mg mh mi bi translated">将您的消息发送到消息输入字段</li><li id="5927" class="ma mb hi ld b le mj lh mk kp ml kt mm kx mn lt mf mg mh mi bi translated">点击<strong class="ld hs">发送</strong>按钮</li></ul><p id="0cfb" class="pw-post-body-paragraph lb lc hi ld b le lv is lg lh lw iv lj kp lx ll lm kt ly lo lp kx lz lr ls lt hb bi translated">注意:无论是否抛出异常，都需要执行driver.quit()。quit()方法清除web驱动程序正在使用的任何资源。如果quit()没有被执行，那么内存将不会被正确释放，并可能导致内存泄漏。此方法还会在调用浏览器实例后将其关闭。因此，需要time.sleep()来保持浏览器打开足够长的时间，以确保代码正确运行。</p></div><div class="ab cl jx jy gp jz" role="separator"><span class="ka bw bk kb kc kd"/><span class="ka bw bk kb kc kd"/><span class="ka bw bk kb kc"/></div><div class="hb hc hd he hf"><h2 id="7b4b" class="ke kf hi bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ho bi translated">观看机器人的运行</h2><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es mt"><img src="../Images/1765f558283955b52c58383a058cad4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*6TONEKNtrQDDxiWMlc_zXw.gif"/></div></div><figcaption class="js jt et er es ju jv bd b be z dx translated">作者GIF</figcaption></figure><p id="8770" class="pw-post-body-paragraph lb lc hi ld b le lv is lg lh lw iv lj kp lx ll lm kt ly lo lp kx lz lr ls lt hb bi translated">在上面的GIF中，电子邮件机器人输入我的电子邮件信息，编写一封电子邮件，并发送它。我在GIF的末尾显示了接收bot消息的收件箱。该消息看起来完全正常(就好像我亲自输入并发送了它)。据我所知，没有办法知道这封邮件是否是由一个真实的人发出的。这种认识既令人兴奋又令人恐惧。在测试这个机器人时，我注意到了一些非常有趣的事情。发送的电子邮件仅显示在接收电子邮件的收件箱中。如果您重新加载用于发送消息的电子邮件，那么您将看不到自己发送的任何新消息。</p><p id="eef1" class="pw-post-body-paragraph lb lc hi ld b le lv is lg lh lw iv lj kp lx ll lm kt ly lo lp kx lz lr ls lt hb bi translated">注意:用于发送邮件的电子邮件是基于大学的Outlook电子邮件。普通的Outlook电子邮件(某些大学不使用)可能需要与上面不同的实现。这是因为一些web元素可能具有与所讨论的属性相对应的稍微不同的值。</p><p id="cae3" class="pw-post-body-paragraph lb lc hi ld b le lv is lg lh lw iv lj kp lx ll lm kt ly lo lp kx lz lr ls lt hb bi translated">注意:我为一个GIF创建了一个非常长的视频。我还必须在将视频转换成GIF之前对其进行编辑。所以帧率极慢。大约需要15秒左右才能看到消息最终到达(由于帧速率较慢)。</p></div><div class="ab cl jx jy gp jz" role="separator"><span class="ka bw bk kb kc kd"/><span class="ka bw bk kb kc kd"/><span class="ka bw bk kb kc"/></div><div class="hb hc hd he hf"><h2 id="7be9" class="ke kf hi bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ho bi translated">总结想法</h2><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es mu"><img src="../Images/5cad4dc58bb30e31dbfbf2724514ea84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*IJeSTkfplZhedCjt"/></div></div><figcaption class="js jt et er es ju jv bd b be z dx translated">弗洛里安·范·杜恩在<a class="ae jw" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="605f" class="pw-post-body-paragraph lb lc hi ld b le lv is lg lh lw iv lj kp lx ll lm kt ly lo lp kx lz lr ls lt hb bi translated">我用最少的硒知识做了一个邮件机器人。我不需要使用任何复杂的从一个窗口/框架到另一个的切换(这显然依赖于这个机器人的电子邮件平台)。使用的最高级的主题是调用find_element_by_xpath()方法。我真的相信使用find_element_by_xpath()在定位包含不太常见的属性的元素方面给了我更多的自由。令人难以置信的是，一个电子邮件机器人只用60行代码就能编写出来(如果不考虑注释和空格，就更少了)。希望你也可以用这篇文章来构建你自己的电子邮件机器人！</p><h2 id="e36f" class="ke kf hi bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ho bi translated">参考</h2><p id="6b89" class="pw-post-body-paragraph lb lc hi ld b le lf is lg lh li iv lj kp lk ll lm kt ln lo lp kx lq lr ls lt hb bi translated">文艺复兴工程师。(2019年5月25日)。Selenium WebDriver Python教程-安装和快速入门。【YouTube视频】。文艺复兴工程师。检索自<a class="ae jw" href="https://www.youtube.com/watch?v=W5GrTVwRlD4&amp;t=8s" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/watch?v=W5GrTVwRlD4&amp;t = 8s</a></p><p id="e33c" class="pw-post-body-paragraph lb lc hi ld b le lv is lg lh lw iv lj kp lx ll lm kt ly lo lp kx lz lr ls lt hb bi translated">文艺复兴工程师。(2019年5月31日)。Selenium WebDriver Python教程-制作一个简单的Bot。【YouTube视频】。文艺复兴工程师。从https://www.youtube.com/watch?v=eZNIgKEYstQ<a class="ae jw" href="https://www.youtube.com/watch?v=eZNIgKEYstQ&amp;t=1072s" rel="noopener ugc nofollow" target="_blank">取回&amp; t=1072s </a></p><p id="4805" class="pw-post-body-paragraph lb lc hi ld b le lv is lg lh lw iv lj kp lx ll lm kt ly lo lp kx lz lr ls lt hb bi translated">Muthukadan，B. (2018年)。硒与Python。从https://selenium-python.readthedocs.io/<a class="ae jw" href="https://selenium-python.readthedocs.io/" rel="noopener ugc nofollow" target="_blank">取回</a></p><p id="8656" class="pw-post-body-paragraph lb lc hi ld b le lv is lg lh lw iv lj kp lx ll lm kt ly lo lp kx lz lr ls lt hb bi translated">我的<a class="ae jw" href="https://github.com/wormhole85/email-bot" rel="noopener ugc nofollow" target="_blank"> GitHub repo </a>邮件机器人代码。</p></div></div>    
</body>
</html>