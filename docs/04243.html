<html>
<head>
<title>Simple Moving Average and Exponentially Weighted Moving Average</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">简单移动平均和指数加权移动平均</h1>
<blockquote>原文：<a href="https://medium.com/codex/simple-moving-average-and-exponentially-weighted-moving-average-with-pandas-57d4a457d363?source=collection_archive---------0-----------------------#2021-11-13">https://medium.com/codex/simple-moving-average-and-exponentially-weighted-moving-average-with-pandas-57d4a457d363?source=collection_archive---------0-----------------------#2021-11-13</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/6748bf67f23a2173dd11398d52a66480.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-TzkZuv98JBp4RQzFZXtrw.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">照片由来自<a class="ae iu" href="https://www.pexels.com/photo/graphs-display-on-an-ipad-187041/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> Pexels </a>的<a class="ae iu" href="https://www.pexels.com/@weekendplayer?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> Burak Kebapci </a>拍摄</figcaption></figure><p id="414e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">趋势是一种模式，显示数据随时间的移动。可以用手绘图解法、选点法、半平均法、移动平均法、最小二乘法进行测量。</p><p id="59b9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">移动平均</strong>的方法是基于不同时间点周期性变化的总效应完全中和的原理。它使用多个相邻数据点或周期的平均值，该平均值通过重叠观察计算得出，并且它<strong class="ix hj">突出时间序列中的长期趋势</strong>，同时捕捉短期波动。ARIMA等时间序列预测模型使用移动平均进行预测。</p><h2 id="9c35" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">简单移动平均线</h2><p id="c099" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">SMA是之前k个数据点的未加权平均值。如果p1，p2…，pn是时间序列数据点，并且最后k个数据点的平均值表示为SMAk，则它可以计算为:</p><figure class="ku kv kw kx fd ij er es paragraph-image"><div class="er es kt"><img src="../Images/48ea43593a08681819140709b0858ca4.png" data-original-src="https://miro.medium.com/v2/resize:fit:994/format:webp/1*JGcGKLtAB_kizSmUbsuw9g.png"/></div></figure><p id="d3d1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这里，k的相同采样宽度是从(n-k+1)到n的范围。当计算接下来k个数据点的SMA时，k的宽度将是从(n-k+2)到(n+1)的范围，并且新的值p(n+1)进入图像，并且p(n-k+1)消失。下一个k值的SMA可以用之前的值进行总结</p><p id="6828" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">SMA可以用熊猫来实现。DataFrame.rolling()函数用于计算固定窗口内的移动平均值。</p><p id="294e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">滚动函数的一般语法是</p><p id="1e09" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">data frame . rolling(<em class="ky">window</em>，<em class="ky"> min_periods=None </em>，<em class="ky"> center=False </em>，<em class="ky"> win_type=None </em>，<em class="ky"> on=None </em>，<em class="ky"> axis=0 </em>，<em class="ky"> closed=None </em>，<em class="ky"> method='single' </em> ) </strong></p><p id="5248" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">其中<strong class="ix hj"> <em class="ky">窗口</em> </strong>的大小是固定的，它是用于计算统计量的观察值的数量。如果未提供其他值，将采用默认值。</p><p id="1f6a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">滚动平均从具有窗口值大小的完整序列中创建一个子集，它将是第一个移动平均。然后通过<strong class="ix hj">向前移动</strong>到具有窗口大小的下一个子集来改变子集。</p><p id="c0a0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了解释rolling()，我使用了一个数据集来描述1959年(从1月1日到12月31日)加州每天的女性出生人数。数据集的前5行如下</p><figure class="ku kv kw kx fd ij er es paragraph-image"><div class="er es kz"><img src="../Images/821c508e0b42295b7ac008b9aab28d89.png" data-original-src="https://miro.medium.com/v2/resize:fit:650/format:webp/1*IeFJ1YjvaYguWFn9FJMujw.png"/></div></figure><p id="376e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">绘制数据框后，它将如下所示:</p><figure class="ku kv kw kx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es la"><img src="../Images/f5fb4b3172c118f0f1604d315ed9b660.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Fj5ClXz4T94jN-830qKjjw.png"/></div></div></figure><p id="1c76" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">rolling()函数用于5天的窗口大小，详细信息如下:</p><figure class="ku kv kw kx fd ij er es paragraph-image"><div class="er es lb"><img src="../Images/7a05307a183b9012fb3202a4053d9aec.png" data-original-src="https://miro.medium.com/v2/resize:fit:706/format:webp/1*sfEUDssRMQ3VCz7V3kk_Og.png"/></div></figure><p id="6495" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">前4天的值，即(窗口-1)值将为NaN，因为我们已经提供了从5天开始的滚动平均值。我们可以用线图来描绘它。</p><figure class="ku kv kw kx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lc"><img src="../Images/0584d0ffe396c567cc8ec27e506b571e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3MQYCTGc9KjAjY-Efxm0Lw.png"/></div></div></figure><p id="ef6b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">橙色线表示滚动平均值，不同于日线图，它具有平滑的趋势，因为它平滑了时间序列。</p><h2 id="1740" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated"><strong class="ak">指数加权移动平均(EWMA) </strong></h2><p id="3864" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">EWMA也被称为<strong class="ix hj">指数移动平均线(EMA)。</strong></p><p id="26a3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"/></p><p id="d5da" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">EMA是通过使用pandas函数实现的。DataFrame.ewm()。</p><p id="8438" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">一般语法是</p><p id="4937" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">data frame . ewm(<em class="ky">com = None</em>，<em class="ky"> span=None </em>，<em class="ky">半衰期=None </em>，<em class="ky"> alpha=None </em>，<em class="ky"> min_periods=0 </em>，<em class="ky"> adjust=True </em>，<em class="ky"> ignore_na=False </em>，<em class="ky"> axis=0 </em>，<em class="ky"> times=None </em> ) </strong></p><p id="bf84" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在EWMA，应用的权重取决于“调整参数”和使用的周期数。默认情况下，调整为真。</p><p id="e423" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">使用以下公式计算重量</p><figure class="ku kv kw kx fd ij er es paragraph-image"><div class="er es ld"><img src="../Images/7b66896c7fa19a5acd5ea2ea695c8b20.png" data-original-src="https://miro.medium.com/v2/resize:fit:448/format:webp/1*6SYpqNy07GJMg4lmhOlqaw.png"/></div></figure><figure class="ku kv kw kx fd ij er es paragraph-image"><div class="er es le"><img src="../Images/843bdd9d7672dcc77b0952f47b7ecb26.png" data-original-src="https://miro.medium.com/v2/resize:fit:220/format:webp/1*FmycM1QxyWn_ogHyqA6e0Q.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd jv">其中，alpha是一个平滑因子，取值范围为0到1，包括1。</strong></figcaption></figure><p id="96cd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">当调整参数为真时，yt计算如下</p><figure class="ku kv kw kx fd ij er es paragraph-image"><div class="er es lf"><img src="../Images/b559d9a703695178e08bcebe3b9cb0ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:988/format:webp/1*Tvsp2kZfWBxGHPqLHsWWDw.png"/></div></figure><p id="6580" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">当调整参数为假时，yt计算如下</p><figure class="ku kv kw kx fd ij er es paragraph-image"><div class="er es lg"><img src="../Images/9d15336157ec3b017a52cfc106192aac.png" data-original-src="https://miro.medium.com/v2/resize:fit:514/format:webp/1*peh1QtPGvtMJnd18_raGGw.png"/></div></figure><p id="c274" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">跨度对应于通常所说的“N日EW移动平均线”</p><figure class="ku kv kw kx fd ij er es paragraph-image"><div class="er es lh"><img src="../Images/ccfb323a7e85c7d86e7f9ef89904d2ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1016/format:webp/1*5GPVN6uUAyIRm7LYk8Uucg.png"/></div></figure><figure class="ku kv kw kx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es li"><img src="../Images/767ead127c0ef3c51759e621d57000f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bvh-sO5JnjRqhw2h-_Iu1g.png"/></div></div></figure><p id="1047" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果绘制最后几行，绘图将如下。</p><figure class="ku kv kw kx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lj"><img src="../Images/029fba085043b17292aeb872db219767.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4qGHG21hLY--QKLniwdrGQ.png"/></div></div></figure><p id="f3d4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">EWMA用于计算会计/财务流程中可能看起来非常大的日常波动，它可以用于计算电子商务网站或其他网站的波动，等等。,</p><p id="186f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">对于ewm()函数，comass、span、halflife和alpha是互斥的，因此要绘制ewm()。mean()对于不同的alpha值，不能提供span。当提供跨度时，alpha计算为2/(跨度+1)，其中跨度&gt; = 1。</p><figure class="ku kv kw kx fd ij er es paragraph-image"><div class="er es lk"><img src="../Images/e6740fe080d9210f16ffe48106ce4e88.png" data-original-src="https://miro.medium.com/v2/resize:fit:844/format:webp/1*I6OINrtpesDt8tgsz1IB3g.png"/></div></figure><figure class="ku kv kw kx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ll"><img src="../Images/b81c9e91964cfa720273f5553f492e97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bfTSYaygQCxfr_Ve5tbf0A.png"/></div></div></figure><p id="10cd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">随着alpha值的增加，它变得越来越类似于原始特征。<br/>我们来绘制原始特征，alpha值=0.98999。</p><figure class="ku kv kw kx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lm"><img src="../Images/0b14f5c54c39f4973876ab436af34dd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B_ZRFFZCcFWRkX8f4HA1UA.png"/></div></div></figure><p id="aaa0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这里，ewma图几乎与原始特征重叠，我标记了几个点，在这些点上蓝线是可见的。如果alpha值取为1，它将与原始值重叠。因此α值应根据要求取值。</p><p id="c823" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">你可以从<a class="ae iu" href="https://github.com/SandKrish/TimeSeries/blob/main/SMA_EWMA.ipynb" rel="noopener ugc nofollow" target="_blank">这里</a>获得完整的代码。</p><p id="c8f9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">感谢阅读！！！！如果这篇文章对你有帮助，欢迎鼓掌，分享和回复。</strong></p></div><div class="ab cl ln lo gp lp" role="separator"><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls"/></div><div class="hb hc hd he hf"><h1 id="a285" class="lu ju hi bd jv lv lw lx jz ly lz ma kd mb mc md kg me mf mg kj mh mi mj km mk bi translated">参考</h1><div class="ml mm ez fb mn mo"><a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.rolling.html" rel="noopener  ugc nofollow" target="_blank"><div class="mp ab dw"><div class="mq ab mr cl cj ms"><h2 class="bd hj fi z dy mt ea eb mu ed ef hh bi translated">熊猫。DataFrame.rolling - pandas 1.3.4文档</h2><div class="mv l"><h3 class="bd b fi z dy mt ea eb mu ed ef dx translated">提供滚动窗口计算。参数windowint、offset或BaseIndexer移动窗口的子类大小…</h3></div><div class="mw l"><p class="bd b fp z dy mt ea eb mu ed ef dx translated">pandas.pydata.org</p></div></div></div></a></div><div class="ml mm ez fb mn mo"><a href="https://en.wikipedia.org/wiki/Moving_average" rel="noopener  ugc nofollow" target="_blank"><div class="mp ab dw"><div class="mq ab mr cl cj ms"><h2 class="bd hj fi z dy mt ea eb mu ed ef hh bi translated">移动平均线-维基百科</h2><div class="mv l"><h3 class="bd b fi z dy mt ea eb mu ed ef dx translated">在统计学中，移动平均线(滚动平均线或移动平均线)是一种通过…分析数据点的计算方法</h3></div><div class="mw l"><p class="bd b fp z dy mt ea eb mu ed ef dx translated">en.wikipedia.org</p></div></div><div class="mx l"><div class="my l mz na nb mx nc io mo"/></div></div></a></div></div></div>    
</body>
</html>