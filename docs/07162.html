<html>
<head>
<title>How does Apache ShardingSphere standardize and format code? We use Spotless</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Apache ShardingSphere如何标准化和格式化代码？我们使用一尘不染</h1>
<blockquote>原文：<a href="https://medium.com/codex/how-does-apache-shardingsphere-standardize-and-format-code-we-use-spotless-caf09403de6a?source=collection_archive---------7-----------------------#2022-06-02">https://medium.com/codex/how-does-apache-shardingsphere-standardize-and-format-code-we-use-spotless-caf09403de6a?source=collection_archive---------7-----------------------#2022-06-02</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="0a8e" class="pw-post-body-paragraph ih ii hi ij b ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je hb bi translated">为什么我们需要格式化代码？简单地说，就是让代码更容易阅读、理解和修改。</p><p id="ef88" class="pw-post-body-paragraph ih ii hi ij b ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je hb bi translated">作为顶级的Apache开源项目，<a class="ae jf" href="https://shardingsphere.apache.org/" rel="noopener ugc nofollow" target="_blank"> ShardingSphere </a>到目前为止已经有400个贡献者。由于大多数开发人员没有相同的编码风格，因此在GitHub开放协作模型中标准化项目的整体代码格式并不容易。为了解决这个问题，ShardingSphere使用<a class="ae jf" href="https://github.com/diffplug/spotless/tree/main/plugin-maven" rel="noopener ugc nofollow" target="_blank">完美的</a>来统一代码格式。</p><h2 id="8b5a" class="jg jh hi bd ji jj jk jl jm jn jo jp jq is jr js jt iw ju jv jw ja jx jy jz ka bi translated">什么是一尘不染？</h2><p id="4f98" class="pw-post-body-paragraph ih ii hi ij b ik kb im in io kc iq ir is kd iu iv iw ke iy iz ja kf jc jd je hb bi translated">纤尘不染是一个多语言代码格式化工具，支持<a class="ae jf" href="https://maven.apache.org/" rel="noopener ugc nofollow" target="_blank"> Maven </a>和<a class="ae jf" href="https://gradle.org/" rel="noopener ugc nofollow" target="_blank"> Gradle </a>用插件构建。</p><p id="7376" class="pw-post-body-paragraph ih ii hi ij b ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je hb bi translated">开发人员可以通过两种方式来使用Monica:检查代码中与格式相关的问题，以及格式化代码。</p><blockquote class="kg kh ki"><p id="dda7" class="ih ii kj ij b ik il im in io ip iq ir kk it iu iv kl ix iy iz km jb jc jd je hb bi translated">ShardingSphere社区使用Maven来构建它的项目——而Monica使用Maven进行演示。</p></blockquote><h2 id="88c8" class="jg jh hi bd ji jj jk jl jm jn jo jp jq is jr js jt iw ju jv jw ja jx jy jz ka bi translated">怎么用？</h2><p id="2d81" class="pw-post-body-paragraph ih ii hi ij b ik kb im in io kc iq ir is kd iu iv iw ke iy iz ja kf jc jd je hb bi translated">让我们来看看下面的官方演示:</p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="d8ef" class="jg jh hi ks b fi kw kx l ky kz">user@machine repo % mvn spotless:check</span><span id="8088" class="jg jh hi ks b fi la kx l ky kz">[ERROR]  &gt; The following files had format violations:</span><span id="5bc5" class="jg jh hi ks b fi la kx l ky kz">[ERROR]  src\main\java\com\diffplug\gradle\spotless\FormatExtension.java</span><span id="9209" class="jg jh hi ks b fi la kx l ky kz">[ERROR]    -\t\t····if·(targets.length·==·0)·{</span><span id="2196" class="jg jh hi ks b fi la kx l ky kz">[ERROR]    +\t\tif·(targets.length·==·0)·{</span><span id="226f" class="jg jh hi ks b fi la kx l ky kz">[ERROR]  Run 'mvn spotless:apply' to fix these violations.</span><span id="e097" class="jg jh hi ks b fi la kx l ky kz">user@machine repo % mvn spotless:apply</span><span id="1456" class="jg jh hi ks b fi la kx l ky kz">[INFO] BUILD SUCCESS</span><span id="b94c" class="jg jh hi ks b fi la kx l ky kz">user@machine repo % mvn spotless:check</span><span id="4eb5" class="jg jh hi ks b fi la kx l ky kz">[INFO] BUILD SUCCESS</span></pre><p id="717d" class="pw-post-body-paragraph ih ii hi ij b ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je hb bi translated">当你用<code class="du lb lc ld ks b"> mvn spotless:check</code>检查项目代码时，出现错误，然后用<code class="du lb lc ld ks b">mvn spotless:apply</code>格式化代码。一旦你再次检查，格式错误已经神奇地消失了。</p><h2 id="2af2" class="jg jh hi bd ji jj jk jl jm jn jo jp jq is jr js jt iw ju jv jw ja jx jy jz ka bi translated">1.准备您的环境</h2><p id="e6d0" class="pw-post-body-paragraph ih ii hi ij b ik kb im in io kc iq ir is kd iu iv iw ke iy iz ja kf jc jd je hb bi translated">ShardingSphere使用Monica来添加Java文件<code class="du lb lc ld ks b">licenseHeader</code>和格式化Java代码。</p><p id="82a4" class="pw-post-body-paragraph ih ii hi ij b ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je hb bi translated">纤尘不染有几种Java代码格式化方法，比如:<code class="du lb lc ld ks b">googleJavaFormat</code>、<code class="du lb lc ld ks b">eclipse</code>、<code class="du lb lc ld ks b">prettier</code>等。</p><p id="186d" class="pw-post-body-paragraph ih ii hi ij b ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je hb bi translated">出于定制的原因，我们选择<code class="du lb lc ld ks b">eclipse</code>进行Java代码格式化。</p><figure class="kn ko kp kq fd le er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es et"><img src="../Images/6813b751d6d2551096bbb44e00d13df8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Eh3QKtXme-4VdDZy"/></div></div></figure><p id="5bff" class="pw-post-body-paragraph ih ii hi ij b ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je hb bi translated"><strong class="ij hj"> a)根据项目要求</strong>添加 <code class="du lb lc ld ks b"><strong class="ij hj">licenseHeader</strong></code> <strong class="ij hj"/></p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="893c" class="jg jh hi ks b fi kw kx l ky kz">/*</span><span id="c02d" class="jg jh hi ks b fi la kx l ky kz">* Licensed to the Apache Software Foundation (ASF) under one or more</span><span id="1e65" class="jg jh hi ks b fi la kx l ky kz">* contributor license agreements.  See the NOTICE file distributed with</span><span id="6778" class="jg jh hi ks b fi la kx l ky kz">* this work for additional information regarding copyright ownership.</span><span id="24f4" class="jg jh hi ks b fi la kx l ky kz">* The ASF licenses this file to You under the Apache License, Version 2.0</span><span id="2e09" class="jg jh hi ks b fi la kx l ky kz">* (the "License"); you may not use this file except in compliance with</span><span id="ca2d" class="jg jh hi ks b fi la kx l ky kz">* the License.  You may obtain a copy of the License at</span><span id="6bf3" class="jg jh hi ks b fi la kx l ky kz">*</span><span id="8631" class="jg jh hi ks b fi la kx l ky kz">*     <a class="ae jf" href="http://www.apache.org/licenses/LICENSE-2.0" rel="noopener ugc nofollow" target="_blank">http://www.apache.org/licenses/LICENSE-2.0</a></span><span id="fd37" class="jg jh hi ks b fi la kx l ky kz">*</span><span id="bca0" class="jg jh hi ks b fi la kx l ky kz">* Unless required by applicable law or agreed to in writing, software</span><span id="1cd5" class="jg jh hi ks b fi la kx l ky kz">* distributed under the License is distributed on an "AS IS" BASIS,</span><span id="456d" class="jg jh hi ks b fi la kx l ky kz">* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span><span id="3bd3" class="jg jh hi ks b fi la kx l ky kz">* See the License for the specific language governing permissions and</span><span id="fcb8" class="jg jh hi ks b fi la kx l ky kz">* limitations under the License.</span><span id="149b" class="jg jh hi ks b fi la kx l ky kz">*/</span></pre><p id="e916" class="pw-post-body-paragraph ih ii hi ij b ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je hb bi translated"><strong class="ij hj">注意:</strong>记得在<code class="du lb lc ld ks b">licenseHeader</code>的末尾加一个空格。否则<code class="du lb lc ld ks b">licenseHeader</code>和包装之间将没有空间。</p><p id="e38a" class="pw-post-body-paragraph ih ii hi ij b ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je hb bi translated"><strong class="ij hj"> b)添加</strong>T10】</p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="3058" class="jg jh hi ks b fi kw kx l ky kz">?xml version="1.0" encoding="UTF-8" standalone="no"?&gt;<br/></span><span id="8c80" class="jg jh hi ks b fi la kx l ky kz">&lt;profiles version="13"&gt;</span><span id="9b72" class="jg jh hi ks b fi la kx l ky kz">    &lt;profile kind="CodeFormatterProfile" name="'ShardingSphere Apache Current'" version="13"&gt;</span><span id="7d08" class="jg jh hi ks b fi la kx l ky kz">        &lt;setting id="org.eclipse.jdt.core.compiler.source" value="1.8"/&gt;<br/>        &lt;setting id="org.eclipse.jdt.core.compiler.compliance" value="1.8"/&gt;</span><span id="1e61" class="jg jh hi ks b fi la kx l ky kz">        &lt;setting id="org.eclipse.jdt.core.compiler.codegen.targetPlatform" value="1.8"/&gt;</span><span id="d74c" class="jg jh hi ks b fi la kx l ky kz">        &lt;setting id="org.eclipse.jdt.core.formatter.indent_empty_lines" value="true"/&gt;</span><span id="585e" class="jg jh hi ks b fi la kx l ky kz">        &lt;setting id="org.eclipse.jdt.core.formatter.tabulation.size" value="4"/&gt;</span><span id="ed45" class="jg jh hi ks b fi la kx l ky kz">        &lt;setting id="org.eclipse.jdt.core.formatter.lineSplit" value="200"/&gt;</span><span id="5fe3" class="jg jh hi ks b fi la kx l ky kz">        &lt;setting id="org.eclipse.jdt.core.formatter.comment.line_length" value="200"/&gt;</span><span id="031c" class="jg jh hi ks b fi la kx l ky kz">        &lt;setting id="org.eclipse.jdt.core.formatter.tabulation.char" value="space"/&gt;</span><span id="174a" class="jg jh hi ks b fi la kx l ky kz">        &lt;setting id="org.eclipse.jdt.core.formatter.indentation.size" value="1"/&gt;</span><span id="15cf" class="jg jh hi ks b fi la kx l ky kz">        &lt;setting id="org.eclipse.jdt.core.formatter.comment.format_javadoc_comments" value="false"/&gt;</span><span id="4f70" class="jg jh hi ks b fi la kx l ky kz">        &lt;setting id="org.eclipse.jdt.core.formatter.join_wrapped_lines" value="false"/&gt;</span><span id="ccee" class="jg jh hi ks b fi la kx l ky kz">        &lt;setting id="org.eclipse.jdt.core.formatter.insert_space_before_colon_in_conditional" value="insert"/&gt;</span><span id="191b" class="jg jh hi ks b fi la kx l ky kz">        &lt;setting id="org.eclipse.jdt.core.formatter.insert_space_before_colon_in_default" value="do not insert"/&gt;</span><span id="4905" class="jg jh hi ks b fi la kx l ky kz">        &lt;setting id="org.eclipse.jdt.core.formatter.alignment_for_enum_constants" value="16"/&gt;</span><span id="ebdb" class="jg jh hi ks b fi la kx l ky kz">        &lt;setting id="org.eclipse.jdt.core.formatter.insert_space_before_colon_in_labeled_statement" value="do not insert"/&gt;</span><span id="2f7d" class="jg jh hi ks b fi la kx l ky kz">        &lt;setting id="org.eclipse.jdt.core.formatter.insert_space_before_colon_in_case" value="do not insert"/&gt;</span><span id="bac5" class="jg jh hi ks b fi la kx l ky kz">        &lt;setting id="org.eclipse.jdt.core.formatter.alignment_for_conditional_expression" value="80"/&gt;</span><span id="a4fc" class="jg jh hi ks b fi la kx l ky kz">        &lt;setting id="org.eclipse.jdt.core.formatter.alignment_for_assignment" value="16"/&gt;</span><span id="1e5e" class="jg jh hi ks b fi la kx l ky kz">        &lt;setting id="org.eclipse.jdt.core.formatter.blank_lines_after_package" value="1"/&gt;</span><span id="fa2e" class="jg jh hi ks b fi la kx l ky kz">        &lt;setting id="org.eclipse.jdt.core.formatter.continuation_indentation_for_array_initializer" value="2"/&gt;</span><span id="d2ac" class="jg jh hi ks b fi la kx l ky kz">        &lt;setting id="org.eclipse.jdt.core.formatter.alignment_for_resources_in_try" value="160"/&gt;</span><span id="535d" class="jg jh hi ks b fi la kx l ky kz">        &lt;setting id="org.eclipse.jdt.core.formatter.alignment_for_throws_clause_in_method_declaration" value="10"/&gt;</span><span id="36c1" class="jg jh hi ks b fi la kx l ky kz">        &lt;setting id="org.eclipse.jdt.core.formatter.alignment_for_parameters_in_method_declaration" value="106"/&gt;</span><span id="fe87" class="jg jh hi ks b fi la kx l ky kz">        &lt;setting id="org.eclipse.jdt.core.formatter.alignment_for_parameters_in_constructor_declaration" value="106"/&gt;</span><span id="2111" class="jg jh hi ks b fi la kx l ky kz">        &lt;setting id="org.eclipse.jdt.core.formatter.alignment_for_throws_clause_in_constructor_declaration" value="106"/&gt;</span><span id="308a" class="jg jh hi ks b fi la kx l ky kz">        &lt;setting id="org.eclipse.jdt.core.formatter.alignment_for_arguments_in_explicit_constructor_call.count_dependent" value="16|5|80"/&gt;</span><span id="71b8" class="jg jh hi ks b fi la kx l ky kz">    &lt;/profile&gt;</span><span id="8365" class="jg jh hi ks b fi la kx l ky kz">&lt;/profiles&gt;</span></pre><p id="3d20" class="pw-post-body-paragraph ih ii hi ij b ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je hb bi translated">关于ShardingSphere的最新规则，请参见<code class="du lb lc ld ks b"><a class="ae jf" href="https://github.com/apache/shardingsphere/blob/master/src/resources/shardingsphere_eclipse_formatter.xml" rel="noopener ugc nofollow" target="_blank">shardingsphereeclipseformatter.xml</a></code>。如需参考，请查看<code class="du lb lc ld ks b"><a class="ae jf" href="https://github.com/google/styleguide/blob/gh-pages/eclipse-java-google-style.xml" rel="noopener ugc nofollow" target="_blank">eclipse-java-google-style.xml</a> </code>文件。</p><p id="51e4" class="pw-post-body-paragraph ih ii hi ij b ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je hb bi translated"><code class="du lb lc ld ks b">shardingsphereeclipseformatter.xml</code>的内容是按照ShardingSphere代码规范量身定制的，可以灵活更改。</p><p id="6c1a" class="pw-post-body-paragraph ih ii hi ij b ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je hb bi translated"><strong class="ij hj"> c)添加Maven插件</strong></p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="c610" class="jg jh hi ks b fi kw kx l ky kz">&lt;plugin&gt;</span><span id="7322" class="jg jh hi ks b fi la kx l ky kz">    &lt;groupId&gt;com.diffplug.spotless&lt;/groupId&gt;</span><span id="af3c" class="jg jh hi ks b fi la kx l ky kz">    &lt;artifactId&gt;spotless-maven-plugin&lt;/artifactId&gt;</span><span id="3875" class="jg jh hi ks b fi la kx l ky kz">    &lt;version&gt;2.22.1&lt;/version&gt;</span><span id="601d" class="jg jh hi ks b fi la kx l ky kz">    &lt;configuration&gt;</span><span id="d51c" class="jg jh hi ks b fi la kx l ky kz">        &lt;java&gt;</span><span id="eb54" class="jg jh hi ks b fi la kx l ky kz">            &lt;eclipse<br/>                 &lt;file&gt;${maven.multiModuleProjectDirectory}/src/resources/shardingsphere_eclipse_formatter.xml&lt;/file&gt;</span><span id="35d4" class="jg jh hi ks b fi la kx l ky kz">            &lt;/eclipse&gt;</span><span id="23e9" class="jg jh hi ks b fi la kx l ky kz">            &lt;licenseHeader&gt;</span><span id="bab6" class="jg jh hi ks b fi la kx l ky kz">                &lt;file&gt;${maven.multiModuleProjectDirectory}/src/resources/license-header&lt;/file&gt;</span><span id="3b3e" class="jg jh hi ks b fi la kx l ky kz">            &lt;/licenseHeader&gt;</span><span id="e270" class="jg jh hi ks b fi la kx l ky kz">        &lt;/java&gt;</span><span id="2ad5" class="jg jh hi ks b fi la kx l ky kz">    &lt;/configuration&gt;</span><span id="0c81" class="jg jh hi ks b fi la kx l ky kz">&lt;/plugin&gt;</span></pre><p id="3390" class="pw-post-body-paragraph ih ii hi ij b ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je hb bi translated">一尘不染支持指定的格式化目录和排除指定的目录。更多信息，请参见<code class="du lb lc ld ks b"><a class="ae jf" href="https://github.com/diffplug/spotless/tree/main/plugin-maven#java" rel="noopener ugc nofollow" target="_blank">plugin-maven#java</a></code>。如果没有指定，当执行<code class="du lb lc ld ks b">check</code>或<code class="du lb lc ld ks b"> apply</code>时，默认情况下所有的项目代码都会受到影响。</p><p id="7dd8" class="pw-post-body-paragraph ih ii hi ij b ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je hb bi translated"><strong class="ij hj"> d)执行代码格式化</strong></p><p id="dedc" class="pw-post-body-paragraph ih ii hi ij b ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je hb bi translated">在执行以上三个步骤之后，您可以在项目中执行命令来检查Java代码是否符合规范，以及代码格式化特性。</p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="1a31" class="jg jh hi ks b fi kw kx l ky kz">user@machine repo % mvn spotless:apply</span><span id="4dc7" class="jg jh hi ks b fi la kx l ky kz">[INFO] BUILD SUCCESS</span><span id="9188" class="jg jh hi ks b fi la kx l ky kz">user@machine repo % mvn spotless:check</span><span id="efc8" class="jg jh hi ks b fi la kx l ky kz">[INFO] BUILD SUCCESS</span></pre><h2 id="774e" class="jg jh hi bd ji jj jk jl jm jn jo jp jq is jr js jt iw ju jv jw ja jx jy jz ka bi translated">2.绑定Maven生命周期</h2><p id="bf7b" class="pw-post-body-paragraph ih ii hi ij b ik kb im in io kc iq ir is kd iu iv iw ke iy iz ja kf jc jd je hb bi translated">在实际的ShardingSphere应用程序中，您可以选择将pinpoint<code class="du lb lc ld ks b">apply </code>绑定到编译阶段，以便在本地执行mvn安装时自动格式化。</p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="d757" class="jg jh hi ks b fi kw kx l ky kz">&lt;plugin&gt;</span><span id="1cd1" class="jg jh hi ks b fi la kx l ky kz">    &lt;groupId&gt;com.diffplug.spotless&lt;/groupId&gt;</span><span id="39bb" class="jg jh hi ks b fi la kx l ky kz">    &lt;artifactId&gt;spotless-maven-plugin&lt;/artifactId&gt;</span><span id="5e68" class="jg jh hi ks b fi la kx l ky kz">    &lt;version&gt;2.22.1&lt;/version&gt;</span><span id="9947" class="jg jh hi ks b fi la kx l ky kz">    &lt;configuration&gt;</span><span id="ed73" class="jg jh hi ks b fi la kx l ky kz">        &lt;java&gt;</span><span id="d2da" class="jg jh hi ks b fi la kx l ky kz">            &lt;eclipse&gt;                &lt;file&gt;${maven.multiModuleProjectDirectory}/src/resources/shardingsphere_eclipse_formatter.xml&lt;/file&gt;</span><span id="9c4c" class="jg jh hi ks b fi la kx l ky kz">            &lt;/eclipse&gt;</span><span id="6ce9" class="jg jh hi ks b fi la kx l ky kz">            &lt;licenseHeader&gt;</span><span id="ba4c" class="jg jh hi ks b fi la kx l ky kz">                &lt;file&gt;${maven.multiModuleProjectDirectory}/src/resources/license-header&lt;/file&gt;</span><span id="dda9" class="jg jh hi ks b fi la kx l ky kz">            &lt;/licenseHeader&gt;</span><span id="373a" class="jg jh hi ks b fi la kx l ky kz">        &lt;/java&gt;</span><span id="f241" class="jg jh hi ks b fi la kx l ky kz">    &lt;/configuration&gt;</span><span id="d979" class="jg jh hi ks b fi la kx l ky kz">    &lt;executions&gt;</span><span id="b166" class="jg jh hi ks b fi la kx l ky kz">        &lt;execution&gt;</span><span id="83f2" class="jg jh hi ks b fi la kx l ky kz">            &lt;goals&gt;</span><span id="9390" class="jg jh hi ks b fi la kx l ky kz">                &lt;goal&gt;apply&lt;/goal&gt;</span><span id="ed24" class="jg jh hi ks b fi la kx l ky kz">            &lt;/goals&gt;</span><span id="c73b" class="jg jh hi ks b fi la kx l ky kz">            &lt;phase&gt;compile&lt;/phase&gt;</span><span id="6d23" class="jg jh hi ks b fi la kx l ky kz">        &lt;/execution&gt;</span><span id="4f3d" class="jg jh hi ks b fi la kx l ky kz">    &lt;/executions&gt;</span><span id="89f3" class="jg jh hi ks b fi la kx l ky kz">&lt;/plugin&gt;</span></pre><h2 id="15d7" class="jg jh hi bd ji jj jk jl jm jn jo jp jq is jr js jt iw ju jv jw ja jx jy jz ka bi translated">3.想法格式</h2><p id="7305" class="pw-post-body-paragraph ih ii hi ij b ik kb im in io kc iq ir is kd iu iv iw ke iy iz ja kf jc jd je hb bi translated">如果您想在编写代码时检查单个文件的一致性，执行<code class="du lb lc ld ks b">mvn spotless:check</code>或<code class="du lb lc ld ks b">mvn spotless:apply</code>会有点麻烦，因为默认情况下格式化范围是整个项目。</p><p id="4622" class="pw-post-body-paragraph ih ii hi ij b ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je hb bi translated">IntelliJ IDEA的原生格式化功能可以用<code class="du lb lc ld ks b">shardingsphereeclipseformatter.xml</code>代替。</p><p id="1302" class="pw-post-body-paragraph ih ii hi ij b ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je hb bi translated">这样，您可以在编写过程中随时格式化代码，从而显著提高效率。</p><p id="d088" class="pw-post-body-paragraph ih ii hi ij b ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je hb bi translated">IDEA版本:2019.3.4</p><p id="65d9" class="pw-post-body-paragraph ih ii hi ij b ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je hb bi translated"><strong class="ij hj"> a)安装插件Eclipse代码格式化程序</strong></p><figure class="kn ko kp kq fd le er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es ll"><img src="../Images/0dae8a4da992d4400cef4a6c3f213237.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ZLG4UJNc5j0sl29w"/></div></div></figure><p id="0206" class="pw-post-body-paragraph ih ii hi ij b ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je hb bi translated"><strong class="ij hj"> b)选择</strong> <code class="du lb lc ld ks b"><strong class="ij hj">shardingsphereeclipseformatter.xml</strong></code> <strong class="ij hj">作为默认格式模板</strong></p><figure class="kn ko kp kq fd le er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es ll"><img src="../Images/5045e823108f7b177968f7223403cb84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*NVEcu_RO3fFw-0m3"/></div></div></figure><p id="1f06" class="pw-post-body-paragraph ih ii hi ij b ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je hb bi translated">使用IDEA代码格式化快捷方式可以实现完美的代码格式化。</p><h1 id="336a" class="lm jh hi bd ji ln lo lp jm lq lr ls jq lt lu lv jt lw lx ly jw lz ma mb jz mc bi translated">常见问题解答</h1><h2 id="3efc" class="jg jh hi bd ji jj jk jl jm jn jo jp jq is jr js jt iw ju jv jw ja jx jy jz ka bi translated">1.一尘不染和方格风格之间的冲突</h2><p id="e3a7" class="pw-post-body-paragraph ih ii hi ij b ik kb im in io kc iq ir is kd iu iv iw ke iy iz ja kf jc jd je hb bi translated"><a class="ae jf" href="https://github.com/checkstyle/checkstyle" rel="noopener ugc nofollow" target="_blank"> Checkstyle </a>是一个检查Java源代码是否符合代码标准或一组验证规则(最佳实践)的工具。</p><p id="deaf" class="pw-post-body-paragraph ih ii hi ij b ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je hb bi translated">在极端情况下，完美的格式化代码无法通过Checkstyle检查。</p><p id="22ac" class="pw-post-body-paragraph ih ii hi ij b ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je hb bi translated">根本原因是检查机制和两者设置的格式配置之间的冲突。例如，一尘不染格式的新行缩进16个空格，而Checkstyle检查12个空格的新行。</p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="59c0" class="jg jh hi ks b fi kw kx l ky kz">private static Collection&lt;PreciseHintShadowValue&lt;Comparable&lt;?&gt;&gt;&gt; createNoteShadowValues(final ShadowDetermineCondition shadowDetermineCondition) {</span><span id="7b07" class="jg jh hi ks b fi la kx l ky kz">    // format that can pass Checkstyle</span><span id="0cf4" class="jg jh hi ks b fi la kx l ky kz">    return shadowDetermineCondition.getSqlComments().stream().&lt;PreciseHintShadowValue&lt;Comparable&lt;?&gt;&gt;&gt;map(</span><span id="0178" class="jg jh hi ks b fi la kx l ky kz">        each -&gt; new PreciseHintShadowValue&lt;&gt;(tableName, shadowOperationType, each)).collect(Collectors.toList());</span><span id="f9b1" class="jg jh hi ks b fi la kx l ky kz">    // After being formatted by Spotless</span><span id="f042" class="jg jh hi ks b fi la kx l ky kz">    return shadowDetermineCondition.getSqlComments().stream().&lt;PreciseHintShadowValue&lt;Comparable&lt;?&gt;&gt;&gt;map(</span><span id="4bde" class="jg jh hi ks b fi la kx l ky kz">           each -&gt; new PreciseHintShadowValue&lt;&gt;(tableName, shadowOperationType, each)).collect(Collectors.toList());</span><span id="b735" class="jg jh hi ks b fi la kx l ky kz">}</span></pre><p id="6faf" class="pw-post-body-paragraph ih ii hi ij b ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je hb bi translated">这种情况需要开发者权衡利弊。有两种解决方案:修改无污点的格式规则，或修改Checkstyle的检查规则。</p><p id="9fdd" class="pw-post-body-paragraph ih ii hi ij b ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je hb bi translated"><strong class="ij hj"> 2。CRLF &amp; LF </strong>之间的格式冲突</p><p id="f56f" class="pw-post-body-paragraph ih ii hi ij b ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je hb bi translated">参见https://github.com/diffplug/spotless/issues/1171的<a class="ae jf" href="https://github.com/diffplug/spotless/issues/1171" rel="noopener ugc nofollow" target="_blank"/></p><h1 id="f763" class="lm jh hi bd ji ln lo lp jm lq lr ls jq lt lu lv jt lw lx ly jw lz ma mb jz mc bi translated">摘要</h1><p id="f6d6" class="pw-post-body-paragraph ih ii hi ij b ik kb im in io kc iq ir is kd iu iv iw ke iy iz ja kf jc jd je hb bi translated">Apache ShardingSphere使用pineagle来格式化遗留代码，以及随后的代码格式标准化，这有助于保持项目代码的整洁。</p><p id="0051" class="pw-post-body-paragraph ih ii hi ij b ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je hb bi translated">当然，fispot不限于Java代码格式化，还包括<code class="du lb lc ld ks b">Pom</code>、<code class="du lb lc ld ks b">Markdown</code>等文件类型的格式化，很快就会在ShardingSphere中应用。</p><h1 id="c645" class="lm jh hi bd ji ln lo lp jm lq lr ls jq lt lu lv jt lw lx ly jw lz ma mb jz mc bi translated">作者</h1><p id="d2d4" class="pw-post-body-paragraph ih ii hi ij b ik kb im in io kc iq ir is kd iu iv iw ke iy iz ja kf jc jd je hb bi translated"><strong class="ij hj">龙泰</strong></p><p id="2f93" class="pw-post-body-paragraph ih ii hi ij b ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je hb bi translated"><a class="ae jf" href="https://github.com/longtai-cn" rel="noopener ugc nofollow" target="_blank"><strong class="ij hj">Github ID</strong></a><strong class="ij hj">:</strong>longtai-cn</p><p id="71b6" class="pw-post-body-paragraph ih ii hi ij b ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je hb bi translated"><a class="ae jf" href="https://shardingsphere.apache.org/" rel="noopener ugc nofollow" target="_blank"><em class="kj">Apache sharding sphere</em></a><em class="kj">贡献者；hippo4j作者(2.2K GitHub stars)。</em></p></div></div>    
</body>
</html>