<html>
<head>
<title>How to build in-app chat using Kotlin — Part 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Kotlin构建应用内聊天——第1部分</h1>
<blockquote>原文：<a href="https://medium.com/codex/how-to-build-in-app-chat-using-kotlin-part-1-750b3ebd4457?source=collection_archive---------4-----------------------#2021-12-16">https://medium.com/codex/how-to-build-in-app-chat-using-kotlin-part-1-750b3ebd4457?source=collection_archive---------4-----------------------#2021-12-16</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/c641a15b7c03c7e63e3d9ddaa7b25744.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*66VzkbnDFffKEhCK.jpg"/></div></div></figure><div class=""/><p id="6d85" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">解决方案工程师| <a class="ae jo" href="https://www.sendbird.com/" rel="noopener ugc nofollow" target="_blank"> Sendbird </a></p><p id="1779" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="jp">如果你正在寻找关于Swift、React等的教程，请查看我们的</em> <a class="ae jo" href="https://sendbird.com/developer/tutorials" rel="noopener ugc nofollow" target="_blank"> <em class="jp">开发者门户</em> </a> <strong class="is hu"> <em class="jp">。</em>T12】</strong></p><p id="6556" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="jp">您可能会发现查看Android聊天示例应用程序的</em> <a class="ae jo" href="https://github.com/sendbird/SendBird-Android" rel="noopener ugc nofollow" target="_blank"> <em class="jp">代码</em> </a> <em class="jp">很有用。如需更多指导，请查看我们的</em> <a class="ae jo" href="https://sendbird.com/docs/chat/v3/android/quickstart/send-first-message" rel="noopener ugc nofollow" target="_blank"> <em class="jp">文档</em> </a> <em class="jp">。记住一个应用内聊天的</em> <a class="ae jo" href="https://sendbird.com/demos/in-app-chat" rel="noopener ugc nofollow" target="_blank"> <em class="jp">演示</em> </a> <em class="jp">可能也会有用。更多信息，请查看我们的</em> <a class="ae jo" href="https://sendbird.com/features/chat-messaging" rel="noopener ugc nofollow" target="_blank"> <em class="jp">聊天页面</em> </a> <em class="jp">。</em></p><h1 id="4439" class="jq jr ht bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">介绍</h1><p id="d111" class="pw-post-body-paragraph iq ir ht is b it ko iv iw ix kp iz ja jb kq jd je jf kr jh ji jj ks jl jm jn hb bi translated">本教程是使用<a class="ae jo" href="https://docs.sendbird.com/android/quick_start" rel="noopener ugc nofollow" target="_blank"><strong class="is hu">send bird Chat SDK</strong></a>构建聊天应用的一个简单易懂的Kotlin实现指南。完整的教程包括两部分。完成后，你就可以用Kotlin创建自己的聊天应用程序了。</p><p id="258a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在第一部分中，我们将回顾初始化和登录，以及频道的显示、选择和创建。Sendbird有两种频道类型:开放频道和群组频道。本指南重点介绍了创建一对一私人聊天和私人群组聊天的群组渠道实施。</p><p id="6299" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们将创建三个活动:</p><ul class=""><li id="2a71" class="kt ku ht is b it iu ix iy jb kv jf kw jj kx jn ky kz la lb bi translated"><strong class="is hu">登录活动</strong> —用户登录和设置昵称的基本登录界面</li><li id="1708" class="kt ku ht is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated"><strong class="is hu">channelistactivity</strong>—显示用户可以加入的群组频道的频道列表</li><li id="795a" class="kt ku ht is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated"><strong class="is hu">频道创建活动</strong> —允许用户邀请其他用户并创建频道的屏幕</li></ul><p id="690d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然后，我们将介绍以下步骤:</p><ul class=""><li id="554a" class="kt ku ht is b it iu ix iy jb kv jf kw jj kx jn ky kz la lb bi translated">导入依赖项并添加权限</li><li id="f6ac" class="kt ku ht is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">登录活动，包括:</li></ul><ol class=""><li id="37b7" class="kt ku ht is b it iu ix iy jb kv jf kw jj kx jn lh kz la lb bi translated">创建基本登录用户界面</li><li id="2e87" class="kt ku ht is b it lc ix ld jb le jf lf jj lg jn lh kz la lb bi translated">创建<strong class="is hu">逻辑活动</strong></li></ol><ul class=""><li id="e6ee" class="kt ku ht is b it iu ix iy jb kv jf kw jj kx jn ky kz la lb bi translated">显示频道列表，包括:</li></ul><ol class=""><li id="1aa9" class="kt ku ht is b it iu ix iy jb kv jf kw jj kx jn lh kz la lb bi translated">创建频道列表用户界面</li><li id="0366" class="kt ku ht is b it lc ix ld jb le jf lf jj lg jn lh kz la lb bi translated">创建<strong class="is hu">通道活动</strong></li><li id="b287" class="kt ku ht is b it lc ix ld jb le jf lf jj lg jn lh kz la lb bi translated">为<strong class="is hu">回收视图</strong>创建<strong class="is hu">通道适配器</strong></li></ol><ul class=""><li id="9757" class="kt ku ht is b it iu ix iy jb kv jf kw jj kx jn ky kz la lb bi translated">创建渠道，包括:</li></ul><ol class=""><li id="fd6f" class="kt ku ht is b it iu ix iy jb kv jf kw jj kx jn lh kz la lb bi translated">实现一个<strong class="is hu">通道创建</strong>用户界面</li><li id="3ced" class="kt ku ht is b it lc ix ld jb le jf lf jj lg jn lh kz la lb bi translated">实现<strong class="is hu">通道创建活动</strong></li><li id="4a70" class="kt ku ht is b it lc ix ld jb le jf lf jj lg jn lh kz la lb bi translated">为<strong class="is hu">回收视图</strong>实现<strong class="is hu">通道创建适配器</strong></li></ol><p id="7006" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">请注意，本教程假设您对Kotlin有基本的了解。</p><p id="fc57" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们开始吧！</p><h1 id="b9d7" class="jq jr ht bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">第一步。导入依赖项并添加权限</h1><p id="38a7" class="pw-post-body-paragraph iq ir ht is b it ko iv iw ix kp iz ja jb kq jd je jf kr jh ji jj ks jl jm jn hb bi translated">首先，将最新的Sendbird SDK添加到应用程序级别的build.gradle文件中。</p><figure class="li lj lk ll fd hk"><div class="bz dy l di"><div class="lm ln l"/></div></figure><h1 id="07c1" class="jq jr ht bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">第二步。登录活动</h1><p id="aa6f" class="pw-post-body-paragraph iq ir ht is b it ko iv iw ix kp iz ja jb kq jd je jf kr jh ji jj ks jl jm jn hb bi translated">要开始聊天，用户必须能够登录或创建一个用户。</p><p id="1df7" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">本节包括两个部分，包括如何:</p><ol class=""><li id="5842" class="kt ku ht is b it iu ix iy jb kv jf kw jj kx jn lh kz la lb bi translated">用您各自的AppID初始化Sendbird应用程序</li><li id="ba4f" class="kt ku ht is b it lc ix ld jb le jf lf jj lg jn lh kz la lb bi translated">用用户名和昵称连接到Sendbird</li></ol><p id="5b9f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">但是首先，我们需要创建一个基本的登录UI。</p><ul class=""><li id="edb5" class="kt ku ht is b it iu ix iy jb kv jf kw jj kx jn ky kz la lb bi translated">基本的登录UI包括一个用于用户ID的编辑文本字段、一个用于所需昵称的字段和一个用于连接的按钮。见下图。</li></ul><figure class="li lj lk ll fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lo"><img src="../Images/15ad8019528c09736df49643ba4650e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*qGzvz3a9dXdPeKMf.png"/></div></div></figure><p id="be3d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您可以在此查看完整代码:</p><p id="b9b1" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu"> activity_login.xml </strong></p><figure class="li lj lk ll fd hk"><div class="bz dy l di"><div class="lm ln l"/></div></figure><p id="a02e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu">创建</strong> <strong class="is hu">逻辑活动</strong></p><p id="6061" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">创建一个名为<strong class="is hu"> LoginActivity.kt </strong>的新活动。请务必在清单中注册此活动。这个活动负责初始化和处理到Sendbird应用程序的连接。</p><p id="c14a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">理想情况下，您会选择将初始化放在不同的活动中。为了简单起见，我们将在LoginActivity中初始化。</p><p id="9119" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">添加一个<strong class="is hu"> onCreate </strong>方法。该方法处理UI元素和初始化过程。</p><p id="4980" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu">loginactivity . kt</strong>中的onCreate 方法</p><figure class="li lj lk ll fd hk"><div class="bz dy l di"><div class="lm ln l"/></div></figure><p id="908a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">方法<strong class="is hu"> connectToSendBird() </strong>将传递的UserID连接到SendBird，然后更新连接用户的昵称。完成后，它启动我们的<strong class="is hu">渠道活动</strong>。</p><p id="13da" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu"> LoginActivity.kt </strong>中的<strong class="is hu"> connectToSendBird() </strong>方法</p><figure class="li lj lk ll fd hk"><div class="bz dy l di"><div class="lm ln l"/></div></figure><p id="93bf" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu"> LoginActivity.kt </strong>的完整内容见以下要点。</p><figure class="li lj lk ll fd hk"><div class="bz dy l di"><div class="lm ln l"/></div></figure><h1 id="a45b" class="jq jr ht bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">第三步。显示频道列表</h1><p id="5a56" class="pw-post-body-paragraph iq ir ht is b it ko iv iw ix kp iz ja jb kq jd je jf kr jh ji jj ks jl jm jn hb bi translated">创建登录后，创建一个活动来显示、选择和创建频道。下面向您展示如何查询与用户相关的频道列表，并在<strong class="is hu"> RecyclerView </strong>中渲染和显示它们。</p><p id="3348" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">创建频道列表用户界面</p><p id="4b06" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为频道列表<strong class="is hu"> RecyclerView </strong>创建一个基本项目。为了简单起见，我们将创建一个<strong class="is hu"> CardView </strong>和<strong class="is hu"> TextViews </strong>用于频道名称、成员计数和最近的消息。</p><p id="ad0c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu">item _ channel _ chooser . XML</strong></p><figure class="li lj lk ll fd hk"><div class="bz dy l di"><div class="lm ln l"/></div></figure><p id="0419" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然后，为频道列表创建一个包含<strong class="is hu"> RecyclerView </strong>的实际视图。该视图还包含一个<strong class="is hu">浮动操作按钮</strong>，使用户能够创建频道。</p><p id="f3f4" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu"> activity_channel.xml </strong></p><figure class="li lj lk ll fd hk"><div class="bz dy l di"><div class="lm ln l"/></div></figure><p id="6242" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">创建<strong class="is hu">通道活动</strong></p><p id="9004" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">接下来，创建一个名为<strong class="is hu">channelistactivity</strong>的新活动。确保<strong class="is hu">在清单中登记此活动</strong>。该活动负责向<strong class="is hu"> RecyclerView </strong>添加通道，在用户创建新通道时处理UI交互，并使用所选通道启动下一个活动。</p><p id="f85e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu"> onCreate </strong>方法设置布局，设置<strong class="is hu"> RecyclerView </strong>，并为启动<strong class="is hu"> ChannelCreateActivity </strong>的<strong class="is hu"> FloatingActionButton </strong>包含<strong class="is hu"> onClickListener </strong>。</p><p id="853a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu"> onCreate() </strong>方法在<strong class="is hu">channelistactivity . kt</strong>中</p><figure class="li lj lk ll fd hk"><div class="bz dy l di"><div class="lm ln l"/></div></figure><p id="d7dd" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">onCreate 方法调用了一个方法<strong class="is hu"> addChannels() </strong>。此方法创建检索指定范围的频道的查询。通过检查<strong class="is hu">检索更多频道。hasNext() </strong>在查询对象上调用。结果返回后，可以将通道添加到适配器中。</p><p id="39c0" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu"> addChannels() </strong>方法在<strong class="is hu">channelistactivity . kt</strong>中</p><figure class="li lj lk ll fd hk"><div class="bz dy l di"><div class="lm ln l"/></div></figure><p id="67d1" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu"> onItemClicked() </strong>方法覆盖了您将在适配器中实现的接口的方法调用。它允许您在单个视图上设置点击监听器。在这个方法中，您需要创建一个意图来启动channel.URL的<strong class="is hu"> ChannelActivity </strong>。本指南的第二部分将介绍<strong class="is hu"> ChannelActivity </strong>的创建以及处理启动<strong class="is hu"> ChannelActivity </strong>的意图。</p><p id="076c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu">onItemClicked<strong class="is hu">channelistactivity . kt</strong>中的</strong></p><figure class="li lj lk ll fd hk"><div class="bz dy l di"><div class="lm ln l"/></div></figure><p id="855d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">要查看该类的完整实现，请参见下面的要点:</p><figure class="li lj lk ll fd hk"><div class="bz dy l di"><div class="lm ln l"/></div></figure><p id="9ae9" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为<strong class="is hu">回收视图</strong>创建<strong class="is hu">通道适配器</strong></p><p id="777d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">创建一个适配器，用返回的频道列表填充<strong class="is hu">回收视图</strong>。这个适配器填充视图，并向每个视图添加一个<strong class="is hu"> onClickListener </strong>，为相应的通道启动聊天活动。</p><p id="9da3" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">该指南将该课程分为两部分:</p><ol class=""><li id="c1a3" class="kt ku ht is b it iu ix iy jb kv jf kw jj kx jn lh kz la lb bi translated">用于<strong class="is hu">回收视图</strong>的适配器<strong class="is hu">信道适配器</strong>的标准实现</li><li id="672f" class="kt ku ht is b it lc ix ld jb le jf lf jj lg jn lh kz la lb bi translated">一个内部类，<strong class="is hu"> ChannelHolder </strong>，它实现了<strong class="is hu">viewcholder</strong>模式</li></ol><p id="ac7f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">参见第一部分的以下要点，即使用返回的频道列表填充<strong class="is hu"> RecyclerView </strong>的适配器</p><p id="b27e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu">通道适配器</strong>:</p><figure class="li lj lk ll fd hk"><div class="bz dy l di"><div class="lm ln l"/></div></figure><p id="28bc" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这个类的第二部分涉及一个实现视图持有者模式的内部类。这将数据绑定到相应的视图。在<strong class="is hu"> bindViews </strong>方法中，可以看到我们传递了一个<strong class="is hu"> groupChannel </strong>对象和一个<strong class="is hu"> OnChannelClickedListener </strong>。这两个对象建立了视图。确保将<strong class="is hu"> itemView </strong>上的<strong class="is hu"> onClickListener </strong>设置为在<strong class="is hu"> bindViews </strong>方法中传递的监听器。</p><p id="fd9b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu">通道适配器</strong>中的通道座:</p><figure class="li lj lk ll fd hk"><div class="bz dy l di"><div class="lm ln l"/></div></figure><p id="7e26" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">参见下面要点中的<strong class="is hu">channelistadapter . kt</strong>的完整实现:</p><figure class="li lj lk ll fd hk"><div class="bz dy l di"><div class="lm ln l"/></div></figure><h1 id="43e9" class="jq jr ht bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">第四步。创建频道</h1><p id="8408" class="pw-post-body-paragraph iq ir ht is b it ko iv iw ix kp iz ja jb kq jd je jf kr jh ji jj ks jl jm jn hb bi translated">本节介绍如何查询用户列表、显示这些用户以及使用该用户列表创建频道。</p><p id="b741" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">实现频道创建用户界面</p><p id="6c0d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">像以前一样，创建一个带有<strong class="is hu"> RecyclerView </strong>和一个简单按钮的布局。</p><p id="d268" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu"> Activity_create.xml </strong></p><figure class="li lj lk ll fd hk"><div class="bz dy l di"><div class="lm ln l"/></div></figure><p id="8dc4" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">创建一个包含用户内容的项目。为此，创建一个包含一个<strong class="is hu">复选框</strong>和一个<strong class="is hu">文本视图</strong>的简单布局。</p><p id="d7bb" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu"> Item_create.xml </strong></p><figure class="li lj lk ll fd hk"><div class="bz dy l di"><div class="lm ln l"/></div></figure><p id="f639" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">创建另一个活动，并将其命名为<strong class="is hu"> ChannelCreateActivity </strong>。确保在清单中注册此活动。该活动加载用户列表，设置UI元素和<strong class="is hu">recycle view</strong>适配器，并处理通道的创建。</p><p id="ca96" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu"> onCreate </strong>方法设置必要的组件。在<strong class="is hu"> ChannelCreateActivity </strong>的完整代码中，初始化一个名为<strong class="is hu"> selectedUsers </strong>的全局变量，这个变量将是你创建通道时传递的用户列表。设置您的<strong class="is hu">回收视图</strong>和适配器。调用之后，请参见下面实现的方法<strong class="is hu"> loadUsers() </strong>。最后，设置一个<strong class="is hu"> onClickListener </strong>用于用户选择创建频道的时候。</p><p id="59b9" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu">channelcreateactivity . kt中的onCreate()</strong></p><figure class="li lj lk ll fd hk"><div class="bz dy l di"><div class="lm ln l"/></div></figure><p id="8362" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，实现<strong class="is hu"> loadUsers() </strong>方法。该示例使用默认的通用查询来获取应用程序的用户。与频道查询一样，可以通过在<strong class="is hu">用户列表查询</strong>上设置某些变量来定制返回的内容。当查询返回时，将返回的用户添加到适配器中。</p><p id="456c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu">channelcreateactivity . kt</strong>中的loadUsers()</p><figure class="li lj lk ll fd hk"><div class="bz dy l di"><div class="lm ln l"/></div></figure><p id="0806" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">像前面一样，向我们的适配器类添加一个接口，以处理对<strong class="is hu"> RecyclerView </strong>中的单个项目的操作。这个接口将有一个方法，<strong class="is hu"> onItemChecked() </strong>，实现如下。它指示用户是否已被检查，并相应地更新<strong class="is hu">选择的用户</strong>列表。</p><p id="26e1" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu"> ChannelCreateActivity.kt </strong>中的<strong class="is hu"> onItemChecked() </strong></p><figure class="li lj lk ll fd hk"><div class="bz dy l di"><div class="lm ln l"/></div></figure><p id="efe0" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最后，实现<strong class="is hu"> createChannel() </strong>方法。顾名思义，这个方法使用传递的用户创建通道。在Sendbird中创建频道时，可以自由定制频道。通过创建params val，您可以添加用户、添加操作员(管理员)、设置通道名称等等。指定可选参数后，使用传递的参数创建组通道。一旦它返回，创建一个意图来启动<strong class="is hu"> ChannelActivity </strong>，并将频道URL作为“额外”内容。</p><p id="093c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu">channelcreateactivity . kt</strong>中的<strong class="is hu"> createChannel() </strong></p><figure class="li lj lk ll fd hk"><div class="bz dy l di"><div class="lm ln l"/></div></figure><p id="9141" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下面是<strong class="is hu"> ChannelCreateActivity </strong>的完整实现。</p><p id="6b1e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu">channelcreateactivity . kt</strong></p><figure class="li lj lk ll fd hk"><div class="bz dy l di"><div class="lm ln l"/></div></figure><p id="5583" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为<strong class="is hu">回收视图</strong>实现<strong class="is hu">通道创建适配器</strong></p><p id="f917" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最后要实现的是我们的<strong class="is hu"> RecyclerView </strong>的定制适配器。</p><p id="d6c1" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如前所述，本指南将其分为两个部分:</p><ol class=""><li id="a33a" class="kt ku ht is b it iu ix iy jb kv jf kw jj kx jn lh kz la lb bi translated">用于<strong class="is hu">回收视图</strong>的适配器<strong class="is hu"> ChannelCreateAdapter </strong>的标准实现</li><li id="00c3" class="kt ku ht is b it lc ix ld jb le jf lf jj lg jn lh kz la lb bi translated">一个内部类<strong class="is hu"> UserHolder </strong>，它实现了<strong class="is hu"> ViewHolder </strong>模式</li></ol><p id="d210" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu"> ChannelCreateAdapter </strong>部分涵盖了适配器实现的基本方法。这需要一个接口来处理项目何时被选中，以及一个<strong class="is hu">sparsebooleanaray()</strong>来处理用户何时被选中/取消选中。除了这两个要求，遵循实现所需方法的标准方法。</p><p id="8517" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu">通道创建适配器</strong></p><figure class="li lj lk ll fd hk"><div class="bz dy l di"><div class="lm ln l"/></div></figure><p id="46e8" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">创建一个扩展<strong class="is hu">recycle view</strong>的内部类。<strong class="is hu">取景器</strong>。这个类绑定了来自<strong class="is hu"> item_create.xml </strong>的视图。它还将负责检查和取消检查<strong class="is hu">复选框</strong>，并分别更新用户列表。</p><p id="0d18" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu">用户持有者</strong></p><figure class="li lj lk ll fd hk"><div class="bz dy l di"><div class="lm ln l"/></div></figure><p id="445b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">有关<strong class="is hu">channelcreateadapter . kt</strong>的完整实现，请参见以下要点</p><figure class="li lj lk ll fd hk"><div class="bz dy l di"><div class="lm ln l"/></div></figure><h1 id="7e9e" class="jq jr ht bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">结论</h1><p id="d328" class="pw-post-body-paragraph iq ir ht is b it ko iv iw ix kp iz ja jb kq jd je jf kr jh ji jj ks jl jm jn hb bi translated">使用Kotlin创建自己的聊天应用程序的工作已经完成了一半！</p><p id="2cbb" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在Kotlin实施指南的第一部分中，我们介绍了如何:</p><ul class=""><li id="c715" class="kt ku ht is b it iu ix iy jb kv jf kw jj kx jn ky kz la lb bi translated">导入依赖项并添加权限</li><li id="043f" class="kt ku ht is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">创建<strong class="is hu">登录活动</strong>和一个基本的登录UI</li><li id="600a" class="kt ku ht is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">为<strong class="is hu"> RecyclerView </strong>创建<strong class="is hu">频道活动</strong>、<strong class="is hu">频道适配器</strong>和一个频道列表UI</li><li id="94ee" class="kt ku ht is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated">实现<strong class="is hu"> ChannelCreateActivity </strong>，<strong class="is hu"> ChannelCreateAdapter </strong>用于<strong class="is hu"> RecyclerView </strong>，以及一个通道创建UI</li></ul><p id="4aac" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您现在可以查看Kotlin指南的<a class="ae jo" href="https://sendbird.com/developer/tutorials/kotlin-chat-tutorial-part-2" rel="noopener ugc nofollow" target="_blank"> <strong class="is hu">第二部分</strong> </a>！在第2部分中，您将通过添加聊天UI并使用户能够发送和接收消息来完成您自己的聊天应用程序。如有疑问，记得查看我们的<a class="ae jo" href="https://community.sendbird.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="is hu">社区网站</strong> </a>并咨询我们的<a class="ae jo" href="https://sendbird.com/docs/chat/v3/android/getting-started/about-chat-sdk" rel="noopener ugc nofollow" target="_blank"> <strong class="is hu">文档</strong> </a>。</p><p id="b670" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">你正在创建一个吸引人的Android移动应用程序。坚持下去，快乐手机聊天建设！</p></div></div>    
</body>
</html>