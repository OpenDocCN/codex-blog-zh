<html>
<head>
<title>Media Mix Modeling With Scikit-Learn</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Scikit-Learn进行媒体混合建模</h1>
<blockquote>原文：<a href="https://medium.com/codex/simple-to-advanced-media-mix-modeling-d86764e2afdb?source=collection_archive---------5-----------------------#2022-10-13">https://medium.com/codex/simple-to-advanced-media-mix-modeling-d86764e2afdb?source=collection_archive---------5-----------------------#2022-10-13</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="5c91" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">媒体组合建模是一种分析技术，用于理解和量化广告对其预期目标(通常是促销产品的销售)的影响。</p><p id="bc6d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">本文将介绍媒体混合建模的原则，并用scikit-learn演示各种建模技术，从一个非常简单的方法开始，逐步提高模型的复杂性。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/bb104cd4538978c20e24bcdb47e67d75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*YhV4ZvYty_B3mAch"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">约书亚·厄尔在<a class="ae jt" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><blockquote class="ju jv jw"><p id="55d3" class="if ig jx ih b ii ij ik il im in io ip jy ir is it jz iv iw ix ka iz ja jb jc hb bi translated">“我一半的广告支出都浪费了；麻烦的是，我不知道是哪一半。”<em class="hi"> 1900 - </em> <strong class="ih hj"> <em class="hi">约翰·沃纳梅克</em> </strong> <em class="hi">，零售业巨头&amp;广告业先驱</em></p></blockquote><p id="0aa5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">约翰·沃纳梅克在数字营销时代为广告商提供了对广告影响的新见解之前写下了这些文字。他在印刷品和黑白电视上做广告。虽然从脸书到你的网站跟踪点击远比衡量一个全国性电视广告的影响更直接，但最后点击的衡量并没有结束我们的对话，也没有结束我们对什么才是真正影响广告的困惑。</p><p id="0093" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">问10个营销人员他们喜欢的归因技巧，你会得到10个不同的答案。这种分歧源自一些基本问题，这些问题在今天的市场营销人员的头脑中扮演着重要角色，就像他们在约翰·沃纳梅克的头脑中扮演的角色一样。</p><ol class=""><li id="56e7" class="kb kc hi ih b ii ij im in iq kd iu ke iy kf jc kg kh ki kj bi translated">我如何将广告销售与即使没有广告也会发生的销售分开？</li><li id="da0b" class="kb kc hi ih b ii kk im kl iq km iu kn iy ko jc kg kh ki kj bi translated">同时在两个渠道投放广告的综合效果是什么，我如何将两者分开？</li><li id="0441" class="kb kc hi ih b ii kk im kl iq km iu kn iy ko jc kg kh ki kj bi translated">今天的广告如何影响明天或六个月后的销售？</li><li id="97af" class="kb kc hi ih b ii kk im kl iq km iu kn iy ko jc kg kh ki kj bi translated">如果我继续在这一渠道投资，回报会减少吗？</li></ol><h1 id="5afd" class="kp kq hi bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">为什么媒体混合建模？</h1><p id="67af" class="pw-post-body-paragraph if ig hi ih b ii ln ik il im lo io ip iq lp is it iu lq iw ix iy lr ja jb jc hb bi translated">广告商需要了解如何分配他们的营销预算，以最大限度地提高投资回报率(广告支出)。在一个预算有限、渠道众多的世界里，浪费50%的投资是不够的。智能媒体规划始于对广告渠道的投资回报率的预测。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ls"><img src="../Images/6468b6eccf114f75cd15f93e23e5cefb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wv6SaM9YYj86sG0ML0N3lQ.png"/></div></div></figure><p id="0832" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">媒体组合建模使用来自广告商的历史数据来绘制花费(X)和销售(y)之间的联系。这些联系不仅有助于阐明过去投资的投资回报率，还能释放优化未来媒体计划的能力。</p><p id="d22a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">把你自己放在一家手机配件公司的CMO椅子上。在过去几年中，贵公司在三个渠道投放了广告；电视、广播和网络。您有一款新产品在年底发布，您想知道过去哪些广告渠道发挥了作用，这样您就可以为产品发布活动创建最佳的媒体组合。</p><p id="79ce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你会使用什么技巧？如果谈论X和y之间的联系使你想到线性回归，那么直觉上你是正确的。我们稍后会看到，广告支出和销售之间的关系不是一条简单的直线，但一般来说，随着广告支出的增加，销售也会增加，所以线性回归是一个很好的起点。</p><p id="e93c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用线性回归，媒体组合模型寻找两件事…</p><p id="8d93" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个模型的系数告诉我们在给定渠道上调整支出对销售的影响程度。* </p><p id="436f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">将一个渠道对销售的影响从销售和其他营销的基线中分离出来，可以让我们找到该渠道的投资回报率。</strong></p><p id="13be" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jx">*一切平等</em></p><h1 id="01bb" class="kp kq hi bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">简单媒体混合模型</h1><h2 id="5262" class="lt kq hi bd kr lu lv lw kv lx ly lz kz iq ma mb ld iu mc md lh iy me mf ll mg bi translated">使用scikit-learn中的线性回归</h2><p id="5209" class="pw-post-body-paragraph if ig hi ih b ii ln ik il im lo io ip iq lp is it iu lq iw ix iy lr ja jb jc hb bi translated">线性回归是揭示广告支出和销售之间隐藏联系的最简单的技术。我们从罗伯特·库伯勒博士提供的一个样本数据集开始，他对我理解这个话题做出了重大贡献。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mh"><img src="../Images/28c348487f1834440be66a30695d0702.png" data-original-src="https://miro.medium.com/v2/resize:fit:922/format:webp/1*NDyvmbeVjQQLW25pT6dBDA.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">数据:<a class="ae jt" href="https://raw.githubusercontent.com/Garve/datasets/4576d323bf2b66c906d5130d686245ad205505cf/mmm.csv" rel="noopener ugc nofollow" target="_blank">https://raw . githubusercontent . com/Garve/datasets/4576d 323 bf2 b 66 c 906d 5130d 686245 ad 205505 cf/mmm . CSV</a></figcaption></figure><p id="5e60" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在数据集(<a class="ae jt" href="https://github.com/Garve/datasets/blob/4576d323bf2b66c906d5130d686245ad205505cf/mmm.csv" rel="noopener ugc nofollow" target="_blank">此处可用</a>)中，我们可以看到在200周的过程中，每周对三个广告渠道的历史投资。这些将是我们在线性回归模型中的特征。</p><ol class=""><li id="e98a" class="kb kc hi ih b ii ij im in iq kd iu ke iy kf jc kg kh ki kj bi translated"><strong class="ih hj">电视</strong></li><li id="b536" class="kb kc hi ih b ii kk im kl iq km iu kn iy ko jc kg kh ki kj bi translated"><strong class="ih hj">收音机</strong></li><li id="55cb" class="kb kc hi ih b ii kk im kl iq km iu kn iy ko jc kg kh ki kj bi translated"><strong class="ih hj">在线横幅</strong></li></ol><p id="3c11" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们还有一个列代表我们的目标变量，<strong class="ih hj">产品销售额。</strong></p><h2 id="7192" class="lt kq hi bd kr lu lv lw kv lx ly lz kz iq ma mb ld iu mc md lh iy me mf ll mg bi translated">创建我们的功能和目标</h2><p id="6036" class="pw-post-body-paragraph if ig hi ih b ii ln ik il im lo io ip iq lp is it iu lq iw ix iy lr ja jb jc hb bi translated">将你的数据分成X(消费特征)和y(产品销售)</p><pre class="je jf jg jh fd mi mj mk ml aw mm bi"><span id="ce4c" class="lt kq hi mj b fi mn mo l mp mq">from sklearn.linear_model import LinearRegression<br/>from sklearn.model_selection import cross_val_score, TimeSeriesSplit<br/>import pandas as pd</span><span id="072f" class="lt kq hi mj b fi mr mo l mp mq">data = pd.read_csv(<br/>    '<a class="ae jt" href="https://raw.githubusercontent.com/Garve/datasets/4576d323bf2b66c906d5130d686245ad205505cf/mmm.csv'" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/Garve/datasets/4576d323bf2b66c906d5130d686245ad205505cf/mmm.csv'</a>,<br/>    parse_dates=['Date'],<br/>    index_col='Date'<br/>)<br/>X = data.drop(columns=['Sales'])<br/>y = data['Sales']</span></pre><h2 id="7750" class="lt kq hi bd kr lu lv lw kv lx ly lz kz iq ma mb ld iu mc md lh iy me mf ll mg bi translated">建立和评估线性回归</h2><pre class="je jf jg jh fd mi mj mk ml aw mm bi"><span id="707b" class="lt kq hi mj b fi mn mo l mp mq">lr = LinearRegression()<br/>print(f'cross val scores {cross_val_score(lr, X, y, cv=TimeSeriesSplit())}')<br/>print(f'mean cross val score {np.mean(cross_val_score(lr, X, y, cv=TimeSeriesSplit()))}')</span><span id="bd43" class="lt kq hi mj b fi mr mo l mp mq"><strong class="mj hj"># Output: <br/>cross val scores [0.69594303 0.69302285 0.66850729 0.78807363 0.73512387]<br/>mean cross val score 0.716134134746767</strong></span></pre><p id="0d9e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们的简单线性回归在预测销售额方面做得不错(R2 = 0.7)。让我们解开模型的属性以获得系数和基线，知道我们的模型使用以下公式进行预测。</p><p id="ac98" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> Sales = coef_tv(电视)+ coef_radio(广播)+ coef_radio(横幅)+ Base </strong></p><p id="d930" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先是系数。这些数据告诉我们，给定渠道中增加的支出会对销售额产生多大影响。你可以看到，在同等条件下，条幅对销售的影响最大。</p><pre class="je jf jg jh fd mi mj mk ml aw mm bi"><span id="5132" class="lt kq hi mj b fi mn mo l mp mq">#Return coeficients for each type of marketing spend<br/>lr_coef_table = pd.DataFrame(lr.coef_.flatten())<br/>lr_coef_table.index = list(X.columns)<br/>lr_coef_table = lr_coef_table.rename(columns={0:"Coef"})<br/>lr_coef_table</span><span id="e40d" class="lt kq hi mj b fi mr mo l mp mq"><strong class="mj hj"># Output:<br/></strong><br/><strong class="mj hj">TV 0.348643<br/>Radio 0.459996<br/>Banners 1.206171</strong></span></pre><p id="56c3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，y截距，我们营销组合模型中的基线。这就是我们不打广告也能期待的持续销售。你可以看到我们的模型在6678美元处与y轴相交。这是我们产品的销售底线。</p><pre class="je jf jg jh fd mi mj mk ml aw mm bi"><span id="112c" class="lt kq hi mj b fi mn mo l mp mq">#Return the y intercept</span><span id="94ed" class="lt kq hi mj b fi mr mo l mp mq">baseline = lr.intercept_<br/>baseline</span><span id="b49f" class="lt kq hi mj b fi mr mo l mp mq"><strong class="mj hj"># Output:<br/></strong>6678.396933606161</span><span id="2645" class="lt kq hi mj b fi mr mo l mp mq">#Save a total spend df<br/>total_spend = X.copy()<br/>total_spend["Spend Total"] = total_spend["TV"] + total_spend["Radio"] +total_spend["Banners"]<br/>total_spend = total_spend[["Spend Total"]]</span><span id="763a" class="lt kq hi mj b fi mr mo l mp mq">#Plot our model's performance<br/>fig, ax = plt.subplots(figsize=(12, 6))<br/>ax.scatter(total_spend, y,color="black")<br/>ax.plot(total_spend, lr.predict(X), color="blue", linewidth=3)<br/>ax.set_xlabel("Marketing Spend")<br/>ax.set_ylabel("Sales")<br/>ax.legend(["Predicted","Actual"])<br/>ax.set_title("Simiple LR Marketing Mix Model")</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ms"><img src="../Images/33751808b24a678eace9a72c04ca4aa4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EpwVFGkXywsn-f4DuCm2Ew.png"/></div></div></figure><p id="500a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我们进入ROI分析之前，让我们看看是否可以改进我们模型的性能。</p><p id="4cd4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">简单媒体混合模型R2: 0.71 </p><h1 id="5c2a" class="kp kq hi bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">调整后的简单媒体组合模型</h1><h2 id="3adc" class="lt kq hi bd kr lu lv lw kv lx ly lz kz iq ma mb ld iu mc md lh iy me mf ll mg bi translated">使用scikit的线性回归-学习和手动调整</h2><p id="ad87" class="pw-post-body-paragraph if ig hi ih b ii ln ik il im lo io ip iq lp is it iu lq iw ix iy lr ja jb jc hb bi translated">这种手动调整的思想是理解模型的偏差并针对它进行调整。为了理解我们的模型是如何产生偏差的，让我们先来看一周的样本，看看我们的模型表现如何。</p><pre class="je jf jg jh fd mi mj mk ml aw mm bi"><span id="8f82" class="lt kq hi mj b fi mn mo l mp mq">#Test our lr on a single week of spend data<br/>test_week_spend = data.loc["2021-10-10"][0:3].values</span><span id="b279" class="lt kq hi mj b fi mr mo l mp mq">#Use sample week spend data to predict sales<br/>spend_test_prediction = lr.predict(([test_week_spend]))[0]</span><span id="dbdb" class="lt kq hi mj b fi mr mo l mp mq">#Now use our lr to attempt a prediction using this selected week's spend figure and our lr's coeficients<br/>print(f'lr sales prediction {spend_test_prediction}')<br/>print(f'Actual sales {data.loc["2021-10-10"][3]}')<br/>print(f'Delta {spend_test_prediction-data.loc["2021-10-10"][3]}')</span><span id="d852" class="lt kq hi mj b fi mr mo l mp mq">#Find a correlation factor using truth and predictions<br/>correl_factor = data.loc["2021-10-10"][3]/spend_test_prediction<br/>print(f'Correlation factor {correl_factor}')</span><span id="91ac" class="lt kq hi mj b fi mr mo l mp mq"><strong class="mj hj"><br/># Output:</strong></span><span id="2d63" class="lt kq hi mj b fi mr mo l mp mq"><strong class="mj hj">lr sales prediction 15992.602810755861<br/>Actual sales 15904.11<br/>Delta 88.49281075586077<br/>Correlation factor 0.9944666411213349</strong></span></pre><p id="ce6d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">相关系数=(实际销售额/预测销售额)</strong></p><p id="37c2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">销售额=相关系数(coef_tv(电视)+ coef_radio(电台)+ coef_radio(横幅)+ Base) </strong></p><p id="65a2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们对单周销售的预测相差88美元，相关系数为0.99。为了调整我们的模型的偏差，我们简单地将我们的相关因子应用于我们对数据集的每一周所做的预测。</p><p id="579a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果我们对整个数据集执行这种调整，我们将返回一个完美的R2分数，这是不现实的，因为在实践中，我们需要将这种模型应用于看不见的数据。</p><p id="572a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们首先将我们的数据分成训练组和测试组，然后在看不见的测试组上评估调整后的模型。</p><pre class="je jf jg jh fd mi mj mk ml aw mm bi"><span id="125b" class="lt kq hi mj b fi mn mo l mp mq">#Split our data into 2/3 for training and 1/3 for eval<br/>from sklearn.model_selection import train_test_split<br/>X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.33, random_state=42)<br/>lr = LinearRegression()<br/>lr.fit(X_train,y_train)</span></pre><p id="a4bd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，我们将使用训练集中的支出数据和模型的相应系数(权重)构建一组未经调整的预测。</p><pre class="je jf jg jh fd mi mj mk ml aw mm bi"><span id="3934" class="lt kq hi mj b fi mn mo l mp mq">#unadjusted_sales_predictions = weights * spend<br/>weights = pd.Series(lr.coef_,index=X_train.columns)<br/>#Now on the x_test<br/>#Create a Dataframe that contains the product of weights and spend numbers, this will need to be adjusted by the correl factor<br/>unadj_contributions = X_test.copy()<br/>unadj_contributions["TV"] = unadj_contributions["TV"]*weights.TV<br/>unadj_contributions["Radio"] = unadj_contributions["Radio"]*weights.Radio<br/>unadj_contributions["Banners"] = unadj_contributions["Banners"]*weights.Banners<br/>unadj_contributions["Base"] = baseline</span></pre><p id="d221" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们根据来自训练数据的原始相关因子调整贡献，并返回调整后模型的R2。</p><pre class="je jf jg jh fd mi mj mk ml aw mm bi"><span id="dd05" class="lt kq hi mj b fi mn mo l mp mq">adjusted_contributions = unadj_contributions.mul(correl_factor,axis=0)<br/>adjusted_contributions["Total Predicted Spend"] =  adjusted_contributions.sum(axis=1)</span><span id="8a57" class="lt kq hi mj b fi mr mo l mp mq">print(f'adjusted R2 {r2_score(y_true=y_test,y_pred=adjusted_contributions["Total Predicted Spend"])}')</span><span id="3121" class="lt kq hi mj b fi mr mo l mp mq"><strong class="mj hj"># Output:</strong></span><span id="ce8a" class="lt kq hi mj b fi mr mo l mp mq"><strong class="mj hj">adjusted R2 0.8232431652722243</strong></span></pre><p id="835e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们已经显著改进了我们的模型！让我们通过将我们的广告支出投资除以预测的销售回报来获得每个渠道的投资回报率。现在我们可以看到每个渠道的相对表现及其对销售的贡献。这是智能媒体规划的关键信息。</p><pre class="je jf jg jh fd mi mj mk ml aw mm bi"><span id="94bd" class="lt kq hi mj b fi mn mo l mp mq">roi = {'TV':[],'Radio':[],'Banners':[]}<br/>for channel in roi:<br/>    roi[channel] = adjusted_contributions[channel].sum()/data[channel].sum()<br/>roi</span><span id="2bea" class="lt kq hi mj b fi mr mo l mp mq"><strong class="mj hj"># Output:</strong></span><span id="5526" class="lt kq hi mj b fi mr mo l mp mq"><strong class="mj hj">{'TV': 0.11238120757362816,<br/> 'Radio': 0.14342429769462278,<br/> 'Banners': 0.42312870897586125}</strong></span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ls"><img src="../Images/6468b6eccf114f75cd15f93e23e5cefb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wv6SaM9YYj86sG0ML0N3lQ.png"/></div></div></figure><p id="8fc8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">调整后的简单媒体混合模型R2: 0.82 </strong></p><h1 id="a1e0" class="kp kq hi bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">高级媒体组合模型</h1><h2 id="7608" class="lt kq hi bd kr lu lv lw kv lx ly lz kz iq ma mb ld iu mc md lh iy me mf ll mg bi translated">使用scikit-learn &amp; feature engineering的线性回归</h2><p id="b15b" class="pw-post-body-paragraph if ig hi ih b ii ln ik il im lo io ip iq lp is it iu lq iw ix iy lr ja jb jc hb bi translated">在这一点上，我们需要认识到，我们简单的线性回归虽然相当准确，但却是不现实的。它没有考虑到广告的两个现实世界的影响。</p><p id="0ba1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">饱和效应</strong></p><p id="65e2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该模型假设广告支出和销售之间存在线性关系，但任何广告商都可以告诉你这不是真的。你花的越多，广告的效果就越差，因为市场已经饱和，它已经部分吸收了信息。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ms"><img src="../Images/d6d2f2d3e0ffdf27f10efa5f04106f74.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pkW4-zNYoYyKWiRpsqByBw.png"/></div></div></figure><p id="2ecd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">a =控制饱和曲线形状的超参数(a&gt;0)</p><p id="348e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">X =花费</p><p id="9f2a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">饱和效应= 1-exp(a*X)</p><p id="3d9a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">结转效应</strong></p><p id="bed2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们的简单模型假设广告对销售的全部影响在支出发生的同一周被吸收。营销人员明白，现实中存在一种光环效应，第一阶段的广告也会影响未来阶段的销售。遗留效应有两个变量，可分别视为垂直和水平移动。</p><p id="15e3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">强度</strong>(以前期间的支出有多少结转到未来期间)是有效支出的垂直变化。您可以在下图中看到，结转支出是周内支出的向上转移。</p><p id="c98b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">长度</strong>(今天的广告支出影响未来多少个时期)是有效支出的水平移动。您可以在下图中看到，结转支出是周内支出的右移。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ms"><img src="../Images/cb7725d9e6206da4125d1d3812067283.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vhz6NPdmKh3uBaXGkkWKwA.png"/></div></div></figure><p id="4fe3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要进一步了解在你的建模管道中添加饱和度和遗留效果的方法，请参见我的<a class="ae jt" href="https://github.com/zander1268/marketing-mix-modeling/blob/main/advanced_linear_regression.ipynb" rel="noopener ugc nofollow" target="_blank"> Jupyter笔记本</a>和Robert Kübler博士的文章<a class="ae jt" href="https://dr-robert-kuebler.medium.com/" rel="noopener">。</a></p><p id="84ff" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下一步是调整我们工程特征的超参数</p><p id="8387" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">饱和效应超参数</strong></p><ul class=""><li id="2e93" class="kb kc hi ih b ii ij im in iq kd iu ke iy kf jc mt kh ki kj bi translated">a =控制饱和曲线形状的超参数</li></ul><p id="15a8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">结转效应超参数</strong></p><ul class=""><li id="df65" class="kb kc hi ih b ii ij im in iq kd iu ke iy kf jc mt kh ki kj bi translated">力量</li><li id="05cb" class="kb kc hi ih b ii kk im kl iq km iu kn iy ko jc mt kh ki kj bi translated">长度</li></ul><p id="b5ef" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这可以通过<a class="ae jt" href="http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html" rel="noopener ugc nofollow" target="_blank"> scikit-learn网格搜索</a>来完成，或者通过<a class="ae jt" href="https://optuna.readthedocs.io/en/stable/reference/generated/optuna.integration.OptunaSearchCV.html" rel="noopener ugc nofollow" target="_blank"> Optuna </a>随机网格搜索来更有效地完成。Optuna将在一段时间的试验中随机选择超参数，直到它开始学习和测试更有希望的组合。</p><p id="13f9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最终结果是一个改进的模型，更好地反映了广告的现实。</p><p id="c980" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">高级媒体混合模型R2: 0.82 </strong></p><h1 id="9d90" class="kp kq hi bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">结论</h1><p id="2ff2" class="pw-post-body-paragraph if ig hi ih b ii ln ik il im lo io ip iq lp is it iu lq iw ix iy lr ja jb jc hb bi translated">更高级的模型能够更好地预测销售额，如下图所示。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ms"><img src="../Images/bad7fe6beaf79462a8d8dc6b741a18a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2cMrWpDZIfKEZPZPpFbbyw.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ms"><img src="../Images/33751808b24a678eace9a72c04ca4aa4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EpwVFGkXywsn-f4DuCm2Ew.png"/></div></div></figure><p id="6e99" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该模型的特征工程版本改进了先前模型对潜在假设的坚持，并使该模型对于使用看不见的数据更实用。该模型能够相当准确地预测销售额(0.82)，返回不同广告渠道投资的ROI计算结果，并将基线销售额与受广告影响的销售额隔离开来。</p><p id="45f8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我需要进一步研究的一个限制是，当谈到线性回归特性对目标的影响时，必须提供“所有其他条件相同”的警告。如果我们只能说一个渠道中的支出以这样一种方式影响销售,“在所有条件相同的情况下”,这削弱了我们的历史ROI分析，并限制了我们模型的预测能力。在广告业，事情很少是平等的。如果你的MMM模型建议将预算从一个渠道转移到另一个渠道，这将违反你用来指导决策的同一模型的假设，这一点尤其正确。</p><p id="bf07" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个模型的更高级版本将考虑额外的广告因素，如季节性和广告库存的相对成本。</p><p id="0a8e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">进一步的发展将考虑公司和产品因素，如产品价格和客户情绪。</p></div></div>    
</body>
</html>