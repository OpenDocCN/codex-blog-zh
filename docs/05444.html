<html>
<head>
<title>Introduction to Time Series Forecasting: Smoothing Methods</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">时间序列预测简介:平滑方法</h1>
<blockquote>原文：<a href="https://medium.com/codex/introduction-to-time-series-forecasting-smoothing-methods-9a904c00d0fd?source=collection_archive---------4-----------------------#2022-02-28">https://medium.com/codex/introduction-to-time-series-forecasting-smoothing-methods-9a904c00d0fd?source=collection_archive---------4-----------------------#2022-02-28</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="0147" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">时间序列的基本术语，预测的平滑方法和Python三重指数平滑的应用示例，超参数优化</h2></div><p id="88f7" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">嘿，我已经有一段时间没写信了。事实上，我错过了这个平台，但是我有借口为什么我不能写任何出版。我已经非常接近完成我的大学教育，并且在这几个星期里我在我的职业生涯中做了一些改变，我不能写。谢天谢地，现在我可以在^^.写我想要的东西了</p><p id="db13" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这个故事中，我们将讨论什么是时间序列预测，它的基本术语是什么，以及我们如何在Python中应用它们。我希望你喜欢并从这个故事中提取花絮。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es jt"><img src="../Images/4fff8cb131b7192d3b73b32f4ff2fd9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XgrEAQTunVFqZZVDOfkWgg.jpeg"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">凯文·Ku在<a class="ae kj" href="https://unsplash.com/s/photos/time-series-forecasting?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><h1 id="82bc" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">时间序列的基本术语(预测)</h1><p id="ae8c" class="pw-post-body-paragraph ix iy hi iz b ja lc ij jc jd ld im jf jg le ji jj jk lf jm jn jo lg jq jr js hb bi translated">我们可以说基于时间序列的工作在这个领域占有很大的份额。基于有序时间观察创建的数据称为“时间序列”。我们将解释4个基本术语来理解时间序列。</p><ul class=""><li id="912b" class="lh li hi iz b ja jb jd je jg lj jk lk jo ll js lm ln lo lp bi translated">静止的</li><li id="c9f3" class="lh li hi iz b ja lq jd lr jg ls jk lt jo lu js lm ln lo lp bi translated">趋势</li><li id="89e0" class="lh li hi iz b ja lq jd lr jg ls jk lt jo lu js lm ln lo lp bi translated">季节性</li><li id="4093" class="lh li hi iz b ja lq jd lr jg ls jk lt jo lu js lm ln lo lp bi translated">循环</li></ul><h2 id="636d" class="lv kl hi bd km lw lx ly kq lz ma mb ku jg mc md kw jk me mf ky jo mg mh la mi bi translated">静止的</h2><ul class=""><li id="f350" class="lh li hi iz b ja lc jd ld jg mj jk mk jo ml js lm ln lo lp bi translated">平稳表示时间序列的统计特征不随时间而变化。</li><li id="24f9" class="lh li hi iz b ja lq jd lr jg ls jk lt jo lu js lm ln lo lp bi translated">如果一个时间序列的均值、方差和协方差不变，并且随时间稳定，我们可以说这个时间序列是平稳的。</li></ul><p id="d67b" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">下面有一个平稳时间序列的示例图片。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div class="er es mm"><img src="../Images/97da811bd42ab99d7a7ab7dd0aa6a25d.png" data-original-src="https://miro.medium.com/v2/resize:fit:592/format:webp/1*SgjuJDqOcTVfX--waFxucw.png"/></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">图片由<a class="ae kj" href="https://www.veribilimiokulu.com/" rel="noopener ugc nofollow" target="_blank"> VBO </a></figcaption></figure><h2 id="1ece" class="lv kl hi bd km lw lx ly kq lz ma mb ku jg mc md kw jk me mf ky jo mg mh la mi bi translated">趋势</h2><ul class=""><li id="347a" class="lh li hi iz b ja lc jd ld jg mj jk mk jo ml js lm ln lo lp bi translated">趋势表示时间序列的增加或减少。</li><li id="d498" class="lh li hi iz b ja lq jd lr jg ls jk lt jo lu js lm ln lo lp bi translated">长期趋势是一个时间序列的递增或递减结构。</li></ul><p id="deae" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们在下面看到增加和减少时间序列的例子。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div class="er es mn"><img src="../Images/6caf98c4274699f166aab9db67b99799.png" data-original-src="https://miro.medium.com/v2/resize:fit:1334/format:webp/1*IVyvdlURFM8mKiXkxL1LRA.png"/></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">一个递增时间序列的例子|图片由<a class="ae kj" href="https://www.veribilimiokulu.com/" rel="noopener ugc nofollow" target="_blank"> VBO </a>拍摄</figcaption></figure><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es mo"><img src="../Images/d4548ed346b28af698587745e9007abe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dAj0benR7P5O7Tiv-36IWQ.png"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">时间序列增加的示例|图片由<a class="ae kj" href="https://www.veribilimiokulu.com/" rel="noopener ugc nofollow" target="_blank"> VBO </a>提供</figcaption></figure><h2 id="2468" class="lv kl hi bd km lw lx ly kq lz ma mb ku jg mc md kw jk me mf ky jo mg mh la mi bi translated">季节性</h2><ul class=""><li id="63ea" class="lh li hi iz b ja lc jd ld jg mj jk mk jo ml js lm ln lo lp bi translated">这个术语基本上问了这个问题:趋势是否遵循一个模式？</li><li id="89b5" class="lh li hi iz b ja lq jd lr jg ls jk lt jo lu js lm ln lo lp bi translated">我们说，如果有一个按周期发生的模式，时间序列中就有季节性。</li></ul><p id="5d16" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们看到一个具有季节性的时间序列示例如下。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es mo"><img src="../Images/f78f1389e99bb3568a45a51e7ed96f70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SVpxijuRdzJxt8-tMDEc1Q.png"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">图片由<a class="ae kj" href="https://www.veribilimiokulu.com/" rel="noopener ugc nofollow" target="_blank"> VBO </a></figcaption></figure><h2 id="989c" class="lv kl hi bd km lw lx ly kq lz ma mb ku jg mc md kw jk me mf ky jo mg mh la mi bi translated">循环</h2><ul class=""><li id="4669" class="lh li hi iz b ja lc jd ld jg mj jk mk jo ml js lm ln lo lp bi translated">周期有点类似于季节性。然而，它弱于季节性，以显示出现的模式。</li><li id="a56b" class="lh li hi iz b ja lq jd lr jg ls jk lt jo lu js lm ln lo lp bi translated">它包含重复的模式。</li><li id="c287" class="lh li hi iz b ja lq jd lr jg ls jk lt jo lu js lm ln lo lp bi translated">处理时间序列中的季节性模式既简单又快捷。</li><li id="26d4" class="lh li hi iz b ja lq jd lr jg ls jk lt jo lu js lm ln lo lp bi translated">在周期时间序列中，模式是长期的，很难在短期内处理它们。</li></ul><p id="8526" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">下面我们看一张图来想象周期和季节时间序列的区别。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es mo"><img src="../Images/eeaf9eac0dba01c2100509061d9523bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mip9gluxynWTzRdgcudbbw.png"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">图片由<a class="ae kj" href="https://www.veribilimiokulu.com/" rel="noopener ugc nofollow" target="_blank"> VBO </a></figcaption></figure><h2 id="cc9c" class="lv kl hi bd km lw lx ly kq lz ma mb ku jg mc md kw jk me mf ky jo mg mh la mi bi translated">水平</h2><p id="08e0" class="pw-post-body-paragraph ix iy hi iz b ja lc ij jc jd ld im jf jg le ji jj jk lf jm jn jo lg jq jr js hb bi translated">该水平是时间序列的平均值。</p><h1 id="7e38" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">对时间序列本质的理解</h1><p id="4452" class="pw-post-body-paragraph ix iy hi iz b ja lc ij jc jd ld im jf jg le ji jj jk lf jm jn jo lg jq jr js hb bi translated">一般规则:时间序列更容易受到前一个时间序列的影响。例如，6月2日的销售比6月1日的销售更有效。为了更好地理解这条规则，我们将学习两个关键术语:移动平均线和加权平均线。</p><h2 id="a39c" class="lv kl hi bd km lw lx ly kq lz ma mb ku jg mc md kw jk me mf ky jo mg mh la mi bi translated">移动平均数</h2><p id="8cfc" class="pw-post-body-paragraph ix iy hi iz b ja lc ij jc jd ld im jf jg le ji jj jk lf jm jn jo lg jq jr js hb bi translated">简而言之，这个平均值告诉我们一个时间序列的未来值是它的<code class="du mp mq mr ms b">k</code>以前值的平均值。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es mo"><img src="../Images/e45e7df83153af7214129e5c32d28d5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iydwwkCCnBBZPB2HsEk8mA.png"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">图片由<a class="ae kj" href="https://www.veribilimiokulu.com/" rel="noopener ugc nofollow" target="_blank"> VBO </a></figcaption></figure><p id="b071" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们看到一个低于4天的移动平均线的例子。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es mt"><img src="../Images/8edee246eba171b6a308bf801c751751.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m45w1u_5XcFbCaV1CE0Vvw.png"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">图片由<a class="ae kj" href="https://www.veribilimiokulu.com/" rel="noopener ugc nofollow" target="_blank"> VBO </a></figcaption></figure><h2 id="9a0d" class="lv kl hi bd km lw lx ly kq lz ma mb ku jg mc md kw jk me mf ky jo mg mh la mi bi translated">加权平均值</h2><p id="14da" class="pw-post-body-paragraph ix iy hi iz b ja lc ij jc jd ld im jf jg le ji jj jk lf jm jn jo lg jq jr js hb bi translated">它类似于移动平均线。它的主要思想是给予最新的观察更多的权重(重要性)。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es mt"><img src="../Images/a022d608142619c7afcb216f0d1c76e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ncGup8lo0yZP1CZvONFKCA.png"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">图片由<a class="ae kj" href="https://www.veribilimiokulu.com/" rel="noopener ugc nofollow" target="_blank"> VBO </a></figcaption></figure><p id="e451" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们在下面看到一个加权平均计算的例子。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es mu"><img src="../Images/2f8274c679ebb12e4ab5bdb50ce55b9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A4InCbcRG_F7GyMggiKj6Q.png"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">图片由<a class="ae kj" href="https://www.veribilimiokulu.com/" rel="noopener ugc nofollow" target="_blank"> VBO </a></figcaption></figure><p id="e76f" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，我们知道了理解时间序列预测的基本术语。时间序列预测有3种类型:</p><ul class=""><li id="ff22" class="lh li hi iz b ja jb jd je jg lj jk lk jo ll js lm ln lo lp bi translated">平滑方法</li><li id="654a" class="lh li hi iz b ja lq jd lr jg ls jk lt jo lu js lm ln lo lp bi translated">统计方法</li><li id="6469" class="lh li hi iz b ja lq jd lr jg ls jk lt jo lu js lm ln lo lp bi translated">机器学习</li></ul><p id="3852" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这个故事中，我们将深入探讨平滑的方法。</p><h1 id="f1b0" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">平滑方法</h1><p id="0851" class="pw-post-body-paragraph ix iy hi iz b ja lc ij jc jd ld im jf jg le ji jj jk lf jm jn jo lg jq jr js hb bi translated">有3种不同的平滑方法可用于3种不同的情况:</p><ul class=""><li id="4ea3" class="lh li hi iz b ja jb jd je jg lj jk lk jo ll js lm ln lo lp bi translated">单一指数平滑法</li><li id="4313" class="lh li hi iz b ja lq jd lr jg ls jk lt jo lu js lm ln lo lp bi translated">双指数平滑法</li><li id="32f7" class="lh li hi iz b ja lq jd lr jg ls jk lt jo lu js lm ln lo lp bi translated">三重指数平滑(TES)</li></ul><p id="b6f0" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们将解释我们上面提到的所有这些方法，并做一个关于TES的应用实例。</p><h2 id="6234" class="lv kl hi bd km lw lx ly kq lz ma mb ku jg mc md kw jk me mf ky jo mg mh la mi bi translated">单一指数平滑法</h2><p id="d6e3" class="pw-post-body-paragraph ix iy hi iz b ja lc ij jc jd ld im jf jg le ji jj jk lf jm jn jo lg jq jr js hb bi translated">这种方法只适用于平稳的时间序列。如果要用这种方法，时间序列就不应该有趋势性和季节性。</p><p id="a3b8" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这种方法:</p><ul class=""><li id="d991" class="lh li hi iz b ja jb jd je jg lj jk lk jo ll js lm ln lo lp bi translated">可以处理水平</li><li id="df7d" class="lh li hi iz b ja lq jd lr jg ls jk lt jo lu js lm ln lo lp bi translated">通过指数校正进行预测</li><li id="1715" class="lh li hi iz b ja lq jd lr jg ls jk lt jo lu js lm ln lo lp bi translated">根据“未来与过去更相关”对以前的值进行加权</li><li id="f63a" class="lh li hi iz b ja lq jd lr jg ls jk lt jo lu js lm ln lo lp bi translated">按以前的实际值和以前的预测值进行预测(以指数方式给出权重)</li></ul><p id="fb64" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这种方法的公式:</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es mu"><img src="../Images/9da2d833ccf2752478e846955252f5de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0nazsT22mNjw-CGXZTdsiQ.png"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">图片由<a class="ae kj" href="https://www.veribilimiokulu.com/" rel="noopener ugc nofollow" target="_blank"> VBO </a></figcaption></figure><ul class=""><li id="3af3" class="lh li hi iz b ja jb jd je jg lj jk lk jo ll js lm ln lo lp bi translated">y_hat t:要预测的时间单位</li><li id="20c7" class="lh li hi iz b ja lq jd lr jg ls jk lt jo lu js lm ln lo lp bi translated">yt-1:以前的act值(学习，方法从这个值学习)</li><li id="3a95" class="lh li hi iz b ja lq jd lr jg ls jk lt jo lu js lm ln lo lp bi translated">y_hat t-1:以前的预测值(记住，方法是从这个值开始记忆)</li><li id="c0bc" class="lh li hi iz b ja lq jd lr jg ls jk lt jo lu js lm ln lo lp bi translated">答:平滑因子。它介于0和1之间</li></ul><p id="45b3" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因此，该方法使用先前的实际值和先前的预测值来预测下一个值。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es mu"><img src="../Images/1affd137f8f35ddbeaed23c6574eff03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kalFmpvhPyiOWcvBqsFBKw.png"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">SES |图片示例<a class="ae kj" href="https://www.veribilimiokulu.com/" rel="noopener ugc nofollow" target="_blank"> VBO </a></figcaption></figure><h2 id="f788" class="lv kl hi bd km lw lx ly kq lz ma mb ku jg mc md kw jk me mf ky jo mg mh la mi bi translated">双指数平滑法</h2><p id="94e2" class="pw-post-body-paragraph ix iy hi iz b ja lc ij jc jd ld im jf jg le ji jj jk lf jm jn jo lg jq jr js hb bi translated">这种方法适用于平稳和趋势时间序列。如果要用这种方法，时间序列应该没有季节性。</p><p id="f389" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这种方法</p><ul class=""><li id="0cb5" class="lh li hi iz b ja jb jd je jg lj jk lk jo ll js lm ln lo lp bi translated">能够处理水平和趋势</li><li id="be36" class="lh li hi iz b ja lq jd lr jg ls jk lt jo lu js lm ln lo lp bi translated">考虑趋势效应的指数修正</li><li id="e890" class="lh li hi iz b ja lq jd lr jg ls jk lt jo lu js lm ln lo lp bi translated">除了SES，趋势也被考虑在内</li><li id="1ccc" class="lh li hi iz b ja lq jd lr jg ls jk lt jo lu js lm ln lo lp bi translated">应该用在没有季节性和单一变量(特征)的时间序列上</li></ul><p id="5ea7" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">公式:</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es mu"><img src="../Images/85e9044053a6bf6b3bcdd89ce76f0ec5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t0jMpqNy_LpC5248kU8T6A.png"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">图片由<a class="ae kj" href="https://www.veribilimiokulu.com/" rel="noopener ugc nofollow" target="_blank"> VBO </a></figcaption></figure><p id="20b3" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最新的等式告诉我们，下期=级别+趋势。在均值上，下期=上期均值(水平)+趋势。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es mv"><img src="../Images/9adfcc3452791f3920c0c03e2875163e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U4CpJJkIxsR8wV0P5RAYbw.png"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">SES |图片示例由<a class="ae kj" href="https://www.veribilimiokulu.com/" rel="noopener ugc nofollow" target="_blank"> VBO </a></figcaption></figure><h2 id="b5ad" class="lv kl hi bd km lw lx ly kq lz ma mb ku jg mc md kw jk me mf ky jo mg mh la mi bi translated">三重指数平滑法(TES，又名霍尔特-温特斯)</h2><p id="d284" class="pw-post-body-paragraph ix iy hi iz b ja lc ij jc jd ld im jf jg le ji jj jk lf jm jn jo lg jq jr js hb bi translated">这种方法适用于平稳、季节性和趋势性的时间序列。</p><p id="abc6" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这种方法；</p><ul class=""><li id="016e" class="lh li hi iz b ja jb jd je jg lj jk lk jo ll js lm ln lo lp bi translated">能够处理水平、趋势和季节性</li><li id="85fe" class="lh li hi iz b ja lq jd lr jg ls jk lt jo lu js lm ln lo lp bi translated">除了SES之外，趋势和季节性也被考虑在内</li><li id="15af" class="lh li hi iz b ja lq jd lr jg ls jk lt jo lu js lm ln lo lp bi translated">是改进最多的平滑方法</li><li id="8dd1" class="lh li hi iz b ja lq jd lr jg ls jk lt jo lu js lm ln lo lp bi translated">预测动态地考虑水平、趋势和季节性</li><li id="b6e4" class="lh li hi iz b ja lq jd lr jg ls jk lt jo lu js lm ln lo lp bi translated">应与具有趋势和/或季节性以及单一变量(特征)的时间序列一起使用</li></ul><p id="c24d" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这种方法的公式:</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es mv"><img src="../Images/a9a0d16fcb390cf67c40557e25e1bf9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vDB5dHwgdVqaOYR5iTf4Ew.png"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">图片由<a class="ae kj" href="https://www.veribilimiokulu.com/" rel="noopener ugc nofollow" target="_blank"> VBO </a></figcaption></figure><h2 id="e0a2" class="lv kl hi bd km lw lx ly kq lz ma mb ku jg mc md kw jk me mf ky jo mg mh la mi bi translated">平滑方法汇总表</h2><p id="5c91" class="pw-post-body-paragraph ix iy hi iz b ja lc ij jc jd ld im jf jg le ji jj jk lf jm jn jo lg jq jr js hb bi translated">我们在下面看到了我们上面谈到的平滑方法的对比表。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es mv"><img src="../Images/0f51b1a597ef186bb589ddbe96d31db8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ahmr46b_-joMMci8RL_P6Q.png"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">图片由<a class="ae kj" href="https://www.veribilimiokulu.com/" rel="noopener ugc nofollow" target="_blank"> VBO </a></figcaption></figure><h1 id="e01e" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">Python三重指数平滑的应用实例</h1><p id="f61d" class="pw-post-body-paragraph ix iy hi iz b ja lc ij jc jd ld im jf jg le ji jj jk lf jm jn jo lg jq jr js hb bi translated">在这一节中，我们将用Python做一个应用实例来应用TES方法。我为这部分准备了一个Kaggle笔记本。我们将使用来自<code class="du mp mq mr ms b">statsmodels</code>的名为<code class="du mp mq mr ms b">co2</code>的数据集。您可以使用下面的链接浏览笔记本。</p><div class="mw mx ez fb my mz"><a href="https://www.kaggle.com/enesbaysan/applied-example-of-triple-exponential-smoothing" rel="noopener  ugc nofollow" target="_blank"><div class="na ab dw"><div class="nb ab nc cl cj nd"><h2 class="bd hj fi z dy ne ea eb nf ed ef hh bi translated">三重指数平滑的应用实例</h2><div class="ng l"><h3 class="bd b fi z dy ne ea eb nf ed ef dx translated">使用Kaggle笔记本探索和运行机器学习代码|使用来自无附加数据源的数据</h3></div><div class="nh l"><p class="bd b fp z dy ne ea eb nf ed ef dx translated">www.kaggle.com</p></div></div><div class="ni l"><div class="nj l nk nl nm ni nn kd mz"/></div></div></a></div><h2 id="6860" class="lv kl hi bd km lw lx ly kq lz ma mb ku jg mc md kw jk me mf ky jo mg mh la mi bi translated">安装包</h2><p id="3270" class="pw-post-body-paragraph ix iy hi iz b ja lc ij jc jd ld im jf jg le ji jj jk lf jm jn jo lg jq jr js hb bi translated">首先，我们需要安装并导入所需的包。</p><pre class="ju jv jw jx fd no ms np nq aw nr bi"><span id="6da1" class="lv kl hi ms b fi ns nt l nu nv">import itertools<br/>import warnings<br/>import matplotlib.pyplot as plt<br/>import numpy as np<br/>import statsmodels.api as sm<br/>from sklearn.metrics import mean_absolute_error<br/>from statsmodels.tsa.holtwinters import ExponentialSmoothing</span></pre><p id="b919" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我不需要安装软件包，因为我正在使用Kaggle。然而，如果你在本地工作，也许你需要安装软件包。在这种情况下，您可以使用下面的代码。</p><pre class="ju jv jw jx fd no ms np nq aw nr bi"><span id="8990" class="lv kl hi ms b fi ns nt l nu nv">!pip install matplotlib<br/>!pip install numpy<br/>!pip install statsmodels<br/>!pip install sklearn</span></pre><h2 id="491c" class="lv kl hi bd km lw lx ly kq lz ma mb ku jg mc md kw jk me mf ky jo mg mh la mi bi translated">加载和准备数据</h2><p id="b02c" class="pw-post-body-paragraph ix iy hi iz b ja lc ij jc jd ld im jf jg le ji jj jk lf jm jn jo lg jq jr js hb bi translated">在这个应用示例中，我们将使用上面提到的<code class="du mp mq mr ms b">statsmodels.api</code>包中的CO2数据集。该数据集是1958年3月至2001年12月期间CO2记录。</p><pre class="ju jv jw jx fd no ms np nq aw nr bi"><span id="d896" class="lv kl hi ms b fi ns nt l nu nv">data = sm.datasets.co2.load_pandas()<br/>y = data.data<br/>y.head()</span></pre><figure class="ju jv jw jx fd jy er es paragraph-image"><div class="er es nw"><img src="../Images/a60efb12b910b480fe146eb498c20336.png" data-original-src="https://miro.medium.com/v2/resize:fit:320/format:webp/1*wnXr6UOS0mmWwKidANHcsw.png"/></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">作者图片</figcaption></figure><p id="bd2b" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">该数据集的时间范围是每周。我们将把范围从每周改为每月。</p><pre class="ju jv jw jx fd no ms np nq aw nr bi"><span id="0d9a" class="lv kl hi ms b fi ns nt l nu nv">y = y['co2'].resample('MS').mean()</span></pre><p id="bffd" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然后，我将检查是否有空值。</p><pre class="ju jv jw jx fd no ms np nq aw nr bi"><span id="08fd" class="lv kl hi ms b fi ns nt l nu nv">y.isnull().sum()</span><span id="4af4" class="lv kl hi ms b fi nx nt l nu nv">&gt;&gt;&gt; 5</span></pre><p id="324a" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我将填写这5个空值。为此，我使用了<code class="du mp mq mr ms b">bfill</code>方法。如果一个观察值为空，则自动填充下一个观察值。</p><pre class="ju jv jw jx fd no ms np nq aw nr bi"><span id="fe58" class="lv kl hi ms b fi ns nt l nu nv">y = y.fillna(y.bfill())</span></pre><p id="df5b" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">并获得数据集的第一个概览。</p><pre class="ju jv jw jx fd no ms np nq aw nr bi"><span id="f615" class="lv kl hi ms b fi ns nt l nu nv">y.plot(figsize=(15, 6))<br/>plt.show()</span></pre><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es ny"><img src="../Images/3d727be76a904b4a2c2edf0998f2fc72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5ovheNcBi6JvihRGBaEkcA.png"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">作者图片</figcaption></figure><h2 id="15b9" class="lv kl hi bd km lw lx ly kq lz ma mb ku jg mc md kw jk me mf ky jo mg mh la mi bi translated">创建比较训练值、测试值和预测值的函数</h2><p id="3963" class="pw-post-body-paragraph ix iy hi iz b ja lc ij jc jd ld im jf jg le ji jj jk lf jm jn jo lg jq jr js hb bi translated">我们可以使用下面的函数直观地比较实际值和预测值。</p><pre class="ju jv jw jx fd no ms np nq aw nr bi"><span id="ed66" class="lv kl hi ms b fi ns nt l nu nv">def plot_co2(train, test, y_pred, title):<br/>    """<br/>        This function to visualize the act and predicted value of y<br/>    """<br/>    mae = mean_absolute_error(test, y_pred)<br/>    train["1985":].plot(legend=True, label="TRAIN", title=f"{title}, MAE: {round(mae,2)}")<br/>    test.plot(legend=True, label="TEST", figsize=(6, 4))<br/>    y_pred.plot(legend=True, label="PREDICTION")<br/>    plt.show()</span></pre><p id="f977" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们使用“train["1985":]”来缩小可视化的范围。</p><h2 id="4c2b" class="lv kl hi bd km lw lx ly kq lz ma mb ku jg mc md kw jk me mf ky jo mg mh la mi bi translated">创建TES模型</h2><p id="96bb" class="pw-post-body-paragraph ix iy hi iz b ja lc ij jc jd ld im jf jg le ji jj jk lf jm jn jo lg jq jr js hb bi translated">我将把我的数据集分成训练和测试部分。</p><pre class="ju jv jw jx fd no ms np nq aw nr bi"><span id="047b" class="lv kl hi ms b fi ns nt l nu nv"># from 1958 to end of the 1997<br/>train = y[:'1997-12-01']<br/>len(train)  # 478 month</span><span id="ba84" class="lv kl hi ms b fi nx nt l nu nv"># from 1998 to first month of the 2001<br/>test = y['1998-01-01':]<br/>len(test)  # 48 ay</span></pre><p id="ec8d" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，我将基于上面划分的训练数据集创建(训练)一个TES实例(模型)。为了创建一个TES实例，我们使用来自<code class="du mp mq mr ms b">statsmodels.tsa.holtwinters</code>包的<code class="du mp mq mr ms b">ExponentialSmoothing</code>。</p><pre class="ju jv jw jx fd no ms np nq aw nr bi"><span id="8e50" class="lv kl hi ms b fi ns nt l nu nv">tes_model = ExponentialSmoothing(train,<br/>   trend="add",<br/>   seasonal="add",<br/>   seasonal_periods=12<br/>   ).fit(smoothing_level=0.5,<br/>         smoothing_trend=0.5,<br/>         smoothing_seasonal=0.5<br/>   )</span></pre><p id="185a" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，我可以通过使用我创建的TES实例来预测N步之后的情况。我们在48步后进行预测，并将预测值存储到<code class="du mp mq mr ms b">y_pred</code>变量中。</p><pre class="ju jv jw jx fd no ms np nq aw nr bi"><span id="2fa3" class="lv kl hi ms b fi ns nt l nu nv">y_pred = tes_model.forecast(48)</span></pre><p id="21d8" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们可以使用我们上面创建的名为<code class="du mp mq mr ms b">plot_co2</code>的方法来可视化真实值和预测值。</p><pre class="ju jv jw jx fd no ms np nq aw nr bi"><span id="88d8" class="lv kl hi ms b fi ns nt l nu nv">plot_co2(train, test, y_pred, "Triple Exponential Smoothing")</span></pre><figure class="ju jv jw jx fd jy er es paragraph-image"><div class="er es nz"><img src="../Images/cfae0b552b69fe6dbad548f59a41e7f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:792/format:webp/1*G5m11Ev8-WLqA_KZeJoESw.png"/></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">作者图片</figcaption></figure><p id="294c" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">实际上，我们已经完成了“用Python实现三重指数平滑的应用示例”。然而，我不想就此打住。因为还有一个非常重要的话题:TES的超参数优化。我们将在下一节学习如何优化TES的超参数。</p><h2 id="9e60" class="lv kl hi bd km lw lx ly kq lz ma mb ku jg mc md kw jk me mf ky jo mg mh la mi bi translated">三重指数平滑的超参数优化</h2><p id="ba4c" class="pw-post-body-paragraph ix iy hi iz b ja lc ij jc jd ld im jf jg le ji jj jk lf jm jn jo lg jq jr js hb bi translated">在开始如何为TES优化超参数之前，我想先简单介绍一下什么是超参数。超参数是创建或构建模型时使用的参数。举个例子，我们上面看到TES公式中有一些参数。我们可以通过播放这些参数来创建TES模型。我们可以尝试使用不同的参数来获得模型的最佳结果。这就是超参数调整/优化。</p><p id="4cdb" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我已经编写了一个函数来优化TES模型。我不想一行一行地解释这个故事中的代码。如果您想获得更多细节，可以通过Kaggle链接，通过注释行来更好地理解代码。</p><pre class="ju jv jw jx fd no ms np nq aw nr bi"><span id="f012" class="lv kl hi ms b fi ns nt l nu nv">def tes_optimizer(train, test, abg, trend_mode='add', seasonal_mode = 'add', seasonal_period=12,step=48):<br/>    """<br/>        This function to optimize hyperparameters for the TES model<br/>    """<br/>    best_alpha, best_beta, best_gamma, best_mae = None, None, None, float("inf")</span><span id="b10a" class="lv kl hi ms b fi nx nt l nu nv">for comb in abg:<br/>        tes_model = ExponentialSmoothing(train, trend=trend_mode, seasonal=seasonal_mode, seasonal_periods=seasonal_period).\<br/>            fit(smoothing_level=comb[0], smoothing_trend=comb[1], smoothing_seasonal=comb[2])<br/>        y_pred = tes_model.forecast(step)<br/>        mae = mean_absolute_error(test, y_pred)<br/>        if mae &lt; best_mae:<br/>            best_alpha, best_beta, best_gamma, best_mae = comb[0], comb[1], comb[2], mae<br/>        print([round(comb[0], 2), round(comb[1], 2), round(comb[2], 2), round(mae, 2)])</span><span id="fc91" class="lv kl hi ms b fi nx nt l nu nv">print("best_alpha:", round(best_alpha, 2), "best_beta:", round(best_beta, 2), "best_gamma:", round(best_gamma, 2),<br/>          "best_mae:", round(best_mae, 4))</span><span id="e50d" class="lv kl hi ms b fi nx nt l nu nv">return best_alpha, best_beta, best_gamma, best_mae</span></pre><p id="ea3a" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们在上面看到了优化函数。为了使用该功能，我将创建超参数对。该函数将尝试每一对以在模型上获得更好的结果，然后返回最佳参数。</p><pre class="ju jv jw jx fd no ms np nq aw nr bi"><span id="f4f3" class="lv kl hi ms b fi ns nt l nu nv">alphas = betas = gammas = np.arange(0.10, 1, 0.20)</span><span id="7edf" class="lv kl hi ms b fi nx nt l nu nv">abg = list(itertools.product(alphas, betas, gammas))</span></pre><p id="e354" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然后，我将这些参数推送给优化器函数，以获得最佳参数。</p><pre class="ju jv jw jx fd no ms np nq aw nr bi"><span id="f3d2" class="lv kl hi ms b fi ns nt l nu nv">best_alpha, best_beta, best_gamma, best_mae = tes_optimizer(train,test, abg)</span></pre><h2 id="a6d5" class="lv kl hi bd km lw lx ly kq lz ma mb ku jg mc md kw jk me mf ky jo mg mh la mi bi translated">决赛最佳TES模特</h2><p id="2ea2" class="pw-post-body-paragraph ix iy hi iz b ja lc ij jc jd ld im jf jg le ji jj jk lf jm jn jo lg jq jr js hb bi translated">我们拥有创建或构建新TES模式的最佳参数。让我们使用参数创建一个新模型。</p><pre class="ju jv jw jx fd no ms np nq aw nr bi"><span id="aef0" class="lv kl hi ms b fi ns nt l nu nv">final_tes_model = ExponentialSmoothing(train, trend="add", seasonal="add", seasonal_periods=12).\<br/>            fit(smoothing_level=best_alpha, smoothing_trend=best_beta, smoothing_seasonal=best_gamma</span></pre><p id="d8ab" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然后用最终模型预测48步。</p><pre class="ju jv jw jx fd no ms np nq aw nr bi"><span id="ea80" class="lv kl hi ms b fi ns nt l nu nv">y_pred = final_tes_model.forecast(48)</span></pre><p id="3c0e" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，如果我们使用上面创建的visualizer函数，我们可以看到优化模型和未优化模型之间的成功差异。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div class="er es oa"><img src="../Images/c55398eb795c56bd03878a9c6682e914.png" data-original-src="https://miro.medium.com/v2/resize:fit:826/format:webp/1*Sx_rSjMWUTCivM_hDv-dmw.png"/></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">作者图片</figcaption></figure><p id="6592" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果你看一下之前的TES结果图表，你就会明白为什么超参数优化如此重要。</p><h1 id="9db9" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">最后</h1><p id="97fb" class="pw-post-body-paragraph ix iy hi iz b ja lc ij jc jd ld im jf jg le ji jj jk lf jm jn jo lg jq jr js hb bi translated">希望你喜欢这个。我喜欢编码和解释。我更愿意给出一个TES的应用例子，而不是DES和SES。因为，正如我们之前提到的，TES是平滑方法中改进最多的方法。我希望您将使用它来构建自己的项目。</p><p id="3e15" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">亲切的问候。</p></div></div>    
</body>
</html>