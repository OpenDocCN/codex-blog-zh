<html>
<head>
<title>Build an Unsplash Photo Search App Using Vanilla JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用普通的JavaScript构建一个Unsplash照片搜索应用程序</h1>
<blockquote>原文：<a href="https://medium.com/codex/build-an-unsplash-photo-search-app-using-vanilla-javascript-11554126a2e?source=collection_archive---------26-----------------------#2021-07-30">https://medium.com/codex/build-an-unsplash-photo-search-app-using-vanilla-javascript-11554126a2e?source=collection_archive---------26-----------------------#2021-07-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="28e0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本文中，我将解释我是如何使用JavaScript构建一个图片搜索应用程序的。它根据用户的搜索查询从<a class="ae jd" href="https://unsplash.com/" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>获取并显示图像。这是我建立的几个个人项目之一，使我能够在我所学的基础上获得一些实践。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/e485690c1df59ed5c4f9201d4a96a076.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ApO8FQHdzCzSUh_H.png"/></div></div></figure><h1 id="081e" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">设置标记和样式</h1><p id="77b8" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">我考虑了一下我想要的页面外观，决定选择一个简单的白色页面(如上所示),顶部有输入和提交按钮，结果是一个网格结构。</p><h1 id="28b7" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">解决JavaScript问题</h1><p id="bb06" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">我首先全局存储了对表单和其他一些我将要使用的HTML元素的引用。稍后我仍然会在函数中选择其他函数。我还在表单中添加了一个<code class="du kt ku kv kw b">submit</code>事件监听器。</p><pre class="jf jg jh ji fd kx kw ky kz aw la bi"><span id="f75f" class="lb jr hi kw b fi lc ld l le lf">const form = document.querySelector('.js-form');<br/>form.addEventListener('submit', handleSubmit);<br/>const nextBtn = document.querySelector('.js-next');<br/>const prevBtn = document.querySelector('.js-prev');<br/>let resultStats = document.querySelector('.js-result-stats');<br/>let searchQuery;</span></pre><p id="b333" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后我在事件监听器中定义了回调函数<code class="du kt ku kv kw b">handleSubmit</code>,如下所示:</p><pre class="jf jg jh ji fd kx kw ky kz aw la bi"><span id="769a" class="lb jr hi kw b fi lc ld l le lf">function handleSubmit(event) {<br/>    event.preventDefault();<br/>    const inputValue = document.querySelector('.js-search-input').value;<br/>    searchQuery = inputValue.trim();<br/>    console.log(searchQuery);<br/>    fetchResults(searchQuery);<br/>}</span></pre><p id="58f8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个函数将一个事件作为它的参数，首先使用<code class="du kt ku kv kw b">preventDefault()</code>方法阻止页面重新加载。然后，它将搜索输入的值存储在<code class="du kt ku kv kw b">inputValue</code>中，并用<code class="du kt ku kv kw b">trim()</code>方法删除任何空白。它将调整后的输入值存储在<code class="du kt ku kv kw b">searchQuery</code>中，并将其作为参数传递给正在调用的<code class="du kt ku kv kw b">fetchResults</code>函数。我将<code class="du kt ku kv kw b">searchQuery</code>的值记录到控制台，以确保传递了正确的值。</p><h1 id="f06a" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">从Unsplash获取结果</h1><pre class="jf jg jh ji fd kx kw ky kz aw la bi"><span id="7331" class="lb jr hi kw b fi lc ld l le lf">async function searchUnsplash(searchQuery) {<br/>    const endpoint = `https://api.unsplash.com/search/photos?query=${searchQuery}&amp;client_id=YOUR_ACCESS_KEY`;<br/>    const response = await fetch(endpoint);<br/>    if (!response.ok) {<br/>        throw Error(response.statusText);<br/>    }<br/>    const json = await response.json();<br/>    return json;<br/>}<br/><br/>async function fetchResults(searchQuery) {<br/>    try {<br/>        const results = await searchUnsplash(searchQuery);<br/>        console.log(results);<br/>        displayResults(results);<br/>    } catch(err) {<br/>        console.log(err);<br/>        alert('Failed to search Unsplash');<br/>    }<br/>}</span></pre><p id="ef9a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要想使用Unsplash的API，你必须创建一个开发者账户。只有在那之后，你才能得到你唯一的API密匙，用它你可以访问网站上的照片。使用包含端点和相关查询参数的URL向Unsplash发出AJAX请求。他们网站上的<a class="ae jd" href="https://unsplash.com/documentation" rel="noopener ugc nofollow" target="_blank">文档</a>页面提供了更多相关信息。</p><p id="6e2b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">函数<code class="du kt ku kv kw b">searchUnsplash</code>接受一个参数(<code class="du kt ku kv kw b">searchQuery</code>)，该参数作为<code class="du kt ku kv kw b">query</code>查询参数的值插入到端点中。现在，URL存储在变量<code class="du kt ku kv kw b">endpoint</code>中，该变量作为参数传递给<code class="du kt ku kv kw b">fetch</code>。<code class="du kt ku kv kw b">fetch()</code>方法接受一个参数，即您想要获取的资源的路径，在本例中存储在<code class="du kt ku kv kw b">endpoint</code>中。它总是返回一个<a class="ae jd" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" rel="noopener ugc nofollow" target="_blank">承诺</a>。现在，如果响应是200 OK，它被解析为JSON，存储在<code class="du kt ku kv kw b">json</code>变量中。结果被记录到控制台，以便查看JSON数据的内容。</p><p id="18e7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上面的两个函数都是异步的，这意味着<code class="du kt ku kv kw b">await</code>关键字可以用来暂停函数的执行，直到一个承诺被解决。这是通过在声明函数之前放置<code class="du kt ku kv kw b">async</code>关键字来实现的。我在<code class="du kt ku kv kw b">fetchResults</code>函数中使用了一个<code class="du kt ku kv kw b">try...catch</code>块。<code class="du kt ku kv kw b">try</code>块“尝试”执行其中的代码，如果出现异常或错误，<code class="du kt ku kv kw b">catch</code>块会保存当天的结果，并以其中写入的任何代码做出适当的响应。这是一种控制流机制，如果在获取结果时发生错误，它可以防止代码崩溃。</p><h1 id="79ac" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">在页面上显示结果</h1><p id="0fda" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">接下来的事情是在页面上显示结果。如果您检查加载到控制台的JSON数据，您会发现它包含几个内容不同的属性。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lg"><img src="../Images/84c693aef68a2bab1e1e914929e34d70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*udYEZwaHxCTNWESK.png"/></div></div><figcaption class="lh li et er es lj lk bd b be z dx translated">从Unsplash获取的JSON数据</figcaption></figure><p id="bbde" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du kt ku kv kw b">results</code>属性是一个包含搜索结果的数组。每个搜索结果都是一个对象，可以使用点或括号符号来访问。</p><pre class="jf jg jh ji fd kx kw ky kz aw la bi"><span id="9eb4" class="lb jr hi kw b fi lc ld l le lf">function displayResults(json) {<br/>    const searchResults = document.querySelector('.js-search-results');<br/>    searchResults.textContent = '';<br/>    json.results.forEach(result =&gt; {<br/>        const url = result.urls.small;<br/>        const unsplashLink = result.links.html;<br/>        const photographer = result.user.name;<br/>        const photographerPage = result.user.links.html;<br/>        searchResults.insertAdjacentHTML(<br/>            'beforeend',<br/>            `&lt;div&gt;<br/>                &lt;a href="${unsplashLink}" target="_blank"&gt;<br/>                    &lt;div class="result-item" style="background-image: url(${url});"&gt;&lt;/div&gt;<br/>                &lt;/a&gt;<br/>                &lt;p class="photographer-name"&gt;<br/>                    &lt;a href="${photographerPage}" target="_blank" style="color: black; text-decoration: none;"&gt;Photo by ${photographer}&lt;/a&gt;<br/>                &lt;/p&gt;<br/>            &lt;/div&gt;`<br/>        );  <br/>    });<br/>    totalResults = json.total;<br/>    resultStats.textContent = `About ${totalResults} results found`;<br/>};</span></pre><p id="fb85" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在HTML文件中已经创建了一个空的类别为<code class="du kt ku kv kw b">search-results</code>的<code class="du kt ku kv kw b">div</code>。然后在JS文件中的一个名为<code class="du kt ku kv kw b">displayResults</code>的新函数中选择它，该函数将一个JSON对象作为参数。<code class="du kt ku kv kw b">textContent</code>也被设置为空字符串，以清除所有先前的结果。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ll"><img src="../Images/285630928b187d843531d6f59ea3acbf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*NYAjqgQI7HpPH6vQ.png"/></div></div><figcaption class="lh li et er es lj lk bd b be z dx translated">其中一个提取结果的分解</figcaption></figure><p id="7ecf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，使用<code class="du kt ku kv kw b">forEach</code>方法迭代<code class="du kt ku kv kw b">results</code>数组。在回调函数中，嵌套的对象可以通过<code class="du kt ku kv kw b">result</code>参数来访问。如果你仔细研究上图，你会发现数组中的每个对象都包含了几个键，比如<code class="du kt ku kv kw b">links</code>、<code class="du kt ku kv kw b">user</code>、<code class="du kt ku kv kw b">urls</code>。这些可用于访问所讨论对象的不同类别的信息。</p><p id="fa15" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">回调函数中的第一行是变量，其中存储了所需的不同值。它们都是使用点符号访问的，包括:</p><ul class=""><li id="3560" class="lm ln hi ih b ii ij im in iq lo iu lp iy lq jc lr ls lt lu bi translated">图像url</li><li id="222f" class="lm ln hi ih b ii lv im lw iq lx iu ly iy lz jc lr ls lt lu bi translated">Unsplash上图像的链接</li><li id="2b78" class="lm ln hi ih b ii lv im lw iq lx iu ly iy lz jc lr ls lt lu bi translated">摄影师的名字</li><li id="6c1c" class="lm ln hi ih b ii lv im lw iq lx iu ly iy lz jc lr ls lt lu bi translated">链接到摄影师的Unsplash个人资料</li></ul><p id="b0e6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后，使用<code class="du kt ku kv kw b"><a class="ae jd" href="https://developer.mozilla.org/en/docs/Web/API/Element/insertAdjacentHTML" rel="noopener ugc nofollow" target="_blank">insertAdjacentHTML</a></code>方法将每个结果插入到<code class="du kt ku kv kw b">searchResults</code>元素中。这个方法有两个参数:元素的位置和要解析为HTML的文本。第二个参数中使用了模板文字，因为代码的某些部分会不断变化。这些由代码中的占位符表示。然后在<code class="du kt ku kv kw b">fetchResults</code>中调用函数<code class="du kt ku kv kw b">displayResults</code>。</p><p id="ac5c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">每个图像都被设置为其容器的背景，也是指向其Unsplash页面的链接。摄影师的名字，链接到他/她的Unsplash配置文件，被放置在图像的正下方，结果显示使用CSS网格进行了样式化。</p><h1 id="a47b" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">显示负载指示器</h1><p id="af08" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">这是在执行搜索查询时显示的内容，让用户知道操作仍在进行中。我从<a class="ae jd" href="https://tobiasahlin.com/spinkit/" rel="noopener ugc nofollow" target="_blank">这个网站</a>选择了一个微调器，并将HTML和CSS粘贴到我的代码中。对微调器的引用被全局存储在变量<code class="du kt ku kv kw b">spinner</code>中，然后<code class="du kt ku kv kw b">fectchResults</code>函数被更新如下:</p><pre class="jf jg jh ji fd kx kw ky kz aw la bi"><span id="45f5" class="lb jr hi kw b fi lc ld l le lf">const spinner = document.querySelector('.js-spinner');</span><span id="932d" class="lb jr hi kw b fi ma ld l le lf">async function fetchResults(searchQuery) {<br/>    spinner.classList.remove('hidden');<br/>    try {<br/>        const results = await searchUnsplash(searchQuery);<br/>        pagination(results.total_pages);<br/>        console.log(results);<br/>        displayResults(results);<br/>    } catch(err) {<br/>        console.log(err);<br/>        alert('Failed to search Unsplash');<br/>    }<br/>    spinner.classList.add('hidden');<br/>}</span></pre><h1 id="1d98" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">结论</h1><p id="5fb6" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">在本教程中，我们看到了如何使用JavaScript构建交互式应用程序。我希望你从中学到了很多。</p><p id="3f56" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我目前对工作机会持开放态度。任何关于职位空缺的信息都将不胜感激。</p><p id="087f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">感谢阅读！</p></div></div>    
</body>
</html>