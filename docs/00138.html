<html>
<head>
<title>4 Steps To Detect Handwriting in Images</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">检测图像中笔迹的4个步骤</h1>
<blockquote>原文：<a href="https://medium.com/codex/4-steps-to-detect-handwriting-in-images-cc6f031b42d8?source=collection_archive---------0-----------------------#2020-11-03">https://medium.com/codex/4-steps-to-detect-handwriting-in-images-cc6f031b42d8?source=collection_archive---------0-----------------------#2020-11-03</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/08b446690f12aa8e854002f1147191a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X3UYDGB154ih20LfyLJa7g.png"/></div></div></figure><p id="1863" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果你曾经想把手写的文本图像翻译成文字，那么你来对地方了。在本文中，我将讨论如何向Cloud Vision API发送POST请求。所以让我们开始吧！</p><p id="f799" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">您可能需要预先安装的应用程序:</strong></p><ol class=""><li id="278f" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated"><a class="ae jx" href="https://code.visualstudio.com/download" rel="noopener ugc nofollow" target="_blank"> Visual Studio代码</a>或<a class="ae jx" href="https://www.sublimetext.com/3" rel="noopener ugc nofollow" target="_blank">崇高文本</a>(只是一个好的文本编辑器)</li><li id="de5f" class="jo jp hi is b it jy ix jz jb ka jf kb jj kc jn jt ju jv jw bi translated"><a class="ae jx" href="https://www.postman.com/downloads/" rel="noopener ugc nofollow" target="_blank"> Postman </a>(向Google Vision API发送POST请求)</li></ol><h1 id="6bc9" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated"><strong class="ak">步骤1:在GCP上创建一个项目并启用API </strong></h1><p id="c080" class="pw-post-body-paragraph iq ir hi is b it lb iv iw ix lc iz ja jb ld jd je jf le jh ji jj lf jl jm jn hb bi translated">首先，用一个用户账号登录<a class="ae jx" href="https://cloud.google.com/" rel="noopener ugc nofollow" target="_blank"> Google云平台</a>，在上面建立一个项目。该项目将让您访问谷歌提供的所有API和服务。请确保为您的帐户启用计费，以避免在开发项目时遇到问题。不要担心，我们会给你300美元的信用点数，所以一开始不会向你收费。</p><p id="c904" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一旦您设置了帐户、获得了计费权限并创建了项目，请导航至平台上的“API和服务”选项卡(您可以在顶部的搜索栏中进行搜索)。点击“+启用API和服务”并搜索Cloud Vision API。单击它并启用API。</p><p id="dded" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">那么什么是云视觉API呢？这个API将读取你的图像文件，识别手写内容并返回输入的文本。</p><p id="fdd9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在进入下一步！</p><h1 id="4835" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated"><strong class="ak">第二步:设置您的服务帐户</strong></h1><p id="ceae" class="pw-post-body-paragraph iq ir hi is b it lb iv iw ix lc iz ja jb ld jd je jf le jh ji jj lf jl jm jn hb bi translated">等等…那么服务账号和我刚设置的账号有什么区别呢？您设置的账户是一个<strong class="is hj">用户账户</strong>。从名字就能猜到，它代表了与Google Cloud交互的开发者或用户。<strong class="is hj">服务账户</strong>代表非人类用户。当您的应用程序需要在没有人或“用户”指导的情况下自己访问资源时，可以使用它。</p><p id="8d0d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在我们知道了<em class="lg">为什么</em>我们需要一个服务帐户，让我们来设置一个。</p><p id="080c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">转到导航菜单上的“IAM和管理”选项卡。悬停在它上面，从菜单中选择“服务帐户”，然后单击“+创建服务帐户”。</p><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lh"><img src="../Images/5050e09e76ae8746df294cdb56c3d7cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MCj6HfcUHCpb4t3k6xGvWA.png"/></div></div></figure><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lm"><img src="../Images/9a227940f56f4d4e25fb14b9cacc0688.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vvRjhk5TEg6jiotNLg79-Q.png"/></div></div></figure><p id="0d7f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">选择一个帐户名称，最好与您的项目同名，然后单击“创建”。然后使服务帐户成为项目的“所有者”,这样它就可以完成项目中的操作。单击继续。然后输入您与GCP关联的电子邮件地址，授予您访问和更改服务帐户的权限。单击“完成”,等待服务帐户设置完成。</p><h1 id="4223" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">第三步:获取公钥</h1><p id="3033" class="pw-post-body-paragraph iq ir hi is b it lb iv iw ix lc iz ja jb ld jd je jf le jh ji jj lf jl jm jn hb bi translated">设置服务帐户后，单击“操作”选项卡下的三个按钮。从下拉菜单中单击“创建密钥”。这会将一个JSON文件下载到您的计算机上。这个文件夹包含您所有的凭证，这就是为什么它是超级重要的，你不要失去你的电脑中的文件。</p><p id="9fa3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在您的主目录中创建一个名为“secrets”的文件夹，并将下载的JSON文件移动到secrets文件夹中。</p><p id="c169" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">使用终端</strong></p><p id="3bc3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">使用以下命令将当前目录更改为主目录:</p><pre class="li lj lk ll fd ln lo lp lq aw lr bi"><span id="62d7" class="ls ke hi lo b fi lt lu l lv lw">cd ~</span></pre><p id="04c7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在您的个人目录中创建一个名为“秘密”的文件夹</p><pre class="li lj lk ll fd ln lo lp lq aw lr bi"><span id="164f" class="ls ke hi lo b fi lt lu l lv lw">mkdir secrets</span></pre><p id="263a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">从当前目录(下载)移动到目的地(主页&gt;机密)</p><pre class="li lj lk ll fd ln lo lp lq aw lr bi"><span id="2b73" class="ls ke hi lo b fi lt lu l lv lw">mv ~/Downloads/[file name] ~/secrets</span></pre><p id="54bc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">好了，你的文件现在被移动到一个新的目的地，这样你就不必搜索它了:)</p><p id="8ab3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在要打开这个文件，你需要一个好的文本编辑器，最好是<a class="ae jx" href="https://code.visualstudio.com/download" rel="noopener ugc nofollow" target="_blank"> Visual Studio Code </a>或<a class="ae jx" href="https://www.sublimetext.com/3" rel="noopener ugc nofollow" target="_blank"> Sublime </a> Text(如果你还没有安装，下载并安装它。一个好的文本编辑器真的会改变你的生活。使用您选择的编辑器打开下载的文件。</p><p id="69a1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在我们需要创建一个<strong class="is hj">系统变量:一个可以被你计算机上的任何应用程序访问的变量。</strong>系统变量将包含您的凭证。为什么？因为gcloud将使用系统变量来生成一个承载令牌，我们将在发送到Vision API的请求中使用它。</p><p id="23a7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">打开终端(我知道…我们今天会经常使用终端)并键入以下命令:</p><pre class="li lj lk ll fd ln lo lp lq aw lr bi"><span id="4970" class="ls ke hi lo b fi lt lu l lv lw">export GOOGLE_APPLICATION_CREDENTIALS = [your JSON file path]</span></pre><p id="72c4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du lx ly lz lo b">export</code>是用于在终端中创建系统变量的关键字。现在，计算机上的任何应用程序都可以访问您的文件路径。</p><p id="e29a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">设置好系统变量后，gcloud可以使用它来访问您的凭据，以生成不记名令牌。<strong class="is hj">无记名令牌是标识用户的凭证。</strong>现在你要做的第一件事就是查看gcloud是否在你的终端上运行。要进行检查，请运行以下命令:</p><pre class="li lj lk ll fd ln lo lp lq aw lr bi"><span id="6d0f" class="ls ke hi lo b fi lt lu l lv lw">gcloud -v</span></pre><p id="b722" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果它返回一个响应，那么gcloud就安装在你的电脑上了，你就可以开始使用了。如果没有，则使用<a class="ae jx" href="https://cloud.google.com/sdk/docs/install" rel="noopener ugc nofollow" target="_blank">此链接</a>下载并再次运行上述命令。一旦gcloud开始运行，请在您的终端中键入以下内容:</p><pre class="li lj lk ll fd ln lo lp lq aw lr bi"><span id="48c4" class="ls ke hi lo b fi lt lu l lv lw">gcloud auth application-default print-access-token</span></pre><p id="8d53" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">你得到的回应就是你的不记名令牌。复制密钥并将其粘贴到您的文本编辑器中。我们需要保存这个密钥，因为我们将在发送到Cloud Vision API的请求中使用它。现在我们已经设置好了一切，是时候测试了！</p><h1 id="0ae2" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">步骤4:使用Postman向API发送POST请求</h1><p id="9554" class="pw-post-body-paragraph iq ir hi is b it lb iv iw ix lc iz ja jb ld jd je jf le jh ji jj lf jl jm jn hb bi translated">现在是有趣的部分——转换！</p><p id="cc92" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">首先，您需要一个样本图像。如果你已经有一张手写文本的图像，只需使用<a class="ae jx" href="https://onlinejpgtools.com/convert-jpg-to-base64" rel="noopener ugc nofollow" target="_blank">在线转换器</a>将其转换为base64格式。如果您没有图像，请找到一个，并使用相同的转换器将其转换为base64。在文本编辑器中将base64格式保存到一个新文件中。</p><p id="1409" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">例如，这是我的图像</p><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ma"><img src="../Images/65bedca48271c1b8749cf715247e48bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zgDBS7M5jUTMR1fRHmz2iA.jpeg"/></div></div></figure><p id="958f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这是我的字符串表示</p><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mb"><img src="../Images/e981233a86a58cd5f7e6f32b65e82e80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YDOf19hq9FYoAwiVkFKdMA.png"/></div></div></figure><p id="e8be" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果你还没有，<a class="ae jx" href="https://www.postman.com/downloads/" rel="noopener ugc nofollow" target="_blank">下载并安装邮递员</a>。登录后，您应该会看到如下页面:</p><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mc"><img src="../Images/f7e3d8c350544fb9202525673ff68125.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X-hFK6uGzoUQH60VFqee5A.png"/></div></div></figure><p id="c2b9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">从灰色下拉菜单中，选择POST。复制以下请求URL并将其粘贴到灰色栏中。</p><pre class="li lj lk ll fd ln lo lp lq aw lr bi"><span id="89f8" class="ls ke hi lo b fi lt lu l lv lw">https://vision.googleapis.com/v1/images:annotate</span></pre><p id="e560" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然后，在右下方的“auth”选项卡中，单击“Type”下拉菜单并选择“Bearer Token”。还记得我们从证件上找到的不记名令牌吗？复制并粘贴到灰色栏中。设置授权后，转到“Body”选项卡，从下拉菜单中选择“raw”。从旁边的下拉菜单中，选择JSON。然后，复制下面的JSON请求。</p><pre class="li lj lk ll fd ln lo lp lq aw lr bi"><span id="b011" class="ls ke hi lo b fi lt lu l lv lw">{<br/>  "requests": [<br/>    {<br/>      "image": {<br/>        "content": "[<em class="lg">base64-encoded-image</em>]"<br/>      },<br/>      "features": [<br/>        {<br/>          "type": "DOCUMENT_TEXT_DETECTION"<br/>        }<br/>      ]<br/>    }<br/>  ]<br/>}</span></pre><p id="b52b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">还记得你保存的base64字符串吗？复制粘贴到“内容”里。你的身体应该看起来像这样:</p><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es md"><img src="../Images/76f1c7331c52b8213aec13ef92da745a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3UV_comcQQmltNfZ9u36gA.png"/></div></div></figure><p id="6f73" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">保存请求并点击“发送”,将请求发送到Cloud Vision API。你的回答应该是这样的:</p><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mc"><img src="../Images/bec9271b3d54eaf61219e1c87436edf3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bq9kQ12ruOfyKwl63KDSGQ.png"/></div></div><figcaption class="me mf et er es mg mh bd b be z dx translated">回应</figcaption></figure><p id="4c43" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，如果我们将图片与响应进行比较，我们会看到我们的请求被发送到API并被API读取。</p><p id="f2eb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，您向Cloud Vision API发送了第一个请求，将手写文本翻译成书面文本！补充说明:不记名令牌会随着每个会话而改变，所以如果您在关闭Postman后发送相同的请求，请确保重新生成令牌。如果您将这个特性硬编码到应用程序中，以自动向API发送请求，那么这是一个需要记住的重要注意事项。我将在下一篇文章中讨论这一部分。</p><p id="19a7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在那之前，再见，祝你项目好运！</p></div></div>    
</body>
</html>