# 揭穿伪码的三个神话

> 原文：<https://medium.com/codex/debunking-three-myths-of-puppet-code-708710b917bf?source=collection_archive---------13----------------------->

![](img/4661765b3fdd59c73eed670095bdd659.png)

我看到很多文章赞美木偶，这是理所当然的，但是我一直看到一些被列为“缺点”的话题根本不是真的。我想消除一些似乎围绕着木偶的神话，尽管是绝对不准确的。请允许我透露一点信息，揭示真相。

![](img/c3a142a221e046e0aa1d408bb3eacb52.png)

**误区:“需要了解 Ruby 才能使用 Puppet”**

你不需要了解鲁比。您不必编写一行 Ruby 代码来创建 Puppet 目录、管理节点、运行任务和计划等。没有。Puppet 有一个健壮的领域特定语言(DSL ),您可以用它来定义您想要管理的所有资源。虽然 Puppet 仍然可以通过 Ruby 进行扩展，但是使用 Ruby 进行编码的需求已经成为过去。你甚至不需要成为一个程序员来使用木偶 DSL 这很简单，也很直观，这就引出了下一个流言。

![](img/cd38f381369284f0975e49c946cc2fa6.png)

**神话:“木偶很难学/用”**

我真的不知道这是怎么开始的。这就像传说中的“你永远离蜘蛛不超过三英尺”；有人说过，它只是无休止地回响。我假设这个神话是神话 1 的遗产，但我不确定。我知道的是这完全是假的。

Puppet 的 DSL 是一种自我文档化的声明性语言，任何人都可以阅读和理解。语法很简单，只定义了期望的状态。Puppet 知道如何在受支持的环境中达到期望的状态，而不需要用户编写特定的步骤。下面是一个将安装和维护 Nano 编辑器的 Puppet 代码的工作示例:

```
package { 'nano':ensure => installed,}
```

这就是全部了。它可以在任何支持 nano 的操作系统上运行(这个包被命名为“nano”)。)Puppet 的 DSL 是自文档化的。任何人都应该能够阅读该课程并理解资源是如何被管理的。此示例确保安装了软件包 nano。

您可以编写更复杂的类，这些类依赖于操作系统、资源状态，甚至是从托管节点收集的元数据 Puppet，但是所有的类都使用相同的简单的、自我记录的声明性代码。额外的工作示例是[这里的](https://github.com/Jlaffey-Puppet/cs_control-repo)。你可以管理 100，000 台机器，却找不到一行 Ruby 代码。说到大规模管理节点，我们来谈谈

![](img/a5a1d40a60aedacb4c543cfe11c5a4fd.png)

***谬论:“一个傀儡代码库可能难以管理和维护”***

好吧，如果你没有适当的组织，你的车库，你的书，和你崭新的口袋妖怪交易卡会变得难以管理和维护。Puppet 的一个关键优势是能够扩展到数以千计的节点。许多木偶用户这样做，他们保持他们的木偶代码组织良好，不需要玛丽近藤组织艺术。

Puppet 使用一种叫做 [Roles 和 Profiles](https://puppet.com/docs/pe/2019.8/osp/the_roles_and_profiles_method.html) 的方法来可靠地构建可重用、可配置和可重构的系统配置，这些配置被保存为基础设施代码(IaC)。概要文件是使用多个组件(类和其他概要文件)来配置层技术堆栈的包装类。在最简单的一层，概要文件可以是一个类，它确保 Java 安装在一个特定的版本上，并包含 case 语句或 Hiera 变量来定制包名(例如，linux 系统的“apache”和 Windows 的“win_apache”)。更复杂的概要文件可以将几个相关的包或设置放在一起，例如:确保安装了 Tomcat，设置了正确的端口和主路径，并且启动了服务。

概要文件允许 Puppet 用户维护存储在存储库中的独立 IaC 块中的相关配置。然后可以模块化地组合配置文件，以构建完整的系统配置(角色。)重构变得很简单，因为在一个概要文件中进行的更改将扩展到分配给该概要文件的所有实例。角色和概要文件提供了一种有组织的方法来构建和维护大规模的复杂配置，这是单一剧本无法支持的。

冲突解决得到了妥善处理。谨慎是勇气的一部分，如果在资源傀儡的管理中出现冲突，它将勇敢地拒绝编制目录，直到冲突解决。如果乍一看这似乎很难，实际上它让用户理解团队在管理什么。

这些过时的和不准确的关于木偶的信念不断被重复，成为使用木偶的“首要”缺点。虽然看到为“缺点”清单提出新的项目有多难令人感到荣幸，但我希望看到这些项目被搁置。