<html>
<head>
<title>MLP’s applications with tweaks in its structure</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">MLP的应用与结构上的调整</h1>
<blockquote>原文：<a href="https://medium.com/codex/mlps-applications-with-tweaks-in-its-structure-c9aa3f05578?source=collection_archive---------7-----------------------#2021-10-29">https://medium.com/codex/mlps-applications-with-tweaks-in-its-structure-c9aa3f05578?source=collection_archive---------7-----------------------#2021-10-29</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="4be0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">MLP与其他方法不同的一点是，我们可以调整许多参数，这些参数可以分为两个用途。第一，执行不同的分析，第二，产生更好的性能。在本帖中，我们将探讨第一个问题。但是在我们进入细节之前，让我们回顾一下MLP的结构。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/944e27f2b4efec8dd4a3728d3b679a09.png" data-original-src="https://miro.medium.com/v2/resize:fit:992/format:webp/1*J6SlvC7SZ5tiAwlyNQHetw.png"/></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">MLP结构</figcaption></figure><h1 id="f0a4" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">调整回归结构</h1><p id="d5f7" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated"><strong class="ih hj"><em class="ks">TL；</em>博士</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es kt"><img src="../Images/0b537a8fd182adbf6cc051a2e83a8cf2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KaS9j44kuFruiQ6XMkgZZQ.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">应如何针对回归调整参数的摘要</figcaption></figure></div><div class="ab cl ky kz gp la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="hb hc hd he hf"><h2 id="7d7c" class="lf jq hi bd jr lg lh li jv lj lk ll jz iq lm ln kd iu lo lp kh iy lq lr kl ls bi translated">对输出图层中的变化执行不同的回归</h2><p id="6bf7" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">当你考虑一个回归问题时，你首先想到的可能是预测一个单一的数字。例如，它可以预测房价或工资。这类问题称为单变量回归问题。</p><p id="1564" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是有时候，你需要一次预测多个数值。例如，如果您对图像中苹果的位置感兴趣，</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es lt"><img src="../Images/fb6e50c6bfe0e8d58499f45c9bc3eb40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uJlmJv8b00OOuqaIEFEuzQ.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">多元回归问题的例子</figcaption></figure><p id="9a50" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你需要一个同时预测两个数值的模型:x和y，这类问题称为多元回归问题。</p><p id="e1ec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">根据输出图层的形状，您可以执行其中一项操作。基本规则是MLP预测的每个值对应一个输出神经元。因此，对于单变量回归，MLP的输出层只需要一个输出神经元。为了预测苹果的位置，MLP需要两个输出神经元。</p><div class="je jf jg jh fd ab cb"><figure class="lu ji lv lw lx ly lz paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><img src="../Images/98e4852b00c0982f6f136d1e7abba8ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:932/format:webp/1*dX_YbzZ4bz0kExW7AnGYQA.png"/></div></figure><figure class="lu ji ma lw lx ly lz paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><img src="../Images/07e342bc4ebef9c7fcf97a443e1cb396.png" data-original-src="https://miro.medium.com/v2/resize:fit:1070/format:webp/1*sYhuczIasoZRSdx6Yx5-JA.png"/></div><figcaption class="jl jm et er es jn jo bd b be z dx mb di mc md translated">一元和多元回归的MLP结构</figcaption></figure></div><h2 id="e7a0" class="lf jq hi bd jr lg lh li jv lj lk ll jz iq lm ln kd iu lo lp kh iy lq lr kl ls bi translated">输出神经元的激活功能取决于你想要哪个输出</h2><p id="1897" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">当你在输出神经元中使用激活函数时，你就限制了输出的范围。所以一般来说，你不会在输出神经元中包含激活函数。</p><p id="18f4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是，有些情况下你需要它们。例如，如果你在预测一个价格，那么输出为负是没有意义的。在这种情况下，您可以使用Relu或softplus来确保每个输出都是正的。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es me"><img src="../Images/c08dc528ff58e40bb9634d7bb64993ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6ww5gr_5LRW8mg6bMjkdUg.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">Relu和softplus图</figcaption></figure><p id="9c43" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">另一方面，在预测概率时，您可能希望输出范围从0到1或0到100。在这种情况下，您可以使用logistic或tanh并相应地缩放以获得所需的输出边界。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es mf"><img src="../Images/70e44d0924586a6687a3527f029dcf11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L0id6FUHn4ksIUyUfROc5g.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">逻辑和双曲正切图</figcaption></figure><h2 id="6a0f" class="lf jq hi bd jr lg lh li jv lj lk ll jz iq lm ln kd iu lo lp kh iy lq lr kl ls bi translated">培训期间的回归评估指标</h2><p id="0dee" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">常规指标是计算(实际-预测)平均值的均方误差。但是，如果存在大量异常值，即使模型非常适合非异常值，对实际值和预测值之间的差值求平方也不可避免地会得到较高的值。所以在这种情况下，你可以用平均绝对误差来代替。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mg"><img src="../Images/139ccb16d989e16b5fd2b0791ed15304.png" data-original-src="https://miro.medium.com/v2/resize:fit:1066/format:webp/1*dxXIj0dH6kLDRJ0fsa96KA.png"/></div></figure><h1 id="f0be" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">调整分类结构</h1><p id="e2ad" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated"><strong class="ih hj"><em class="ks">TL；</em>博士</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es mh"><img src="../Images/8c877b39c1e720e926e3d0831b74d7a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BKmOh3qd3HMcU3-nu-UwOQ.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">应如何为分类调整参数的摘要</figcaption></figure></div><div class="ab cl ky kz gp la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="hb hc hd he hf"><h2 id="eb2e" class="lf jq hi bd jr lg lh li jv lj lk ll jz iq lm ln kd iu lo lp kh iy lq lr kl ls bi translated">随着输出层的变化执行不同的分类</h2><p id="7d7b" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">最基本的分类类型是二元分类，它将输出分为两类。例如，对图像是苹果还是橘子进行分类就属于这种分类。在这种情况下，使用逻辑激活函数产生输入属于正类的概率的一个输出神经元就足够了。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mi"><img src="../Images/ec17b9eec076ec2fa1cc8ced3b9cfc26.png" data-original-src="https://miro.medium.com/v2/resize:fit:980/format:webp/1*yd6CqfmzMBRp84t6MROMvQ.png"/></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">二元分类的MLP结构</figcaption></figure><p id="b416" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有时，您可能希望同时对两个二进制类进行分类。例如，作为前面示例的扩展，您还可以同时对水果是大还是小进行分类。在这种情况下，这个问题就变成了一个多标签二进制分类，你需要做的只是简单地添加另一个输出神经元来分类大小。所以每种标签对应一个输出神经元。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mj"><img src="../Images/f2abf533f98e1368b49123bfe17a4cc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1138/format:webp/1*4STCgVZtVPzNAOrWfrV2OA.png"/></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">多标记二元分类的MLP结构</figcaption></figure><p id="6f39" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">或者你可能想对更多的水果进行分类，而不仅仅是苹果和橘子。这种分类称为多类分类。如果您尝试使用与上述相同的激活函数，那么网络将必须比较每一对类，因为逻辑激活函数一次只能比较两个类。因此，如果你的目标是对9种水果进行分类，这将需要36个输出神经元，因为有36种组合。这似乎是一个很小的数字，但是当你想对越来越多的类进行分类时，这就成了一个问题，因为这个数字呈指数增长。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mk"><img src="../Images/f8495f6a06bbd2f6c04ba828891b6d86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/format:webp/1*OYIjMBUQnKW8FTFDCM_waQ.png"/></div></figure><p id="ab45" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，您应该为每个使用softmax激活函数的类使用一个输出神经元，而不是一个具有逻辑激活函数的输出神经元。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ml"><img src="../Images/520d0bb942b33ccc4d240dbf45cd10cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1158/format:webp/1*9_YZ7C6xpcBl2VvL_J4KBQ.png"/></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">多类分类的MLP结构</figcaption></figure><p id="d3de" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是什么是softmax函数呢？</p><h2 id="0860" class="lf jq hi bd jr lg lh li jv lj lk ll jz iq lm ln kd iu lo lp kh iy lq lr kl ls bi translated">输出每个类的概率<strong class="ak">s-soft max函数</strong></h2><p id="aa82" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">简单地说，您可以将softmax函数视为逻辑函数的扩展版本。如上所述，逻辑函数给出了观察值属于两个类之间的正类的概率。与逻辑函数不同，softmax函数给出所有类的概率。所以，如果它输出[0.2，0.7，0.1]，就说明这个观测值极有可能属于第二类。这背后的数学原理是使用下面的等式将隐藏层提供的数字向量转换为概率向量。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mm"><img src="../Images/2e650b5ae131ab4f7010c73f8c40f9ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1274/format:webp/1*SHj__WUV-03DHOImFaTINQ.png"/></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">softmax函数的等式</figcaption></figure><p id="a83a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">例如，如果给定[1，2，3]，您可以将1转换为概率，如下所示。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es mn"><img src="../Images/64631934045de1ef43c1c2aaf3dc88d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1118/format:webp/1*FrUCtuUwulYdnZSz8jn5Sw.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">给定[1，2，3]时的Softmax函数示例</figcaption></figure><p id="e25d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当同样的等式应用于2和3时，它产生大约0.2447和0.665，这些输出最终都加起来是1。</p><h2 id="5420" class="lf jq hi bd jr lg lh li jv lj lk ll jz iq lm ln kd iu lo lp kh iy lq lr kl ls bi translated">培训期间的分类评估指标</h2><p id="cf42" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">由于logistic和softmax函数都输出概率分布，最常见的损失函数是交叉熵，它使用以下公式来测量实际和预测概率分布之间的差异。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es mo"><img src="../Images/b46be0a56b75f45ff3d3667f9913ea04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_COhSS7K2RGHjPFJagksbw.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">p(x)代表真实概率分布，q(x)代表预测概率分布</figcaption></figure><p id="2949" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一个例子可以帮助你理解它的计算是如何工作的，以及一个网络如何在训练中使用它。例如，假设我们有三个类，称为a、b、c，以及一个属于b类的观察值。由于该观察值只能标记为b，因此真实的概率分布可以描述如下。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mp"><img src="../Images/1813e3d30a453766abb3f925530e6563.png" data-original-src="https://miro.medium.com/v2/resize:fit:1054/format:webp/1*NvuAHRpHLUJaHkc2mmsO6Q.png"/></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">真实概率分布</figcaption></figure><p id="4cbf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当这个观察值被传递到网络A中时，该网络产生下面的预测概率分布。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mq"><img src="../Images/e3e0c7b010d68a9433928ab0b784434c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1040/format:webp/1*dvlRVgoTWXVbVK53RqLHzA.png"/></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">预测概率分布A</figcaption></figure><p id="6519" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">既然我们有了真实的和预测的概率分布，我们可以计算它的交叉熵。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es mr"><img src="../Images/ccfb10d7709500e42f99764ec3702507.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MALDcLtN03aNouLEkTQAPg.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">给定[0.2，0.7，0.1]时计算交叉熵</figcaption></figure><p id="164b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是当观察结果被传入网络B时，就会产生一个不同的预测概率分布。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ms"><img src="../Images/f32af04626ffe079117d7ded51070637.png" data-original-src="https://miro.medium.com/v2/resize:fit:1036/format:webp/1*aDpnj71IhmLtV4JTc4sCSw.png"/></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">预测概率分布B</figcaption></figure><p id="62fa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">利用这个概率分布，我们得到如下所示的交叉熵值0.693。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es mt"><img src="../Images/12541add975d54cc80729a3b8f97584e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D6tlmXubBzkp8EYhUI9lYQ.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">给定[0.4，0.5，0.1]时计算交叉熵</figcaption></figure><p id="bc05" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在两个网络之间，A的交叉熵值比B低。当我们研究概率分布时，A的预测概率分布比B的更接近真实概率分布。这意味着给出较低交叉熵值的网络更能描述真实的关系。因此，它更有可能在训练中被选中。所以在我们的例子中，更好的网络是a。</p></div><div class="ab cl ky kz gp la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="hb hc hd he hf"><h1 id="24f5" class="jp jq hi bd jr js mu ju jv jw mv jy jz ka mw kc kd ke mx kg kh ki my kk kl km bi translated">参考</h1><p id="7e6b" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">[1]j .布朗利(2020年12月22日)。<em class="ks">机器学习交叉熵的温和介绍</em>。机器学习精通。检索于2021年10月27日，来自<a class="ae mz" href="https://machinelearningmastery.com/cross-entropy-for-machine-learning/." rel="noopener ugc nofollow" target="_blank">https://machinelingmastery . com/cross-entropy-for-machine-learning/。</a></p><p id="3303" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">[2]j .布朗利(2020年6月23日)。<em class="ks">用python实现Softmax激活功能</em>。机器学习精通。检索于2021年10月27日，来自<a class="ae mz" href="https://machinelearningmastery.com/softmax-activation-function-with-python/." rel="noopener ugc nofollow" target="_blank">https://machinelementmastery . com/soft max-activation-function-with-python/。</a></p><p id="ee1c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">[3]杰龙，A. (2017)。<em class="ks">用Scikit-Learn、Keras &amp; TensorFlow进行动手机器学习:构建智能系统的概念、工具和技术</em>。奥赖利。</p><p id="f456" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">[4] stackoverflowuser2010。(2017年2月1日)。<em class="ks">什么是交叉熵？</em>堆栈溢出。2021年10月27日检索，来自<a class="ae mz" href="https://stackoverflow.com/questions/41990250/what-is-cross-entropy/41990932." rel="noopener ugc nofollow" target="_blank">https://stack overflow . com/questions/41990250/what-is-cross-entropy/41990932。</a></p></div></div>    
</body>
</html>