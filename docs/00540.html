<html>
<head>
<title>Azure function Eventhub trigger: Checkpoint</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Azure函数Eventhub触发器:检查点</h1>
<blockquote>原文：<a href="https://medium.com/codex/azure-function-eventhub-trigger-checkpoint-12d5c2e48778?source=collection_archive---------3-----------------------#2021-02-23">https://medium.com/codex/azure-function-eventhub-trigger-checkpoint-12d5c2e48778?source=collection_archive---------3-----------------------#2021-02-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><h2 id="3119" class="hg hh hi bd b fp hj hk hl hm hn ho dx hp translated" aria-label="kicker paragraph"><a class="ae ge" href="http://medium.com/codex" rel="noopener">法典</a></h2><div class=""/><p id="88f4" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">在这篇文章中，我将谈论Azure函数EventHub trigger，它实际上是引擎盖下的检查点，最后，你可以如何轻松地从头开始阅读它。所以，让我们开始吧…</p><p id="7ff0" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated"><strong class="iq hs"> Azure function: </strong> It <strong class="iq hs"> </strong>是一个无服务器解决方案，支持多种类型的输入和/或输出绑定。其中一个输入绑定是EventHub触发器。使用这个输入绑定，用户可以用更少的代码从EventHub中读取事件/消息。</p><p id="840c" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated"><strong class="iq hs">检查点:</strong>检查点有什么大惊小怪的。为什么它很重要？嗯，检查点理论上是一种机制，每个消费者通过它存储最后读取的事件位置。一旦存储了检查点，当函数下次触发时，它将实际从最后存储的检查点读取。而且，如果您搞砸了这个检查点文件，事情可能会变得非常糟糕。</p><p id="5ac7" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">现在，您可以想象每个消费者可能都有自己存储检查点的方式——甚至可以选择存储在SQL数据库中。但是，azure function EventHub触发器扩展实际上将存储帐户中的检查点(即应用程序设置AzureWebJobsStorage的值)作为名为“<em class="jm"> azure-webjobs-eventhub”的容器下每个分区的blob文件。</em></p><p id="a6a9" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">请参考下面的示例截图，其中有2个blobs，每个分区一个。是的，你没看错——如果Eventhub有10个分区，那么就有10个blob文件。</p><figure class="jo jp jq jr fd js er es paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="er es jn"><img src="../Images/106b17b94a7b671a6cb18ec229f39636.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tOXZO73XevleRK1YKclo5Q.png"/></div></div><figcaption class="jz ka et er es kb kc bd b be z dx translated">检查点blob文件</figcaption></figure><p id="0d2a" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">所以，我们来说重点。如何移除检查点并从头开始读取事件。答案很简单:</p><ol class=""><li id="1b16" class="kd ke hi iq b ir is iv iw iz kf jd kg jh kh jl ki kj kk kl bi translated">停止Azure函数app，等待租赁状态为空</li><li id="2e47" class="kd ke hi iq b ir km iv kn iz ko jd kp jh kq jl ki kj kk kl bi translated">转到存储帐户下的<em class="jm"> azure-webjobs-eventhub </em>容器</li><li id="4422" class="kd ke hi iq b ir km iv kn iz ko jd kp jh kq jl ki kj kk kl bi translated">导航至您感兴趣的<eventhub namespace=""> / <cosumer_group/></eventhub></li><li id="d728" class="kd ke hi iq b ir km iv kn iz ko jd kp jh kq jl ki kj kk kl bi translated">选择所有斑点并删除</li><li id="b503" class="kd ke hi iq b ir km iv kn iz ko jd kp jh kq jl ki kj kk kl bi translated">最后…启动功能</li></ol><p id="cc9f" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">干得好的..您现在已经学会了如何删除检查点以从头开始读取…</p><p id="264d" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">请记住，删除这个检查点blob文件意味着您将再次读取相同的消息，并可能复制下游系统。在生产环境中练习时，请格外小心。</p><p id="12be" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">暂时就这样了。请随时发表您的评论/问题:)</p></div></div>    
</body>
</html>