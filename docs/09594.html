<html>
<head>
<title>Hack The Boo: Wrong Spooky Season</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">黑客嘘:错误的幽灵季节</h1>
<blockquote>原文：<a href="https://medium.com/codex/hack-the-boo-wrong-spooky-season-3609cf3dc1fc?source=collection_archive---------24-----------------------#2022-10-28">https://medium.com/codex/hack-the-boo-wrong-spooky-season-3609cf3dc1fc?source=collection_archive---------24-----------------------#2022-10-28</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/80fbc19924a02b981cde7ad0f31a2c9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*4iCCNx6HGMxze-3bopiYcw.png"/></div></figure><p id="e17a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这是我写的黑客布CTF的错误幽灵季法医挑战。在这个挑战中，我们被要求分析pcap以检测任何入侵。</p><figure class="jl jm jn jo fd ij er es paragraph-image"><div class="er es jk"><img src="../Images/baed794c9c9ee174089f2d4c6cff1a2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:698/format:webp/1*KtR0_I_7FVc-dsM-8lRCEA.png"/></div></figure><p id="a312" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">首先，我们下载文件并查看pcap。观察协议层次结构，我们看到只有TCP流量，在它上面的更高层，我们可以看到HTTP流量，让我们检查一下。</p><figure class="jl jm jn jo fd ij er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es jp"><img src="../Images/f7216cf6cbe2f4fa6e47c64625da1a0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CsoRn17_QvMIE1oxQhR6zg.png"/></div></div></figure><p id="26b0" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">让我们使用HTTP statistics选项来快速查看一下发出的请求。我们可以看到几个使用cmd参数将命令传递给端点的请求。</p><figure class="jl jm jn jo fd ij er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es ju"><img src="../Images/e488ea22e304795da7c2d9e73d551558.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-YgBwACGcjI0xsw3RSYgVQ.png"/></div></div></figure><p id="d6a4" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在其中一个请求中，我们可以看到攻击者如何试图用socat打开一个反向外壳。让我们更仔细地看看这个调用，然后跟踪TCP流。</p><figure class="jl jm jn jo fd ij er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es jv"><img src="../Images/85749dd1bfbccda670ef6c0e490e3feb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FdBRSLVpiS7recJpZqf3lA.png"/></div></div></figure><p id="e027" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">通过查看这些命令，我们可以找到在将后门添加到。在/bin/bash中的SUID之前，使用Cyberchef恢复它。</p><figure class="jl jm jn jo fd ij er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es jw"><img src="../Images/a757468e8caff2f1e9f3a056b2388e18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zT-CrDBVubxVQomYcF7piw.png"/></div></div></figure><p id="8485" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我希望你喜欢这篇文章，并了解一些新的:D</p></div></div>    
</body>
</html>