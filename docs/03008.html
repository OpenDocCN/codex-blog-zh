<html>
<head>
<title>Wonder how a Recommendation System works?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">想知道推荐系统是如何工作的吗？</h1>
<blockquote>原文：<a href="https://medium.com/codex/wonder-how-a-recommendation-system-works-5731a88ebf10?source=collection_archive---------14-----------------------#2021-08-14">https://medium.com/codex/wonder-how-a-recommendation-system-works-5731a88ebf10?source=collection_archive---------14-----------------------#2021-08-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/9d35c4bc7185984852fc016e4917bb8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qG-omMYuXVrtxelbtClUZQ.png"/></div></div></figure><p id="6f8a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们在日常生活中都广泛使用网飞、YouTube和亚马逊。想知道推荐系统是如何工作的吗？随着时间的推移，这些建议似乎变得越来越个性化。当然，为什么不呢？</p><p id="7ddf" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们给电影评分，喜欢/不喜欢视频/购买产品。现在有很多数据，但是这些数据足以构建一个健壮的推荐系统吗？</p><p id="b318" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">本文将概述如何为我们的应用程序构建推荐系统。我不会深究数学，会尽量保持简单。</p><p id="78a2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我想谈谈两种主要的推荐系统技术。</p><p id="52cb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="jo"> 1。基于内容的推荐</em></p><p id="e444" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="jo"> 2。协同过滤</em></p><p id="4725" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们谈一点关于基于内容的推荐系统，然后我将谈到协作过滤技术，<em class="jo">数学魔术。</em></p><p id="6fec" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">基于内容的推荐到底是什么意思？我们如何将此建模为机器学习问题？</p><p id="e3f4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">推荐系统通常有两个主要部分。一个是用户，一个是产品。亚马逊、网飞、YouTube拥有数百万用户和数百万产品、电影/纪录片/连续剧、视频。</p><p id="99ae" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们可以将我们的数据可视化为一个数据矩阵(在整篇文章中，我将使用D来指代这个矩阵)，其中每行表示一个用户，每列表示一个产品，反之亦然。在这两种情况下，这个矩阵的规模都将是巨大的，当我说巨大，我的意思是非常巨大。这个N×M矩阵中的每个单元格代表什么？(N:用户数量，M:产品数量)。这些单元格值可以是评级，也可以是布尔值(真/假)，比如一个人是否看过视频，或者他/她是否看过视频。</p><p id="ca1e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这个矩阵将会非常稀疏。为什么？你在网飞网站上给多少部电影评级，或者你喜欢或不喜欢多少部视频？很少，并且这种行为在大多数用户中是相似的，使得这个数据矩阵非常非常稀疏。</p><p id="78bc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在基于内容的推荐系统中，你必须为用户和产品提出特征向量。</p><p id="ab8c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然后，您将利用这些特征向量来预测数据矩阵值(即，一个人是否会对一部电影给出1、2、3、4或5星评级，或者他/她是否会观看某个特定的视频)。这简单地归结为一个标准的分类/回归问题。</p><p id="6924" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这种建立推荐系统的方式有一个小问题。通常，数据矩阵D将非常稀疏，并且进入训练集的数据点的比例将大大少于进入测试集的数据点。我们如何确保我们的基于内容的推荐系统是健壮的？</p><p id="1299" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">好了，让我们跳到另一个优雅的技术:协同过滤。</p><p id="2e91" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我更愿意称之为数学的魔力。机器学习是一个确实从许多其他领域借用了一些想法的领域，比如统计、数学、概率、热力学等等。</p><p id="e009" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">有一种叫做矩阵分解的技术可以用来构建一个基于协同过滤的推荐系统。</p><h2 id="51ad" class="jp jq hi bd jr js jt ju jv jw jx jy jz jb ka kb kc jf kd ke kf jj kg kh ki kj bi translated">矩阵分解简介；</h2><p id="b841" class="pw-post-body-paragraph iq ir hi is b it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj ko jl jm jn hb bi translated">假设我们有数据矩阵/评级矩阵(D):我们可以把它写成两个独立矩阵U和P-转置的乘积。这和我们写10 = 2 * 5非常相似。矩阵U &amp; P转置被认为是数据矩阵d的因子。</p><p id="b0d8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">N * M (N:用户数量，M:产品数量，D:包含我们评级的稀疏矩阵)</p><p id="a814" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du kp kq kr ks b">Dimensions of Matrix U:</code> N * f</p><p id="fe72" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du kp kq kr ks b">Dimensions of Matrix P:</code> M * f，暗示P-转置将具有f * M的维数</p><p id="b045" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我将使用P.T作为P-转置的简称。</p><p id="b18c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">(先不要担心f，它是一个超参数，我们可以以后再调)</p><p id="966c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我会讲到为什么我们有时需要这些矩阵，但是让我们想想如何找到这些矩阵U &amp; P。</p><p id="b458" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们在机器学习中解决优化问题，不是吗？是的，我们可以使用随机梯度下降来找到这些矩阵。我们的损失将在所有非空数据点上求和(以D表示的等级)，</p><p id="ec01" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du kp kq kr ks b">(over all non-empty cells of D):</code> ∑ [(Dij — Ui * Pj。T) ^ 2】。</p><p id="3a08" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du kp kq kr ks b">Dij:</code>用户I对商品j给出的非空评分</p><p id="3162" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du kp kq kr ks b">Ui:</code>矩阵U的第I行表示用户I的f维向量</p><p id="1cd9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du kp kq kr ks b">Pj:</code>矩阵P的第j行或P.T的第j列(P的转置)。这也是一个f维向量。</p><p id="9058" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">好，现在我们有了矩阵U &amp; P。</p><p id="d9aa" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">U &amp; P.T是我们的数据矩阵D的因子，意味着U x P.T = D，当然有一些微小的误差。(损失不总是零)。</p><p id="7d58" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们填充d中的空单元格。</p><p id="5071" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果我们希望填充D (2，3)，我们将取向量U (2)和P (3)的点积。D (2，3)是什么意思？这是用户U (2)对产品P (3)的预测评分。</p><p id="7539" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们现在有一个矩阵D，所有的评级都在里面。现在，我想继续向用户推荐电影/视频是非常容易和直接的。</p><p id="0a75" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因为D是填充的(没有空单元格)，所以我们可以对每个用户的列值(即每行)进行排序。这就是协同过滤的工作原理。<em class="jo">这个魔术不是用数学完成的吗？</em>😀</p><p id="8906" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在结束本文之前，我选择了U和P这两个名字，以便让事情看起来更直观。</p><p id="824e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">N * f矩阵表示所有N个用户的f维特征向量。</p><p id="b006" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du kp kq kr ks b">P:</code> M * f矩阵表示所有M个产品/视频/电影的f维特征向量。</p><p id="d1bb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">希望你喜欢！！😀</p></div></div>    
</body>
</html>