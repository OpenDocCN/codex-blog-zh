<html>
<head>
<title>iOS Interview: Singleton Design Pattern (Understanding, Implementation)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">iOS访谈:单一设计模式(理解、实现)</h1>
<blockquote>原文：<a href="https://medium.com/codex/ios-interview-singleton-design-pattern-understanding-implementation-d283fb2c305b?source=collection_archive---------5-----------------------#2022-05-05">https://medium.com/codex/ios-interview-singleton-design-pattern-understanding-implementation-d283fb2c305b?source=collection_archive---------5-----------------------#2022-05-05</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/579483a40e08e4ba0ab642d207b8e9d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wTcpi55qKufrPPpZ_JKSNQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">一个</figcaption></figure><p id="38a0" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">许多设计模式目前在apple swift中很流行)但是apple在文档中没有显示任何设计模式，但是他们在列表中提到了singleton[<a class="ae js" href="https://developer.apple.com/documentation/swift/cocoa_design_patterns" rel="noopener ugc nofollow" target="_blank">设计模式</a> ]，如果你愿意，他们的许多SDK也遵循Singleton模式。</p><ul class=""><li id="a6f9" class="jt ju hi iw b ix iy jb jc jf jv jj jw jn jx jr jy jz ka kb bi translated">UIApplication.shared</li><li id="52fb" class="jt ju hi iw b ix kc jb kd jf ke jj kf jn kg jr jy jz ka kb bi translated">用户默认值.标准</li><li id="1b5b" class="jt ju hi iw b ix kc jb kd jf ke jj kf jn kg jr jy jz ka kb bi translated">FileManager.default</li><li id="1441" class="jt ju hi iw b ix kc jb kd jf ke jj kf jn kg jr jy jz ka kb bi translated">URLSession.shared</li><li id="935d" class="jt ju hi iw b ix kc jb kd jf ke jj kf jn kg jr jy jz ka kb bi translated">OperationQueue.main</li></ul><p id="7b8c" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">因此，让我们了解什么是单体设计模式，以及何时以及如何实现单体设计模式。</p><p id="d17f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">当你在维基百科上搜索单例类时，维基会说“<strong class="iw hj">单例模式</strong>是一种软件设计模式，它将一个类的实例化限制为一个“单个”实例。【<a class="ae js" href="https://en.wikipedia.org/wiki/Singleton_pattern" rel="noopener ugc nofollow" target="_blank">来源</a><em class="kh"/></p><p id="715d" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">虽然苹果的官方文件称“单例模式(singleton pattern)使用单个共享类实例(source)提供对共享资源的访问”。</p><p id="bf65" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">你发现维基百科和苹果对Singleton的说法有什么不同吗？。两者之间唯一的区别是苹果没有说我们不能只做一个单例类的实例，是的，这就是苹果的情况。</p><p id="4c9f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">让我们借助代码来理解这一点:</p><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ki"><img src="../Images/0cd65bd7940488117af7194262952c67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G45LK_1bF0dhgLF4GmJj4Q.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">单例类</figcaption></figure><p id="516e" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我已经创建了一个Singleton类名manager，并用共享实例的名称创建了一个Manager的静态实例，还向Manager singleton类添加了name属性。</p><p id="3678" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">Manager singleton类的sharedManager属性允许我们在任何地方访问它，通过这种方式，我们还可以借助共享管理器来访问name属性。</p><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kn"><img src="../Images/c06d7e750846b6f39cdc06967e99c809.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HWXqUF0wfJi0vYgrCNtuGw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">获取管理器单例类的实例</figcaption></figure><p id="a874" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">从上面我们可以看到，我们在第一行得到了一个经理的实例，从这个实例中，我们可以打印出经理的名字。现在，我将使用实例更改name属性值</p><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ko"><img src="../Images/98ffc1763c512e27fc44f337512e0f34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xiwOPnG_BjagXTBPXNHouA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">更新属性</figcaption></figure><p id="ca8d" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在，管理器名称更改为Not veer，之前用“veer”初始化。</p><p id="8141" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在，如果我们通过直接创建一个对象来为Manger创建另一个实例，我们仍然可以看到它的名字是“Veer ”,这意味着我们可以创建单例类的多个实例。</p><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kp"><img src="../Images/04add3c0c1bb50d34ae21d44e72f26fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PCecePSWaiBpBDZDRGZmoQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">创建管理器类的对象</figcaption></figure><p id="73d9" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">因此，我们如何避免创建任何单例类的多个实例，以及如果创建任何单例类的另一个实例，我们如何引用同一个对象。</p><p id="530c" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">Singleton类的关键原则是给它一个私有的初始化器，这样任何地方的任何人都不能为Singleton类创建其他实例，所以如果我们像下面这样修改代码:</p><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kq"><img src="../Images/d1e994bfc77f0b454fff56ec4eac0eb2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y-zEtStgEJ97GmlOH4CZgA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">初始化singleton的新实例时出错</figcaption></figure><p id="e696" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我们可以看到Xcode不喜欢创建另一个Manager类的实例，因为它是不可访问的，因为它是一个私有的初始化器。当我们使用共享实例属性创建另一个管理器时，我们可以看到我们现在指向同一个对象，因为管理器1和管理器2的名称将与“Not Veer”相同。</p><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kr"><img src="../Images/b925d32812a7b58d8952b3473d4e0ac9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r33IzSOZWzlu45dAcPTFDw.png"/></div></div></figure><p id="ee84" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">所以单个类的主要目的是<strong class="iw hj">将对象创建的数量限制为只有一个</strong>。这通常可以确保对资源的访问控制，例如，在套接字或数据库连接中，我们可以创建一个sharedManager或sharedSocket，这样我们就只为数据库或套接字创建一个对象。</p><p id="72bd" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> <em class="kh">如果您喜欢这个，点击💚所以其他人会在媒体上看到这个。如果你有任何合唱团或建议，请随时评论或在Twitter上打我。</em> </strong></p></div></div>    
</body>
</html>