<html>
<head>
<title>DolphinScheduler can schedule workflows with Python scripts!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">DolphinSchedulerå¯ä»¥ç”¨Pythonè„šæœ¬è°ƒåº¦å·¥ä½œæµï¼</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/codex/dolphinscheduler-can-schedule-workflows-with-python-scripts-a882fdd2d862?source=collection_archive---------3-----------------------#2022-12-09">https://medium.com/codex/dolphinscheduler-can-schedule-workflows-with-python-scripts-a882fdd2d862?source=collection_archive---------3-----------------------#2022-12-09</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/9cf8e703648b8098bb222e17572b453b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JPTuZpYIBP9kOTBZbZ1eQQ.png"/></div></div></figure><blockquote class="iq"><p id="7ba0" class="ir is hi bd it iu iv iw ix iy iz ja dx translated">éšç€2.0.5ç‰ˆæœ¬çš„å‘å¸ƒï¼ŒApache DolphinSchedulerå¢åŠ äº†Python APIå‡½æ•°ï¼Œä½¿ç”¨æˆ·èƒ½å¤Ÿé€šè¿‡Pythonè„šæœ¬å®‰æ’å·¥ä½œæµï¼Œä»¥åˆ›å»ºã€æ›´æ–°å’Œè°ƒåº¦å·¥ä½œæµã€‚é‚£å¯¹Pythonç”¨æˆ·æ¥è¯´å°±æ–¹ä¾¿å¤šäº†ï¼</p></blockquote><p id="cd08" class="pw-post-body-paragraph jb jc hi jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ja hb bi translated">Apache DolphinScheduleræ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼ã€é«˜å¯æ‰©å±•ã€å¯è§†åŒ–çš„å¼€æºå·¥ä½œæµä»»åŠ¡è°ƒåº¦æ¡†æ¶ï¼Œé€‚ç”¨äºä¼ä¸šçº§åº”ç”¨æ¡ˆä¾‹ï¼Œä¸ºå¯è§†åŒ–çš„ä»»åŠ¡æ“ä½œã€å·¥ä½œæµè°ƒåº¦ä»¥åŠæ•´ä¸ªæ•°æ®å¤„ç†è¿‡ç¨‹æä¾›å¯è§†åŒ–çš„è§£å†³æ–¹æ¡ˆã€‚</p><p id="adcc" class="pw-post-body-paragraph jb jc hi jd b je jy jg jh ji jz jk jl jm ka jo jp jq kb js jt ju kc jw jx ja hb bi translated">Apache DolphinScheduleræä¾›äº†ä¸°å¯Œçš„ç»„ä»¶ï¼Œå…è®¸ç”¨æˆ·è°ƒç”¨MRã€SageMakerã€DMSã€DataSyncç­‰AWSæœåŠ¡ï¼Œä»¥åŠSparkã€Flinkã€Hiveç­‰ç§æœ‰éƒ¨ç½²çš„æœåŠ¡ï¼›å®ƒè¿˜ä¸ºæ ¸å¿ƒè°ƒåº¦åœºæ™¯æä¾›äº†å·¥å…·ï¼Œå¦‚å¤±è´¥é‡è¯•ã€å¤±è´¥è­¦æŠ¥ã€ä»»åŠ¡SLAã€å¤æ‚ä¾èµ–å¤„ç†ç­‰ã€‚ï¼›å®ƒè¿˜æä¾›äº†ä¸°å¯Œçš„è°ƒåº¦åŠŸèƒ½ï¼Œå¦‚å¤–éƒ¨èµ„æºæ–‡ä»¶ç®¡ç†ã€é›†ç¾¤ç‰©ç†æœºèµ„æºç›‘æ§ï¼›ä»¥åŠç”¨äºå¤–éƒ¨ç›‘æ§çš„å„ç§åº¦é‡ã€‚</p><h1 id="de9c" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">Dolphinè°ƒåº¦å™¨Python API</h1><p id="42ba" class="pw-post-body-paragraph jb jc hi jd b je lb jg jh ji lc jk jl jm ld jo jp jq le js jt ju lf jw jx ja hb bi translated">ä½¿ç”¨Python APIï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡Pythonè„šæœ¬æ¥å®‰æ’å·¥ä½œæµï¼Œä»¥åˆ›å»ºã€æ›´æ–°å’Œè°ƒåº¦å·¥ä½œæµç­‰ã€‚</p><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lg"><img src="../Images/c4096e06c373c30617085055d6ac61ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*QfQeiPe731H3CtyD"/></div></div></figure><h2 id="407f" class="ll ke hi bd kf lm ln lo kj lp lq lr kn jm ls lt kr jq lu lv kv ju lw lx kz ly bi translated">å®‰è£…</h2><p id="da8f" class="pw-post-body-paragraph jb jc hi jd b je lb jg jh ji lc jk jl jm ld jo jp jq le js jt ju lf jw jx ja hb bi translated">æ‚¨å¯ä»¥é€šè¿‡pipè½»æ¾æ–¹ä¾¿åœ°å®‰è£…PyDolphinScheduler:</p><pre class="lh li lj lk fd lz ma mb bn mc md bi"><span id="e1f6" class="me ke hi ma b be mf mg l mh mi">python -m pip install apache-dolphinscheduler</span></pre><h2 id="d3c3" class="ll ke hi bd kf lm ln lo kj lp lq lr kn jm ls lt kr jq lu lv kv ju lw lx kz ly bi translated">å¥”è·‘</h2><p id="04a4" class="pw-post-body-paragraph jb jc hi jd b je lb jg jh ji lc jk jl jm ld jo jp jq le js jt ju lf jw jx ja hb bi translated">æˆ‘ä»¬æä¾›äº†ç°æˆçš„ç¤ºä¾‹ï¼Œç”¨æˆ·å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è¿è¡ŒPython API:</p><pre class="lh li lj lk fd lz ma mb bn mc md bi"><span id="8b20" class="me ke hi ma b be mf mg l mh mi">wget https://raw.githubusercontent.com/apache/dolphinscheduler/dev/dolphinscheduler-python/pydolphinscheduler/src/pydolphinscheduler/examples/tutorial.py<br/>python tutorial.py</span></pre><h1 id="20ae" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">Python APIå‡½æ•°</h1><p id="285d" class="pw-post-body-paragraph jb jc hi jd b je lb jg jh ji lc jk jl jm ld jo jp jq le js jt ju lf jw jx ja hb bi translated">Python APIæä¾›äº†æˆ‘ä»¬å¯ä»¥åœ¨DolphinScheduler Web UIä¸­ç›´æ¥æ“ä½œçš„æ‰€æœ‰åŠŸèƒ½ï¼Œæ¯”å¦‚å·¥ä½œæµåˆ›å»ºã€ä»»åŠ¡åˆ›å»ºã€å·¥ä½œæµè°ƒåº¦ã€èµ„æºæ–‡ä»¶å®ç”¨ç¨‹åºã€å‚æ•°ä¼ é€’ç­‰ã€‚ç›®å‰æ”¯æŒDolphinSchedulerä¸­å¤§éƒ¨åˆ†ä»»åŠ¡ç±»å‹ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡Python APIä½“éªŒDolphinSchedulerçš„å¤§éƒ¨åˆ†æ ¸å¿ƒåŠŸèƒ½ã€‚</p><p id="d73f" class="pw-post-body-paragraph jb jc hi jd b je jy jg jh ji jz jk jl jm ka jo jp jq kb js jt ju kc jw jx ja hb bi translated">å¦‚æœæˆ‘ä»¬æƒ³è¦é€šè¿‡DolphinScheduler Python APIåˆ›å»ºå¹¶è¿è¡ŒDolphinSchedulerå·¥ä½œæµï¼Œæˆ‘ä»¬éœ€è¦é¦–å…ˆå¯åŠ¨DolphinScheduleræœåŠ¡ï¼Œè¯¥æœåŠ¡å¯ä»¥åœ¨<a class="ae mj" href="https://dolphinscheduler.apache.org/python/dev/start.html#start-python-gateway-service" rel="noopener ugc nofollow" target="_blank">https://dolphin scheduler . Apache . org/Python/dev/start . html # start-Python-gateway-service</a>æ‰¾åˆ°ï¼Œä»¥æ£€æŸ¥å®ƒæ˜¯å¦‚ä½•å®‰è£…å’Œè¿è¡Œçš„ã€‚æœ¬æ–‡ä¸»è¦å¸¦ä½ é¢†ç•¥Python APIçš„é­…åŠ›ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†é‡ç‚¹è®²è§£Python APIä»»åŠ¡ã€‚</p><h1 id="7625" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">ä¾‹å­</h1><p id="dd95" class="pw-post-body-paragraph jb jc hi jd b je lb jg jh ji lc jk jl jm ld jo jp jq le js jt ju lf jw jx ja hb bi translated">è¿™æ˜¯ä¸€ä¸ªå¦‚ä½•ä½¿ç”¨Python APIè¿è¡ŒDolphinSchedulerå·¥ä½œæµçš„ä¾‹å­ã€‚æˆ‘ä»¬éœ€è¦ä»å®˜ç½‘ä¸‹è½½èµ„æºï¼Œåšä¸€äº›è®¡ç®—ã€‚</p><p id="4ac7" class="pw-post-body-paragraph jb jc hi jd b je jy jg jh ji jz jk jl jm ka jo jp jq kb js jt ju kc jw jx ja hb bi translated"><strong class="jd hj">æ¦‚è¿°</strong></p><p id="2b52" class="pw-post-body-paragraph jb jc hi jd b je jy jg jh ji jz jk jl jm ka jo jp jq kb js jt ju kc jw jx ja hb bi translated">ä»¥ä¸‹æ˜¯æˆ‘ä»¬ä»£ç çš„æ¦‚è¿°ã€‚åœ¨è¿™ä¸ªè„šæœ¬ä¸­ï¼Œç”¨æˆ·éœ€è¦ä¸‹è½½DolphinScheduleræºä»£ç ï¼Œç„¶åæ‰¾åˆ°æœ€å¤§çš„æ–‡ä»¶å’Œæœ€å¸¸è§çš„æ–‡ä»¶æ‰©å±•åã€‚è¦åšåˆ°è¿™ä¸€ç‚¹éœ€è¦ä¸‰ä¸ªæ­¥éª¤ã€‚æ‰€æœ‰çš„æ­¥éª¤åœ¨DolphinSchedulerä¸­éƒ½å«åšâ€œä»»åŠ¡â€ï¼Œæˆ‘ä»¬è¦å®Œæˆçš„æ•´ä¸ªå·¥ä½œå«åšâ€œProcessDefinitionâ€ã€‚</p><p id="db5a" class="pw-post-body-paragraph jb jc hi jd b je jy jg jh ji jz jk jl jm ka jo jp jq kb js jt ju kc jw jx ja hb bi translated">é™¤äº†è¿™3ä¸ªä¸»è¦æ­¥éª¤ï¼Œæˆ‘ä»¬è¿˜æœ‰ä¸€äº›é¢å¤–çš„æ­¥éª¤æ¥å‡†å¤‡æˆ‘ä»¬çš„ç¯å¢ƒï¼Œå¹¶ç¡®ä¿ä¸»è¦æ­¥éª¤æ­£å¸¸å·¥ä½œã€‚æ¯”å¦‚æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªæ–°çš„ç›®å½•æ¥ä¿å­˜ä»å®˜ç½‘è·å–çš„èµ„æºï¼Œå¹¶ä¿è¯ä¼ å…¥çš„å‹ç¼©åŒ…ä¸ä¸ç°æœ‰ç¯å¢ƒå†²çªã€‚ä¸‹è½½èµ„äº§åï¼Œæˆ‘ä»¬éœ€è¦å‹ç¼©å®ƒï¼Œå¹¶ä»tarballä¸­æå–å†…å®¹ã€‚</p><pre class="lh li lj lk fd lz ma mb bn mc md bi"><span id="690b" class="me ke hi ma b be mf mg l mh mi">from pydolphinscheduler.core.process_definition import ProcessDefinition<br/>from pydolphinscheduler.tasks.python import Python<br/>from pydolphinscheduler.tasks.shell import Shell<br/>download_dir = "/tmp/demo"<br/>store_dir = "dolphinscheduler"<br/>download_link = "https://github.com/apache/dolphinscheduler/archive/refs/heads/dev.zip"<br/>file_name = download_link. split("/")[-1]<br/>def largest_size():<br/>     from pathlib import Path<br/>     download_dir = "/tmp/demo"<br/>     store_dir = "dolphinscheduler"<br/>     result = (None, 0)<br/>     paths = Path(download_dir).joinpath(store_dir).glob("**/*")<br/>     for path in paths:<br/>         # skip is path is directory<br/>         if path.is_dir():<br/>             continue<br/>         file_size = path.stat().st_size<br/>         if result[0] is None or file_size &gt; result[1]:<br/>             result = (path.name, file_size)<br/>     print(result)<br/>def most_frequently():<br/>     from pathlib import Path<br/>     download_dir = "/tmp/demo"<br/>     store_dir = "dolphinscheduler"<br/>     ext_cnt = {}<br/>     paths = Path(download_dir).joinpath(store_dir).glob("**/*")<br/>     for path in paths:<br/>         # skip is path is directory<br/>         if path.is_dir():<br/>             continue<br/>         ext = path.suffix<br/>         ext_cnt[ext] = ext_cnt[ext] + 1 if ext in ext_cnt else 1<br/>     print(max(ext_cnt.items(), key=lambda p: p[1]))<br/>with ProcessDefinition(<br/>         name="top_ten_size_files",<br/>         tenant="zhongjiajie",<br/>) as pd:<br/>     prepare = Shell(<br/>         name="prepare_dir",<br/>         command=f"mkdir -p {download_dir}; rm -rf {download_dir}/*"<br/>     )<br/>     download = Shell(<br/>         name="download_resources",<br/>         command=f"wget -P {download_dir} {download_link}"<br/>     )<br/>     compress = Shell(<br/>         name="compress_tar",<br/>         command=f "cd {download_dir}; unzip {file_name} -d {store_dir}"<br/>     )<br/>     largest_file = Python(<br/>         name="largest_file",<br/>         definition=largest_size,<br/>     )<br/>     most_type = Python(<br/>         name="most_type",<br/>         definition=most_frequently,<br/>     )<br/>     prepare &gt;&gt; download &gt;&gt; compress &gt;&gt; [<br/>         largest_file,<br/>         most_type,<br/>     ]<br/>     pd. run()</span></pre><h1 id="d16e" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">ä¸‹è½½èµ„æº</h1><p id="9558" class="pw-post-body-paragraph jb jc hi jd b je lb jg jh ji lc jk jl jm ld jo jp jq le js jt ju lf jw jx ja hb bi translated">åœ¨è¿™ä¸ªä»»åŠ¡ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨shellå‘½ä»¤wgetä»GitHubä¸‹è½½èµ„æºï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•åœ°ä½¿ç”¨PyDolphinSchedulerçš„å†…ç½®shellå°†wgetå‘½ä»¤ä¼ é€’ç»™parameterå‘½ä»¤ã€‚</p><p id="6b5a" class="pw-post-body-paragraph jb jc hi jd b je jy jg jh ji jz jk jl jm ka jo jp jq kb js jt ju kc jw jx ja hb bi translated">æ‚¨å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œä½¿ç”¨äº†åä¸ºdownload_dirå’Œdownload_linkçš„Pythonå˜é‡ï¼Œä»¥ä½¿æˆ‘ä»¬çš„ä»£ç å¯ç»´æŠ¤ã€‚å®é™…è¿è¡Œçš„å‘½ä»¤æ˜¯wget-P/tmp/demo<a class="ae mj" href="https://github.com/apache/dolphinscheduler/archive/refs" rel="noopener ugc nofollow" target="_blank">https://github.com/apache/dolphinscheduler/archive/refs</a>/heads/dev . zipã€‚å®Œæˆåï¼ŒDolphinScheduleræºä»£ç å°†è¢«ä¸‹è½½åˆ°ç›®å½•/tmp/demoã€‚</p><pre class="lh li lj lk fd lz ma mb bn mc md bi"><span id="bb61" class="me ke hi ma b be mf mg l mh mi">download = Shell(<br/>     name="download_resources",<br/>     command=f"wget -P {download_dir} {download_link}"<br/>)</span></pre><h2 id="c33a" class="ll ke hi bd kf lm ln lo kj lp lq lr kn jm ls lt kr jq lu lv kv ju lw lx kz ly bi translated">ä¸‹è½½èµ„æºå‰åæˆ‘ä»¬éœ€è¦åšä»€ä¹ˆï¼Ÿ</h2><p id="9b33" class="pw-post-body-paragraph jb jc hi jd b je lb jg jh ji lc jk jl jm ld jo jp jq le js jt ju lf jw jx ja hb bi translated">æ­£å¦‚æˆ‘ä»¬åœ¨æ¦‚è¿°ä¸­æåˆ°çš„ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ä»å®˜æ–¹ç½‘ç«™ä¸‹è½½èµ„äº§ä¹‹å‰æˆ–ä¹‹åç»å†ä¸€äº›é¢å¤–çš„æ­¥éª¤ã€‚å¯¹äºç¯å¢ƒå‡†å¤‡ï¼Œæˆ‘ä»¬ä½¿ç”¨å•ä¸ªshellä»»åŠ¡æ¥ç¡®ä¿ä¸‹è½½ç›®å½•å­˜åœ¨ï¼Œå¹¶ä¸”ç›®å½•ä¸­æ²¡æœ‰å…¶ä»–èµ„æºæ–‡ä»¶ã€‚ä¼ é€’å‘½ä»¤mkdir-p/tmp/demoï¼›å‚æ•°å‘½ä»¤çš„rm -rf /tmp/demo/*(æ³¨æ„æˆ‘ä»¬åœ¨è¿™é‡Œä¹Ÿä½¿ç”¨Pythonå˜é‡)ã€‚æˆ‘ä»¬å¿…é¡»å‹ç¼©ã€‚ç„¶åå°†å®ƒä»¬è§£å‹ç¼©åˆ°ä¸€ä¸ªç‰¹å®šçš„ç›®å½•ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨è¿™ä¸ªè·¯å¾„ä¸Šè¿è¡Œä¸€äº›Pythonä»£ç ã€‚</p><pre class="lh li lj lk fd lz ma mb bn mc md bi"><span id="4e03" class="me ke hi ma b be mf mg l mh mi">prepare = Shell(<br/>     name="prepare_dir",<br/>     command=f"mkdir -p {download_dir}; rm -rf {download_dir}/*"<br/>)<br/>compress = Shell(<br/>     name="compress_tar",<br/>     command=f "cd {download_dir}; unzip {file_name} -d {store_dir}"<br/>)</span></pre><h2 id="c4cf" class="ll ke hi bd kf lm ln lo kj lp lq lr kn jm ls lt kr jq lu lv kv ju lw lx kz ly bi translated">è®¡ç®—æœ€å¤§çš„æ–‡ä»¶</h2><p id="f57b" class="pw-post-body-paragraph jb jc hi jd b je lb jg jh ji lc jk jl jm ld jo jp jq le js jt ju lf jw jx ja hb bi translated">æˆ‘ä»¬ä½¿ç”¨Pythonä»»åŠ¡æ¥ç»Ÿè®¡DolphinScheduleræºä»£ç ä¸­æœ€å¤§çš„æ–‡ä»¶å’Œæœ€å¸¸ç”¨çš„æ–‡ä»¶ç±»å‹ã€‚å¦‚ä½ æ‰€è§ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å‘½åPythonä»»åŠ¡ï¼Œè¿™é‡Œæˆ‘å°†å…¶å‘½åä¸ºmaximum _ fileï¼Œç„¶åå°†å‡½æ•°ä¼ é€’ç»™Pythonä»»åŠ¡çš„å‚æ•°å®šä¹‰ã€‚<strong class="jd hj">è¿™ä¸€æ­¥çš„æ ¸å¿ƒé€»è¾‘æ¥è‡ªäºæœ€å¤§å°ºå¯¸å‡½æ•°</strong>ã€‚åœ¨è¿™ä¸ªå‡½æ•°ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡pathlibåº“éå†æºä»£ç ç›®å½•å¹¶æ‰¾åˆ°æœ€å¤§çš„æ–‡ä»¶ã€‚ä½¿ç”¨ä¸€ä¸ªåä¸ºresultçš„å…ƒç»„æ¥å­˜å‚¨å‘½åæ–‡ä»¶åŠå…¶å¤§å°ï¼Œæœ€åæ‰“å°ç»“æœï¼Œç»“æœå°†æ˜¾ç¤ºåœ¨æ§åˆ¶å°ä¸Šã€‚</p><pre class="lh li lj lk fd lz ma mb bn mc md bi"><span id="f0b0" class="me ke hi ma b be mf mg l mh mi">def largest_size():<br/>     from pathlib import Path<br/>     download_dir = "/tmp/demo"<br/>     store_dir = "dolphinscheduler"<br/>     result = (None, 0)<br/>     paths = Path(download_dir).joinpath(store_dir).glob("**/*")<br/>     for path in paths:<br/>         # skip is path is directory<br/>         if path.is_dir():<br/>             continue<br/>         file_size = path.stat().st_size<br/>         if result[0] is None or file_size &gt; result[1]:<br/>             result = (path.name, file_size)<br/>     print(result)<br/>largest_file = Python(<br/>     name="largest_file",<br/>     definition=largest_size,<br/>)</span></pre><h2 id="072a" class="ll ke hi bd kf lm ln lo kj lp lq lr kn jm ls lt kr jq lu lv kv ju lw lx kz ly bi translated">è®¡ç®—æœ€å¸¸å‡ºç°çš„æ–‡ä»¶ç±»å‹</h2><p id="1c6b" class="pw-post-body-paragraph jb jc hi jd b je lb jg jh ji lc jk jl jm ld jo jp jq le js jt ju lf jw jx ja hb bi translated">è¿™é‡Œçš„æ–¹æ³•å¯¹äºæœ€å¤§çš„æ–‡ä»¶æ˜¯ç›¸åŒçš„ï¼Œæˆ‘ä»¬ä½¿ç”¨Pythonä»»åŠ¡ï¼Œç”¨most_typeä½œä¸ºåç§°ï¼Œmost _ frequentlyä½œä¸ºå®šä¹‰ã€‚ä¸ºäº†æ‰¾åˆ°æœ€å¸¸ç”¨çš„æ–‡ä»¶ç±»å‹ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªå­—å…¸æ¥ä¿å­˜æ‰€æœ‰æ–‡ä»¶æ‰©å±•åã€‚ç„¶åä½¿ç”¨pathlibåº“éå†æºä»£ç ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæ³¨æ„è·³è¿‡æ²¡æœ‰æ‰©å±•åçš„ç›®å½•å’Œæ–‡ä»¶ï¼Œä»å­—å…¸ä¸­æ‰¾åˆ°æœ€å¸¸ç”¨çš„å€¼ã€‚</p><pre class="lh li lj lk fd lz ma mb bn mc md bi"><span id="36ed" class="me ke hi ma b be mf mg l mh mi">def most_frequently():<br/>     from pathlib import Path<br/>     download_dir = "/tmp/demo"<br/>     store_dir = "dolphinscheduler"<br/>     ext_cnt = {}<br/>     paths = Path(download_dir).joinpath(store_dir).glob("**/*")<br/>     for path in paths:<br/>         # skip is path is directory<br/>         if path.is_dir():<br/>             continue<br/>         ext = path.suffix<br/>         # skip file without suffix<br/>         if ext == "":<br/>             continue<br/>         ext_cnt[ext] = ext_cnt[ext] + 1 if ext in ext_cnt else 1<br/>     print(max(ext_cnt.items(), key=lambda p: p[1]))<br/>most_type = Python(<br/>     name="most_type",<br/>     definition=most_frequently,<br/>)</span></pre><h2 id="67e3" class="ll ke hi bd kf lm ln lo kj lp lq lr kn jm ls lt kr jq lu lv kv ju lw lx kz ly bi translated">è®¾ç½®ä»»åŠ¡ç›¸å…³æ€§</h2><p id="ac3c" class="pw-post-body-paragraph jb jc hi jd b je lb jg jh ji lc jk jl jm ld jo jp jq le js jt ju lf jw jx ja hb bi translated">è®¾ç½®å®Œæˆåï¼Œæˆ‘ä»¬éœ€è¦å£°æ˜ä»»åŠ¡çš„ä¾èµ–å…³ç³»ã€‚ä¸ç”¨è¯´ï¼Œæˆ‘ä»¬åº”è¯¥å…ˆè¿è¡Œå‡†å¤‡ä»»åŠ¡ï¼Œå› ä¸ºæ²¡æœ‰å‹ç¼©åŒ…å°±æ— æ³•è¿›è¡Œå‹ç¼©ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å°†ä»»åŠ¡ä¸‹è½½è®¾ç½®ä¸ºå‹ç¼©çš„ä¸Šæ¸¸ã€‚å¦ä¸€ä¸ªè®¡ç®—å¯ä»¥å¹¶è¡Œè¿è¡Œï¼Œæ‰€ä»¥æˆ‘ä»¬å°†å®ƒä»¬éƒ½è®¾ç½®åœ¨å‹ç¼©ä»»åŠ¡çš„ä¸‹æ¸¸ï¼Œæˆ‘ä»¬ä½¿ç”¨è¯­æ³•sugar compress &gt;&gt; [largest_fileï¼Œmost_type]åœ¨è¿™é‡Œï¼Œå¯ä»¥åœ¨ä¸€ä¸ªè¯­å¥ä¸­è®¾ç½®ä¸¤ä¸ªæˆ–å¤šä¸ªä¾èµ–é¡¹ã€‚</p><h2 id="70b0" class="ll ke hi bd kf lm ln lo kj lp lq lr kn jm ls lt kr jq lu lv kv ju lw lx kz ly bi translated">å¿«è·‘ï¼</h2><p id="080b" class="pw-post-body-paragraph jb jc hi jd b je lb jg jh ji lc jk jl jm ld jo jp jq le js jt ju lf jw jx ja hb bi translated">å°†ä»¥ä¸‹ä»£ç æ·»åŠ åˆ°è„šæœ¬çš„æœ«å°¾ï¼Œä»¥å°†å·¥ä½œæµå’Œä»»åŠ¡æäº¤ç»™DolphinSchedulerï¼Œå¹¶åœ¨é»˜è®¤æƒ…å†µä¸‹è§¦å‘å®ƒä»¬ã€‚</p><pre class="lh li lj lk fd lz ma mb bn mc md bi"><span id="4098" class="me ke hi ma b be mf mg l mh mi">pd. run()</span></pre><p id="b3f8" class="pw-post-body-paragraph jb jc hi jd b je jy jg jh ji jz jk jl jm ka jo jp jq kb js jt ju kc jw jx ja hb bi translated">å®Œæˆæ‰€æœ‰å·¥ä½œåï¼Œæ‚¨å¯ä»¥åœ¨Pythonæ§åˆ¶å°ä¸­è¿è¡Œä»£ç å¹¶è§‚å¯Ÿç»“æœã€‚ä¹‹åï¼Œæ‚¨å¯ä»¥åœ¨DolphinScheduler UIä¸­çœ‹åˆ°æ­£åœ¨è¿è¡Œçš„å·¥ä½œæµå’Œä»»åŠ¡ï¼Œé»˜è®¤ä¸º</p><pre class="lh li lj lk fd lz ma mb bn mc md bi"><span id="90a2" class="me ke hi ma b be mf mg l mh mi">http://127.0.0.1:12345/dolphinscheduler.<br/>python3 demo.py</span></pre><h1 id="423f" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">æ‘˜è¦</h1><p id="c282" class="pw-post-body-paragraph jb jc hi jd b je lb jg jh ji lc jk jl jm ld jo jp jq le js jt ju lf jw jx ja hb bi translated">åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä»‹ç»äº†ä»€ä¹ˆæ˜¯DolphinScheduleråŠå…¶æœ€è¿‘æ·»åŠ çš„Python APIç‰¹æ€§ï¼Œå¹¶å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨Python APIæ¥æ„å»ºåŒ…å«å¤šä¸ªä»»åŠ¡çš„å·¥ä½œæµï¼Œå¦‚ä½•è®¾ç½®ä»»åŠ¡ï¼Œä»¥åŠå¦‚ä½•å°†ä»»åŠ¡æäº¤ç»™DolphinSchedulerã€‚</p><p id="afb1" class="pw-post-body-paragraph jb jc hi jd b je jy jg jh ji jz jk jl jm ka jo jp jq kb js jt ju kc jw jx ja hb bi translated">æ‚¨å¯ä»¥åœ¨ä»»åŠ¡ä¸­æ‰¾åˆ°Python APIæ”¯æŒçš„æ‰€æœ‰ä»»åŠ¡ã€‚æœ‰å…³DolphinScheduler Python APIçš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚è€ƒ<a class="ae mj" href="https://dolphinscheduler.apache.org/python/dev/index.html" rel="noopener ugc nofollow" target="_blank">æœ¬æ–‡æ¡£</a>ã€‚</p><p id="22a9" class="pw-post-body-paragraph jb jc hi jd b je jy jg jh ji jz jk jl jm ka jo jp jq kb js jt ju kc jw jx ja hb bi translated">ğŸ“ŒğŸ“Œæ¬¢è¿å¡«å†™<a class="ae mj" href="https://www.surveymonkey.com/r/7CHHWGW" rel="noopener ugc nofollow" target="_blank">è¿™ä»½è°ƒæŸ¥</a>æ¥åé¦ˆæ‚¨çš„ç”¨æˆ·ä½“éªŒæˆ–æ‚¨å¯¹Apache DolphinSchedulerçš„æƒ³æ³•:)</p><p id="d171" class="pw-post-body-paragraph jb jc hi jd b je jy jg jh ji jz jk jl jm ka jo jp jq kb js jt ju kc jw jx ja hb bi translated">ã€https://www.surveymonkey.com/r/7CHHWGW T4ã€‘</p></div></div>    
</body>
</html>