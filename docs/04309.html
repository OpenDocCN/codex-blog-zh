<html>
<head>
<title>How to Use React Bootstrap Navbar’s collapseOnSelect property With Custom Links</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在自定义链接中使用React Bootstrap Navbar的collapseOnSelect属性</h1>
<blockquote>原文：<a href="https://medium.com/codex/how-to-use-react-bootstrap-navbars-collapseonselect-property-with-custom-links-b2902ff5f472?source=collection_archive---------5-----------------------#2021-11-20">https://medium.com/codex/how-to-use-react-bootstrap-navbars-collapseonselect-property-with-custom-links-b2902ff5f472?source=collection_archive---------5-----------------------#2021-11-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/72b1c85e254b44f3bf489d56649e2c3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*V0WdZzpDDI507SAE"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">由<a class="ae iu" href="https://unsplash.com/@minhctran?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">明陈</a>在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</figcaption></figure><p id="8989" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">React Bootstrap提供了一个方便、简单且响应迅速的设计系统，使用可重复使用的组件为您的网站添加功能、风格和结构。有几个方面的事情可能会变得有点复杂，比如让Navbar及其CollapseOnSelect属性按预期工作。环顾互联网，似乎我不是唯一一个遇到困难的人。好消息是，我最近将<a class="ae iu" href="https://blog.corkhounds.com/p/cb7c1e64-54c8-4a89-b281-a99be1b332c4/www.corkhounds.com" rel="noopener ugc nofollow" target="_blank"> Cork Hounds </a>从React Bootstrap v0.33.1更新到了v1.6.4，我终于能够让CollapseOnSelect与React路由器链接和哈希链接一起工作了。解决方案相对简单，但是这是一个有一个工作示例真的很有帮助的例子。因此，我将从重点开始，最后概述codesandbox.io中的一个全功能解决方案。</p><h1 id="e9a4" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">概观</h1><p id="85d3" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">那么，什么是CollapseOnSelect，为什么我们需要一个专门针对它的博客？CollapseOnSelect是Navbar组件的一个(挑剔的)设置，主要在两种情况下发挥作用:</p><ul class=""><li id="d826" class="kw kx hi ix b iy iz jc jd jg ky jk kz jo la js lb lc ld le bi translated">当您使用下拉菜单时，您希望在用户单击NavDropdown后关闭它。项目，或</li><li id="c463" class="kw kx hi ix b iy lf jc lg jg lh jk li jo lj js lb lc ld le bi translated">当你使用导航条时。当你的应用程序显示在小屏幕上时，折叠组件会自动将你的导航条转换成汉堡菜单。当用户做出选择时，您希望菜单折叠。注意，<code class="du lk ll lm ln b">expand</code> prop允许在不同的断点折叠导航条。</li></ul><p id="dcc3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">使用Navbar组件时，您通常需要适应(1)内部路由，(2)锚定标签/引用，或(3)外部站点。由于大多数有内部路由的React站点使用React路由器，我们将使用<a class="ae iu" href="https://v5.reactrouter.com/web/api/Link" rel="noopener ugc nofollow" target="_blank">链接</a>。对于锚点引用，React路由器链接提供了<a class="ae iu" href="https://v5.reactrouter.com/web/api/Link/innerref-refobject" rel="noopener ugc nofollow" target="_blank"> innerRef </a>属性。您的Navbar组件需要能够访问refs，有很多方法可以做到这一点。你也可以使用锚标签(或者散列链接)，例如<code class="du lk ll lm ln b">id="first"</code>。React路由器不支持锚标签，但是有一个名为<a class="ae iu" href="https://www.npmjs.com/package/react-router-hash-link" rel="noopener ugc nofollow" target="_blank"> React路由器散列链接</a>的库提供了该功能。为了与ReactJS的最佳实践保持一致，说直接引用DOM中的元素是一种反模式可能很重要，并且您应该<a class="ae iu" href="https://reactjs.org/docs/refs-and-the-dom.html" rel="noopener ugc nofollow" target="_blank">使用refs而不是</a>。但是有些情况下不方便使用refs，你只需要让一些东西工作起来就可以了。链接到外部URL的第三个也是最后一个用例是使用导航。链接<code class="du lk ll lm ln b">href</code>道具，除非需要特殊处理。</p><p id="d196" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">使用CollapseOnSelect属性的最终目的是当用户点击这些链接时，按预期折叠菜单。此外，您希望将用户发送到他们期望的精确位置(例如，在锚定标签/引用的顶部，或者在适当的内部页面上)。当我们考虑到Navbar这个事实时，这里就有点复杂了。当用户与菜单交互时，Collapse改变标题的高度。我们想要解决这个问题，这样当导航到一个锚标签/引用时，它就不会干扰/偏移页面。</p><p id="2deb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因为使用React路由器散列链接是“自定义”处理的象征，所以我将通过一个示例演示如何使链接和散列链接与Navbar和CollapseOnSelect属性一起工作。</p><h1 id="5f8f" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">假设和开始</h1><p id="5f9f" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">对于这篇博客，我假设您已经相当好地掌握了JavaScript、包管理(npm或yarn)和ReactJS，包括React Router (react-router-dom)，并且熟悉React Bootstrap。我试图通过在codesandbox.io中提供一个由create-react-app生成的完全可用的示例<a class="ae iu" href="https://codesandbox.io/s/react-bootstrap-collapseonclose-mqewn" rel="noopener ugc nofollow" target="_blank">来缓解这些障碍，您可以使用React Bootstrap Navbar来启动您的项目。我们的项目使用以下依赖关系:</a></p><pre class="lo lp lq lr fd ls ln lt lu aw lv bi"><span id="e290" class="lw ju hi ln b fi lx ly l lz ma">{"bootstrap": "4.6.1", "react": "16.14.0", "react-bootstrap": "1.6.4", "react-dom": "17.0.2", "react-router-dom": "5.3.0", "react-router-hash-link": "2.4.3", "react-scripts": "4.0.0"}</span></pre><h1 id="0f10" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">密码</h1><p id="65bd" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">让我们先来看一个使用CollapseOnSelect和Nav的导航条的精简示例。链接和导航下拉菜单。项目，带有用于页面的标准React路由器链接和用于锚标签的自定义链接实现(也称为哈希链接)。</p><figure class="lo lp lq lr fd ij"><div class="bz dy l di"><div class="mb mc l"/></div></figure><p id="4d2e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这个例子中有一些事情需要注意。首先，我们显示两个导航。链接和两个NavDropdown。物品；每一个都说明了如何使用一个标准的React路由器链接和一个自定义链接，我们稍后将对此进行详细说明。React路由器链路将开箱即用；不需要特殊处理/考虑。然而，对于一个定制的散列链接，我们需要将标题高度传递给<code class="du lk ll lm ln b">MyHashLink</code>组件，以便它知道滚动位置偏移多远。</p><p id="9380" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">要做到这一点，让我们看看一个基于类的方法来加载Navbar，精确计算标题的高度并将值存储在组件状态中，我们称之为<code class="du lk ll lm ln b">this.state.headerHeight</code>。我们将使用两个步骤来完成此操作。首先，当组件挂载时，我们通过从<code class="du lk ll lm ln b"> componentDidMount()</code>生命周期方法中调用<code class="du lk ll lm ln b">updateHeaderHeight()</code>方法来设置headerHeight。注意，在<code class="du lk ll lm ln b">updateHeaderHeight()</code>方法中，我们使用<code class="du lk ll lm ln b">this.divElement.clientHeight</code>来获取我们在div容器上设置的<code class="du lk ll lm ln b">ref</code>的高度，在上面提供的例子中，div容器包装了Navbar。</p><figure class="lo lp lq lr fd ij"><div class="bz dy l di"><div class="mb mc l"/></div></figure><p id="2754" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">第二，因为图像加载很慢，所以我们希望在头部图像加载时更新headerHeight。您会注意到，在下面的代码片段中(为了方便起见，从上面的Navbar部分转述而来)，我们调用了<code class="du lk ll lm ln b">this.updateHeaderHeight()</code>来完成这个任务。</p><figure class="lo lp lq lr fd ij"><div class="bz dy l di"><div class="mb mc l"/></div></figure><p id="3bae" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在我们有了一个准确的标题大小，我们可以看看我们的定制<code class="du lk ll lm ln b">MyHashLink</code>组件。下面所示的功能组件接收与Nav相关联的属性。链接和导航下拉列表。项，包括<code class="du lk ll lm ln b">data-height</code>、<code class="du lk ll lm ln b">to</code>等重要属性。</p><figure class="lo lp lq lr fd ij"><div class="bz dy l di"><div class="mb mc l"/></div></figure><p id="9207" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在我们的自定义示例中，我们希望滚动到一个锚标记。我们将使用<a class="ae iu" href="https://www.npmjs.com/package/react-router-hash-link" rel="noopener ugc nofollow" target="_blank"> React路由器哈希链接</a>库来完成这项工作。这个库导出两个组件:<code class="du lk ll lm ln b">HashLink</code>和<code class="du lk ll lm ln b">NavHashLink</code>。我们将使用<code class="du lk ll lm ln b">NavHashLink</code>,因为当链接被点击时，它正确地将活动的<code class="du lk ll lm ln b">className</code>应用到框外。为了在点击<code class="du lk ll lm ln b">NavHashLink</code>时触发<code class="du lk ll lm ln b">Navbar</code>折叠，我们设置了它的onClick属性:<code class="du lk ll lm ln b">onClick={props.onClick}</code>。</p><p id="20d2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">接下来，我们使用scroll属性将元素传递给我们的<code class="du lk ll lm ln b">scrollWithOffset</code>函数来定制滚动行为。这里，当滚动到选定的锚标记时，我们使用传入的<code class="du lk ll lm ln b">props["data-height"]</code>作为yOffset。</p><p id="d614" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这就是我们需要为collapseOnSelect做的所有特殊处理，以便与React路由器链接和自定义哈希链接实现一起正常工作。</p><h1 id="e076" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">工作示例</h1><p id="9861" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">让我们把这些放在一起。没有什么比有一个完全可行的例子来说明一切是如何结合在一起的更好了。这个项目是在codesandbox.io中使用create-react-app (CRA)创建的。这个应用程序的入口点是<code class="du lk ll lm ln b">src/index.js</code>文件，我们在其中引入了上面描述的Header类，并设置了React Router。</p><p id="296d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">基本路由“/”指向<code class="du lk ll lm ln b">App</code>组件，还有一些其他示例路由指向<code class="du lk ll lm ln b">PageComponent</code>。在<code class="du lk ll lm ln b">App</code>组件中，我们引入了<code class="du lk ll lm ln b">HashComponent</code>来说明在整个页面中使用多个锚标签。<code class="du lk ll lm ln b">Header</code>和<code class="du lk ll lm ln b">MyHashLink</code>组件协同工作以提供导航。我们将React路由器链接映射到<code class="du lk ll lm ln b">index.js</code>中指定的路由，这些路由指向一个<code class="du lk ll lm ln b">PageComponent</code>，而我们的锚标记指向一个<code class="du lk ll lm ln b">HashComponent</code>。</p><p id="ea3d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">当点击菜单项时，菜单将按预期折叠，并导航到适当的锚或页面。请随意探索这一点，并在您认为合适的时候加以利用。</p><figure class="lo lp lq lr fd ij"><div class="bz dy l di"><div class="md mc l"/></div></figure><h1 id="bd24" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">结论</h1><p id="e274" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">希望这篇博客对你有所帮助。如果您觉得这很有用或者需要任何帮助，请留下您的评论！</p></div><div class="ab cl me mf gp mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="hb hc hd he hf"><p id="b0c8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="ml">原载于2021年11月20日</em><a class="ae iu" href="https://blog.corkhounds.com/p/cb7c1e64-54c8-4a89-b281-a99be1b332c4/" rel="noopener ugc nofollow" target="_blank"><em class="ml">【https://blog.corkhounds.com】</em></a><em class="ml">。</em></p></div></div>    
</body>
</html>