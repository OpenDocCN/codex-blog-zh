<html>
<head>
<title>A walkthrough for async &amp; await / promises</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">异步&amp;等待/承诺的演练</h1>
<blockquote>原文：<a href="https://medium.com/codex/javascript-react-callback-hell-promises-async-await-1a1bfdc8a10c?source=collection_archive---------12-----------------------#2022-07-22">https://medium.com/codex/javascript-react-callback-hell-promises-async-await-1a1bfdc8a10c?source=collection_archive---------12-----------------------#2022-07-22</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="0848" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">还记得那句老话吗，“一诺千金”？在现实世界中，当你承诺做某事时，无论你在哪里，你都应该信守承诺。嗯，即使是臭名昭著的角色，所有时代的恶魔罪犯，“小丑”似乎也非常认真地对待他的承诺:-)编程世界也不例外。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/ac04b3a8c0a7b19e4124714b5ff25841.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*6qt0OVvIkr0DfIEp.jpg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">引用插图</figcaption></figure><p id="d9e6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">玩笑归玩笑，承诺也是JavaScript领域的基石。我将用一个基本的比喻来告诉你这个概念的要点。想象一下，你要举办一场非凡的夏季派对。</p><div class="je jf jg jh fd ab cb"><figure class="jt ji ju jv jw jx jy paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><img src="../Images/e8ae0dfd98cf8fdc5f15ad1ad23b9bd4.png" data-original-src="https://miro.medium.com/v2/resize:fit:562/format:webp/0*0f5rbYbrgQ-3ZV50.jpg"/></div></figure><figure class="jt ji jz jv jw jx jy paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><img src="../Images/26771559360c58e90505c3d62d86137c.png" data-original-src="https://miro.medium.com/v2/resize:fit:842/0*otEihyv8Hgppsg2J"/></div></figure><figure class="jt ji ka jv jw jx jy paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><img src="../Images/cd4fd9181a74274679f6fe62d3cfea87.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/0*8JU8NUfQ_YsBvn4f.jpg"/></div><figcaption class="jp jq et er es jr js bd b be z dx kb di kc kd translated">沉积照片插图</figcaption></figure></div><p id="baba" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因为这是一个大事件，你需要一些额外的人手来确保事情从一开始就能顺利进行。因此，你好心地请你的朋友(姑且称他为“杰克”)提前买了莫吉托鸡尾酒。与此同时，你还需要处理一些重要的杂事，由于时间的限制，你不知何故被迫向另一个朋友(姑且称他为“蒂姆”)求助零食，尽管你知道他很健忘。聚会那天，所有的莫吉托都到了；但是，没有零食！很自然，你会生蒂姆的气，但是没用。该做的都做了，派对应该继续进行，不吃零食了。你真可耻，蒂姆！:-)</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ke"><img src="../Images/b7fb8ba8d311fe15601d969a1cacd550.png" data-original-src="https://miro.medium.com/v2/resize:fit:902/format:webp/1*onuJKfzZsTtkLCz9gCEFgA.png"/></div></figure><p id="f732" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，让我们稍微剖析一下我们虚构的故事，并尝试在编程世界中与“承诺”建立一些联系。如果您仔细检查上面的代码片段，您会看到“承诺”是如何按照所需的公式工作的，以及我们如何在这里插入基于当事人的场景。</p><p id="6be0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果Jack和Tim都履行了责任，也就是说遵守了他们的承诺(就像上面代码片段中Kim和Lilly最喜欢的季节匹配的方式)，一切都会很棒/代码不会抛出任何错误。但是，当Tim忘记零食/请求被拒绝时，就该通过控制台检查错误的来源了。</p><p id="8425" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在上面的例子中，没有<a class="ae kf" href="https://www.mulesoft.com/resources/api/what-is-an-api" rel="noopener ugc nofollow" target="_blank">面向API的任务</a>，但是程序员无时无刻不在与API打交道，并且承诺在这个过程中会非常有帮助。为了更好地理解这个概念，让我们通过包含一个API来重新塑造同一个场景。有一个新的承诺(例如，从外部API服务器获取数据= Jack和Tim对您的承诺)采取“解决”(例如，成功检索API数据。杰克遵守了他的诺言。)和‘拒绝’(蒂姆无法信守承诺。=出现了一个错误。)参数。代码块‘then&amp;catch’引导我们完成剩下的过程。</p><p id="d58e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在技术世界里，改进从未停止，一些额外的功能/版本不断出现，这就是作为一名程序员的好处，因为你可以不断更新自己。<a class="ae kf" href="https://www.geeksforgeeks.org/introduction-to-es6/" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> ES6 </strong> </a> <strong class="ih hj"> </strong>提供的<strong class="ih hj"> async </strong> &amp; <strong class="ih hj"> await </strong>关键词，让承诺的实现变得更加容易。在处理异步动作时，这两个确实很有帮助。</p><p id="0a46" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如我在之前的文章中通过<a class="ae kf" rel="noopener" href="/codex/shall-we-create-a-basic-project-from-scratch-via-react-a49a65ac1767">与你分享的，React在某种程度上是深受喜爱的JavaScript的一个孩子，所以我们从promises / asynch + await关键字中受益的方式非常相似。现在让我们分析一个基于React的例子。如果您没有使用React的经验，下面的内容对您来说可能有点复杂，但是我们如何实现异步&amp; await并没有太大的不同。你可以在这里</a>看到一些基于JavaScript的例子<a class="ae kf" href="https://www.geeksforgeeks.org/async-await-function-in-javascript/" rel="noopener ugc nofollow" target="_blank">。</a></p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kg"><img src="../Images/58d1167436c049517ef7353a2ebb8e98.png" data-original-src="https://miro.medium.com/v2/resize:fit:912/format:webp/1*KKz1RAHpd1J4zkuLS-I33w.png"/></div></figure><p id="42c1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在上面的React项目中，我们首先需要将API的url存储在一个变量中，以便能够从服务器获取数据。正如您在上面的代码块中看到的，从相关API中获取一些旅游的过程以<strong class="ih hj"> <em class="kh">异步</em> </strong>开始，然后<strong class="ih hj"> <em class="kh">等待</em> </strong>连续两次接管任务。为了能够以有组织的方式查看数据，我们将响应与json结合起来。Try &amp; catch块可以帮助我们瞬间发现错误。</p><p id="00b7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">长话短说，承诺帮助程序员编写<a class="ae kf" href="https://eloquentjavascript.net/11_async.html" rel="noopener ugc nofollow" target="_blank">异步代码</a>。使用承诺是摆脱<a class="ae kf" href="https://www.bmc.com/blogs/callback-hell/#:~:text=Callback%20Hell%2C%20also%20known%20as,a%20few%20callbacks%20seem%20harmless." rel="noopener ugc nofollow" target="_blank">回调地狱</a>的可靠策略，基于ES6的异步&amp; await关键字使这个过程变得不那么复杂。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ki"><img src="../Images/2d1becdc73b6e1c6f698c127270737d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*bxEA4RZMVLN4zkdJ.jpeg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">一个超级英雄(承诺)将程序员从回调地狱中拯救出来:-)</figcaption></figure><p id="1c2b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你很难记住这些公式/语法，实际上有两种有效的方法可以让你受益。第一个是使用<a class="ae kf" href="https://www.popsci.com/what-is-muscle-memory/" rel="noopener ugc nofollow" target="_blank">肌肉记忆</a>。多次键入代码块。越多越好…如果可能的话，不要借助类似VS代码的编辑器。你可以使用文字处理器。把它们写在一张纸上几次。当你意识到它们是如何不费吹灰之力就变得朗朗上口时，你会大吃一惊的。你越是使用相关的语法，它就会成为你的第二天性。更不用说对于<a class="ae kf" href="https://www.codecademy.com/resources/blog/whiteboard-interview-tips/" rel="noopener ugc nofollow" target="_blank">白板编码面试</a>来说，这实际上是一个很好的实践，这可能相当困难。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kj"><img src="../Images/f9a8e80ecdcd22a9b38f5a96ca4792da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/0*WC5ls5fjf5j80vVD.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">Freepik的迷因</figcaption></figure><p id="4390" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第二种方法与一种叫做“<a class="ae kf" href="https://fs.blog/the-memory-palace/#:~:text=The%20memory%20palace%20technique%20is,your%20memories%20to%20recall%20them." rel="noopener ugc nofollow" target="_blank">记忆宫殿</a>”的技术有关。在写这些代码块的时候，试着把它们和一些荒谬/不真实的事情联系起来(就像上面奇怪的json提醒)。您甚至可以通过使用代码块中的片段来构思自己独特的故事。细节越古怪，在时间的流逝中就越容易记住。试一试吧。你不会后悔的。</p><p id="76e4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">学习一门新编程语言的唯一方法就是用它来写程序。——<em class="kh">丹尼斯·里奇</em></p></div></div>    
</body>
</html>