<html>
<head>
<title>Set-Up Automatic Testing</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">设置自动测试</h1>
<blockquote>原文：<a href="https://medium.com/codex/set-up-automatic-testing-2507dfb94cbe?source=collection_archive---------5-----------------------#2021-08-06">https://medium.com/codex/set-up-automatic-testing-2507dfb94cbe?source=collection_archive---------5-----------------------#2021-08-06</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="6e37" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">Github操作</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/d298a4b56bc5d4331653000a4b4d5586.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SRIE_bThihIWEba94qxzXg.jpeg"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated"><a class="ae jn" href="https://unsplash.com/@ninjason" rel="noopener ugc nofollow" target="_blank">梁杰森</a>在<a class="ae jn" href="https://unsplash.com/s/photos/robot" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="df5e" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">从我之前的博客<a class="ae jn" href="https://javascript.plainenglish.io/how-to-write-javascript-unit-tests-using-jest-422b3c4e050f" rel="noopener ugc nofollow" target="_blank">如何使用Jest </a>编写JavaScript单元测试开始，我将解释如何使用GitHub动作设置自动测试。</p><p id="a502" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在我看来，设置自动测试是必须的，太多次我忘记运行命令<code class="du kk kl km kn b">npm run test</code>并确保我所有的测试用例在合并到主分支之前通过。在我为创建测试做了这么多工作之后，我仍然忘记运行它们并推出错误的代码，这种想法是疯狂的。在团队项目中，这种情况会变得更糟，因为团队项目中更容易出现bug。</p><h1 id="e799" class="ko kp hi bd kq kr ks kt ku kv kw kx ky io kz ip la ir lb is lc iu ld iv le lf bi translated">入门指南</h1><p id="905e" class="pw-post-body-paragraph jo jp hi jq b jr lg ij jt ju lh im jw jx li jz ka kb lj kd ke kf lk kh ki kj hb bi translated">在开始之前，我们需要将代码放在GitHub库中。如果你不知道如何将你的代码添加到GitHub库，你可以遵循这个<a class="ae jn" href="https://dev.to/marianyp/git-github-put-in-5-simple-steps-egl" rel="noopener ugc nofollow" target="_blank">指南</a>。</p><p id="c964" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">一旦你在Github上托管了你的代码，我们就可以开始创建一个GitHub动作。每当针对主分支发出Pull请求(PR)时，我将创建的操作将简单地运行所有Jest测试。除非所有测试都通过，否则该操作将阻止所有合并到主分支中，从而降低主分支中出现随机错误的几率。</p><p id="2304" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在存储库中，单击位于顶部的actions选项卡。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ll"><img src="../Images/e70aa60bf8808e0023074a342175c2ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cuJcAwSqY8xHrGtGrWyCwQ.png"/></div></div></figure><p id="1884" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">GitHub提供了许多流行的操作，你可以在这里看到它们。然而，我们将从头开始创建我们自己的GitHub动作。为此，请点击“自行设置工作流程”。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lm"><img src="../Images/7bd315a598a222f4d700a5a1d8f2b1cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r6cylpNDHKUZ8cqp32TPkA.png"/></div></div></figure><p id="b7fb" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这将打开一个UI，我们可以在其中创建自己的GitHub操作。默认代码如下所示:</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="ln lo l"/></div></figure><p id="3374" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">当你第一次看到它的时候，它肯定看起来很吓人，但是我保证它没那么糟糕(评论本身解释了每一步，非常棒)。如果你想获得更多关于你看到的所有命令的信息，请访问Github操作页面，位于<a class="ae jn" href="https://docs.github.com/en/actions" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><p id="b618" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我们可以用下面的代码替换上面的代码:</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="ln lo l"/></div></figure><p id="4b33" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">写完这段代码后，点击“开始提交”，将这段代码合并到主分支中。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lm"><img src="../Images/f04b848906216139b431ec88b605a84f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8EPXyv97T1h4TlprEHoiKA.png"/></div></div></figure><p id="533c" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">通过这段代码，我们成功地创建了一个GitHub动作，每次创建PR时都会运行这个动作。为了测试这一点，创建一个新的分支并创建一个PR。它应该是这样的:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lp"><img src="../Images/e3b854b75466ac1678187e928ef1d006.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pWijHdncVmU_xS5_9xuNGg.png"/></div></div></figure><p id="b725" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在这里，我们可以看到GitHub操作正在运行我们所有的Jests测试。但是，正如您所看到的，我们能够在所有测试完成之前合并这个PR。显然，我们希望在测试通过之前阻止所有到主分支的合并。为此，我们将设置“分支保护规则”。</p><p id="e902" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">为此，请单击“设置”。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ll"><img src="../Images/ce800b30db330b813bfb4a5c868edc6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7_HDagziApYIlI_cZVNuZg.png"/></div></div></figure><p id="dc82" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">接下来点击“分支”。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lm"><img src="../Images/74bf010f8f288f8ff6bfb0117995ae4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KLIoCJeHlloczhqbm0TF_A.png"/></div></div></figure><p id="a024" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">最后是“添加规则”。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lm"><img src="../Images/8d947e6c51bc9f63f545ac6bc45794d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8aFN2m7XIgZDcgpyzrcHsA.png"/></div></div></figure><p id="adee" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在此页面上，我们将能够设置规则来保护我们的分支机构。在这种情况下，我将只设置一个规则，要求我们的Jests测试在合并到主分支之前通过。</p><p id="89ec" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">为此，我们将首先指定要保护的分支。为此，在“分支名称模式”输入字段中写入<code class="du kk kl km kn b">main</code>。</p><p id="81aa" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">之后，我们将需要指定“在合并之前需要通过的状态检查”。为此，只需搜索Github动作的名称并选择该动作。</p><p id="7f4f" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">最后，我们还需要指定将应用于管理员的规则。如果不选中此框，无论测试是否通过，管理员都可以合并分支。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lq"><img src="../Images/5f1302502c93ecb16ca99b620de02cf0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RcK01tZZjpjORlXVnO6Dgg.png"/></div></div></figure><p id="83b9" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">完成后，点击“Create ”,这将在允许合并到主分支之前将GitHub动作状态添加为“通过”。</p><p id="227b" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">最后，我们将再次测试这一点。再次，创建一个随机公关。</p><p id="fb5b" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">当GitHub操作运行时，您应该看到“合并拉取请求”按钮被禁用。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lr"><img src="../Images/f99851b803fa72b8b5576be1f56191b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R5NRgZv9Odau51AyoHdKLg.png"/></div></div></figure><p id="2384" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">操作结束后，如果所有测试都通过,“合并拉取请求”按钮将变为启用状态，否则将保持禁用状态。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ls"><img src="../Images/cf64255880116b4376bb56e8c219300a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f0lYmdq6hJ7_6cL5LTkZNA.png"/></div></div></figure></div><div class="ab cl lt lu gp lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="hb hc hd he hf"><p id="39a4" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这总结了如何在GitHub上设置自动测试。下次见。编码快乐！</p></div></div>    
</body>
</html>