<html>
<head>
<title>Importing Data Using MySQL and Arctype</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用MySQL和Arctype导入数据</h1>
<blockquote>原文：<a href="https://medium.com/codex/importing-data-using-mysql-and-arctype-a8c0d9549e80?source=collection_archive---------10-----------------------#2021-12-10">https://medium.com/codex/importing-data-using-mysql-and-arctype-a8c0d9549e80?source=collection_archive---------10-----------------------#2021-12-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/89e02442c8f73cf13516f6b88c088709.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mPnA5iBdBnRW8ru4hioVrQ.jpeg"/></div></div></figure><p id="5936" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果您是希望快速将数据加载到数据库中的开发人员或数据库管理员，您可能已经知道有很多选择，至少就MySQL而言。在这篇博客中，我们将介绍将数据导入MySQL实例时的选项。</p><h1 id="631c" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">有哪些选择？</h1><p id="b7aa" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">首先，在将数据导入MySQL时，您有两个导入数据的选项:</p><ul class=""><li id="7ad3" class="kr ks hi is b it iu ix iy jb kt jf ku jj kv jn kw kx ky kz bi translated">可以使用<code class="du la lb lc ld b">INSERT INTO</code>并指定一个表名以及需要导入给定数据库实例的列和数据。</li><li id="6414" class="kr ks hi is b it le ix lf jb lg jf lh jj li jn kw kx ky kz bi translated">用户也可以使用<code class="du la lb lc ld b">LOAD DATA INFILE</code>并指定一个特定的文件，他或她希望将数据从该文件加载到给定的表中。</li></ul><p id="e788" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，我们可以告诉你，“不，<code class="du la lb lc ld b">LOAD DATA INFILE</code>不是将数据导入基于MySQL或MariaDB的实例的唯一选项”，但是，这不是你来这里的目的——你来这里是为了了解将数据导入基于MySQL的实例的最佳机制。</p><p id="5fb1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在你已经知道<code class="du la lb lc ld b">LOAD DATA INFILE</code>和<code class="du la lb lc ld b">INSERT INTO</code>是你唯一的选择——然而，你可能也知道我们已经在我们的的早期博客文章中介绍了<code class="du la lb lc ld b">LOAD DATA INFILE</code>和<a class="ae lj" href="https://arctype.com/blog/mysql-load-data-infile/" rel="noopener ugc nofollow" target="_blank">提供的一些功能，所以你可能想知道我们为什么要写另一个。嗯，我们还没有涵盖所有内容！</a></p><p id="a66e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">比如我们告诉你<code class="du la lb lc ld b">LOAD DATA INFILE</code>更快，事实也的确如此。但是，一旦您需要将数据快速导入到数据库实例中，您还有几个其他的选择。例如，您可以像这样使用<code class="du la lb lc ld b">COMMIT</code>语句:</p><pre class="lk ll lm ln fd lo ld lp lq aw lr bi"><span id="0e41" class="ls jp hi ld b fi lt lu l lv lw">SET autocommit=0;<br/>INSERT INTO arctype (demo_column) VALUES (‘Demo Column’);<br/>COMMIT;</span></pre><p id="a4d2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">以上面指定的方式运行查询将有助于您的数据库在插入数据时执行得更好，因为<code class="du la lb lc ld b">COMMIT</code>语句保存了数据库的当前状态。换句话说，将<code class="du la lb lc ld b">autocommit</code>的值设为0，导入数据，然后提交可能是在MySQL中导入数据的一个更好的选择，因为您只需要在需要的时候将修改保存到磁盘上，这样可以减少MySQL(或MariaDB)的麻烦。另外，考虑将<code class="du la lb lc ld b">unique_checks</code>设置为0，将<code class="du la lb lc ld b">foreign_key_checks</code>也设置为0:将这些参数设置为off (0)也会提高数据库性能。</p><p id="6dea" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果您运行的是MyISAM存储引擎，将数据导入MySQL的另一个快速方法是将<code class="du la lb lc ld b">.frm</code>、<code class="du la lb lc ld b">.MYD</code>和<code class="du la lb lc ld b">.MYI</code>文件复制到不同数据库服务器上的给定文件夹中。不过这里有一个警告——您应该只使用MyISAM这样做，因为InnoDB的工作方式不同。除非你充分意识到后果，否则不要尝试这种方法。</p><p id="2f91" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您可以<a class="ae lj" href="https://arctype.com/blog/mysql-storage-engine-big-data/" rel="noopener ugc nofollow" target="_blank">阅读我们关于InnoDB与大数据的博客文章，以了解更多信息</a>，但本质上，InnoDB有一个核心文件——ibdata1——这是其性能的核心。像这样简单地复制文件弊大于利，因为ibdata1中的表空间ID与复制到新服务器的数据库文件中的表空间ID不匹配。</p><p id="d599" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">另一种加快给定数据导入的快速方法是在导入时锁定表。在导入数据之前运行一个<code class="du la lb lc ld b">LOCK TABLES</code>查询，完成后运行<code class="du la lb lc ld b">UNLOCK TABLES</code>，你应该可以开始了。如果您发现自己需要防止某些会话修改表，那么建议使用这种方法。</p><p id="3268" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您也可以使用由<code class="du la lb lc ld b">INSERT</code>语句提供的批量导入功能。<code class="du la lb lc ld b">INSERT INTO arctype (demo_column) VALUES (‘demo’), (‘demo’);</code>会比普通的<code class="du la lb lc ld b">INSERT</code>语句插入得更快。</p><p id="5476" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然而，这些并不是你可以采用的唯一选择。如果您正在使用MyISAM(您不应该这样做，但是如果您发现自己被迫使用这样的存储引擎…)，您可能还想考虑增加<code class="du la lb lc ld b">bulk_insert_buffer_size</code>的值。根据MySQL，该变量限制了每个线程的缓存树的大小(以字节为单位),因此，如果您发现自己在使用MyISAM时导入了大量数据，这应该会有所帮助。</p><h2 id="2d15" class="ls jp hi bd jq lx ly lz ju ma mb mc jy jb md me kc jf mf mg kg jj mh mi kk mj bi translated">一个注意事项:secure_file_priv变量</h2><p id="9cd8" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated"><code class="du la lb lc ld b">secure_file_priv</code>变量与数据库实例内部的数据批量导入密切相关。<a class="ae lj" href="https://arctype.com/blog/mysql-load-data-infile/" rel="noopener ugc nofollow" target="_blank">在之前的帖子中，我们说过</a> <code class="du la lb lc ld b"><a class="ae lj" href="https://arctype.com/blog/mysql-load-data-infile/" rel="noopener ugc nofollow" target="_blank">LOAD DATA INFILE</a></code> <a class="ae lj" href="https://arctype.com/blog/mysql-load-data-infile/" rel="noopener ugc nofollow" target="_blank">比</a> <code class="du la lb lc ld b"><a class="ae lj" href="https://arctype.com/blog/mysql-load-data-infile/" rel="noopener ugc nofollow" target="_blank">INSERT</a></code> <a class="ae lj" href="https://arctype.com/blog/mysql-load-data-infile/" rel="noopener ugc nofollow" target="_blank">语句要快得多，因为它自带了许多所谓的“花里胡哨”语句</a>。这种魔力的一部分是<code class="du la lb lc ld b">load_data_infile</code>。该变量通常驻留在您的<code class="du la lb lc ld b">my.cnf</code>文件中(该文件本身位于您的<code class="du la lb lc ld b">/var/bin/mysql</code>目录中)，看起来是这样的(下面的例子引用了在Windows环境中使用的变量):</p><p id="b0cd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du la lb lc ld b">secure_file_priv=”c:/wamp64/tmp”</code></p><p id="3e68" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">简单地说，这个变量限制了哪些目录可以用来将数据加载到MySQL数据库实例中。换句话说，一旦您运行一个<code class="du la lb lc ld b">LOAD DATA INFILE</code>查询，并且您加载到数据库实例中的文件不在这个目录中，MySQL将返回一个类似这样的错误:</p><pre class="lk ll lm ln fd lo ld lp lq aw lr bi"><span id="d0b3" class="ls jp hi ld b fi lt lu l lv lw">ERROR 1290 (HY000): The MySQL server is running with the --secure-file-priv option so it cannot execute this statement</span></pre><p id="953b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了克服这个错误，您需要从您的<code class="du la lb lc ld b">my.cnf</code>文件中删除<code class="du la lb lc ld b">--secure-file-priv</code>设置，或者从变量值中指定的目录中加载您的数据。一旦你这样做了，你的数据应该被加载(和导出)没有任何问题！</p><h1 id="5976" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">其他问题</h1><p id="c29b" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">除了使用<code class="du la lb lc ld b">LOAD DATA INFILE</code>将数据加载到MySQL数据库实例中并利用这个特权之外，当使用<code class="du la lb lc ld b">SELECT … INTO OUTFILE</code>从MySQL导出数据时，这样一个变量的值也可能是相关的。该变量也可用于通过<code class="du la lb lc ld b">LOAD DATA INFILE</code>和<code class="du la lb lc ld b">SELECT ... INTO OUTFILE</code>禁用导入和导出操作:在这种情况下，只需将该变量设置为<code class="du la lb lc ld b">NULL</code>。不过，一般来说，您也可以运行类似于<code class="du la lb lc ld b">SHOW QUERY VARIABLES LIKE ‘secure_file_priv’</code>或<code class="du la lb lc ld b">SELECT @@secure_file_priv</code>的查询，以便观察这个变量被设置到的目录的名称。</p><h1 id="a82b" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">是时候导入一些数据了！</h1><p id="9505" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">现在，您已经准备好导入一些数据了。您能使用<code class="du la lb lc ld b">INSERT</code>查询并逐个插入所有的行吗？或者您可能会使用<code class="du la lb lc ld b">INSERT</code>提供的批量插入功能？</p><p id="5b29" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">从技术上讲，是的——你可以做到。您可以通过将CSV文件中的行复制到<code class="du la lb lc ld b">INSERT</code>语句中来插入它们，然后逐个运行它们，但是这将花费相当多的时间，您还需要确保将CSV文件中行的正确值复制到<code class="du la lb lc ld b">INSERT</code>语句中，等等。-那会很麻烦！</p><p id="8cdd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">谢天谢地，有一些工具可以帮助你完成这些任务。其中一些工具是SQL客户端。例如，<a class="ae lj" href="https://arctype.com" rel="noopener ugc nofollow" target="_blank"> Arctype </a>开发的SQL客户端可以像电子表格一样帮助你编辑表格，你可以选择任何你想要编辑的单元格，只需点击删除就可以删除行，等等。</p><p id="4a3d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">但是，Arctype有另一个功能应该与本文的范围更相关，即Arctype还允许您将CSV文件导入到数据库实例中。让我们看看如何做到这一点！</p><p id="b709" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">继续并启动Arctype。在你桌子的右边，在桌子结构的上方，你会发现三个水平的点。点击它们:</p><figure class="lk ll lm ln fd ij er es paragraph-image"><div class="er es mk"><img src="../Images/459e9f9ab05144664f403d32c30f086e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1390/format:webp/0*PS8OF_iQBLd09aNf.png"/></div></figure><p id="ae31" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这些点表示可供您使用的选项:您可以创建一个表格或刷新它们，也可以将给定CSV文件的内容导入到您的表格中。点击<strong class="is hj">导入CSV </strong>并选择您想要导入的文件:</p><figure class="lk ll lm ln fd ij er es paragraph-image"><div class="er es ml"><img src="../Images/02ec142585d8d1dc11b0088e566b7bb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1196/format:webp/0*mCqBo-SLiL_XJNb1.png"/></div></figure><p id="4d62" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Arctype将为您提供有关文件的一些信息，并提供CSV文件包含的前五行。一旦您对看到的输出感到满意，就该导入数据了——继续并点击<strong class="is hj"> Accept </strong>:</p><figure class="lk ll lm ln fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mm"><img src="../Images/f06d5281317239edf61edabfa77fb86c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*dQx73L_5EPIqc8Lh.png"/></div></div></figure><p id="6550" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">单击accept后，您将能够定义要导入数据的表的列，您将能够创建新表或选择将数据上传到现有表中。</p><p id="f4a4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一旦您对屏幕上看到的内容感到满意，继续点击I<strong class="is hj">import CSV</strong>导入您的文件:您的数据现在应该存在于您的表中了！就是这样——真的就这么简单。</p><figure class="lk ll lm ln fd ij er es paragraph-image"><div class="er es mn"><img src="../Images/340cb66f14bd13f2c1f7b3815c848f7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1026/format:webp/0*kZ2kFVai53CE2qq1.png"/></div></figure><p id="206a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">有时，当您的数据太长而无法导入时，您可能会遇到如上所示的一些错误(在这种情况下，Arctype将导入导致错误的所有行)，但通常情况下，导入过程应该会很顺利</p><h1 id="b747" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">底线</h1><p id="1b25" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">当您发现自己需要快速将数据导入MySQL实例时，<code class="du la lb lc ld b">LOAD DATA INFILE</code>远不是您唯一的选择。您还可以使用<code class="du la lb lc ld b">INSERT</code>语句提供的批量插入功能，修改MySQL的功能，使其只在数据完全加载到数据库表中后才提交，并且使用<code class="du la lb lc ld b">LOAD DATA INFILE</code>只将数据加载到特定的列中。</p><p id="053e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们希望您继续关注我们的博客，因为我们为您准备了更多的内容——这个博客涵盖了数据库、安全性和对开发人员的一般建议，因此您一定会找到您正在寻找的内容。此外，如果您想尝试目前为止所学的内容，Arctype是实现这一目的的最佳工具。使用下面的按钮下载Arctype，并立即测试您的技能！</p><p id="4fee" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Lukas是一个有道德的黑客，MySQL数据库管理员，也是一个经常参加会议的演讲者。自2014年以来，Lukas发现并负责任地披露了立陶宛国内外一些访问量最大的网站的安全漏洞，包括广告、礼品购买、游戏、托管网站以及一些政府机构的网站。Lukas运行着世界上最大和最快的数据泄露搜索引擎之一:<a class="ae lj" href="http://breachdirectory.com/" rel="noopener ugc nofollow" target="_blank">BreachDirectory.com</a>并经常在多个地方写博客，教育人们关于信息安全和其他主题。他还在lukasvileikis.com经营自己的博客。</p></div></div>    
</body>
</html>