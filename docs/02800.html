<html>
<head>
<title>Android ViewBinding Migration</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Android ViewBinding迁移</h1>
<blockquote>原文：<a href="https://medium.com/codex/android-viewbinding-migration-16070e24b752?source=collection_archive---------1-----------------------#2021-08-06">https://medium.com/codex/android-viewbinding-migration-16070e24b752?source=collection_archive---------1-----------------------#2021-08-06</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="1c14" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">kot Lin Android Extensions<strong class="ih hj">已被弃用</strong>，这意味着不再支持使用Kotlin synthetics进行视图绑定。如果您的应用程序使用Kotlin synthetics进行视图绑定，请使用本指南迁移到Jetpack视图绑定。这里可以看到详细的公布信息<a class="ae jd" href="https://developer.android.com/topic/libraries/view-binding/migration" rel="noopener ugc nofollow" target="_blank">。</a></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/92cf4ce0db8599ac3fef9c34d4874230.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*X7LtBJojpMXDdv7y.jpg"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">来自https://www.kodefin.com/<a class="ae jd" href="https://www.kodefin.com/post/57/from-butterknife-to-android-view-binding-java" rel="noopener ugc nofollow" target="_blank">的图片src</a></figcaption></figure><p id="efcf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我做了一件你以后会做的事，或者你已经做了。但是我会分享我所做的和我知道的任何事情，也许不是全部，但至少我分享我所知道的，请随时评论和分享你的知识，以便我们可以交流我们的知识，成为更好的工程师。</p><p id="2390" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如我们所知，我们有多种方式来绑定/膨胀我们的视图，通过绑定/膨胀我们的视图意味着我们可以在我们的android逻辑文件(Kotlin/Java)中读取我们的视图。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ju"><img src="../Images/abc5f9e88ac13f8bfb45e4cd3fffa1b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IY0Cpx2v33rvxBSM2RqVhg.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">根据我目前的知识</figcaption></figure><h2 id="6c61" class="jv jw hi bd jx jy jz ka kb kc kd ke kf iq kg kh ki iu kj kk kl iy km kn ko kp bi translated"><a class="ae jd" href="https://developer.android.com/reference/android/view/View#findViewById(int)" rel="noopener ugc nofollow" target="_blank"> findViewById &lt;视图&gt; (R.id.xxx) </a></h2><p id="1abb" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">这是从我们的逻辑文件中获取视图的老方法，逻辑文件在activity/fragment/view类中。它总是有效的，但是你知道，你可能会在使用它时发现一些问题，正如你从上表中看到的，你可能会泄漏视图，并在运行时得到<strong class="ih hj"> NullPointerException </strong>。它还包含许多样板文件，你需要编写<strong class="ih hj"> findViewById </strong>并将其转换为视图，然后再次放置Id。</p><h2 id="0e7a" class="jv jw hi bd jx jy jz ka kb kc kd ke kf iq kg kh ki iu kj kk kl iy km kn ko kp bi translated"><a class="ae jd" href="https://github.com/JakeWharton/butterknife" rel="noopener ugc nofollow" target="_blank">黄油刀</a></h2><p id="3a37" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">由于这已被否决，Jake已经在他的git上提到了它，但它并没有解决我们的问题。它在代码上仍然有一些样板文件，比如<code class="du kv kw kx ky b">@BindView</code>，它仍然没有解决样板文件问题，我们需要把我们的id放在那里，我们需要把视图类型放在那里。因为它使用了注释处理，所以会稍微减慢构建时间。在更大的项目中比findViewById更糟糕。</p><h2 id="7b5e" class="jv jw hi bd jx jy jz ka kb kc kd ke kf iq kg kh ki iu kj kk kl iy km kn ko kp bi translated"><a class="ae jd" href="https://android-developers.googleblog.com/2020/11/the-future-of-kotlin-android-extensions.html" rel="noopener ugc nofollow" target="_blank">科特林合成</a></h2><p id="6607" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">正如团队<a class="ae jd" href="https://plugins.gradle.org/plugin/org.jetbrains.kotlin.android.extensions" rel="noopener ugc nofollow" target="_blank"> 2017 </a>所宣布的，它已经成为一个很好的候选/选项，因为它很轻，使用的代码量更少，并且它使我们可以更快地开发android应用程序。我们在这里不会发现类型转换的问题，因为它已经给出了一个很好的参考方式。但是，这里我们有一个问题，它不完全支持<strong class="ih hj"> NullPointerException </strong>，它不支持Java，并且没有一个很好的使用它的约定(我们的XML将使用camelCase而不是snake_case)。</p><h2 id="e1a3" class="jv jw hi bd jx jy jz ka kb kc kd ke kf iq kg kh ki iu kj kk kl iy km kn ko kp bi translated"><a class="ae jd" href="https://developer.android.com/topic/libraries/data-binding" rel="noopener ugc nofollow" target="_blank">数据绑定</a></h2><p id="2e12" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">我们知道另一种方法是使用数据绑定，google提议这样你可以绑定UI组件并与逻辑共享数据，或者我们知道它是双向绑定。例如，在我们的XML中，我们可以做类似于<code class="du kv kw kx ky b">&lt;TextView android:text="@{viewmodel.text}" /&gt;</code>的事情，哇，这很好，我们现在可以更快地编码，但是，我们需要更长的构建时间，在我们用于数据绑定的每个XML上有许多样板<code class="du kv kw kx ky b">&lt;layout&gt;</code>标记。它解决了我们的<strong class="ih hj"> NullPointerException </strong>问题，它提供了正确的参考，它支持Java和Kotlin，但是我们是否想浪费时间等待Android Studio来构建我们的项目，对我来说，我不想要它。😢</p><h2 id="25c0" class="jv jw hi bd jx jy jz ka kb kc kd ke kf iq kg kh ki iu kj kk kl iy km kn ko kp bi translated"><a class="ae jd" href="https://developer.android.com/topic/libraries/view-binding" rel="noopener ugc nofollow" target="_blank">查看绑定</a></h2><p id="6c21" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">视图绑定在这里是我们的英雄，它可以解决我们所有已知的问题，它解决了<strong class="ih hj"> NullPointerException </strong>问题，它解决了错误的引用id问题，它支持Kotlin和Java，它需要做的代码更少，它没有像ButterKnife和DataBinding那样增加我们的构建时间。但是，为什么呢</p><p id="945f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">视图绑定<em class="kz"> </em>将为模块中的每个XML布局生成一个绑定对象。假设您有<code class="du kv kw kx ky b">activity_main.xml</code>，它将创建一个名为<code class="du kv kw kx ky b">ActivityMainBinding.java</code>的文件，您可以直接从您的逻辑文件中调用它。</p><p id="3b5f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">视图绑定是Kotlin友好的，因为所有属性都用<code class="du kv kw kx ky b">@Nullable</code>或<code class="du kv kw kx ky b">@NonNull</code>进行了注释，这样Kotlin就知道如何将它们公开为空安全类型。</p><h2 id="61da" class="jv jw hi bd jx jy jz ka kb kc kd ke kf iq kg kh ki iu kj kk kl iy km kn ko kp bi translated">如何在Activity、Fragments或CustomView上使用ViewBinding？</h2><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es la"><img src="../Images/22206dc54cc7d7ae371692fc3b2d7ea7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xyVoJwxYDEWRVPNwnweyag.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">首先，你需要将它添加到你的“build.gradle”模块中，为app 添加“build.gradle”</figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lb"><img src="../Images/0e0bb28e2f33106e27d6afded43d159c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BAaW6s4obhEd9hGG_JRTvQ.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated"><strong class="bd jx">关于活动，你可以按照这个样本</strong></figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lc"><img src="../Images/1261bd023dd940393211630ef43c677a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xQEFNFkk7F1M2WYAkgIqpg.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated"><strong class="bd jx">对于一个片段，可以按照这个样本</strong></figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ld"><img src="../Images/3d5d9124192595c6d9533b4d35e875e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*euAnIzVbEwu-bNC_SIxGJw.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated"><strong class="bd jx">对于CustomView，您可以遵循此示例</strong></figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ld"><img src="../Images/964d005f9f4ac1e7cc838cb15b93730a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HJlS-tewf5yYIUvaX_yfrw.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated"><strong class="bd jx">用于回收查看适配器</strong></figcaption></figure><h2 id="65a3" class="jv jw hi bd jx jy jz ka kb kc kd ke kf iq kg kh ki iu kj kk kl iy km kn ko kp bi translated">如何在ParentActivity，ParentFragments上使用ViewBinding？</h2><p id="6e02" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">但是，我有一个父类/超类，我如何移动到ViewBinding？</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lc"><img src="../Images/64ef281d4c6712e2e5cc581bbf0fdce0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rYA-b95fpzls5gZ-kU46xw.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated"><strong class="bd jx">以防您将其用于活动层级</strong></figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ld"><img src="../Images/4ecdd519a31fd43ac39c5adadb8dd6ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lSFo85Twfw4SihPVeUedOQ.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated"><strong class="bd jx">如果你使用片段层次</strong></figcaption></figure><p id="1213" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当然，如果你想简化这些实现，你可以简化任何事情，而且没有解决所有问题的灵丹妙药，这是基于我目前的知识。如果你有什么要补充的，请告诉我。😃</p><p id="9442" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">参考:</strong></p><div class="le lf ez fb lg lh"><a href="https://proandroiddev.com/migrating-the-deprecated-kotlin-android-extensions-compiler-plugin-to-viewbinding-d234c691dec7" rel="noopener  ugc nofollow" target="_blank"><div class="li ab dw"><div class="lj ab lk cl cj ll"><h2 class="bd hj fi z dy lm ea eb ln ed ef hh bi translated">将过时的Kotlin Android Extensions编译器插件迁移到ViewBinding</h2><div class="lo l"><h3 class="bd b fi z dy lm ea eb ln ed ef dx translated">在Koltin 1.4.20-M2 JetBrains不赞成Kotlin Android扩展编译器插件。以下是原因和下一步要做的事情。</h3></div><div class="lp l"><p class="bd b fp z dy lm ea eb ln ed ef dx translated">proandroiddev.com</p></div></div><div class="lq l"><div class="lr l ls lt lu lq lv jo lh"/></div></div></a></div><div class="le lf ez fb lg lh"><a href="https://betterprogramming.pub/why-are-kotlin-synthetics-deprecated-and-what-are-the-alternatives-5c2b087dda1c" rel="noopener  ugc nofollow" target="_blank"><div class="li ab dw"><div class="lj ab lk cl cj ll"><h2 class="bd hj fi z dy lm ea eb ln ed ef hh bi translated">为什么Kotlin合成纤维被弃用，有什么替代品？</h2><div class="lo l"><h3 class="bd b fi z dy lm ea eb ln ed ef dx translated">比较使用哪一个:findViewById vs. Kotlin合成vs .数据绑定vs .视图绑定</h3></div><div class="lp l"><p class="bd b fp z dy lm ea eb ln ed ef dx translated">better编程. pub</p></div></div><div class="lq l"><div class="lw l ls lt lu lq lv jo lh"/></div></div></a></div></div></div>    
</body>
</html>