# åœ¨ Kubernetes ä¸Šä½¿ç”¨ Spring Boot å¯é åœ°è¿è¡Œ Cron ä½œä¸šçš„æŠ€å·§

> åŸæ–‡ï¼š<https://medium.com/codex/tips-to-run-cron-jobs-reliably-using-spring-boot-on-kubernetes-bb28052e8972?source=collection_archive---------1----------------------->

![](img/4b69d209250b5bef7348fbec3fa7a6f0.png)

è©¹å§†æ–¯Â·å“ˆé‡Œé€Šåœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) ä¸Šæ‹æ‘„çš„ç…§ç‰‡

Spring Boot æä¾›äº†ä¸€ç§éå¸¸ç®€å•çš„æ–¹æ³•ï¼Œä½¿ç”¨ [Spring Scheduler](https://www.baeldung.com/spring-scheduled-tasks) åœ¨åº”ç”¨ç¨‹åºä¸­è®¾ç½® Cron ä½œä¸šã€‚å®ƒå¯ä»¥å¾ˆå®¹æ˜“åœ°æ‰“åŒ…åˆ°ä¸€ä¸ªå®¹å™¨ä¸­ï¼Œå¹¶éƒ¨ç½²åœ¨ Kubernetes ä¸Šï¼Œå®ƒçš„å·¥ä½œéå¸¸æœ‰é­…åŠ›ã€‚

æˆ‘ä»¬æ‰€æœ‰çš„ç”Ÿäº§åº”ç”¨ç¨‹åºéƒ½ä½¿ç”¨ Spring Scheduler æ¥è¿è¡Œ cron ä½œä¸šã€‚ä¸€ä¸ªè­¦å‘Šæ˜¯ï¼Œåº”ç”¨ç¨‹åºå¯ä»¥åœ¨å•ä¸ª pod ä¸Šè¿è¡Œï¼Œå› ä¸ºå®ƒç¼ºä¹åœ¨å¤šä¸ªå®ä¾‹ä¸ŠåŒæ­¥è°ƒåº¦çš„èƒ½åŠ›ï¼Œè¿™æœ‰æ•ˆåœ°é™ä½äº† cron ä½œä¸šçš„å¼¹æ€§å’Œå¯é æ€§ã€‚

# æˆ‘ä»¬å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜ï¼Ÿ

## **è¿è¡Œå¤šä¸ª pod å‰¯æœ¬**

Shedlock éå¸¸æ–¹ä¾¿ï¼Œå› ä¸ºå®ƒæä¾›äº†ä¸€ç§åœ¨å¤šä¸ªå®ä¾‹ä¸ŠåŒæ­¥ä½œä¸šçš„æ–¹æ³•ï¼Œç¡®ä¿æˆ‘ä»¬è®¡åˆ’çš„ä½œä¸šåœ¨åŒä¸€æ—¶é—´åªè¿è¡Œä¸€æ¬¡ã€‚

æˆ‘å‘ç°è¿™ç¯‡ç”± Baeldung æ’°å†™çš„[æ–‡ç« ](https://www.baeldung.com/shedlock-spring)å¯¹äºåœ¨æ‚¨çš„ Spring Boot é¡¹ç›®ä¸­å¿«é€Ÿå¯åŠ¨ Shedlock éå¸¸æœ‰ç”¨ã€‚

**è¿˜ä¸å®Œç¾â€¦â€¦**

ç°åœ¨æˆ‘ä»¬èƒ½å¤Ÿåœ¨ K8s ä¸Šè¿è¡Œå¤šä¸ª pod å‰¯æœ¬ã€‚ä¸€åˆ‡çœ‹èµ·æ¥ä¸é”™ã€‚å”‰ï¼Œåœ¨ä¸€ä¸ªæ™´æœ—çš„æ—¥å­ï¼Œæˆ‘ä»¬æ³¨æ„åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œå½“é›†ç¾¤ä¸­æœ‰ä¸€ä¸ªè®¡åˆ’çš„ Kubernetes å‡çº§æ—¶ï¼Œç®¡ç†å‘˜ä»¥ç¿»è½¬çš„æ–¹å¼æ¸…ç©ºèŠ‚ç‚¹ï¼Œä¸å¹¸çš„æ˜¯ï¼Œæˆ‘ä»¬çš„ä¸¤ä¸ª cron æœåŠ¡ pods éƒ½è¢«å®‰æ’åœ¨åŒä¸€ä¸ªèŠ‚ç‚¹ä¸Šï¼Œå› æ­¤å®ƒä»¬åœ¨åŒä¸€æ—¶é—´å…³é—­ï¼Œå› æ­¤è®¡åˆ’çš„ä½œä¸šæ²¡æœ‰è¿è¡Œã€‚

## **ä½¿ç”¨ PDB**

ä¸ºäº†å‡è½»è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬åœ¨ Kubernetes ä¸­å°è¯•äº†ä¸€ä¸ªåä¸º [Pod ä¸­æ–­é¢„ç®—](https://kubernetes.io/docs/tasks/run-application/configure-pdb/) (PDB)çš„åŠŸèƒ½ï¼Œå®ƒå¯ä»¥é˜²æ­¢è¿™ç§è‡ªæ„¿çš„ç®¡ç†æ“ä½œè¢«æš‚åœï¼Œå¹¶ç¡®ä¿æˆ‘ä»¬åœ¨ä»»ä½•ç»™å®šçš„æ—¶é—´éƒ½æœ‰æœ€å°æ•°é‡çš„ Pod åœ¨è¿è¡Œã€‚

![](img/0a363a6445a02232bd0133bf8d257224.png)

æ‹¥æœ‰ä¸Šè¿° PDB å¯ä»¥ç¡®ä¿æˆ‘ä»¬åœ¨ä»»ä½•ç»™å®šçš„æ—¶é—´ç‚¹æ€»æ˜¯æœ‰ä¸€ä¸ªæœ‰ä¿è¯çš„ pod åœ¨ K8S é›†ç¾¤ä¸­è¿è¡Œã€‚

ç”Ÿäº§ç¯å¢ƒä¸­çš„æ‰€æœ‰ç”Ÿäº§ä½œä¸šç°åœ¨éƒ½åœ¨ä»¥å¯æ¢å¤çš„æ–¹å¼è¿è¡Œ:)

> å¦‚æœä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œè¯·èŠ±ç‚¹æ—¶é—´ä¸ºæˆ‘é¼“æŒğŸ‘(å¯ä»¥å¤šæ¬¡é¼“æŒ)ï¼Œå…³æ³¨æˆ‘ï¼Œç”šè‡³è¯·æˆ‘å–å’–å•¡[https://www.buymeacoffee.com/abhiandy](https://www.buymeacoffee.com/abhiandy)