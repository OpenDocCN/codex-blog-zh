# 更好的捕鼠器

> 原文：<https://medium.com/codex/the-better-mousetrap-66a4384c7e6e?source=collection_archive---------12----------------------->

## [法典](http://medium.com/codex)

## 程序员在疫情期间安排疫苗的方式。

由于大多数国家都在处理疫苗批次扩散到人群的问题，每个国家都采取了自己的策略，以最佳方式安排疫苗接种，以获得最佳效果。

![](img/259e8ec5c9e70f7ec6d596426c9738eb.png)

照片由[杰斯·贝利设计](https://www.pexels.com/@jessbaileydesign?utm_content=attributionCopyText&utm_medium=referral&utm_source=pexels)来自[派克斯](https://www.pexels.com/photo/black-framed-wayfarer-style-eyeglasses-on-white-surface-917293/?utm_content=attributionCopyText&utm_medium=referral&utm_source=pexels)

无论采取何种策略，有一点似乎在所有国家都很突出:从根本上缺乏对整个系统的工程监督，而且几乎所有的疫苗接种都远没有达到最佳效果。

我们将要做的练习的结果应该是一个调度应用程序，它处理来自每个用户的一组输入数据，来自管理部门的一组输入数据，并输出基本上是谁在哪里接种疫苗的逐日日历。

# 准备

我们的项目运行时间从 2020 年 11 月开始，届时有消息称新冠肺炎疫苗已经获得批准，一些国家已经开始使用。一旦获得对其拥有管辖权的监管机构的批准，疫苗基本上就可以使用了，所以唯一的问题是生产何时才能充分增加，以便开始大规模接种。此时，整个系统需要运行，至少在用户输入阶段，以便让用户有尽可能多的时间来表达他们的偏好。

这意味着项目的开始日期应该更早，并且，对于像我描述的这样的项目，我会说一个严肃的软件开发团队应该有大约 3 个月的工作时间。这意味着 2020 年 8 月。

这个时间框架不仅仅是为了让未来的项目经理兴奋。知道你的观众想要什么是很有价值的。如果一个国家的政府估计他们需要 100 万剂疫苗，而 300 万人在实际疫苗接种开始前就已经报名了，那么这就表明该国(或联邦，或欧盟，无论哪种情况)没有分配足够的资金，也没有获得足够的疫苗。提前知道你的员工想要什么是为他们的利益服务的最好方式，并为他们获得最甜蜜的交易。

# 用户输入

用户输入应该包括一组与将要施用的疫苗相关的参数。很自然，我们无法提前想到所有的疫苗，但是几乎所有疫苗的基本信息都可以提前想到。

每个用户都应该能够添加他们自己和他们管理的人(儿童、残疾人、老人，可能还有配偶，甚至宠物——谁知道可能需要什么疫苗——人畜共患病很棘手),对于每个人，应该询问一些细节:

*   全名
*   某种身份和/或公民身份证明(在罗马尼亚，有 PNC——个人数字代码——为每个公民唯一生成)
*   出生日期(如果无法获得，在罗马尼亚可以从 PNC 中提取)
*   这个人居住的地方
*   不管这个人是不是慢性疾病患者，或者是否有任何使他们处于更危险的状况
*   无论这个人是否有过活动性感染
*   不管这个人是不是医生
*   无论此人是否在关键部门积极工作
*   不管这个人是否在监狱里
*   无论该人是否有某种特殊身份，使其有资格进入某些闭路疫苗接种中心(如现役军人或外交使团)
*   无论该人是否怀孕，或是否正在哺乳(到目前为止，已经毫无疑问地证明，孕妇确实会传递抗体——如果预计婴儿会有一些疾病或易患因素，如自身免疫疾病，这是极其重要的)
*   无论此人是否已经死亡(在被安排之前)——不幸的是，这种情况可能发生
*   这个人是否有行动能力

除此之外，还应该为每个人添加联系数据，以电子邮件和电话号码的形式(除了被监禁或特殊身份)，用户的初步数据集是完整的。在每个阶段，可以根据同时发现的情况，请求新的信息，例如可能的相互作用(例如，如果您正在接受 Y 或 Z 药物治疗，请不要接种 X 型疫苗)。

# 行政和政府投入

管理的输入阶段稍微有点棘手。

输入需要围绕三个方面:疫苗特性、疫苗接种中心和优先等级。

## 疫苗特性

显然，我们需要疫苗的特性，以便正确和安全地分发它们。如果一种特定的疫苗只能分配给特定的年龄组，或者有任何特定的相互作用，这很重要。这些特征虽然不能提前预知，但实际上可以拯救生命。

不过，某些数据是可以预测的，比如疫苗适用的年龄范围。在替代疫苗已经存在的情况下，安排一个超过一定年龄的人接种一种特定类型的疫苗是没有意义的。

你可以预期的其他信息是每单位的疫苗剂量。由于用于大规模疫苗接种活动的疫苗很少(如果有的话)以单剂量包装出现(发生这种情况是非常不切实际的)，可以预期这些数据在以后的使用中是需要的。

想象一下，如果你愿意，你可以把这些数据和用户输入联系起来。你可以筛选出那些只能使用一种特定类型疫苗的人，你将知道你需要多少剂量的疫苗作为最小数量，以及如何分发。如果政府不依赖于储存第二剂疫苗(以防这是必要的)，他们也知道如何正确地提前计划。

## 疫苗接种中心

疫苗接种中心最重要的是它们的位置。这可以将接种者与疫苗接种中心联系起来，因此可以很好地规划疫苗的储存和分发路线。

如果您定义了一个具有特定位置的疫苗接种中心，您可以根据距离(或其他位置标准，如同一行政区划)自动获得可能的疫苗接种者的分布。通过将这些数据与用户输入相关联，您会得到一些东西。

首先，你得到一个指示，哪些中心工作不足，哪些中心工作过度；通过将最大距离标准添加到查询中，您可以得到一个指示，表明在哪里增加中心容量或开放更多中心是一个好主意，以便在中心之间进一步分配收件人。当然，这些数字可以在对疫苗数量的估计发生变化时进行调整(正如我们所看到的，基本上所有制药公司都过度夸大了它们的生产能力)，但它们仍然是一组强有力的指标。

效率也可以通过不同的方式实现。工作不足的中心很容易被发现，特别是在人口稀少或很少人愿意接受免疫的地区。在这种情况下，地方政府可以采取削减成本的措施，最终帮助更多的人，比如专用班车服务。通过为否则将被分配到工作不足的中心的一整组人手动设置时间表，并为他们提供往返于疫苗接种中心的班车，工作不足的中心可以提前从系统中移除，而不是允许他们浪费资源。

罗马尼亚的疫苗接种中心做出了一个特殊的决定，每个中心只能携带一种疫苗。这是为了避免在第二剂疫苗中接种不同于第一剂疫苗的错误。对于那些能够阅读罗马尼亚语并错过这条新闻的人来说，[这实际上发生在](https://www.digi24.ro/stiri/actualitate/pacient-imunizat-la-rapel-cu-moderna-in-loc-de-pfizer-o-asistenta-din-targu-jiu-a-incurcat-dozele-de-vaccin-1448977)之前。因此，假设我们会格外小心，将这一要求添加到我们的规范中，以提高安全性，并使物流规划更加容易。

因此，这将结束我们的疫苗接种中心的初始设置。

接下来，在疫苗接种阶段的运行时间内，每个中心可以显示当前期望服务的人数。由于我们在实际疫苗接种阶段开始之前就开始运行 web 应用程序，我们已经可以安排第一批人接种疫苗，并且我们在每个疫苗接种中心都有相当多的人可以安排未来许多天的接种。

再次以罗马尼亚的模式为例，疫苗接种物流在几个地区中心进行协调，以便于储存和分发到实际的疫苗接种中心。由于有特殊要求的疫苗，如辉瑞公司的疫苗，需要在零下 70 度以下的温度下储存，对单个疫苗接种中心来说是一个严重的负担，因此决定在区域中心大批量储存它们是有意义的。因此，让我们考虑区域中心的超级单元，以及依赖于它们的本地中心。

每当一批疫苗到达时，当局只需输入预计到达的总剂量。每个疫苗接种中心已经有一个等候名单，每个区域中心可以自动推断出它需要的剂量数。通过将输入剂量的一半除以区域中心的数量或每个疫苗接种中心等候名单中的最小人数(以较小者为准),我们可以计算出发送到每个区域中心进行分发的最小剂量数，剩余的剂量将根据每个中心等候名单的剩余数量进行分配，作为总等候人数的比例。一个简单而有效的算法，以确保每个中心得到一定比例的剂量削减，但没有中心可以得到超过他们需要的，也没有人被忽视，因为太少人登记。

## 优先等级

管理部门可以随时调整优先级。

最重要的是让那些接种了第一剂疫苗的人接种第二剂疫苗(如果需要的话)。如果接种疫苗的等待时间是 20 天，那么那些已经接种的人应该有绝对的优先权排在 20 天后。从本质上讲，一个中心可以像一个敏捷软件团队一样在时间上运作:一个 20 天的冲刺阶段，给人们注射第一剂疫苗，然后是 20 天的冲刺阶段，注射第二剂疫苗。从本质上来说，这是一个滴答冲刺的周期(嘿，我们已经设法在这一段中塞进了相当多的软件开发术语！).

否则，管理部门可以在任何时候自由决定谁在调度时获得优先权。例如，在特定的时间段内，教师比能源工作者具有更高的优先级。或者，他们可以在特定条件下完全停止接种疫苗(比如，发现疫苗对特定人群有严重副作用)。

然而，这样做的不良后果是，普通人对何时接种疫苗缺乏可预见性。一名商业工作者可以期待下周的某个时候接种疫苗，却发现其他类别已经优先接种，现在，他们突然被推迟大约三个月左右。理想情况下，优先级应该相当稳定，特别是从广义上来看(预计有风险的人总是优先于没有风险的人)，但应该允许变化，特别是如果一些中心可以是封闭的(只服务于特定的人群)。

出于这个原因，应该有某种稳定的时间，比如说 3 天，除非在极端情况下，否则时间表不能改变。这意味着，在该时间段内安排拍摄的人不会被优先级更高的人取代。应该选择一个时间框架，既要限制在较高优先级之前接种较低优先级疫苗的不良副作用，又要实际可行，并且对人们来说是可预测的。接种疫苗，尤其是在这种情况下，不是一件可以掉以轻心的事情，所以提供某种稳定是一个好主意。

# 整件事是如何运作的

整个系统基于简单的优先级查询来填充下一个稳定期的时间表(例如，3 天，但也可以延长到一周)。每个登记接种疫苗的人，基于某些特征，在队列中被分配一个位置，并且可以基于他们的移动因素被分配到中心。

一旦稳定期新的一天到来，每个疫苗接种中心都从队列中安排人，在日历中创建一个实际的时间表。第二天黎明，从优先队列中抽出一批新的人，并创建新的一天的时间表，等等。

一旦预定的日子到来，人们就会去接种疫苗。那里的工作人员应该能够为每个人输入疫苗接种状态，确保信息准确无误。每个接种过疫苗的人都会被自动安排第二次接种。

如果一个人没有出现，他们将被从日程中删除，并被放回队列中，这一次，每错过一次日程，障碍就会增加，错过几次(比如 3 次)后会受到惩罚。这确保了没有一个中心只剩下缺席。

如果某个位置因未出现而空着，该系统可以从队列中抽取，并且在成功出现并接种疫苗后，该人可以被安排接受第二剂疫苗并从队列中移除，从而确保不会浪费剂量。

由于该系统是实时的，当局对谁接种了疫苗、问题在哪里、需要多少剂量等等有一个清晰的了解，每个人都知道他们在队列中的位置以及有多少人接种了疫苗。

# 最后

这是一个简单的想象力练习，也是一个可能用于进一步流行病或大流行的可行产品。

当然，我们在新冠肺炎疫情看到的问题更多的是社会问题，而不是物流问题。例如，在罗马尼亚，考虑到我们接种了多少剂疫苗以及公众的利益，疫苗接种运动到目前为止进行得相当顺利。但是裂缝不在负责这场运动的军医身上，而是在人们自己身上。

从医生拒绝安排那些无法上网或太老而不能自己做的人的故事，到那些无法上网或没有手机信号的人，等等。(我不会链接到任何这些)，这些都是没有计算机系统会修复的问题。只要需要用户输入和同意，我建议的任何东西都将是一个简单的工具，或多或少有用。