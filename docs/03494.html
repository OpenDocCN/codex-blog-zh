<html>
<head>
<title>Web Scraping with BeautifulSoup</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">美声网刮</h1>
<blockquote>原文：<a href="https://medium.com/codex/web-scraping-with-beautifulsoup-66a3a2b3b60?source=collection_archive---------4-----------------------#2021-09-06">https://medium.com/codex/web-scraping-with-beautifulsoup-66a3a2b3b60?source=collection_archive---------4-----------------------#2021-09-06</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/ebcc4d391913d4fd7510fb0916530332.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*H5pO-cnF0PyGL_55"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">凯文·巴加特在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="fdf2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">网络抓取是从不同网站提取数据的过程。我们将看看如何从Indeed.com收集数据，这是一个流行的求职网站。在继续下一步之前，免责声明是检查条款和条件，无论你试图抓取的网站是否允许。在这种情况下，Indeed.com允许网页抓取，所以我们将进一步进行。</p><p id="0b6f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们将使用BeautifulSoup和请求库从indeed.com收集数据。</p><p id="d011" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">首先，我们用一个例子来了解一下URL的结构。</p><p id="7f5a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">https://in.indeed.com/jobsq=Data+Scientist URL =<a class="ae iu" href="https://in.indeed.com/jobs?q=Data+Scientist&amp;l=Bengaluru&amp;start=10" rel="noopener ugc nofollow" target="_blank">T5&amp;l = Bengaluru&amp;start = 10T7】</a></p><p id="36ea" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">“q”是您要搜索的职位的字符串。从上面的URL示例中，我们想搜索一份数据科学家的工作。因此，q将等于用“+”号分隔的字符串数据科学家。</p><p id="bf1b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">“l”是您要搜索的位置或城市的字符串。在上面的例子中，它是“Bengaluru”。</p><p id="a1f1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">“开始”表示您想要开始的结果。在我们的例子中，它是10。</p><p id="1b7b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们将使用这个URL结构来概括我们将要编写的函数。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es jt"><img src="../Images/b911410f7814e9cf090da7655a9a3df8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1296/format:webp/1*_HdXi-TQm8pxfRC12zX8Rw.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated"><a class="ae iu" href="https://in.indeed.com/" rel="noopener ugc nofollow" target="_blank">https://in.indeed.com/</a></figcaption></figure><p id="6509" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">每页一次显示15个结果。我们可以在URL中使用start参数来浏览结果。这个页面上的所有信息都用HTML标签编码。HTML(超文本标记语言)是一种编码，它告诉你的互联网浏览器在访问一个给定的页面时如何显示它的内容。这包括它的基本结构和顺序。HTML标签也有属性，这些属性有助于跟踪在页面结构中的什么位置可以找到什么信息。</p><p id="ae09" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Chrome用户可以通过右击页面并从出现的菜单中选择“检查”来检查页面的HTML结构。页面右侧会出现一个菜单，其中有一长串嵌套的HTML标签，包含当前显示在浏览器窗口中的信息。</p><p id="a676" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在让我们了解什么是请求模块，以及我们为什么需要它。它是一个python模块，可以用来发送所有类型的HTTP请求。这是一个易于使用的库，具有许多功能，从在URL中传递参数到发送自定义头和SSL验证。我们将使用它向我们的URL发送HTTP请求。</p><p id="a66b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">首先安装BeautifulSoup和Requests。现在，让我们来看看一步一步的过程中建立一个刮刀。</p><figure class="ju jv jw jx fd ij"><div class="bz dy l di"><div class="jy jz l"/></div></figure><p id="cbe8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，我们将通过Requests模块发送一个HTTP请求，看看是否能得到适当的响应。</p><figure class="ju jv jw jx fd ij"><div class="bz dy l di"><div class="jy jz l"/></div></figure><p id="fd77" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我碰到的很多教程都是使用urllib.request中的urlopen来取数据，不提供头。它用于伪装请求，否则您可能会遇到禁止的状态代码(HTTP错误403)。因此，在请求中使用报头非常重要。上面的代码给出了状态码200，这意味着请求被成功执行。在使用BeautifulSoup与网页建立连接后，我们将解析HTML并将对象存储在一个名为Soup的变量中。</p><p id="1f26" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，我们将获取各个职位的链接，然后提取公司、职位、位置和职位描述。有几种方法可以做到。我遇到的大多数教程都使用HTML树结构来访问链接。但是这种方法不起作用，因为页面结构发生了变化。相反，我们将遵循一种通用的方法，即使将来页面结构发生变化，它也能工作。因为这让我们了解了页面结构以及每个招聘信息的URL是如何嵌入的。</p><p id="24ab" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">单击链接所在的职位，然后右键单击“检查”。然后滚动找到“href”属性。它包含特定工作发布的链接。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ka"><img src="../Images/9e4cd0a46b6f7bf36da5f0ab495ed3b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uubdxEoM5hRJp7EMor5Sjw.png"/></div></div></figure><p id="4895" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果您向下滚动，可以看到所有的作业链接都是在一个<a>标记内的“href”属性中定义的。所以我们将提取嵌入在</a><a>标签中的所有‘href’属性。这将需要一点点探索你的网页，你一定会明白是怎么回事。</a></p><figure class="ju jv jw jx fd ij"><div class="bz dy l di"><div class="jy jz l"/></div></figure><p id="2982" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果您仔细查看该页面，您会看到工作链接遵循一种模式。在这种情况下，包含“/rc/clk”或“/company/”的链接都是作业链接。这可能会在未来发生变化，但肯定会有一种模式，你需要找到，然后你可以过滤招聘链接的链接。</p><figure class="ju jv jw jx fd ij"><div class="bz dy l di"><div class="jy jz l"/></div></figure><p id="28d8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，我们已经获得了工作发布的所有URL，我们将进一步提取我们想要的所有信息。</p><figure class="ju jv jw jx fd ij"><div class="bz dy l di"><div class="jy jz l"/></div></figure><p id="f068" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们理解上面的代码发生了什么。所以，上面的函数有两个参数，我们之前得到的URL列表和我们正在寻找工作的城市。现在，遍历每个URL，我们发送HTTP请求并获得一个soup对象。现在，让我们了解如何从每个URL中提取信息。</p><p id="97ba" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">请看下图。我正在检查一个这样的网址，它是我从求职页面中提取的。如果您右键单击作业标题并单击inspect，您会看到它包含在一个<h1>标记中，该标记的类名为“ICL-u-xs-MB—xs ICL-u-xs-mt—none jobsearch-JobInfoHeader-title”。使用类名，您可以访问所有URL的标题。</h1></p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kb"><img src="../Images/67eee3e16f48acbe225672f9dcb3e610.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5ipEelp2hD8n5jbePz6ieg.png"/></div></div></figure><p id="3a18" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">接下来，我们将看看公司名称。在检查公司名称时，我可以看到它被包含在一个<div>标签中。您可能会在某些页面上发现不同之处。对于一些招聘信息，我注意到公司名称也包含一个超链接。在这种情况下，将有一个<a>标记，它将有一个包含公司名称的文本和一个带有URL的href属性。而在其他情况下，公司名称不会有超链接，所以文本将直接在<div>标签下。在这两种情况下，您都可以通过提及div标记的类名来直接访问文本。在这里，公司名称在一个带有类名的<div>标签中:“ICL-u-LG-Mr-sm ICL-u-xs-Mr-xs”。</div></div></a></div></p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/2680764892410b8c377628246ae67b18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NkP6gpRRNm5ajIPqQpPtTg.png"/></div></div></figure><p id="0994" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，工作所在的位置或城市也包含在一个<div>标签中，标签的类名为:“jobsearch-inline company rating ICL-u-xs-mt—xs jobsearch-DesktopStickyContainer-company rating”。请注意，在许多URL中，包含城市名称的div标签没有任何类。我已经在异常处理中处理了这个场景，在这里我直接附加了我们已经在输入参数中提供的城市名称。</div></p><p id="63ae" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，我们到了最后一部分，职位描述。当您检查作业描述时，您会看到它被包含在另一个<div>标签中，标签的类名为:“jobsearch-jobDescriptionText”。请记住，在抓取数据时，您可能会遇到对URL的访问被拒绝的情况，因为您一次可以抓取多少数据是有限制的。因此，我在这里使用了异常处理。即使一些网址被封锁，你的代码不会失败。此外，一次发送太多请求是不明智的，你会开始得到Recaptcha，或者更糟的是你可能会被阻塞。为小型ML项目提取数据完全没问题。</div></p><p id="7fba" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在让我们巩固所有的知识，并编写最终的函数。</p><figure class="ju jv jw jx fd ij"><div class="bz dy l di"><div class="jy jz l"/></div></figure><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es kd"><img src="../Images/f916c7f9a5a9095d3d146428909418e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1372/format:webp/1*IAxEHhnSjEYIWH7sqBRlAA.png"/></div></figure><p id="a7db" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在上面的函数中，您只需要插入您想要搜索数据的目的地和城市，您将提取数据并存储在熊猫数据框中。</p><p id="b984" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">结论</strong></p><p id="a8e5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我已经整合了我所有的知识和我在学习网络抓取时遇到的问题。一旦你理解了一个HTML页面的基本结构以及我们如何使用它来提取数据，它就是你的数据科学技能组合中一个非常有用的工具。</p><p id="5666" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">完整代码请访问GitHub <a class="ae iu" href="https://github.com/vdhar1992/Web_Scraper" rel="noopener ugc nofollow" target="_blank">链接</a>。</p><p id="e5dc" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果您喜欢阅读，请关注我的<a class="ae iu" href="https://vaishali4175.medium.com/" rel="noopener">此处</a>了解更多数据科学内容，并在Linkedin上与我联系，我们很乐意与您谈论数据世界。</p><p id="caef" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">感谢阅读。</p></div></div>    
</body>
</html>