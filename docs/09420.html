<html>
<head>
<title>The Cryptographer’s Toolbox</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">密码学家的工具箱</h1>
<blockquote>原文：<a href="https://medium.com/codex/the-cryptographers-toolbox-5d31ef0f5058?source=collection_archive---------10-----------------------#2022-10-19">https://medium.com/codex/the-cryptographers-toolbox-5d31ef0f5058?source=collection_archive---------10-----------------------#2022-10-19</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><h2 id="6f84" class="hg hh hi bd b fp hj hk hl hm hn ho dx hp translated" aria-label="kicker paragraph">引用</h2><div class=""/><div class=""><h2 id="d918" class="pw-subtitle-paragraph io hr hi bd b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf dx translated"><em class="jg">出自</em> <a class="ae jh" href="https://www.manning.com/books/secret-key-cryptography?utm_source=medium&amp;utm_medium=referral&amp;utm_campaign=book_rubin_secret_12_27_21" rel="noopener ugc nofollow" target="_blank"> <em class="jg">秘钥密码术</em> </a> <em class="jg">作者弗兰克·鲁宾</em></h2></div><p id="1e53" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated"><em class="ke">本文涵盖:</em></p><ul class=""><li id="cc5d" class="kf kg hi jk b jl jm jo jp jr kh jv ki jz kj kd kk kl km kn bi translated"><em class="ke">用于密码的评级系统</em></li><li id="8a7c" class="kf kg hi jk b jl ko jo kp jr kq jv kr jz ks kd kk kl km kn bi translated"><em class="ke">替代密码</em></li><li id="3eae" class="kf kg hi jk b jl ko jo kp jr kq jv kr jz ks kd kk kl km kn bi translated"><em class="ke">换位密码</em></li><li id="4739" class="kf kg hi jk b jl ko jo kp jr kq jv kr jz ks kd kk kl km kn bi translated"><em class="ke">分割，将字母分割成更小的单元</em></li><li id="fbb2" class="kf kg hi jk b jl ko jo kp jr kq jv kr jz ks kd kk kl km kn bi translated"><em class="ke">伪随机数发生器</em></li></ul></div><div class="ab cl kt ku gp kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="hb hc hd he hf"><p id="e952" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">在<a class="ae jh" href="https://www.manning.com/books/secret-key-cryptography?utm_source=medium&amp;utm_medium=referral&amp;utm_campaign=book_rubin_secret_12_27_21" rel="noopener ugc nofollow" target="_blank">manning.com</a>的结账处，将<strong class="jk hs"> fccrubin </strong>输入折扣码框，即可享受<a class="ae jh" href="https://www.manning.com/books/secret-key-cryptography?utm_source=medium&amp;utm_medium=referral&amp;utm_campaign=book_rubin_secret_12_27_21" rel="noopener ugc nofollow" target="_blank"> <em class="ke">密钥加密</em></a>35%的折扣。</p></div><div class="ab cl kt ku gp kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="hb hc hd he hf"><p id="b65d" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">秘密密钥密码是由一些基本元素构成的。你可以认为这些是交易的工具。要构建一个强大的密码，你需要工具箱中的所有这些工具。这并不意味着你应该使用每个密码中的每个元素。这可能会导致额外的复杂性，而不会提高安全性。你的密码会更慢，没有额外的好处。这篇文章涵盖了替换，换位，分馏和随机数。</p><p id="24cd" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">在讨论元素之前，先说实力。密码的强度是用比特来衡量的。每一位代表一个二进制选择。如果有一个密码，其中每个密文只能代表两个可能的明文之一，那么该密码的强度将为1位。举个例子，</p><p id="9bf8" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">0 =我们输了。</p><p id="bc05" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">1 =我们赢了。</p><p id="524a" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">密钥的大小是决定密码强度的一个限制因素。如果密码使用64位密钥，那么它的强度不能超过64位，但是如果密码较弱，强度可以更小。</p><figure class="lb lc ld le fd lf er es paragraph-image"><div class="er es la"><img src="../Images/416e354e361ebc7457910f5c95bfaed1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/format:webp/0*c6W3L1rabrrv2KJp.png"/></div></figure></div><div class="ab cl kt ku gp kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="hb hc hd he hf"><h2 id="4dd7" class="li lj hi bd lk ll lm ln lo lp lq lr ls jr lt lu lv jv lw lx ly jz lz ma mb ho bi translated"><strong class="ak">评级系统</strong></h2><p id="610f" class="pw-post-body-paragraph ji jj hi jk b jl mc is jn jo md iv jq jr me jt ju jv mf jx jy jz mg kb kc kd hb bi translated">为了让您对密码的优势有一个总体的感觉，我将密码分为一到十个等级。这些是我的个人评级，基于我的经验和我对使用我所知的最佳技术破解密码需要多少努力的分析，以及这些密码相互之间以及与实践中被破解或未被破解的历史密码的比较。我在每个评级之前的部分给出了很多分析。</p><ul class=""><li id="cfe8" class="kf kg hi jk b jl jm jo jp jr kh jv ki jz kj kd kk kl km kn bi translated">一个表示一个密码，没有受过训练的初学者只用纸和笔，适度的努力就能破解。</li><li id="c895" class="kf kg hi jk b jl ko jo kp jr kq jv kr jz ks kd kk kl km kn bi translated">二表示一个有经验的业余爱好者或爱好者只用纸和铅笔就能破解的密码。</li><li id="9b2f" class="kf kg hi jk b jl ko jo kp jr kq jv kr jz ks kd kk kl km kn bi translated">三是一个熟练的业余密码学家可以用手工破解的密码。</li><li id="d098" class="kf kg hi jk b jl ko jo kp jr kq jv kr jz ks kd kk kl km kn bi translated">四五个意味着需要一台电脑，一个训练有素的密码师，或者两者都需要。</li><li id="8141" class="kf kg hi jk b jl ko jo kp jr kq jv kr jz ks kd kk kl km kn bi translated">从6到9表示一个专家对手需要多少计算能力。</li><li id="a2c9" class="kf kg hi jk b jl ko jo kp jr kq jv kr jz ks kd kk kl km kn bi translated">10表示一种可以对抗国家密码机构的密码，国家密码机构拥有大量训练有素的密码学家，使用当今最大的超级计算机。</li></ul><p id="1b21" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">有时我会超出范围。零表示不需要纸笔就能理解密码，如猪拉丁或<code class="du mh mi mj mk b">GNITIRW</code> <code class="du mh mi mj mk b">EHT</code> <code class="du mh mi mj mk b">SDROW</code> <code class="du mh mi mj mk b">SDRAWKCAB</code>。11的评级意味着该密码将经得起未来潜在的超级计算机的考验，远远强于量子计算机或我们目前设想的超级计算机。</p><p id="c7b1" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">通过看我如何评价不同的密码，你可以得到如何评价你在别处看到的或你自己发明的密码的要点。每个评级只是一个估计，并不能保证实力。</p><h2 id="19d7" class="li lj hi bd lk ll lm ln lo lp lq lr ls jr lt lu lv jv lw lx ly jz lz ma mb ho bi translated"><strong class="ak">换人</strong></h2><p id="30aa" class="pw-post-body-paragraph ji jj hi jk b jl mc is jn jo md iv jq jr me jt ju jv mf jx jy jz mg kb kc kd hb bi translated">密码学家工具箱中的第一个工具是替换。课文中一个单位代替另一个单位。明文单元可以是单个字母、成对字母或更长的块。密文单元可以是字母、字母组、数字组或字母-数字组合。当所有单元都是单字母时，该密码称为<em class="ke">简单替换</em>或<em class="ke">单字母密码</em>。在计算机密码学中，单位可以是比特、字节或任意长度的比特或字节块。本节简要介绍了一下。</p><p id="2def" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">已知的最古老的替代密码之一是凯撒密码，由朱利叶斯·凯撒使用并可能发明，其中字母表的每个字母被后面3个位置的字母替代。在现代使用中，这可能是任何固定数量的位置更早或更晚。凯撒密码被评为一级。</p><p id="d29b" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">不要求所有明文单元都具有相同的长度。假设密码采用字母表中的字母并替换成2位数对。字母表只有26个字母，但有100个可能的数字对。这意味着有74对额外的密码可以用于其他目的。一种已经使用了数百年的方法是提供普通字母对的替代，例如TH、er、on、as和NT，以及除了单个字母之外的可能的短单词，例如and和。明文单元的长度将是1、2或3个字母。这使得数字对的频率更加一致。因为字母频率的差异可以用来解密码，所以让频率更均匀会让密码更强。</p><p id="eee1" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">另一种方法是使用额外的对来为一些常见的字母提供额外的替代。这叫<em class="ke">谐音</em>替代。例如，您可以为E提供10个替代项，为T提供8个替代项，依此类推。给定字母的多个替代字母被称为<em class="ke">同音字</em>。这类似于英语中同音字F和PH都代表同一个音。提供多个替代项使得100位数字对的频率更加均匀。自然，字母对和谐音替换这两种方法可以结合使用，以获得数字对更均匀的频率。换句话说，这些方法阻止对手使用频率分析。</p><h2 id="1067" class="li lj hi bd lk ll lm ln lo lp lq lr ls jr lt lu lv jv lw lx ly jz lz ma mb ho bi translated"><strong class="ak">霍夫曼码</strong></h2><p id="9c14" class="pw-post-body-paragraph ji jj hi jk b jl mc is jn jo md iv jq jr me jt ju jv mf jx jy jz mg kb kc kd hb bi translated">在计算机环境中，密文单元可以是比特串。一个很好的例子是Huffman编码，它是由David A. Huffman于1952年在麻省理工学院上学时开发的。我不会讨论优化代码集的方法，我只会给出一个变长二进制代码的例子的一般概念。在霍夫曼编码中，最频繁的字母得到短码，而较少的字母得到长码，这是基于底层的字母频率表。因此，需要更少的比特来表达消息。这叫做<em class="ke">文本压缩</em>。</p><p id="532f" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">英语中最常见的字母是E和T，它们各出现1/8的时间。由于8=23，我们使用3位来表示E和T。我们可以任意选择任何3位值，比如E=100和T=111。我把这种方法叫做混合霍夫曼。下一个最常见的是A、O、I、N、S、R、h，每一个出现的时间大约是1/16，所以我们用4位来表示每一个。我们可以使用任何4位代码，除了已经使用的以100或111开头的代码。下一组字母是D、L、U、C、M、F、Y，每组出现的时间约为1/32，因此需要5位代码。诸如此类。</p><p id="3177" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">这是我根据150，000个英文字母的计数创建的一组混合霍夫曼代码。其他语言各不相同。霍夫曼码具有<em class="ke">前缀属性</em>，即没有任何码是任何更长码的前缀。例如，如果<strong class="jk hs"> abcd </strong>是一个代码，那么<strong class="jk hs">ABCD</strong>不可能也是二进制数字a、b、c、d、e的任意选择的代码。前缀属性是由数学家埃米尔·莱昂·波斯特在1920年首次描述的。</p><pre class="lb lc ld le fd ml mk mm mn aw mo bi"><span id="8e16" class="li lj hi mk b fi mp mq l mr ms">E 100     D 00000     P 010010     <br/>         T 111     L 01000     B 010011     <br/>         A 0001    U 10110     V 110101     <br/>         O 0010    C 10111     K 1101000    <br/>         I 0011    M 11000     X 11010011   <br/>         N 0101    F 11001     Q 110100101<br/>         S 0110    Y 11011     J 1101001000<br/>         R 0111    W 000010    Z 1101001001<br/>         H 1010    G 000011</span></pre><p id="4e4d" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">使用这些代码组，单词STYLE将被编码为<code class="du mh mi mj mk b">0110</code> <code class="du mh mi mj mk b">111</code> <code class="du mh mi mj mk b">11011</code> <code class="du mh mi mj mk b">01000</code> <code class="du mh mi mj mk b">100</code>。以4位为一组进行重写，得到十六进制的<code class="du mh mi mj mk b">0110</code> <code class="du mh mi mj mk b">1111</code> <code class="du mh mi mj mk b">1011</code> <code class="du mh mi mj mk b">0100</code> <code class="du mh mi mj mk b">0100</code>。</p><p id="1e43" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">虽然Emily几乎不可能识别密文中单个字母的代码组，但Emily可以搜索更长的重复位串。这些将代表常见的字母对，称为<em class="ke">二元组</em>，字母三元组，称为<em class="ke">三元组</em>，或单词。例如，任何给定的10位字符串应该每210或1024次出现一次。如果一个10位字符串在1024个字符串中出现20次或更多次，那么它几乎肯定代表单词the，这是英语中最常见的单词。如果你已经在一篇文章中识别出单词the，那么你可以寻找像THERE或THESE这样的扩展名，因为重复的e，所以很容易被发现。</p><h2 id="d159" class="li lj hi bd lk ll lm ln lo lp lq lr ls jr lt lu lv jv lw lx ly jz lz ma mb ho bi translated"><strong class="ak">换位</strong></h2><p id="a2c5" class="pw-post-body-paragraph ji jj hi jk b jl mc is jn jo md iv jq jr me jt ju jv mf jx jy jz mg kb kc kd hb bi translated">第二个主要的加密工具是换位，改变消息中字符的顺序。最简单的方法是<em class="ke">路线换位</em>。消息的字母按一个顺序被写入一个矩形，并按不同的顺序读出。本节简要介绍了这方面的实践。</p><p id="14d3" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">例如，有25个字母的信息“小偷之间没有爱”从左到右横着写在这个5×5的网格中，并沿着列从上到下读出。当从上到下阅读时，该网格中最左边的列是<code class="du mh mi mj mk b">TIOOI</code>。</p><pre class="lb lc ld le fd ml mk mm mn aw mo bi"><span id="d93d" class="li lj hi mk b fi mp mq l mr ms">T H E R E     Plaintext:  THERE IS NO LOVE AMONG THIEVES<br/>         I S N O L<br/>         O V E A M     Ciphertext:  TIOOI HSVNE ENEGV ROATE ELMHS<br/>         O N G T H<br/>         I E V E S</span></pre><p id="49ff" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">将字母写入网格以及将字母从网格中读出的常见路线包括直着穿过行、向左或向右、直着向上或向下穿过列、交替向左和向右穿过行、交替向上和向下穿过列、对角地从任何角落开始、对角地交替方向、或者顺时针或逆时针螺旋。路由转置密码被评定为一级。</p><h2 id="2c14" class="li lj hi bd lk ll lm ln lo lp lq lr ls jr lt lu lv jv lw lx ly jz lz ma mb ho bi translated"><strong class="ak">分馏</strong></h2><p id="19b3" class="pw-post-body-paragraph ji jj hi jk b jl mc is jn jo md iv jq jr me jt ju jv mf jx jy jz mg kb kc kd hb bi translated">分割是将字符分割成更小的单元。我们已经看到一种方法，用二进制数表示一个字符。该二进制数的每一位都可以作为一个独立的单元进行处理、替换或转置。本节介绍分馏。</p><p id="7b45" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">将一个字母表示为两位数的经典方法是波利比乌斯方块，它是由希腊历史学家波利比乌斯在公元前二世纪发明的。这是一个5×5的正方形，使用混合字母表和关键字SAMPLE。请注意，字母I和J共享一个单元格，以使26个字母的字母表适合25个单元格的网格。</p><pre class="lb lc ld le fd ml mk mm mn aw mo bi"><span id="a872" class="li lj hi mk b fi mp mq l mr ms">1  2  3  4  5<br/>         1  U  V  W  X  Y     A mixed Polybius Square using<br/>         2  Z  S  A  M  P     the keyword SAMPLE<br/>         3  L  E  B  C  D<br/>         4  F  G  H  IJ  K<br/>         5  N  O  Q  R  T</span></pre><p id="4ab7" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">因为A在单元格3的第2行，所以用23表示。b是33，C是34，以此类推，直到用21表示的Z。I和J都用44表示。然后，这些数字可以用各种方式替换、调换和重新组合。使用这个格子，或者以不同的混合顺序排列的另一个波利比乌斯方块，可以将成对的数字变回字母。</p><p id="bc95" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">现代版本会用ASCII或UTF 8码中的十六进制表示来替换每个字符。因此A=41，B=42，C=43，一直到Z=5A。这些十六进制数字同样可以被替换、转置、重新分组并变回字节。</p><p id="f701" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">一个有趣的例子是M. E .欧哈弗在1910年发明的分馏莫尔斯电码。欧哈弗总是用M.E .来称呼他，因为他不喜欢他的名，即莫尔。</p><p id="2c21" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">在分段莫尔斯电码中，字母被分成固定大小的组，比如7个，然后用/作为字母分隔符，替换成对应的莫尔斯电码。然后，代码组的长度被反转，并且调整大小的组被变回字母。</p><pre class="lb lc ld le fd ml mk mm mn aw mo bi"><span id="4fed" class="li lj hi mk b fi mp mq l mr ms">E X    A  M  P    L    E   Plaintext<br/>         ·/-··-/·-/--/·--·/·-··/·   Morse equivalents<br/>         1 4    2  2  4    4    1   Code group lengths<br/>         1 4    4    2  2  4    1   Lengths in reverse order<br/>         ·/-··-/·---/·-/-·/·-··/·   Regrouped Morse<br/>        E X    J    A  N  L    E   Equivalent letters</span></pre><p id="243b" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">莫尔斯电码是阿尔弗雷德·维尔在1840年发明的，并以他的雇主塞缪尔·f·b·莫尔斯的名字命名。</p><p id="3d3a" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">这种密码有几个明显的弱点。由于它使用标准的莫尔斯字母表，唯一的关键是字母组的长度，只需几次尝试就可以猜到。明文字母经常被自己代替。有30个不同的莫尔斯电码组，但只有26个字母，所以需要4个额外的字符。欧哈弗使用了日耳曼语的、和。分馏莫尔斯被评为一级。</p><p id="73e1" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">这些问题可以通过两个改变得到部分解决:(1)只使用长度为1、3和4的莫尔斯群。有26个这样的组，完全符合26个字母的字母表。(2)打乱字母表的顺序，或者，等价地，打乱莫尔斯码组的顺序。我称之为加强版的动作莫尔斯。例如，使用关键字MIXEDALPHBT将字母表与莫尔斯组按标准顺序混合，您会得到:</p><pre class="lb lc ld le fd ml mk mm mn aw mo bi"><span id="15bd" class="li lj hi mk b fi mp mq l mr ms">M ·     P -·-    Y ·-··   N -·--  <br/>         I -     H --·    Z ·-·-   O --··<br/>         X ···   B ---    C ·--·   Q --·-<br/>         E ··-   T ····   F ·---   R ---·<br/>         D ·-·   U ···-   G -···   S ----<br/>         A ·--   V ··-·   J -··-  <br/>         L -··   W ··--   K -·-·</span></pre><p id="92f7" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">即使有这些改进，FR-actioned莫尔斯被评为只有两个。</p><h2 id="5e9a" class="li lj hi bd lk ll lm ln lo lp lq lr ls jr lt lu lv jv lw lx ly jz lz ma mb ho bi translated"><strong class="ak">随机数发生器</strong></h2><p id="4df7" class="pw-post-body-paragraph ji jj hi jk b jl mc is jn jo md iv jq jr me jt ju jv mf jx jy jz mg kb kc kd hb bi translated">随机数生成器可以是在给定范围内产生一系列数字的任何东西。这些数字可以是一位、8位字节、十进制数字或任何其他所需范围内的数字。例如，在0到25范围内的数字，对应于字母表中的26个字母，对于一些加密目的是有用的。本节介绍这个主题。</p><p id="2e5f" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">认识到没有“随机数”这种东西是很重要的。你不能说51是一个随机数，而52不是，反之亦然。然而，你可以说51、52、53、54……的顺序不是随机的。这个顺序是完全可以预测的。随机性是序列或发生器的一种属性，而不是序列中单个数字的属性。说“随机数字序列”比“随机数字序列”更准确</p><p id="6e52" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">发电机可能是一个物理过程，如宇宙射线，盖革计数器的乒乒乓乓，计算机按键的精确计时，在强风中飘扬的旗帜，海浪撞击的浪花或赶火车的人群。大多数物理源对于加密目的来说不够快，但是数字序列可以存储在计算机文件中以备后用。</p><p id="6239" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">生成器也可以是一个数学函数或计算机程序，每次被调用时都会产生一个数字。由数学算法产生的随机数称为<em class="ke">伪随机</em>数，以区别于<em class="ke">真随机</em>数。它们被认为比真正的随机数弱，因为确定随机序列的一部分的对手可能能够计算出前面和后面的数字，从而读取消息。数学函数永远不会产生真正的随机数。</p><p id="e961" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">伪随机序列和真随机序列的一大区别是伪随机序列最终会重复，而真随机序列从不重复。序列重复之前的项数称为其<em class="ke">周期</em>。例如，序列3，1，9，2，4，3，1，9，2，4，3，1，9，2，4，3…有一个带下划线的句点5。一般来说，周期越长，密码越强。</p><p id="f464" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">仅仅因为一个数字序列是随机的，并不意味着这些数字是同样可能的。例如，假设你正在观察穿过一座繁忙的桥的汽车的颜色。颜色是随机的，但某些颜色比其他颜色更常见。白色、黑色、银色和红色远比橙色、紫红色或黄绿色更常见。类似地，在掷骰子的游戏中，如果骰子是公平的，那么每次投掷都是随机的，然而投掷7的可能性是投掷12的六倍。</p><p id="d047" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">让我们假设任何一个随机数发生器产生的数字都是等概率的(并不总是这样)。这被称为<em class="ke">均匀分布</em>，或<em class="ke">等概率分布</em>。有了一个好的随机数生成器，生成的数字的对和三等也将具有统一的概率，也许会达到八倍甚至更高。</p><h2 id="9da0" class="li lj hi bd lk ll lm ln lo lp lq lr ls jr lt lu lv jv lw lx ly jz lz ma mb ho bi translated"><strong class="ak">链式数字发生器</strong></h2><p id="9ae7" class="pw-post-body-paragraph ji jj hi jk b jl mc is jn jo md iv jq jr me jt ju jv mf jx jy jz mg kb kc kd hb bi translated">让我用一个伪随机数发生器的例子来结束这一节，这个例子可以用纸和笔很容易地完成。不需要电脑。让我们称之为链式数字发生器。从写任何7位十进制数开始。这7位数字称为<em class="ke">种子、</em>或<em class="ke">初始值</em>，或<em class="ke">初始化向量</em>。它们可以被认为是包含该生成器的任何密码的密钥或密钥的一部分。要获得第一个伪随机数，只需将第一个和最后一个数字相加。将这个新数字添加到序列中，并涂黑第一个数字。所以，从3920516开始，我们加3+6得到9。</p><figure class="lb lc ld le fd lf er es paragraph-image"><div class="er es mt"><img src="../Images/c4c7fc52e69822a2285a0c36057caef1.png" data-original-src="https://miro.medium.com/v2/resize:fit:208/format:webp/0*QI4JC1DC0E_Wb5iB.png"/></div></figure></div><div class="ab cl kt ku gp kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="hb hc hd he hf"><p id="bf66" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">每当总数超过9时，我们就去掉十位数。也就是说，加法是以10为模进行的。为了得到第二个伪随机数，我们重复这个过程。这里9+9等于18。我们去掉十位数得到8。</p><figure class="lb lc ld le fd lf er es paragraph-image"><div class="er es mu"><img src="../Images/3dbb63204168f2bdbfb0cef686c8063e.png" data-original-src="https://miro.medium.com/v2/resize:fit:216/format:webp/0*KwRIGVrfYlW_nvr3.png"/></div></figure></div><div class="ab cl kt ku gp kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="hb hc hd he hf"><p id="fbcd" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">这个过程可以重复进行，以获得所需数量的伪随机十进制数字。</p><pre class="lb lc ld le fd ml mk mm mn aw mo bi"><span id="fb1b" class="li lj hi mk b fi mp mq l mr ms">39205169800562199940232...</span></pre><p id="15f5" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">产生的伪随机序列是<code class="du mh mi mj mk b">9800562199940232...</code></p><p id="6739" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">请注意，如果种子中的所有数字都是偶数，那么所有生成的数字都将是偶数。同样，如果所有数字都可以被5整除，即0或5，那么所有生成的数字都可以被5整除。在这种情况下，周期可能不超过128，因为种子中有7个数字，只有27=128个可能的0和5的组合。因为这种种子不能产生长周期，所以它们被称为<em class="ke">不合格</em>。对于链式数字生成器，一个<em class="ke">合格的</em>种子必须包含至少一个奇数和一个不是5的倍数的数字。比如2222225是合格的种子，但是2222222和5555555是不合格的。对于合格的7位数种子，周期将始终为2，480，437。</p><p id="dc96" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">该发生器具有典型的自制伪随机数发生器的行为。有107个可能的7位数种子。如果您从任何一个种子开始，生成器将循环通过某个数字序列，直到它再次生成该种子，因此7位数的集合被划分为几个离散的循环，每个循环都有自己的周期。如果你选择了一个合格的种子，那么循环将总是有2，480，437个数字的最大可能周期。这个长度有4个独立的周期，加上不合格种子产生的几个更短的周期。</p><p id="fdbe" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">对于其他大小的种子，该行为是类似的。即使当最大循环非常短时，也经常有很高的概率获得最大循环，因为可能有许多最大循环。下表显示了使用合格种子获得给定长度周期的概率:</p><figure class="lb lc ld le fd lf er es paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="er es mv"><img src="../Images/689d748f783b40c65544e7bb38062f16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*inU4VI9lmLFIgHXmSMoURQ.png"/></div></div><figcaption class="na nb et er es nc nd bd b be z dx translated">表1</figcaption></figure><p id="cf52" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">该表显示，5位数和8位数的种子长度是不安全的。它们产生很大比例的非常短的周期。7和10位数的种子长度是最好的，因为你总是保证有一个长的周期。</p><p id="2e06" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">这个随机数生成器严格来说是一个演示模型，只是为了展示使用简单的手工方法可以实现什么。不适合高安全性的工作。</p><h2 id="7c0a" class="li lj hi bd lk ll lm ln lo lp lq lr ls jr lt lu lv jv lw lx ly jz lz ma mb ho bi translated"><strong class="ak">有用的组合，浪费的组合</strong></h2><p id="a1ad" class="pw-post-body-paragraph ji jj hi jk b jl mc is jn jo md iv jq jr me jt ju jv mf jx jy jz mg kb kc kd hb bi translated">这篇文章中的4种基本技术可以有无数种组合，我将在我即将出版的新书《牢不可破的密码学》中对此进行探讨。然而，重要的是从一开始就认识到，并不是每种组合都是有益的。有些组合增加了功，但没有增加力量。</p><p id="4eb4" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">考虑一些初学者尝试的想法。他们对消息执行简单的替换，然后对产生的文本执行第二次简单的替换，然后第三次，等等，进行5、10甚至100轮。这是白费力气。执行两个简单的替换和执行一个是一样的，但是使用不同的混合字母表，所以执行许多简单的替换不会增加任何力量。这里有一个例子。这两个替换混合了第一个和第二个键。第三次替换相当于先执行第一次替换，然后执行第二次替换。</p><pre class="lb lc ld le fd ml mk mm mn aw mo bi"><span id="0cd7" class="li lj hi mk b fi mp mq l mr ms">ABCDEFGHIJKLMNOPQRSTUVWXYZ    First substitution<br/>         XYZFIRSTABCDEGHJKLMONPQUVW<br/>         ABCDEFGHIJKLMNOPQRSTUVWXYZ    Second substitution<br/>         UVWXYZSECONDABFGHIJKLMPQRT<br/>         ABCDEFGHIJKLMNOPQRSTUVWXYZ    Equivalent<br/>         QRTZCIJKUVWXYSEONDAFBGHLMP</span></pre><p id="fe0f" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">让我们试一个例子。如果我们使用第一次替换对单词<code class="du mh mi mj mk b">EXAMPLE</code>进行加密，结果就是<code class="du mh mi mj mk b">IUXEJDI</code>。如果<code class="du mh mi mj mk b">IUXEJDI</code>用第二次替换加密，结果是<code class="du mh mi mj mk b">CLQYOXC</code>。你可以自己验证用等价替换加密<code class="du mh mi mj mk b">EXAMPLE</code>会产生<code class="du mh mi mj mk b">CLQYOXC</code>。</p><p id="2c98" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">执行一次加密然后执行第二次加密称为<em class="ke">，构成</em>两次加密。前面的例子表明，组合两个简单的替换只会产生另一个简单的替换。如果第一次加密使用一个代码，那么在代码之后使用一个密码称为<em class="ke">超级加密</em>。超级解密最常见的形式是非进位加法，或模10加法，其工作原理如下:</p><pre class="lb lc ld le fd ml mk mm mn aw mo bi"><span id="c604" class="li lj hi mk b fi mp mq l mr ms"><strong class="mk hs">12155 12155 12155 12155</strong>   Superencipherment key<br/> <strong class="mk hs">61587</strong> <strong class="mk hs">02954</strong> <strong class="mk hs">70069</strong> <strong class="mk hs">53028</strong>   Plaintext code groups<br/> <strong class="mk hs">73632 14009 82114 65173</strong>   Superenciphered code groups</span></pre><h2 id="ae5f" class="li lj hi bd lk ll lm ln lo lp lq lr ls jr lt lu lv jv lw lx ly jz lz ma mb ho bi translated"><strong class="ak">baz eries 4型密码</strong></h2><p id="cce9" class="pw-post-body-paragraph ji jj hi jk b jl mc is jn jo md iv jq jr me jt ju jv mf jx jy jz mg kb kc kd hb bi translated">我们来看看相反的情况。让我们来看一个密码，使用一个替换步骤，然后进行一个非常简单的转置，产生一个更强的密码。</p><p id="8cf5" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">这种密码是由才华横溢、脾气暴躁且爱责骂人的法国密码学家tienne Bazeries在1898年提出的。我不知道Bazeries给这个密码起了什么名字。我称之为Bazeries Type 4，因为这是他在19世纪90年代向外交使团提出的4种密码中的最后一种。这很容易用手工完成。</p><p id="1abf" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">Bazeries类型4由简单的替换和简单的转置组成，我称之为<em class="ke">分段反转</em>。转置根据一个键(一系列小整数)反转文本的小段。这里有一个例子，使用关键字BAZERIS来混合替换字母表，使用关键字4，2，3来进行移调。</p><pre class="lb lc ld le fd ml mk mm mn aw mo bi"><span id="e443" class="li lj hi mk b fi mp mq l mr ms">ABCDEFGHIJKLMNOPQRSTUVWXYZ   Plaintext alphabet<br/> HGFDCBAZERISYXWVUTQPONMLKJ   Ciphertext alphabet<br/> THEQUICKBROWNFOXJUMPSOVERTHELAZYDOG   Message plaintext<br/> PZCUOEFIGTWMXBWLROYVQWNCTPZCSHJKDWA   After substitution<br/> 4    2  3   4    2  3   4    2  3   4    2  3   Transposition key<br/> PZCU OE FIG TWMX BW LRO YVQW NC TPZ CSHJ KD WA<br/> UCZP EO GIF XMWT WB ORL WQVY CN ZPT JHSC DK AW  Final ciphertext<br/> UCZPE OGIFX MWTWB ORLWQ VYCNZ PTJHS CDKAW  Ciphertext grouped by fives</span></pre><p id="7cde" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">这种类型的置换可以用来加强许多不同类型的密码，所以它应该有自己的名字。姑且称之为分段反转。更强的分段换位密码可以混合文本的正向和反向部分，就像这个使用数字键3，4，-3，2的例子。</p><pre class="lb lc ld le fd ml mk mm mn aw mo bi"><span id="dd1c" class="li lj hi mk b fi mp mq l mr ms">3   4    -3  2   3   4    -3  2   3   4    -3  2  <br/> THE QUIC KBR OW  NFO XJUM PSO VE  RTH ELAZ YDO GS  Plaintext<br/> EHT CIUQ KBR WO  OFN MUJX PSO EV  HTR ZALE YDO SG  Transposed</span></pre><p id="5b6c" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">奇夫勒局的密码学家无法破解巴泽里提供的任何样本信息。尽管付出了相当大的努力，这些消息仍然没有解决40年，直到著名的建筑师和业余密码学家罗萨里奥·坎德拉解决了它们，并写了一本关于他如何做到这一点的书(《巴泽里司令官的军事密码》，卡尔达诺斯出版社:纽约，1938年)。</p><p id="69b4" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">然而，坎德拉无法直接解密这些信息。相反，他发现并利用了Bazeries从一把钥匙生成替代字母表的方式中的一个弱点。如果Bazeries使用了一种更强的混合密码字母的方法，坎德拉就不可能破译这些信息。因此，混合字母表的Bazeries类型4被评定为5。很好地结合了两种方法，每种方法都被评为一。</p><p id="9343" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">这里还有另一个历史趣闻:坎德拉是哥伦比亚建筑学院的毕业生，所以他计划在哥伦比亚大学出版社出版他的书。时任美国密码学家学院院长的威廉·f·弗里德曼(William F. Friedman)得到了这方面的风声，并秘密封锁了该出版物。这再次证明了Bazeries型密码的强度。</p><p id="67f6" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">本文到此为止。感谢阅读。</p></div></div>    
</body>
</html>