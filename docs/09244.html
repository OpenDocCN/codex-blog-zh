<html>
<head>
<title>How I made a YouTube downloader with NodeJS — NestJS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我如何用NodeJS制作一个YouTube下载器</h1>
<blockquote>原文：<a href="https://medium.com/codex/how-i-made-a-youtube-downloader-with-nodejs-nestjs-cd72e84163e9?source=collection_archive---------9-----------------------#2022-10-06">https://medium.com/codex/how-i-made-a-youtube-downloader-with-nodejs-nestjs-cd72e84163e9?source=collection_archive---------9-----------------------#2022-10-06</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/8388b4bc9384c72f2434d2a76b1741b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*hgtzA5jx1GpAsRZT.png"/></div></div></figure><p id="86a6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最近我很无聊，无事可做，所以我想用Flutter(对我来说是一个全新的堆栈)做一个音乐播放器。问题是我找不到一个好的来源来为我的应用程序获取音乐，于是我决定为自己创建一个API。</p><p id="2196" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">目的是创建一个API来从youtube视频中获取信息，获取其标题、长度、缩略图、音频URL，并将它们存储到数据库中，以便在其他GET API调用中使用</p><p id="8f6e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这是该函数的完整代码，我将在下面解释每一行代码:</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jo"><img src="../Images/1463a7927a9a1a03cc183eb57836b961.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E3Iap9A8Gm5KqkzWSE74Bw.png"/></div></div></figure><p id="9202" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">首先</strong>，API的关键是<code class="du jt ju jv jw b">ytdl-core</code>库。这是一个YouTube下载模块。仅用Javascript和一个节点友好的流接口编写，你可以在NPM上找到。这里我就导入一下。</p><p id="df38" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">其次</strong>，我将为一首<strong class="is hj">歌曲定义一个接口，</strong>对此没什么好说的</p><p id="907d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">最后</strong>，最重要的部分，API本身:</p><p id="7b8f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">传递一个youtube url作为参数，然后使用ytdl库的<code class="du jt ju jv jw b">getInfo</code>方法。记得放一个<code class="du jt ju jv jw b">if</code>块来拦截错误的URL。</p><p id="af93" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">回应会有很多信息，但在我看来，我们只需要<code class="du jt ju jv jw b">videoDetails</code>和<code class="du jt ju jv jw b">formats</code>。</p><p id="359b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然后，我们将析构音频网址，标题，缩略图，…并保存到我们的数据库中。</p><p id="4acc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">但是你可以注意到我把视频网址保存在我们的数据库里了，为什么？这是因为随着时间的推移，音频url会过时，我们需要视频url来进行回调。虽然有另一种方法可以克服这一点，我们将音频本身从url保存到我们的数据库，但这是以后的另一篇文章。</p><p id="0b85" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果你需要透明度，我这里有一个gitlab回购:<a class="ae jx" href="https://gitlab.com/letrongduc1999/music-player-backend" rel="noopener ugc nofollow" target="_blank">https://gitlab.com/letrongduc1999/music-player-backend</a></p><h1 id="18f7" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">遗言</h1><p id="fc33" class="pw-post-body-paragraph iq ir hi is b it kw iv iw ix kx iz ja jb ky jd je jf kz jh ji jj la jl jm jn hb bi translated">虽然我的内容对每个人都是免费的，但是如果你觉得这篇文章有帮助，<a class="ae jx" href="https://www.buymeacoffee.com/kylele19" rel="noopener ugc nofollow" target="_blank">你可以在这里给我买杯咖啡</a></p></div></div>    
</body>
</html>