<html>
<head>
<title>Pandas Practice Series: Top 5 States with 5-Star Businesses</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">熊猫实践系列:五星级企业排名前五的州</h1>
<blockquote>原文：<a href="https://medium.com/codex/pandas-practice-series-top-5-states-with-5-star-businesses-e30b33f691b6?source=collection_archive---------5-----------------------#2022-09-05">https://medium.com/codex/pandas-practice-series-top-5-states-with-5-star-businesses-e30b33f691b6?source=collection_archive---------5-----------------------#2022-09-05</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="5210" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">级别:中等|公司:Yelp</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/99e6626120e761000b22cef5ade53c7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oMqcdDVGa0VCP8u3wRmxBA.jpeg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">图片来自Unsplash的<a class="ae jt" href="https://unsplash.com/@mailchimp" rel="noopener ugc nofollow" target="_blank"> @mailchimp </a></figcaption></figure><h1 id="a3ba" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">问题描述:</h1><blockquote class="ks kt ku"><p id="7b52" class="if ig kv ih b ii ij ik il im in io ip kw ir is it kx iv iw ix ky iz ja jb jc hb bi translated">找出拥有最多五星级企业的前5个州。输出州名和五星级商家数量，并按五星级商家数量降序排列订单记录。如果企业数量相同，则返回所有唯一的状态。如果两个州的结果相同，按字母顺序排序。</p></blockquote><p id="71cf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">问题和数据来自<strong class="ih hj"> Stratascratch，</strong>一个<strong class="ih hj"> </strong>网站，该网站收集基本的面试问题，并根据问题的难度和被问到的公司来组织这些问题。</p><p id="d315" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">数据预览:</strong></p><pre class="je jf jg jh fd kz la lb lc aw ld bi"><span id="0609" class="le jv hi la b fi lf lg l lh li">yelp_business.head()</span></pre><p id="1e95" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">输出:</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lj"><img src="../Images/366353c98a11dfb9d2a12e7d5eb4ca94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dVX6CeVVV-PsuwWo9N1smQ.png"/></div></div></figure><p id="9a6a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">列定义:</strong></p><pre class="je jf jg jh fd kz la lb lc aw ld bi"><span id="ee28" class="le jv hi la b fi lf lg l lh li">business_id:object<br/>name:object<br/>neighborhood:object<br/>address:object<br/>city:object<br/>state:object<br/>postal_code:object<br/>latitude:float64<br/>longitude:float64<br/>stars:float64<br/>review_count:int64<br/>is_open:int64<br/>categories:object</span></pre><h1 id="59b6" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">解决方案:</h1><p id="8a38" class="pw-post-body-paragraph if ig hi ih b ii lk ik il im ll io ip iq lm is it iu ln iw ix iy lo ja jb jc hb bi translated">让我们逐步解决这个问题。</p><p id="5ac3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">考虑到这一点，我们需要返回拥有5星评论的企业数量最多的前5个州。这个问题可以分成几个部分:</p><p id="ba04" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，过滤掉五星级企业</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="lp lq l"/></div></figure><p id="395a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">其次，统计每个州的企业数量。</p><p id="fc4a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们需要确定<code class="du lr ls lt la b">business_id</code>是否是表的主键，这可以通过比较数据集的大小和<code class="du lr ls lt la b">business_id</code>中唯一数量的值的大小来完成，如果大小相同，就可以认为是主键。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="lp lq l"/></div></figure><p id="e531" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们知道<code class="du lr ls lt la b">business_id</code>是一个主键，我们可以计算每个州的企业数量，并相应地对结果数据进行排序。现在问题说你要按降序对各州进行排序，即五星商家数量最多的州应该是第一，五星商家数量最少的州应该是最后。如果出现平局，那么应该按照字母顺序或者简单地按照升序对州进行排序。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="lp lq l"/></div></figure><p id="4779" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以我们得到了正确的答案，但最后一点可以这样做，让我们有机会了解一个名为<a class="ae jt" href="https://www.geeksforgeeks.org/python-pandas-dataframe-rank/" rel="noopener ugc nofollow" target="_blank"> <em class="kv"> Rank </em> </a>的熊猫函数。Pandas <code class="du lr ls lt la b"><strong class="ih hj">Dataframe.rank()</strong></code>方法返回一系列被传递的每个索引的等级。排序后根据位置返回排名。所以我们会这样做:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="lp lq l"/></div></figure><p id="1b7f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">输出:</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lu"><img src="../Images/90d50973a9146cf5693ca7329e32061a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Do0JVHjBabfy0-oHaMeI-w.png"/></div></div></figure><p id="0f3d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上面的代码片段根据每个州的企业数量对每一行进行排名，现在我们可以只保留排名小于5的行，并进行相应的排序。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="lp lq l"/></div></figure><h1 id="d5b4" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">我们学习了一些重要的概念:</h1><p id="80a1" class="pw-post-body-paragraph if ig hi ih b ii lk ik il im ll io ip iq lm is it iu ln iw ix iy lo ja jb jc hb bi translated">我们可以通过在<code class="du lr ls lt la b">sort_values</code>函数的<code class="du lr ls lt la b">by</code>参数中提到一个列名数组来基于多个列对数据帧进行排序。我们也可以通过设置<code class="du lr ls lt la b">ascending</code>参数为<code class="du lr ls lt la b">True</code>或<code class="du lr ls lt la b">False</code>来决定其顺序。</p><p id="2873" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们还学习了如何使用<code class="du lr ls lt la b">rank</code>函数根据列值对行进行排序。</p><p id="2d04" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这篇文章到此为止，但不要忘记实践是掌握解决问题艺术的关键，所以请继续关注更多此类内容！</p><p id="d1f1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你有兴趣以一口大小的块的形式获取每天的ML、DL和python内容，以便即使在空闲时间也可以更新知识，请查看我的Twitter帐户👇</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="lv lq l"/></div></figure></div></div>    
</body>
</html>