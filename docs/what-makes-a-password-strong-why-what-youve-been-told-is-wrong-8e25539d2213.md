# 什么让密码变得强大:为什么告诉你的是错的

> 原文：<https://medium.com/codex/what-makes-a-password-strong-why-what-youve-been-told-is-wrong-8e25539d2213?source=collection_archive---------0----------------------->

## 这实际上让你的密码变得更加脆弱。

![](img/f464e7c7c2474f2068bb166a07e3229c.png)

在我们开始之前，试着忘记你所知道的关于密码的一切。像“密码必须包括一个大写字母和一个数字”或那些给你一个令人放心的绿色勾号的小“强度表”这样的规则是危险的误导和不完整的。一些原因是数学上的，但很多也与人类行为有关。让我们看看幕后的数学，以及为什么对人类习惯的理解可以击败最强大的算法。

## 第 1 部分:密码是如何工作的？

当你输入密码并按回车键登录一个账户时，你的网络浏览器运行代码*散列*你的密码，将其转换成一长串看似随机的字母、数字和符号——从中不可能看出最初输入的是什么。这个散列存储在服务器上，所以每次你登录时，散列被比较-不是你的普通密码。这样，只有你知道你的密码，甚至系统管理员也看不到，如果服务器被黑客攻破，他们只能看到看起来乱码。

这个过程的关键是*哈希函数*——将你的密码变成这种乱码的特定数学运算。散列函数可能相当复杂，但基本思想是非常熟悉的。假设我们的函数只是简单的加法，我们的输入是 2 个整数作为‘密码’。您设置了一个由 3 和 4 组成的“密码”。这被“散列”为 7 (3 +4 =7)。只有这 7 个存储在服务器上。如果黑客进入服务器并找到这个“散列”，他就没有办法知道你的“密码”是 3 和 4，还是 1 和 6，或者 5 和 2。这是一个关键点: ***你不能从输出中决定性地确定原始输入。*** 哈希函数是**单向的。**(这不同于加密，在加密中你可以很容易地恢复原来的输入)。现在，这个作为散列函数相加的例子是不完整的——如果服务器只知道你的数字应该等于 7，那么任何两个加起来等于 7 的数字就能猜出你的“密码”当两个或更多的输入导致相同的散列输出时，这被称为具有许多*冲突-* 。因此，我们需要添加一些变换，使碰撞尽可能少，但仍然避免任何可逆操作。让我们试着把原始的数字连接起来，然后把得到的数字乘以我们的和。所以对于 3 和 4，我们将得到 3 + 4 = 7，然后 7 * 34 = 238。对于 5 和 2，我们将得到 5 + 2 = 7，然后 7 * 52 = 364。
记住，我们做出的任何猜测都必须是 2 个数字的形式，所以我们必须为我们想要猜测的每组 2 个数字计算整个答案。那么哪两个数字给出了输出 1305？

你也许最终可以用计算器算出来，或者通过编写一个程序来猜测和检查来更快地算出来，但是这需要一些工作。这基本上是现代密码散列背后的思想。现代的散列函数非常复杂，并且需要计算机花费相对大量的能量来计算。因此，即使我们知道公式是什么，输出哈希是什么，我们也必须投入大量的计算时间来猜测，这使得尝试变得非常困难。正如我们下面将要探讨的，计算机可能要花上几千年的时间才能猜出密码。事实上，已经表明，对于某些哈希函数，在我们以当前的全球计算能力计算出所有可能的哈希之前，宇宙就会发生热寂。

## 第 2 部分:哈希破解:这都是猜测和检查

“破解”密码的唯一方法是计算给定输入的哈希值，并查看它是否与您试图破解的哈希值匹配——即猜测并检查。例如，称为 MD5 的[哈希函数需要 3000 个 CPU 周期来计算(实际数字因公式和计算机系统而异)，可能需要 10 个周期来比较和查看哈希是否相同……因此检查一个哈希需要 3010 个周期。如果你有一个 10 个字符的密码，那么小写字母、大写字母、数字和符号有 72 种⁰排列(可能更多，这取决于允许输入什么符号)——大约 3.75 万亿次可能性。因此，对于一个典型的 3GHz CPU 内核和大约 3000 个哈希周期，每秒 30 亿个周期除以 3000 个哈希周期=每秒 100 万个哈希。十亿分之一是十亿分之一，所以计算所有可能的组合需要 3.75 万亿秒…以每秒一百万次散列计算，大约需要 118，833 年的恒定 CPU 时间。我们一会儿将回到这一点。](https://en.wikipedia.org/wiki/MD5)

![](img/fca902ffff0eadb4d9767a0ea3527cc6.png)

这可能有助于准确理解哈希公式中发生的事情，以及为什么这需要 CPU 周期。简单回答就是一堆数学运算而已。在现代的 CPU 中，有保存 64 位二进制数的寄存器，CPU 可以对这些寄存器执行基本的逻辑运算，比如将两个数相加，或者比较它们是否相等。要做到这一点，必须有足够的电流通过构成 CPU 的晶体管，使电子通过逻辑门向前移动一步——类似于让电动机旋转一周需要一定量的电流。因此，散列公式通常需要做足够的数学运算，绝对最少需要几千次这样的运算。

大多数真正的散列函数都是 CPU 密集型的，并且保证每个输入都有唯一的输出，等等。但是现代的 CPU 有很多内核，你也可以利用云…假设我们有一批 3GHz 的云服务器，总共有 100 个内核，使用我们上面的例子，单核 CPU 使用了 118，833 年，这将使我们减少到 1188 年…或者说我们有一个拥有一万个内核的大型服务器群，我们可以将它缩短到 0.1188 年(大约 6 周)。当然，这是针对每一个可能的散列，也就是说，我们将破解每一个可能的密码。如果我们只是试图找到一个单一的哈希，我们可能会很幸运，也许在几十年内破解它。

## 第 3 部分:如何破解密码

事实上，我们不需要猜测所有的可能性。大多数人使用与他们生活相关的字母和数字的组合，例如英语单词和他们出生日期的数字，所以我们可以大大减少猜测的次数。例如，我们可以将英语中每个单词的列表输入到流行的[破解程序 Hashcat](https://hashcat.net/hashcat/) ，并指示它计算每个单词后跟数字 0 到 999 的哈希。因此，将英语中的 200，000 个单词四舍五入，加上每个单词后面的 1000 个数字，就是 200，000 *1000 = 200，000，000 个可能性，以每秒 1 百万次散列计算，需要 200 秒。不算太坏。

当然，大多数网站都有“强度”要求，比如“您的密码必须至少包括一个数字、一个大写字母和一个符号。”从数学上来说，这是一个伟大的想法，但它没有考虑到人们实际上做了什么，因此这些“强度”规则正好符合黑客的利益。像这样的规则使得人们更难设置一个他们能记住的密码，所以我们倾向于直接进入常见的模式和序列。大多数人只会大写一个单词的第一个字母，在末尾加上一个常见的数字，如 123，456 或最近的年份，然后是一个按住 shift 键时容易找到的符号——通常是感叹号、at 符号、英镑符号或星号(是的，键盘布局会影响人们选择密码的方式——“asdf”和“qwerty”是一些可识别的常见模式)。因此，在实践中，这些要求实际上使密码不那么安全-当然，它们防止绝对可怕的密码，如“password”，但总的来说，它们使甚至复杂的密码更容易猜测。

![](img/ecd877191ae4011550748456fa719618.png)

我们也知道每个人都会重复使用密码——不仅仅是他们自己的密码，但是我们倾向于使用和其他人一样的密码。甚至当我们认为我们得到了一个“随机的”序列，或者一些高度个人化和原创的东西，它通常已经被其他人使用过了。我们没什么不同。即使我们创造的东西是“随机的”，我们也倾向于选择更容易键入的序列，或者用我们的母语发音的序列。网络安全研究人员估计，目前只有大约 70 亿个不同的密码在使用。在我们前面的每秒一百万次散列的例子中，计算 70 亿次散列需要 116 分钟。现代 GPU 和分布式系统每秒可以轻松处理数十亿次。

因此，当试图破解密码或整个被盗的哈希数据库时，我们希望考虑所有这些因素，并编制一个最有可能破解最多哈希的可能性列表:

1.  最常用语言中的单词

2.常见的数字，如序列，出生日期，最近几年。

3.以前使用过的密码——这些密码的大量列表，被称为“[破解字典，](http://enzoic.com/rockyou2021)”是公开可用的。

4.常见位置的符号和大写字母——第一个和最后一个字符，容易通过 shift 键找到，等等。

5.像“我爱你”或“donthackme”这样的小短语

6.如果目标是一个特定的网站，统计上许多密码将包含该网站的名称，例如“facebook123”

根据有关目标用户的其他可用信息，可能会进一步细化列表(例如姓名、国籍等)。
我们知道这实际上是威胁分子的运作方式。网络安全研究观察到，野生的“凭据填充”机器人与命令和控制(C2)服务器进行通信，这些服务器为它们提供参数(即猜测规则)，根据与上面列表中描述的非常相似的启发式规则来锁定受害者。像 Hashcat 这样的破解网站和程序已经发展到可以更容易、更快速地开发和应用这些规则。那么我们如何反击呢？

## 第 4 部分:如何增强您的密码

嗯，理论上这很容易——只是不要表现得像个人类。但众所周知，说起来容易做起来难。所以让计算机替你做，用一个[强密码生成器。](https://www.lastpass.com/features/password-generator)这确保了你的密码不仅在数学上是可靠的，而且在基于行为的猜测中是安全的。当然，没有 100%的保证，即使是一个随机的字符串也不会被猜到(或者你不会得到记录你击键的恶意软件，或者窃取你浏览器中保存的密码)，所以每个帐户有不同的随机密码也是一个好主意。

然而，改变习惯是很难的，改进总比什么都不做好，所以如果你必须继续设计自己的密码，请尝试做与人类相反的事情:

*   用词来制造无意义的短语(“公园-浴缸-植物园”)
*   将大写字母随机或放在短语中间(“公园-浴缸-植物园”)
*   使用不连续的数字和各种各样的符号(“parking lot % bath 395 tub @ @ & ARBORetum”)
*   不要使用任何关于您或网站/服务的身份信息。
*   确保您的密码不在破解词典中。

如果你是一名系统管理员或软件开发人员，可以考虑使用凭证筛选服务(如 [Enzoic](https://www.enzoic.com/) )来检查所有用户的已知受损账户和密码，并随着更多密码在数据泄露中被破解或泄露而不断更新他们的数据库。