<html>
<head>
<title>Pimp Your Python and Django Shells</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">皮条客你的蟒蛇和姜戈壳</h1>
<blockquote>原文：<a href="https://medium.com/codex/pimp-your-python-and-django-shells-db9c995c3735?source=collection_archive---------0-----------------------#2021-12-04">https://medium.com/codex/pimp-your-python-and-django-shells-db9c995c3735?source=collection_archive---------0-----------------------#2021-12-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="7388" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用IPython美化Python/Django shell的简单步骤</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/9aefdd13a1beff9cb231348d19264036.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*iDbUQR5x6GM5cAH4"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">阿诺德·弗朗西斯卡在<a class="ae jt" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h1 id="5872" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">目标</h1><ul class=""><li id="d93f" class="ks kt hi ih b ii ku im kv iq kw iu kx iy ky jc kz la lb lc bi translated">有这样一个聪明的伊普森·REPL:</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ld"><img src="../Images/3eeadb306b5fb60f0ebbb14be389c07b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CuN1JJV0Qx39hZi7XI3Qzw.png"/></div></div></figure><h1 id="0a5b" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">背景</h1><p id="c7d5" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq le is it iu lf iw ix iy lg ja jb jc hb bi translated"><a class="ae jt" href="https://en.wikipedia.org/wiki/IPython" rel="noopener ugc nofollow" target="_blank">IPython</a>(<strong class="ih hj">I</strong>interactive<strong class="ih hj">Python</strong>)现在20岁了。它很成熟，有很多特性，而且非常受欢迎。它是一个交互式的shell，一个<a class="ae jt" href="https://www.youtube.com/watch?v=S0No2zSJmks&amp;t=612s" rel="noopener ugc nofollow" target="_blank"> eval()机器</a>，并作为各种客户端的<strong class="ih hj">后端</strong>，比如IPython REPL shell(终端客户端)和IPython/Jupyter Notebook(浏览器客户端)。</p><p id="c44d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">默认的Python REPL(<strong class="ih hj">R</strong>EAD-<strong class="ih hj">E</strong>val-<strong class="ih hj">P</strong>rint-<strong class="ih hj">L</strong>OOP)外壳存在缺陷，因此IPython旨在改进UI/UX。一些值得注意的<a class="ae jt" href="https://github.com/ipython/ipython#main-features-of-ipython" rel="noopener ugc nofollow" target="_blank"> IPython特性</a>:</p><ul class=""><li id="d12f" class="ks kt hi ih b ii ij im in iq lh iu li iy lj jc kz la lb lc bi translated"><strong class="ih hj">语法高亮</strong>(更容易阅读代码或发现错误)</li><li id="0ba8" class="ks kt hi ih b ii lk im ll iq lm iu ln iy lo jc kz la lb lc bi translated"><strong class="ih hj">标签完成</strong>(少打字)</li><li id="1f8a" class="ks kt hi ih b ii lk im ll iq lm iu ln iy lo jc kz la lb lc bi translated"><strong class="ih hj">自动缩进</strong>(适用于<code class="du lp lq lr ls b">for</code>循环或<code class="du lp lq lr ls b">def</code>中的代码块)</li><li id="9277" class="ks kt hi ih b ii lk im ll iq lm iu ln iy lo jc kz la lb lc bi translated">自省(例如，<code class="du lp lq lr ls b">foo?</code>用于文档，<code class="du lp lq lr ls b">foo??</code>用于源代码)</li><li id="357b" class="ks kt hi ih b ii lk im ll iq lm iu ln iy lo jc kz la lb lc bi translated">模块的自动重新加载(方便/高效)</li><li id="4058" class="ks kt hi ih b ii lk im ll iq lm iu ln iy lo jc kz la lb lc bi translated">访问Unix shell命令(例如，<code class="du lp lq lr ls b">ls</code>、<code class="du lp lq lr ls b">pwd</code>、<code class="du lp lq lr ls b">cd</code>)</li><li id="d863" class="ks kt hi ih b ii lk im ll iq lm iu ln iy lo jc kz la lb lc bi translated">与Django shell整合</li><li id="9022" class="ks kt hi ih b ii lk im ll iq lm iu ln iy lo jc kz la lb lc bi translated">会话/历史被保存</li></ul><p id="049d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">仅前3条就足以成为放弃默认Python REPL的理由。</p><p id="330c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">笔记本在统计学家、科学家、研究人员等中很受欢迎。虽然有很多定制Jupyter主题的资源，但是IPython REPL的资源却很少。而且它们相当稀疏，所以需要挖掘IPython文档，甚至源代码来定制颜色/提示。</p><h1 id="7865" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">IPython Shell</h1><p id="8a7b" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq le is it iu lf iw ix iy lg ja jb jc hb bi translated"><em class="lt">安装</em></p><p id="0a5c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">很容易安装:</p><p id="f12d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du lp lq lr ls b">pip install ipython</code></p><p id="a670" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="lt">捆绑配色方案</em></p><p id="6646" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">IPython捆绑了一些配色方案:<code class="du lp lq lr ls b">Neutral</code>、<code class="du lp lq lr ls b">Linux</code>、<code class="du lp lq lr ls b">LightBG</code>和<code class="du lp lq lr ls b">NoColor</code>。<em class="lt">默认</em>配色方案称为<code class="du lp lq lr ls b">Neutral</code>，可通过<code class="du lp lq lr ls b">—-colors </code>选项调用:</p><pre class="je jf jg jh fd lu ls lv lw aw lx bi"><span id="1d45" class="ly jv hi ls b fi lz ma l mb mc">ipython --<strong class="ls hj">colors</strong>=<strong class="ls hj">Neutral</strong></span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es md"><img src="../Images/86e0b61b38fde02acae9b659166ca72a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7XOdwpx80PoN1lbDwWdGnw.png"/></div></div></figure><p id="3363" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">另一种配色叫做<code class="du lp lq lr ls b">Linux</code>。同样，这可以通过以下方式调用:</p><pre class="je jf jg jh fd lu ls lv lw aw lx bi"><span id="1fee" class="ly jv hi ls b fi lz ma l mb mc">ipython --<strong class="ls hj">colors</strong>=<strong class="ls hj">Linux</strong></span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es me"><img src="../Images/df80350d612c50505aab7db52d41bb46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8ul3f13JcVBCg9zBjanfMA.png"/></div></div></figure><p id="a4ae" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是这些配色都不好看，尤其是深色终端。配色是个人的事。因此，用户很可能也想使用他们喜欢的配色方案。幸运的是，有一种方法。</p><h1 id="d486" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">色素细胞</h1><p id="2a00" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq le is it iu lf iw ix iy lg ja jb jc hb bi translated"><a class="ae jt" href="https://github.com/pygments/pygments" rel="noopener ugc nofollow" target="_blank"> Pygments </a>是一个用Python写的语法高亮器。对于<a class="ae jt" href="https://github.com/willmcgugan/rich" rel="noopener ugc nofollow" target="_blank"> Rich </a>、<a class="ae jt" href="https://github.com/pdbpp/pdbpp" rel="noopener ugc nofollow" target="_blank"> Pdb++ </a>、<a class="ae jt" href="https://github.com/inducer/pudb" rel="noopener ugc nofollow" target="_blank"> PuDB </a>、<a class="ae jt" href="https://github.com/ipython/ipython" rel="noopener ugc nofollow" target="_blank"> IPython </a>等热门项目来说是一个依赖。因此，当您安装IPython时，它也会自动安装。</p><p id="5b39" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="lt">已安装的主题</em></p><p id="65c0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Pygment捆绑了很多主题。我们可以通过以下方式轻松检查可用/已安装的主题:</p><pre class="je jf jg jh fd lu ls lv lw aw lx bi"><span id="1774" class="ly jv hi ls b fi lz ma l mb mc">pygmentize -L styles</span></pre><p id="eb30" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这些配色方案在<a class="ae jt" href="https://pygments.org/styles/" rel="noopener ugc nofollow" target="_blank"> Pygments网站</a>上有截图，所以你会对它们在终端上的外观有所了解。</p><h1 id="a932" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">IPython主题</h1><p id="a7c3" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq le is it iu lf iw ix iy lg ja jb jc hb bi translated"><em class="lt"> Zenburn配色方案</em></p><p id="8f75" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以在调用命令时在IPython中指定配色方案。例如，要使用<code class="du lp lq lr ls b">zenburn </code>配色方案:</p><pre class="je jf jg jh fd lu ls lv lw aw lx bi"><span id="04d4" class="ly jv hi ls b fi lz ma l mb mc">ipython --TerminalInteractiveShell.<strong class="ls hj">highlighting_style</strong>=<strong class="ls hj">zenburn</strong></span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mf"><img src="../Images/78a00d68e664f33e4a94b03d7ebd5e4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kT6W3rIJDR_vRq3-_tWnng.png"/></div></div></figure><p id="dbb6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="lt"> Python/IPython覆盖</em></p><p id="cdb0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后我们可以在<code class="du lp lq lr ls b">.bashrc</code>或<code class="du lp lq lr ls b">.zshrc</code>中设置这些方便的shell别名，这样调用<code class="du lp lq lr ls b"><strong class="ih hj">python</strong></code>或<code class="du lp lq lr ls b"><strong class="ih hj">ipython</strong></code>将自动调用带有主题的<code class="du lp lq lr ls b">ipython</code>:</p><pre class="je jf jg jh fd lu ls lv lw aw lx bi"><span id="f3cc" class="ly jv hi ls b fi lz ma l mb mc">alias <strong class="ls hj">python</strong>="ipython"<br/>alias <strong class="ls hj">ipython</strong>="ipython --TerminalInteractiveShell.<strong class="ls hj">highlighting_style</strong>=<strong class="ls hj">zenburn</strong>"</span></pre><p id="2eb4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="lt">字体样式</em></p><p id="250d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在<a class="ae jt" href="https://pygments.org/styles/" rel="noopener ugc nofollow" target="_blank">样式库</a>中，你会注意到一些主题有斜体/粗体字符，比如在<code class="du lp lq lr ls b">material</code>和<code class="du lp lq lr ls b">dracula</code>主题中。这些主要取决于你的终端。例如，我的fast <a class="ae jt" href="https://github.com/alacritty/alacritty" rel="noopener ugc nofollow" target="_blank"> Alacritty </a>终端不支持连字/带样式的字母，但它在我的<a class="ae jt" href="https://github.com/gnachman/iTerm2" rel="noopener ugc nofollow" target="_blank"> iTerm2 </a>上呈现得很好。下面是使用iTerm2和<code class="du lp lq lr ls b">material</code>主题时的截图，注意<code class="du lp lq lr ls b"><strong class="ih hj"><em class="lt">import</em></strong></code>和<code class="du lp lq lr ls b"><strong class="ih hj"><em class="lt">_</em></strong></code>是斜体的:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mg"><img src="../Images/0e0d5ddd7bec13f47dde01419549eadb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vWlp56rUR-X-H1up1hD3tg.png"/></div></div></figure><p id="1d9f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="lt">一暗</em> </strong> <em class="lt">配色</em></p><p id="e176" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一片黑暗是我最喜欢的主题。它由Atom推广，目前是VS Code、PyCharm或Vim中最流行的主题之一。我所有的编辑器、ide、终端都在用。</p><p id="3f99" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">幸运的是，自从两周前的<a class="ae jt" href="https://github.com/pygments/pygments/pull/1924" rel="noopener ugc nofollow" target="_blank">开始，这款</a><a class="ae jt" href="https://github.com/pygments/pygments/blob/master/pygments/styles/onedark.py" rel="noopener ugc nofollow" target="_blank">也有了小版本</a>。但是，这意味着它在PyPI上还不可用。上一次<code class="du lp lq lr ls b">pygments </code>的PyPI更新是差不多4个月前(2021年8月15日)。所以，当你运行<code class="du lp lq lr ls b">pygmentize -L styles</code>时，它不在列表中，其他最近的主题也可能不在列表中。</p><p id="5e3d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">于是，我在GitHub上下载了<code class="du lp lq lr ls b">pygments</code>的<a class="ae jt" href="https://github.com/pygments/pygments/archive/refs/heads/master.zip" rel="noopener ugc nofollow" target="_blank">最新版本</a>，然后复制了<code class="du lp lq lr ls b">styles</code>文件夹，并覆盖了我安装的<code class="du lp lq lr ls b">pygments</code>的<strong class="ih hj"> 2.10.0 </strong>版本中的<code class="du lp lq lr ls b">styles</code>文件夹:</p><pre class="je jf jg jh fd lu ls lv lw aw lx bi"><span id="8e9b" class="ly jv hi ls b fi lz ma l mb mc">.../site-packages/pygments/<strong class="ls hj">styles</strong></span></pre><p id="f0ea" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我现在可以运行它:</p><pre class="je jf jg jh fd lu ls lv lw aw lx bi"><span id="8e3f" class="ly jv hi ls b fi lz ma l mb mc">ipython --TerminalInteractiveShell<strong class="ls hj">.highlighting_style</strong>=<strong class="ls hj">one-dark</strong></span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mh"><img src="../Images/e034e6f3e314b54dde0f86453fe2c2a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LUbUq7xLm58r0Myqg4rPzg.png"/></div></div></figure><h1 id="98e3" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">IPython配置</h1><p id="c8d8" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq le is it iu lf iw ix iy lg ja jb jc hb bi translated">其他用户可能会在这一点上停止，因为我们已经有了一个配色方案。但是其他人可能仍然对冗长的IPython <strong class="ih hj">提示符</strong>及其编号和/或颜色感到恼火。</p><p id="4f99" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="lt"> IPython配置文件</em></p><p id="2ec8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了定制IPython的各个方面，包括提示，我们可以创建一个概要文件，这样我们就可以将我们的定制/覆盖放在那里:</p><pre class="je jf jg jh fd lu ls lv lw aw lx bi"><span id="7dd1" class="ly jv hi ls b fi lz ma l mb mc">ipython <strong class="ls hj">profile</strong> <strong class="ls hj">create</strong></span></pre><p id="bafb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这将创建名为<strong class="ih hj"> profile_default </strong>的默认配置文件:</p><pre class="je jf jg jh fd lu ls lv lw aw lx bi"><span id="837b" class="ly jv hi ls b fi lz ma l mb mc">~/.ipython/<strong class="ls hj">profile_default</strong></span></pre><p id="0f56" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">IPython将在其中自动创建一个<strong class="ih hj">配置文件</strong>:</p><pre class="je jf jg jh fd lu ls lv lw aw lx bi"><span id="2c5b" class="ly jv hi ls b fi lz ma l mb mc">~/.ipython/profile_default/<strong class="ls hj">ipython_config.py</strong></span></pre><p id="ef23" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您检查配置文件的内容，它包含IPython的默认设置，这些设置是注释行，它们都以全局config ( <code class="du lp lq lr ls b"><strong class="ih hj">c</strong></code>)对象命名空间/前缀。</p><p id="6554" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="lt">提示颜色</em></p><p id="d362" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要更改提示颜色，我们可以利用这个属性:</p><pre class="je jf jg jh fd lu ls lv lw aw lx bi"><span id="989a" class="ly jv hi ls b fi lz ma l mb mc"># Override highlighting format for specific tokens<br/>#<strong class="ls hj"> c.TerminalInteractiveShell.highlighting_style_overrides</strong> = {}</span></pre><p id="4628" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">例如，您可以将它放在配置文件中的任何位置:</p><pre class="je jf jg jh fd lu ls lv lw aw lx bi"><span id="bb29" class="ly jv hi ls b fi lz ma l mb mc">from IPython.terminal.prompts import Token</span><span id="2b13" class="ly jv hi ls b fi mi ma l mb mc"><strong class="ls hj">YELLOW</strong> = '#FFFF5C'<br/><strong class="ls hj">VIOLET</strong> = '#BD93F9'</span><span id="a7e1" class="ly jv hi ls b fi mi ma l mb mc">c.TerminalInteractiveShell.<strong class="ls hj">highlighting_style_overrides </strong>= {<br/>    Token.Prompt: YELLOW,<br/>    Token.PromptNum: YELLOW,<br/>    Token.OutPrompt: VIOLET,<br/>    Token.OutPromptNum: VIOLET,<br/>}</span></pre><p id="cdbc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du lp lq lr ls b">Token.Prompt</code>、<code class="du lp lq lr ls b">Token.PromptNum</code>、<code class="du lp lq lr ls b">Token.OutPrompt</code>、<code class="du lp lq lr ls b">Token.OutPromptNum</code>对应IPython输入输出提示，即<code class="du lp lq lr ls b">In [1]:</code>和<code class="du lp lq lr ls b">Out[2]:</code>。这看起来更好:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mf"><img src="../Images/308f3aa15d6ce434b2388b4ec2e6d309.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hGX-z4vC-WByjNz6nk3Ncg.png"/></div></div></figure><p id="3d2d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="lt">提示字符</em></p><p id="9d89" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，提示颜色对我来说是可以接受的，但它仍然太冗长，我只想有一个最小/光滑的提示。我们可以通过从<code class="du lp lq lr ls b">Prompts</code>类继承并覆盖提示方法来轻松覆盖默认提示。您可以将任何字符放入<a class="ae jt" href="https://ipython.readthedocs.io/en/7.x/config/details.html#custom-prompts" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">记号</strong> </a>列表中，就像放入<code class="du lp lq lr ls b">&gt;&gt;&gt;</code>一样，以符合通常的Python提示:</p><pre class="je jf jg jh fd lu ls lv lw aw lx bi"><span id="7dff" class="ly jv hi ls b fi lz ma l mb mc">from IPython.terminal.prompts import Prompts, Token</span><span id="3692" class="ly jv hi ls b fi mi ma l mb mc">class MyPrompt(<strong class="ls hj">Prompts</strong>):</span><span id="dbfe" class="ly jv hi ls b fi mi ma l mb mc">    def <strong class="ls hj">in_prompt_tokens</strong>(self, cli=None):<br/>        tokens = [<br/>            (Token.Prompt, '<strong class="ls hj">λ</strong>  ')<br/>        ]<br/>        return tokens</span><span id="5b7e" class="ly jv hi ls b fi mi ma l mb mc">    def <strong class="ls hj">out_prompt_tokens</strong>(self):<br/>        tokens = [<br/>            (Token.OutPrompt, '<strong class="ls hj">Φ</strong>  ')<br/>        ]<br/>        return tokens</span><span id="0693" class="ly jv hi ls b fi mi ma l mb mc">c.TerminalInteractiveShell.<strong class="ls hj">prompts_class</strong> = <strong class="ls hj">MyPrompt</strong></span></pre><p id="5ec6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这将呈现对我来说足够好的最终表单，并与我的其他终端定制保持一致:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mj"><img src="../Images/855693ee1b7a4405ad16fb4970a0ff4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IiuZCgj3JMC6Dl-h2P6jvg.png"/></div></div></figure><p id="7c90" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">主题配置</p><p id="fbd7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">既然我们现在有了一个配置文件，我们也可以在其中设置主题:</p><pre class="je jf jg jh fd lu ls lv lw aw lx bi"><span id="96bc" class="ly jv hi ls b fi lz ma l mb mc">c.TerminalInteractiveShell.<strong class="ls hj">highlighting_style</strong> = '<strong class="ls hj">one-dark</strong>'</span></pre><p id="3d68" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此我们不需要在<code class="du lp lq lr ls b">ipython</code>调用期间设置它，或者不需要如上所述为它设置shell别名。</p><h1 id="90d2" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">姜戈壳牌公司</h1><p id="b7a5" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq le is it iu lf iw ix iy lg ja jb jc hb bi translated">如果安装了IPython，Django <code class="du lp lq lr ls b">shell</code>或<code class="du lp lq lr ls b"><a class="ae jt" href="https://django-extensions.readthedocs.io/en/latest/shell_plus.html" rel="noopener ugc nofollow" target="_blank">shell_plus</a></code>将利用它，这也将加载您的定制概要文件/配置。这是使用Django <code class="du lp lq lr ls b">shell</code>时的示例:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mk"><img src="../Images/50754b7505658f8320fb57a10d21d0d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1216/format:webp/1*OGh3NzfqHcujV9FJdd35cQ.png"/></div></figure><p id="fb3f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="lt">自动重新加载</em></p><p id="9f91" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">IPython有自动重新加载机制，这在使用Django <code class="du lp lq lr ls b">shell</code>时非常方便，因为如果您更新了Django代码，就不需要再次运行<code class="du lp lq lr ls b">manage.py shell</code>。只需要加载/调用<code class="du lp lq lr ls b">autoreload</code> IPython扩展:</p><pre class="je jf jg jh fd lu ls lv lw aw lx bi"><span id="b18f" class="ly jv hi ls b fi lz ma l mb mc"># Load<br/>%load_ext <strong class="ls hj">autoreload</strong></span><span id="992c" class="ly jv hi ls b fi mi ma l mb mc"># Invoke<br/>%<strong class="ls hj">autoreload</strong></span></pre><p id="e96c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在下面的运行示例中，<code class="du lp lq lr ls b"><strong class="ih hj">random_hex_string</strong>()</code>返回一个随机的十六进制字符串，然后我修改了它的定义/返回值，保存了更改，加载/调用了IPython <code class="du lp lq lr ls b">autoreload</code>，然后再次调用了<code class="du lp lq lr ls b">random_hex_string() </code>。我故意硬编码了一个无效的十六进制字符串<code class="du lp lq lr ls b">IPython Auto-Reload FTW</code>返回文本，只是为了证明函数定义确实被修改了。实际上，更新后的代码无需重启Django <code class="du lp lq lr ls b">shell</code>即可执行:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ml"><img src="../Images/7200bed7caa03808dc6a01421043b499.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6tCpUFq-oYHrDB4zVDKaMw.png"/></div></div></figure><h1 id="3bc1" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">关键要点</h1><ul class=""><li id="bee1" class="ks kt hi ih b ii ku im kv iq kw iu kx iy ky jc kz la lb lc bi translated">IPython是一个成熟的项目，非常受欢迎，相对于默认的Python REPL有很多特性和改进。重要的特性是语法高亮、制表符补全和自动缩进。</li><li id="61c9" class="ks kt hi ih b ii lk im ll iq lm iu ln iy lo jc kz la lb lc bi translated">某些用户不接受默认的IPython颜色/提示。尽管定制它们很容易。</li><li id="2a7c" class="ks kt hi ih b ii lk im ll iq lm iu ln iy lo jc kz la lb lc bi translated">IPython使用色素着色。我们可以列出可用的主题:</li></ul><pre class="je jf jg jh fd lu ls lv lw aw lx bi"><span id="c89c" class="ly jv hi ls b fi lz ma l mb mc">pygmentize -L styles</span></pre><ul class=""><li id="be6c" class="ks kt hi ih b ii ij im in iq lh iu li iy lj jc kz la lb lc bi translated">我们可以在运行<code class="du lp lq lr ls b">ipython</code>时设置IPython主题:</li></ul><pre class="je jf jg jh fd lu ls lv lw aw lx bi"><span id="3ca0" class="ly jv hi ls b fi lz ma l mb mc">ipython --TerminalInteractiveShell.<strong class="ls hj">highlighting_style</strong>=<strong class="ls hj">one-dark</strong></span></pre><ul class=""><li id="612f" class="ks kt hi ih b ii ij im in iq lh iu li iy lj jc kz la lb lc bi translated">我们可以创建一个默认配置文件:</li></ul><pre class="je jf jg jh fd lu ls lv lw aw lx bi"><span id="1a5f" class="ly jv hi ls b fi lz ma l mb mc">ipython profile create</span></pre><ul class=""><li id="e8bb" class="ks kt hi ih b ii ij im in iq lh iu li iy lj jc kz la lb lc bi translated">我们可以将我们的定制(颜色、提示等)放在profile/config文件中:</li></ul><pre class="je jf jg jh fd lu ls lv lw aw lx bi"><span id="2f20" class="ly jv hi ls b fi lz ma l mb mc">~/.ipython/profile_default/<strong class="ls hj">ipython_config.py</strong></span></pre><ul class=""><li id="855e" class="ks kt hi ih b ii ij im in iq lh iu li iy lj jc kz la lb lc bi translated">Django <code class="du lp lq lr ls b">shell</code>或<code class="du lp lq lr ls b"><a class="ae jt" href="https://django-extensions.readthedocs.io/en/latest/shell_plus.html" rel="noopener ugc nofollow" target="_blank">shell_plus</a></code>将自动加载IPython及其配置文件(如果可用的话)。它还可以自动重新加载导入的模块，避免重新运行<code class="du lp lq lr ls b">shell</code>。</li><li id="05ab" class="ks kt hi ih b ii lk im ll iq lm iu ln iy lo jc kz la lb lc bi translated">IPython可以取代ide终端中默认的Python REPL，比如PyCharm/VS代码。</li><li id="e12c" class="ks kt hi ih b ii lk im ll iq lm iu ln iy lo jc kz la lb lc bi translated">IPython有许多强大的特性。看看这个有趣的"<a class="ae jt" href="https://www.youtube.com/watch?v=S0No2zSJmks" rel="noopener ugc nofollow" target="_blank">等等，IPython能做到吗？！</a>”演示，包括对IPython替代方案的讨论，如<code class="du lp lq lr ls b">bpython</code>和<code class="du lp lq lr ls b">ptpython</code>。</li></ul></div><div class="ab cl mm mn gp mo" role="separator"><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr"/></div><div class="hb hc hd he hf"><p id="8083" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi mt translated">感谢您的阅读。如果你发现了一些价值，请关注我，或者为文章鼓掌/评论，或者<a class="ae jt" href="https://ko-fi.com/ranelpadon" rel="noopener ugc nofollow" target="_blank">请我喝杯咖啡</a>。这对我意义重大，鼓励我创作更多高质量的内容。</p></div></div>    
</body>
</html>