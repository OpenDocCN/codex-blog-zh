<html>
<head>
<title>BLAST on the Cloud with NCBI’s ElasticBLAST</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用NCBI的弹性冲击波在云上爆炸</h1>
<blockquote>原文：<a href="https://medium.com/codex/blast-on-the-cloud-with-ncbis-elasticblast-3b35b29afde7?source=collection_archive---------4-----------------------#2021-06-17">https://medium.com/codex/blast-on-the-cloud-with-ncbis-elasticblast-3b35b29afde7?source=collection_archive---------4-----------------------#2021-06-17</a></blockquote><div><div class="dt gx gy gz ha hb"/><div class="hc hd he hf hg"><div class=""/><div class=""><h2 id="b760" class="pw-subtitle-paragraph ig hi hj bd b ih ii ij ik il im in io ip iq ir is it iu iv iw ix dy translated">在AWS上使用ElasticBLAST、SNS和DataBrew构建分析管道</h2></div><figure class="iz ja jb jc fe jd es et paragraph-image"><div role="button" tabindex="0" class="je jf di jg bf jh"><div class="es et iy"><img src="../Images/e6216bc326db2e326fd91cac8874ef2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*SJvaHOIq3Feo2-jg"/></div></div><figcaption class="jk jl eu es et jm jn bd b be z dy translated"><a class="ae jo" href="https://unsplash.com/@realaxer?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">田宽</a>在<a class="ae jo" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</figcaption></figure><blockquote class="jp"><p id="f844" class="jq jr hj bd js jt ju jv jw jx jy jz dy translated">信息程序来来去去，但爆炸留下来了。</p></blockquote><p id="861c" class="pw-post-body-paragraph ka kb hj kc b kd ke ik kf kg kh in ki kj kk kl km kn ko kp kq kr ks kt ku jz hc bi translated">BLAST是基本局部比对搜索工具的缩写，是生物信息学家的搜索引擎。Google将文本字符串作为查询并返回相关网页，而BLAST接受DNA或蛋白质序列作为查询并返回来自数据库的类似序列，例如来自国家生物技术信息中心(NCBI)的非冗余核苷酸数据库和非冗余蛋白质数据库。</p><p id="f2a9" class="pw-post-body-paragraph ka kb hj kc b kd kv ik kf kg kw in ki kj kx kl km kn ky kp kq kr kz kt ku jz hc bi translated">BLAST是所有生物信息学家的面包和黄油。Altschul于1990年发表，截至本文撰写时，其论文已被引用92993次。对于每个生物学家来说，这个常青的软件可能是他或她学习的第一个生物信息学工具。自从它出现以来，已经开发了许多其他的序列搜索工具，例如HMMER、RAPSearch、DIAMOND和MMseqs，但是没有一个能够取代广受欢迎的BLAST。就像“谷歌”一样，BLAST也变成了动词。</p><p id="0510" class="pw-post-body-paragraph ka kb hj kc b kd kv ik kf kg kw in ki kj kx kl km kn ky kp kq kr kz kt ku jz hc bi translated">BLAST可以在本地运行。虽然程序本身很小，但数据库却不小。例如，来自NCBI的格式化核苷酸数据库大于130 GB。当它运行时，它是I/O、CPU和内存密集型的。因此，我们更有可能在一些超级计算机集群上看到BLAST，而不是在我们的台式机上。</p><figure class="iz ja jb jc fe jd es et paragraph-image"><div role="button" tabindex="0" class="je jf di jg bf jh"><div class="es et la"><img src="../Images/5841e2b849e8be08134a8b6b52bdc83d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hVPBDp5Y-MYVXHkX57hPEg.png"/></div></div><figcaption class="jk jl eu es et jm jn bd b be z dy translated">图一。NCBI的在线爆炸页面。截图来自<a class="ae jo" href="https://blast.ncbi.nlm.nih.gov/Blast.cgi" rel="noopener ugc nofollow" target="_blank">https://blast.ncbi.nlm.nih.gov/Blast.cgi</a>。图片作者。</figcaption></figure><p id="2c5d" class="pw-post-body-paragraph ka kb hj kc b kd kv ik kf kg kw in ki kj kx kl km kn ky kp kq kr kz kt ku jz hc bi translated">或者，生物学家也可以在网上进行BLAST搜索。最受欢迎的是托管在NCBI的网站上(图1。).尽管web BLAST非常方便，但它也有很多局限性。首先，它对处理时间设置了限制<a class="ae jo" href="https://www.ncbi.nlm.nih.gov/guide/howto/submit-mult-seq-blast/" rel="noopener ugc nofollow" target="_blank">，从而间接限制了输入序列的数量。其次，您只能查询他们预定义的数据库。第三，您的搜索受制于NCBI定义的设置，如并行度、输出格式等。最后，你基本上是在和世界各地的生物学家竞争NCBI的资源。所以搜索有时会很长。</a></p><p id="8f8d" class="pw-post-body-paragraph ka kb hj kc b kd kv ik kf kg kw in ki kj kx kl km kn ky kp kq kr kz kt ku jz hc bi translated">第三个选择是云。云计算使超级计算机大众化。我们现在可以高效地在云上运行BLAST，并使用我们的用户设置，两全其美。在云上运行BLAST的方法有很多种。在我之前的文章“<a class="ae jo" href="https://aws.plainenglish.io/parallel-blast-against-cazy-with-aws-batch-8239a45d8116" rel="noopener ugc nofollow" target="_blank">用AWS批处理</a>对CAZy进行并行BLAST”中，我使用AWS批处理上的Docker对我的自定义数据库CAZy进行无服务器BLAST。还可以提供EC2实例来安装和运行BLAST。</p><figure class="iz ja jb jc fe jd es et paragraph-image"><div role="button" tabindex="0" class="je jf di jg bf jh"><div class="es et lb"><img src="../Images/c0738b8eb02407aceea2adf3f0c61696.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uBDqzFhDQahzePjGrS2q9A.png"/></div></div><figcaption class="jk jl eu es et jm jn bd b be z dy translated">图二。ElasticBLAST的网页。https://blast.ncbi.nlm.nih.gov/doc/elastic-blast/index.html<a class="ae jo" href="https://blast.ncbi.nlm.nih.gov/doc/elastic-blast/index.html" rel="noopener ugc nofollow" target="_blank">。图片作者。</a></figcaption></figure><p id="e07a" class="pw-post-body-paragraph ka kb hj kc b kd kv ik kf kg kw in ki kj kx kl km kn ky kp kq kr kz kt ku jz hc bi translated">然后来自NCBI的Ravinder Pannu Eskandary好心的告诉我，NCBI也在研发一款云端爆破:<a class="ae jo" href="https://blast.ncbi.nlm.nih.gov/doc/elastic-blast/" rel="noopener ugc nofollow" target="_blank"> <strong class="kc hk"> ElasticBLAST </strong> </a>。她和她的团队也友好地让我测试软件的最新版本。ElasticBLAST目前处于测试阶段，在<a class="ae jo" href="https://blast.ncbi.nlm.nih.gov/doc/elastic-blast/quickstart-aws.html#quickstart-aws" rel="noopener ugc nofollow" target="_blank"> AWS </a>和<a class="ae jo" href="https://blast.ncbi.nlm.nih.gov/doc/elastic-blast/quickstart-gcp.html#quickstart-gcp" rel="noopener ugc nofollow" target="_blank"> GCP </a>上运行。这两个平台上的命令本质上是相同的。您也可以按照他们的说明自己测试软件。</p><div class="lc ld fa fc le lf"><a href="https://blast.ncbi.nlm.nih.gov/doc/elastic-blast/overview.html#overview" rel="noopener  ugc nofollow" target="_blank"><div class="lg ab dx"><div class="lh ab li cl cj lj"><h2 class="bd hk fj z dz lk eb ec ll ee eg hi bi translated">弹性塑料</h2><div class="lm l"><h3 class="bd b fj z dz lk eb ec ll ee eg dy translated">基本局部比对搜索工具(BLAST)寻找序列之间的局部相似区域。该程序比较…</h3></div><div class="ln l"><p class="bd b fq z dz lk eb ec ll ee eg dy translated">blast.ncbi.nlm.nih.gov</p></div></div><div class="lo l"><div class="lp l lq lr ls lo lt ji lf"/></div></div></a></div><p id="79c4" class="pw-post-body-paragraph ka kb hj kc b kd kv ik kf kg kw in ki kj kx kl km kn ky kp kq kr kz kt ku jz hc bi translated">这是一场全新的比赛。正如我的BLAST文章所展示的，一个本土云爆炸的建立需要大量的点击或者一个巨大的地形。现在，如果NCBI介入并接管BLAST设置，我们这些用户就可以专注于我们最擅长的领域:生物学。这也意味着现在整个工作流程，从通过ElasticBLAST的序列上传到结果分析，完全是云原生的(图3)。如果你愿意，没有数据会离开云。云也是可扩展的。事实上，它鼓励更多的并发性，因为并行和顺序执行的成本是相同的。小型研究小组或生物学爱好者现在可以在没有自己的超级计算机的情况下进行资源饥渴的生物信息学分析。</p><figure class="iz ja jb jc fe jd es et paragraph-image"><div role="button" tabindex="0" class="je jf di jg bf jh"><div class="es et lu"><img src="../Images/4523602b025d24e23d38bca44e204ff6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v3ZQQgTtt4zcCij9TEct1w.png"/></div></div><figcaption class="jk jl eu es et jm jn bd b be z dy translated">图3。这个项目的架构。图片作者。</figcaption></figure><p id="e977" class="pw-post-body-paragraph ka kb hj kc b kd kv ik kf kg kw in ki kj kx kl km kn ky kp kq kr kz kt ku jz hc bi translated">目前，NCBI团队正专注于软件的可用性、可伸缩性和性能。作为一个受鼓励的用户，我想在ElasticBLAST之上建立一个管道。在本文中，我将设置一个SNS电子邮件通知，带您完成ElasticBLAST示例运行，然后使用DataBrew对结果进行可视化分析。本教程在AWS上运行。</p><h1 id="75c1" class="lv lw hj bd lx ly lz ma mb mc md me mf ip mg iq mh is mi it mj iv mk iw ml mm bi translated">1.设置带有SNS电子邮件通知的S3存储桶</h1><p id="3712" class="pw-post-body-paragraph ka kb hj kc b kd mn ik kf kg mo in ki kj mp kl km kn mq kp kq kr mr kt ku jz hc bi translated">在运行ElasticBLAST之前，我们需要创建一个S3桶来存放传入的结果。稍后很难使用<code class="dv ms mt mu mv b">status</code>子命令来监控作业状态，因为它依赖于一个实时的CloudShell会话，并且会话可能会在作业完成之前超时。作为一种变通方法，我们最好在桶中设置电子邮件通知。这样，当工作完成时，我们将收到来自AWS的电子邮件。</p><p id="09f7" class="pw-post-body-paragraph ka kb hj kc b kd kv ik kf kg kw in ki kj kx kl km kn ky kp kq kr kz kt ku jz hc bi translated">我们需要<strong class="kc hk">在S3桶</strong>之前先 <strong class="kc hk">创建一个SNS话题。登录你的AWS控制台，前往社交网站。创建一个<code class="dv ms mt mu mv b">Standard</code>话题<code class="dv ms mt mu mv b">blast-output-topic</code>。</strong></p><figure class="iz ja jb jc fe jd es et paragraph-image"><div role="button" tabindex="0" class="je jf di jg bf jh"><div class="es et mw"><img src="../Images/54d8720f2a819bfa6e0dc8d56daaff66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*48-y3ESmX9qMV9eczR23-Q.png"/></div></div><figcaption class="jk jl eu es et jm jn bd b be z dy translated">图4。S3文件定稿的SNS设置。图片作者。</figcaption></figure><p id="5ef1" class="pw-post-body-paragraph ka kb hj kc b kd kv ik kf kg kw in ki kj kx kl km kn ky kp kq kr kz kt ku jz hc bi translated">我们还需要修改<code class="dv ms mt mu mv b">access policy</code>来允许未来的S3存储桶调用SNS。在下面的模板中填写您的<strong class="kc hk">未来</strong>桶名和您的账户ID(您用户名下拉菜单中<code class="dv ms mt mu mv b">My Account</code>旁边的12位ID ),并将内容粘贴到<code class="dv ms mt mu mv b">JSON editor</code>字段中。</p><figure class="iz ja jb jc fe jd"><div class="bz dz l di"><div class="mx my l"/></div></figure><p id="aacb" class="pw-post-body-paragraph ka kb hj kc b kd kv ik kf kg kw in ki kj kx kl km kn ky kp kq kr kz kt ku jz hc bi translated">之后，使用<code class="dv ms mt mu mv b">Email</code>协议创建一个订阅。填写您的电子邮件地址作为终点。点击<code class="dv ms mt mu mv b">Create subscription</code>按钮。</p><figure class="iz ja jb jc fe jd es et paragraph-image"><div role="button" tabindex="0" class="je jf di jg bf jh"><div class="es et mz"><img src="../Images/900c295afda02d9e6509692211ffce72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7eFcYjp0kmLIEgTXNDy-bQ.png"/></div></div><figcaption class="jk jl eu es et jm jn bd b be z dy translated">图5。为主题创建订阅。图片作者。</figcaption></figure><p id="1956" class="pw-post-body-paragraph ka kb hj kc b kd kv ik kf kg kw in ki kj kx kl km kn ky kp kq kr kz kt ku jz hc bi translated">然后，AWS将向您发送一封电子邮件，您需要通过单击其链接来确认订阅。</p><p id="cea9" class="pw-post-body-paragraph ka kb hj kc b kd kv ik kf kg kw in ki kj kx kl km kn ky kp kq kr kz kt ku jz hc bi translated">现在，前往S3，使用您之前在策略中填写的名称创建一个bucket。我的是<code class="dv ms mt mu mv b">eblast-result-sixing</code>。选择<code class="dv ms mt mu mv b">us-east-1</code>区域。之后，点击进入新bucket的<code class="dv ms mt mu mv b">Properties</code>选项卡，找到<code class="dv ms mt mu mv b">Event notifications</code>部分并创建一个名为<code class="dv ms mt mu mv b">result received</code>的事件通知。在<code class="dv ms mt mu mv b">Prefix</code>中写<code class="dv ms mt mu mv b">results/</code>，在<code class="dv ms mt mu mv b">Suffix</code>中写<code class="dv ms mt mu mv b">.gz</code>，因为ElasticBLAST会将结果写入。gz格式保存在<code class="dv ms mt mu mv b">results</code>文件夹中。启用<code class="dv ms mt mu mv b">Event types</code>中的<code class="dv ms mt mu mv b">All object create events</code>。在<code class="dv ms mt mu mv b">Destination</code>中选择<code class="dv ms mt mu mv b">SNS topic</code>，在下拉菜单中选择<code class="dv ms mt mu mv b">blast-output-topic</code>。</p><figure class="iz ja jb jc fe jd es et paragraph-image"><div role="button" tabindex="0" class="je jf di jg bf jh"><div class="es et na"><img src="../Images/cc71bfe88f0b20f1502cecd5c86cf212.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KYXCEK--EEFCmLiaDu8P7A.png"/></div></div></figure><figure class="iz ja jb jc fe jd es et paragraph-image"><div role="button" tabindex="0" class="je jf di jg bf jh"><div class="es et nb"><img src="../Images/9b92a82f42ee11eea2cda0acf6fc6ba4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BN1sBhQOVdlcfzFPsBM5zw.png"/></div></div><figcaption class="jk jl eu es et jm jn bd b be z dy translated">图6。事件通知设置。图片作者。</figcaption></figure><p id="177b" class="pw-post-body-paragraph ka kb hj kc b kd kv ik kf kg kw in ki kj kx kl km kn ky kp kq kr kz kt ku jz hc bi translated">您现在可以通过创建一个文件夹<code class="dv ms mt mu mv b">results</code>并在其中上传一个. gz文件来测试设置。如果你收到主题名为的邮件，恭喜你！</p><h1 id="47b0" class="lv lw hj bd lx ly lz ma mb mc md me mf ip mg iq mh is mi it mj iv mk iw ml mm bi translated">2.在CloudShell中运行ElasticBLAST</h1><p id="d7c5" class="pw-post-body-paragraph ka kb hj kc b kd mn ik kf kg mo in ki kj mp kl km kn mq kp kq kr mr kt ku jz hc bi translated">现在是时候运行ElasticBLAST本身了。打开一个CloudShell会话。在撰写本文时，版本是0.2.5。NCBI官方快速入门中缺少一个命令<code class="dv ms mt mu mv b">pip install wheel</code>。因此，执行以下命令来下载并验证二进制文件<code class="dv ms mt mu mv b">elastic-blast</code>:</p><figure class="iz ja jb jc fe jd"><div class="bz dz l di"><div class="mx my l"/></div></figure><p id="b940" class="pw-post-body-paragraph ka kb hj kc b kd kv ik kf kg kw in ki kj kx kl km kn ky kp kq kr kz kt ku jz hc bi translated">如果您可以看到版本号和帮助消息，则您的安装是成功的。接下来，我们需要编写一个配置文件。调整下面模板中的内容，用<code class="dv ms mt mu mv b">vi</code>或<code class="dv ms mt mu mv b">cat</code>粘贴到一个名为<code class="dv ms mt mu mv b">BDQA.ini</code>的文件中(如果需要帮助，请在此处阅读<a class="ae jo" href="https://www.dummies.com/web-design-development/web-hosting/how-to-edit-files-with-vi/" rel="noopener ugc nofollow" target="_blank">或在此处</a><a class="ae jo" href="https://www.linux.com/training-tutorials/using-cat-text-editor/" rel="noopener ugc nofollow" target="_blank">阅读</a>)。然后，在当前目录中应该有一个文件:<code class="dv ms mt mu mv b">BDQA.ini</code>。</p><figure class="iz ja jb jc fe jd"><div class="bz dz l di"><div class="mx my l"/></div></figure><p id="e2c3" class="pw-post-body-paragraph ka kb hj kc b kd kv ik kf kg kw in ki kj kx kl km kn ky kp kq kr kz kt ku jz hc bi translated">这个配置文件指示ElasticBLAST从NCBI为我们准备的<code class="dv ms mt mu mv b">s3://elasticblast-test/queries/</code>桶中查询<code class="dv ms mt mu mv b">BDQA01.1.fsa_aa</code>文件中的序列。这是一种与海洋微生物相关的病毒宏基因组。该作业将在10个节点上运行，结果将被写入您的S3存储桶中的<code class="dv ms mt mu mv b">results/[RunName]</code>文件夹。我将<code class="dv ms mt mu mv b">-outfmt</code>设置为<code class="dv ms mt mu mv b">6</code>，因为这种格式比NCBI文档中的<code class="dv ms mt mu mv b">7</code>更容易处理。参考数据库是refseq_protein。如需更多数据库，请阅读以下链接:</p><div class="lc ld fa fc le lf"><a href="https://github.com/ncbi/blast_plus_docs#blast-databases" rel="noopener  ugc nofollow" target="_blank"><div class="lg ab dx"><div class="lh ab li cl cj lj"><h2 class="bd hk fj z dz lk eb ec ll ee eg hi bi translated">NCBI/爆炸_加_文件</h2><div class="lm l"><h3 class="bd b fj z dz lk eb ec ll ee eg dy translated">该存储库包含Docker映像中NCBI BLAST+命令行应用程序的文档。我们会…</h3></div><div class="ln l"><p class="bd b fq z dz lk eb ec ll ee eg dy translated">github.com</p></div></div><div class="lo l"><div class="nc l lq lr ls lo lt ji lf"/></div></div></a></div><p id="cd46" class="pw-post-body-paragraph ka kb hj kc b kd kv ik kf kg kw in ki kj kx kl km kn ky kp kq kr kz kt ku jz hc bi translated">您也可以制作并上传自己的数据库:</p><div class="lc ld fa fc le lf"><a href="https://blast.ncbi.nlm.nih.gov/doc/elastic-blast/configuration.html#elb-db" rel="noopener  ugc nofollow" target="_blank"><div class="lg ab dx"><div class="lh ab li cl cj lj"><h2 class="bd hk fj z dz lk eb ec ll ee eg hi bi translated">弹性塑料</h2><div class="lm l"><h3 class="bd b fj z dz lk eb ec ll ee eg dy translated">使用spot实例和可抢占节点运行ElasticBLAST。这可能会降低成本，但会延长运行时间。"…</h3></div><div class="ln l"><p class="bd b fq z dz lk eb ec ll ee eg dy translated">blast.ncbi.nlm.nih.gov</p></div></div></div></a></div><p id="0c69" class="pw-post-body-paragraph ka kb hj kc b kd kv ik kf kg kw in ki kj kx kl km kn ky kp kq kr kz kt ku jz hc bi translated">您可以启用自动关机功能:</p><div class="lc ld fa fc le lf"><a href="https://blast.ncbi.nlm.nih.gov/doc/elastic-blast/janitor.html#janitor" rel="noopener  ugc nofollow" target="_blank"><div class="lg ab dx"><div class="lh ab li cl cj lj"><h2 class="bd hk fj z dz lk eb ec ll ee eg hi bi translated">弹性塑料</h2><div class="lm l"><h3 class="bd b fj z dz lk eb ec ll ee eg dy translated">此功能使ElasticBLAST能够监控其状态，并在出现故障或…时关闭云资源</h3></div><div class="ln l"><p class="bd b fq z dz lk eb ec ll ee eg dy translated">blast.ncbi.nlm.nih.gov</p></div></div></div></a></div><p id="0841" class="pw-post-body-paragraph ka kb hj kc b kd kv ik kf kg kw in ki kj kx kl km kn ky kp kq kr kz kt ku jz hc bi translated">现在执行这个命令开始ElasticBLAST运行:</p><figure class="iz ja jb jc fe jd"><div class="bz dz l di"><div class="mx my l"/></div></figure><p id="54a6" class="pw-post-body-paragraph ka kb hj kc b kd kv ik kf kg kw in ki kj kx kl km kn ky kp kq kr kz kt ku jz hc bi translated">等待命令完成。您可以通过以下方式监控状态:</p><figure class="iz ja jb jc fe jd"><div class="bz dz l di"><div class="mx my l"/></div></figure><p id="dd10" class="pw-post-body-paragraph ka kb hj kc b kd kv ik kf kg kw in ki kj kx kl km kn ky kp kq kr kz kt ku jz hc bi translated">在输出中，您可以看到ElasticBLAST将输入分成11个部分。一旦所有11个都在<code class="dv ms mt mu mv b">Succeeded</code>行，任务就完成了。</p><p id="4292" class="pw-post-body-paragraph ka kb hj kc b kd kv ik kf kg kw in ki kj kx kl km kn ky kp kq kr kz kt ku jz hc bi translated">但是正如我之前所说的，很难抓住一个实时的CloudShell会话，看着它变干。因为我们已经设置了SNS通知，所以我们可以关闭CloudShell，转而查看我们的电子邮件。一旦你收到11封邮件，你就知道整个工作完成了。</p><p id="3b20" class="pw-post-body-paragraph ka kb hj kc b kd kv ik kf kg kw in ki kj kx kl km kn ky kp kq kr kz kt ku jz hc bi translated">在我们继续之前，我们应该清理云资源，以避免AWS的意外账单。</p><figure class="iz ja jb jc fe jd"><div class="bz dz l di"><div class="mx my l"/></div></figure><h1 id="e316" class="lv lw hj bd lx ly lz ma mb mc md me mf ip mg iq mh is mi it mj iv mk iw ml mm bi translated">3.在DataBrew中分析结果</h1><p id="262a" class="pw-post-body-paragraph ka kb hj kc b kd mn ik kf kg mo in ki kj mp kl km kn mq kp kq kr mr kt ku jz hc bi translated">如果示例运行成功，您应该在S3存储区的<code class="dv ms mt mu mv b">results/[RunName]</code>文件夹中看到11个batch_*.out.gz文件。我们可以立即用DataBrew直观地分析这些输出。</p><p id="9060" class="pw-post-body-paragraph ka kb hj kc b kd kv ik kf kg kw in ki kj kx kl km kn ky kp kq kr kz kt ku jz hc bi translated">首先，前往AWS Glue DataBrew。创建一个项目<code class="dv ms mt mu mv b">BDQA</code>。然后选择<code class="dv ms mt mu mv b">New dataset</code>，命名为<code class="dv ms mt mu mv b">BDQABlastOutput</code>。用您的ElasticBLAST输出位置调整以下字符串，并将其放在<code class="dv ms mt mu mv b">Enter your source from S3</code>下。</p><pre class="iz ja jb jc fe nd mv ne nf aw ng bi"><span id="a2f5" class="nh lw hj mv b fj ni nj l nk nl">s3://[YourBucketName]/results/[RunName]/&lt;[^/]+&gt;.out.gz</span></pre><p id="532a" class="pw-post-body-paragraph ka kb hj kc b kd kv ik kf kg kw in ki kj kx kl km kn ky kp kq kr kz kt ku jz hc bi translated"><code class="dv ms mt mu mv b">&lt;[^/]+&gt;.out.gz</code>部分指示DataBrew搜索所有扩展名为. out.gz的文件。</p><figure class="iz ja jb jc fe jd es et paragraph-image"><div role="button" tabindex="0" class="je jf di jg bf jh"><div class="es et nm"><img src="../Images/1f9a2093b75a84b57d766e03c38d02e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xOamKQx7ulxNI14mnzaqQA.png"/></div></div></figure><figure class="iz ja jb jc fe jd es et paragraph-image"><div role="button" tabindex="0" class="je jf di jg bf jh"><div class="es et nn"><img src="../Images/755bb5d97610906ea1a76811702837aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jEQevG0f3wA0n7rHvIuYXw.png"/></div></div><figcaption class="jk jl eu es et jm jn bd b be z dy translated">图7。数据Brew设置。图片作者。</figcaption></figure><p id="43cb" class="pw-post-body-paragraph ka kb hj kc b kd kv ik kf kg kw in ki kj kx kl km kn ky kp kq kr kz kt ku jz hc bi translated">选择<code class="dv ms mt mu mv b">Selected file type</code>下的<code class="dv ms mt mu mv b">CSV</code>和<code class="dv ms mt mu mv b">Tab (\t)</code>作为分隔符。另外，选择<code class="dv ms mt mu mv b">Add default header</code>是因为BLAST的outfmt 6没有表头。将<code class="dv ms mt mu mv b">Sampling</code>大小调整为5000，虽然我检查了只有3796行结果(你的结果可能会有所不同)。最后，创建一个后缀为<code class="dv ms mt mu mv b">databrew-for-elasticblast</code>的新IAM角色。点击<code class="dv ms mt mu mv b">Create project</code>。</p><p id="d209" class="pw-post-body-paragraph ka kb hj kc b kd kv ik kf kg kw in ki kj kx kl km kn ky kp kq kr kz kt ku jz hc bi translated">之后，DataBrew会将数据加载到一个包含列统计信息的电子表格中。点击<code class="dv ms mt mu mv b">SCHEMA</code>并按照正确的顺序用这些值修改列名:</p><pre class="iz ja jb jc fe nd mv ne nf aw ng bi"><span id="3fcc" class="nh lw hj mv b fj ni nj l nk nl">qaccver, saccver, pident, length, mismatch, gapopen, qstart, qend, sstart, send, evalue, bitscore, sskingdoms, ssciname</span></pre><figure class="iz ja jb jc fe jd es et paragraph-image"><div role="button" tabindex="0" class="je jf di jg bf jh"><div class="es et no"><img src="../Images/0a2d38eed06b9e8b918fdc89ee51a443.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1OlU6nR1VwziC3CBMO7M2Q.png"/></div></div><figcaption class="jk jl eu es et jm jn bd b be z dy translated">图8。DataBrew中的模式编辑。图片作者。</figcaption></figure><p id="28a5" class="pw-post-body-paragraph ka kb hj kc b kd kv ik kf kg kw in ki kj kx kl km kn ky kp kq kr kz kt ku jz hc bi translated">现在，当你点击<code class="dv ms mt mu mv b">GRID</code>时，你会看到最精彩的结果。它显示总共有3796次爆炸命中。</p><figure class="iz ja jb jc fe jd es et paragraph-image"><div role="button" tabindex="0" class="je jf di jg bf jh"><div class="es et lb"><img src="../Images/60c7312b6c806f26b25d91678bd8dce8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O8UyogI6RCSP0FpuBRilNw.png"/></div></div><figcaption class="jk jl eu es et jm jn bd b be z dy translated">图9。弹力纤维形成数据纤维。图片作者。</figcaption></figure><p id="7f16" class="pw-post-body-paragraph ka kb hj kc b kd kv ik kf kg kw in ki kj kx kl km kn ky kp kq kr kz kt ku jz hc bi translated">仔细检查后，很明显每个查询<code class="dv ms mt mu mv b">qaccver</code>可以有多个命中。我们可以通过点击<code class="dv ms mt mu mv b">qaccver</code>旁边的<code class="dv ms mt mu mv b">…</code>并选择<code class="dv ms mt mu mv b">Remove duplicate values</code>并点击右侧面板上的<code class="dv ms mt mu mv b">Apply</code>来移除重复值。这样，我们只检查每个查询的顶部命中。</p><figure class="iz ja jb jc fe jd es et paragraph-image"><div role="button" tabindex="0" class="je jf di jg bf jh"><div class="es et np"><img src="../Images/76fe4825bc3c86323d56c5487e24f434.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xJw-15lhwjusvDK1Q7trEQ.png"/></div></div><figcaption class="jk jl eu es et jm jn bd b be z dy translated">图10。删除DataBrew中的重复值。图片作者。</figcaption></figure><p id="a7af" class="pw-post-body-paragraph ka kb hj kc b kd kv ik kf kg kw in ki kj kx kl km kn ky kp kq kr kz kt ku jz hc bi translated">去复制后，揭示了在548个输入序列中，只有116个蛋白质命中。</p><figure class="iz ja jb jc fe jd es et paragraph-image"><div role="button" tabindex="0" class="je jf di jg bf jh"><div class="es et nq"><img src="../Images/274acc41b739d6bab09af9d3df1c22b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*25ys5hTY0wtXZT0Znul8Uw.png"/></div></div><figcaption class="jk jl eu es et jm jn bd b be z dy translated">图11。在数据库中，ElasticBLAST结果的百分比同一性、主题界和主题学名。图片作者。</figcaption></figure><p id="763c" class="pw-post-body-paragraph ka kb hj kc b kd kv ik kf kg kw in ki kj kx kl km kn ky kp kq kr kz kt ku jz hc bi translated">现在我们可以看到这116个蛋白质的百分比同一性(pident)不是很高。中位数仅为33.83%。这表明这些病毒序列相当新颖。其中九个是细菌的热门。所以样本可能有细菌污染。微小单胞菌呼肠孤病毒、乌桕呼肠孤病毒、辽宁病毒位列五大打击生物。它们都与海洋栖息地有关。微小单胞菌呼肠孤病毒是从海洋原生生物<em class="nr">微小单胞菌</em>中分离出来的，而无齿海蟹呼肠孤病毒是青蟹的病原。据<a class="ae jo" href="https://virologyj.biomedcentral.com/articles/10.1186/s12985-020-01382-2" rel="noopener ugc nofollow" target="_blank">张<em class="nr">等人</em>。</a>、廖宁病毒首先出现在澳洲的南太平洋地区，然后传播到mainland China。相反，卡迪皮罗病毒是从蚊子中分离出来的。</p></div><div class="ab cl ns nt gq nu" role="separator"><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx"/></div><div class="hc hd he hf hg"><h1 id="9719" class="lv lw hj bd lx ly nz ma mb mc oa me mf ip ob iq mh is oc it mj iv od iw ml mm bi translated">结论</h1><p id="d105" class="pw-post-body-paragraph ka kb hj kc b kd mn ik kf kg mo in ki kj mp kl km kn mq kp kq kr mr kt ku jz hc bi translated">ElasticBLAST是我们云原生生物信息工作流程的一大补充。只需一个网络浏览器，我们就可以在云中爆炸序列、清理结果并可视化结果，而无需下载、配置超级计算机或与同事争夺计算机资源。它具有可扩展性和成本效益。</p><p id="ce91" class="pw-post-body-paragraph ka kb hj kc b kd kv ik kf kg kw in ki kj kx kl km kn ky kp kq kr kz kt ku jz hc bi translated">开始时，ElasticBLAST需要加快基础设施的建设并转移数据库。一旦它变热，爆炸就开始了。因此，对于小型查询数据集，初始运行可能比web BLAST需要更长的时间。但是随后的运行不再需要准备，因此完成得更快。因此，查询数据集越大，速度就越快。</p><p id="cf44" class="pw-post-body-paragraph ka kb hj kc b kd kv ik kf kg kw in ki kj kx kl km kn ky kp kq kr kz kt ku jz hc bi translated">与网络爆炸不同，这次是用户买单。但是成本很低。NCBI数据库的启用不产生费用。用户支付剩余的云服务费用。在AWS上，ElasticBLAST调用<code class="dv ms mt mu mv b">m5.8xlarge</code>实例。每一个都有32个vCPUs，每小时按需收费1.536美元。此外，SNS的前1000封邮件是免费的。每个DataBrew互动环节时长30分钟，费用1美元。但是，前40个互动会话对首次用户是免费的。</p><p id="6201" class="pw-post-body-paragraph ka kb hj kc b kd kv ik kf kg kw in ki kj kx kl km kn ky kp kq kr kz kt ku jz hc bi translated">本文中的工作流只是一个开始。您可以设置另一个SNS来触发AWS Glue crawler。爬虫从BLAST结果中创建一个数据目录，然后您可以使用Athena查询它。您也可以触发一个Lambda函数来创建一个<a class="ae jo" href="https://github.com/marbl/Krona/wiki" rel="noopener ugc nofollow" target="_blank">克朗图</a>来可视化结果。</p><p id="7cca" class="pw-post-body-paragraph ka kb hj kc b kd kv ik kf kg kw in ki kj kx kl km kn ky kp kq kr kz kt ku jz hc bi translated">今天就用ElasticBLAST为你的生物信息学研究增压，请告诉我你的体验。</p><p id="a613" class="pw-post-body-paragraph ka kb hj kc b kd kv ik kf kg kw in ki kj kx kl km kn ky kp kq kr kz kt ku jz hc bi translated">感谢来自NCBI的Ravinder Pannu Eskandary、Tom Madden和Christiam Camacho给我这个机会。</p><div class="lc ld fa fc le lf"><a href="https://dgg32.medium.com/membership" rel="noopener follow" target="_blank"><div class="lg ab dx"><div class="lh ab li cl cj lj"><h2 class="bd hk fj z dz lk eb ec ll ee eg hi bi translated">加入媒介与我的介绍链接-黄思兴</h2><div class="lm l"><h3 class="bd b fj z dz lk eb ec ll ee eg dy translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="ln l"><p class="bd b fq z dz lk eb ec ll ee eg dy translated">dgg32.medium.com</p></div></div><div class="lo l"><div class="oe l lq lr ls lo lt ji lf"/></div></div></a></div></div></div>    
</body>
</html>