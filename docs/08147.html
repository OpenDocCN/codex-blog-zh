<html>
<head>
<title>We all make this common mistake while using Pandas.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我们在使用熊猫时都会犯这种常见的错误。</h1>
<blockquote>原文：<a href="https://medium.com/codex/we-all-make-this-common-mistake-while-using-pandas-622fce2938e1?source=collection_archive---------24-----------------------#2022-07-19">https://medium.com/codex/we-all-make-this-common-mistake-while-using-pandas-622fce2938e1?source=collection_archive---------24-----------------------#2022-07-19</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="1b6c" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">相信我，它们很容易修理…</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/4406d14ef7faa89d57104fca09145692.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*yP98jV5Te60l2X4V.jpeg"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated"><a class="ae jn" href="https://www.pexels.com/photo/1-1-3-text-on-black-chalkboard-374918/" rel="noopener ugc nofollow" target="_blank">来自</a></figcaption></figure><p id="85b8" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">今天，在这个世界上，我们都会犯错误，即使在数据世界里，很多数据科学家在涉及熊猫时也会犯错误。虽然这些错误很容易避免，但是修复它们可以使您的代码更具可读性和可理解性。</p><h1 id="f0d0" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">错误1:让熊猫寻找数据类型</h1><p id="0c97" class="pw-post-body-paragraph jo jp hi jq b jr lc ij jt ju ld im jw jx le jz ka kb lf kd ke kf lg kh ki kj hb bi translated">当您将数据导入到数据帧中，并且不告诉Pandas您的列和数据类型时，Pandas会将整个数据集读入内存，以确定数据类型。</p><p id="b9fe" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">让我们假设，如果您有一个充满文本的列，熊猫将读取每个值，并查看它们是否都是字符串，在确认后，它会将该列的数据类型设置为“字符串”。然后对所有其他列重复这个过程。</p><p id="91f3" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">通常，我们使用<code class="du lh li lj lk b">df.info()</code>来查看一个数据帧使用了多少内存。这与熊猫计算每一列的数据类型所花费的时间大致相同。</p><p id="9b78" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">为了解决这个问题，只需添加<code class="du lh li lj lk b">dtypes</code>参数和一个字典，将列名及其数据类型作为字符串。例如:</p><pre class="iy iz ja jb fd ll lk lm ln aw lo bi"><span id="e9af" class="lp kl hi lk b fi lq lr l ls lt">pd.read_csv(‘Student_profiles.csv’, dtype={<br/>    ‘Name’: ‘str’,<br/>    ‘Class’: ‘str’,<br/>    ‘Grade’: ‘str’<br/>})</span></pre><h1 id="6af6" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">错误2:剩余的数据帧</h1><p id="2014" class="pw-post-body-paragraph jo jp hi jq b jr lc ij jt ju ld im jw jx le jz ka kb lf kd ke kf lg kh ki kj hb bi translated">熊猫数据框的最大优点是它们很容易创建和修改。但不幸的是，这样做的副作用是大多数人最终会得到这样的代码:</p><pre class="iy iz ja jb fd ll lk lm ln aw lo bi"><span id="cf28" class="lp kl hi lk b fi lq lr l ls lt"># Change dataframe 1 and save it into a new dataframed<br/>f1 = pd.read_csv(‘file.csv’)df2 = df1.dropna()df3 = df2.groupby(‘thing’)</span></pre><p id="ad1b" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">尽管你已经搬到<code class="du lh li lj lk b">df3</code>并开始使用它。不要在内存中留下多余的数据帧。如果你用的是笔记本电脑，它会影响你几乎所有其他工作的表现。如果你在一个服务器上，这将会影响服务器上与你一起工作的其他人的性能。</p><p id="a4a2" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">相反，保持你的记忆干净:</p><ul class=""><li id="ec0e" class="lu lv hi jq b jr js ju jv jx lw kb lx kf ly kj lz ma mb mc bi translated">在一行中链接多个数据帧修改:</li></ul><p id="2bc5" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><code class="du lh li lj lk b">df = df.apply(thing1).dropna()</code></p><ul class=""><li id="85ed" class="lu lv hi jq b jr js ju jv jx lw kb lx kf ly kj lz ma mb mc bi translated"><em class="md">正如</em> <a class="ae jn" rel="noopener" href="/@bobbruno_6876"> <em class="md">罗伯托·布鲁诺·马丁</em> </a> <em class="md">一样，另一种清理内存的方法是</em> <strong class="jq hj"> <em class="md">执行函数</em> </strong> <em class="md">内的操作。您仍然可能无意中以这种方式滥用内存，解释范围超出了本文的范围，但是如果您不熟悉，我鼓励您阅读本文。</em></li></ul><p id="0463" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><a class="ae jn" href="https://www.datacamp.com/community/tutorials/scope-of-variables-python" rel="noopener ugc nofollow" target="_blank">https://www . data camp . com/community/tutorials/scope-of-variables-python</a></p><h1 id="b64e" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">错误3:手动配置Matplotlib</h1><p id="02f7" class="pw-post-body-paragraph jo jp hi jq b jr lc ij jt ju ld im jw jx le jz ka kb lf kd ke kf lg kh ki kj hb bi translated">这可能是最常见的错误，因为它影响最小。</p><p id="e078" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">Matplotlib是熊猫自动发货的，它还会在每个数据帧上为我们生成一些图表配置。因此，当它已经为您填充到Pandas中时，没有必要为每个图表导入和配置它。</p><p id="375f" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这里有一个错误做法的例子，尽管这是一个基本图表，但仍然是浪费代码:</p><pre class="iy iz ja jb fd ll lk lm ln aw lo bi"><span id="a366" class="lp kl hi lk b fi lq lr l ls lt">import matplotlib.pyplot as plt<br/>plot1.hist(x=df[‘x’])<br/>plot1.set_xlabel(‘label for column X’)<br/>plt.show()</span></pre><p id="44c6" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">正确的做法:</strong></p><p id="7887" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><code class="du lh li lj lk b">df[‘x’].plot()</code></p><p id="6e2c" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">更容易，不是吗？你可以在这些<a class="ae jn" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.plot.html" rel="noopener ugc nofollow" target="_blank">数据帧绘图对象</a>上做任何你可以对任何其他<a class="ae jn" href="https://matplotlib.org/3.1.3/api/_as_gen/matplotlib.pyplot.plot.html" rel="noopener ugc nofollow" target="_blank"> Matplotlib绘图对象</a>做的事情。例如:</p><p id="7063" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><code class="du lh li lj lk b">df[‘x’].plot.hist(title=’Chart title’)</code></p><h1 id="0c42" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">结论</h1><p id="a405" class="pw-post-body-paragraph jo jp hi jq b jr lc ij jt ju ld im jw jx le jz ka kb lf kd ke kf lg kh ki kj hb bi translated">我确信并且坦率地说，我犯了这些错误，而且我还犯了一些我不知道的愚蠢的错误。但是希望与您和这个数据世界社区中的其他人分享这些已知的方法将有助于更好地使用您的硬件，<strong class="jq hj">让我们编写更少的代码，完成更多的工作！</strong></p><p id="e8fd" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">别忘了留下你的回答。✌</p><p id="ec44" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">大家敬请关注！！为了把我的故事发到你的邮箱里，请订阅我的时事通讯。</p><p id="7b3d" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">感谢您的阅读！不要忘记给你的掌声，分享你的回答，并与朋友分享！</p></div></div>    
</body>
</html>