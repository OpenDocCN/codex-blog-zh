<html>
<head>
<title>useRef and useState, which one should you use and why?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">useRef和useState，应该用哪个，为什么？</h1>
<blockquote>原文：<a href="https://medium.com/codex/useref-and-usestate-which-one-should-you-use-and-why-b9853dff9e38?source=collection_archive---------6-----------------------#2022-04-17">https://medium.com/codex/useref-and-usestate-which-one-should-you-use-and-why-b9853dff9e38?source=collection_archive---------6-----------------------#2022-04-17</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="8aab" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你对useRef和useState了解多少？好吧，如果你有任何疑问，你和我需要谈一谈。首先，我觉得有必要重申理解useRef和useState钩子的重要性。除了所有的优化之外，useRef和useState是React中两个重要的核心钩子。先说useState。</p><h1 id="73c5" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">使用状态</h1><p id="32a0" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">根据<a class="ae kg" href="https://reactjs.org/docs/hooks-reference.html#usestate" rel="noopener ugc nofollow" target="_blank">官方文档</a>，它们返回一个有状态值和一个更新它的函数，但这并不意味着什么，不是吗？useState允许你声明一个状态和一个函数来操作你声明的状态。本文假设您至少对React有一个基本的了解，所以我不会深入探究什么是状态以及为什么您需要操纵它。然而，有一个重要的信息你需要知道。每次使用useState操作状态时，组件都会被重新呈现，但也不会就此结束。不管他们是否将该组件作为道具使用，该组件的子组件也会被重新呈现。我们来看一个非常基础的反app例子。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div class="er es kh"><img src="../Images/8aca067f749f37afa61a02538332978c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*nXVeDm7iqgd2QxwAevd-Pw.png"/></div></figure><p id="1035" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们有一个状态叫做“计数”，它的初始值是0。我们有一个名为“setCount”的setter函数我们使用useEffect钩子在每次计数状态改变时控制台记录“呈现的计数”。我们在p标签中显示计数状态的当前值，我们有两个并排的按钮来增加和减少计数状态的值。现在，如果你检查你的控制台，你会看到你已经有一个日志，即使你没有点击任何按钮。这是因为在绘制虚拟DOM之前，状态已经发生了变化。更简单地说，在我们看到网站之前，状态就已经改变了。现在，如果您单击任何按钮，无论是增加还是减少，您都会看到连续的控制台日志，告诉您计数已渲染。这是因为useState重新呈现了我们的组件。不仅如此，如果你使用React DevTools(你应该使用),你会注意到我们的按钮也被重新渲染。嗯，有一些方法可以防止整个组件被重新呈现，但是你可以看到为什么使用useState需要更加小心。</p><h1 id="bf38" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">useRef</h1><p id="800f" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">useRef允许你存储一个可变的引用对象。与useState类似，您可以存储所有类型的不同值。我为useRef稍微修改了我们的代码。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div class="er es kp"><img src="../Images/9cbf44a088dd1f83f3df4e0af6bae2a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1074/format:webp/1*oxUOGxi3oZUGfWpmjGa9sA.png"/></div></figure><p id="2809" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我声明了一个引用对象，并将其命名为“count”其当前值为0。它的大部分仍然是相同的代码，所以我不会进入太多的细节。但是，值得注意的是“count”现在是一个<strong class="ih hj">对象</strong>。它有一个名为“current”的属性，您可以使用current属性来操作数据。现在，你可以像个疯子一样不停地按递增或递减按钮，但页面本身不会发生任何变化。然而，如果你按下“控制台日志当前值”并检查控制台，你会注意到值正在改变，但由于我们的组件没有得到重新渲染，你不会注意到发生的变化。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div class="er es kq"><img src="../Images/76c30afafd6ece3d55158000bf09aef1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1034/1*y1lZuI9_ym8ba9WVZAcuFQ.gif"/></div><figcaption class="kr ks et er es kt ku bd b be z dx translated">组件不会被重新渲染。</figcaption></figure><figure class="ki kj kk kl fd km er es paragraph-image"><div class="er es kv"><img src="../Images/c47c400eca670ca18259b6bca0fddfa5.png" data-original-src="https://miro.medium.com/v2/resize:fit:276/format:webp/1*mYlXOEVjJ404fN7qJcLsBw.png"/></div><figcaption class="kr ks et er es kt ku bd b be z dx translated">您可以在控制台中看到当前值。</figcaption></figure><h1 id="bb6c" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">结论</h1><p id="6e42" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">好吧，这很酷，但我为什么要向你解释这一切？好吧，有时候你的终端用户不需要看到更新后的状态。假设您正在创建一个登录页面，出于某种原因，您希望在前端存储当前的登录尝试。如果您使用useState来完成它，那么每次最终用户尝试登录时，您的登录表单都会被重新呈现，这并不理想。如果您使用useRef，您仍然可以存储登录尝试的次数，并且组件不会被重新呈现。如果你使用类和实例变量，你需要使用useRef。引用对于用户输入处理也很有用。请随意使用useRef和useState，并在评论部分让我知道您对这两者的使用情况。话虽如此，这就是我今天为你们准备的全部。</p><p id="afd3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">感谢您的阅读，如果您有任何问题，请告诉我。下次见！</p></div></div>    
</body>
</html>