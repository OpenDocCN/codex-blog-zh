<html>
<head>
<title>How hooks simplifies data fetching in React app</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">hooks如何简化React应用程序中的数据获取</h1>
<blockquote>原文：<a href="https://medium.com/codex/how-react-hooks-compares-to-redux-eba43788df46?source=collection_archive---------2-----------------------#2019-09-01">https://medium.com/codex/how-react-hooks-compares-to-redux-eba43788df46?source=collection_archive---------2-----------------------#2019-09-01</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><h2 id="4d35" class="hg hh hi bd b fp hj hk hl hm hn ho dx hp translated" aria-label="kicker paragraph"><a class="ae ge" href="http://medium.com/codex" rel="noopener">抄本</a></h2><div class=""/><figure class="ev ex ip iq ir is er es paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="er es io"><img src="../Images/348a9ee4caa51bc409ef50a47c178e59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JRYQCD1FmpjqRnlX4cdpaQ.jpeg"/></div></div></figure><p id="b60e" class="pw-post-body-paragraph iz ja hi jb b jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw hb bi translated">我是一名软件工程师，从事react工作已经四年多了。我仍然记得用<code class="du jx jy jz ka b">React.createClass</code>创建我的第一个react应用。我很快就被<code class="du jx jy jz ka b">state</code>和<code class="du jx jy jz ka b">props</code>的想法吸引住了。我坚信这是一种天才的UI表现方式。我很高兴我选择react作为主要的UI库，并坚持使用它。</p><p id="5cc7" class="pw-post-body-paragraph iz ja hi jb b jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw hb bi translated">但有一件事我从未真正完全领会——那就是全球状态管理库的作用。不要误会我的意思，我曾经用过所有值得注意的解决方案，比如Redux、MobX、Unstated等等。但是我一直对他们的方法和实现有疑问。抛开所有的顾虑和疑虑，我和redux合作到现在已经三年多了。我已经用redux编写了大尺寸的react应用程序，我可以很舒服地说我对redux了如指掌。</p><p id="3aca" class="pw-post-body-paragraph iz ja hi jb b jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw hb bi translated">Redux是一个很好的工具，并且很好地服务于这个目的，我绝不反对它。我只想分享我对它的爱恨情仇，以及react hooks如何简化我的前端应用程序中常见的重复出现的模式。</p><p id="9010" class="pw-post-body-paragraph iz ja hi jb b jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw hb bi translated">我们都知道redux因为过于罗嗦而名声不好。这在开始时可能感觉还好，但随着应用程序的发展，你会开始注意到一些问题，比如为同类任务写太多样板文件。有时很难决定什么<code class="du jx jy jz ka b">state</code>进入redux存储，什么存在于react组件中，例如spinner的加载状态等等。随着应用程序的增长，单一状态对象也在增长，变得非常复杂，很难维护。在我看来，redux还通过引入诸如reducers、thunks、sagas、middlewares等概念增加了认知开销。所有这些都不是redux特有的，这些问题都有解决方案，但是我觉得在我转向hooks之前分享一下我的想法是很重要的。</p><p id="70dc" class="pw-post-body-paragraph iz ja hi jb b jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw hb bi translated">最近，我开始研究新的react hooks API，并决定通过完全使用hooks编写视图/屏幕来尝试一下。我明确决定不在这个视图中使用redux。我使用react挂钩的第一件事是最常见和重复的场景——进行API调用。这是一个组件做的最简单和最常见的事情，在redux中有数百种方法可以做到。通常，您会在组件挂载时<code class="du jx jy jz ka b">dispatch</code>执行一个操作。您将设置一些状态来指示数据正在加载，以便您可以在UI上显示加载微调器。然后，异步地将接收到的数据或错误设置为状态，并更新标记，如<code class="du jx jy jz ka b">isLoading</code>、<code class="du jx jy jz ka b">isErrored</code>等。如果您想进行长时间轮询或某种出错重试策略，这很快就会变得很麻烦。所有这些逻辑通常都与组件生命周期相关联，很难在多个组件之间轻松共享这种通用功能。</p><p id="6a03" class="pw-post-body-paragraph iz ja hi jb b jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw hb bi translated">Hooks相当优雅地解决了这个问题(<em class="kb">我不打算解释它们是如何工作的</em>)。我编写了一个钩子来完成这个任务，我惊讶地发现获取数据、在请求发生时显示加载微调器以及处理错误(如果有的话)是多么容易。没有涉及全局状态，没有动作(和类型常量)，没有sagas(和生成器函数和不必要的函数，如<a class="ae kc" href="https://redux-saga.js.org/docs/api/#callfn-args" rel="noopener ugc nofollow" target="_blank">调用</a>)或thunks。一切都是独立的，很容易理解。我真的很喜欢这样一个事实，我不必在几个地方为我的一个API调用定义多个状态——所有的东西都在一个地方，在钩子内部，在组件的本地。下面是我的钩子的代码:</p><figure class="kd ke kf kg fd is"><div class="bz dy l di"><div class="kh ki l"/></div><figcaption class="kj kk et er es kl km bd b be z dx translated">使用react挂钩读取加载和错误状态的数据</figcaption></figure><p id="b758" class="pw-post-body-paragraph iz ja hi jb b jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw hb bi translated">它使用<code class="du jx jy jz ka b">useState</code>和<code class="du jx jy jz ka b">useEffect</code>挂钩。它有三个状态变量，即<code class="du jx jy jz ka b">data</code>、<code class="du jx jy jz ka b">isLoading</code>、<code class="du jx jy jz ka b">error</code>。如果组件卸载，它将取消网络调用，这很简单。在我看来，很明显，这个钩子比相同东西的redux实现要好。它是一个函数，负责一件事——不像redux实现，它是在动作和reducers之间共享的。</p><h2 id="cfa5" class="kn ko hi bd kp kq kr ks kt ku kv kw kx jk ky kz la jo lb lc ld js le lf lg ho bi translated">我已经为这个用例发布了一个钩子。它支持api调用、出错重试和轮询:<a class="ae kc" href="https://github.com/zaingz/use-axios-hooks" rel="noopener ugc nofollow" target="_blank">https://github.com/zaingz/use-axios-hooks</a></h2></div><div class="ab cl lh li gp lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="hb hc hd he hf"><p id="9280" class="pw-post-body-paragraph iz ja hi jb b jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw hb bi translated">我希望这篇文章对你有所帮助，并让你感兴趣。请分享，鼓掌，评论。我真的很期待你的反馈和想法。</p></div></div>    
</body>
</html>