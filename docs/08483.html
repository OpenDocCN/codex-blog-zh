<html>
<head>
<title>Appium: How to handle device lock and unlock actions for Android Emulators</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Appium:如何处理Android模拟器的设备锁定和解锁操作</h1>
<blockquote>原文：<a href="https://medium.com/codex/appium-how-to-handle-device-lock-and-unlock-actions-for-android-emulators-44b962698e89?source=collection_archive---------6-----------------------#2022-08-11">https://medium.com/codex/appium-how-to-handle-device-lock-and-unlock-actions-for-android-emulators-44b962698e89?source=collection_archive---------6-----------------------#2022-08-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="a576" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">大家好！！在这篇简短的文章中，我们将探讨如何使用各种技术，如PIN、模式、密码等，使用Appium所需的功能来锁定和解锁android仿真器设备。让我们开始吧。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/4b523f52226b4de58d19b0367fefbd28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*sRFlmxop8GBk840-.jpg"/></div></figure><p id="e93c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">假设您需要用您的移动应用测试一个场景，其中我们需要在执行设备锁定后检查应用状态。例如，假设您正在使用安全应用程序，如一些银行应用程序或任何交易应用程序，您可能希望验证用户每次登录应用程序、执行一些操作，然后锁定设备，下次他们解锁设备时，移动应用程序的状态应被重置，他们将需要再次登录。反之亦然，在用户完成锁定/解锁操作后，您可能需要保存应用程序状态，让我们看看如何处理这种情况。</p><blockquote class="jl jm jn"><p id="fda4" class="if ig jo ih b ii ij ik il im in io ip jp ir is it jq iv iw ix jr iz ja jb jc hb bi translated">出于我们的测试目的，我使用了一个在我的系统中本地运行的Android模拟器，我们将使用本地运行的Appium服务器在Sauce Labs提供的<a class="ae js" href="https://github.com/saucelabs/sample-app-mobile/releases" rel="noopener ugc nofollow" target="_blank"> Swag Labs app </a>上进行测试。</p><p id="2784" class="if ig jo ih b ii ij ik il im in io ip jp ir is it jq iv iw ix jr iz ja jb jc hb bi translated">当您在android模拟器中启动Swag labs应用程序时，您需要使用用户名和密码进行登录。</p></blockquote><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jt"><img src="../Images/9eb171fe822cdb7e8704b2ddd970b215.png" data-original-src="https://miro.medium.com/v2/resize:fit:762/format:webp/1*qpvT_5008BCRsTXYkwy41g.png"/></div></figure><blockquote class="jl jm jn"><p id="243c" class="if ig jo ih b ii ij ik il im in io ip jp ir is it jq iv iw ix jr iz ja jb jc hb bi translated">移动应用程序有一些可以使用的预配置用户名。所有用户的密码如下所示(“secret_sauce”)</p></blockquote><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jt"><img src="../Images/3aff5690b3ceb6e19c2a6153ac4ae76d.png" data-original-src="https://miro.medium.com/v2/resize:fit:762/format:webp/1*TTIxV-xLO8iijSJpbeHWNQ.png"/></div><figcaption class="ju jv et er es jw jx bd b be z dx translated">SauceLabs的用户名</figcaption></figure><h2 id="4103" class="jy jz hi bd ka kb kc kd ke kf kg kh ki iq kj kk kl iu km kn ko iy kp kq kr ks bi translated">如何在android模拟器设备中锁定、解锁以及检查锁定状态？</h2><blockquote class="jl jm jn"><p id="1c67" class="if ig jo ih b ii ij ik il im in io ip jp ir is it jq iv iw ix jr iz ja jb jc hb bi translated">AndroidDriver提供了以下方法来锁定、解锁和检查设备<code class="du kt ku kv kw b">isDeviceLocked()</code>、<code class="du kt ku kv kw b">lockDevice()</code>和<code class="du kt ku kv kw b">unlockDevice()</code>的锁定状态。</p></blockquote><p id="1660" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jo">这些方法在AndroidDriver中是可用的，所以如果你的驱动是AppiumDriver类型，那么你需要将它转换成AndroidDriver。</em></p><pre class="je jf jg jh fd kx kw ky kz aw la bi"><span id="d8a7" class="jy jz hi kw b fi lb lc l ld le">((AndroidDriver&lt;MobileElement&gt;)driver).unlockDevice();</span></pre><blockquote class="jl jm jn"><p id="0de6" class="if ig jo ih b ii ij ik il im in io ip jp ir is it jq iv iw ix jr iz ja jb jc hb bi translated">方法isDeviceLocked()将返回一个布尔值(真或假)</p><p id="a6be" class="if ig jo ih b ii ij ik il im in io ip jp ir is it jq iv iw ix jr iz ja jb jc hb bi translated">lockDevice()还有一个重载方法，我们可以在其中指定它需要被锁定的持续时间。</p></blockquote><h2 id="ae7b" class="jy jz hi bd ka kb kc kd ke kf kg kh ki iq kj kk kl iu km kn ko iy kp kq kr ks bi translated">让我们看一下我们将要执行的步骤</h2><p id="215c" class="pw-post-body-paragraph if ig hi ih b ii lf ik il im lg io ip iq lh is it iu li iw ix iy lj ja jb jc hb bi translated">启动已经安装在仿真器设备上的Swag Labs应用程序。<br/>使用用户名:standard_user和密码:secret_sauce <br/>进行登录，等待5秒钟<br/>锁定设备。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="er es lk"><img src="../Images/97a85250390325f8cbcf176ff6fa1542.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cLOXbIh8TLAMg4XyFsX3iA.png"/></div></div></figure><p id="98a4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">目前，我没有使用任何单独的驱动程序类来初始化，也没有使用任何页面对象模型的概念，这只是最基本的脚本。说吧，你可以说我懒！！😜</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lp"><img src="../Images/327fd4d4e703a1e942f738fe1811a43c.png" data-original-src="https://miro.medium.com/v2/resize:fit:816/1*koASqOUVAhPXpEO0SUj_Ew.gif"/></div><figcaption class="ju jv et er es jw jx bd b be z dx translated">试运行—锁定设备</figcaption></figure><p id="9191" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jo">现在，我们已经了解了如何锁定设备，让我们看看解锁设备的各种方法。</em></p><blockquote class="jl jm jn"><p id="e23b" class="if ig jo ih b ii ij ik il im in io ip jp ir is it jq iv iw ix jr iz ja jb jc hb bi translated">您可能知道，我们可以通过多种方式解锁Android设备，这可以是默认选项，您只需按下电源按钮即可锁定/解锁设备(即没有PIN/密码/模式设置)，也可以是您设置了一些PIN或密码或模式。</p></blockquote><p id="91e8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所有这些选项都可以通过Appium DesiredCapabilities进行处理，您需要为其指定“unlockType”和“unlockKey”详细信息。</p><h2 id="cd49" class="jy jz hi bd ka kb kc kd ke kf kg kh ki iq kj kk kl iu km kn ko iy kp kq kr ks bi translated">使用PIN解锁Android模拟器设备</h2><blockquote class="jl jm jn"><p id="340f" class="if ig jo ih b ii ij ik il im in io ip jp ir is it jq iv iw ix jr iz ja jb jc hb bi translated">在这种情况下，我们为我们的android模拟器设备设置了一些PIN。这可以通过设置应用程序&gt;安全&gt;设备安全&gt;屏幕锁定来完成</p></blockquote><p id="6f1a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我们的例子中，我将为我的设备设置一个PIN: 123456。</p><p id="54d8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">相应地，在我的脚本中，我已经使用期望的功能提到了这些细节，现在我的设置方法将如下所示。</p><blockquote class="jl jm jn"><p id="ec06" class="if ig jo ih b ii ij ik il im in io ip jp ir is it jq iv iw ix jr iz ja jb jc hb bi translated"><em class="hi">同样在我的测试方法post lockDevice()中，我们必须添加unlockDevice() </em></p></blockquote><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="er es lq"><img src="../Images/395797d4ee0d5f0fb0fd0e9811c0e4c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6aGBX2BC-QBHB9K8_TER5Q.png"/></div></div><figcaption class="ju jv et er es jw jx bd b be z dx translated">增加了设备解锁功能</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="er es lr"><img src="../Images/37ec7ee0b811d27454e22585b50085aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_RV0lxt0xYa6AcaQ9ws2EQ.png"/></div></div><figcaption class="ju jv et er es jw jx bd b be z dx translated">测试类已更新</figcaption></figure><p id="c4f9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是我的测试运行现在看起来像post添加这些行，正如你看到的post设备锁它会自动解锁它使用我们设置的PIN。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lp"><img src="../Images/06513ddf5e5dad5bd56028a960bd535e.png" data-original-src="https://miro.medium.com/v2/resize:fit:816/1*r1I0j-7Oj6yEIDls8aybmg.gif"/></div></figure><h2 id="f21d" class="jy jz hi bd ka kb kc kd ke kf kg kh ki iq kj kk kl iu km kn ko iy kp kq kr ks bi translated">使用密码解锁Android模拟器设备</h2><p id="cddc" class="pw-post-body-paragraph if ig hi ih b ii lf ik il im lg io ip iq lh is it iu li iw ix iy lj ja jb jc hb bi translated">这种方法将类似于PIN，我们将需要指定细节:unlockType为“密码”，unlockKey为您在设备中设置的密码文本。期望的能力如下。</p><p id="4dcc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jo">在我的例子中，我将密码设置为“Android”</em></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="er es ls"><img src="../Images/cb878c28a8a4ba9c37883a7097185d53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wbc16MipkppluR9mSL7RBA.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lp"><img src="../Images/4718e4ab66d9c8c430f16c7010a9374b.png" data-original-src="https://miro.medium.com/v2/resize:fit:816/1*9nD4oMqXF8jS-W7sgITDTw.gif"/></div></figure><h2 id="6264" class="jy jz hi bd ka kb kc kd ke kf kg kh ki iq kj kk kl iu km kn ko iy kp kq kr ks bi translated">使用模式解锁Android模拟器设备</h2><p id="65f6" class="pw-post-body-paragraph if ig hi ih b ii lf ik il im lg io ip iq lh is it iu li iw ix iy lj ja jb jc hb bi translated">您可能知道，模式如下所示。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lt"><img src="../Images/eda429409d5ddfc84bd70c5a8f5e04ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:466/format:webp/1*0RlCvput8VUeG32XNNsGXQ.png"/></div></figure><p id="c28d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，在Appium中这是如何解锁的，每个点对应一个从1开始的特定数字。</p><blockquote class="jl jm jn"><p id="740f" class="if ig jo ih b ii ij ik il im in io ip jp ir is it jq iv iw ix jr iz ja jb jc hb bi translated"><strong class="ih hj">顶行:三个点将是1 2 3 <br/>中间行:三个点将是4 5 6 <br/>最后一行:三个点将是7 8 9 </strong></p></blockquote><p id="b8bb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">假设，我已经设置了一个模式，它是英文字符“Z ”,假设我决定从左上角开始。</p><blockquote class="jl jm jn"><p id="f5d9" class="if ig jo ih b ii ij ik il im in io ip jp ir is it jq iv iw ix jr iz ja jb jc hb bi translated">我的模式应该是“1235789”</p></blockquote><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lu"><img src="../Images/9224cf30c5990e8472d75c8a78e3374e.png" data-original-src="https://miro.medium.com/v2/resize:fit:458/format:webp/1*l5q0-CLLSwqNX8hPJzu-8w.png"/></div></figure><p id="2af1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们将这些细节添加到我们的设置脚本中(期望的功能)</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="er es lv"><img src="../Images/bf6fa6d82899f8b0e74ce504e0584f79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WK6EyucIleFG4yv67XjjfA.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lp"><img src="../Images/4952be697d3032814b856141e6bac5c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:816/1*C3FhmhoD7t8U74dqvBrUHw.gif"/></div></figure><p id="7236" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">就是这样，这就是你如何使用Appium DesiredCapabilities锁定和解锁你的android模拟器设备。😎</p><p id="b1c8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">感谢阅读！！！</p></div></div>    
</body>
</html>