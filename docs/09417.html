<html>
<head>
<title>Python Pandas Tutorial — 9</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python熊猫教程— 9</h1>
<blockquote>原文：<a href="https://medium.com/codex/python-pandas-tutorial-9-ad33fdc92659?source=collection_archive---------7-----------------------#2022-10-19">https://medium.com/codex/python-pandas-tutorial-9-ad33fdc92659?source=collection_archive---------7-----------------------#2022-10-19</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="2062" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">本教程将涵盖清理数据—转换数据类型和处理缺失值。</p><p id="0dfa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们使用一些缺失值、NAN值和自定义缺失值创建了以下数据框。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/3c920e539d93453e15efa83e3753388a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*33iJLcce2Kkn_k0XMheO1w.png"/></div></div></figure><p id="f597" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了处理丢失的值，我们在pandas中有dropna()方法，我将首先运行这个方法，然后我将解释所有相同的默认参数。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jp"><img src="../Images/b4a1c420447fa07dfc6e512a8836cc68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1188/format:webp/1*F7o2jNiqhlW4fMwcgHkFIQ.png"/></div></figure><p id="9dc6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了理解dropna()是如何工作的，让我们研究一下dropna()方法用来删除数据的默认参数。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jq"><img src="../Images/81be0473d0528eb373561d7eed9bf98d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1230/format:webp/1*ASbotuPsWLFhA_IVFsFSAQ.png"/></div></figure><p id="c196" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这两个参数是dropna()的默认参数，axis='index '意味着默认情况下它将在行中搜索，因此如果任何行有丢失的数据，它将删除它，我们也可以更改为列，但默认情况下它是行。</p><p id="0715" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">how='any '表示如果任何一列中有丢失的数据，它将删除该行。我们可以将其更改为“all ”,这意味着只有当所有列都有缺失数据时，它才会删除该行。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jr"><img src="../Images/4cc706090825da3653c96100dd5a9b2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1180/format:webp/1*0GUFixHqrDGGmIuAU-ZjXQ.png"/></div></figure><p id="b962" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，与之前的结果相比，现在我们得到了更多的行。</p><p id="6e24" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，如果数据在任何列中有任何缺失值，我们可以指定列名，而不是删除数据，因此如果想要删除没有电子邮件id的数据。我们可以用子集参数来实现。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es js"><img src="../Images/8d3b8c372d4c36ab2b4dd9be3b03851c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1332/format:webp/1*VWrL4LVJqCyPXNX-Qa07VA.png"/></div></figure><p id="c9e8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里,“how”属性值无关紧要，因为我们只检查单个列，所以如果我们传递“any”或“all ”,我们将得到相同的输出。</p><p id="8928" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们有一些复杂的需求，我们希望删除那些没有姓氏或电子邮件的行，然后我们可以将一个列列表传递给我们的子集。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jt"><img src="../Images/e74166cd231d1ea4b157dede500e1594.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DYY6JngwUJtXu60LIvFO7g.png"/></div></div></figure><p id="9bff" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您注意到，在第六行中，我们有一个自定义的“NA”或“Missing”值尚未删除。为了移除这些值，根据我们创建数据框的方式，我们在这里使用字典创建了数据框，稍后我将展示一个CSV文件示例。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ju"><img src="../Images/0c1d0a513707e08eaee4740fe503f233.png" data-original-src="https://miro.medium.com/v2/resize:fit:1170/format:webp/1*hp9lhn2C1jsc1wyqRozvPQ.png"/></div></figure><p id="b129" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，我们已经用NumPy NaN值替换了所有“NA”和“Missing”值，现在如果我们运行dropna()方法，这些数据将从数据框中移除。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jv"><img src="../Images/cc15f60095559e6f1b2bf45ee0888508.png" data-original-src="https://miro.medium.com/v2/resize:fit:1162/format:webp/1*HaWvvIyO8ASIkaZTb1qG4w.png"/></div></figure><p id="d11c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们还可以将NaN值填充到某个默认字符串或默认数字中，为此我们可以使用fillna()方法。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jw"><img src="../Images/76b2718bdf2fd2bf09748a79a5238ed6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1268/format:webp/1*XolNXE7MOAyXkKo94jRtyA.png"/></div></div></figure><p id="a935" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，我们已经将所有的NaN值填充到默认字符串中，我们还有一个方法isna()，如果值为NaN，它将返回true，否则返回false。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jx"><img src="../Images/243666482e3483e7959613cebbb3186e.png" data-original-src="https://miro.medium.com/v2/resize:fit:806/format:webp/1*h0Rlm62MV6RmR_4p1n3mjg.png"/></div></figure><p id="69c3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们需要计算平均年龄，所以如果我们直接在列中运行mean()函数，我们将得到一个错误。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jy"><img src="../Images/9b03c9d8f5edaa53b3afc28be1493dc5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GNnsVdUhraJNmFryFQPOAw.png"/></div></div></figure><p id="571a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是一个很大的错误，但是在最后，它说我们不能把str和int连接起来。</p><p id="97e1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，我们首先使用dtypes检查年龄列的数据类型，然后将str转换为float来计算平均值。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jz"><img src="../Images/8ef591824c1832e052320d58fd434a78.png" data-original-src="https://miro.medium.com/v2/resize:fit:716/format:webp/1*s58N5sCdZjiE6LbwfjcZlw.png"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ka"><img src="../Images/9a7b9ec4086680d93370e507c5f07f07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*efV0CLmDxtks7XkjvokIiQ.png"/></div></figure><p id="2258" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，当我们使用CSV创建数据框时，我们将切换到StackOverflow调查数据，并检查如何处理NA或缺失值。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kb"><img src="../Images/2fbabb19edc5a5aa56b32b2c55bf96c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NuswHMZB6Vzvrttwjz6RBA.png"/></div></div></figure><p id="373c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，我创建了一个na值列表作为na_vals，我们需要在创建数据框时传递一个参数，它将忽略Na或缺失值。</p><p id="28d1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们想要计算开发人员的经验平均值，但是在应用该函数之前，如果我们检查该列中的唯一值，我们将得到String、int和NaN值的混合。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kc"><img src="../Images/c91f1970488f5630a7fe9ab5d2499c88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*THyyLQQrQ9ArkRddEo2YZQ.png"/></div></div></figure><p id="a4e1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以，我们不能直接套用，意思到这一栏。因此，首先我们需要转换该数据中可用的两个字符串值，然后我们将执行mean。</p><p id="cbd9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，我使用替换方法将“不到1年”转换为零，将“超过50年”转换为52。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kd"><img src="../Images/ad89f4450c00d894d37024383945de4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NNyBg9-BU-CtTvHfXKnH0A.png"/></div></div></figure><p id="1285" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们可以使用mean()方法找到经验的平均年份。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ke"><img src="../Images/6e6f0377bce5f6463bbad10cdbe94aea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1298/format:webp/1*B2gjw40SoN1Eya62mpGRbA.png"/></div></figure><p id="159b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在下一个教程中，我们将讨论如何处理日期和时间序列数据。</p></div></div>    
</body>
</html>