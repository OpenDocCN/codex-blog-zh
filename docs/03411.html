<html>
<head>
<title>Monitor and Update your models</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">监控和更新您的模型</h1>
<blockquote>原文：<a href="https://medium.com/codex/monitor-and-update-your-models-7eb7fc734708?source=collection_archive---------9-----------------------#2021-09-01">https://medium.com/codex/monitor-and-update-your-models-7eb7fc734708?source=collection_archive---------9-----------------------#2021-09-01</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="912f" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">部署您的模型只是开始…</h2></div><p id="29be" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在一个漫长的开发阶段之后，您必须处理特征工程、特征选择、正则化等等，您终于在您的生产环境中部署了令人敬畏的机器学习模型。</p><p id="3820" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">但是几周后，你会意识到你的模型失控了，它的预测毫无意义。发生什么事了？怎么解决呢？我们将在本文中回答这些问题</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es jt"><img src="../Images/348001ce6558da61e1ffa3212baa4f00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xuV3oLJTfAIUJw9220PDVA.jpeg"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">马里乌斯·马萨拉尔在<a class="ae kj" href="https://unsplash.com/s/photos/machine-learning?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><h1 id="f143" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">一.模型折旧</h1><p id="1a7d" class="pw-post-body-paragraph ix iy hi iz b ja lc ij jc jd ld im jf jg le ji jj jk lf jm jn jo lg jq jr js hb bi translated">所有模型最终都需要更新，以适应外部世界的变化</p><p id="91fb" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">事实上，您的模型的性能可能会因为以下两个因素而下降:</p><ul class=""><li id="d566" class="lh li hi iz b ja jb jd je jg lj jk lk jo ll js lm ln lo lp bi translated"><strong class="iz hj">数据漂移</strong>:可以描述为数据分布的变化。例如，标准偏差、平均值、中值的变化……像<a class="ae kj" href="https://en.wikipedia.org/wiki/Kolmogorov%E2%80%93Smirnov_test" rel="noopener ugc nofollow" target="_blank"> Kolmogorov-Smirnov </a>这样的统计测试可以用来识别数据漂移</li><li id="d038" class="lh li hi iz b ja lq jd lr jg ls jk lt jo lu js lm ln lo lp bi translated"><strong class="iz hj">概念漂移</strong>:变量与输出之间的关系发生变化。事实上，数据中的模式和关系往往会随着时间的推移而演变，为分析某些初始数据而建立的模型会随着时间的推移而迅速过时，因为输入和输出变量之间的关系会发生变化</li></ul><p id="3285" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">所以一旦部署，你的模型会越来越不被看好。这种现象被称为<strong class="iz hj">模型漂移</strong>。这就是为什么你必须定期重新训练你的模型，使它保持敏锐。一个很好的方法是实施<strong class="iz hj">连续培训管道</strong>。</p><blockquote class="lv lw lx"><p id="157f" class="ix iy ly iz b ja jb ij jc jd je im jf lz jh ji jj ma jl jm jn mb jp jq jr js hb bi translated">持续培训(CT):它基本上是一个管道，使用来自生产环境的数据自动重新培训您的已部署模型。一旦经过训练，新模型就被用来代替旧模型。这是在不停止服务或中断操作的情况下完成的</p></blockquote><p id="bc95" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">要实现CT管道，您首先需要监控您的模型。之后，您需要<strong class="iz hj">设置您的模型何时更新以及在什么条件下更新</strong></p><h1 id="9e2c" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">二。模型监控</h1><p id="b35a" class="pw-post-body-paragraph ix iy hi iz b ja lc ij jc jd ld im jf jg le ji jj jk lf jm jn jo lg jq jr js hb bi translated">实现CT管道的第一步:监控您的模型。</p><p id="d22d" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">它基本上是设置所需的代码，以便您可以轻松地看到数据和概念漂移的影响，以及它们如何随着时间的推移而演变。</p><p id="881d" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">那么，我们需要监控什么？</p><ul class=""><li id="c897" class="lh li hi iz b ja jb jd je jg lj jk lk jo ll js lm ln lo lp bi translated"><strong class="iz hj">数据</strong>:数据分布(平均值、标准差、分位数等等)、数据的模式、…</li><li id="572a" class="lh li hi iz b ja lq jd lr jg ls jk lt jo lu js lm ln lo lp bi translated"><strong class="iz hj">模型</strong>:模型的度量指标(准确度、精确度、召回率、…)、延迟、训练时间、…</li></ul><p id="4c20" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">您可以通过在模型运行时进行一些测试并记录结果来监控它们。然后你可以把你的日志放在一个<a class="ae kj" href="https://en.wikipedia.org/wiki/Fileset" rel="noopener ugc nofollow" target="_blank">文件集</a> ( <a class="ae kj" href="https://en.wikipedia.org/wiki/Set_(mathematics)" rel="noopener ugc nofollow" target="_blank">集<a class="ae kj" href="https://en.wikipedia.org/wiki/Computer_file" rel="noopener ugc nofollow" target="_blank">个计算机文件</a>中的</a>个，通过定义属性或公共特征链接)或者一个弹性搜索中，你可以在以后分析它们。</p><p id="2a59" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">既然已经进行了监控，那么当两个监控轴(数据或模型)中的一个变红时，您必须找到一种方法来<strong class="iz hj">提醒</strong>您的团队。例如，可以通过邮件</p><p id="ddfb" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这一点上，如果我们的模型失去控制，你有一个清晰的系统来监控和警告你的团队。所以现在，您必须设置更新机制</p><h1 id="339c" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">三。模型更新</h1><p id="20f4" class="pw-post-body-paragraph ix iy hi iz b ja lc ij jc jd ld im jf jg le ji jj jk lf jm jn jo lg jq jr js hb bi translated">通过“建立更新机制”，我的意思是决定我的模型在什么时候和什么条件下被更新。</p><p id="e55b" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">第一步是决定模型何时更新。可以说，您必须决定使用哪个触发器:</p><ul class=""><li id="6bee" class="lh li hi iz b ja jb jd je jg lj jk lk jo ll js lm ln lo lp bi translated"><strong class="iz hj">按需</strong>:临时手动执行再培训</li><li id="daf9" class="lh li hi iz b ja lq jd lr jg ls jk lt jo lu js lm ln lo lp bi translated"><strong class="iz hj">按计划</strong>:如果ML系统定期提供新数据，您可以在相同的基础上重新培训。</li><li id="d735" class="lh li hi iz b ja lq jd lr jg ls jk lt jo lu js lm ln lo lp bi translated"><strong class="iz hj">关于模型性能退化</strong>:现在您已经监控了您的模型，您可以在重新训练模型之前决定您接受的最小精度(或者您使用的任何度量)</li><li id="fc4a" class="lh li hi iz b ja lq jd lr jg ls jk lt jo lu js lm ln lo lp bi translated"><strong class="iz hj">关于数据分布的重大变化</strong>:现在您已经监视了您的模型，您可以在重新训练模型之前决定您接受的数据的最大变化</li></ul><blockquote class="lv lw lx"><p id="c24f" class="ix iy ly iz b ja jb ij jc jd je im jf lz jh ji jj ma jl jm jn mb jp jq jr js hb bi translated">注意:只有最后两个触发器才需要监控你的模型。即使不是前两种情况，监控仍然可能是方便的，至少有一个可观察的系统</p></blockquote><p id="6ac9" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">重新训练的频率还取决于:</p><ul class=""><li id="0c09" class="lh li hi iz b ja jb jd je jg lj jk lk jo ll js lm ln lo lp bi translated">重新训练你的模型有多贵:它越贵，你重新训练它就越少</li><li id="af02" class="lh li hi iz b ja lq jd lr jg ls jk lt jo lu js lm ln lo lp bi translated">你的模型被否决的速度:你的模型越不稳定，你就越需要重新训练它。例如，如果变量非常动态(随时间变化很大)，这个变量的一个小变化就可能在很大程度上影响模型。</li></ul><p id="99cd" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">既然已经决定了重新训练模型的时间，就必须决定是否要用新模型替换旧模型。为此，新系统/模型必须通过一些条件:</p><ul class=""><li id="f631" class="lh li hi iz b ja jb jd je jg lj jk lk jo ll js lm ln lo lp bi translated"><strong class="iz hj">数据验证</strong>:测试数据模式是否已经改变，数据是否仍然具有代表性，……如果数据没有通过验证，那么模型甚至不会被重新训练</li><li id="b622" class="lh li hi iz b ja lq jd lr jg ls jk lt jo lu js lm ln lo lp bi translated"><strong class="iz hj">模型验证</strong>:比较新模型和新模型的准确性(或者你用来评估你的模型的任何度量)。如果根据您的要求，比较是可接受的，则更换模型</li></ul><p id="b4a4" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果这两个条件都满足，您的旧型号可以被更新的型号取代。如果没有，在推广到生产之前，让数据科学家/企业审查新模型的解释可能是一个好主意。您可能需要引入新的功能工程步骤或类似的东西。所以你必须回到开发阶段</p><blockquote class="lv lw lx"><p id="0865" class="ix iy ly iz b ja jb ij jc jd je im jf lz jh ji jj ma jl jm jn mb jp jq jr js hb bi translated">注意:你也可以发布你的新模型，这样它每次只服务于你的一部分用户，其余的由你的旧模型服务。新模式接管了越来越多的用户，直到它完全取代了以前的模式</p></blockquote><h1 id="a2f0" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">结论</h1><p id="ddf7" class="pw-post-body-paragraph ix iy hi iz b ja lc ij jc jd ld im jf jg le ji jj jk lf jm jn jo lg jq jr js hb bi translated">现在，由于CT管道的存在，您拥有了一个可靠且可维护的ML生产系统！用一个时髦的词来形容我刚才描述的，这是<strong class="iz hj"> MLOps的做法之一。</strong></p><blockquote class="lv lw lx"><p id="5b42" class="ix iy ly iz b ja jb ij jc jd je im jf lz jh ji jj ma jl jm jn mb jp jq jr js hb bi translated">MLOps:用于使ML模型在生产中可维护和可靠的一组实践。因此，通过CT(持续培训)管道监控和更新您的模型属于MLOps实践</p></blockquote><p id="183d" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我希望这篇文章对你有用。感谢阅读！</p><p id="ac97" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">参考资料:</p><p id="415a" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">[1]:<a class="ae kj" href="https://cloud.google.com/architecture/mlops-continuous-delivery-and-automation-pipelines-in-machine-learning" rel="noopener ugc nofollow" target="_blank">https://cloud . Google . com/architecture/mlops-continuous-delivery-and-automation-pipeline-in-machine-learning</a></p><p id="5456" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">【2】:<a class="ae kj" href="https://valohai.com/model-monitoring/" rel="noopener ugc nofollow" target="_blank">https://valohai.com/model-monitoring/</a></p><p id="4291" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">[3]:<a class="ae kj" href="https://www.datarobot.com/wiki/model-monitoring/" rel="noopener ugc nofollow" target="_blank">https://www.datarobot.com/wiki/model-monitoring/</a></p></div></div>    
</body>
</html>