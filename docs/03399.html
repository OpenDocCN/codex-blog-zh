<html>
<head>
<title>Machine Learning demystified through Excel</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过Excel揭开机器学习的神秘面纱</h1>
<blockquote>原文：<a href="https://medium.com/codex/machine-learning-demystified-through-excel-6d4f88f03b5c?source=collection_archive---------15-----------------------#2021-08-31">https://medium.com/codex/machine-learning-demystified-through-excel-6d4f88f03b5c?source=collection_archive---------15-----------------------#2021-08-31</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/b20851a53249f7a60e0029ba62a59d29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*yJvOYQ3xHEcO-nAe"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">米卡·鲍梅斯特在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="6fcb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在预测分析(监督学习)中，我们解决两类问题——回归和分类。分类模型在许多领域都有应用—欺诈/垃圾邮件检测、购买/不购买决策、机器故障预测、风险分类等等。在ML算法方面，我们有几种选择来解决这些问题。可以使用逻辑回归、决策树、集成模型、KNN、朴素贝叶斯、SVM和人工神经网络，这取决于数据的复杂性和某些特征，如记录数量、维度、连续/离散变量数量、基数、类别数量等。</p><p id="3960" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然而，在引擎盖下，这个想法在最基本的层面上保持不变。我们需要找到输入(独立变量)，它有最大的辨别能力来区分类别。我们称之为<strong class="ix hj">可变重要性</strong>，并挑选出最有效的以备后用(<strong class="ix hj">降维</strong>)。然后，我们将它们的影响与一些参数(逻辑回归、判别分析、朴素贝叶斯、人工神经网络)或无参数(决策树、KNN、SVM等)结合起来。)来找出成为一个类的成员的可能性。前一类算法称为<strong class="ix hj">参数模型</strong>，后一类称为<strong class="ix hj">非参数模型</strong>。</p><p id="c456" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们以更简单的方式使用同样的直觉。我们将使用Excel进行计算。让我们以广泛使用的虹膜数据集作为基本说明。这个数据集有一个因变量，它是离散的，有3个标签——“setosa”、“versicolor”和“virginica”。有4个独立变量，它们都是连续的。最上面的几行如下所示。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es jt"><img src="../Images/0fd72e5770945837256c7a10a3988f8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:902/format:webp/1*5TWEQXlIIqgQRUJPNoUlyg.png"/></div></figure><p id="4cc1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">可变重要性</strong></p><p id="1ad2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们将使用Excel数据透视表来查找变量的重要性。如果一个X变量是一个重要的因素，那么它的值在不同的类中应该是非常不同的。另一方面，一个不重要的变量不会显示出类之间的差异。这与方差间和方差内是一样的，我们在数据科学中会遇到很多地方。在下面的图片中，Var-2应该是一个比Var-1更重要的变量，因为它在两个类别(A和B)中的平均值非常不同。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es jy"><img src="../Images/f796be556bc3d4ab9d43ac86a9b17192.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*oRHqWHOh2i5ZzVLK5TbK4w.png"/></div></figure><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es jz"><img src="../Images/6d1f22f92d64a4ec00897ee4073976c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*pjCKkPUoCQ0sfnZciiENHw.png"/></div></figure><p id="0d77" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们计算了4个变量在每个类别中的平均值。然后，我们估计它们在总计(总体样本平均值)中的分散程度。它们之间的距离越大，重要性就越高。我们应该期待花瓣。宽度作为最重要的变量，因为离差最高。我们将色散计算为</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es ka"><img src="../Images/0329d87e7bc5c2bb27f3d71ade35a7bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:758/format:webp/1*w8tcGtfdNIqSyFeukQdz7w.png"/></div></figure><p id="fc46" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">花瓣宽度和花瓣宽度的离差分别为106%、79%、19%和16%。长度，萼片。分别为长度和萼片宽度。因此，这应该是重要性可变的顺序。在R中使用“<strong class="ix hj"> rpart </strong>”库(<strong class="ix hj"> CART model </strong>)可以获得相同的结果。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es kb"><img src="../Images/ab105288eed0c893baf042a3bd782b96.png" data-original-src="https://miro.medium.com/v2/resize:fit:834/format:webp/1*XHukhd4JUKCToHZiEvDcCg.png"/></div></figure><p id="fc81" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">只有顺序是重要的，应该进行比较，因为R计算在内部涉及更多。现在让我们转到模型拟合和预测。</p><p id="0159" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">预测</strong></p><p id="d5fc" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在我们的简单计算中，没有这样的模型拟合。我们将再次使用Excel数据透视表，但方式不同。我们将通过计算一系列值中的行总数的百分比来寻找概率。这可以通过Excel数据透视表中的分组选项来完成。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es kc"><img src="../Images/48a6710c251b3bad5820feedd2814622.png" data-original-src="https://miro.medium.com/v2/resize:fit:730/format:webp/1*qrYklconvHLl6BN8rDvUIw.png"/></div></figure><p id="1911" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">它的本质意思是如果萼片。长度在2–2.2的范围内，则100%可能是“杂色”，如果在2.2–2.4的范围内，则[14.3%，71.4%，14.3%]可能是“setosa”，“杂色”和“virginica”。同样的逻辑也适用于其他箱和其他变量。</p><p id="f10e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果面元尺寸太大，我们将无法充分捕捉模式，如果面元尺寸非常小，我们可能会捕捉到噪声。<strong class="ix hj">这分别类似于ML中的欠拟合或过拟合模型。</strong></p><p id="59e7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们的简单分类器已经可以用于这些概率了。</p><p id="44c0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们用萼片对一个新样本进行预测。长度= 6.5，萼片。宽度= 3.0，花瓣。长度= 5.2，花瓣。宽度= 2.0。</p><p id="b2f3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">如果我们使用R中内置的CART模型，上述样本的预测是“VIRGINICA”。</strong></p><p id="571a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果我们对数据透视表中的这些值进行vlookup，3个类别的每个变量的概率如下。正如所料，最有力的变量预测它是“海滨”(100%概率。)与R结果一致，而最不重要的在“versicolor”和“Virginica”上分裂。从下表中，我们可以明智地将预测结果视为“弗吉尼亚”。<strong class="ix hj">我们通过Excel中的基本计算建立了一个简单的模型，与R结果相匹配。</strong></p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es kd"><img src="../Images/a0532d260716a7fe4ace7f747ad19800.png" data-original-src="https://miro.medium.com/v2/resize:fit:560/format:webp/1*TVwj9jumND_RwEeXvLNXHw.png"/></div></figure><p id="a8a3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了测试这个简单但基本正确的原则，我们可以使用一个更复杂的案例。<strong class="ix hj">让我们使用Kaggle上的电信客户流失数据集。</strong></p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es jz"><img src="../Images/48af9f587d7fce99ab662497332d5475.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*X18trXB1VqQKMrOSwZIYqg.png"/></div></figure><p id="31ab" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">它有4250条记录和一个二进制输出变量(关于流失的是/否)。有19个X变量。前几条记录的示例如下所示。</p><p id="f800" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们用同样的逻辑来寻找变量的重要性。前面计算的离差给出了4个重要的X变量—<strong class="ix hj">Vmail消息数量、全天分钟数、全天费用和客户服务呼叫次数</strong>。很少有像状态这样的离散X变量。它们的重要性可以用同样的方式来判断，但是用否/是类的计数(%)。例如，全球范围内，否定/肯定分类的百分比分别为85%和14%。钙的这一比例为74-26%，钴的这一比例为87-13%。我们可以发现他们与全球平均85%和14%的差距有多大。所有50个州的分裂都接近全球平均水平，这并没有什么惊人之处。</p><p id="5cad" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们将按照同样的逻辑创建容器，并在其中寻找概率。我们可以保留20%的样本作为批量预测的测试数据。</p><p id="88ef" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">做Vlookup，我们可以找到与4个最重要的变量相对应的概率。<strong class="ix hj">我们可以使用50%的最大概率和阈值来将它们分类为是/否。</strong>最大值更合适，因为平均值受极限的影响。使用此规则，结果如下所示。<strong class="ix hj">与之相邻的是R </strong>中运行的逻辑回归的结果。<strong class="ix hj">我们可以再次看到，这个简单的分类器和r的一样好(或者不好)</strong></p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es ke"><img src="../Images/14838f07770fb7d6cf9c48937fb8903e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1332/format:webp/1*Bx-MiVRl7AVZ9R4xJYJAKQ.png"/></div></figure><p id="4657" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">总之，简单探索性分析也有很多优点。我们可以明智地使用它们来补充高级分析，或者向不熟悉这个领域的人解释这些模型的工作原理。显然，高级模型对于实际数据集是必须的，因为我们不能用这些简单的计算来解决现实世界中遇到的复杂问题。但是我们不应该把ML模型当作一个黑箱，并鼓励其他人也去理解在幕后工作的基本原理。这些毕竟是建立在相同的基本逻辑之上的，尽管有很多数学上的严格性。</p></div></div>    
</body>
</html>