<html>
<head>
<title>Set up an Ubuntu-based EC2 Instance with a Virtual Python Environment</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用虚拟Python环境设置一个基于Ubuntu的EC2实例</h1>
<blockquote>原文：<a href="https://medium.com/codex/set-up-an-ubuntu-based-ec2-instance-with-a-virtual-python-environment-ae7c434fccc6?source=collection_archive---------4-----------------------#2021-04-10">https://medium.com/codex/set-up-an-ubuntu-based-ec2-instance-with-a-virtual-python-environment-ae7c434fccc6?source=collection_archive---------4-----------------------#2021-04-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="0e40" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">如何使用Ubuntu 20.04 AMI创建EC2实例，然后通过AWS CLI安装Python虚拟环境。</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/dd8ea34287c0cf5ab78a9d6afd0bc4a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K4Mh8VvzHyRyXalmUxoqiQ.png"/></div></div></figure><p id="8fdc" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">使用AWS CLI和AWS控制台，我们将完成实现七个目标所需的步骤:</p><ol class=""><li id="1e27" class="kf kg hi jl b jm jn jp jq js kh jw ki ka kj ke kk kl km kn bi translated">创建用户、下载凭据并设置AWS CLI。</li><li id="6ddb" class="kf kg hi jl b jm ko jp kp js kq jw kr ka ks ke kk kl km kn bi translated">创建一个Ubuntu 20.04 Ec2实例(t3.small)。</li><li id="8133" class="kf kg hi jl b jm ko jp kp js kq jw kr ka ks ke kk kl km kn bi translated">使用您的密钥对连接并登录到实例。</li><li id="a517" class="kf kg hi jl b jm ko jp kp js kq jw kr ka ks ke kk kl km kn bi translated">刷新更新并升级实例上的所有包。</li><li id="b506" class="kf kg hi jl b jm ko jp kp js kq jw kr ka ks ke kk kl km kn bi translated">创建一个名为“environment”的目录，并在该目录中创建一个虚拟python环境。</li><li id="84a5" class="kf kg hi jl b jm ko jp kp js kq jw kr ka ks ke kk kl km kn bi translated">激活虚拟环境并确认环境已启动。</li><li id="4ad7" class="kf kg hi jl b jm ko jp kp js kq jw kr ka ks ke kk kl km kn bi translated">创建一个名为<a class="ae kt" href="http://hello.py/" rel="noopener ugc nofollow" target="_blank"> hello.py </a>的程序，打印“hello，World！”在该文件中，退出vim/nano，并运行程序。</li></ol><h1 id="bda1" class="ku kv hi bd kw kx ky kz la lb lc ld le io lf ip lg ir lh is li iu lj iv lk ll bi translated">步骤1:用户和CLI设置</h1><p id="43f8" class="pw-post-body-paragraph jj jk hi jl b jm lm ij jo jp ln im jr js lo ju jv jw lp jy jz ka lq kc kd ke hb bi translated">登录AWS管理控制台(控制台)，转到IAM仪表板，然后单击“添加用户”</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lr"><img src="../Images/9897012d6c2fe156997bad34bf8c621d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gi_ztFo3YqYUHIjOG6Ag4Q.png"/></div></div></figure><p id="01c9" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">当该选项出现在“用户设置”中时，选中该框以授予新用户编程权限，并在用户的“摘要”选项卡中确认权限设置。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lr"><img src="../Images/af84d6a3c299fcc8c29c8c3541583c02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M8Lvz1lB2ad2u640jvlEAQ.png"/></div></div></figure><p id="912b" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">为新用户创建并下载一个<strong class="jl hj">密钥对</strong>——配置AWS CLI需要此凭证。</p><p id="2a76" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">如果您的本地机器上没有安装AWS CLI，请按照<a class="ae kt" href="https://docs.aws.amazon.com/cli/latest/userguide/cli-chap-install.html" rel="noopener ugc nofollow" target="_blank">用户指南第</a>页上针对您的操作系统的说明进行安装。</p><p id="73a3" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">接下来，要通过新用户运行AWS CLI命令，您必须在您选择的文本编辑器中更新AWS帐户的凭据和配置文件。但是首先，为新用户创建一个登录配置文件:</p><pre class="iy iz ja jb fd ls lt lu lv aw lw bi"><span id="d6f9" class="lx kv hi lt b fi ly lz l ma mb">aws iam create-login-profile — user-name &lt;your-user&gt; — password &lt;your-password&gt;</span></pre><ul class=""><li id="33be" class="kf kg hi jl b jm jn jp jq js kh jw ki ka kj ke mc kl km kn bi translated">In ~/。aws/credentials，括号内添加新用户的用户名，添加<em class="md"> aws_access_key_id </em>和<em class="md"> aws_secret_access_key。</em></li><li id="28f6" class="kf kg hi jl b jm ko jp kp js kq jw kr ka ks ke mc kl km kn bi translated">In ~/。aws/config，在括号中添加新用户的profile ID，并列出<em class="md"> source_profile </em>和<em class="md"> region </em>。</li></ul><p id="433a" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">要使用AWS资源作为新用户，请输入“export AWS_PROFILE= <new-user>”命令。</new-user></p><h1 id="4158" class="ku kv hi bd kw kx ky kz la lb lc ld le io lf ip lg ir lh is li iu lj iv lk ll bi translated">步骤2:创建一个Ubuntu 20.04 EC2实例</h1><p id="3907" class="pw-post-body-paragraph jj jk hi jl b jm lm ij jo jp ln im jr js lo ju jv jw lp jy jz ka lq kc kd ke hb bi translated">回到AWS控制台，导航到EC2仪表板并单击“启动实例”在这个实例中，设置步骤1，在搜索字段中输入“Ubuntu”以显示实例选项。选择<strong class="jl hj"> Ubuntu Server 20.04 LTS </strong>并点击“下一步”</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lr"><img src="../Images/a91b05f2a427f2265df6970c3edc7133.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mRZ10-CiCc-Lmuq6hiaLSw.png"/></div></div></figure><p id="8598" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">例如，键入，选择“<strong class="jl hj"> t3.small </strong>”确保在配置步骤中选择“启用”公共IPv4地址，并将您的安全组设计为允许从您选择的IP范围进行SSH访问。</p><p id="e8c9" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">为实例选择或创建一个<strong class="jl hj">密钥对</strong>，然后点击“启动实例”</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lr"><img src="../Images/3fe1baf8e5ec6018799ad9662a42ddc7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7upVUaqG2K2GZZXmLdiaRA.png"/></div></div></figure><p id="6f8c" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">在EC2仪表板的Instances页面上，确认实例已成功启动并通过了两次状态检查。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es me"><img src="../Images/9e95dadbaa3e7867d00dbc2db7bd9284.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K7W3y1z59XP8QsI5Idferg.png"/></div></div></figure><h1 id="d4a3" class="ku kv hi bd kw kx ky kz la lb lc ld le io lf ip lg ir lh is li iu lj iv lk ll bi translated">步骤3:连接并登录</h1><p id="0bcb" class="pw-post-body-paragraph jj jk hi jl b jm lm ij jo jp ln im jr js lo ju jv jw lp jy jz ka lq kc kd ke hb bi translated">当实例准备就绪时，单击“<strong class="jl hj"> Connect </strong>”并选择用于SSH访问的选项卡。按照说明通过SSH登录到您的实例。我的输入和输出如下所示:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mf"><img src="../Images/dbd427fba819dd93e4e8fb91091e81aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*khWL-4SOAEBwD2cGsfMeyQ.png"/></div></div></figure><h1 id="d082" class="ku kv hi bd kw kx ky kz la lb lc ld le io lf ip lg ir lh is li iu lj iv lk ll bi translated">步骤4:更新和升级Ubuntu服务器</h1><p id="56ac" class="pw-post-body-paragraph jj jk hi jl b jm lm ij jo jp ln im jr js lo ju jv jw lp jy jz ka lq kc kd ke hb bi translated">使用Ubuntu命令更新和升级实例及其包，如下所示:</p><ul class=""><li id="dc28" class="kf kg hi jl b jm jn jp jq js kh jw ki ka kj ke mc kl km kn bi translated">为了<strong class="jl hj">更新</strong>，运行<em class="md"> sudo apt更新</em></li><li id="1588" class="kf kg hi jl b jm ko jp kp js kq jw kr ka ks ke mc kl km kn bi translated">为了<strong class="jl hj">升级</strong>，运行<em class="md"> sudo来升级</em>(这可能需要一分钟才能完成)。</li></ul><h1 id="d1a0" class="ku kv hi bd kw kx ky kz la lb lc ld le io lf ip lg ir lh is li iu lj iv lk ll bi translated">步骤5:包含虚拟Python环境的环境目录</h1><p id="e4e5" class="pw-post-body-paragraph jj jk hi jl b jm lm ij jo jp ln im jr js lo ju jv jw lp jy jz ka lq kc kd ke hb bi translated">首先，创建一个新目录，运行<strong class="jl hj"> <em class="md"> mkdir环境</em> </strong>，然后将cd放入那个目录<em class="md">。</em></p><p id="8e4a" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">其次，使用Python的<a class="ae kt" href="https://docs.python.org/3/library/venv.html" rel="noopener ugc nofollow" target="_blank"> <strong class="jl hj"> venv </strong> </a> <strong class="jl hj">模块</strong>在新目录下安装一个虚拟环境。<em class="md"> </em>下面的命令应该管用:</p><pre class="iy iz ja jb fd ls lt lu lv aw lw bi"><span id="36e0" class="lx kv hi lt b fi ly lz l ma mb">sudo apt install python3-ven<em class="md">v</em></span></pre><p id="88f8" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">第三，创建包含虚拟环境和库的目录的路径:</p><pre class="iy iz ja jb fd ls lt lu lv aw lw bi"><span id="0571" class="lx kv hi lt b fi ly lz l ma mb">python3 -m venv &lt;your-env&gt;</span></pre><h1 id="3df0" class="ku kv hi bd kw kx ky kz la lb lc ld le io lf ip lg ir lh is li iu lj iv lk ll bi translated">步骤6:激活虚拟环境并确认</h1><p id="7677" class="pw-post-body-paragraph jj jk hi jl b jm lm ij jo jp ln im jr js lo ju jv jw lp jy jz ka lq kc kd ke hb bi translated">要激活新目录中的venv模块，请运行:</p><pre class="iy iz ja jb fd ls lt lu lv aw lw bi"><span id="9dc4" class="lx kv hi lt b fi ly lz l ma mb">source &lt;your-env&gt;/bin/activate</span></pre><p id="c67f" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">如果激活成功，您应该会看到您的环境名称出现在命令行的前面，例如:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mg"><img src="../Images/139769b15e05bb934fcbec7592547ecb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1348/format:webp/1*vm2PuIa9ETUEvjZl-RwyVw.png"/></div></figure><h1 id="ad71" class="ku kv hi bd kw kx ky kz la lb lc ld le io lf ip lg ir lh is li iu lj iv lk ll bi translated">步骤7:创建并运行“hello.py”</h1><p id="8d46" class="pw-post-body-paragraph jj jk hi jl b jm lm ij jo jp ln im jr js lo ju jv jw lp jy jz ka lq kc kd ke hb bi translated">要创建一个测试Python程序，使用vim、nano或您选择的文本编辑器来创建文件“hello.py”。例如<em class="md"> vim hello.py. </em></p><p id="872f" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">在新的Python文档中，只需输入Python命令“print('Hello World！)，”退出文本编辑器，并运行命令:</p><pre class="iy iz ja jb fd ls lt lu lv aw lw bi"><span id="326d" class="lx kv hi lt b fi ly lz l ma mb">python3 hello.py</span></pre><p id="45b9" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">输出应该立即显示“Hello World！”</p><p id="c2d8" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">例如，我的步骤5、6和7的CLI历史如下所示:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mh"><img src="../Images/7593d262f0b5f2defd4cfc64a4b446fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bjmIj6sG4xTlC0PJwDBiCA.png"/></div></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mh"><img src="../Images/50b13c483dc6eae8538c408d38f4b9e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R7Ejres8uEthdzRzP4oO3w.png"/></div></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mh"><img src="../Images/a5042dd56c1e84790a3db2771b76e515.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mzR7Gaa3wAwjGFf_XimKCA.png"/></div></div></figure><p id="a51d" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">恭喜您，您成功地在Ubuntu EC2实例中设置的虚拟环境中创建和运行了一个Python程序！</p><h2 id="8e26" class="lx kv hi bd kw mi mj mk la ml mm mn le js mo mp lg jw mq mr li ka ms mt lk mu bi translated">感谢您的阅读！</h2></div></div>    
</body>
</html>