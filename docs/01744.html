<html>
<head>
<title>A Super-Simple PHP Tutorial for Beginning to Code — Part 3 — Working with Databases via PDO</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">开始编码的超级简单的PHP教程——第3部分——通过PDO使用数据库</h1>
<blockquote>原文：<a href="https://medium.com/codex/a-super-simple-php-tutorial-for-beginning-to-code-part-3-working-with-databases-via-pdo-e32e0b929dfe?source=collection_archive---------3-----------------------#2021-05-26">https://medium.com/codex/a-super-simple-php-tutorial-for-beginning-to-code-part-3-working-with-databases-via-pdo-e32e0b929dfe?source=collection_archive---------3-----------------------#2021-05-26</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/804967fcc41d241d166e246515b10151.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hcKZe4hkZyfRbDcQlEgogw.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">简·安东宁·科拉尔在<a class="ae iu" href="https://unsplash.com/s/photos/database?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h1 id="8a91" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">第3部分的目的</h1><ul class=""><li id="2803" class="jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">理解关系数据库的基础，并能够使用PHP将它们集成到基于web的应用程序中。</li><li id="7939" class="jt ju hi jv b jw kl jy km ka kn kc ko ke kp kg kh ki kj kk bi translated">了解PHP扩展以及如何在您的web应用程序中使用他人的代码。</li></ul><h1 id="8c37" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">先决条件</h1><ul class=""><li id="9d68" class="jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated"><a class="ae iu" href="https://johncoonrod.medium.com/a-super-simple-php-tutorial-for-beginning-to-code-part-1-db703d22d227" rel="noopener">本系列的第1部分</a>——PHP基础知识</li><li id="35c0" class="jt ju hi jv b jw kl jy km ka kn kc ko ke kp kg kh ki kj kk bi translated">本系列的第2部分 — PHP页面间通信</li><li id="2ef1" class="jt ju hi jv b jw kl jy km ka kn kc ko ke kp kg kh ki kj kk bi translated">一个<strong class="jv hj">需要</strong>来处理数据。数据库从来都不容易使用。我试图创建一个尽可能简单的介绍，但是——如果你不需要数据库——就不要麻烦了！</li><li id="9f40" class="jt ju hi jv b jw kl jy km ka kn kc ko ke kp kg kh ki kj kk bi translated">数据库背后的基本概念——这里有一个很棒的<a class="ae iu" href="https://www.youtube.com/watch?v=wR0jg0eQsZA" rel="noopener ugc nofollow" target="_blank"> 5分钟YouTube教程</a>(你只需要前3分钟)。</li><li id="525c" class="jt ju hi jv b jw kl jy km ka kn kc ko ke kp kg kh ki kj kk bi translated">SQL的基本概念——结构化查询语言——这里是世界上最可爱的关于SQL的4分钟YouTube教程</li><li id="49e9" class="jt ju hi jv b jw kl jy km ka kn kc ko ke kp kg kh ki kj kk bi translated">什么不是先决条件——要开始安装PHP，您不需要安装apache这样的web服务器或MySQL这样的数据库服务器。我们已经看到了如何使用PHP内置的web服务器。在这里，您将使用其内置的SQLite数据库例程。</li></ul><h1 id="267f" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">基本概念</h1><ul class=""><li id="2e0a" class="jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated"><strong class="jv hj"> PDO — PHP数据对象</strong>。SQL是一种相当标准化的语言，被许多不同的实现所使用:MySQL、Postgress、Microsoft SQLServer、Oracle等等。PHP拥有PDO，而不必为每一个都重写代码。虽然我们不打算深入研究面向对象编码的复杂性，但是我们可以在过程化编码中安全地使用PDO，而不会有太多麻烦。</li><li id="b950" class="jt ju hi jv b jw kl jy km ka kn kc ko ke kp kg kh ki kj kk bi translated"><strong class="jv hj"> PHPINFO。你安装的PHP可能有也可能没有内置PDO。你怎么会知道？您需要一个简单的单行页面phpinfo.php如下:</strong></li></ul><pre class="kq kr ks kt fd ku kv kw kx aw ky bi"><span id="a3fe" class="kz iw hi kv b fi la lb l lc ld">&lt;?php phpinfo(); ?&gt;</span></pre><figure class="kq kr ks kt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es le"><img src="../Images/e083b07612581f5c23d94bab7e4971b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uk_1t4jtHtJz0no4U_EtVg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">来自phpinfo的一个很长的页面的标题</figcaption></figure><figure class="kq kr ks kt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lf"><img src="../Images/f8c02ae2e9af46e778b617ebe226e4d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9olJ9CLU_di2sy9YTf_gXA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">标题显示安装了哪些数据库驱动程序</figcaption></figure><ul class=""><li id="fece" class="jt ju hi jv b jw lg jy lh ka li kc lj ke lk kg kh ki kj kk bi translated"><strong class="jv hj"> PHP扩展:</strong>你会注意到上面已经安装了sqlite。如果没有，您需要为您的php版本安装sqlite扩展。例如，当我安装php7.4时它不存在，所以在linux中我需要:</li></ul><pre class="kq kr ks kt fd ku kv kw kx aw ky bi"><span id="0928" class="kz iw hi kv b fi la lb l lc ld">sudo apt install php7.4-sqlite3</span></pre><ul class=""><li id="8756" class="jt ju hi jv b jw lg jy lh ka li kc lj ke lk kg kh ki kj kk bi translated">(对于windows，这里的指令是<a class="ae iu" href="https://www.php.net/manual/en/install.pecl.windows.php" rel="noopener ugc nofollow" target="_blank">这里是</a>。)我还发现，当我第一次尝试运行phpliteadmin(如下所述)时，我也需要mbstring扩展。一旦安装了这些，它们就保持安装状态。</li></ul><pre class="kq kr ks kt fd ku kv kw kx aw ky bi"><span id="cfd2" class="kz iw hi kv b fi la lb l lc ld">sudo apt install php7.4-mbstring</span></pre><ul class=""><li id="9c72" class="jt ju hi jv b jw lg jy lh ka li kc lj ke lk kg kh ki kj kk bi translated"><strong class="jv hj">一个管理页面。</strong>在构建复杂的多页面web应用程序时，您不需要自己构建管理员页面。幸运的是，你可以简单地下载一个并链接到它(一旦你移动到一个公共服务器，就会有适当的保护)。对于SQLite，您可以下载一个页面<a class="ae iu" href="https://www.phpliteadmin.org/" rel="noopener ugc nofollow" target="_blank"> phpLiteAdmin </a>，它允许您创建或删除数据库和表格，插入、编辑或删除记录，并测试查询。它还可以导入和导出与电子表格程序兼容的CSV文件。</li><li id="3f35" class="jt ju hi jv b jw kl jy km ka kn kc ko ke kp kg kh ki kj kk bi translated"><strong class="jv hj">主键:</strong>数据库中的记录由字段中的值访问，通常由主键访问，主键通常是(但不是必须的)自动递增的整数，通常命名为id。您不必输入该字段，数据库会为您创建。</li><li id="cc6e" class="jt ju hi jv b jw kl jy km ka kn kc ko ke kp kg kh ki kj kk bi translated">大型数据库表通常有一个或多个索引，允许数据库找到你的记录，而不必读取整个文件。例如，如果您有一个百万人的表，您可能希望根据他们的姓氏或邮政编码创建一个索引。在SQLite中使用小表的情况下，没有理由创建索引，除非您真的想了解它们。</li><li id="1a8b" class="jt ju hi jv b jw kl jy km ka kn kc ko ke kp kg kh ki kj kk bi translated"><strong class="jv hj">查询:</strong>查询是从数据库获取数据的语句，如教程中所示。通常是“从&lt;表&gt;【where子句】中选择&lt;字段&gt;”的形式。例如，在test1的people表中，您可以执行下面的查询。还有SQL语句对数据库做所有其他的事情:创建、删除、删除、插入更新，你可以在这里找到<a class="ae iu" href="https://sqlite.org/lang.html" rel="noopener ugc nofollow" target="_blank"/>。</li></ul><pre class="kq kr ks kt fd ku kv kw kx aw ky bi"><span id="15ae" class="kz iw hi kv b fi la lb l lc ld">select first_name,last_name from people where name='Brown' </span></pre><h1 id="643b" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">终于！构建数据库PHP web应用程序！</h1><ul class=""><li id="dcd0" class="jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated"><strong class="jv hj">项目文件夹:</strong>你的app会由一堆小文件组成，请为它们创建一个文件夹。如果您还没有使用像VSCode这样可以处理文件夹文件的编辑器，这可能是一个转换的好时机！我已经把所有这些文件的副本放到了我的github库，所以你可以从https://github.com/jcoonrod/demo1下载或者“克隆”它们</li><li id="c491" class="jt ju hi jv b jw kl jy km ka kn kc ko ke kp kg kh ki kj kk bi translated"><strong class="jv hj">错误报告:</strong> PHP通常不会在浏览器中显示错误。在生产环境中，您真的不希望用户看到这些消息——它们出现在服务器上。但是当你开发一个数据库应用程序时，你实际上会想要看到它们。我已将它们添加到下一部分。</li><li id="7f0a" class="jt ju hi jv b jw kl jy km ka kn kc ko ke kp kg kh ki kj kk bi translated"><strong class="jv hj"> D.R.Y .(不要重复自己):</strong>我们将创建一堆具有相同标题的相似页面，所以header.php将保存共同的行，然后我们可以在其他页面中包括它，包括一个超级简单的菜单，超级精简的CSS和在<a class="ae iu" href="https://web.dev/measure/" rel="noopener ugc nofollow" target="_blank">谷歌的灯塔测试</a>中获得100%分数所必需的标题(这是我总是喜欢做的事情，如果我可以的话)。)你会在那里看到一个svg图标——SVG图形是一个有趣的学习工具。我最喜欢的学习网络知识的地方</li></ul><pre class="kq kr ks kt fd ku kv kw kx aw ky bi"><span id="aff8" class="kz iw hi kv b fi la lb l lc ld">&lt;!DOCTYPE html&gt;<br/>&lt;html lang='en'&gt;<br/>&lt;head&gt;&lt;title&gt;My App&lt;/title&gt;<br/>&lt;link rel="icon" type="image/svg+xml" href="/favicon.svg"&gt;<br/>&lt;meta name="viewport" content="width=device-width, initial-scale=1"&gt;<br/>&lt;meta name = "Description" content = "My first database app"&gt;<br/>&lt;style&gt; * {font-family:sans-serif;}<br/>nav, th {color:white; background-color:navy;padding:5px;}<br/>nav a {color:white; font-weight:bold; text-decoration:none;}<br/>nav a:hover {background-color:green;}<br/>&lt;/style&gt;<br/>&lt;/head&gt;<br/>&lt;body&gt;<br/>&lt;nav&gt;<br/>&lt;a href="/"&gt;Home&lt;/a&gt; |<br/>&lt;a href="/people.php"&gt;People&lt;/a&gt; |<br/>&lt;a href="/products.php"&gt;Products&lt;/a&gt; |<br/>&lt;a href="/phpinfo.php"&gt;PHPInfo&lt;/a&gt; |<br/>&lt;a href="/phpliteadmin.php" target="_blank"&gt;Admin&lt;/a&gt;<br/>&lt;/nav&gt;</span></pre><ul class=""><li id="c6de" class="jt ju hi jv b jw lg jy lh ka li kc lj ke lk kg kh ki kj kk bi translated"><strong class="jv hj">将PHP连接到数据库:</strong>这是一个简单的例子，它连接到数据库，并将客户的名字复制到一个表中。您将在包含“- &gt;”的表达式中看到您的第一份OOP代码像PDO这样的对象有一堆函数，你可以用“objectname- &gt; function”来引用它们“new”命令创建一个新的PDO对象，我们将其命名为$db，指向我们的数据库文件。query命令创建一个我们称之为$stmt的语句对象，它的fetch函数以常规数组的形式一次返回一个$行。坦白说，这些是我唯一用过的东西。</li></ul><pre class="kq kr ks kt fd ku kv kw kx aw ky bi"><span id="7646" class="kz iw hi kv b fi la lb l lc ld">&lt;?php require_once("header.php"); ?&gt;<br/>&lt;h1&gt;People in Test1&lt;/h1&gt;<br/>&lt;?php<br/>$db=new PDO("sqlite:test1.db");<br/>if(!$db) Die("Failed to connect");</span><span id="ddd3" class="kz iw hi kv b fi ll lb l lc ld">$stmt=$db-&gt;query("select first_name,last_name from customers order by 2");<br/>if(!$stmt) die(print_r($db-&gt;errorInfo(),true));<br/>?&gt;<br/>&lt;table&gt;<br/>&lt;tr&gt;&lt;th&gt;First Name&lt;/th&gt;&lt;th&gt;Last Name&lt;/th&gt;&lt;/tr&gt;<br/>&lt;?php <br/>while($row=$stmt-&gt;fetch()) <br/>  echo("&lt;tr&gt;&lt;td&gt;".$row[0]."&lt;/td&gt;&lt;td&gt;".$row[1]."&lt;/td&gt;&lt;/tr&gt;");<br/>?&gt;<br/>&lt;/table&gt;<br/>&lt;/body&gt;<br/>&lt;/html&gt;</span></pre><h1 id="d169" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">问题集</h1><ul class=""><li id="78e7" class="jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">将类似的查询语言添加到按价格列出订购产品的products.php页面中。</li><li id="38f0" class="jt ju hi jv b jw kl jy km ka kn kc ko ke kp kg kh ki kj kk bi translated">创建一个新表“采购”,该表将客户与产品关联起来(提示——4个整数字段和一个，id，customer_id，product_id，purchase_date)。对于后者，在https://www.sqlite.org/datatype3.html<a class="ae iu" href="https://www.sqlite.org/datatype3.html" rel="noopener ugc nofollow" target="_blank">学习Unix时间</a></li><li id="6df9" class="jt ju hi jv b jw kl jy km ka kn kc ko ke kp kg kh ki kj kk bi translated">向菜单中添加一个新页面——purchase.php，该页面选择一个客户和一个产品，并向采购表中插入一条新记录。</li></ul><h1 id="eb30" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">何去何从！</h1><ul class=""><li id="2b5e" class="jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">一旦您熟悉了这一点，您就可以轻松地将所学应用到使用MySQL或其他专业级数据库的“真实世界”系统中。</li><li id="3aca" class="jt ju hi jv b jw kl jy km ka kn kc ko ke kp kg kh ki kj kk bi translated">如果你开始在云中构建应用程序(如谷歌或AWS)，多页面应用程序通常会将每个URL发送到index.php，在那里你需要拉入URI($ URL = $ _ SERVER[' REQUEST _ URI '])并<a class="ae iu" href="https://www.php.net/manual/en/function.parse-url.php" rel="noopener ugc nofollow" target="_blank">解析i </a> t，然后“require_once”相关文件。</li><li id="1a2a" class="jt ju hi jv b jw kl jy km ka kn kc ko ke kp kg kh ki kj kk bi translated">使用PHP的一个好处是，你遇到的任何问题都已经被别人解决了，你可以简单地用谷歌搜索并根据你的需要进行修改。很多人会提到所有需要“Composer”包管理器的包，并学习关于类和名称空间的知识。我通常避免这些(<a class="ae iu" href="https://johncoonrod.medium.com/top-10-reasons-we-should-stop-using-frameworks-5d23139be728" rel="noopener">见我的文章</a>)。如果您必须通过composer包含一个包，您可能仍然不需要了解太多关于类或名称空间的知识。</li></ul></div></div>    
</body>
</html>