<html>
<head>
<title>Building Data Platforms I — The ETL bias</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">构建数据平台I——ETL偏好</h1>
<blockquote>原文：<a href="https://medium.com/codex/building-data-platforms-the-etl-bias-d589733ce4cc?source=collection_archive---------0-----------------------#2021-05-30">https://medium.com/codex/building-data-platforms-the-etl-bias-d589733ce4cc?source=collection_archive---------0-----------------------#2021-05-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="7ca4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">[第二部分现已开始—<a class="ae jd" href="https://link.medium.com/f6Ixe9Htbhb]" rel="noopener">https://link.medium.com/f6Ixe9Htbhb】</a></p><p id="951d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">[第三部分现已发布<a class="ae jd" href="https://joaovasques.medium.com/building-data-platforms-iii-the-evolution-of-the-software-engineer-bdb3d9c1dd71" rel="noopener">此处</a></p><p id="5019" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是构建数据平台系列的第一篇文章。你可能会问，为什么要这样做？很简单。如果你退后一步，看看软件行业处理数据的方式，你会发现与过去10-15年中发生的其他转变相比，它并没有发生根本性的变化。我们有了Kafka、Spark、Flink和Snowflake等新工具，但我们没有改变构建数据平台的思维模式。正如你将会看到的，这有很多后果，从缺乏生产力，破碎的系统，知识筒仓，不快乐的人，等等。</p><p id="29e5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们从我认为的构建数据平台的最大问题开始这个系列ETL偏差。</p><h1 id="5586" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">什么是ETL？</h1><p id="5b3d" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">ETL代表提取、转换和加载，在20世纪70年代非常流行。在那十年中，公司开始拥有多个数据存储库，并希望将相关信息保存在一个地方进行分析。ETL成为执行这些类型操作的事实上的标准。</p><h2 id="34b2" class="kh jf hi bd jg ki kj kk jk kl km kn jo iq ko kp js iu kq kr jw iy ks kt ka ku bi translated">提取</h2><p id="c12d" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">这一步负责从一组数据源中读取数据。这些通常是关系数据库、NoSQL数据库、JSON、CVS或XML文件等。大多数情况下，这一步需要对数据所在的位置进行直接只读访问。</p><h2 id="c0bf" class="kh jf hi bd jg ki kj kk jk kl km kn jo iq ko kp js iu kq kr jw iy ks kt ka ku bi translated">改变</h2><p id="8e9a" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">转换源数据以匹配目标系统的格式。此阶段的操作包括更改数据类型、合并或拆分字段、应用更复杂的公式来派生新字段。</p><h2 id="0575" class="kh jf hi bd jg ki kj kk jk kl km kn jo iq ko kp js iu kq kr jw iy ks kt ka ku bi translated">负荷</h2><p id="062c" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">这个步骤获取转换阶段产生的数据，并将其持久化到目标数据系统中。目标系统通常是数据仓库或文件系统。</p><p id="5cf2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ETL可以链接在一起以创建计算管道，并且通常被安排以给定的频率运行(例如每小时、每天、每月等)。</p><p id="827c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们有了ETL的定义，让我们开始理解它的一些问题。</p><h1 id="f377" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">第一个数据产品</h1><p id="534f" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">公司中的第一个数据产品通常是相同的，并满足以下需求</p><blockquote class="kv kw kx"><p id="4aa4" class="if ig ky ih b ii ij ik il im in io ip kz ir is it la iv iw ix lb iz ja jb jc hb bi translated">“我们需要关于我们主要产品的指标和KPI”。</p></blockquote><p id="bebc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">值得一提的是，我们现在谈论的不是平台，而是一个简单的数据产品。该数据产品的目标是让公司的每个人都能使用数据进行分析。</p><p id="5daf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">大多数时候，第一个数据产品是使用某种ETL完成的，如下所示。</p><figure class="ld le lf lg fd lh er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es lc"><img src="../Images/274fb9d339e78409a0b054fb1038c754.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KYnMFi7S5JaeoKlJvd7p4A.jpeg"/></div></div><figcaption class="lo lp et er es lq lr bd b be z dx translated">经典的ETL管道</figcaption></figure><p id="6b3e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们仔细看看这里正在发生的事情:</p><ul class=""><li id="3ec1" class="ls lt hi ih b ii ij im in iq lu iu lv iy lw jc lx ly lz ma bi translated">我们有一个主操作数据库的只读副本</li><li id="dc22" class="ls lt hi ih b ii mb im mc iq md iu me iy mf jc lx ly lz ma bi translated">我们完全理解领域模型和模式</li><li id="2900" class="ls lt hi ih b ii mb im mc iq md iu me iy mf jc lx ly lz ma bi translated">有一个cron作业(或可视化拖放工具)运行一组MongoDB和SQL查询，应用一些转换并将其加载到另一个SQL数据库(例如，另一个Postgres/MySQL实例，因为人们没有时间学习新的数据库技术。)</li></ul><p id="89d9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该领域很小，其知识在所有工程团队中共享，从操作系统到KPI的映射逻辑非常简单，这使得它可以很快交付。ETL管道完成后，公司能够从其操作系统中提取数据，并拥有一套很好的仪表板来支持其业务。</p><p id="f2cd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第一个数据产品取得了巨大的成功，每个人都很满意。</p><figure class="ld le lf lg fd lh er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es mg"><img src="../Images/b69a732ebed7653b378aea959a56fe7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ntrZ3s0n7-8VrqHLyDp3NQ.jpeg"/></div></div></figure><h1 id="5ba4" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">复杂性开始出现</h1><p id="caee" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">有一个时间点，每个公司都开始将他们的整体分成更小的组件，即所谓的微服务。在这个微服务之旅中，工程团队通常应用<a class="ae jd" href="https://martinfowler.com/tags/domain%20driven%20design.html#:~:text=Domain%2DDriven%20Design%20is%20an,through%20a%20catalog%20of%20patterns." rel="noopener ugc nofollow" target="_blank">领域驱动设计概念</a>和API最佳实践，目标是封装复杂性(通过更高阶的抽象)，同时使系统可扩展。所有这些都在操作可靠性、开发速度和体验的口号下进行，最终目标是更快地构建更好的产品。</p><figure class="ld le lf lg fd lh er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es mh"><img src="../Images/d8e9863c5d2b8cf763853538c7a9b103.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aG7VGMEShINnguKhUmY55Q.jpeg"/></div></div></figure><p id="53b3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在扩展到微服务的过程中，团队可能会决定采用不同的数据库技术，因为它们在系统运行的领域和范围内是有意义的。因为系统通过API通信，所以拥有不同的数据库技术没有问题。</p><p id="2658" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在公司决定打破这种单一模式几个月后，工程师们加快了代码的发布速度，产品变得稳定了，新的功能也在开发中。打破巨石柱的任务成功了！</p><p id="5fd6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是，我们的数据产品呢？</p><p id="2720" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在过去的几个月里，ETL不断发展，变得更加复杂。ETL不必查询一个数据库来获取数据，而是必须连接到多个数据源。除了复杂性的明显增加，还有什么变化呢？</p><p id="6730" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">所有权— </strong>维护和开发ETL现在是构建它的第一批工程师的共同责任。这些工程师现在在负责特定领域的不同系统上工作。谁是ETL的所有者？</p><p id="f492" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">数据库技术— </strong>不同的系统可能有不同的数据库技术(例如，MongoDB、MySQL、Postgres、Cassandra等..).这意味着ETL逻辑将混合所有这些技术和不同的查询语言。这增加了ETL需要实现的业务逻辑的复杂性。</p><p id="f3f2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">稳定性— </strong>使用API的主要目的是允许团队在不破坏客户逻辑的情况下改变他们的系统。然而，由于ETL(大多数时候)连接到只读数据库，模式中的变化可能会中断ETL并导致<strong class="ih hj">数据停机</strong>(我将在本系列的后面更深入地讨论这个主题)。此外，在操作系统中构建数据提取API并不是优先考虑的事情，因为团队需要专注于构建和改进主要产品。</p><p id="de59" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有一个时间点，公司意识到他们需要为他们的数据产品、他们的ETL拥有一个所有者。他们可能会承认这一点，因为:</p><ul class=""><li id="f0fb" class="ls lt hi ih b ii ij im in iq lu iu lv iy lw jc lx ly lz ma bi translated">人们开始抱怨丢失数据</li><li id="e7d7" class="ls lt hi ih b ii mb im mc iq md iu me iy mf jc lx ly lz ma bi translated">ETL管道破裂的频率越来越高，工程师们花费更多的时间来修复它们</li><li id="e6dd" class="ls lt hi ih b ii mb im mc iq md iu me iy mf jc lx ly lz ma bi translated">工程师们声称数据产品的查询逻辑太复杂，他们缺乏对特定数据库的深入了解</li><li id="de81" class="ls lt hi ih b ii mb im mc iq md iu me iy mf jc lx ly lz ma bi translated">构建复杂的数据对象需要更深入的数据库专业知识</li></ul><p id="a807" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">解决办法很简单</p><blockquote class="mi"><p id="27bb" class="mj mk hi bd ml mm mn mo mp mq mr jc dx translated">他们需要一个数据工程团队</p></blockquote><h1 id="f884" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp ms jr js jt mt jv jw jx mu jz ka kb bi translated">涨落</h1><p id="0f0b" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">该公司现在有一个数据工程团队，他们对正在使用的一些数据库有着丰富的知识。一开始，团队可能能够解决一些与当前ETL管道的性能和稳定性相关的问题。这种情况发生后，组织中就会出现积极的趋势。这一趋势基于以下事实:</p><ol class=""><li id="24d0" class="ls lt hi ih b ii ij im in iq lu iu lv iy lw jc mv ly lz ma bi translated">有(终于有了！)拥有不同数据库技术的广泛知识的团队</li><li id="1b3f" class="ls lt hi ih b ii mb im mc iq md iu me iy mf jc mv ly lz ma bi translated">有一个团队知道几个系统的细微差别，因为他们需要知道他们的本体</li><li id="9247" class="ls lt hi ih b ii mb im mc iq md iu me iy mf jc mv ly lz ma bi translated">数据收集过程工作正常</li><li id="d322" class="ls lt hi ih b ii mb im mc iq md iu me iy mf jc mv ly lz ma bi translated">工程团队可以专注于构建特性，因为数据组件已经被处理好了</li></ol><p id="dba0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据工程团队完成了许多人认为不可能完成的任务</p><blockquote class="mi"><p id="6532" class="mj mk hi bd ml mm mn mo mp mq mr jc dx translated"><strong class="ak">他们让数据产品再次变得伟大</strong></p></blockquote><figure class="mw mx my mz na lh"><div class="bz dy l di"><div class="nb nc l"/></div><figcaption class="lo lp et er es lq lr bd b be z dx translated">拥有一家数据驱动型公司的快乐— <a class="ae jd" href="https://giphy.com/gifs/borat-great-success-a0h7sAqON67nO" rel="noopener ugc nofollow" target="_blank">来源</a></figcaption></figure><p id="a7ef" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有了这种对数据的积极乐观的新感觉，产品和工程团队开始规划新功能。这些新特性带来了产品的重要变化，以支持可用的新用例和新指标。数据工程团队的积压工作开始变得挤满了新的问题，以支持新的功能和业务中的其他领域，例如面向客户的团队。这导致了与工程团队的一系列会议，讨论数据模型中的变化，以及它们如何影响当前的ETL管道。由于要进行多项更改，工程师们突然意识到更改数据管道Dag的复杂性非同小可。使当前的数据产品保持最新并不像人们最初认为的那样简单。</p><p id="9d36" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因为没有人愿意呆在一个不断修补破损数据管道的地方，所以后果很简单:新功能的发布速度不会像产品和其他业务部门计划的那样快。这导致了沮丧、摩擦和一种普遍的感觉..</p><blockquote class="mi"><p id="9c0d" class="mj mk hi bd ml mm mn mo mp mq mr jc dx translated"><strong class="ak">“数据让我们慢了下来”</strong></p></blockquote><p id="a465" class="pw-post-body-paragraph if ig hi ih b ii nd ik il im ne io ip iq nf is it iu ng iw ix iy nh ja jb jc hb bi translated">事实是，他们都是对的。</p><h1 id="41ca" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">为什么数据断了又慢？</h1><p id="4032" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">关于数据损坏和速度慢的问题并不新鲜。每个从事或曾经从事数据系统工作的人都知道这一点。</p><p id="df60" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我认为问题的根源与技术经验无关，而是看数据的心态。自从ETL成为标准，数据团队就负责维护它们并确保它们正常工作。数据团队大部分是具有数据库专业知识的团队(所谓的DBA)</p><p id="26c5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">产品和工程团队不认为数据是一等公民，因为数据团队的存在就是为了“处理数据”。对于构建特性的团队来说，担心谁需要他们生成的数据是没有意义的。很长一段时间以来，这一直是该行业的标准(我认为是从70年代开始)。然而，让我问你以下问题</p><blockquote class="mi"><p id="f1fa" class="mj mk hi bd ml mm mn mo mp mq mr jc dx translated">“如果数据是公司最宝贵的资产，那么只有一个团队负责数据有意义吗？”</p></blockquote><p id="5f84" class="pw-post-body-paragraph if ig hi ih b ii nd ik il im ne io ip iq nf is it iu ng iw ix iy nh ja jb jc hb bi translated">答案当然是<strong class="ih hj">没有</strong>。然而，大多数公司处理数据的方式仍然是一样的，这是我称之为ETL偏差的结果。这意味着有一个团队(数据工程)必须:</p><ul class=""><li id="329d" class="ls lt hi ih b ii ij im in iq lu iu lv iy lw jc lx ly lz ma bi translated">从所有操作系统中提取数据</li><li id="c64a" class="ls lt hi ih b ii mb im mc iq md iu me iy mf jc lx ly lz ma bi translated">了解公司中的所有数据库模式</li><li id="4e24" class="ls lt hi ih b ii mb im mc iq md iu me iy mf jc lx ly lz ma bi translated">为报告构建所有数据模型</li></ul><p id="0ab0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">而其他工程团队必须:</p><ul class=""><li id="b462" class="ls lt hi ih b ii ij im in iq lu iu lv iy lw jc lx ly lz ma bi translated">为产品构建功能</li><li id="3b28" class="ls lt hi ih b ii mb im mc iq md iu me iy mf jc lx ly lz ma bi translated">不要担心“数据资料”，以免减缓产品开发</li></ul><p id="ec16" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了让公司获得成功，并利用数据获得优势，他们需要改变思维模式。近年来，敏捷和DevOps改变了软件构建的方式。如果我们回顾这两次运动背后的原因，就会发现它们解决了同一个问题:某种东西从根本上拖慢了公司的发展。当时的it软件和处理基础设施。今天是数据。</p><p id="e816" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本系列的第二部分，我们将讨论我认为R&amp;D团队应该如何处理数据，因为众所周知，数据是21世纪现代互联网公司最重要的资产。现在是开始这样对待它的时候了。</p></div></div>    
</body>
</html>