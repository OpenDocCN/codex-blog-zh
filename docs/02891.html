<html>
<head>
<title>Avoid these bad practices when you are an Angular developer</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">当你是一个有角度的开发者时，避免这些不好的实践</h1>
<blockquote>原文：<a href="https://medium.com/codex/avoid-these-bad-practices-when-you-are-an-angular-developer-135323db74c7?source=collection_archive---------1-----------------------#2021-08-10">https://medium.com/codex/avoid-these-bad-practices-when-you-are-an-angular-developer-135323db74c7?source=collection_archive---------1-----------------------#2021-08-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/c59e045f2e2213a156c6d2dd92ef699e.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*FZDQJ7ZMtUuIDVhQR0mXsw.png"/></div></figure><p id="3944" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">自从第一次出现以来，Angular带来了一整套新功能，使web开发人员的生活更加轻松，也降低了创建应用程序的成本。在这些特性中，该框架具有基于MVC的更清晰的体系结构、由ivy项目加强的高速和优化的性能、类型脚本兼容性、集成的路由系统和有效的数据绑定方式等。…</p><p id="5146" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">由于这些因素，Angular在web应用程序领域获得了巨大的优势，因为许多企业和团队都在他们的项目中采用它。但是就像任何强大的工具一样，如果使用不当，它会给使用者带来一些伤害。因此，在本文中，我们将强调开发人员所犯的常见错误，并提出解决方案来纠正这些错误。</p><h2 id="b389" class="jk jl hi bd jm jn jo jp jq jr js jt ju ix jv jw jx jb jy jz ka jf kb kc kd ke bi translated"><strong class="ak">你应该了解你正在使用的工具</strong></h2><p id="684c" class="pw-post-body-paragraph im in hi io b ip kf ir is it kg iv iw ix kh iz ja jb ki jd je jf kj jh ji jj hb bi translated">Angular最重要的优势之一是它的架构，这使得编写干净的代码比开发人员前些年编写的经典JQuery spaghettis代码容易得多。</p><p id="508e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这种架构有一组构建模块，如服务(帮助我们组织业务逻辑，如数据操作、与外部API的交互)和组件(显示应用程序的数据并捕获用户交互)、管道、指令等</p><p id="87f2" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">Angular应用程序上最常见的不良实践与违反关注点分离原则有关，这可能是由于缺乏框架知识或忽视干净的代码或急于尽快交付项目。有很多例子可以说明这种不好的做法，但是我们举了一个简单的例子来说明它</p><p id="2078" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">在组件内部编写外部系统交互</strong></p><p id="d6ba" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">最好在服务中编写外部API调用和数据操作，因为它就是为此而设计的。让我们看看下面的代码</p><figure class="kk kl km kn fd ij"><div class="bz dy l di"><div class="ko kp l"/></div></figure><p id="622f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这段代码有两个主要缺陷:</p><ul class=""><li id="a69b" class="kq kr hi io b ip iq it iu ix ks jb kt jf ku jj kv kw kx ky bi translated">我们用一些不应该存在的业务逻辑污染了构造函数。一般来说，构造函数应该只包含初始化。</li><li id="3cf7" class="kq kr hi io b ip kz it la ix lb jb lc jf ld jj kv kw kx ky bi translated">我们在组件中编写了连接到Github API的代码，这是放置这种代码的一个不好的地方。在我们的例子中，我们只是简单地调用了一个URL，而没有为准备请求做太多的工作，但是一旦我们想要创建一个更复杂的请求，问题就会更加突出。组件应该处理用户交互并显示数据，而不携带请求本身(端点、头等)。其次，通过这样的实践，我们降低了其他组件对该代码的可重用性，这些组件必须重新创建连接到API的逻辑。</li></ul><p id="c83e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">所以这样的组件应该被重构为这样:</p><figure class="kk kl km kn fd ij"><div class="bz dy l di"><div class="ko kp l"/></div></figure><p id="a859" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们创建了一个名为Repository的类，它将包含API返回的JSON的序列化(我们将在本文后面讨论typescript)，然后我们将API交互移动到一个特定的服务中，之后我们从我们的组件中调用它。</p><figure class="kk kl km kn fd ij"><div class="bz dy l di"><div class="ko kp l"/></div></figure><figure class="kk kl km kn fd ij"><div class="bz dy l di"><div class="ko kp l"/></div></figure><p id="ce16" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">误用或不使用某些角度特征</strong></p><p id="aacc" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">如前所述，Angular ecosystem有许多组件可以帮助开发人员，但其中许多根本没有被开发人员使用或误用。最常见的不良使用实践主要涉及指令和管道。</p><p id="2a77" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">指令:</strong>是简单的类，用新的功能扩展HTML元素，并对它们应用定制代码(<a class="ae le" href="https://angular.io/guide/built-in-directives" rel="noopener ugc nofollow" target="_blank">文档</a>)。</p><p id="ee5e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在许多情况下，开发人员倾向于编写无用的指令，可以用简单的CSS选择器来代替，尤其是样式丰富的选择器。</p><p id="d5b9" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在其他情况下，我们看到一些指令具有复杂的逻辑来检索和操作数据，这违背了它们呈现数据的目的(以简单或复杂的方式)。因此，我们需要将这样的逻辑分离成单独的服务。</p><p id="c2a8" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">管道:</strong>它们<strong class="io hj"> </strong>被定义为将输入转换为所需格式的函数，它们直接应用于模板。让我们看看下面的代码，用户必须输入一个以字节为单位的文件大小，然后我们的程序将它转换成一个以兆字节为单位的更可读的人类格式</p><figure class="kk kl km kn fd ij"><div class="bz dy l di"><div class="ko kp l"/></div></figure><p id="f43d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这段代码的主要问题是，如果我们想在任何其他组件中重用文件大小格式化的逻辑，那么我们必须复制它，或者我们可以在一个单独的函数中提取它，但幸运的是，有更好的方法来使用管道重构这段代码:)</p><p id="00af" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">首先，我们必须创建我们的管道</p><figure class="kk kl km kn fd ij"><div class="bz dy l di"><div class="ko kp l"/></div></figure><p id="5eef" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">然后我们可以在我们想要格式化文件大小的任何地方调用组件内部的管道。</p><figure class="kk kl km kn fd ij"><div class="bz dy l di"><div class="ko kp l"/></div></figure><p id="3097" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们可以通过允许每个调用者指定大小单位(GB、TB等)来增强我们的管道，但我们只是使用示例来演示如何使用管道来重构我们的代码，而无需输入管道细节。</p><h1 id="85f3" class="lf jl hi bd jm lg lh li jq lj lk ll ju lm ln lo jx lp lq lr ka ls lt lu kd lv bi translated"><strong class="ak">别忘了退订</strong></h1><p id="a98c" class="pw-post-body-paragraph im in hi io b ip kf ir is it kg iv iw ix kh iz ja jb ki jd je jf kj jh ji jj hb bi translated">在Angular应用程序中，我们总是需要连接服务来获取数据。但是如果这些订阅管理不善，它们会导致内存泄漏。让我们以一个简单的应用程序为例，该应用程序包含一个定期推送值的服务，以及一个订阅该服务并在控制台上记录该值的组件:</p><figure class="kk kl km kn fd ij"><div class="bz dy l di"><div class="ko kp l"/></div></figure><figure class="kk kl km kn fd ij"><div class="bz dy l di"><div class="ko kp l"/></div></figure><p id="4d8f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这段代码似乎没什么问题！我们可以看到控制台上显示的发射值。</p><p id="f289" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">惊喜！！当我们导航到另一个组件时，我们可以在控制台上看到订阅仍处于活动状态并发出值，当我们再次返回时，一个新的订阅与旧的订阅一起创建，这在给定的时刻会导致内存泄漏问题。</p><p id="ee64" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">所以，当你使用完Observable后，请不要忘记退订。有许多方法可以做到:</p><ul class=""><li id="67d4" class="kq kr hi io b ip iq it iu ix ks jb kt jf ku jj kv kw kx ky bi translated">通过手动调用unsubscribe()函数。</li><li id="d61d" class="kq kr hi io b ip kz it la ix lb jb lc jf ld jj kv kw kx ky bi translated">使用takeWhile()运算符[ <a class="ae le" href="https://www.learnrxjs.io/learn-rxjs/operators/filtering/takewhile" rel="noopener ugc nofollow" target="_blank"> Documentation </a> ]。</li><li id="9e9f" class="kq kr hi io b ip kz it la ix lb jb lc jf ld jj kv kw kx ky bi translated">-或者使用我个人在管理这些行为时使用的takeUntil()操作符[ <a class="ae le" href="https://www.learnrxjs.io/learn-rxjs/operators/filtering/takeuntil" rel="noopener ugc nofollow" target="_blank">文档</a></li></ul><h1 id="8b4f" class="lf jl hi bd jm lg lh li jq lj lk ll ju lm ln lo jx lp lq lr ka ls lt lu kd lv bi translated"><strong class="ak">摇一摇你的代码</strong></h1><p id="dfd0" class="pw-post-body-paragraph im in hi io b ip kf ir is it kg iv iw ix kh iz ja jb ki jd je jf kj jh ji jj hb bi translated">angular team自其第9版以来提供的最重要的优势之一是<strong class="io hj"> ivy </strong>，它允许提供更小的包，这意味着加载应用程序的时间更少，并且它促进了调试和测试。</p><figure class="kk kl km kn fd ij er es paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="er es lw"><img src="../Images/a506ab17512d8eee2aa2d1651ab4c3ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fj8620J1-rthqFdY9OLIdA.png"/></div></div><figcaption class="mb mc et er es md me bd b be z dx translated">图片来自Angular.io博客</figcaption></figure><p id="9478" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">从版本12开始，Ivy甚至是渲染angular应用程序的唯一选项，但是如果它是基于Angular 9或更高版本，您可以通过遵循官方的<a class="ae le" href="https://angular.io/guide/ivy" rel="noopener ugc nofollow" target="_blank">文档</a>在您的应用程序中实现这样的特性</p><p id="4050" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">【typescript怎么样？</p><p id="ff22" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">typescript最重要的优势之一是使代码更清晰、更易于阅读和维护，因为它将OOP的强大功能引入了前端世界。</p><p id="3aa3" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">许多开发人员发现键入数据和编写接口代码是一项耗时的任务，因此他们通常使用神奇的<strong class="io hj"> any </strong>关键字，这在许多情况下会产生早期开发阶段无法发现的异常。我们可以以下面的代码为例</p><figure class="kk kl km kn fd ij"><div class="bz dy l di"><div class="ko kp l"/></div></figure><p id="9354" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这段代码编译正确，但是当我们试图运行它时，控制台<strong class="io hj"> </strong>上显示了一个<strong class="io hj">未定义的</strong>，因为传递给参数的用户变量没有名为identifier的属性。但是如果我们用用户类型改变any关键字，我们将得到一个编译错误，这样我们可以更早地识别问题，然后我们将在运行时有更少的未定义。</p><p id="23f7" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">遗言</strong></p><p id="e48a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在本文中，我们快速浏览了Angular上一些常见的不良做法。如果你在你的团队中发现了其他人来丰富上面的列表，请告诉我们。</p><p id="b0cd" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">感谢阅读，</p><p id="87e9" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">法迪</p></div></div>    
</body>
</html>