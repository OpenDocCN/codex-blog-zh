<html>
<head>
<title>Picking Stocks with a Quantitative Momentum Strategy in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python中的量化动量策略选股</h1>
<blockquote>原文：<a href="https://medium.com/codex/picking-stocks-with-a-quantitative-momentum-strategy-in-python-b15ac8925ec6?source=collection_archive---------0-----------------------#2021-04-23">https://medium.com/codex/picking-stocks-with-a-quantitative-momentum-strategy-in-python-b15ac8925ec6?source=collection_archive---------0-----------------------#2021-04-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="f655" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">一个简单而有用的方法来优化选择股票的过程</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/83aa3e8c4faaa13871b543788b37409a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*j4sTPuFpeVPSHmT2"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated"><a class="ae jn" href="https://unsplash.com/@gillyberlin?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">吉利</a>在<a class="ae jn" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="7e22" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">免责声明:</strong>本文严格出于教育目的，不应作为投资提示。</p><h1 id="7ae6" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">介绍</h1><p id="3b83" class="pw-post-body-paragraph jo jp hi jq b jr lc ij jt ju ld im jw jx le jz ka kb lf kd ke kf lg kh ki kj hb bi translated">当我还是一个业余交易者时，选择合适的股票进行交易的过程是一场噩梦。关于股票、不确定性和情绪的消息增加了这一过程的痛苦。遥遥领先，今天，我用我最好的伙伴Python找到了自己的解决方案。在本文中，我们将使用python构建一个简单的量化动量策略，该策略可以过滤并挑选出最佳的盘中股票。但是等等，什么是量化动量策略？</p><p id="595b" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">量化动量策略是一种选择价格涨幅最大的股票的策略。简单来说就是识别涨势很大的股票的过程。现在我们已经对什么是量化动量策略以及如何用它来选股有了一些了解。让我们用python实现策略吧！</p><h1 id="b37c" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">Python实现</h1><p id="aebf" class="pw-post-body-paragraph jo jp hi jq b jr lc ij jt ju ld im jw jx le jz ka kb lf kd ke kf lg kh ki kj hb bi translated">本文涉及的步骤有:</p><pre class="iy iz ja jb fd lh li lj lk aw ll bi"><span id="ec59" class="lm kl hi li b fi ln lo l lp lq"><strong class="li hj">- Importing the required packages</strong></span><span id="04dd" class="lm kl hi li b fi lr lo l lp lq"><strong class="li hj">- Extracting the list of all S&amp;P 500 stock's symbols</strong></span><span id="ab09" class="lm kl hi li b fi lr lo l lp lq"><strong class="li hj">- Pulling Intraday data of all the stocks in the S&amp;P 500</strong></span><span id="f445" class="lm kl hi li b fi lr lo l lp lq"><strong class="li hj">- Calculating percentage change and momentum of all stocks</strong></span><span id="870b" class="lm kl hi li b fi lr lo l lp lq"><strong class="li hj">- Finding stocks with greater momentum</strong></span><span id="f305" class="lm kl hi li b fi lr lo l lp lq"><strong class="li hj">- Backtesting with a equal-weight portfolio</strong></span></pre><h2 id="c2ee" class="lm kl hi bd km ls lt lu kq lv lw lx ku jx ly lz kw kb ma mb ky kf mc md la me bi translated">步骤1:导入包</h2><p id="d697" class="pw-post-body-paragraph jo jp hi jq b jr lc ij jt ju ld im jw jx le jz ka kb lf kd ke kf lg kh ki kj hb bi translated">本文的主要包是处理数据的Pandas包、处理数组的NumPy包和使用API提取数据的Requests包。二级包是数学函数的Math包、复杂函数的SciPy包和统计函数的Statistics包。</p><p id="9f0a" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj"> Python实现:</strong></p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mf mg l"/></div></figure><p id="9c5f" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">既然我们已经将所有需要的包导入到python环境中。让我们开始提取所有标准普尔500股票的符号列表。</p><h2 id="682d" class="lm kl hi bd km ls lt lu kq lv lw lx ku jx ly lz kw kb ma mb ky kf mc md la me bi translated">第二步:提取所有标准普尔500股票的符号列表</h2><p id="e508" class="pw-post-body-paragraph jo jp hi jq b jr lc ij jt ju ld im jw jx le jz ka kb lf kd ke kf lg kh ki kj hb bi translated">我看到过构建复杂的web抓取功能来完成这个特定任务的教程。但是，这不是我们要遵循的方式，我们的代码将会更加简单和高效。</p><p id="77fe" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj"> Python实现:</strong></p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mf mg l"/></div></figure><p id="eeaa" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">输出:</strong></p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mh"><img src="../Images/4c0ee5e2759a67ea83bc394062d1ee39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mkqdS2IdYCUElnYqAPGQLQ.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">作者图片</figcaption></figure><p id="173d" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">代码解释:</strong>正如我之前所说，我们不会使代码复杂化，也不会使用任何网络抓取技术来提取标准普尔500指数中股票的符号，但是，我们使用了Pandas软件包提供的一个名为“read_html”的高效函数。这个函数将在给定的URL中搜索表，并以列表格式返回数据。回到我们的代码，我们首先使用“read_html”函数提取S &amp; P 500中股票的符号，并将其存储到“sp500”变量中。然后我们定义了一个变量‘sp 500 _ list’来将提取的数据存储到一个NumPy数组中。现在我们已经收集了所有标准普尔500股票的符号。我们来拉一些日内数据！</p><h2 id="75dd" class="lm kl hi bd km ls lt lu kq lv lw lx ku jx ly lz kw kb ma mb ky kf mc md la me bi translated">步骤3:使用IEX云API提取当天数据</h2><p id="cf2b" class="pw-post-body-paragraph jo jp hi jq b jr lc ij jt ju ld im jw jx le jz ka kb lf kd ke kf lg kh ki kj hb bi translated">在这一步中，我们将使用IEX云API提取所有标准普尔500股票的当天数据。如果你不知道如何使用IEX云API提取股票数据，我建议你在这里<a class="ae jn" rel="noopener" href="/codex/pulling-stock-data-from-iex-cloud-with-python-d44f63bb82e0#38d0">阅读我的文章</a>。</p><p id="0202" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj"> Python实现:</strong></p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mf mg l"/></div></figure><p id="6417" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">输出:</strong></p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mi"><img src="../Images/4a763277bb7ea949977294c1f323371f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T0u3blzhUUKgh9KJ6JwlAQ.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">作者图片</figcaption></figure><p id="d12d" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">代码解释:</strong>这段代码可以分为三个部分:定义一个拉取日内数据的函数，使用定义的函数拉取S &amp; P 500中所有股票的日内数据，保存并导入提取的数据。</p><p id="cafd" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">第一部分包括从第1行到第36行的代码。在第一部分中，我们首先定义一个名为“get_intraday_prices”的函数，它以股票的符号作为参数。在函数内部，我们首先定义两个变量来存储API键和URL。使用Requests包提供的“get”函数，我们以JSON格式提取当天数据。在做了一些数据处理和操作之后，我们以熊猫数据帧的形式返回数据。</p><p id="21d8" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">第二部分包括从第38行到第44行的代码。在这一部分中，我们迭代股票的符号来提取每只股票的当天数据。我们将每只股票的当天数据存储到“df”变量中。</p><p id="278a" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">第三部分包括从第46行到第48行的代码。这一部分的主要目标是保存和导入提取的所有股票的日内数据。这一步是可选的，但是强烈建议您这样做，因为当您重新打开脚本时，您可以节省运行迭代过程的时间。我们首先使用Pandas软件包提供的“to_csv”功能将提取的日内数据保存在“sp500”的名称中。然后，在“read_csv”功能的帮助下，我们导入保存的数据帧。</p><h2 id="1b75" class="lm kl hi bd km ls lt lu kq lv lw lx ku jx ly lz kw kb ma mb ky kf mc md la me bi translated">步骤4:计算百分比变化和动量</h2><p id="41e8" class="pw-post-body-paragraph jo jp hi jq b jr lc ij jt ju ld im jw jx le jz ka kb lf kd ke kf lg kh ki kj hb bi translated">在这一步，我们将计算每只股票的日变化和动量。</p><p id="be5e" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj"> Python实现:</strong></p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mf mg l"/></div></figure><p id="812e" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">输出:</strong></p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mj"><img src="../Images/7443c6825315a7168e6788f05b9eedfd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1378/format:webp/1*jSf-GaGjyrvO6oorexxjOg.png"/></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">作者图片</figcaption></figure><p id="e100" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">代码解释:</strong>首先，我们创建一个名为‘PC’的空列表来存储每只股票的百分比变化。利用for循环，我们遍历标准普尔500指数中所有股票的符号，并使用Pandas软件包提供的“pct_change”函数将计算出的百分比变化附加到“dc”列表中。然后，我们创建一个名为“sp500_momentum”的数据框架来存储股票的符号、百分比变化以及我们将要计算的动量。</p><p id="7174" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">回到计算动量的代码，我们首先在“sp500_momentum”数据帧中创建一个名为“momentum”的列，并用空值填充它。然后我们传递一个for循环，用实际的动量值填充空值。</p><h2 id="552f" class="lm kl hi bd km ls lt lu kq lv lw lx ku jx ly lz kw kb ma mb ky kf mc md la me bi translated">第五步:寻找更有动力的股票</h2><p id="2132" class="pw-post-body-paragraph jo jp hi jq b jr lc ij jt ju ld im jw jx le jz ka kb lf kd ke kf lg kh ki kj hb bi translated">在这一步中，我们将根据我们计算的动量值对股票进行排序，并找出动量最高的前10只股票。</p><p id="a8e4" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj"> Python实现:</strong></p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mf mg l"/></div></figure><p id="5a64" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">输出:</strong></p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mk"><img src="../Images/d23ba358c957a66f3fd3796c5357232d.png" data-original-src="https://miro.medium.com/v2/resize:fit:230/format:webp/1*6cW6NjD7MXZgEF27_fhdrw.png"/></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">作者图片</figcaption></figure><p id="1592" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">代码解释:</strong>我一直遵循保持代码简单高效的原则。我也在这里做过。我们首先创建一个名为“top_picks”的数据框架，其中存储了前10只动量较大的股票。为了对前10只股票进行排序和查找，我们使用了Pandas软件包提供的‘nlargest’函数。</p><h2 id="0cec" class="lm kl hi bd km ls lt lu kq lv lw lx ku jx ly lz kw kb ma mb ky kf mc md la me bi translated">步骤6:回溯测试</h2><p id="e5d3" class="pw-post-body-paragraph jo jp hi jq b jr lc ij jt ju ld im jw jx le jz ka kb lf kd ke kf lg kh ki kj hb bi translated">在这一步中，我们将通过在动量最高的前10只股票中投资等量的资金来进行回溯测试，让我们看看结果。</p><p id="bc80" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj"> Python实现:</strong></p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mf mg l"/></div></figure><p id="d374" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">输出:</strong></p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ml"><img src="../Images/27f55a8e24faf322da625f84de161201.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oGH1Y_cVMTIT8aANwV149g.png"/></div></div></figure><p id="c323" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">代码解释:</strong>首先，我们定义两个变量分别存储总投资价值和每股投资价值。接下来，我们将传递一个for循环来查找所有前10名股票的当天收盘价，并将这些值附加到“day_close”变量中。在接下来的几行代码中，我们创建了一个名为“backtest_df”的数据框架，其中包括计算出的每只股票的买入数量、我们投资前10只股票的回报率，以及我们投资的回报率。如你所见，我们得到了不错的回报。就是这样！</p><h1 id="b4c9" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">最后的想法！</h1><p id="81ec" class="pw-post-body-paragraph jo jp hi jq b jr lc ij jt ju ld im jw jx le jz ka kb lf kd ke kf lg kh ki kj hb bi translated">在本文中，我们学习了如何实施简单的量化动量策略来挑选可交易的股票。您可以从两个方面改进这篇文章:</p><ul class=""><li id="42d6" class="mm mn hi jq b jr js ju jv jx mo kb mp kf mq kj mr ms mt mu bi translated"><strong class="jq hj">挑选股票进行长期投资:</strong>在这篇文章中，我们挑选股票进行日内交易，但是，你也可以实施挑选长期可投资股票的策略。通过这样做，你将学会如何相应地调整定量动量策略，并使用几个指标来构建策略。</li><li id="01d3" class="mm mn hi jq b jr mv ju mw jx mx kb my kf mz kj mr ms mt mu bi translated">更多股票:本文仅基于标准普尔500指数(S &amp;中列出的股票，但你也可以考虑在更多交易所上市的股票。执行此任务的优点是，在给定提取的数据量的情况下，您将能够进行大规模的研究，并且您可以掌握使用stocks APIs和数据处理提取数据的艺术，因为此任务需要大量的数据。</li></ul><p id="63f8" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">就是这样！您已到达这篇文章的结尾。此外，如果您忘记了遵循任何编码部分，不要担心！我在最后提供了完整的源代码。希望你能在这篇文章中找到有用的东西。如果你有任何改进这篇文章的建议，请留下你的评论。</p><h2 id="db02" class="lm kl hi bd km ls lt lu kq lv lw lx ku jx ly lz kw kb ma mb ky kf mc md la me bi translated"><strong class="ak">完整代码:</strong></h2><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mf mg l"/></div></figure></div></div>    
</body>
</html>