<html>
<head>
<title>Migrating a Legacy App to Cloud Native — Part 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将传统应用迁移到云原生环境—第1部分</h1>
<blockquote>原文：<a href="https://medium.com/codex/migrating-a-legacy-app-to-cloud-native-part-1-68a1adbb95d5?source=collection_archive---------6-----------------------#2020-04-11">https://medium.com/codex/migrating-a-legacy-app-to-cloud-native-part-1-68a1adbb95d5?source=collection_archive---------6-----------------------#2020-04-11</a></blockquote><div><div class="dt gx gy gz ha hb"/><div class="hc hd he hf hg"><div class=""/><figure class="ew ey ih ii ij ik es et paragraph-image"><div role="button" tabindex="0" class="il im di in bf io"><div class="es et ig"><img src="../Images/497dc7a58156a81d72319097997ed13d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ZPxDaX2-WRzDQbB4"/></div></div><figcaption class="ir is eu es et it iu bd b be z dy translated">雅利安·辛格在<a class="ae iv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="361f" class="pw-post-body-paragraph iw ix hj iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hc bi translated">在八个月的时间里，我进行了一次旅行。您可能会说我的应用程序是一次旅程，但对我来说，这也是一次通过一些新的开发工具学习和奋斗的旅程。一路上，我记录了这段旅程，与你分享。这篇文章是分享这一旅程的八篇文章之一。自始至终，我都努力做到公平和诚实；尊重这些工具和服务的作者，也尊重我的读者…</p></div><div class="ab cl ju jv gq jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="hc hd he hf hg"><p id="ad26" class="pw-post-body-paragraph iw ix hj iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hc bi translated">在这篇文章中，我开始探索如何将我的<a class="ae iv" href="https://sqac.fanello.net" rel="noopener ugc nofollow" target="_blank"> SqAC </a>应用迁移为AWS云原生应用。在宣布我打算采用的方法之前，我给出了一些关于当前应用程序架构的背景，考虑了lift &amp; shift和无服务器迁移方法。本系列的下一部分将介绍并讨论新的架构。</p><h1 id="fd83" class="kb kc hj bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">背景</h1><p id="f601" class="pw-post-body-paragraph iw ix hj iy b iz kz jb jc jd la jf jg jh lb jj jk jl lc jn jo jp ld jr js jt hc bi translated">耐心听我说，或者浏览下一部分。)</p><p id="e4ca" class="pw-post-body-paragraph iw ix hj iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hc bi translated">2015年开始学习成为广场舞呼叫器。🎤🕺🏻方块舞是一种有趣的爱好和社交活动，我已经准备好迎接新的挑战。当我学会如何调用一个舞蹈时，我一直在想“我可以写一个应用程序来帮助我。”🤔</p><p id="53c8" class="pw-post-body-paragraph iw ix hj iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hc bi translated">作为一名软件工程师，我发现我的职业正在从编写Java后端应用程序转向编写全栈web应用程序。在我的知识中有一些空白来完成这个跳跃。</p><p id="61f2" class="pw-post-body-paragraph iw ix hj iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hc bi translated">因此，在2016年，一个目的的融合诞生了。我会为跳广场舞的人编写这个利基应用程序，并利用它将我的编程经验扩展到新的领域。🎉这将比另一个待办事项应用有趣得多😴正如许多其他人在想玩新技术时所写的那样。</p><p id="704e" class="pw-post-body-paragraph iw ix hj iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hc bi translated">我开始玩<a class="ae iv" href="https://dart.dev/" rel="noopener ugc nofollow" target="_blank"> Dart 1.0 </a>，它看起来很酷，但也很不成熟。我试过<a class="ae iv" href="https://ionicframework.com/" rel="noopener ugc nofollow" target="_blank"> Ionic 2 </a>，但是遇到了可用性的麻烦；一个框架<em class="le">在另一个框架</em>之上，这个框架很复杂，当时的文档也很糟糕。所以我向下一层到底层框架，<a class="ae iv" href="https://angular.io/" rel="noopener ugc nofollow" target="_blank"> Angular 2 </a>。<a class="ae iv" href="https://material.io/" rel="noopener ugc nofollow" target="_blank">材质设计</a>存在，但是它的Angular库仍在构建中，缺少关键组件，所以我选择了当时仍然流行的<a class="ae iv" href="https://getbootstrap.com/docs/3.3/" rel="noopener ugc nofollow" target="_blank"> Bootstrap 3 </a>。</p><p id="4988" class="pw-post-body-paragraph iw ix hj iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hc bi translated">该应用程序需要一个简单的后端来验证用户，保存他们的数据，并允许可选的共享。我的早期原型是用Dart编写的，但最终我决定使用<a class="ae iv" href="https://www.typescriptlang.org/" rel="noopener ugc nofollow" target="_blank"> Typescript </a>作为后端来与有角度的前端配对。一点探索把我带到了<a class="ae iv" href="https://feathersjs.com/" rel="noopener ugc nofollow" target="_blank">features</a>，一个结合了<a class="ae iv" href="https://expressjs.com/" rel="noopener ugc nofollow" target="_blank"> Express.js </a> web服务器和<a class="ae iv" href="http://www.passportjs.org/" rel="noopener ugc nofollow" target="_blank"> Passport </a>用于用户认证的框架。我把它放在一个<a class="ae iv" href="https://www.digitalocean.com/products/droplets/" rel="noopener ugc nofollow" target="_blank">数字海洋水滴</a>服务器上，这基本上是一个带有持久文件系统的小型虚拟机实例。</p><p id="43aa" class="pw-post-body-paragraph iw ix hj iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hc bi translated">我想提供一个漂亮的图表来展示现有的架构…但这就是全部了:</p><figure class="lg lh li lj fe ik es et paragraph-image"><div class="es et lf"><img src="../Images/a147a7bb1777ce76613bd4d5513b4f41.png" data-original-src="https://miro.medium.com/v2/resize:fit:444/format:webp/0*9R6o9pC2WYEcqVrX.png"/></div></figure><p id="6792" class="pw-post-body-paragraph iw ix hj iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hc bi translated">此外，由于这是一台服务器，因此还有一个自述文件解释如何配置服务器，包括:</p><ul class=""><li id="660c" class="lk ll hj iy b iz ja jd je jh lm jl ln jp lo jt lp lq lr ls bi translated">自动运行定制的Feathers服务器。(记住，是Express.js)</li><li id="b599" class="lk ll hj iy b iz lt jd lu jh lv jl lw jp lx jt lp lq lr ls bi translated">使用SSL设置Nginx代理到Feathers服务器，</li><li id="89f3" class="lk ll hj iy b iz lt jd lu jh lv jl lw jp lx jt lp lq lr ls bi translated">让我们加密 SSL证书。</li><li id="0c70" class="lk ll hj iy b iz lt jd lu jh lv jl lw jp lx jt lp lq lr ls bi translated">将用户数据备份到S3存储桶的Cron作业；唯一的一块AWS。</li></ul><p id="fb04" class="pw-post-body-paragraph iw ix hj iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hc bi translated">这是<em class="le">不是</em>基础设施即代码(IaC)！相反，这是一种让人害怕需要重建的设置。至少我有先见之明记录了手工过程。🤷在当时的‍♂️，这很了不起。</p><p id="7da3" class="pw-post-body-paragraph iw ix hj iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hc bi translated">两年后，该应用程序达到了功能完成，我在旅途中学到了很多关于前端开发<em class="le">和</em>广场舞编舞的知识。偶尔其他人甚至会用！</p><figure class="lg lh li lj fe ik es et paragraph-image"><div class="es et ly"><img src="../Images/87e63fe0012c8e698d328de7f9b9b911.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/0*l0HyzShghhr9zsUs.png"/></div></figure><p id="67e7" class="pw-post-body-paragraph iw ix hj iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hc bi translated">大约在完成的同时，我成为了一名认证的AWS解决方案架构师。我仍然在用Angular做网络应用，但是后端……云……天啊！我现在可以做得更好。</p><p id="d8dd" class="pw-post-body-paragraph iw ix hj iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hc bi translated">舞台已经搭建好了。我有一个现有的应用程序，想把它转移到AWS。这是典型的云迁移，尽管规模很小。我有什么选择？</p><h1 id="6a9b" class="kb kc hj bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">提升和移位</h1><p id="5de5" class="pw-post-body-paragraph iw ix hj iy b iz kz jb jc jd la jf jg jh lb jj jk jl lc jn jo jp ld jr js jt hc bi translated">最直接的方法是安装一个运行Ubuntu的<a class="ae iv" href="https://aws.amazon.com/lightsail/" rel="noopener ugc nofollow" target="_blank"> AWS Lightsail </a>实例，按照我的自述文件安装一个新的服务器。复制数据，重定向DNS，我就完事了。✅</p><p id="372d" class="pw-post-body-paragraph iw ix hj iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hc bi translated"><strong class="iy hk">优点</strong>:快捷方便。<br/> <strong class="iy hk">缺点</strong>:我一事无成！</p><p id="0fb0" class="pw-post-body-paragraph iw ix hj iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hc bi translated">如果我采取这种方法，我花了一天的时间，这样我就可以每月向亚马逊支付几美元，而不是每月向DigitalOcean支付几美元。没有收获。\_(ツ)_/</p><p id="3709" class="pw-post-body-paragraph iw ix hj iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hc bi translated">我还能做什么来利用AWS的<em class="le">优势</em>？</p><ul class=""><li id="f691" class="lk ll hj iy b iz ja jd je jh lm jl ln jp lo jt lp lq lr ls bi translated">将用户数据转移到S3或DynamoDB？是的，那我可以用EC2代替Lightsail。</li><li id="f75f" class="lk ll hj iy b iz lt jd lu jh lv jl lw jp lx jt lp lq lr ls bi translated">将web应用程序文件转移到S3，并通过CloudFront提供服务？确实是的！</li><li id="f8eb" class="lk ll hj iy b iz lt jd lu jh lv jl lw jp lx jt lp lq lr ls bi translated">用Lambda运行Express.js应用？现在我们越来越有趣，并适应免费层！</li><li id="d09f" class="lk ll hj iy b iz lt jd lu jh lv jl lw jp lx jt lp lq lr ls bi translated">将认证切换到Cognito？哦是的！</li></ul><p id="2278" class="pw-post-body-paragraph iw ix hj iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hc bi translated">当我们开始这样思考时，我们就离开了提升和转移的领域，进入了…</p><h1 id="e837" class="kb kc hj bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">云原生</h1><p id="7bbf" class="pw-post-body-paragraph iw ix hj iy b iz kz jb jc jd la jf jg jh lb jj jk jl lc jn jo jp ld jr js jt hc bi translated">云原生开发是指应用程序被<em class="le">设计为</em>在云中原生工作，利用托管服务。云原生和无服务器不完全一样，但两者往往是齐头并进的；理想云原生架构通常是无服务器的，不需要我的旧自述文件中的任何服务器设置工作。</p><h1 id="b453" class="kb kc hj bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">不仅仅是无服务器</h1><p id="4890" class="pw-post-body-paragraph iw ix hj iy b iz kz jb jc jd la jf jg jh lb jj jk jl lc jn jo jp ld jr js jt hc bi translated">上面提出的想法将实现无服务器。使用Cognito、Lambda、S3、DynamoDB和CloudFront可以得到一个无服务器的解决方案。我可以很容易地做到这一点，因为我已经做了很多次。这很容易，而且在这个过程中我什么也学不到。以这种方式将我的应用程序转移到AWS将比简单的电梯转移花费更多的时间，并且它将为我节省大约5美元/月(相对于数字海洋),因为我的使用将属于所有这些AWS服务的免费层。我想了大约一年，但是花的时间不值得节省这么少的钱，而且我不会学到任何东西。</p><p id="c1bb" class="pw-post-body-paragraph iw ix hj iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hc bi translated">尽管有一些新的东西冲击着主流开发。我甚至会在下个月为当地的AWS用户群做一个关于它的演示，但是我还没有用这个更新的技术栈做任何实质性的事情。因此，在上次三年后，一个目标的融合又一次诞生了。我会将我的应用程序迁移到…</p><figure class="lg lh li lj fe ik es et paragraph-image"><div role="button" tabindex="0" class="il im di in bf io"><div class="es et lz"><img src="../Images/42bde0167c53ad754eccc4c5905dc0ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6a2yRi4htcZJg7I_"/></div></div></figure><h1 id="5e19" class="kb kc hj bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">下次来…</h1><p id="949c" class="pw-post-body-paragraph iw ix hj iy b iz kz jb jc jd la jf jg jh lb jj jk jl lc jn jo jp ld jr js jt hc bi translated">我将探索我的应用程序的需求，并使用AWS Amplify设计一个解决方案。</p><div class="ma mb fa fc mc md"><a rel="noopener follow" target="_blank" href="/@kernwig/migrating-a-legacy-app-to-cloud-native-part-2-533dfebd38fb"><div class="me ab dx"><div class="mf ab mg cl cj mh"><h2 class="bd hk fj z dz mi eb ec mj ee eg hi bi translated">将传统应用迁移到云原生环境—第2部分</h2><div class="mk l"><h3 class="bd b fj z dz mi eb ec mj ee eg dy translated">上一次(在第1部分中)，我给出了一些要迁移的应用程序的背景(Square Auto-Choreographer；SqAC)，以及为什么…</h3></div><div class="ml l"><p class="bd b fq z dz mi eb ec mj ee eg dy translated">medium.com</p></div></div><div class="mm l"><div class="mn l mo mp mq mm mr ip md"/></div></div></a></div></div></div>    
</body>
</html>