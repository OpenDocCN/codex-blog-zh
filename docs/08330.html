<html>
<head>
<title>YugabyteDB Deployment using Docker Compose file</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Docker合成文件进行YugabyteDB部署</h1>
<blockquote>原文：<a href="https://medium.com/codex/yugabytedb-local-deployment-using-docker-compose-file-69965775c416?source=collection_archive---------6-----------------------#2022-08-01">https://medium.com/codex/yugabytedb-local-deployment-using-docker-compose-file-69965775c416?source=collection_archive---------6-----------------------#2022-08-01</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="381a" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">如何使用Docker Compose文件设置YugabyteDB本地集群</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/b4e326922bbbc88db338815602c4562e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Yu2-IdC1yQgeHVeY"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">Jo Heubeck和Domi Pfenninger摄影</figcaption></figure><p id="484b" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在这篇博文中，我将向您展示如何使用Docker Compose文件部署Yugabyte本地集群。与单独提供Docker容器相比，使用Docker Compose文件进行开发速度更快，而且不会出错。在这篇博客中，我将向您展示如何加载和填充用于测试目的的样本数据。此外，您可能处于这样一种情况:您希望展示一个概念证明，而不想设置一个大型集群来构建一个简单的应用程序。如果这是您想要的，那么让我们团结起来，快速建立我们的集群。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es kk"><img src="../Images/5c9d394edf8179e108928137515c3cea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/0*wQZlGaEfE6ImdPI4"/></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">YugabyteDB集群(图片由作者提供)</figcaption></figure><p id="df14" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这对你的发展过程非常重要。有趣的是，如果您正在为您的生产环境设置一个多节点集群，建议您在云平台上设置您的数据库集群，如本页【https://docs.yugabyte.com/preview/deploy/checklist/<a class="ae jn" href="https://docs.yugabyte.com/preview/deploy/checklist/" rel="noopener ugc nofollow" target="_blank"/>所述。请参考它，了解在任何云平台上设置集群的方法。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es kl"><img src="../Images/2e579f961cfe56531aae3a09d590fd9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1058/format:webp/1*gkrsMtPK3_6FM6h0FVLl-w.png"/></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">Yugabyte节点(图片由作者提供)</figcaption></figure><p id="bf00" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">Docker容器帮助解决的问题之一是不同的环境问题，我们能够跨不同的平台移动我们的部署，我们的数据库将按预期工作。别浪费太多时间，让我们开始工作吧。在我们接触Docker命令之前，值得注意的是YugabyteDB是一个高性能、云原生的分布式SQL数据库，旨在支持所有PostgreSQL特性。它最适合云原生OLTP(即实时、关键业务)应用程序，这些应用程序需要绝对的数据正确性，并且至少需要以下一项:可伸缩性、高容错性和全球分布式部署。</p><p id="929e" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">YugabyteDB符合Cassandra API和Postgres API，这使得它非常强大。它结合并补充了NoSQL Cassandra数据库和PostgreSQL数据库的优势。为此，我使用PostgreSQL API将我的数据加载到数据库中。我使用的数据是开源的PostgreSQL DVD租赁数据库，可从<a class="ae jn" href="https://www.postgresqltutorial.com/postgresql-getting-started/postgresql-sample-database/" rel="noopener ugc nofollow" target="_blank">https://www . PostgreSQL tutorial . com/PostgreSQL-getting-started/PostgreSQL-sample-database/</a>获得。至此，让我们使用Docker容器来设置YugabyteDB。</p><ul class=""><li id="4bcb" class="km kn hi jq b jr js ju jv jx ko kb kp kf kq kj kr ks kt ku bi translated">用docker-compose文件克隆Github repo</li></ul><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="kv kw l"/></div></figure><p id="3a60" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">请注意，您可以在YAML文件中包含任意多的节点/容器，但是对于我们的例子，我们只包含了一个节点。</p><ul class=""><li id="7075" class="km kn hi jq b jr js ju jv jx ko kb kp kf kq kj kr ks kt ku bi translated">确保您的数据库可以与其他正在运行的docker容器的其他应用程序/服务网络进行通信</li></ul><p id="deaf" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这一部分对于你成功连接运行在你的网络上的YugabyteDB非常重要，你的数据库必须向你的应用程序公开，你必须能够连接数据库。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="kv kw l"/></div></figure><ul class=""><li id="9758" class="km kn hi jq b jr js ju jv jx ko kb kp kf kq kj kr ks kt ku bi translated">启动Docker容器、主节点和服务器节点</li></ul><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="kv kw l"/></div></figure><p id="7333" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">使用位于<a class="ae jn" href="http://localhost:7000/" rel="noopener ugc nofollow" target="_blank"> http://localhost:7000 </a>的yb-master管理服务页面检查并确认YugabyteDB正在运行。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es kx"><img src="../Images/65f21abd023b844f92060244512726f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*roEKpWLhB0K657A5"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">YugabyteDB管理页面(图片由作者提供)</figcaption></figure><p id="890a" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">您也可以使用Docker命令来检查这一点。</p><pre class="iy iz ja jb fd ky kz la lb aw lc bi"><span id="802f" class="ld le hi kz b fi lf lg l lh li">docker ps</span></pre><ul class=""><li id="ab0b" class="km kn hi jq b jr js ju jv jx ko kb kp kf kq kj kr ks kt ku bi translated">将样本数据复制并加载到YugabyteDB中</li></ul><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="kv kw l"/></div></figure><ul class=""><li id="0ca7" class="km kn hi jq b jr js ju jv jx ko kb kp kf kq kj kr ks kt ku bi translated">连接到PostgreSQL API，并将数据加载到数据库中</li></ul><p id="7b0e" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">默认情况下，YCQL API和YSQL API在集群上是启用的。下面的命令将进入Postgre数据库Docker容器，创建一个新的Postgres数据库，创建有权限的表，设置凭证，并用必要的数据行加载表。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="kv kw l"/></div></figure><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="kv kw l"/></div></figure><ul class=""><li id="d486" class="km kn hi jq b jr js ju jv jx ko kb kp kf kq kj kr ks kt ku bi translated">登录到您使用上一页中的脚本创建的用户帐户，并确认您的数据在新创建的Postgres数据库中</li></ul><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="kv kw l"/></div></figure><ul class=""><li id="65e4" class="km kn hi jq b jr js ju jv jx ko kb kp kf kq kj kr ks kt ku bi translated">列出dvdrental数据库中的所有表格</li></ul><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="kv kw l"/></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lj"><img src="../Images/fc5fb2e92f99874fe837508c7b78ebc2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*vYrJK9DxjQ9A7xk2"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">dvdrental Postgres数据库中所有表格的列表(图片由作者提供)</figcaption></figure><ul class=""><li id="7882" class="km kn hi jq b jr js ju jv jx ko kb kp kf kq kj kr ks kt ku bi translated">检查演员的桌子</li></ul><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="kv kw l"/></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lk"><img src="../Images/8daa7ff0b1d8b8969cfba8b61420e1b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*3WoJgpFYPMV5znjV"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">演员表(图片由作者提供)</figcaption></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es kx"><img src="../Images/803c91ae0035cf9733c93b7fd764067f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*NplsZMaSB2xlHsox"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">YugabyteDB管理UI页面中的表列表(图片由作者提供)</figcaption></figure><p id="337d" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">有了这个设置，您就可以开始设计并开始将您的应用程序连接到您的YugabyteDB。有了这些，你就可以继续你的开发过程了，在这之后进入生产阶段，一定要按照<a class="ae jn" href="https://docs.yugabyte.com/preview/deploy/checklist/" rel="noopener ugc nofollow" target="_blank">页面</a>上描述的部署清单进行。</p><h2 id="f073" class="ld le hi bd ll lm ln lo lp lq lr ls lt jx lu lv lw kb lx ly lz kf ma mb mc md bi translated"><strong class="ak">结论</strong></h2><p id="5650" class="pw-post-body-paragraph jo jp hi jq b jr me ij jt ju mf im jw jx mg jz ka kb mh kd ke kf mi kh ki kj hb bi translated">对于您的部署，请确保将一个卷附加到您的容器以避免数据丢失，此外，请确保公开您的端口，以便您可以从应用程序连接到数据库集群。有了这些，你就可以开始了，这篇文章的完整代码可以在<a class="ae jn" href="https://github.com/yTek01/YugabyteDB-on-Docker" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><h2 id="815f" class="ld le hi bd ll lm ln lo lp lq lr ls lt jx lu lv lw kb lx ly lz kf ma mb mc md bi translated">参考</h2><p id="e596" class="pw-post-body-paragraph jo jp hi jq b jr me ij jt ju mf im jw jx mg jz ka kb mh kd ke kf mi kh ki kj hb bi translated">[1]<a class="ae jn" href="https://www.postgresqltutorial.com/postgresql-getting-started/postgresql-sample-database/" rel="noopener ugc nofollow" target="_blank">https://www . PostgreSQL tutorial . com/PostgreSQL-getting-started/PostgreSQL-sample-database/</a></p><p id="f0cd" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><a class="ae jn" href="https://docs.yugabyte.com/preview/deploy/checklist/" rel="noopener ugc nofollow" target="_blank">https://docs.yugabyte.com/preview/deploy/checklist/</a></p><p id="cceb" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">[3]<a class="ae jn" href="https://hub.docker.com/r/yugabytedb/yugabyte" rel="noopener ugc nofollow" target="_blank">https://hub.docker.com/r/yugabytedb/yugabyte</a></p><p id="475c" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">[4]<a class="ae jn" href="https://docs.yugabyte.com/preview/deploy/docker/docker-compose/" rel="noopener ugc nofollow" target="_blank">https://docs . yugabyte . com/preview/deploy/docker/docker-compose/</a></p><p id="f35f" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">感谢您的阅读。我很乐意回答任何问题，并听取任何意见。</p></div></div>    
</body>
</html>