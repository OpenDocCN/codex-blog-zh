<html>
<head>
<title/>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1/>
<blockquote>原文：<a href="https://medium.com/codex/10-mistakes-ive-made-in-my-software-designs-part-1-of-2-9664ccc9aa00?source=collection_archive---------3-----------------------#2021-11-14">https://medium.com/codex/10-mistakes-ive-made-in-my-software-designs-part-1-of-2-9664ccc9aa00?source=collection_archive---------3-----------------------#2021-11-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/7754e69100dc8bd5e010b78d5bf61531.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QMkgTa50HKbHU-jUnvb7cQ.jpeg"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">肖恩·斯特拉顿在<a class="ae hv" href="https://unsplash.com/s/photos/rock-stack?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="bd59" class="pw-post-body-paragraph hw hx hy hz b ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir is it iu hb bi translated">我犯的许多设计错误是忘记考虑系统的某些方面。这些错误不再让我感到惊讶，因为软件设计需要在头脑中同时处理许多概念，如封装、依赖、性能和规模。我的经历帮助我成为一名更好的设计师，因为我记得我以前设计中缺失的那些方面。</p><p id="f437" class="pw-post-body-paragraph hw hx hy hz b ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir is it iu hb bi translated">以下是我列出的过去未能考虑的设计元素，希望能帮助你在现在和未来的设计中记住它们。这些适用于后端服务，但其中一些也是前端考虑事项。</p><p id="7a76" class="pw-post-body-paragraph hw hx hy hz b ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir is it iu hb bi translated"><em class="iv">免责声明1:这篇文章很长。我把它分成了两部分。每一项都可以自己填充多个章节。我试着把它浓缩到花费我返工、意外工作或繁忙工作的关键点上。</em></p><p id="5331" class="pw-post-body-paragraph hw hx hy hz b ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir is it iu hb bi translated"><em class="iv">免责声明2:我不涵盖具体的技术或基础设施设计。我涵盖了抽象这些基本层的逻辑软件设计。</em></p><h1 id="6f34" class="iw ix hy bd iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt bi translated">1.操作</h1><p id="50de" class="pw-post-body-paragraph hw hx hy hz b ia ju ic id ie jv ig ih ii jw ik il im jx io ip iq jy is it iu hb bi translated">运行您设计的软件的成本是要考虑的最重要的方面之一。如果你的系统是一个操作负担，我会认为它是失败的。通过在设计中考虑这些操作问题，可以避免系统的高成本操作。</p><p id="e5f4" class="pw-post-body-paragraph hw hx hy hz b ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir is it iu hb bi translated"><strong class="hz jz">健康指标</strong> —您应该确定将告诉您系统是否健康的指标。然后，您应该设计系统来发出允许计算这些指标的数据。不要错误地认为系统的健康仅仅是主机的CPU、内存和磁盘利用率。有时，我们系统的健康指标更复杂，涉及实时收集和聚合多个数据点。</p><p id="2070" class="pw-post-body-paragraph hw hx hy hz b ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir is it iu hb bi translated"><strong class="hz jz">质量</strong> <strong class="hz jz">取证</strong> —当出现操作问题时，您系统中的日志会对您有所帮助。我犯了一个错误，我们将打开日志文件，它会告诉我所有我需要知道的信息，却发现我遗漏了一些关键的信息。更糟糕的是，系统的日志跨越数十台主机，我必须编写脚本来提取、解析和提取我需要的信息。当你处于恢复系统正常运行的高压状态时，这样工作并不有趣。在设计时考虑系统的取证部署，而不是在关键时刻。</p><p id="b99f" class="pw-post-body-paragraph hw hx hy hz b ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir is it iu hb bi translated"><strong class="hz jz">应用性能监控(APM) </strong> —目前市场上有多种APM产品可以为您的系统运营提供单一平台。我天真地认为这些都可以轻松地安装，转动钥匙，瞧，我看到了我的系统内部所有的荣耀。没有。我不得不改变许多开发和部署过程，以使它“正常工作”不要在以后改造您的系统来与APM集成，而是从一开始就将其设计为与您选择的APM一起工作，并获得他们的销售和营销所宣称的“开箱即用”的好处。</p><h1 id="8cdf" class="iw ix hy bd iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt bi translated">2.托管和许可成本</h1><p id="4429" class="pw-post-body-paragraph hw hx hy hz b ia ju ic id ie jv ig ih ii jw ik il im jx io ip iq jy is it iu hb bi translated">我承认，当我设计系统时，托管和许可成本是我最后考虑的问题。这是一个后来要处理的话题，很久以后，直到会计部的某个人发来一封关于一笔巨额账单的邮件。在这一点上，我必须更换昂贵的组件，优化其使用，或更换它。</p><p id="ee2d" class="pw-post-body-paragraph hw hx hy hz b ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir is it iu hb bi translated"><strong class="hz jz">预测成本</strong> —你可以通过一些简单的计算来预测成本。这并不需要很长时间，而且可以为你节省很多费用。例如，假设您的系统每台主机每秒可以处理一个事务(1 TPS)。您预测您将需要支持100个并发用户，这意味着您将需要100台主机。如果每台主机的成本是每月10美元，那么您看到的大约是每月1000美元的账单。你能负担得起吗？如果不能，你的设计最好改变以支持更多的TPS(或者找到更便宜的主机)。</p><p id="39ea" class="pw-post-body-paragraph hw hx hy hz b ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir is it iu hb bi translated"><strong class="hz jz">抽象化您的第三方提供商</strong> —您将从为您的第三方提供商设计的抽象化中受益。例如，如果您使用第三方进行授权，那么为您的第三方创建一个带有具体实现的抽象授权接口。通过这种方式，您可以在以后更改成本较低的提供者，而无需更改依赖于您的特定身份验证提供者的客户端。</p><h1 id="5472" class="iw ix hy bd iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt bi translated">3.易测性</h1><p id="cc8f" class="pw-post-body-paragraph hw hx hy hz b ia ju ic id ie jv ig ih ii jw ik il im jx io ip iq jy is it iu hb bi translated">你必须设计你的系统从一开始就可以自动化测试。任何非平凡的系统都会继续增长其功能，增加代码行，这有可能导致bug和错误。随着系统的增长，测试它所花费的时间也会增加。稍后添加自动化将是具有挑战性的，使您的组件可模仿、可配置、足够小以至于可测试。通过从一开始就将您的系统设计成可测试的，您可以发展您的系统，并保持它是高质量的信心。</p><p id="4c9a" class="pw-post-body-paragraph hw hx hy hz b ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir is it iu hb bi translated">抽象您的第三方提供商 —除了让您节省成本，抽象您的依赖关系也是使您的系统可测试的一个步骤。依赖关系的具体实现可以是支持自动化测试的模拟。</p><p id="ef87" class="pw-post-body-paragraph hw hx hy hz b ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir is it iu hb bi translated"><strong class="hz jz">综合输入</strong> —构建您的系统以接受来自多个来源的输入。为了从标准自动化输入的文件源或命令行接收输入，以后进行重构的代价是很高的。然而，在这里要小心。如果您的系统不能扫描这些合成输入，您将很快拥有一个被“测试用户”、“临时产品”和类似变体污染的嘈杂系统。</p><p id="db08" class="pw-post-body-paragraph hw hx hy hz b ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir is it iu hb bi translated"><strong class="hz jz">测试环境</strong> —您构建系统的环境最终会变得太大而无法复制。您将最终测试生产中的一切，因为这是唯一拥有足够或最好的数据来验证您的系统更改的地方。我在我工作过的几乎每一家公司都看到了这一点，甚至是像亚马逊这样的大巨头。不要让这种事情发生。考虑如何在您的设计和整个开发过程中管理您的登台、测试和开发环境。</p><h1 id="f14f" class="iw ix hy bd iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt bi translated">4.国际化</h1><p id="5f09" class="pw-post-body-paragraph hw hx hy hz b ia ju ic id ie jv ig ih ii jw ik il im jx io ip iq jy is it iu hb bi translated">“好吧，让我们向世界开放，获得更多的客户，”几乎每个产品经理都这么说。然而，他们是对的。如果你有好的产品或服务，为什么不让它在全球范围内发展呢？想象一下当你告诉他们你的系统只支持西方语言的不幸消息时他们的表情。或者你的拷贝都是硬编码的，很难翻译。或者您的系统没有跟踪每个国家或每个市场的数据。</p><p id="5dca" class="pw-post-body-paragraph hw hx hy hz b ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir is it iu hb bi translated"><strong class="hz jz">分离您的本地化资产，将它们存储在Unicode中</strong> —保持您的本地化资产，如文本和图像，通过系统中的标识符进行分离和引用。这样，您可以在将来用本地化版本替换资产。请确保以Unicode格式存储文本，这样您就不用处理昂贵的字节转换来支持以后在客户机上的呈现。一个好的技巧是将系统文本放在一个单独的文件中，就像其他源代码一样。</p><p id="e512" class="pw-post-body-paragraph hw hx hy hz b ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir is it iu hb bi translated"><strong class="hz jz">使用ISO国家代码作为你的标识符</strong> —我曾经有一个应用程序遇到了生产问题，其中一个屏幕显示空白。根本原因是因为一名工程师决定将英国的国家代码从“UK”更改为“GB”。“GB”是英国的ISO国家代码，所以在当时这并不是一个坏主意。由于将代码更改为在任何地方都使用“GB”需要很长时间，工程师编写了一个临时修复程序来接受“UK”或“GB”。您可以想象在代码中的多个地方看到这种条件是多么令人讨厌。从一开始就使用ISO国家代码，避免这个问题。</p><p id="c81f" class="pw-post-body-paragraph hw hx hy hz b ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir is it iu hb bi translated"><strong class="hz jz">从一开始就建立地理跟踪</strong> —如果您正在跟踪客户或系统数据，很容易忘记位置是捕获系统事件的一个重要属性。当你的产品经理或领导向你要一份按市场划分的报告时，如果没有这些数据，那是不可能的。对此的补救是昂贵的。您需要回填现有数据以添加位置，更改服务和客户端调用以添加额外的位置参数，并更改数据存储模式以添加属性。坦白说，这是一场噩梦。</p><h1 id="dd36" class="iw ix hy bd iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt bi translated">5.安全性</h1><p id="cfa8" class="pw-post-body-paragraph hw hx hy hz b ia ju ic id ie jv ig ih ii jw ik il im jx io ip iq jy is it iu hb bi translated">软件设计中的安全性是一个大话题，但我记得在系统设计期间考虑了以下几个方面。如果您正在处理客户、支付或其他敏感数据，请花时间从安全角度仔细检查您的系统。您不希望因为您的安全设计不够谨慎而破坏您和客户之间的信任。</p><p id="1905" class="pw-post-body-paragraph hw hx hy hz b ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir is it iu hb bi translated"><strong class="hz jz">隔离</strong> —如果这种类型的数据被隔离，您的系统对敏感、机密数据的处理和保护将更加易于管理。您应该尽量避免将其与公共类型或受限类型混合使用。通过将数据存储在完全不同的数据存储中并限制代码对数据的访问来隔离它们。越来越多的组织将他们的数据转移到服务提供商那里，这些服务提供商能够比他们更好地保护和管理数据。你也应该考虑这个选择。</p><p id="ba3a" class="pw-post-body-paragraph hw hx hy hz b ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir is it iu hb bi translated"><strong class="hz jz">授权</strong> —如果您没有使用行业标准的授权机制来保护系统，那么您的系统是不完整的。忘记做这件事就相当于没锁门。有用于认证的样板代码或库，但是要确保它来自可信的来源。您不希望在您的系统中有未知的后门或安全漏洞，因为您获得了第一个开源身份验证库来加速您的开发。</p><p id="8b69" class="pw-post-body-paragraph hw hx hy hz b ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir is it iu hb bi translated"><strong class="hz jz"> Bot检测，速率限制</strong>——“我的系统不会宕机”是乐观工程师的共同宣言之一。诚然，这是我刚接触系统设计时的想法。最终，您的系统会停机，这很可能是流量激增的结果。你可以经受住风暴，希望交通平静下来。或者你可以设计你的系统从启动的第一天就有防御机制，比如僵尸检测和速率限制。同样，服务提供商可以有偿提供这些防护措施，您应该在自己构建之前考虑这些措施。</p></div><div class="ab cl ka kb gp kc" role="separator"><span class="kd bw bk ke kf kg"/><span class="kd bw bk ke kf kg"/><span class="kd bw bk ke kf"/></div><div class="hb hc hd he hf"><p id="da3a" class="pw-post-body-paragraph hw hx hy hz b ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir is it iu hb bi translated">本文是两部分系列的第一部分。如果你有其他你犯过的设计错误并想分享，请在下面的评论中添加它们。我很乐意为这个系列做一个附录，包括其他人学到的东西。</p></div></div>    
</body>
</html>