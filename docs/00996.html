<html>
<head>
<title>Never Lose Any One! Sparkify User Churn Prediction Challenge Using Pyspark</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">绝不丢任何一个！使用Pyspark提高用户流失预测挑战</h1>
<blockquote>原文：<a href="https://medium.com/codex/never-lose-any-one-sparkify-user-churn-prediction-challenge-using-pyspark-7ab67ac080d4?source=collection_archive---------13-----------------------#2021-03-29">https://medium.com/codex/never-lose-any-one-sparkify-user-churn-prediction-challenge-using-pyspark-7ab67ac080d4?source=collection_archive---------13-----------------------#2021-03-29</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="cf12" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Github回购:<a class="ae jd" href="https://github.com/BurgerWu/Sparkify-Project" rel="noopener ugc nofollow" target="_blank">此处</a></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es je"><img src="../Images/53f8cb4f49954feb76a139ab9be40019.png" data-original-src="https://miro.medium.com/v2/resize:fit:1302/format:webp/1*cxN-lTlH--shrVOPqRv_Qg.jpeg"/></div></figure><h1 id="17cc" class="jm jn hi bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">介绍</h1><p id="b180" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">对于任何服务提供商来说，如果他们能够感觉到一些用户将要离开或取消他们的服务，这对于他们的生存是至关重要的。在这个项目中，我们提供了包含为每个用户-服务交互记录日志的数据集。我们将在后面的部分讨论数据集的细节。我们的任务是从我们拥有的数据集建立预测模型，并预测特定用户是否有流失的意图。</p><p id="6f42" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了实现我们的目标，我们使用Pyspark作为我们项目的框架。Pyspark是Python的Spark API，特别是在处理大数据时，它的工作效率很高。在Spark的帮助下，我们能够构建高效且有用的应用程序。</p><h1 id="20a2" class="jm jn hi bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">关于数据集</h1><p id="c75b" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">在本文中，我们仅使用原始大型(12GB)数据集的一个子集(230MB)进行初步建模。下面列出了数据帧的模式。该数据集中有448个不同的用户。</p><pre class="jf jg jh ji fd kp kq kr ks aw kt bi"><span id="397a" class="ku jn hi kq b fi kv kw l kx ky"> |-- artist: string (nullable = true)<br/> |-- auth: string (nullable = true)<br/> |-- firstName: string (nullable = true)<br/> |-- gender: string (nullable = true)<br/> |-- itemInSession: long (nullable = true)<br/> |-- lastName: string (nullable = true)<br/> |-- length: double (nullable = true)<br/> |-- level: string (nullable = true)<br/> |-- location: string (nullable = true)<br/> |-- method: string (nullable = true)<br/> |-- page: string (nullable = true)<br/> |-- registration: long (nullable = true)<br/> |-- sessionId: long (nullable = true)<br/> |-- song: string (nullable = true)<br/> |-- status: long (nullable = true)<br/> |-- ts: long (nullable = true)<br/> |-- userAgent: string (nullable = true)<br/> |-- userId: string (nullable = true)</span></pre><h1 id="26ae" class="jm jn hi bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">探索性数据分析</h1><p id="a3d6" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">在本节中，我们将对收到的日志数据执行探索性数据分析。我们将重点分析整个群体，而在第二部分，我们将深入分析用户群。</p><h2 id="dd1d" class="ku jn hi bd jo kz la lb js lc ld le jw iq lf lg ka iu lh li ke iy lj lk ki ll bi translated">用户活动计数直方图</h2><p id="a36e" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">通过按userId分组，我们可以获得用户活动的计数。绘制出我们的结果后，这是一个右偏分布就不足为奇了，因为大多数用户对我们的服务反应并不那么极端</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es lm"><img src="../Images/8e20564916c78281a627bce46771e370.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pbGtY1y-auyO2_DmsTHlxg.png"/></div></div></figure><h2 id="0f3a" class="ku jn hi bd jo kz la lb js lc ld le jw iq lf lg ka iu lh li ke iy lj lk ki ll bi translated">按页面类型列出的活动</h2><p id="1bf3" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">我们通过统计不同页面上的活动数量来了解用户交互的总体情况。看起来访问量最大的页面是NextSong，而第二和第三大页面是thumbs up和home。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es lr"><img src="../Images/e376db64693d4373032b6e58656b0020.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LF0PGpfOU5RInqE4-9Hr4g.png"/></div></div></figure><h2 id="8e18" class="ku jn hi bd jo kz la lb js lc ld le jw iq lf lg ka iu lh li ke iy lj lk ki ll bi translated">用户性别</h2><p id="602d" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">我们很好奇总用户的性别分布。结果显示，使用我们服务的男性用户多于女性用户</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es ls"><img src="../Images/3934f8af336167d913321b9c2bdbfaa8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1064/format:webp/1*Yv32uVeNRlbvoXVYogeslw.png"/></div></figure><h2 id="6811" class="ku jn hi bd jo kz la lb js lc ld le jw iq lf lg ka iu lh li ke iy lj lk ki ll bi translated">位置</h2><p id="c052" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">下图显示了不同地区用户的分布情况。用户最多的前三个城市是纽约、洛杉矶和波士顿。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es lt"><img src="../Images/caa14c3f3dc7233c411f159598c3cf43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F0WaIkBbcJkRv3L38RGvzw.png"/></div></div></figure><h2 id="796c" class="ku jn hi bd jo kz la lb js lc ld le jw iq lf lg ka iu lh li ke iy lj lk ki ll bi translated">最受欢迎的艺术家</h2><p id="7816" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">根据我们的统计分析，最受欢迎的两位歌手是《莱昂之王》和《酷玩乐队》。以下是最受欢迎的20位艺人。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es lu"><img src="../Images/3fff37b0856499e3a8d5954b842bc0c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W6N8eprFVqR2XGS4_wUkFg.png"/></div></div></figure><h2 id="e4e8" class="ku jn hi bd jo kz la lb js lc ld le jw iq lf lg ka iu lh li ke iy lj lk ki ll bi translated">大多数人听歌</h2><p id="486c" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">最热门的歌曲是《非诚勿扰》。下面是前20名的点击率。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es lv"><img src="../Images/990091470227469bd00cb71e2e81f6cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E9UVHOwea2YXRTjc992KqA.png"/></div></div></figure><p id="2255" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们将开始分析不同搅动组的数据，以查看搅动用户和非搅动用户之间是否存在显著差异。</p><h2 id="0842" class="ku jn hi bd jo kz la lb js lc ld le jw iq lf lg ka iu lh li ke iy lj lk ki ll bi translated">降级次数</h2><p id="2217" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">搅动用户和非搅动用户的降级行为除了在搅动用户群体中出现一些极值外，没有显著差异</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es lw"><img src="../Images/9de070c95d6614af5e75f24f529440e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1088/format:webp/1*hlAMeHj-euuJHVTGkmcPeA.png"/></div></figure><h2 id="6997" class="ku jn hi bd jo kz la lb js lc ld le jw iq lf lg ka iu lh li ke iy lj lk ki ll bi translated">升级次数</h2><p id="a9ce" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">搅动和非搅动用户之间升级次数的比率似乎没有显著差异。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es lx"><img src="../Images/8a9145bf1d46b8d3c83b7da966de87d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1028/format:webp/1*XBkG_EMjJHD3eWw3fbp1OA.png"/></div></figure><h2 id="ae41" class="ku jn hi bd jo kz la lb js lc ld le jw iq lf lg ka iu lh li ke iy lj lk ki ll bi translated">最终用户级别</h2><p id="aab3" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">我们检查了最终用户级别和流失之间的关系，发现付费用户比免费用户有更高的流失机会。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es ly"><img src="../Images/950ceb6390fb1d164cc007345f702963.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Tu4hlIMTWNKqdw0XrBMK1w.png"/></div></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es lz"><img src="../Images/0ccdf9aa33d80c10524bdb1ed7fde4c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:652/format:webp/1*-9d7yphOMLqsRIIKckHgMw.png"/></div></figure><h2 id="1f0c" class="ku jn hi bd jo kz la lb js lc ld le jw iq lf lg ka iu lh li ke iy lj lk ki ll bi translated">总花费时间</h2><p id="7cb4" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">虽然总花费时间的平均值对于非频繁使用的用户来说有点高，但是从kde曲线来看，两组用户之间没有明显的区别。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es ma"><img src="../Images/1e6c520835916f53fc06fc1b8fb97c53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bTD9vKMCDhBsyaS9Cco8ig.png"/></div></div></figure><h2 id="3a2f" class="ku jn hi bd jo kz la lb js lc ld le jw iq lf lg ka iu lh li ke iy lj lk ki ll bi translated">歌曲总数</h2><p id="65f3" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">与总花费时间相同，两组没有明显的区别。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es mb"><img src="../Images/1ef5aa9e3ca3e7281bac8e182e77312b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hHY1_ozWzoF3l51iBpOUWg.png"/></div></div></figure><h2 id="f5d2" class="ku jn hi bd jo kz la lb js lc ld le jw iq lf lg ka iu lh li ke iy lj lk ki ll bi translated">每月会话数</h2><p id="a1ab" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">频繁使用的用户比不频繁使用的用户每月有更多的会话。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es mc"><img src="../Images/186ec843c69f6499ca8b539ab9cd156b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q4ZBgDn3bZo5XfjDePWRMg.png"/></div></div></figure><h2 id="1f7d" class="ku jn hi bd jo kz la lb js lc ld le jw iq lf lg ka iu lh li ke iy lj lk ki ll bi translated">平均会话长度</h2><p id="6ddf" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">尽管这种分布并不完全相同，但仍然没有证据表明这两个群体在这一特征上有不同的行为。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es md"><img src="../Images/fb75b1057f9c6560dca335c1a72c4831.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Hf4g0YyJ_jACrHFzWjz9QA.png"/></div></div></figure><h2 id="21fa" class="ku jn hi bd jo kz la lb js lc ld le jw iq lf lg ka iu lh li ke iy lj lk ki ll bi translated">用户设备</h2><p id="3045" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">用户设备的两大主流是Windows和Macintosh，但它们都具有与数据集群体相似的流失率。至于其他少数民族，用户太少，不具有代表性。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es me"><img src="../Images/5152f6f6b1a8b0009164b0c37e67ec1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bL3MOQcvidcuOI-CJsXfLw.png"/></div></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es mf"><img src="../Images/cff6465637c2bef16033719abed67234.png" data-original-src="https://miro.medium.com/v2/resize:fit:650/format:webp/1*dj4Lm3GLlGh4JyDAoYPHkw.png"/></div></figure><h2 id="4914" class="ku jn hi bd jo kz la lb js lc ld le jw iq lf lg ka iu lh li ke iy lj lk ki ll bi translated">给予的总赞数</h2><p id="d30d" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">非易激动用户比易激动用户更倾向于竖起大拇指，但没有那么显著。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es mb"><img src="../Images/12e6740eeca19a9cb4177540886a0390.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TjpnQvELEf9OJbpT9uHkiQ.png"/></div></div></figure><h2 id="3200" class="ku jn hi bd jo kz la lb js lc ld le jw iq lf lg ka iu lh li ke iy lj lk ki ll bi translated">每天竖起大拇指</h2><p id="9d80" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">但是，如果我们分析每天竖起大拇指的情况，令我们惊讶的是，易怒的用户比不易怒的用户更倾向于竖起大拇指。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es mg"><img src="../Images/bede5a449ef68779a76fc9f03bf73faf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vb-jx-5iofls7styIfSAZA.png"/></div></div></figure><h2 id="df26" class="ku jn hi bd jo kz la lb js lc ld le jw iq lf lg ka iu lh li ke iy lj lk ki ll bi translated">完全否定</h2><p id="c83f" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">两组用户给出的平均否定量是相似的。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es mh"><img src="../Images/7528707beee21eab57af1a39ecc9845c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0Vxb6iq_oheKl84q49N8hw.png"/></div></div></figure><h2 id="f02b" class="ku jn hi bd jo kz la lb js lc ld le jw iq lf lg ka iu lh li ke iy lj lk ki ll bi translated">每天拇指向下</h2><p id="6a2b" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">但是当我们每天分析拇指向下的时候，有一点变得很重要，那就是兴奋的用户比不兴奋的用户每天发出更多的拇指向下的声音。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es mi"><img src="../Images/226b109461420890ed369bac0ad94196.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w6l95_3De1XowrtvdhVqlg.png"/></div></div></figure><h2 id="c7da" class="ku jn hi bd jo kz la lb js lc ld le jw iq lf lg ka iu lh li ke iy lj lk ki ll bi translated">拇指向上比率</h2><p id="bb08" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">我们创建了一个名为“竖起大拇指比率”的新功能，来调查所有评级行为中竖起大拇指的比例。根据该图，有一个位于较低侧的峰值，反映了搅动的用户平均具有较低的竖起大拇指比率的事实。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es mj"><img src="../Images/a09f3542967454e79e76e223fd653bb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zp91B-3SWimVbL7XsLHEiA.png"/></div></div></figure><h2 id="c2d6" class="ku jn hi bd jo kz la lb js lc ld le jw iq lf lg ka iu lh li ke iy lj lk ki ll bi translated">性别</h2><p id="a40f" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">男性和女性的流失率与数据集人群几乎完全相同</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es mk"><img src="../Images/cbfc2a6567db544567f29b29e74da30f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1050/format:webp/1*57MK5eFgtmGku86vp8EkWw.png"/></div></figure><h2 id="4c0c" class="ku jn hi bd jo kz la lb js lc ld le jw iq lf lg ka iu lh li ke iy lj lk ki ll bi translated">独特的歌曲</h2><p id="b03b" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">两组之间的独特歌曲没有显著差异</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es ml"><img src="../Images/672b3829564128e44c0bfe4de12d6f3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kczjRvsITKxnwjUIZAOwfA.png"/></div></div></figure><h2 id="0eff" class="ku jn hi bd jo kz la lb js lc ld le jw iq lf lg ka iu lh li ke iy lj lk ki ll bi translated">独特的艺术家</h2><p id="f7cd" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">两组之间的独特艺术家没有显著差异</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es mm"><img src="../Images/b15315aec5fd78aa2eecc9671d39a6fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*381jK7v446n1KuCRWAhB9Q.png"/></div></div></figure><h2 id="d50c" class="ku jn hi bd jo kz la lb js lc ld le jw iq lf lg ka iu lh li ke iy lj lk ki ll bi translated">会话中的平均项目</h2><p id="c7c2" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">搅动的用户平均会话中的项目稍多，但不显著。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es mn"><img src="../Images/cdb56f12e56f23b4aae74315e8f8fd4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DvRfzPLTMFPLp-zeLIoneA.png"/></div></div></figure><h2 id="2d2d" class="ku jn hi bd jo kz la lb js lc ld le jw iq lf lg ka iu lh li ke iy lj lk ki ll bi translated">朋友总数</h2><p id="4f84" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">非狂热用户往往比狂热用户拥有更多的朋友。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es ml"><img src="../Images/b5582553735d21aefbef5325d9022b03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kvWQ7Q6MCi7s_Y6SAEhFyg.png"/></div></div></figure><h2 id="fdd8" class="ku jn hi bd jo kz la lb js lc ld le jw iq lf lg ka iu lh li ke iy lj lk ki ll bi translated">会员期限</h2><p id="76cb" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">成员资格持续时间是指注册和最后一次记录日志之间的时间长度。显然，非活跃用户比活跃用户更容易保持会员资格。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es mo"><img src="../Images/c9062ba5ad6257537189b5fe487726e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N_0j_ei5MqHYTSTRGsvPyQ.png"/></div></div></figure><h2 id="7ce2" class="ku jn hi bd jo kz la lb js lc ld le jw iq lf lg ka iu lh li ke iy lj lk ki ll bi translated">每天的错误</h2><p id="e023" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">我们分析了用户每天面临的错误，因为这对服务提供商来说是一个严重的问题。正如我们预期的那样，被搅动的用户平均每天面临更多的错误。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es mc"><img src="../Images/8244c018a75389a17faa6063b780872a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*veOm35H-H3QOsMv0or5gWg.png"/></div></div></figure><h1 id="9a61" class="jm jn hi bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">特征工程</h1><p id="c4dd" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">为了评估我们的用户流失意图，我们需要将数据集转换或记录为有用的特征。基于上一节的探索性分析，我们选择了以下特性。在这里，我们将讨论我们为后面的机器学习过程创建的功能。</p><h2 id="5286" class="ku jn hi bd jo kz la lb js lc ld le jw iq lf lg ka iu lh li ke iy lj lk ki ll bi translated">用户是否搅动</h2><p id="545b" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">该列是我们的标签列，因为我们的目标是预测用户是否会流失。根据我们的分析，所有不愉快的用户最后一次访问我们的服务是在“取消确认”页面上，并且再也没有回来。因此，在这种情况下没有返回或重新加入的情况。</p><h2 id="980e" class="ku jn hi bd jo kz la lb js lc ld le jw iq lf lg ka iu lh li ke iy lj lk ki ll bi translated">用户时间跨度</h2><p id="0a4b" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">我们的一些功能应该每天进行分析，因此，我们计算每个用户的时间跨度，即记录的第一个和最后一个日志之间的长度。</p><h2 id="3626" class="ku jn hi bd jo kz la lb js lc ld le jw iq lf lg ka iu lh li ke iy lj lk ki ll bi translated">最终水平</h2><p id="1c70" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">最终级别是指记录用户最后一次活动时的用户级别。有两类免费或付费用户。在使用此功能之前，我们需要执行虚拟转换。</p><h2 id="983d" class="ku jn hi bd jo kz la lb js lc ld le jw iq lf lg ka iu lh li ke iy lj lk ki ll bi translated">每月会话数</h2><p id="024a" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">我们按月统计用户的会话数。</p><h2 id="9537" class="ku jn hi bd jo kz la lb js lc ld le jw iq lf lg ka iu lh li ke iy lj lk ki ll bi translated">每天竖起大拇指</h2><p id="881c" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">从探索性分析来看，每日竖起大拇指似乎是一个显著特征。</p><h2 id="d4cf" class="ku jn hi bd jo kz la lb js lc ld le jw iq lf lg ka iu lh li ke iy lj lk ki ll bi translated">每天拇指向下</h2><p id="2691" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">从探索性分析来看，每日拇指向下似乎是一个显著特征。</p><h2 id="9608" class="ku jn hi bd jo kz la lb js lc ld le jw iq lf lg ka iu lh li ke iy lj lk ki ll bi translated">拇指向上比率</h2><p id="5fe4" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">此功能是关于所有评定行为中竖起大拇指的比例(竖起大拇指和放下大拇指)</p><h2 id="fd9c" class="ku jn hi bd jo kz la lb js lc ld le jw iq lf lg ka iu lh li ke iy lj lk ki ll bi translated">会员期限</h2><p id="e312" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">这一特征在某种程度上反映了我们服务的忠诚度</p><h2 id="23de" class="ku jn hi bd jo kz la lb js lc ld le jw iq lf lg ka iu lh li ke iy lj lk ki ll bi translated">每天的错误</h2><p id="223c" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">正如我在上一节中提到的，这对于服务提供商来说是一个严重的问题，从我们的分析来看，用户每天面临的错误对于两个用户组来说有很大的不同。</p><h2 id="de6c" class="ku jn hi bd jo kz la lb js lc ld le jw iq lf lg ka iu lh li ke iy lj lk ki ll bi translated">会话中的平均项目</h2><p id="bd36" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">我们也对用户每次会话中的平均项目感到好奇，这可能意味着用户会在一次会话中持续使用我们的服务多长时间。</p><h1 id="60ba" class="jm jn hi bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">建模和评估</h1><p id="6666" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">在建模过程中，我们首先应用vectorassemble和minMaxScaler处理我们的数据集，然后用三种候选算法进行拟合，包括Logistic回归、支持向量机和RandomForest。在与我们的训练数据拟合之后，我们然后用拟合的模型转换我们的测试集数据。最后，我们使用准确性和f1_score等指标来评估基于测试集性能的最佳模型。</p><h2 id="f2ce" class="ku jn hi bd jo kz la lb js lc ld le jw iq lf lg ka iu lh li ke iy lj lk ki ll bi translated">预处理</h2><p id="c4c5" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">在预处理阶段，我们使用了矢量汇编器和标准定标器</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="mp mq l"/></div></figure><h2 id="a333" class="ku jn hi bd jo kz la lb js lc ld le jw iq lf lg ka iu lh li ke iy lj lk ki ll bi translated">初步试验</h2><p id="42e6" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">因为原始数据集是不平衡的，并且只有数百个数据，所以我们进行了初步测试，以检查单个分类器是如何工作的，并决定适当的正标签与负标签的比例，以供稍后优化。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es mr"><img src="../Images/586b383fd84a33acf0f2d5f81ed7c843.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nA9dVAVcpnFLTy1XMTWqBA.png"/></div></div><figcaption class="ms mt et er es mu mv bd b be z dx translated">不同分类器的准确度和F1_score比较</figcaption></figure><p id="5904" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从上面的结果图中，我们可以看到，在正负比率为1.25时，精确度和f1_score都得到了优化。因此，我们将在后期优化中使用1.25作为我们的比率。</p><h2 id="d269" class="ku jn hi bd jo kz la lb js lc ld le jw iq lf lg ka iu lh li ke iy lj lk ki ll bi translated">使用ParamGrid和CrossValidator进行优化</h2><p id="3661" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">最后，我们尝试使用paramgrid和交叉验证来优化我们的分类器。这里显示了所有三个分类器的paramgrid参数。我们在crossvalidator中使用8折crossvalidation。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="mp mq l"/></div></figure><h2 id="a46d" class="ku jn hi bd jo kz la lb js lc ld le jw iq lf lg ka iu lh li ke iy lj lk ki ll bi translated">评估</h2><p id="bca5" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">下面是显示我们使用的所有三个分类器性能的线图。正如你所看到的，当我们在平衡测试集上测试时，我们可以达到f1_score和0.7以上的准确率。但是，当我们用整个数据集转换模型时，性能最高仅接近0.6。对于f1_score</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es mw"><img src="../Images/6de587ac774992d11d6db241641ec464.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8Z72-cpQW8rzaXwua9ZxDA.png"/></div></div></figure><h2 id="7f82" class="ku jn hi bd jo kz la lb js lc ld le jw iq lf lg ka iu lh li ke iy lj lk ki ll bi translated">正当理由；辩解</h2><p id="cd56" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">因为梯度增强树很容易在这个小数据集中过度拟合，并且比随机森林更耗时。我们决定采用随机森林作为我们的最终模型。</p><p id="9383" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">总的来说，逻辑回归表现最差，可能是因为我们分析的是非线性的人类行为。</p><p id="172a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">此外，梯度增强树如此容易过拟合的可能原因是算法是迭代的和贪婪的，因为我们只有少量的数据，很容易过拟合。</p><p id="9a8b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我看来，导致整个数据集整体失败的主要问题是由于数据集的大小，因为数据量不足以代表人口，模型很容易出现偏差。</p><h2 id="b8dd" class="ku jn hi bd jo kz la lb js lc ld le jw iq lf lg ka iu lh li ke iy lj lk ki ll bi translated">特征重要性</h2><p id="0c53" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">最后，我们尝试在RandomForest中使用feature importance方法来计算特征重要性。如您所见，每日错误数和每日竖起大拇指数在分类中扮演着重要角色</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es mx"><img src="../Images/922b88de4085eb6712b4dd5f2c0861e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cOcZShaE_hMhP0IpVghM7w.png"/></div></div></figure><h1 id="fcdb" class="jm jn hi bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">结论</h1><h2 id="1eb5" class="ku jn hi bd jo kz la lb js lc ld le jw iq lf lg ka iu lh li ke iy lj lk ki ll bi translated">关于项目</h2><ul class=""><li id="89f9" class="my mz hi ih b ii kk im kl iq na iu nb iy nc jc nd ne nf ng bi translated">我们做了大量的探索性数据分析，发现实际上大多数分析并没有反映出搅动用户群和非搅动用户群之间的明显差异</li><li id="0550" class="my mz hi ih b ii nh im ni iq nj iu nk iy nl jc nd ne nf ng bi translated">通过适当的探索性分析，我们最终选择了一些看起来足够重要的特性来区分不愉快的用户和不愉快的用户。令人欣慰的是，这种方法很有效，但还不够好，可以进一步改进。</li><li id="d52d" class="my mz hi ih b ii nh im ni iq nj iu nk iy nl jc nd ne nf ng bi translated">在机器处理的开始，我们首先进行初步测试以确定期望的正负标签比，以试图增强分类能力，因为如果我们不这样做，分类器可能不能正确地预测(或者甚至可能导致一类预测)</li><li id="9117" class="my mz hi ih b ii nh im ni iq nj iu nk iy nl jc nd ne nf ng bi translated">我们从三个候选者开始——逻辑回归、随机森林和梯度推进树。Logistic回归的表现比另外两个略差。当使用平衡测试集进行测试时，我们可以获得接近75%的准确率，f1也接近0.75。然而，在使用整个数据集进行测试后，性能下降了很多。</li><li id="6769" class="my mz hi ih b ii nh im ni iq nj iu nk iy nl jc nd ne nf ng bi translated">随机森林和梯度增强树的性能非常相似，但梯度增强树更有可能过拟合，而且更耗时。我们决定随机森林可能是这个项目中最终模型的更好选择。</li><li id="3c35" class="my mz hi ih b ii nh im ni iq nj iu nk iy nl jc nd ne nf ng bi translated">似乎很难用这个小数据集来进一步改进模型，我们应该以后在真正解释一般用户行为的完整数据集上工作</li><li id="02ef" class="my mz hi ih b ii nh im ni iq nj iu nk iy nl jc nd ne nf ng bi translated">从特征重要性分析，我们可以说，评级和错误是非常重要的服务提供商。对于服务提供商来说，确保他们服务稳定并让用户满意是至关重要的，因为他们愿意给出积极的评价而不是消极的评价。</li></ul><h2 id="5bdc" class="ku jn hi bd jo kz la lb js lc ld le jw iq lf lg ka iu lh li ke iy lj lk ki ll bi translated">改进</h2><ul class=""><li id="8c66" class="my mz hi ih b ii kk im kl iq na iu nb iy nc jc nd ne nf ng bi translated">这个数据集只是只有400个用户数据的庞大数据集的一部分。数量不足以代表总体，很容易出现偏差。</li><li id="a8fb" class="my mz hi ih b ii nh im ni iq nj iu nk iy nl jc nd ne nf ng bi translated">过拟合问题非常严重，特别是对于梯度增强树，但是调整参数和减少特征量似乎没有帮助(只是降低了训练性能，而没有提高测试性能)。在我看来，当我们使用完整的数据集时，这个问题可以得到缓解。</li><li id="e516" class="my mz hi ih b ii nh im ni iq nj iu nk iy nl jc nd ne nf ng bi translated">这个数据集是不平衡的，负标签比正标签多得多，我们必须首先仔细处理数据集，否则它可能导致错误预测(都在一个类中)</li></ul><p id="97f5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个项目的Github Repo可以在<a class="ae jd" href="https://github.com/BurgerWu/Sparkify-Project" rel="noopener ugc nofollow" target="_blank">这里</a>找到</p></div></div>    
</body>
</html>