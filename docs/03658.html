<html>
<head>
<title>How to install a fan onto a Raspberry Pi and make it run dynamically</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在树莓派上安装风扇并使其动态运行</h1>
<blockquote>原文：<a href="https://medium.com/codex/how-to-install-a-fan-onto-a-raspberry-pi-and-make-it-run-dynamically-4ff0e59985fc?source=collection_archive---------3-----------------------#2021-09-14">https://medium.com/codex/how-to-install-a-fan-onto-a-raspberry-pi-and-make-it-run-dynamically-4ff0e59985fc?source=collection_archive---------3-----------------------#2021-09-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/168fcbd2d3f258caac149808c9c5b2fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*M--Dz_yZxIOVjZ_9"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">斯蒂芬·科斯马在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="e048" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><a class="ae iu" rel="noopener" href="/codex/what-is-the-raspberry-pi-and-why-you-should-buy-one-aaae7f417b63">在我之前的文章中，我写了什么是树莓派，以及为什么你应该考虑买一个</a>。当前第四代树莓Pi的一个主要问题是它在重负载下会变得非常热。第四代Raspberry Pi确实“节流”了CPU，这意味着它减慢了处理速度，以防止设备过热。这很好，但你真的希望Pi表现良好，并得到相应的冷却。所以你真正需要的是一个好的冷却方案。此外，树莓派不附带包装盒，因此我们也可以使用这款产品。</p><p id="4adc" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">树莓派有两种冷却解决方案；主动冷却和被动冷却。主动冷却涉及使用物理旋转风扇来冷却中央处理器(CPU ),而被动冷却涉及使用散热器；锯齿状的金属片来散热。在降低CPU温度方面，主动冷却远比被动冷却有效，这就是我选择风扇来冷却我的树莓派的原因。<a class="ae iu" href="https://www.youtube.com/watch?v=AVfvhEJ9XD0" rel="noopener ugc nofollow" target="_blank">(如果你不相信我，可以看看YouTuber上克里斯·巴尼特(Chris Barnett)在树莓Pi 4上比较冷却解决方案的视频)</a>。</p><p id="4607" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因此，一个装有风扇的箱子将是理想的，因此我从亚马逊购买了6.49美元(8.96美元)的'<a class="ae iu" href="https://www.amazon.co.uk/gp/product/B07Y8DQ5ST/ref=ppx_yo_dt_b_asin_title_o04_s00?ie=UTF8&amp;psc=1" rel="noopener ugc nofollow" target="_blank"> GeeekPi Raspberry Pi 4丙烯酸箱子，带风扇的Raspberry Pi 4箱子(蓝光)和Raspberry Pi 4型号B的Raspberry Pi 4散热器，与Raspberry Pi冰塔风扇(黑色和透明)</a>兼容。</p><p id="b7bd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">当它到达时，我把它连接到我的Pi上，瞧，它启动了，风扇旋转起来，不停地冷却Pi。但是我想更进一步，考虑根据CPU温度动态控制风扇。在谷歌了一下之后，我发现了以下网站:<a class="ae iu" href="https://howchoo.com/g/ote2mjkzzta/control-raspberry-pi-fan-temperature-python" rel="noopener ugc nofollow" target="_blank">https://how choo . com/g/ote 2 mjkzzta/control-raspberry-pi-fan-temperature-python</a>。“蜜蜂的膝盖”我一直在想，直到我读到第3部分——建立测试电路。这就是陷入僵局的地方。我面临的问题是没有试验板和电路，我也不是电子工程师，所以知道如何制作这个对我来说有点太复杂了。</p><p id="a3aa" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在谷歌搜索了一些之后，我发现了这个网站:<a class="ae iu" href="https://www.tindie.com/products/jeremycook/ez-fan2-tiny-raspberry-pi-fan-controller/" rel="noopener ugc nofollow" target="_blank">https://www . tindie . com/products/jeremycook/ez-fan 2-tiny-Raspberry-Pi-fan-controller/</a>一位名叫Jeremy Cook的工程师制作了一个微型印刷电路板(PCB ),位于Raspberry Pi的风扇连接器和GPIO连接器之间。所以我买了它，加上以下附件:透明热收缩，8厘米母接头电线，总共9.95美元，加上运到英国的费用15美元(比这个项目多，但我认为它是值得的)，总费用为23.99美元。(请注意，如果你在英国，请查看一下在thePiHut上仅售4.20英镑的<a class="ae iu" href="https://thepihut.com/collections/raspberry-pi-cooling/products/fan-controller-for-raspberry-pi" rel="noopener ugc nofollow" target="_blank">树莓派风扇控制器</a></p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jt"><img src="../Images/e35c6ce319f04e64a820ded16b2008e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TuVLiwbUvxSVqyilgvLLyQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">如果您还没有额外的选项，请务必购买</figcaption></figure><p id="c641" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">看看杰里米·库克的YouTube视频，看看他是如何制作和安装的；<a class="ae iu" href="https://www.youtube.com/watch?v=AdjU_AVcZTA" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/watch?v=AdjU_AVcZTA</a>。5点59分，Jeremy展示了如何将电线连接到EZ风扇2的GPIO示意图。</p><p id="9046" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这是我安装的EZ风扇2连接器:</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jy"><img src="../Images/8f9c9552402f836e33be9a972d4536e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6-W2eHh6eIC7FATdRImsiw.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">记得在加热热缩膜之前测试风扇和微芯片</figcaption></figure><p id="6bcb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">注意，绿线在顶部，黄色在中间，蓝色在底部。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jy"><img src="../Images/b75c91cd17c26efdfbabe16979730963.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6zJQ0wgJr1_xQxfPHC3ksQ.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">我折断了备用线的一个连接器，并将其用作GPIO端口4的垫片</figcaption></figure><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jy"><img src="../Images/9b7b1d44596e5b52d4d089a03cb03745.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m3s-ea3r3hkAsYLCDh6KbA.jpeg"/></div></div></figure><p id="60f2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">根据原理图使用GPIO端口2、6和8:</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jz"><img src="../Images/e894be5547e949ae06fd5b2cfc19f8ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9nRHK_-aqZYwPtP77vAkqQ.png"/></div></div></figure><p id="07f5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">蓝线—端口2；5V电源</p><p id="f697" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">连接器垫片—端口4；5V电源</p><p id="7cf3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">绿线—端口6；地面</p><p id="c33a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">黄线—端口8；GPIO 14 (TXD)</p><p id="9184" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">现在让shell脚本动态工作</strong></p><p id="07b9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">访问以下链接:<a class="ae iu" href="https://howchoo.com/g/ote2mjkzzta/control-raspberry-pi-fan-temperature-python" rel="noopener ugc nofollow" target="_blank">https://how choo . com/g/ote 2 mjkzzta/control-Raspberry-Pi-fan-temperature-python</a>向下滚动到第4部分——使用安装脚本并一字不差地按照步骤操作(前提条件:给你的Raspberry Pi一个静态IP地址，通过以太网(首选)或WiFi将其连接到你的路由器。您还需要在Raspberry Pi上启用安全外壳(SSH ),并在其中使用SSH。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es ka"><img src="../Images/b22aa71b15fbb9da2c7da7ec28d424e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:658/format:webp/1*HKj4z2cSQvHy4qcwtOo4dQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">我在主目录中创建了一个名为check_fan的目录，并将fancontrol.sh脚本放在那里</figcaption></figure><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es kb"><img src="../Images/8bf7052a250031db03ae1cf4fc87bbc5.png" data-original-src="https://miro.medium.com/v2/resize:fit:670/format:webp/1*5LSyaEp-COzoF9O7vpKUng.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">使用cd命令访问check_fan目录</figcaption></figure><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/021b947d98d48df0963ba3065afe7e78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zNQ24jkKkNtCzD4_gV3fHg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">列出check_fan目录(ls -altr)的内容表明存在fancontrol.sh，因此使用cat命令检查fancontrol.sh的内容。这表明访问了/usr/local/bin目录中的fancontrol.py</figcaption></figure><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kd"><img src="../Images/808c99214f2e4bfa363e823d77653922.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JHo6c3O8Yvc0g1rvRin3eQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">使用cd命令将目录切换到/usr/local/bin目录，并使用ls -altr列出内容，这表明存在fancontrol.py文件</figcaption></figure><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ke"><img src="../Images/1da811381f021450c2cb14bbbae2acbf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9OlyGySwMKV-K6ZFXwe01g.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">输入nano fancontrol.py编辑该文件</figcaption></figure><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kf"><img src="../Images/e1dda935839b8d7f4ca77b7d5e53b2ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iySFpeZ1oNxQvEF1Lw_YLg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">您需要更改的值以红色突出显示。我将ON_THRESHOLD设置为50，OFF_THRESHOLD设置为40。保存您的更改并退出该文件</figcaption></figure><p id="f622" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">就是这样！完成了。由于我们已经在<a class="ae iu" href="https://howchoo.com/g/ote2mjkzzta/control-raspberry-pi-fan-temperature-python" rel="noopener ugc nofollow" target="_blank">的步骤4中使用了安装程序脚本https://how choo . com/g/ote 2 mjkzzta/control-raspberry-pi-fan-temperature-python</a>它已经被注册为在引导时运行。</p><p id="6e1b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">使用以下命令重新启动Raspberry Pi:</p><pre class="ju jv jw jx fd kg kh ki kj aw kk bi"><span id="ef78" class="kl km hi kh b fi kn ko l kp kq">sudo reboot</span></pre><p id="7cd7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这将重新启动您的Pi和您的风扇应该动态运行。</p><p id="2cd4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">是时候测试它了…</p><ol class=""><li id="1b64" class="kr ks hi ix b iy iz jc jd jg kt jk ku jo kv js kw kx ky kz bi translated">访问check_fan目录，并在nano中创建一个名为measure_temp.py的文件</li><li id="52df" class="kr ks hi ix b iy la jc lb jg lc jk ld jo le js kw kx ky kz bi translated">将此复制/粘贴到文件中:</li></ol><pre class="ju jv jw jx fd kg kh ki kj aw kk bi"><span id="81b1" class="kl km hi kh b fi kn ko l kp kq">#!/bin/bash</span><span id="78be" class="kl km hi kh b fi lf ko l kp kq">while [ true ]</span><span id="9300" class="kl km hi kh b fi lf ko l kp kq">do</span><span id="8a9e" class="kl km hi kh b fi lf ko l kp kq">myTemp=`/opt/vc/bin/vcgencmd measure_temp | egrep -o '[0-9]*\.[0-9]*'`</span><span id="66ad" class="kl km hi kh b fi lf ko l kp kq">myDate=`date '+%Y/%m/%d %H:%M:%S'`</span><span id="0b67" class="kl km hi kh b fi lf ko l kp kq">echo $myTemp $myDate</span><span id="f5d2" class="kl km hi kh b fi lf ko l kp kq">sleep 3</span><span id="54e5" class="kl km hi kh b fi lf ko l kp kq">done</span></pre><p id="9e5a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">3.使用ctrl+z键保存文件并退出</p><p id="c023" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">4.通过键入以下命令给出文件的可执行属性:</p><pre class="ju jv jw jx fd kg kh ki kj aw kk bi"><span id="c195" class="kl km hi kh b fi kn ko l kp kq">chmod +x measure_temp.py</span></pre><p id="f355" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">5.运行以上脚本:</p><pre class="ju jv jw jx fd kg kh ki kj aw kk bi"><span id="b581" class="kl km hi kh b fi kn ko l kp kq">./measure_temp.py</span></pre><p id="7f2d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">当温度上升到51度以上时，风扇启动，温度下降到40度，之后风扇关闭。</p><p id="07dc" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这样你就有了一个便宜的风扇和一个脚本来动态控制你的Raspberry Pi的风扇。如果您有任何问题、顾虑或意见，请留下评论。如果你成功地复制了这个，并且对你有效，请鼓掌… :-)</p></div></div>    
</body>
</html>