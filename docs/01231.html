<html>
<head>
<title>Stock Prediction using Regression Algorithm in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中回归算法的股票预测</h1>
<blockquote>原文：<a href="https://medium.com/codex/stock-predication-using-regression-algorithm-in-python-fb8b426453b9?source=collection_archive---------0-----------------------#2021-04-13">https://medium.com/codex/stock-predication-using-regression-algorithm-in-python-fb8b426453b9?source=collection_archive---------0-----------------------#2021-04-13</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/12ca6ae350458a949768f97615ce1ced.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*28n7dXgjFGxORG3b"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated"><a class="ae hv" href="https://unsplash.com/@m_b_m?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> M. B. M. </a>在<a class="ae hv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><div class=""/><div class=""><h2 id="d279" class="pw-subtitle-paragraph iv hx hy bd b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm dx translated">使用ML算法预测股票价格的端到端解释</h2></div><p id="79f5" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在这个练习中，我将使用Yfinance库来删除雅虎财经网站上的信息，雅虎财经是一个很好的网站，可以快速浏览你正在寻找的公司的上市股票、基金和投资数据。此外，我将通过对数据进行回归模型分析来测试和预测某些参数和股票价格。</p><h1 id="41b4" class="kj kk hy bd kl km kn ko kp kq kr ks kt je ku jf kv jh kw ji kx jk ky jl kz la bi translated">导入所有必需的库</h1><p id="ca1c" class="pw-post-body-paragraph jn jo hy jp b jq lb iz js jt lc jc jv jw ld jy jz ka le kc kd ke lf kg kh ki hb bi translated">首先，我们将成功执行这个练习所需的库。这里要调用和关注的主要库是yfinance。这个库将使我们能够从雅虎网站提取和调用不同的数据</p><p id="1e41" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在[1]中:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="934e" class="lp kk hy ll b fi lq lr l ls lt">!pip install yfinance</span><span id="ab66" class="lp kk hy ll b fi lu lr l ls lt">Collecting yfinance<br/>  Downloading yfinance-0.1.59.tar.gz (25 kB)<br/>Requirement already satisfied: pandas&gt;=0.24 in /opt/conda/lib/python3.7/site-packages (from yfinance) (1.2.2)<br/>Requirement already satisfied: numpy&gt;=1.15 in /opt/conda/lib/python3.7/site-packages (from yfinance) (1.19.5)<br/>Requirement already satisfied: requests&gt;=2.20 in /opt/conda/lib/python3.7/site-packages (from yfinance) (2.25.1)<br/>Collecting multitasking&gt;=0.0.7<br/>  Downloading multitasking-0.0.9.tar.gz (8.1 kB)<br/>Requirement already satisfied: lxml&gt;=4.5.1 in /opt/conda/lib/python3.7/site-packages (from yfinance) (4.6.3)<br/>Requirement already satisfied: python-dateutil&gt;=2.7.3 in /opt/conda/lib/python3.7/site-packages (from pandas&gt;=0.24-&gt;yfinance) (2.8.1)<br/>Requirement already satisfied: pytz&gt;=2017.3 in /opt/conda/lib/python3.7/site-packages (from pandas&gt;=0.24-&gt;yfinance) (2021.1)<br/>Requirement already satisfied: six&gt;=1.5 in /opt/conda/lib/python3.7/site-packages (from python-dateutil&gt;=2.7.3-&gt;pandas&gt;=0.24-&gt;yfinance) (1.15.0)<br/>Requirement already satisfied: urllib3&lt;1.27,&gt;=1.21.1 in /opt/conda/lib/python3.7/site-packages (from requests&gt;=2.20-&gt;yfinance) (1.26.3)<br/>Requirement already satisfied: idna&lt;3,&gt;=2.5 in /opt/conda/lib/python3.7/site-packages (from requests&gt;=2.20-&gt;yfinance) (2.10)<br/>Requirement already satisfied: certifi&gt;=2017.4.17 in /opt/conda/lib/python3.7/site-packages (from requests&gt;=2.20-&gt;yfinance) (2020.12.5)<br/>Requirement already satisfied: chardet&lt;5,&gt;=3.0.2 in /opt/conda/lib/python3.7/site-packages (from requests&gt;=2.20-&gt;yfinance) (3.0.4)<br/>Building wheels for collected packages: yfinance, multitasking<br/>  Building wheel for yfinance (setup.py) ... - \ done<br/>  Created wheel for yfinance: filename=yfinance-0.1.59-py2.py3-none-any.whl size=23442 sha256=33c81ce98e6e86be0df9c086ce8b9f54138a14a1079c79d74003a7cfc00b8974<br/>  Stored in directory: /root/.cache/pip/wheels/26/af/8b/fac1b47dffef567f945641cdc9b67bb25fae5725d462a8cf81<br/>  Building wheel for multitasking (setup.py) ... - done<br/>  Created wheel for multitasking: filename=multitasking-0.0.9-py3-none-any.whl size=8368 sha256=c14a0494e534aacbc1170fdaed133fb002cae59c00456e90086fe6970f5dd186<br/>  Stored in directory: /root/.cache/pip/wheels/ae/25/47/4d68431a7ec1b6c4b5233365934b74c1d4e665bf5f968d363a<br/>Successfully built yfinance multitasking<br/>Installing collected packages: multitasking, yfinance<br/>Successfully installed multitasking-0.0.9 yfinance-0.1.59</span></pre><p id="c484" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在[2]中:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="cb77" class="lp kk hy ll b fi lq lr l ls lt"><em class="lv"># Let's start with calling all dependencies that we will use for this exercise </em><br/>import pandas as pd<br/>import numpy as np<br/>import math <br/>import seaborn as sns <br/>import matplotlib.pyplot as plt<br/>from sklearn import metrics<br/>from sklearn.model_selection import train_test_split<br/>import yfinance as yf  <em class="lv"># We will use this library to upload latest data from Yahoo API</em><br/>%matplotlib inline<br/>plt.style.use('fivethirtyeight')</span></pre><h1 id="97d2" class="kj kk hy bd kl km kn ko kp kq kr ks kt je ku jf kv jh kw ji kx jk ky jl kz la bi translated">数据收集和探索</h1><p id="72c8" class="pw-post-body-paragraph jn jo hy jp b jq lb iz js jt lc jc jv jw ld jy jz ka le kc kd ke lf kg kh ki hb bi translated">在本节中，我们将使用某些方法调用与公司描述、股票价格、收盘价、交易量以及与股票相关的公司行为相关的数据。</p><p id="4dfa" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在[3]中:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="e39a" class="lp kk hy ll b fi lq lr l ls lt"><em class="lv"># define the ticker you will use</em><br/>nio = yf.Ticker('NIO')<br/><em class="lv">#Display stock information, it will give you a summary description of the ticker</em><br/>nio.info</span></pre><p id="1122" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">Out[3]:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="ebbf" class="lp kk hy ll b fi lq lr l ls lt">{'zip': '201804',<br/> 'sector': 'Consumer Cyclical',<br/> 'fullTimeEmployees': 7763,<br/> 'longBusinessSummary': 'NIO Inc. designs, develops, manufactures, and sells smart electric vehicles in Mainland China, Hong Kong, the United States, the United Kingdom, and Germany. The company offers five, six, and seven-seater electric SUVs, as well as smart electric sedans. It is also involved in the provision of energy and service packages to its users; marketing, design, and technology development activities; manufacture of e-powertrains, battery packs, and components; and sales and after sales management activities. In addition, the company offers power solutions, including Power Home, a home charging solution; Power Swap, a battery swapping service; Public Charger, a public fast charging solution; Power Mobile, a mobile charging service through charging vans; Power Map, an application that provides access to a network of public chargers and their real-time information; and One Click for Power valet service, where it offers vehicle pick up, charging, and return services. Further, it provides repair, maintenance, and bodywork services through its NIO service centers and authorized third-party service centers; statutory and third-party liability insurance, and vehicle damage insurance through third-party insurers; courtesy car services; and roadside assistance, as well as data packages; and auto financing services. Additionally, the company offers NIO Certified, an used vehicle inspection, evaluation, acquisition, and sales service. NIO Inc. has a strategic collaboration with Mobileye N.V. for the development of automated and autonomous vehicles for consumer markets. The company was formerly known as NextEV Inc. and changed its name to NIO Inc. in July 2017. NIO Inc. was founded in 2014 and is headquartered in Shanghai, China.',<br/> 'city': 'Shanghai',<br/> 'phone': '86 21 6908 2018',<br/> 'country': 'China',<br/> 'companyOfficers': [],<br/> 'website': 'http://www.nio.com',<br/> 'maxAge': 1,<br/> 'address1': 'Building 20',<br/> 'industry': 'Auto Manufacturers',<br/> 'address2': 'No. 56 AnTuo Road Anting Town Jiading District',<br/> 'previousClose': 38.12,<br/> 'regularMarketOpen': 37.96,<br/> 'twoHundredDayAverage': 43.683704,<br/> 'trailingAnnualDividendYield': None,<br/> 'payoutRatio': 0,<br/> 'volume24Hr': None,<br/> 'regularMarketDayHigh': 38,<br/> 'navPrice': None,<br/> 'averageDailyVolume10Day': 70446940,<br/> 'totalAssets': None,<br/> 'regularMarketPreviousClose': 38.12,<br/> 'fiftyDayAverage': 41.888824,<br/> 'trailingAnnualDividendRate': None,<br/> 'open': 37.96,<br/> 'toCurrency': None,<br/> 'averageVolume10days': 70446940,<br/> 'expireDate': None,<br/> 'yield': None,<br/> 'algorithm': None,<br/> 'dividendRate': None,<br/> 'exDividendDate': None,<br/> 'beta': 2.613181,<br/> 'circulatingSupply': None,<br/> 'startDate': None,<br/> 'regularMarketDayLow': 36.76,<br/> 'priceHint': 2,<br/> 'currency': 'USD',<br/> 'regularMarketVolume': 52839807,<br/> 'lastMarket': None,<br/> 'maxSupply': None,<br/> 'openInterest': None,<br/> 'marketCap': 60854632448,<br/> 'volumeAllCurrencies': None,<br/> 'strikePrice': None,<br/> 'averageVolume': 97445091,<br/> 'priceToSalesTrailing12Months': 3.743073,<br/> 'dayLow': 36.76,<br/> 'ask': 37.43,<br/> 'ytdReturn': None,<br/> 'askSize': 3000,<br/> 'volume': 52839807,<br/> 'fiftyTwoWeekHigh': 66.99,<br/> 'forwardPE': -371.4,<br/> 'fromCurrency': None,<br/> 'fiveYearAvgDividendYield': None,<br/> 'fiftyTwoWeekLow': 2.88,<br/> 'bid': 37.21,<br/> 'tradeable': False,<br/> 'dividendYield': None,<br/> 'bidSize': 1400,<br/> 'dayHigh': 38,<br/> 'exchange': 'NYQ',<br/> 'shortName': 'NIO Inc.',<br/> 'longName': 'NIO Inc.',<br/> 'exchangeTimezoneName': 'America/New_York',<br/> 'exchangeTimezoneShortName': 'EDT',<br/> 'isEsgPopulated': False,<br/> 'gmtOffSetMilliseconds': '-14400000',<br/> 'quoteType': 'EQUITY',<br/> 'symbol': 'NIO',<br/> 'messageBoardId': 'finmb_311626862',<br/> 'market': 'us_market',<br/> 'annualHoldingsTurnover': None,<br/> 'enterpriseToRevenue': 2.107,<br/> 'beta3Year': None,<br/> 'profitMargins': -0.34511003,<br/> 'enterpriseToEbitda': -9.618,<br/> '52WeekChange': 11.664452,<br/> 'morningStarRiskRating': None,<br/> 'forwardEps': -0.1,<br/> 'revenueQuarterlyGrowth': None,<br/> 'sharesOutstanding': 1638520064,<br/> 'fundInceptionDate': None,<br/> 'annualReportExpenseRatio': None,<br/> 'bookValue': 17.315,<br/> 'sharesShort': 65406021,<br/> 'sharesPercentSharesOut': 0.0399,<br/> 'fundFamily': None,<br/> 'lastFiscalYearEnd': 1609372800,<br/> 'heldPercentInstitutions': 0.36421,<br/> 'netIncomeToCommon': -5610789888,<br/> 'trailingEps': -0.724,<br/> 'lastDividendValue': None,<br/> 'SandP52WeekChange': 0.45070732,<br/> 'priceToBook': 2.1449609,<br/> 'heldPercentInsiders': 0.00533,<br/> 'nextFiscalYearEnd': 1672444800,<br/> 'mostRecentQuarter': 1609372800,<br/> 'shortRatio': 0.53,<br/> 'sharesShortPreviousMonthDate': 1614297600,<br/> 'floatShares': 1327183283,<br/> 'enterpriseValue': 34251128832,<br/> 'threeYearAverageReturn': None,<br/> 'lastSplitDate': None,<br/> 'lastSplitFactor': None,<br/> 'legalType': None,<br/> 'lastDividendDate': None,<br/> 'morningStarOverallRating': None,<br/> 'earningsQuarterlyGrowth': None,<br/> 'dateShortInterest': 1617148800,<br/> 'pegRatio': 4298.73,<br/> 'lastCapGain': None,<br/> 'shortPercentOfFloat': None,<br/> 'sharesShortPriorMonth': 48084071,<br/> 'impliedSharesOutstanding': None,<br/> 'category': None,<br/> 'fiveYearAverageReturn': None,<br/> 'regularMarketPrice': 37.14,<br/> 'logo_url': 'https://logo.clearbit.com/nio.com'}</span></pre><h1 id="18f0" class="kj kk hy bd kl km kn ko kp kq kr ks kt je ku jf kv jh kw ji kx jk ky jl kz la bi translated">回归分析的数据准备和清理</h1><p id="df98" class="pw-post-body-paragraph jn jo hy jp b jq lb iz js jt lc jc jv jw ld jy jz ka le kc kd ke lf kg kh ki hb bi translated">来自Yahoo Finance的数据简单明了，反映了股票市场的实时数据，因此清理和处理导出的数据并不是一项困难的任务。</p><p id="81d5" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在[4]中:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="7c00" class="lp kk hy ll b fi lq lr l ls lt">history = nio.history(period="Max")<br/>df = pd.DataFrame(history)<br/>df.head(10)</span></pre><p id="5eb3" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">Out[4]:</p><figure class="lg lh li lj fd hk er es paragraph-image"><div class="er es lw"><img src="../Images/93fddeb3b063f8ceea3c3cf56d61578e.png" data-original-src="https://miro.medium.com/v2/resize:fit:966/format:webp/1*LdTR4h7nYNu-Va8pRakWGw.png"/></div></figure><p id="b9a4" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在[5]中:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="8c98" class="lp kk hy ll b fi lq lr l ls lt"><em class="lv"># defining x and y </em><br/>x = df.index<br/>y = df['Close']<br/>y</span></pre><p id="c1b5" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">Out[5]:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="cf12" class="lp kk hy ll b fi lq lr l ls lt">Date<br/>2018-09-12     6.600000<br/>2018-09-13    11.600000<br/>2018-09-14     9.900000<br/>2018-09-17     8.500000<br/>2018-09-18     7.680000<br/>                ...    <br/>2021-04-06    40.000000<br/>2021-04-07    37.270000<br/>2021-04-08    38.700001<br/>2021-04-09    38.119999<br/>2021-04-12    37.139999<br/>Name: Close, Length: 649, dtype: float64</span></pre><p id="5315" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在[6]中:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="4a74" class="lp kk hy ll b fi lq lr l ls lt"><em class="lv"># Data Exploration</em><br/><em class="lv"># i like to set up a plot function so i can reuse it at later stages of this analysis </em><br/>def df_plot(data, x, y, title="", xlabel='Date', ylabel='Value', dpi=100):<br/>    plt.figure(figsize=(16,5), dpi=dpi)<br/>    plt.plot(x, y, color='tab:red')<br/>    plt.gca().set(title=title, xlabel=xlabel, ylabel=ylabel)<br/>    plt.show()</span></pre><p id="08b6" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在[7]中:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="0a6e" class="lp kk hy ll b fi lq lr l ls lt">stock_name= "NIO"<br/>title = (stock_name,"History stock performance till date")<br/>df_plot(df , x , y , title=title,xlabel='Date', ylabel='Value',dpi=100)</span></pre><figure class="lg lh li lj fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lx"><img src="../Images/23445c429e8a31eab430adfbca53b88b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*kb-5PMUOphLb3wbJ.png"/></div></div></figure><p id="a354" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在[8]中:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="69bb" class="lp kk hy ll b fi lq lr l ls lt"><em class="lv"># Data Processing and scaling</em><br/>df.reset_index(inplace=True) <em class="lv"># to reset index and convert it to column</em></span></pre><p id="0c33" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在[9]中:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="522a" class="lp kk hy ll b fi lq lr l ls lt">df.head(2)</span></pre><p id="7b33" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">Out[9]:</p><figure class="lg lh li lj fd hk er es paragraph-image"><div class="er es ly"><img src="../Images/7fe08e551cbd16799ea1c0e34ec52575.png" data-original-src="https://miro.medium.com/v2/resize:fit:988/format:webp/1*OHDt0YdhLvEAZwPUfiCGqw.png"/></div></figure><p id="367b" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在[10]中:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="9637" class="lp kk hy ll b fi lq lr l ls lt">df.columns ['date','open','high','low','close','vol','divs','split']</span></pre><p id="3c92" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在[11]中:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="3482" class="lp kk hy ll b fi lq lr l ls lt">df.drop(columns=['divs','split']).head(2) <em class="lv"># We are dropping un necessary columns from the set</em></span></pre><p id="b9f8" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">Out[11]:</p><figure class="lg lh li lj fd hk er es paragraph-image"><div class="er es lz"><img src="../Images/e55f9f50c1ebffbe7f3ff21a9ec4e52c.png" data-original-src="https://miro.medium.com/v2/resize:fit:696/format:webp/1*5otC-RXdtpm_1ocoZlD_qA.png"/></div></figure><p id="a977" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在[12]中:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="c8ce" class="lp kk hy ll b fi lq lr l ls lt">df['date'] = pd.to_datetime(df.date)</span></pre><p id="8148" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在[13]中:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="d2c0" class="lp kk hy ll b fi lq lr l ls lt">df.describe()</span></pre><p id="7ca9" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">Out[13]:</p><figure class="lg lh li lj fd hk er es paragraph-image"><div class="er es ma"><img src="../Images/16a2cda16ce6dfaaec287b8314cdcb89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1070/format:webp/1*Rhlz25Q4osovPWVTg5X4Eg.png"/></div></figure><p id="a31e" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在[14]中:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="7438" class="lp kk hy ll b fi lq lr l ls lt">print(len(df))</span><span id="f91c" class="lp kk hy ll b fi lu lr l ls lt">649</span></pre><p id="b1d1" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在[15]中:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="2138" class="lp kk hy ll b fi lq lr l ls lt">x = df[['open', 'high','low', 'vol']]<br/>y = df['close']</span></pre><h1 id="e775" class="kj kk hy bd kl km kn ko kp kq kr ks kt je ku jf kv jh kw ji kx jk ky jl kz la bi translated">数据分割</h1><p id="8cb7" class="pw-post-body-paragraph jn jo hy jp b jq lb iz js jt lc jc jv jw ld jy jz ka le kc kd ke lf kg kh ki hb bi translated">对于这些数据，我将数据分为训练数据集和测试数据集，测试规模占总数据集的15%。之后，我们可以使用shape()方法简单地检查数据是否被成功分割。</p><p id="906c" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在[16]中:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="5bd0" class="lp kk hy ll b fi lq lr l ls lt"><em class="lv"># Linear regression Model for stock prediction </em><br/>train_x, test_x, train_y, test_y = train_test_split(x, y, test_size=0.15 , shuffle=False,random_state = 0)</span></pre><p id="0cdd" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在[17]中:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="e3d7" class="lp kk hy ll b fi lq lr l ls lt"><em class="lv"># let's check if total observation makes sense</em><br/>print(train_x.shape )<br/>print(test_x.shape)<br/>print(train_y.shape)<br/>print(test_y.shape)</span><span id="d2a1" class="lp kk hy ll b fi lu lr l ls lt">(551, 4)<br/>(98, 4)<br/>(551,)<br/>(98,)</span></pre><h1 id="9b27" class="kj kk hy bd kl km kn ko kp kq kr ks kt je ku jf kv jh kw ji kx jk ky jl kz la bi translated">回归算法模型实现</h1><p id="4be3" class="pw-post-body-paragraph jn jo hy jp b jq lb iz js jt lc jc jv jw ld jy jz ka le kc kd ke lf kg kh ki hb bi translated">在我们开始对数据集实现回归模型的技术部分之前，让我们谈一谈回归算法。基本上，回归是一套估计关系的技术。例如，在现实生活中，我们可以将拉伸弹簧的力与弹簧拉伸的距离联系起来(类似于胡克定律)，或者解释随着时间的推移，半导体行业可以在电路中装入多少晶体管(摩尔定律)。</p><h1 id="941f" class="kj kk hy bd kl km kn ko kp kq kr ks kt je ku jf kv jh kw ji kx jk ky jl kz la bi translated"><strong class="ak">回归算法的类型</strong></h1><p id="6eb0" class="pw-post-body-paragraph jn jo hy jp b jq lb iz js jt lc jc jv jw ld jy jz ka le kc kd ke lf kg kh ki hb bi translated">显然机器学习中有很多回归算法，比如线性回归、逻辑回归和Lasso回归算法:</p><h1 id="b37f" class="kj kk hy bd kl km kn ko kp kq kr ks kt je ku jf kv jh kw ji kx jk ky jl kz la bi translated"><strong class="ak">线性回归</strong></h1><p id="d4cb" class="pw-post-body-paragraph jn jo hy jp b jq lb iz js jt lc jc jv jw ld jy jz ka le kc kd ke lf kg kh ki hb bi translated">线性回归是一种监督学习算法，它根据给定的自变量预测因变量或目标，所以基本上你找到了因变量和自变量之间的关系。</p><h1 id="6c11" class="kj kk hy bd kl km kn ko kp kq kr ks kt je ku jf kv jh kw ji kx jk ky jl kz la bi translated"><strong class="ak">逻辑回归</strong></h1><p id="17db" class="pw-post-body-paragraph jn jo hy jp b jq lb iz js jt lc jc jv jw ld jy jz ka le kc kd ke lf kg kh ki hb bi translated">逻辑回归算法是另一种监督算法，用于描述数据并解释一个因变量和一个或多个自变量之间的关系。使用该算法的输出不是0就是1。</p><p id="a520" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在我们的例子中，我们将使用线性回归算法来预测这些股票价格</p><p id="8b66" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">线性回归的方程式可以写成如下:</p><p id="ac48" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在[18]中:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="9a51" class="lp kk hy ll b fi lq lr l ls lt">import os<br/>from IPython.display import Image<br/>print("**Linear Regression Formula**")<br/>Image(filename="../input/stock-prediction-using-regression-algorithm/1.JPG", width= 250, height=100)</span><span id="5aba" class="lp kk hy ll b fi lu lr l ls lt">**Linear Regression Formula**</span></pre><p id="16ff" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">Out[18]:</p><figure class="lg lh li lj fd hk er es paragraph-image"><div class="er es mb"><img src="../Images/4b0c8c63d1ddbe1588fdf507ac554edf.png" data-original-src="https://miro.medium.com/v2/resize:fit:474/format:webp/0*LCOajeibczl2gQ-A.jpg"/></div></figure><p id="4860" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">也</p><p id="80cc" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在[19]中:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="29d4" class="lp kk hy ll b fi lq lr l ls lt">print("**Regression Formula**")<br/>Image(filename="../input/stock-prediction-using-regression-algorithm/2.JPG", width= 280, height=110)</span><span id="6235" class="lp kk hy ll b fi lu lr l ls lt">**Regression Formula**</span></pre><p id="7c50" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">Out[19]:</p><figure class="lg lh li lj fd hk er es paragraph-image"><div class="er es mc"><img src="../Images/1357e77cf3534255a62f268d61c4e1c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:876/format:webp/0*F1Dr3rpVL04tc4I6.jpg"/></div></figure><p id="43eb" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">其中，x1，x2，…xn代表自变量，而系数θ1、θ2、θn代表权重。</p><p id="756b" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在[20]中:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="7327" class="lp kk hy ll b fi lq lr l ls lt">from sklearn.linear_model import LinearRegression<br/>from sklearn.metrics import confusion_matrix, accuracy_score<br/>regression = LinearRegression()<br/>regression.fit(train_x, train_y)<br/>print("regression coefficient",regression.coef_)<br/>print("regression intercept",regression.intercept_)</span><span id="9624" class="lp kk hy ll b fi lu lr l ls lt">regression coefficient [-6.51840470e-01  8.48419125e-01  8.12048390e-01 -3.50557805e-10]<br/>regression intercept -0.0315814559475216</span></pre><h1 id="6a98" class="kj kk hy bd kl km kn ko kp kq kr ks kt je ku jf kv jh kw ji kx jk ky jl kz la bi translated">预测和估计</h1><h1 id="aa01" class="kj kk hy bd kl km kn ko kp kq kr ks kt je ku jf kv jh kw ji kx jk ky jl kz la bi translated">决定系数R</h1><p id="a170" class="pw-post-body-paragraph jn jo hy jp b jq lb iz js jt lc jc jv jw ld jy jz ka le kc kd ke lf kg kh ki hb bi translated">在这里，我们将计算由R表示的决定系数，其取值在0和1之间，R值越高，线性回归在解释Y值的变化方面越成功，在我们的情况下，Y值代表受调查公司的收盘价。下面是决定系数R背后的数学公式</p><p id="8e0c" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在[21]中:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="a02e" class="lp kk hy ll b fi lq lr l ls lt">print("**List of equations**")<br/>Image(filename="../input/stock-prediction-using-regression-algorithm/3.JPG", width= 400, height=250)</span><span id="e2a9" class="lp kk hy ll b fi lu lr l ls lt">**List of equations**</span></pre><p id="e2d2" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">Out[21]:</p><figure class="lg lh li lj fd hk er es paragraph-image"><div class="er es md"><img src="../Images/7b68ef18b6f65080e5c965799ec2ff5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/0*Q9uDuUWzhBoOjRGc.jpg"/></div></figure><p id="c69e" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在[22]中:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="5893" class="lp kk hy ll b fi lq lr l ls lt"><em class="lv"># the coefficient of determination R² </em><br/>regression_confidence = regression.score(test_x, test_y)<br/>print("linear regression confidence: ", regression_confidence)</span><span id="31d2" class="lp kk hy ll b fi lu lr l ls lt">linear regression confidence:  0.9836914831421212</span></pre><p id="2015" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">我们数据的决定系数R为0.98，即98%，这意味着我们的模型是一个线性模型，可以解释所有Y值的变化。</p><h1 id="ce78" class="kj kk hy bd kl km kn ko kp kq kr ks kt je ku jf kv jh kw ji kx jk ky jl kz la bi translated">预言；预测；预告</h1><p id="68e4" class="pw-post-body-paragraph jn jo hy jp b jq lb iz js jt lc jc jv jw ld jy jz ka le kc kd ke lf kg kh ki hb bi translated">正如我们在下面看到的，来自开盘、盘高、盘低和成交量的预测数据点列表并没有根据时间或日期进行排序，此时对这些数据点进行排序并不重要，因为我们将使用散点图()方法根据它们的相关日期进行绘图。</p><p id="b528" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在[23]中:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="4acd" class="lp kk hy ll b fi lq lr l ls lt">predicted=regression.predict(test_x)<br/>print(test_x.head())</span><span id="ffc7" class="lp kk hy ll b fi lu lr l ls lt">open       high        low        vol<br/>551  45.750000  46.720001  42.500000  271678300<br/>552  45.360001  48.919998  44.680000  233779100<br/>553  48.270000  50.590000  47.880001  209106300<br/>554  50.860001  55.700001  50.480000  270203000<br/>555  56.990002  57.200001  51.500000  243669700</span></pre><p id="2a0c" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在[24]中:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="d5db" class="lp kk hy ll b fi lq lr l ls lt">predicted.shape</span></pre><p id="f846" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">Out[24]:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="edf5" class="lp kk hy ll b fi lq lr l ls lt">(98,)</span></pre><h1 id="f6ec" class="kj kk hy bd kl km kn ko kp kq kr ks kt je ku jf kv jh kw ji kx jk ky jl kz la bi translated">实际价格与预测值的预测表</h1><p id="1324" class="pw-post-body-paragraph jn jo hy jp b jq lb iz js jt lc jc jv jw ld jy jz ka le kc kd ke lf kg kh ki hb bi translated">在[25]中:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="d4ea" class="lp kk hy ll b fi lq lr l ls lt">dfr=pd.DataFrame({'Actual_Price':test_y, 'Predicted_Price':predicted})<br/>dfr.head(10)</span></pre><p id="92c3" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">Out[25]:</p><figure class="lg lh li lj fd hk er es paragraph-image"><div class="er es me"><img src="../Images/789284ff68eecb04c8e496ae5ce0ea50.png" data-original-src="https://miro.medium.com/v2/resize:fit:522/format:webp/1*o6hRMLlH7A9TTT02ZWnVUA.png"/></div></figure><p id="3878" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">下表显示了数据集的实际值与预测值的汇总统计值</p><p id="27c8" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在[26]中:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="dcf4" class="lp kk hy ll b fi lq lr l ls lt">dfr.describe()</span></pre><p id="a7ef" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">Out[26]:</p><figure class="lg lh li lj fd hk er es paragraph-image"><div class="er es mf"><img src="../Images/fcadb2ec16559f73a3c214aa9746dc47.png" data-original-src="https://miro.medium.com/v2/resize:fit:528/format:webp/1*2ODP8AJFLbM2QGhDuDDW4A.png"/></div></figure><h1 id="ea69" class="kj kk hy bd kl km kn ko kp kq kr ks kt je ku jf kv jh kw ji kx jk ky jl kz la bi translated">模型评估</h1><p id="bed7" class="pw-post-body-paragraph jn jo hy jp b jq lb iz js jt lc jc jv jw ld jy jz ka le kc kd ke lf kg kh ki hb bi translated">MAE和RMSE是最常见的统计指标，用于测量连续变量，或者在我们的情况下，我们的回归模型的准确性。</p><p id="b0dc" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">这两个模型背后的数学可能会令人困惑或有点难以理解其含义，但请以这种简单的方式思考一下，我们有实际的股票收盘价和预测的股票价格，它们是根据我们讨论过的相同的实际股票价格计算的，现在我们需要计算它们之间的误差或差异，以查看这些预测与手头的实际值相比有多准确。</p><h1 id="4a37" class="kj kk hy bd kl km kn ko kp kq kr ks kt je ku jf kv jh kw ji kx jk ky jl kz la bi translated">平均绝对误差(MAE):</h1><p id="11b4" class="pw-post-body-paragraph jn jo hy jp b jq lb iz js jt lc jc jv jw ld jy jz ka le kc kd ke lf kg kh ki hb bi translated">MAE测量一组预测中误差的平均大小，不考虑它们的方向。</p><p id="5c82" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在[27]中:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="9807" class="lp kk hy ll b fi lq lr l ls lt">print("**Mean Absolute Error (MAE)**")<br/>Image(filename="../input/stock-prediction-using-regression-algorithm/4.JPG", width= 400, height=250)</span><span id="5740" class="lp kk hy ll b fi lu lr l ls lt">**Mean Absolute Error (MAE)**</span></pre><p id="1b67" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">Out[27]:</p><figure class="lg lh li lj fd hk er es paragraph-image"><div class="er es mg"><img src="../Images/4d5deac9363e049cf2a0b37a3db64593.png" data-original-src="https://miro.medium.com/v2/resize:fit:812/format:webp/0*OgNQXZ3juR5lPm2W.jpg"/></div></figure><h1 id="0f67" class="kj kk hy bd kl km kn ko kp kq kr ks kt je ku jf kv jh kw ji kx jk ky jl kz la bi translated">均方根误差(RMSE):</h1><p id="87af" class="pw-post-body-paragraph jn jo hy jp b jq lb iz js jt lc jc jv jw ld jy jz ka le kc kd ke lf kg kh ki hb bi translated">RMSE是一个二次评分规则，也衡量误差的平均幅度。</p><p id="b69d" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在[28]中:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="c6a2" class="lp kk hy ll b fi lq lr l ls lt">print("**Root mean squared error (RMSE)**")<br/>Image(filename="../input/stock-prediction-using-regression-algorithm/5.JPG", width= 400, height=250)</span><span id="fe29" class="lp kk hy ll b fi lu lr l ls lt">**Root mean squared error (RMSE)**</span></pre><p id="e839" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">Out[28]:</p><figure class="lg lh li lj fd hk er es paragraph-image"><div class="er es mh"><img src="../Images/420d8bfe674857ba070dcb76ccb12f8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:862/format:webp/0*owl-1PIXE9bMYhVw.jpg"/></div></figure><h1 id="57db" class="kj kk hy bd kl km kn ko kp kq kr ks kt je ku jf kv jh kw ji kx jk ky jl kz la bi translated">均方差(MSE):</h1><p id="67bc" class="pw-post-body-paragraph jn jo hy jp b jq lb iz js jt lc jc jv jw ld jy jz ka le kc kd ke lf kg kh ki hb bi translated">在[29]中:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="aabd" class="lp kk hy ll b fi lq lr l ls lt">print("** Mean squared error (MSE)**")<br/>Image(filename="../input/stock-prediction-using-regression-algorithm/6.JPG", width= 400, height=250)</span><span id="c689" class="lp kk hy ll b fi lu lr l ls lt">** Mean squared error (MSE)**</span></pre><p id="a378" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">Out[29]:</p><figure class="lg lh li lj fd hk er es paragraph-image"><div class="er es mi"><img src="../Images/e8ee27df3fc7e54ff0484506b2d6e875.png" data-original-src="https://miro.medium.com/v2/resize:fit:894/format:webp/0*XKakid1rOSZRRyDm.jpg"/></div></figure><p id="ecbc" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">MSE均方误差(MSE)衡量误差平方的平均值，即估计值和实际值之间的平均平方差。MSE是一个风险函数，对应于平方误差损失的期望值。</p><p id="868b" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">上面提到的所有指标的范围可以从0到∞并且与误差的方向无关。它们是负向的分数，这意味着它们呈现的值越低越好。请记住，RMSE的值总是比MSE大，而且它可以惩罚更多与错误相关的数据，因此RMSE可能是比MSE更好的衡量标准。</p><p id="ef04" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在我们的案例中，我们的评估结果如下:</p><p id="af4d" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在[30]中:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="25da" class="lp kk hy ll b fi lq lr l ls lt">print('Mean Absolute Error (MAE):', metrics.mean_absolute_error(test_y, predicted))<br/>print('Mean Squared Error (MSE) :', metrics.mean_squared_error(test_y, predicted))<br/>print('Root Mean Squared Error (RMSE):', np.sqrt(metrics.mean_squared_error(test_y, predicted)))</span><span id="4bfa" class="lp kk hy ll b fi lu lr l ls lt">Mean Absolute Error (MAE): 0.7581175544856527<br/>Mean Squared Error (MSE) : 1.001586723642404<br/>Root Mean Squared Error (RMSE): 1.000793047359145</span></pre><p id="96c7" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">我们所有的度量结果都显示小于1的值，从解释的角度来看，我认为对于线性问题，MAE是比RMSE更好的度量，因为RMSE不仅仅描述平均误差，还有其他更难梳理和理解的含义。此外，RMSE更加重视大的误差，所以模型会尽可能地减少这些误差。</p><p id="e480" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在[31]中:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="1165" class="lp kk hy ll b fi lq lr l ls lt">dfr.describe()</span></pre><p id="6a4e" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">Out[31]:</p><figure class="lg lh li lj fd hk er es paragraph-image"><div class="er es mj"><img src="../Images/07e76e2fe668f69135a7ca1a9373cfe2.png" data-original-src="https://miro.medium.com/v2/resize:fit:512/format:webp/1*bfHkNST7NYK26yFeK3auMg.png"/></div></figure><h1 id="a41b" class="kj kk hy bd kl km kn ko kp kq kr ks kt je ku jf kv jh kw ji kx jk ky jl kz la bi translated">模型精度</h1><p id="b653" class="pw-post-body-paragraph jn jo hy jp b jq lb iz js jt lc jc jv jw ld jy jz ka le kc kd ke lf kg kh ki hb bi translated">在[32]中:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="0720" class="lp kk hy ll b fi lq lr l ls lt">x2 = dfr.Actual_Price.mean()<br/>y2 = dfr.Predicted_Price.mean()<br/>Accuracy1 = x2/y2*100<br/>print("The accuracy of the model is " , Accuracy1)</span><span id="2157" class="lp kk hy ll b fi lu lr l ls lt">The accuracy of the model is  99.68318915929602</span></pre><p id="9260" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在[33]中:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="d141" class="lp kk hy ll b fi lq lr l ls lt">plt.scatter(dfr.Actual_Price, dfr.Predicted_Price,  color='Darkblue')<br/>plt.xlabel("Actual Price")<br/>plt.ylabel("Predicted Price")</span><span id="47db" class="lp kk hy ll b fi lu lr l ls lt">plt.show()</span></pre><figure class="lg lh li lj fd hk er es paragraph-image"><div class="er es mk"><img src="../Images/2b9cc385b9e55f6bd5f9c5d1a15e84ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:866/format:webp/0*4AbwxuLdI3IgyWUH.png"/></div></figure><p id="78fd" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在[34]中:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="2f62" class="lp kk hy ll b fi lq lr l ls lt">plt.plot(dfr.Actual_Price, color='black')<br/>plt.plot(dfr.Predicted_Price, color='lightblue')<br/>plt.title("Nio prediction chart")<br/>plt.legend();</span></pre><figure class="lg lh li lj fd hk er es paragraph-image"><div class="er es ml"><img src="../Images/8970387eefe7ce062fb73a73ac314b44.png" data-original-src="https://miro.medium.com/v2/resize:fit:822/format:webp/0*_4mX58Hhk000o0RF.png"/></div></figure><h1 id="c2c0" class="kj kk hy bd kl km kn ko kp kq kr ks kt je ku jf kv jh kw ji kx jk ky jl kz la bi translated">结论</h1><p id="413b" class="pw-post-body-paragraph jn jo hy jp b jq lb iz js jt lc jc jv jw ld jy jz ka le kc kd ke lf kg kh ki hb bi translated">当谈到时间序列预测或试图感受市场整体走向时，股票市场一直是最热门的话题。不可能找到“去”公式来预测股票市场的方向，因为市场的不断波动，移动变量的不确定性可能会影响股票市场的波动，从相关风险到政治不稳定和宏观经济因素，等等。</p><p id="f914" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">为了更好地了解市场的走向，依赖回归模型并根据过去的表现预测某些值是不够的。以下几点应该是对成熟的回归模型报告的补充。</p><h1 id="00ba" class="kj kk hy bd kl km kn ko kp kq kr ks kt je ku jf kv jh kw ji kx jk ky jl kz la bi translated">1-基本面分析</h1><p id="9ce5" class="pw-post-body-paragraph jn jo hy jp b jq lb iz js jt lc jc jv jw ld jy jz ka le kc kd ke lf kg kh ki hb bi translated">基本面分析是一种基于历史和当前业绩数据来分析和预测公司内在价值的方法，这些数据以财务报表和资产负债表信息的形式出现。因此，可以分析信息来计算公司当前的倍数，如市盈率、市净率、流动性比率、负债率、回报率、利润率等。这些信息可以让你对公司的发展方向有一个坚定的信念，并帮助你做出是否考虑投资该公司的关键决定。</p><h1 id="5ea0" class="kj kk hy bd kl km kn ko kp kq kr ks kt je ku jf kv jh kw ji kx jk ky jl kz la bi translated">2-技术分析</h1><p id="54e2" class="pw-post-body-paragraph jn jo hy jp b jq lb iz js jt lc jc jv jw ld jy jz ka le kc kd ke lf kg kh ki hb bi translated">技术分析是基于历史数据(例如，交易股票的每日总量或价值)使用统计方法和趋势，并评估历史模式以预测未来股价运动的方法。</p><h1 id="7b64" class="kj kk hy bd kl km kn ko kp kq kr ks kt je ku jf kv jh kw ji kx jk ky jl kz la bi translated">3-情感分析</h1><p id="f94c" class="pw-post-body-paragraph jn jo hy jp b jq lb iz js jt lc jc jv jw ld jy jz ka le kc kd ke lf kg kh ki hb bi translated">基本上，情感分析是使用高端自然语言处理来确定给定的文本数据是正面的、负面的还是中性的。你可以通过段落、大量文字资料、客户评论、研究论文、科学论文等进行分析。在我们的例子中，您可能会使用这种方法来分析主题公司的Twitter帐户，或者从其脸书帐户进行评论等等。</p><p id="98c4" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">关于作者:<strong class="jp hz">阿卜杜拉·马赫古布</strong></p><p id="8f65" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">数据科学家|投资运营分析师|数据科学爱好者| ML |大数据| Python | SQL | FinTech |战略规划者|业务开发人员|演讲者|作家|全栈开发人员和UX设计师</p></div></div>    
</body>
</html>