<html>
<head>
<title>Akka in Dot Net Core</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">点网核心中的Akka</h1>
<blockquote>原文：<a href="https://medium.com/codex/akka-in-dot-net-core-816795ae4ec6?source=collection_archive---------7-----------------------#2021-05-16">https://medium.com/codex/akka-in-dot-net-core-816795ae4ec6?source=collection_archive---------7-----------------------#2021-05-16</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/d1d4dbb535d45f39402c1ff5fa434c13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OX4YYhdr8xUNJvrkPyJefQ.jpeg"/></div></div></figure><p id="e319" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在软件开发的初期，可伸缩性是世界上的一个主要问题。组织要么购买多处理器服务器来扩展现有系统，要么继续购买可以并行运行的多个系统。这样做是希望满足扩展模型中的负载。</p><p id="707a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">你认为将一个系统从放大版转换成缩小版容易吗，反之亦然？不，这并不容易，因为它涉及底层编码，需要小心翼翼地处理与并发和分布式计算相关的问题。</p><p id="686f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">即使在云出现之后，这个问题在现代仍然存在。这就是Akka的用武之地，它提供了一种构建并发和容错系统的优秀方法。让我们详细看看什么是Akka，它带来了什么，以及如何在中实现基于Akka的系统。网芯。</p><p id="e475" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">目录</strong></p><ol class=""><li id="647f" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated">Akka是什么？</li><li id="0ca2" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">什么是演员模特？</li><li id="d570" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">Akka在。网络核心</li><li id="2bef" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">结论</li></ol><h1 id="93f9" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">Akka是什么？</h1><p id="18d8" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">Akka是一个设计用于处理和构建高度并发、分布式和容错系统的工具包。它是用Scala构建的，为开发者提供了Scala和Java APIs。它开发并发分布式系统的方法是基于Actor模型的(我们将在下一节看到)。</p><p id="ed5f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Akka在参与者和底层域系统之间提供了一个层，参与者的角色是处理传入的消息。在此之上，创建、处理、调度线程、同步的复杂性由框架来处理。这使得开发人员更容易专注于业务逻辑，而不是并发机制的底层实现。</p><p id="ba7d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">以下是Akka的主要优势。</p><ol class=""><li id="697f" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated">无需编码的多线程和并发行为。</li><li id="3ff5" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">系统之间的透明通信，以及</li><li id="3300" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">基于需求的高可用性和可扩展性。</li></ol><h1 id="7c27" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">什么是演员模特？</h1><p id="6461" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">简单地说，它是一个有助于更容易实现并发计算的模型。它提供了一组关于系统组件之间应该如何进行交互的规则。类似于面向对象编程中对象扮演主要角色，这里参与者扮演主要角色。所有的动作都是围绕着演员来驱动的。</p><p id="ceb1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">参与者有各自的邮箱，不共享内存，他们是有状态的，彼此隔离。与此同时，参与者可以创建新的参与者，向其他参与者发送消息，并决定如何处理下一条消息。</p><p id="f0e8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">就容错而言，每个参与者都有一个主管。参与者模型背后的逻辑不是为所有的失败场景编写防御性的代码(来处理它们)，相反，错误必须被动态地处理。比方说，如果一个参与者出错了，管理者将采取行动，将参与者恢复到已知的一致状态，并通过自我修复的方法使参与者恢复行动。如果多个消息被发送到同一个参与者，那么参与者将按顺序处理这些消息。</p><h1 id="e910" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">Akka在。网络核心</h1><p id="69c8" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">在本节中，我们将实现一个简单的项目，该项目使用基于控制台的应用程序来消费Akka包。</p><h2 id="3ae3" class="lf kd hi bd ke lg lh li ki lj lk ll km jb lm ln kq jf lo lp ku jj lq lr ky ls bi translated">第一步</h2><p id="6139" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">创建一个基于. Net Core的控制台应用程序，并为项目提供一个有效的名称。</p><figure class="lu lv lw lx fd ij er es paragraph-image"><div class="er es lt"><img src="../Images/d340589206b44d4791bc4bf45d1bccef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1326/0*lPmvWGXA6Jx0p1KA"/></div></figure><h2 id="76b4" class="lf kd hi bd ke lg lh li ki lj lk ll km jb lm ln kq jf lo lp ku jj lq lr ky ls bi translated">第二步</h2><p id="a741" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">创建项目后，它将有一个program.cs文件，内容如下。</p><figure class="lu lv lw lx fd ij er es paragraph-image"><div class="er es ly"><img src="../Images/5acece462553a3ae6512db3a15852017.png" data-original-src="https://miro.medium.com/v2/resize:fit:1148/0*TqHZkQ7sOdOKZ6Gi"/></div></figure><p id="531d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">项目的文件夹结构如下所示。</p><figure class="lu lv lw lx fd ij er es paragraph-image"><div class="er es lz"><img src="../Images/ed62b97af9bd59b0b1855dfcf0b7d109.png" data-original-src="https://miro.medium.com/v2/resize:fit:760/0*3jr6VLxPUj71czQo"/></div></figure><h2 id="d894" class="lf kd hi bd ke lg lh li ki lj lk ll km jb lm ln kq jf lo lp ku jj lq lr ky ls bi translated">第三步</h2><p id="a192" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">是时候在项目中添加Akka的引用了。要使用Akka服务，你需要安装一个NuGet包。为此，右键单击项目并选择Manage NuGet package选项。搜索“Akka”并安装软件包—“Akka”</p><figure class="lu lv lw lx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ma"><img src="../Images/4ad8d670974396f52c1971584a43a9fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*tFsagVlH0D7-Sotr"/></div></div></figure><h2 id="1c7f" class="lf kd hi bd ke lg lh li ki lj lk ll km jb lm ln kq jf lo lp ku jj lq lr ky ls bi translated">第四步</h2><p id="0266" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">创建一个您希望由Akka Actor模型调用和维护的业务逻辑类。为了简单和方便，我们在这里创建一个名为Logic的类。它有一个构造函数，并期望注入字符串参数。</p><pre class="lu lv lw lx fd mb mc md me aw mf bi"><span id="2f0f" class="lf kd hi mc b fi mg mh l mi mj">public class Logic { ​ public Logic(string inputMessage) ​ { ​ Message = inputMessage; ​ } ​ public string Message { get; set; } }</span></pre><h2 id="1ea8" class="lf kd hi bd ke lg lh li ki lj lk ll km jb lm ln kq jf lo lp ku jj lq lr ky ls bi translated">第五步</h2><p id="8605" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">下一步是通过从Akka继承ReceiveActor类来引入actor类。演员参考。这里，在这个例子中，LogicActor充当参与者模型，处理从Logic接收的输入消息，并处理业务逻辑。Actor模型创建一个新线程，并处理其中的信息。除此之外，我们还记录参与者开始和停止流程时的消息。</p><pre class="lu lv lw lx fd mb mc md me aw mf bi"><span id="9368" class="lf kd hi mc b fi mg mh l mi mj">public class LogicActor : ReceiveActor { ​ public LogicActor() ​ { ​ Receive&lt;Logic&gt;(x =&gt; { Console.WriteLine($"Thread - {Thread.CurrentThread.ManagedThreadId} Message received. {x.Message}"); }); ​ } ​ protected override void PreStart() =&gt; Console.WriteLine("Actor started"); ​ protected override void PostStop() =&gt; Console.WriteLine("Actor stopped"); }</span></pre><h2 id="3b4d" class="lf kd hi bd ke lg lh li ki lj lk ll km jb lm ln kq jf lo lp ku jj lq lr ky ls bi translated">第六步</h2><p id="6d5c" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">在main方法中，执行元的调用发生了。为了做到这一点，已经创建了一个actor系统并提供了一个名称。第二，专门创建了一个actor来处理逻辑actor，并为它提供了一个有效的名称。接下来，“告诉”将业务逻辑分配给参与者进行处理的方法。这个角色负责维护应用程序中的所有线程。这里，我们引入了一个5秒钟的线程睡眠机制，这样我们就可以测试actor停止日志消息。</p><pre class="lu lv lw lx fd mb mc md me aw mf bi"><span id="fc10" class="lf kd hi mc b fi mg mh l mi mj">static void Main(string[] args) ​ { ​ var actorSystem = ActorSystem.Create("partech-actor-system"); ​ var actor = actorSystem.ActorOf&lt;LogicActor&gt;("logic"); ​ actor.Tell(new Logic("Hello there!")); ​ Thread.Sleep(5000); ​ actorSystem.Stop(actor); ​ Console.ReadLine(); ​ }</span></pre><h2 id="ecc2" class="lf kd hi bd ke lg lh li ki lj lk ll km jb lm ln kq jf lo lp ku jj lq lr ky ls bi translated">第七步</h2><p id="6dbb" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">运行解决方案。观察结果，因为它显示了由参与者维护和控制的线程号，以处理业务逻辑。除此之外，actor的“开始”和“停止”消息也会出现在控制台窗口中已处理消息的上方和下方。</p><figure class="lu lv lw lx fd ij er es paragraph-image"><div class="er es mk"><img src="../Images/069e5b05cc1f8b9f8a7b4aae0b3bada8.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/0*SO3eDEbe_kj0QBvu"/></div></figure><h1 id="b270" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">最后的话</h1><p id="dc3b" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">Akka为实现并发和分布式系统提供了大量的选择。最好的部分是你可以实现它们，而不需要编写复杂的逻辑来维护它们。</p></div><div class="ab cl ml mm gp mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="hb hc hd he hf"><p id="3509" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="ms">原载于</em><a class="ae mt" href="https://www.partech.nl/nl/publicaties/2021/05/akka-in-dot-net-core" rel="noopener ugc nofollow" target="_blank"><em class="ms">https://www . partech . nl</em></a><em class="ms">。</em></p></div></div>    
</body>
</html>