<html>
<head>
<title>Nullable types in C#</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">C#中可为空的类型</h1>
<blockquote>原文：<a href="https://medium.com/codex/nullable-types-in-c-88b2914ea8d8?source=collection_archive---------15-----------------------#2022-09-20">https://medium.com/codex/nullable-types-in-c-88b2914ea8d8?source=collection_archive---------15-----------------------#2022-09-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/dc952a0af3bd30386faa4ba35ed1974d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ZMi0NoEKKy7qLgLi"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">穆罕默德·拉赫马尼在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="d4e1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在C#中，我们有两种主要的类型:值类型和引用类型。值类型永远不能被赋予<code class="du jt ju jv jw b">null</code>的值。该关键字用于表示对对象的空引用。如果我们试图将<code class="du jt ju jv jw b">null</code>赋值给一个值类型，我们会得到一个编译器错误。</p><p id="0731" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">但是，如果我们需要表示一个可以设置为true、false甚至null的值，该怎么办呢？我们可以利用C# <em class="jx">可空类型</em>，用于两种<a class="ae iu" href="https://learn.microsoft.com/en-us/dotnet/csharp/language-reference/builtin-types/nullable-value-types" rel="noopener ugc nofollow" target="_blank">值</a>类型，从C# 8开始，<a class="ae iu" href="https://learn.microsoft.com/en-us/dotnet/csharp/language-reference/builtin-types/nullable-reference-types" rel="noopener ugc nofollow" target="_blank">引用</a>类型，有一些关键区别(*)。</p><p id="f799" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">一个可为空的值类型有一个下划线类型，作为它周围的一种容器，将<code class="du jt ju jv jw b">null</code>添加到它的基本值集中。因此，如果我们声明一个可空的布尔变量，就像我们前面的例子一样，它可以被赋值为集合<code class="du jt ju jv jw b">{true, false, null}</code> <em class="jx">中的任何值。</em></p><p id="becd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了定义一个可空的变量类型，我们需要添加问号作为下划线类型<code class="du jt ju jv jw b">bool? b = null</code>的后缀。</p><p id="9115" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">向任何值类型添加问号后缀是创建通用<a class="ae iu" href="https://learn.microsoft.com/en-us/dotnet/api/system.nullable-1?view=net-6.0" rel="noopener ugc nofollow" target="_blank">系统实例的一种简化方式。可空的&lt;T&gt;T19】结构。因此，我们也可以使用更实质但完全等价的声明<code class="du jt ju jv jw b">Nullable&lt;bool&gt; b = null</code>。</a></p><p id="bec5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">该结构有两个属性:<a class="ae iu" href="https://learn.microsoft.com/en-us/dotnet/api/system.nullable-1.value?view=net-6.0#system-nullable-1-value" rel="noopener ugc nofollow" target="_blank"> Value </a>，它返回下划线类型的值(如果已经分配了一个有效的值)，以及<a class="ae iu" href="https://learn.microsoft.com/en-us/dotnet/api/system.nullable-1.hasvalue?view=net-6.0#system-nullable-1-hasvalue" rel="noopener ugc nofollow" target="_blank"> HasValue </a>，它检查对象是否已经分配了值。我们可以用<code class="du jt ju jv jw b">!=</code>操作符执行同样的控制。它还有一个方便的<a class="ae iu" href="https://learn.microsoft.com/en-us/dotnet/api/system.nullable-1.getvalueordefault?view=net-6.0#system-nullable-1-getvalueordefault" rel="noopener ugc nofollow" target="_blank">方法</a> <code class="du jt ju jv jw b">GetValueOrDefault()</code>，可以给出下划线类型的当前值或默认值(如果为空)。</p><p id="bf10" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们正在处理可能是<code class="du jt ju jv jw b">null</code>的类型，所以我们可以执行的最频繁的操作是检查<code class="du jt ju jv jw b">null</code>并相应地赋值或检索值。既然如此常见，我们可以使用一个非常简洁的简写来替代经典的if/else语句:空合并运算符<em class="jx"/><code class="du jt ju jv jw b">??</code><em class="jx">。</em></p><figure class="jy jz ka kb fd ij"><div class="bz dy l di"><div class="kc kd l"/></div></figure><p id="3d78" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在第10行，如果我们从方法中得到一个空值，我们把0赋给变量。</p><p id="54ed" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">除此之外，我们可以使用<em class="jx">空值合并赋值操作符</em> <code class="du jt ju jv jw b">??=</code>将值直接赋给空值变量<code class="du jt ju jv jw b">highscore ??= 0</code>。</p><p id="1907" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">C#也有一个条件操作符<code class="du jt ju jv jw b">?.</code>，类似于Angular中的<em class="jx">安全导航操作符</em>，在访问对象属性之前检查是否为空，而不是使用条件语句。这样，如果我们试图访问一个可能为空的对象的某个属性，如果该对象结果为空，我们不会得到运行时错误。</p></div><div class="ab cl ke kf gp kg" role="separator"><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj"/></div><div class="hb hc hd he hf"><p id="1716" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">(*)可空引用类型是C# 8提供的一个可选语言特性。即使它们使用相同的问号后缀，也不是System的简写。可空<t>。</t></p></div></div>    
</body>
</html>