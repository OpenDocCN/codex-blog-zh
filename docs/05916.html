<html>
<head>
<title>Vol 1: The ML Pipeline</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">第1卷:ML管道</h1>
<blockquote>原文：<a href="https://medium.com/codex/vol-1-the-ml-pipeline-1cc1359b41?source=collection_archive---------11-----------------------#2022-04-02">https://medium.com/codex/vol-1-the-ml-pipeline-1cc1359b41?source=collection_archive---------11-----------------------#2022-04-02</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><figure class="in io ip iq fd ir er es paragraph-image"><div role="button" tabindex="0" class="is it di iu bf iv"><div class="er es im"><img src="../Images/01ee71b84e78c92ed2c8cd1a5cc7bb29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*WMWlyfWLjwnFzzM-.png"/></div></div><figcaption class="iy iz et er es ja jb bd b be z dx translated">机器学习管道(来源:Analytics Vidhya)</figcaption></figure></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><h2 id="5adc" class="jc jd hi bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated"><strong class="ak"><em class="ka">TL；【T2博士】</em></strong></h2><p id="a12d" class="pw-post-body-paragraph kb kc hi kd b ke kf kg kh ki kj kk kl jn km kn ko jr kp kq kr jv ks kt ku kv hb bi translated">ML管道描述了数据流以及进出ML模型的信息的<strong class="kd hj">端到端编排。一般封装了原始<strong class="kd hj">数据挖掘</strong>、<strong class="kd hj">预处理</strong> &amp; <strong class="kd hj">特征提取</strong>、模型<strong class="kd hj">训练</strong>、数据<strong class="kd hj">后处理</strong>和模型<strong class="kd hj">评估</strong>的流程。每个ML流水线都是特定于应用的，其中一些阶段比其他阶段更易于自动化。</strong></p></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><h1 id="6395" class="kw jd hi bd je kx ky kz ji la lb lc jm ld le lf jq lg lh li ju lj lk ll jy lm bi translated"><strong class="ak">什么是机器学习？</strong></h1><h2 id="ecb8" class="jc jd hi bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated"><strong class="ak">简介:</strong></h2><p id="6a66" class="pw-post-body-paragraph kb kc hi kd b ke kf kg kh ki kj kk kl jn km kn ko jr kp kq kr jv ks kt ku kv hb bi translated">机器学习(ML)是一门没有边界的学科，其视野可以无限延伸。ML有着广泛的应用——其中许多甚至还没有被发现。已经发现并值得注意的有:</p><ul class=""><li id="1248" class="lo lp hi kd b ke lq ki lr jn ls jr lt jv lu kv lv lw lx ly bi translated">无人驾驶汽车，例如特斯拉的Autopilot</li><li id="a8de" class="lo lp hi kd b ke lz ki ma jn mb jr mc jv md kv lv lw lx ly bi translated">国际象棋引擎，例如DeepMind的AlphaZero</li><li id="ff5b" class="lo lp hi kd b ke lz ki ma jn mb jr mc jv md kv lv lw lx ly bi translated">自动诊断，例如Babylon的健康应用程序。</li></ul><p id="3643" class="pw-post-body-paragraph kb kc hi kd b ke lq kg kh ki lr kk kl jn me kn ko jr mf kq kr jv mg kt ku kv hb bi translated">ML不仅有多种多样的应用，它是建立在多种基础构件之上的；包括但不限于<em class="ln">统计学、微积分、计算机视觉、数字图像处理</em>和<em class="ln">物理学的模块。</em></p><h2 id="9f4c" class="jc jd hi bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated"><strong class="ak">理论:</strong></h2><p id="f4b2" class="pw-post-body-paragraph kb kc hi kd b ke kf kg kh ki kj kk kl jn km kn ko jr kp kq kr jv ks kt ku kv hb bi translated">任何好的最大似然模型的主要特征是它概括数据的能力，以给定的概率分布为特征。此外，一个学习良好的ML模型能够提供对数据的足够准确的预测，而这些数据以前可能没有被准确地看到。作为补充说明，听说ML模型经常被拟人化是很有趣的——原因是它们的设计，特别是在<em class="ln">深度学习</em>模型的情况下，受到了人类大脑的启发。</p><p id="88d1" class="pw-post-body-paragraph kb kc hi kd b ke lq kg kh ki lr kk kl jn me kn ko jr mf kq kr jv mg kt ku kv hb bi translated">ML模型培训可以分为三个核心方面:</p><ol class=""><li id="1227" class="lo lp hi kd b ke lq ki lr jn ls jr lt jv lu kv mh lw lx ly bi translated"><strong class="kd hj"> <em class="ln">决策</em> : </strong>通常，ML模型用于对数据中的模式/结构进行预测和/或产生估计。</li><li id="d8a0" class="lo lp hi kd b ke lz ki ma jn mb jr mc jv md kv mh lw lx ly bi translated"><strong class="kd hj"> <em class="ln">误差</em> : </strong>误差函数用于评估模型的预测和/或分类。</li><li id="2147" class="lo lp hi kd b ke lz ki ma jn mb jr mc jv md kv mh lw lx ly bi translated"><strong class="kd hj"> <em class="ln">优化</em> : </strong>通常指调整模型的超参数，以减少数据样本的基本事实标签与其预测标签之间的误差的过程。<em class="ln">例如，</em>神经网络通过带有反向传播的随机梯度下降进行优化。</li></ol><p id="a78e" class="pw-post-body-paragraph kb kc hi kd b ke lq kg kh ki lr kk kl jn me kn ko jr mf kq kr jv mg kt ku kv hb bi translated">前面提到的ML核心方面在某种程度上被Tom Mitchell的引用所概括，Tom Mitchell是一位美国教授、作家和计算机科学家，以其对机器学习和认知神经科学的贡献而闻名。</p><blockquote class="mi mj mk"><p id="9cd1" class="kb kc ln kd b ke lq kg kh ki lr kk kl ml me kn ko mm mf kq kr mn mg kt ku kv hb bi translated">“如果一个计算机程序在T个任务中的性能(由P、<strong class="kd hj">来衡量)随着经验E而提高</strong>，那么就可以说该程序从与某类<strong class="kd hj">任务T </strong>和<strong class="kd hj">性能P、</strong>相关的<strong class="kd hj">经验E </strong>中进行了学习。”</p></blockquote></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><h1 id="ee54" class="kw jd hi bd je kx ky kz ji la lb lc jm ld le lf jq lg lh li ju lj lk ll jy lm bi translated">什么是ML管道？</h1><h2 id="8057" class="jc jd hi bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">定义:</h2><p id="faf6" class="pw-post-body-paragraph kb kc hi kd b ke kf kg kh ki kj kk kl jn km kn ko jr kp kq kr jv ks kt ku kv hb bi translated">ML管道描述了数据流的端到端编排，从而描述了进出ML模型的信息。尽管存在过多的机器学习应用，但所有生产的ML模型都是ML管道的一部分，或者说是展示了ML管道。每条管道的长度、吞吐量和复杂性将根据手头的应用及其相关的成功标准而有所不同。</p><p id="1e87" class="pw-post-body-paragraph kb kc hi kd b ke lq kg kh ki lr kk kl jn me kn ko jr mf kq kr jv mg kt ku kv hb bi translated">值得注意的是，当开发一个ML管道时，ML工程师并不轻松地通过每个阶段(或者继续类推，每个管道部分)。通常存在吞吐量减少或增加的管道部分、需要多次迭代才能完成的部分以及更加依赖资源的部分。因此，不言而喻，有些部分比其他部分更适合自动化。</p><h2 id="ad57" class="jc jd hi bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">数据挖掘:</h2><p id="46ea" class="pw-post-body-paragraph kb kc hi kd b ke kf kg kh ki kj kk kl jn km kn ko jr kp kq kr jv ks kt ku kv hb bi translated">数据挖掘是从我们生活的环境中提取数据的过程。以分割生物图像中包含的通过光学显微镜捕获的单个神经元细胞为例。在<em class="ln">计算机视觉</em>中，分割图像描述了检测和描绘与其周围环境截然不同的物体。在这项任务中，数据挖掘是捕获生物图像的过程和注释所述图像的实践。数据挖掘的输出是一个数据集，在这种情况下，它是图像-注释组合的集合。其中注释是识别相关生物图像中包含一部分神经元细胞的像素和不包含一部分神经元细胞的像素的二元掩模。注释图像通常由人来执行，因此，数据集可能需要大量的时间来产生。为了确保质量，注释生物图像的任务应该由领域专家来执行；并且如果可能的话，至少由另一个人来验证。</p><blockquote class="mi mj mk"><p id="523e" class="kb kc ln kd b ke lq kg kh ki lr kk kl ml me kn ko mm mf kq kr mn mg kt ku kv hb bi translated">亮点:为了保证质量，注释生物图像的任务应该由领域专家来完成。</p></blockquote><p id="c826" class="pw-post-body-paragraph kb kc hi kd b ke lq kg kh ki lr kk kl jn me kn ko jr mf kq kr jv mg kt ku kv hb bi translated">数据质量是做出准确预测和明智决策的关键。因此，花时间慢慢挖掘原始数据是必要的——这样才能确保数据的质量。在ML中很重要的质量数据的重要特征包括但不限于:</p><ul class=""><li id="fb5b" class="lo lp hi kd b ke lq ki lr jn ls jr lt jv lu kv lv lw lx ly bi translated"><strong class="kd hj"> <em class="ln">准确性</em></strong><em class="ln"/>——正确性的衡量标准。</li><li id="4984" class="lo lp hi kd b ke lz ki ma jn mb jr mc jv md kv lv lw lx ly bi translated"><strong class="kd hj"> <em class="ln">一致性</em></strong><em class="ln"/>——衡量相等样本之间相似程度的指标。</li><li id="89ef" class="lo lp hi kd b ke lz ki ma jn mb jr mc jv md kv lv lw lx ly bi translated"><strong class="kd hj"> <em class="ln">完整性</em> </strong> <em class="ln"> </em> -衡量缺失数据的比例。</li><li id="9024" class="lo lp hi kd b ke lz ki ma jn mb jr mc jv md kv lv lw lx ly bi translated"><strong class="kd hj"><em class="ln"/></strong><em class="ln"/>——衡量数据陈旧程度的指标。</li></ul><h2 id="fd15" class="jc jd hi bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">预处理和特征提取:</h2><p id="be94" class="pw-post-body-paragraph kb kc hi kd b ke kf kg kh ki kj kk kl jn km kn ko jr kp kq kr jv ks kt ku kv hb bi translated">在大多数情况下，在ML模型使用原始数据之前，有必要对其进行清理和预处理。正如之前暗示的那样，ML模型产生的东西和它所包含的东西一样好。</p><p id="2c45" class="pw-post-body-paragraph kb kc hi kd b ke lq kg kh ki lr kk kl jn me kn ko jr mf kq kr jv mg kt ku kv hb bi translated">此外，通常需要进一步处理数据，以帮助ML模型的训练，从而提高其整体性能。特征提取是将数据转换成有用的数字特征的过程；它是一种技术，要求识别和描述最能提供潜在模式信息的特征，这些特征在描述给定问题空间的人群特征的数据中显而易见。在大多数情况下，很好地理解问题域有助于做出明智的决定，即应该提取哪些特征。特征提取过程可以通过专门的算法来自动化，并且在一些应用中可以使用其他ML模型(例如，<em class="ln"> VGG16特征提取器</em>用于<em class="ln">图像分类</em>任务)。</p><blockquote class="mi mj mk"><p id="bb10" class="kb kc ln kd b ke lq kg kh ki lr kk kl ml me kn ko mm mf kq kr mn mg kt ku kv hb bi translated">亮点:在大多数情况下，对问题域有一个很好的理解有助于做出关于应该提取哪些特征的明智决定。</p></blockquote><p id="9e44" class="pw-post-body-paragraph kb kc hi kd b ke lq kg kh ki lr kk kl jn me kn ko jr mf kq kr jv mg kt ku kv hb bi translated">根据具体应用，提取要素并丢弃信息量较少的要素的过程可用于降低维度，从而减少数据集的内存占用。与任何降维方法一样，数据质量的损失应该可以忽略不计。</p><h2 id="e4f2" class="jc jd hi bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated"><strong class="ak">模型训练:</strong></h2><p id="6459" class="pw-post-body-paragraph kb kc hi kd b ke kf kg kh ki kj kk kl jn km kn ko jr kp kq kr jv ks kt ku kv hb bi translated">训练ML模型是将模型拟合到训练数据的过程。ML模型(由算法定义)将自动更新其超参数(例如，<em class="ln">深度学习</em>模型的<em class="ln">权重&amp;偏差</em>)，以便最小化预定义的损失/误差函数。根据上面的ML理论，误差函数用于量化ML模型的表现。它的大小、方向以及梯度被用来更新模型的超参数，以便改进它对训练数据的拟合。ML工程师可以控制某些模型超参数，即优化器的类型、学习速率、时期&amp;运行值、批次值等。，但是甚至其中的一些也可以通过函数回调来改变。</p><p id="5cfd" class="pw-post-body-paragraph kb kc hi kd b ke lq kg kh ki lr kk kl jn me kn ko jr mf kq kr jv mg kt ku kv hb bi translated">使用系统的和可重复的方法进行模型训练是至关重要的——特别是如果组织计划大规模地建立和部署ML模型。</p><h2 id="49ed" class="jc jd hi bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated"><strong class="ak">后处理:</strong></h2><p id="5108" class="pw-post-body-paragraph kb kc hi kd b ke kf kg kh ki kj kk kl jn km kn ko jr kp kq kr jv ks kt ku kv hb bi translated">在某些情况下，可能有必要对由ML模型产生的数据进行处理，以便提高其质量或使其成为合适的形式，从而可以产生洞察力。类似于预处理和特征提取阶段，通常需要在计算时间和数据质量之间进行权衡。通常，ML工程师需要从大量的算法中选择最佳的数据处理技术，以足够的速度提供高质量的数据。</p><p id="a54f" class="pw-post-body-paragraph kb kc hi kd b ke lq kg kh ki lr kk kl jn me kn ko jr mf kq kr jv mg kt ku kv hb bi translated">作为数据后处理的一个例子，让我们再次接受分割单个神经元细胞的挑战。可能存在两个单元没有被彼此描绘的情况，即，预测的掩码表明这两个单元是一个。在这种情况下，应用被称为<em class="ln">分水岭分割</em>算法的<em class="ln">数字图像处理</em>技术可能是有利的。该算法的名称隐喻性地指一个地质分水岭，它将相邻或重叠的流域分开。简而言之，该算法使用距离变换和形态学操作来产生连接的分割边界。</p><figure class="in io ip iq fd ir er es paragraph-image"><div role="button" tabindex="0" class="is it di iu bf iv"><div class="er es mo"><img src="../Images/84bbe957bc6daf4c2e31c6b1a0b3b3b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*dC7aOLQ3_k7DkqqC.png"/></div></div><figcaption class="iy iz et er es ja jb bd b be z dx translated">图1:分水岭分割算法可视化(来源:傅浩等，ResearchGate)</figcaption></figure><p id="a9a1" class="pw-post-body-paragraph kb kc hi kd b ke lq kg kh ki lr kk kl jn me kn ko jr mf kq kr jv mg kt ku kv hb bi translated">如果将<em class="ln">分水岭分割</em>算法应用于两个连接的神经元细胞的预测掩模，如图1a所示，那么图1d中处理后的掩模将更具代表性。</p><h2 id="ec01" class="jc jd hi bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated"><strong class="ak">评估</strong>:</h2><p id="91d1" class="pw-post-body-paragraph kb kc hi kd b ke kf kg kh ki kj kk kl jn km kn ko jr kp kq kr jv ks kt ku kv hb bi translated">评估阶段的第一步是选择和实现性能指标，使ML工程师能够了解模型的运行情况。这些指标应该足够详尽，以便从中产生见解，并在以后用于指导ML工程师如何改进ML管道阶段。此外，正是这些度量标准，或者通常是它们的子集，被用来向重要的利益相关者强调模型的优点，从而强调模型的可取性。</p><p id="db9e" class="pw-post-body-paragraph kb kc hi kd b ke lq kg kh ki lr kk kl jn me kn ko jr mf kq kr jv mg kt ku kv hb bi translated">特定于当前应用程序的数据集创建后，应该至少划分为一个训练集和一个测试集(也称为“保持集”)。如果ML模型要在相同的数据集上训练和评估，那么它将具有近乎完美的性能，这很可能不代表该模型对“看不见的”数据的实际表现——这种情况发生的模型被称为具有<em class="ln">数据泄漏。</em>一般来说，ML模型应该用全部数据集的80%来训练，用另外20%来测试。</p><p id="ffa9" class="pw-post-body-paragraph kb kc hi kd b ke lq kg kh ki lr kk kl jn me kn ko jr mf kq kr jv mg kt ku kv hb bi translated">应该使用的性能指标取决于ML任务。一般来说，对于<em class="ln">分类</em>任务<em class="ln">准确度</em>，<em class="ln">精密度</em>，<em class="ln">召回率</em>，<em class="ln">F1-得分</em>，<em class="ln">平均绝对误差</em>，<em class="ln">ROC下面积(AUC)，混淆矩阵</em>等。，被使用。其中<em class="ln">分类</em>任务是为给定问题领域的数据样本分配类别标签的过程。了解给定数据集中每个类有多少样本非常重要。如果数据集是不平衡的(即一类样本占少数，另一类占多数)，那么<em class="ln">精度</em>、<em class="ln">召回</em>和<em class="ln">F1-分数</em>更能代表模型的性能。然而，如果数据集是平衡的，那么仅仅<em class="ln">精度</em>可能就足够了。</p><blockquote class="mi mj mk"><p id="26ef" class="kb kc ln kd b ke lq kg kh ki lr kk kl ml me kn ko mm mf kq kr mn mg kt ku kv hb bi translated">重点:如果数据集不平衡，那么精确度、召回率和F1分数更能代表模型的性能。</p></blockquote><p id="a9e8" class="pw-post-body-paragraph kb kc hi kd b ke lq kg kh ki lr kk kl jn me kn ko jr mf kq kr jv mg kt ku kv hb bi translated">应当注意，有一些应用，尤其是在<em class="ln">图像分割</em>任务中，需要设计自己的性能指标，以便能够创建比使用上述通用性能指标创建的性能指标更好的洞察力。</p></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><p id="12a0" class="pw-post-body-paragraph kb kc hi kd b ke lq kg kh ki lr kk kl jn me kn ko jr mf kq kr jv mg kt ku kv hb bi translated">感谢阅读。请考虑订阅和/或资助我<a class="ae mp" href="https://gofund.me/c397684d" rel="noopener ugc nofollow" target="_blank">https://gofund.me/c397684d</a></p></div></div>    
</body>
</html>