<html>
<head>
<title>Addressing Toxic Comments with Lightning Flash and Detoxify</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用闪电和解毒来解决有毒的评论</h1>
<blockquote>原文：<a href="https://medium.com/codex/addressing-toxic-comments-with-lightning-flash-and-detoxify-92996b9f9ca8?source=collection_archive---------8-----------------------#2021-12-08">https://medium.com/codex/addressing-toxic-comments-with-lightning-flash-and-detoxify-92996b9f9ca8?source=collection_archive---------8-----------------------#2021-12-08</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/49737af013ad0503523fd6e3b74ec91d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9bkndCAP06_WKarr-65Qjg.jpeg"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">YeahIllustration Photo by<a class="ae hv" href="https://www.pexels.com/@pavel-danilyuk?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">Pavel Danilyuk</a>来自<a class="ae hv" href="https://www.pexels.com/photo/wood-love-writing-winter-8294846/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> Pexels </a></figcaption></figure><div class=""/><div class=""><h2 id="9f23" class="pw-subtitle-paragraph iv hx hy bd b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm dx translated">展示创建了一个自然语言处理(NLP)模型，用于用闪电检测纯文本中的毒性。我们还提出了一个名为解毒的社区项目，它提供了经过PytorchLightning预训练的拥抱脸模型。</h2></div><p id="58bd" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">这篇文章介绍了两种方法来识别有毒评论，作为第四届<a class="ae hv" href="https://www.kaggle.com/c/jigsaw-toxic-severity-rating" rel="noopener ugc nofollow" target="_blank">有毒评论严重程度排名</a>比赛的一部分。第一种方法利用一个强大的NLP基线模型，该模型很容易用<a class="ae hv" href="https://github.com/PyTorchLightning/lightning-flash" rel="noopener ugc nofollow" target="_blank">闪光灯</a>训练，以对人类评论的毒性级别进行分类。第二部分展示了一个开源项目，解毒，基于<a class="ae hv" href="https://huggingface.co/transformers/" rel="noopener ugc nofollow" target="_blank">拥抱脸变形金刚</a>，但用<a class="ae hv" href="https://pytorch-lightning.readthedocs.io/en/stable/" rel="noopener ugc nofollow" target="_blank"> PyTorch Lightning </a> (PL)训练。此外，解毒提供使用他们已经训练好的模型保存为PL检查点。</p><blockquote class="kj kk kl"><p id="61a3" class="jn jo km jp b jq jr iz js jt ju jc jv kn jx jy jz ko kb kc kd kp kf kg kh ki hb bi translated">有害评论被定义为粗鲁、不尊重他人或不合理的评论，可能会使其他用户离开讨论。情感分析的一个子任务是有害评论分类。[ <a class="ae hv" href="https://hpi.de/fileadmin/user_upload/fachgebiete/naumann/publications/PDFs/2020_risch_toxic.pdf" rel="noopener ugc nofollow" target="_blank">在线讨论中的有毒评论检测</a></p></blockquote><p id="8aa2" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">这种<a class="ae hv" href="https://www.kaggle.com/c/jigsaw-toxic-severity-rating" rel="noopener ugc nofollow" target="_blank">竖锯率毒性评论的严重程度</a>已经是关于这个话题的第四版了。以前的比赛是简单的分类，后来也是多语言多标签的任务。</p><div class="hh hi ez fb hj kq"><a href="https://www.kaggle.com/c/jigsaw-toxic-severity-rating" rel="noopener  ugc nofollow" target="_blank"><div class="kr ab dw"><div class="ks ab kt cl cj ku"><h2 class="bd hz fi z dy kv ea eb kw ed ef hx bi translated">拼图评级毒性评论的严重程度</h2><div class="kx l"><h3 class="bd b fi z dy kv ea eb kw ed ef dx translated">在评论之间排列毒性的相对等级</h3></div><div class="ky l"><p class="bd b fp z dy kv ea eb kw ed ef dx translated">www.kaggle.com</p></div></div><div class="kz l"><div class="la l lb lc ld kz le hp kq"/></div></div></a></div><p id="475d" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">今年的拼图挑战赛有所不同，因为组织者引入了新的评估系统。组织者注意到，对哪些评论是有毒的(高于某个可接受的阈值)进行二元分类是具有挑战性和主观性的。因此，当组织者提供验证数据集时，他们求助于一个排名系统——将两个评论并排放置，其中一个比另一个更有害。对于人类来说，更自然的是进行这样的排序，而不是在没有上下文的情况下预测每个样本的绝对分数。</p><h1 id="bf8b" class="lf lg hy bd lh li lj lk ll lm ln lo lp je lq jf lr jh ls ji lt jk lu jl lv lw bi translated">闪电基线</h1><p id="3947" class="pw-post-body-paragraph jn jo hy jp b jq lx iz js jt ly jc jv jw lz jy jz ka ma kc kd ke mb kg kh ki hb bi translated"><a class="ae hv" href="https://github.com/PyTorchLightning/lightning-flash" rel="noopener ugc nofollow" target="_blank"> Lightning Flash </a>是一个方便的人工智能工具箱，涵盖了表格数据、自然语言处理(NLP)、计算机视觉等重要领域。它提供了几个通用的任务——二进制和多标签分类以及特定领域的任务，例如NLP翻译或问答。</p><blockquote class="kj kk kl"><p id="33be" class="jn jo km jp b jq jr iz js jt ju jc jv kn jx jy jz ko kb kc kd kp kf kg kh ki hb bi translated">为了解决问题的简单性和紧密性，我们将把任务视为简单的文本分类，并使用过去比赛的数据集。值得一提的是，组织者甚至鼓励使用过去的数据集。</p></blockquote><figure class="md me mf mg fd hk er es paragraph-image"><div class="er es mc"><img src="../Images/22d9a777a87a984b528f2f9d709a413b.png" data-original-src="https://miro.medium.com/v2/resize:fit:816/format:webp/0*REgk8FbIxdyVw81n.png"/></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">第二版数据集中任何毒性水平的标签分布。</figcaption></figure><p id="6c8e" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">上图显示，即使我们将所有子类:<code class="du mh mi mj mk b">toxic</code>、<code class="du mh mi mj mk b">severe_toxic</code>、<code class="du mh mi mj mk b">obscene</code>、<code class="du mh mi mj mk b">threat</code>、<code class="du mh mi mj mk b">insult</code>、<code class="du mh mi mj mk b">identity_hate</code>进行汇总，数据集仍严重失衡，偏向于无毒标签。当我们阅读一些被归类为无毒的评论时，我们可以感觉到一定程度的毒性，这反映了评估毒性是多么棘手和主观。</p><p id="b1eb" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">这篇文章基于<a class="ae hv" href="https://lightning-flash.readthedocs.io/en/stable/reference/text_classification.html" rel="noopener ugc nofollow" target="_blank"> Flash示例</a>和我们最近公开的Kaggle内核:</p><div class="hh hi ez fb hj kq"><a href="https://www.kaggle.com/jirkaborovec/toxic-comments-with-lightning-flash" rel="noopener  ugc nofollow" target="_blank"><div class="kr ab dw"><div class="ks ab kt cl cj ku"><h2 class="bd hz fi z dy kv ea eb kw ed ef hx bi translated">🙊对Lightning⚡Flash的恶毒评论</h2><div class="kx l"><h3 class="bd b fi z dy kv ea eb kw ed ef dx translated">使用Kaggle笔记本探索和运行机器学习代码|使用来自多个数据源的数据</h3></div><div class="ky l"><p class="bd b fp z dy kv ea eb kw ed ef dx translated">www.kaggle.com</p></div></div><div class="kz l"><div class="ml l lb lc ld kz le hp kq"/></div></div></a></div><p id="6256" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">要训练您的模型，您只需执行三个基本步骤，遵循任何通用的机器学习管道:(1)准备和加载数据集，(2)使用选择的主干创建模型，以及(3)训练它。为了便于说明，我们在下面几行中展示了这些步骤中的每一步，并附有代码截图。</p><h2 id="8554" class="mm lg hy bd lh mn mo mp ll mq mr ms lp jw mt mu lr ka mv mw lt ke mx my lv mz bi translated">1.构建数据模块</h2><p id="4c8a" class="pw-post-body-paragraph jn jo hy jp b jq lx iz js jt ly jc jv jw lz jy jz ka ma kc kd ke mb kg kh ki hb bi translated">我们将在汇总所有毒性子类后使用单一语言二进制数据集——简单地说，在一个名为<code class="du mh mi mj mk b">“any”</code>的新列中。我们还需要指定稍后将使用哪个模型来确保相同的标记器。</p><figure class="md me mf mg fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es na"><img src="../Images/4016bca4eb51c28a2bbb2ef1017806ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*32wP6pRGAC34yhETSnhVtA.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">用于创建数据模块的代码快照。</figcaption></figure><p id="3c76" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">Flash直接与HuggingFace模型中心集成，因此您可以使用这个庞大集合中的任何模型。在这个基线中，我们使用<code class="du mh mi mj mk b">“xlm-roberta-base”</code>主干模型。</p><h2 id="68ab" class="mm lg hy bd lh mn mo mp ll mq mr ms lp jw mt mu lr ka mv mw lt ke mx my lv mz bi translated">2.创建模型</h2><p id="60b5" class="pw-post-body-paragraph jn jo hy jp b jq lx iz js jt ly jc jv jw lz jy jz ka ma kc kd ke mb kg kh ki hb bi translated">模型的创建非常简单。我们从创建的数据模块中传递模型名称，并从提供的数据集中自动提取类的数量。</p><figure class="md me mf mg fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es na"><img src="../Images/ae812fc0e41eaf147b737194a31f9f15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mA_RjZz_s730OiMxt-3EXw.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">用数据模块创建模型的代码快照。</figcaption></figure><p id="809e" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">我们用来自<a class="ae hv" href="https://torchmetrics.readthedocs.io/en/stable/" rel="noopener ugc nofollow" target="_blank"> TorchMetrics </a>的<a class="ae hv" href="https://torchmetrics.readthedocs.io/en/stable/references/modules.html?highlight=Precision#id4" rel="noopener ugc nofollow" target="_blank">精度</a>和<a class="ae hv" href="https://torchmetrics.readthedocs.io/en/stable/references/modules.html?highlight=f1#f1" rel="noopener ugc nofollow" target="_blank"> F1 </a>分数替换默认的精度指标，以更好地监控我们不平衡数据集的性能。</p><h2 id="dfd7" class="mm lg hy bd lh mn mo mp ll mq mr ms lp jw mt mu lr ka mv mw lt ke mx my lv mz bi translated">3.训练模型</h2><p id="9656" class="pw-post-body-paragraph jn jo hy jp b jq lx iz js jt ly jc jv jw lz jy jz ka ma kc kd ke mb kg kh ki hb bi translated">有了实例化的数据模块和模型，我们就可以开始训练了。由于Flash建立在PyTorch Lightning (PL)之上，您可以使用<a class="ae hv" href="https://pytorch-lightning.readthedocs.io/en/stable/common/trainer.html" rel="noopener ugc nofollow" target="_blank"> PL训练器</a>的全部功能来训练您的模型。Flash有一个内置的默认Tenrboard记录器，我们在演示中用CSVLogger替换了它，因为它更适合在笔记本上绘制结果。</p><figure class="md me mf mg fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es na"><img src="../Images/0f4bd9794c365c0f935a998f920969dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G6nJP2LZ-TRHmcE_xiQHsw.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">用于定型模型的代码快照。</figcaption></figure><p id="d90e" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">当训练完成时，我们获取记录结果并绘制进度图。下图显示预训练模型表现良好，我们的微调正在缓慢地改进模型。在这种情况下，我们可以配置优化器、学习率和时间表来提高收敛性。</p><figure class="md me mf mg fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es nb"><img src="../Images/4616b6bf89a46165fac16416439edaa5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*WukEGUB4OM7cGpa7.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">跟踪培训指标。</figcaption></figure><h2 id="189c" class="mm lg hy bd lh mn mo mp ll mq mr ms lp jw mt mu lr ka mv mw lt ke mx my lv mz bi translated">推理和预测</h2><p id="2bcd" class="pw-post-body-paragraph jn jo hy jp b jq lx iz js jt ly jc jv jw lz jy jz ka ma kc kd ke mb kg kh ki hb bi translated">由于竞赛要求某种形式的排名，我们决定返回有毒的概率，而不是二进制标签，因为这将更好地捕捉给定任务的性质。</p><figure class="md me mf mg fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es na"><img src="../Images/4a5f0d4282841c414a96f2c671d89b3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s0d7ucW9lxYu8sN1KZ0gGg.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">用于切换输出格式的代码快照。</figcaption></figure><p id="fecc" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">Flash使得改变预测的输出格式变得很容易。我们可以将输出更改为Logits，这将在概率范围的两端提供更详细的描述——探索sigmoid的tails squash。</p><figure class="md me mf mg fd hk er es paragraph-image"><div class="er es nc"><img src="../Images/41d9fb3b961eac9c33df3d90948e2df8.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/0*fEbR1M3dB_l2Ana0.png"/></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">用Flash进行比赛预测的概率分布。</figcaption></figure><figure class="md me mf mg fd hk er es paragraph-image"><div class="er es nc"><img src="../Images/540eafeb8ae1049028379633126110c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/0*z5MuCEpQvB1IaGE7.png"/></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">比赛预测的罗吉斯分布。</figcaption></figure><p id="26f4" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">具有三种预测变量的排行榜上的基线分数为:<br/> *二元:0.509 <br/> *概率:0.696 <br/> *对数:0.698</p><h1 id="337e" class="lf lg hy bd lh li lj lk ll lm ln lo lp je lq jf lr jh ls ji lt jk lu jl lv lw bi translated">预训练开源保护解毒</h1><p id="4867" class="pw-post-body-paragraph jn jo hy jp b jq lx iz js jt ly jc jv jw lz jy jz ka ma kc kd ke mb kg kh ki hb bi translated">如果您想使用现成的东西进行推理，您可以搜索HuggingFase hub并编写简单的推理代码来使用这个模型。为了比较我们基线的性能，我们将它与由<a class="ae hv" href="https://www.unitary.ai/" rel="noopener ugc nofollow" target="_blank"> unitary </a>在<a class="ae hv" href="https://github.com/unitaryai/detoxify" rel="noopener ugc nofollow" target="_blank">解毒</a>项目中预先训练的模型进行了评估，该项目使用了与我们之前的Flash基线(<code class="du mh mi mj mk b">“xlm-roberta-base”</code>)相同的HuggingFase Transformers主干。</p><blockquote class="kj kk kl"><p id="a235" class="jn jo km jp b jq jr iz js jt ju jc jv kn jx jy jz ko kb kc kd kp kf kg kh ki hb bi translated">解毒:训练有素的模型和代码来预测所有3个拼图毒性评论挑战的毒性评论。使用zap Pytorch闪电和拥抱变形金刚建造。</p></blockquote><p id="0c0c" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">根据第三届拼图大赛的<a class="ae hv" href="https://github.com/unitaryai/detoxify#description" rel="noopener ugc nofollow" target="_blank">公共排行榜</a>，该模型的表现与顶级Kaggle解决方案不相上下。我们的演示Kaggle笔记本第四版公开提供下载的检查点。</p><div class="hh hi ez fb hj kq"><a href="https://www.kaggle.com/jirkaborovec/score-toxic-comments-with-trained-detoxify" rel="noopener  ugc nofollow" target="_blank"><div class="kr ab dw"><div class="ks ab kt cl cj ku"><h2 class="bd hz fi z dy kv ea eb kw ed ef hx bi translated">得分🙊受过训练的有毒评论🤗⚡Detoxify</h2><div class="kx l"><h3 class="bd b fi z dy kv ea eb kw ed ef dx translated">使用Kaggle笔记本探索和运行机器学习代码|使用来自多个数据源的数据</h3></div><div class="ky l"><p class="bd b fp z dy kv ea eb kw ed ef dx translated">www.kaggle.com</p></div></div><div class="kz l"><div class="nd l lb lc ld kz le hp kq"/></div></div></a></div><p id="a683" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在下面的一些章节中，我们将提到使用离线内核来安装包和下载检查点，我们在之前的<a class="ae hv" href="https://towardsdatascience.com/easy-kaggle-offline-submission-with-chaining-kernels-30bba5ea5c4d" rel="noopener" target="_blank">帖子</a>中已经描述过了。</p><div class="hh hi ez fb hj kq"><a href="https://towardsdatascience.com/easy-kaggle-offline-submission-with-chaining-kernels-30bba5ea5c4d" rel="noopener follow" target="_blank"><div class="kr ab dw"><div class="ks ab kt cl cj ku"><h2 class="bd hz fi z dy kv ea eb kw ed ef hx bi translated">带链接内核的简单Kaggle离线提交</h2><div class="kx l"><h3 class="bd b fi z dy kv ea eb kw ed ef dx translated">一个简单的指南，帮助您使用Kaggle提交受限互联网接入的比赛…</h3></div><div class="ky l"><p class="bd b fp z dy kv ea eb kw ed ef dx translated">towardsdatascience.com</p></div></div><div class="kz l"><div class="ne l lb lc ld kz le hp kq"/></div></div></a></div><blockquote class="kj kk kl"><p id="3747" class="jn jo km jp b jq jr iz js jt ju jc jv kn jx jy jz ko kb kc kd kp kf kg kh ki hb bi translated">为了解决离线加载问题，我使用我的个人叉子进行必要的修复:<a class="ae hv" href="https://github.com/Borda/detoxify" rel="noopener ugc nofollow" target="_blank">https://github.com/Borda/detoxify</a></p></blockquote><h2 id="9585" class="mm lg hy bd lh mn mo mp ll mq mr ms lp jw mt mu lr ka mv mw lt ke mx my lv mz bi translated">加载预训练模型</h2><p id="66ae" class="pw-post-body-paragraph jn jo hy jp b jq lx iz js jt ly jc jv jw lz jy jz ka ma kc kd ke mb kg kh ki hb bi translated">解毒模型可以通过绕过检查点名称或给出下载的检查点路径并链接HuggingFace存储模型和记号赋予器定义来实例化。</p><figure class="md me mf mg fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es na"><img src="../Images/d6190ce8b3052a6be9ab993618768c8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ukpZAbqsBt-D3tx7j632zw.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">用于从检查点创建模型的代码快照。</figcaption></figure><h2 id="891f" class="mm lg hy bd lh mn mo mp ll mq mr ms lp jw mt mu lr ka mv mw lt ke mx my lv mz bi translated">推论:收集所有预测</h2><p id="ab9e" class="pw-post-body-paragraph jn jo hy jp b jq lx iz js jt ly jc jv jw lz jy jz ka ma kc kd ke mb kg kh ki hb bi translated">该模型内置了对GPU推理的支持，并以单行命令的形式预测分数，与pandas进程映射相结合。</p><figure class="md me mf mg fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es na"><img src="../Images/32c8aa50441ad5be4baab1443a22ca4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MUpsYXUj44mgetNCY4X44Q.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">运行预测的代码快照。</figcaption></figure><p id="d4aa" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">与我们之前的Flash预测相比，我们可以看到这些分数有利于毒性分数。</p><figure class="md me mf mg fd hk er es paragraph-image"><div class="er es nf"><img src="../Images/d9314fa5a657d0cd4f5755ecb718923c.png" data-original-src="https://miro.medium.com/v2/resize:fit:790/format:webp/0*tLf4-jz3yvNiXDnL.png"/></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">解毒竞争预测的概率分布。</figcaption></figure><h2 id="c3ff" class="mm lg hy bd lh mn mo mp ll mq mr ms lp jw mt mu lr ka mv mw lt ke mx my lv mz bi translated">对验证数据集进行比较</h2><p id="51d3" class="pw-post-body-paragraph jn jo hy jp b jq lx iz js jt ly jc jv jw lz jy jz ka ma kc kd ke mb kg kh ki hb bi translated">我们将在提供的验证数据集上演示性能。确认数据集包括相对有害的评论对，其中一个评论被认为比另一个更有害。</p><p id="b564" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">30k个注释对包含15k个唯一的注释和简单的唯一性分析。我们只对每个独特的评论预测一次，以减少推理时间，从而对整个数据集产生15k个预测，而不是60k个预测(2列* 30k对)。</p><figure class="md me mf mg fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es na"><img src="../Images/41cc502f21cbe6f1c07c80a823c2c600.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qk8rjmhNZ33nppC4dj0gmw.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">用于提取唯一注释的代码快照，</figcaption></figure><p id="5aab" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">然后，我们将验证数据集中假设毒性较低和毒性较高的注释的毒性分数作为二元度量进行比较。此外，由于解毒预测所有七个毒性亚类的分数，我们评估他们每一个。</p><figure class="md me mf mg fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es na"><img src="../Images/592fe9e0809d3bec27966fb0acdbbc3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v5CxqvC19dNojvgLTfdCVQ.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">用于获取验证分数的代码快照。</figcaption></figure><p id="60d9" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">子类别分数的分布非常接近，验证分数从0.65到0.69</p><pre class="md me mf mg fd ng mk nh ni aw nj bi"><span id="75c5" class="mm lg hy mk b fi nk nl l nm nn">score for toxicity:             0.69356<br/>score for severe_toxicity:      <strong class="mk hz">0.69542</strong><br/>score for obscene:              0.68111<br/>score for identity_attack:      0.65862<br/>score for insult:               0.68025<br/>score for threat:               0.65082<br/>score for sexual_explicit:      0.66334</span></pre><p id="f9cf" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">下面，我们绘制了分数之间的差异，以便在更丰富的上下文中查看验证指标。如果两个评论分数之差为正，则排名正确，如果为负，则排名不正确。</p><figure class="md me mf mg fd hk er es paragraph-image"><div class="er es no"><img src="../Images/88ac8115665276a68730264f310bc649.png" data-original-src="https://miro.medium.com/v2/resize:fit:802/format:webp/0*6_X8AmWRawx9qX_j.png"/></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">显示验证对中毒性分数的差异。正差异代表正确的陈述，负差异意味着其中一个评论被错误地评分。</figcaption></figure><p id="7960" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">与综合各种毒性的Flash基线相比，单独使用毒性的任何子类得到0.698分并没有改善。</p><h1 id="ad07" class="lf lg hy bd lh li lj lk ll lm ln lo lp je lq jf lr jh ls ji lt jk lu jl lv lw bi translated">关于可能改进的想法</h1><p id="b9f5" class="pw-post-body-paragraph jn jo hy jp b jq lx iz js jt ly jc jv jw lz jy jz ka ma kc kd ke mb kg kh ki hb bi translated">让我们简单地总结一下我们鼓励读者尝试这个竞赛的一些后续步骤，它可以改进我们的基线，并且实现起来相对简单。</p><h2 id="50c2" class="mm lg hy bd lh mn mo mp ll mq mr ms lp jw mt mu lr ka mv mw lt ke mx my lv mz bi translated">从验证数据集构造新的数据集</h2><p id="1faf" class="pw-post-body-paragraph jn jo hy jp b jq lx iz js jt ly jc jv jw lz jy jz ka ma kc kd ke mb kg kh ki hb bi translated">给定注释对的验证数据集，并且知道平均来说，它们中的每一个在数据集中出现大约三次，我们可以进行一些周排序，并将其缩放到范围(0，1)中，并将其用作具有软标签的新训练数据集。</p><h2 id="a47c" class="mm lg hy bd lh mn mo mp ll mq mr ms lp jw mt mu lr ka mv mw lt ke mx my lv mz bi translated">超参数搜索</h2><p id="bfa0" class="pw-post-body-paragraph jn jo hy jp b jq lx iz js jt ly jc jv jw lz jy jz ka ma kc kd ke mb kg kh ki hb bi translated">与任何机器学习模型一样，选择最佳超参数以从特定模型中获得最大收益至关重要。在Flash与Transformers集成的情况下，我们可以优化模型架构、优化器、调度器、学习率、标记器等等。<a class="ae hv" href="https://lightning-flash.readthedocs.io/en/stable/general/flash_zero.html" rel="noopener ugc nofollow" target="_blank"> Flash Zero CLI </a>揭示了所有这些，并且可以使用云培训工具进行清理。</p><div class="hh hi ez fb hj kq"><a href="https://towardsdatascience.com/hyperparameter-optimization-with-grid-ai-and-no-code-change-b89218d4ff49" rel="noopener follow" target="_blank"><div class="kr ab dw"><div class="ks ab kt cl cj ku"><h2 class="bd hz fi z dy kv ea eb kw ed ef hx bi translated">使用Grid.ai进行超参数优化，无需更改代码</h2><div class="kx l"><h3 class="bd b fi z dy kv ea eb kw ed ef dx translated">用PyTorch闪电和网格点实例在Kaggle上排名的最佳实践(第4/5部分)</h3></div><div class="ky l"><p class="bd b fp z dy kv ea eb kw ed ef dx translated">towardsdatascience.com</p></div></div><div class="kz l"><div class="np l lb lc ld kz le hp kq"/></div></div></a></div><p id="5054" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><strong class="jp hz"> <em class="km">你对更酷的PyTorch闪电集成感兴趣吗？<br/>关注我，加入我们神奇的</em></strong><a class="ae hv" href="https://join.slack.com/t/pytorch-lightning/shared_invite/zt-pw5v393p-qRaDgEk24~EjiZNBpSQFgQ" rel="noopener ugc nofollow" target="_blank"><strong class="jp hz"><em class="km">Slack</em></strong></a><strong class="jp hz"><em class="km">社区！</em> </strong></p></div><div class="ab cl nq nr gp ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="hb hc hd he hf"><h1 id="eb50" class="lf lg hy bd lh li nx lk ll lm ny lo lp je nz jf lr jh oa ji lt jk ob jl lv lw bi translated">关于作者</h1><p id="5396" class="pw-post-body-paragraph jn jo hy jp b jq lx iz js jt ly jc jv jw lz jy jz ka ma kc kd ke mb kg kh ki hb bi translated"><a class="ae hv" rel="noopener" href="/@jborovec"> <strong class="jp hz">吉尔卡·博罗维克</strong> </a>拥有CTU的计算机视觉博士学位。他已经在几家IT创业公司和公司从事机器学习和数据科学工作几年了。他喜欢探索有趣的世界问题，用最先进的技术解决它们，并开发开源项目。</p></div></div>    
</body>
</html>