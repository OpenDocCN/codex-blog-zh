# 2022 年构建 NodeJS API 是什么样的？

> 原文：<https://medium.com/codex/what-is-it-like-building-a-nodejs-api-in-2022-494b279d3520?source=collection_archive---------18----------------------->

对于一个学校项目，我们有机会探索一些新技术。这给了我们第一次使用 NodeJS 的机会，看看它能提供什么。

NodeJS 是一个开源的多平台 JavaScript 运行时环境，内置 HTTP 服务器。顾名思义，它使用 Javascript，你可能已经从很多网站前端知道了。近年来，[它变得非常受欢迎。这是](https://trends.google.com/trends/explore?date=all&q=nodejs)[也是无服务器计算](https://trends.google.com/trends/explore?date=all&q=serverless%20computing)的情况，它可以很容易地用于。

![](img/04cf054f3389bad016889a86c2f5b122.png)

当你说节点，你说 NPM！

它非常简洁，因此速度很快。有[超过一百万个开源包](https://snyk.io/blog/npm-passes-the-1-millionth-package-milestone-what-can-we-learn/)可以让你轻松扩展它的功能。对我来说，最大的挑战是在这种脚本语言中找到一个好的软件架构。在这篇文章中，我将带你浏览我的发现和结论。

## 调酒师应用程序

这篇文章将主要讲述我们使用 NodeJS 的经验，但是我们仍然想解释我们使用它的目的以及我们为什么选择它。我们有机会选择自己的项目和技术。我们想出了一个主意，创建一个应用程序，可以很容易地跟踪消费。因为我们都在关联中，所以我们熟悉正确跟踪这一点的所有额外问题。通过我们的应用程序，我们希望改变这种情况。

我们选择 NodeJS 作为后端，因为我们发现它非常有趣。颤振也是一项新技术。它允许你编写应用程序和网站。我们会将它用于可以显示消费的应用程序，以及可以管理一切的网站。应用程序和网站可以用同一种语言编写当然很容易，但在实践中，相当新的 Flutter web 还不够合适。因此，我们后来决定为网站使用更广为人知的角度框架。这对我们来说也是一项新技术，但它更接近于我们熟悉的 web 开发。

## 现在回到 NodeJS…

## 路由器

Express 是 NodeJS 的首选 web 框架。它包含了网络服务器所有最重要的特性，但在我看来，最重要的是路由器。

您可以将中间件功能与某些路径相关联。这些函数是在访问满足特定正则表达式的路径时按顺序执行的。例如，这使得预先添加一些安全或认证中间件变得很容易。为了保持架构的简单和可读性，我编写了 decorators，使得将函数分配给某个路径成为可能。同样为了认证，我写了一个装饰器来激活适当的中间件。

```
@Get('/club')
@RequiresAdmin()
async getClub(req: Request, res: Response) {
    return res.status(200).json(req.club);
}
```

当您编写自己的装饰器时，它实际上只是一个从“MethodDecorator”类型继承的函数。当装饰器在某个地方被使用时，这个函数用所有的参数和元数据来调用。我的路由装饰器将所有参数存储为附加元数据。因此，当应用程序启动时，将检索所有信息并手动创建路线。

## 数据库ˌ资料库

我们早已摆脱了编写自己的数据库查询的习惯。ORM(对象关系映射)比自己编写查询有很多优势。它易于实现并且速度很快(如果使用正确的话)。它还在应用程序中保持了良好的面向对象结构。

![](img/d650a184fc505066471c40c3dd334fce.png)

截图来自[https://npmjs.com/](https://www.npmjs.com/package/typeorm)

TypeORM 是 typescript 中即将推出的 ORM 包。它得到了积极的维护，去年它的受欢迎程度翻了一番。所以它非常适合我们的项目。安装只需要一个“npm install”命令。当您用正确的数据库数据修改“ormconfig.json”文件时，您可以立即开始。我们将模型和存储库创建为常规类，一切都可以立即工作。例如，要检索具有特定 ID 的项目，您需要“await itemRepository.findOne(id)”。如果我们想进行修改，我们修改检索到的对象，并用` await itemRepository.save(item)'更新数据库。

## 结论

通过简单路由和数据库 ORM 的结合，编写一个 API 是非常容易的。我们也很快为其他问题找到了合适的包，比如上传和调整图像大小。我们有一个结构化的架构，每个人都可以马上找到自己的路。一切都很简单，项目运行也很快。将来，我们可以通过寻找额外的验证或其他包来进一步简化代码。

总而言之，我们对 NodeJS 非常满意。我们希望在未来更频繁地使用它，尤其是对于简单的 API 应用程序。