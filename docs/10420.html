<html>
<head>
<title>Quick Start Apache SeaTunnel</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">快速启动阿帕奇海底隧道</h1>
<blockquote>原文：<a href="https://medium.com/codex/quick-start-apache-seatunnel-aca9ef6c90c7?source=collection_archive---------6-----------------------#2022-12-29">https://medium.com/codex/quick-start-apache-seatunnel-aca9ef6c90c7?source=collection_archive---------6-----------------------#2022-12-29</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/f0acba3f048139876e05c348d1af8d4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9C8B-AFRnC8WgegPTOkvmA.png"/></div></div></figure><p id="86a5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">朝田，阿帕奇海底隧道(孵化)PPMC &amp;委托人</p><p id="e1fc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">今天我将从0到1介绍Apache SeaTunnel(孵化)，主要从以下六个方面。</p><p id="4bf3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">1.数据集成概念的简要概述。</p><p id="a68c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">2.海底隧道简介。</p><p id="5179" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">3.介绍海底隧道的基本原理和结构演变。</p><p id="193e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">4.比较目前市场上一些流行的数据集成工具，解释为什么我们要重新发明轮子，因为现在市场上已经有这么多的数据集成工具了。</p><p id="ebb5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">5.通过案例演示展示SeaTunnel的强大功能。</p><p id="6f32" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">6.介绍一下SeaTunnel的路线图，包括我们目前在做什么，未来想做什么。</p><h1 id="550b" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">数据集成概述</h1><p id="82a9" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">在介绍数据集成之前，我们首先要问一个问题，<strong class="is hj">什么是数据集成？</strong>说起来，数据集成就是将不同来源格式和特征的数据在逻辑上或物理上集中起来，为企业提供全面的数据共享。企业可以通过高度集中的数据快速做出一系列分析和决策，实现数据利用的价值。</p><figure class="ks kt ku kv fd ij er es paragraph-image"><div class="er es kr"><img src="../Images/7610c7d6e383eb10cc7358f833064879.png" data-original-src="https://miro.medium.com/v2/resize:fit:1132/format:webp/1*qLLc20uUsjJT5N8JxJjuSg.png"/></div></figure><p id="06e9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">公司的每个业务部门负责不同的业务线，每天都会产生海量的数据。如果这些数据得到有效的集中和处理，企业可以通过这些数据获得更多的商业机会。</p><p id="78b4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">那么第二个问题，<strong class="is hj">我们为什么需要做数据整合？</strong>在一个企业中，由于开发时间或开发部门不同，往往会有多个异构的信息系统同时运行在不同的软硬件平台上。这些系统的数据源相互独立又相互靠近，导致系统间的数据沟通、共享、集成困难，形成了“信息孤岛”。数据集成可以有效地合并和集成异构数据源，打破“信息孤岛”。</p><figure class="ks kt ku kv fd ij er es paragraph-image"><div class="er es kw"><img src="../Images/006e0290798fc443f20fda09f3f20d47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1330/format:webp/1*QRQIa0pe_ex9FLXjFbh1Ig.png"/></div></figure><p id="fdce" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">以某银行为例。该银行可能同时拥有营销业务和信贷业务。如果信贷业务想从营销业务中获取数据，那是不可能的，因为不同的业务部门可能使用不同的技术栈，有些数据存储在数据仓库中，比如Greenplum或者Oracle，有些数据存储在Hadoop集群中，那么如何共享不同数据库的前期数据呢？这时候就需要数据集成层来做这些事情。我们需要建立一个中间层，将数据规范化、统一化，导入到相应的数据仓库中。这样我们每个业务部门都会从其他部门获取数据，更好的实现数据的价值。</p><p id="0892" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">先说数据集成中的几个核心概念，也就是我们常说的ETL。ETL中的e代表extract，数据抽取；t是Transform，代表数据转换；l代表Load，数据加载。</p><figure class="ks kt ku kv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kx"><img src="../Images/c2525b38bd24aaab17ab3abf92940dcc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KXREGGoU_t0pBBdeBFdzJQ.png"/></div></div></figure><p id="22bf" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">ETL是整个数据集成中最重要的三个步骤。在旧的数据集成架构中，更多的是ETL架构。以Flink和Spark分布式计算引擎为例，它们拥有非常强大的计算能力，同时在转换方面，提供了许多方便易用的运算符来进行数据清理和转换。</p><p id="b1bb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">整个数据处理就是提取数据，然后在计算引擎端进行数据转换，也就是说数据在数据集成层进行转换，然后加载到目标Sink端。</p><p id="01f9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这种方法的缺点是什么？即当数据抽取量较大时，所有的数据计算压力都放在数据集成层，会给数据集成层造成巨大的负担，所以我们需要更多的计算资源，计算过程中的容错也比较困难。</p><p id="88a0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了解决这些问题，并且随着技术的发展，源和宿数据库对应的计算能力增加了，利用它们的计算能力转换数据的效率提高了。渐渐的，数据集成的架构从ETL变成了ELT，T的数据操作被上推或者下移到对应的源端或者宿端。</p><p id="d9c0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这样做的好处是，第一，避免了源端和宿端的资源浪费，可以用它们来优化自己保存的数据，以提高数据转换的效率。第二个好处是减少数据集成中间层的压力，因为在提取数据后，我们不需要转换数据，这将避免内存丢失。而将提取的数据直接加载到对应的目标端，会使得数据整合更加高效。</p><h1 id="09c2" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">Apache SeaTunnel简介</h1><p id="c131" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">让我们看看SeaTunnel是做什么的。SeaTunnel是一个非常易用的超高性能分布式数据集成平台，支持海量数据同步。由中国工程师开发，捐赠给阿帕奇基金会；SeaTunnel的名字灵感来源于小说《三体》中摧毁数千艘战舰的坚不可摧的水滴。</p><p id="0f21" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">阿帕奇海底隧道的特点</strong></p><figure class="ks kt ku kv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/a58e0064ed018217b067a536df3f98dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tvIRnq7sHBWAqDry9OkhJA.png"/></div></div></figure><p id="3da4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">首先，SeaTunnel最大的一个特点就是简单易用，不需要开发。用户可以通过学习配置文件快速开发当前的数据任务。</p><p id="1f56" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">二是升级架构，整合批处理和流。现在，我们可以管理流作业和批处理作业。</p><p id="21fe" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">第三，支持异构多数据源。从架构图中可以看出，SeaTunnel支持HDFS、Hive和JDBC等数据源，以及Kafka、Pulsar和CDC等流数据源。</p><p id="4efe" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">同时，SeaTunnel还支持无缝接入多个计算引擎，如Spark2.4.X+和Flink1.13.X计算引擎。社区的开发路线图将支持更高版本的计算引擎，我们期待更多的人加入进来，为使SeaTunnel变得更好做出贡献。</p><p id="aa0e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">此外，SeaTunnel是模块化和插入式设计。整个框架通过SPI将插件动态加载到框架中。如果企业有定制需求，可以使用预留接口快速实现满足其业务需求的插件。</p><p id="76d1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">值得注意的是，SeaTunnel发布了一款自主研发的计算引擎。这款计算引擎主要针对缺乏大数据资源的用户，因为旧架构SeaTunnel只能依靠Spark或Flink计算引擎运行。但目前SeaTunnel已经完全从计算引擎中解构出来，有了它的计算引擎，大大降低了部署成本，提高了易用性。</p><p id="f6a1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最后，SeaTunnel最大的特点是已经无缝连接CDC，可以支持CDC同步。</p><h1 id="5510" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">原则和架构演变</h1><p id="d38e" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">接下来，我们来谈谈SeaTunnel的核心原则和底层架构演进。</p><h2 id="dc32" class="ky jp hi bd jq kz la lb ju lc ld le jy jb lf lg kc jf lh li kg jj lj lk kk ll bi translated">核心设计原则</h2><p id="d699" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">SeaTunnel设计的核心是在设计模式中使用“控制反转”或“依赖注入”，主要概括为以下两点:</p><ol class=""><li id="9bc3" class="lm ln hi is b it iu ix iy jb lo jf lp jj lq jn lr ls lt lu bi translated">上层不依赖底层，都依赖抽象；</li><li id="61cd" class="lm ln hi is b it lv ix lw jb lx jf ly jj lz jn lr ls lt lu bi translated">流程代码和业务逻辑应该分离。整个数据处理过程大致可以分为以下几个过程:输入-&gt;转换-&gt;输出。对于更复杂的数据处理，它本质上是这些行为的组合:</li></ol><figure class="ks kt ku kv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ma"><img src="../Images/729debe11352c480251f9991bba7ab94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0dzX-J3DH6vw2Vk2mkjWXg.png"/></div></div></figure><p id="eb26" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这三个术语熟悉吗？它代表了我们刚刚谈到的数据集成中的核心概念。ETL就是基于这些高度抽象的行为，然后丰富其插件，定制业务处理流程。</p><p id="f013" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然后，在我们丰富了这些数据处理过程之后，我们可以使用这三种行为来组合不同的有向无环图，以丰富整个数据处理过程。</p><h2 id="0745" class="ky jp hi bd jq kz la lb ju lc ld le jy jb lf lg kc jf lh li kg jj lj lk kk ll bi translated">核心原则</h2><p id="ea21" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">接下来我就来说说SeaTunnel的核心原理。SeaTunnel将数据处理的各种行为抽象成插件，使用Java SPI技术进行动态注册。设计思想保证了框架的灵活扩展。基于以上理论基础，数据的转换和处理也需要统一的抽象。例如，众所周知的异构数据源同步工具DataX也对数据的单个记录进行了统一抽象。</p><p id="151c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在SeaTunnel架构系统中，由于Spark和Flink两大分布式计算框架，框架已经为我们做好了数据源抽象的工作。Flink的DataStream和Spark的DataFrame对于访问数据源已经是高度抽象的了。在此基础上，我们只需要在插件中处理这些数据抽象。同时，借助Flink和Spark提供的SQL接口，我们还可以将每个处理后的数据注册为一个表，方便用SQL处理，减少代码开销；在最新的SeaTunnel架构中，SeaTunnel提供了它的类型抽象来与引擎解耦。</p><h2 id="cceb" class="ky jp hi bd jq kz la lb ju lc ld le jy jb lf lg kc jf lh li kg jj lj lk kk ll bi translated">建筑进化</h2><p id="e9a5" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">纵观海底隧道架构的演变过程，我们目前正在做的事情之一是将架构从v1改造和升级到v2。</p><figure class="ks kt ku kv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mb"><img src="../Images/1b944870b60b0ed98ad79c31a55a0e12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ukD5zTa81YhUDhRq6kvMOQ.png"/></div></div></figure><p id="78be" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对于V1版本，SeaTunnel本质上是一个ETL平台。V2版本正朝着英语教学的方向发展。对于整个建筑和设计理念的讨论，我们可以参考<a class="ae mc" href="https://github.com/apache/incubator-seatunnel/issues/1608." rel="noopener ugc nofollow" target="_blank">https://github.com/apache/incubator-seatunnel/issues/1608.</a>如果你有兴趣，可以了解一下海底隧道建筑演变的前世今生。</p><figure class="ks kt ku kv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/bc13b3f416d5e13c74dd83ad3c98b9dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GtuHQ4DjM_LdB8tn6-pSFQ.png"/></div></div><figcaption class="md me et er es mf mg bd b be z dx translated">V1建筑</figcaption></figure><p id="4b46" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在V1架构中，SeaTunnel的连接器和异构数据强烈依赖于分布式计算引擎。对于不同的计算引擎，会有不同的API层。连接器也依赖于Spark和Flink，已经开发的连接器本质上是Spark连接器和Flink连接器。</p><p id="868f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">访问数据后，转换传入的数据，然后将其写出。虽然是这种设计理念下的低代码开发，但是很多细节是不需要考虑的，因为开源的Spark和Flink的连接器已经为我们解决了大部分问题，但其实这也是一个缺陷。第一，由于对计算引擎的依赖性很强，我们无法与引擎解耦，而且每当计算引擎升级到主要版本时，都需要进行大量的底层转换，难度相对较大。</p><figure class="ks kt ku kv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/b83c93158fab531fabc96166fd12f470.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HcreGhsU4PeDUHxpN31KbQ.png"/></div></div><figcaption class="md me et er es mf mg bd b be z dx translated">V2建筑</figcaption></figure><p id="8257" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">针对这些痛点，我们重构了V2版本。首先，V2版本有自己的一套API和自己的一套数据类型，所以你可以不依赖任何引擎来开发你的连接器。访问的每一条数据都是SeaTunnelRow，通过转换层，推送到对应的计算引擎。</p><p id="fd37" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">从底层来说，我们的实现是统一的。为了适应不同的引擎版本，我们只需要开发不同的翻译层。即使引擎进行了大规模的API升级，我们只需要创建一个新的翻译层，旧版本完全不受影响。这是V2版本的最大好处。</p><p id="08fe" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">另外，我们也在V2架构上做相应的web服务工作。我们有一些计划。首先，将有一个作业IDE，也就是说，一个作业编辑页面，具有一系列高级功能，如智能提示、数据源管理等。二是会有作业设计器高级设计版本功能，可以用不同的数据源参数替换，也可以根据不同的需求实现，一个模板可以生成多个作业。</p><p id="89cf" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">与此同时，我们还在规划我们的调度程序。社区已经访问了Apache DolphinScheduler，并将很快在下一个版本中提供。</p><p id="386b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最后也是我们整个服务工作的重要一环，就是创建我们的Alert和相应的Matrix系统来做作业预警，收集推送作业指标，完整管理作业流程。</p><p id="61b4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最后，我将总结和比较V1和V2架构的升级，以及我们所做的工作。</p><figure class="ks kt ku kv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mh"><img src="../Images/06873990acaded0b3c1234874d9bf4dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ukc8ixcUDEOQ8POxowmuHQ.png"/></div></div></figure><p id="d93f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">首先，在引擎依赖方面，V1强烈依赖Spark和Flink，而V2没有依赖，自带计算引擎，可以直接用于部署。</p><p id="9c21" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">其次，就连接器实现而言，对于不同的引擎，V1可能需要实现多次，而我们只需要用我们的API实现V2一次。</p><p id="aa35" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">第三，升级V1引擎版本比较难，因为底层API与引擎高度耦合，而升级V2引擎版本比较容易，因为我们与引擎解耦了，针对不同版本开发了不同的翻译层。在连接器参数的统一方面，V1针对不同的发动机会有不同的参数。V1为此长期受到批评，而V2解决了这个问题。所有参数和功能统一，降低用户使用和学习成本。</p><p id="9dbc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最后，在自定义分片逻辑方面，在V1架构下，由于强烈依赖Spark和Flink的连接器，部分分片逻辑已经在底层实现，数据提取效率不高，除非更改Spark的源代码，然后重新编译，否则无法更改分片逻辑。对于这一点，V2可以自定义分片逻辑，我们可以自由发挥想象力，数据提取效率可控，可以根据不同的业务需求进行修改。</p><h2 id="4e83" class="ky jp hi bd jq kz la lb ju lc ld le jy jb lf lg kc jf lh li kg jj lj lk kk ll bi translated">V2建筑的新特点</h2><p id="ccbd" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">建筑升级后，V2建筑有了一些新的特点。</p><ul class=""><li id="8479" class="lm ln hi is b it iu ix iy jb lo jf lp jj lq jn mi ls lt lu bi translated">多版本、多引擎支持</li><li id="5a73" class="lm ln hi is b it lv ix lw jb lx jf ly jj lz jn mi ls lt lu bi translated">支持多个版本的Flink引擎，完美支持Flink的检查点进程</li><li id="f88f" class="lm ln hi is b it lv ix lw jb lx jf ly jj lz jn mi ls lt lu bi translated">支持Spark微批量处理模式，支持聚合提交功能</li><li id="fad0" class="lm ln hi is b it lv ix lw jb lx jf ly jj lz jn mi ls lt lu bi translated">自研引擎SeaTunnel Engine，专为数据同步场景设计的引擎。凭借其内部引擎，这些企业缺乏大数据生态系统，或者为追求数据同步最佳体验的用户提供了可选的解决方案</li></ul><p id="20ea" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">基于这些特性，SeaTunnel实现了三项优化。首先，它支持源/转换/接收的并行处理，以提高吞吐量性能。其次，它支持分布式快照算法、两阶段提交和等幂写，实现从源到汇的一次语义，并保证无数据丢失，以及断点续传等高级功能。第三，基于引擎提供的实时处理或微批处理实现低延迟。</p><h2 id="094b" class="ky jp hi bd jq kz la lb ju lc ld le jy jb lf lg kc jf lh li kg jj lj lk kk ll bi translated">海底隧道发动机性能试验</h2><figure class="ks kt ku kv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mj"><img src="../Images/f42b953bccced88a80b97ef41532c730.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aTPzSad-RpUFD1lrYItwVA.png"/></div></div></figure><p id="0909" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们还与DataX进行了性能测试比较。在同样的千万级作业下，我们对比了不同并发和堆内存下的性能。结果表明，SeaTunnel引擎比DataX花费的时间少得多，特别是在200 MB的小内存中。在这种情况下，SeaTunnel引擎表现非常出色，性能比DataX高出30~40%。</p><h1 id="454f" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">数据集成工具比较</h1><p id="82d4" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">下面是我们常用的一些数据集成工具的比较，也回答了你的问题，我们为什么要重新发明轮子？</p><p id="f409" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对比的工具有大家都比较熟悉的DataX，也有大家可能不太熟悉的戴书云的春军。改名前叫FlinkX，最近刚入驻阿帕奇孵化器的StreamPark(原名StreamX)。</p><figure class="ks kt ku kv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mk"><img src="../Images/9dcd05e2269ac71dd89947d4860b4ef0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yI9p_fBFdjuVKWH-2xcgbw.png"/></div></div></figure><p id="0e7c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">首先，从定位上来说，Apache SeaTunnel是一个数据集成平台而不是一个简单的工具。未来会提供很多平台服务，改善运营流程和运营生命周期。但DataX和春军目前只是工具，不提供服务。</p><p id="d826" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">所有这些以ELT为核心的数据同步工具或平台。StreamPark定位为ETL作业管理开发平台，主要分为两部分，Flink作业的管理，提供快速开发SDK，减轻开发者的开发压力。</p><p id="ce9a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">有了StreamPark提供的SDK，可以快速做Flink作业或者Spark作业，减少代码开发量，从定位上来说是不一样的。</p><p id="8a9f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">第二，在发动机依赖方面，SeaTunnel对发动机进行了解耦，我们可以选择自己的发动机，包括Spark发动机或者Flink发动机。DataX也是独立于引擎的，因为它是纯Java开发的，也就是你安装打包，然后部署运行，前提是有Java环境。</p><p id="fb03" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">春军对Flink的依赖性很强，需要基于Flink的组件进行二次开发和连接器优化。</p><p id="7507" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">StreamPark的定位是开发管理平台，同样依赖于引擎。引擎版本支持方面，SeaTunnel目前只支持Spark 2.2.X — 2.4.X，正在支持Spark 3，Flink目前支持1.10.X — Flink 1.13.X，更高版本支持也在测试稳定性，因为升级更高版本的Flink的API比较麻烦。</p><p id="73b7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">DataX没有引擎依赖，是纯Java版本，所以对引擎版本没有要求。</p><p id="bdc8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">春军目前支持Flink1.8.X — Flink1.12.X，但对更高版本的支持较差。</p><p id="d4aa" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">StreamPark在这方面做的很好，支持Flink 1.16作业的管理，Spark的作业管理也在开发中。</p><p id="19a3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">从部署难度来看，SeaTunnel、DataX、Chunjun的部署相对容易，因为它们不涉及后端和前端的部署或者数据库的要求。它们本质上是一个工具，一旦安装了Java环境，就可以在安装后运行，并配置环境变量。</p><p id="e693" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对于StreamPark来说，因为是前端和后端的项目，所以部署和维护比较困难。在精确一次性语义方面，由于SeaTunnel在V2架构中完美支持Flink的检查点流程，在ST Engine中也支持更细粒度的检查点，所以有些连接器支持一次性语义，但DataX不支持。</p><p id="42c7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因为春军也依赖于Flink的检查点，所以也支持一次性语义。StreamPark本身是ETL作业的开发和管理平台，可以保证作业的正常状态，但不支持数据同步或数据处理。</p><p id="1384" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">经过多维度的对比，我们看到了每个工具的优缺点，也回答了为什么要做SeaTunnel的问题，因为现在的一些工具不能满足所有的需求，所以我们借鉴别人的经验，做出一个更好的工具。</p><p id="6fd0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Data X是2017年开源的工具。5年后，依然流行。这可以看作是数据集成的一种新思路和新趋势。随着大数据技术的不断进步和发展，我希望我们的技术也能进步，所以我们会打造这样一个平台来回馈大家。</p><h1 id="988a" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">海底隧道功能演示</h1><p id="9b0c" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">接下来是一个简单的SeaTunnel功能演示。</p><figure class="ks kt ku kv fd ij"><div class="bz dy l di"><div class="ml mm l"/></div></figure><figure class="ks kt ku kv fd ij"><div class="bz dy l di"><div class="ml mm l"/></div></figure><h1 id="96a5" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">海底隧道路线图</h1><figure class="ks kt ku kv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mn"><img src="../Images/114af3a4d80f30daf6f668b8f49b51ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ppwrnt-9EGoxEM8dPZ77Ow.jpeg"/></div></div></figure><p id="e79b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最后，看看SeaTunnel的发展路线图，包括目前的一些工作和计划。</p><h2 id="281a" class="ky jp hi bd jq kz la lb ju lc ld le jy jb lf lg kc jf lh li kg jj lj lk kk ll bi translated">当前工作</h2><p id="c05c" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">连接器的访问和优化</p><p id="cffe" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最高优先级是连接器的访问和优化。虽然已经有80多个连接器，但在性能、具体代码和逻辑方面仍有优化的空间，因此我们将重点优化连接器，添加更多的配置参数，并以更详细的方式控制操作过程。</p><p id="be1c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">海底隧道-网络服务开发</strong></p><p id="de94" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">第二个是我们现在正在进行的基于Web服务的SeaTunnel开发。这个工具已经成型，但不是一键就能部署的。我们的目标是让它开箱即用，你可以拖拽完成数据集成、数据迁移、数据同步、数据监控等一系列数据集成任务。</p><p id="0361" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">海底隧道发动机优化</strong></p><p id="5381" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">第三，SeaTunnel Engine发布了第一个MVP版本，支持集群和单机模式。目前我们已经让它的性能比DataX提升了30~40%，但我相信这不是我们的瓶颈。未来，我们可以在数据传输和整个过程中做更多的工作来提高性能。</p><h2 id="66d2" class="ky jp hi bd jq kz la lb ju lc ld le jy jb lf lg kc jf lh li kg jj lj lk kk ll bi translated">继续推</h2><ol class=""><li id="d30c" class="lm ln hi is b it km ix kn jb mo jf mp jj mq jn lr ls lt lu bi translated"><strong class="is hj">优化指标监控系统</strong></li></ol><p id="f7d9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">目前，SeaTunnel在获取当前操作流程的进度方面相对较弱，我们将在未来重点改进这一点。</p><p id="8465" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果您有相关工作的想法或经验，欢迎加入我们，与我们共同构建指标监控体系。</p><p id="bd3c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 2。脏数据收集、流量控制</strong></p><p id="d82f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">目前，当连接器正在转换数据或报告写入错误时，整个操作将停止。但是它不应该停止。之所以会出现这种情况，是因为在整个数据访问过程中，各种数据都被录入了，但是数据清洗并没有达到预期的目标。这些脏数据的收集应该由系统来处理，并及时进行提醒。</p><p id="42f4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">另一个目标是控制流量，因为现在很多客户的机器可能都在云上，云上会有带宽限制。目前，SeaTunnel的带宽在工作时会满，我们将在未来增加流量控制功能。</p><p id="78d7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 3。自动创建表并监控模式变化</strong></p><p id="e1ab" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">自动创建表格也是很多用户的痛点。比如出库表有五六十个字段，为这五六十个字段写建表SQL很累。我们计划支持自动创建表，这也是接收器端的一个开关。如果用户想自动创建一个表，就打开它，如果不想，就关闭它。</p><p id="6c1c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为CDC方案设置了监控方案变更。目前，如果模式发生更改，必须通知后续的同步行为，并且必须进行一些更改。</p><p id="c0da" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 4。支持Spark3，Flink1.14+ </strong></p><p id="2fc2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们将积极推动对更高版本计算引擎的支持，像支持Spark3和Flink1.14+。</p><p id="263a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">虽然计算引擎已经与Spark和Flink解耦，但仍然需要站在巨人的肩膀上，站在技术的前沿，让数据整合更加顺畅。</p><p id="4b33" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最后，我们的愿景是成为世界级的数据集成平台。如果您需要与我讨论数据集成或海底隧道设计理论或功能需求，欢迎与我们交流。</p></div></div>    
</body>
</html>