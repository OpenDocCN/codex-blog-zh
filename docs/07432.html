<html>
<head>
<title>Clustering Algorithm for Driver Segmentation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">驾驶员细分的聚类算法</h1>
<blockquote>原文：<a href="https://medium.com/codex/clustering-algorithm-for-driver-segmentation-9e5d18ed30cf?source=collection_archive---------21-----------------------#2022-06-14">https://medium.com/codex/clustering-algorithm-for-driver-segmentation-9e5d18ed30cf?source=collection_archive---------21-----------------------#2022-06-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="32c4" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated"><strong class="ak">根据每天行驶的平均距离和平均超速百分比对驾驶员进行分组</strong></h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/d914b0778ec697bcfcd543ed7897f4e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*vk7M_hvWiEWQ74Yl"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">由<a class="ae jn" href="https://unsplash.com/@nicolaspeyrol?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">尼古拉斯·佩罗尔</a>在<a class="ae jn" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="80a5" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">你好，欢迎来到我的文章！在这篇文章中，你将学习当你有未标记的数据时如何使用聚类技术。使用KMeans集群，您将能够通过考虑各种特征来对它们进行集群。让我们开始吧。</p></div><div class="ab cl kk kl gp km" role="separator"><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp"/></div><div class="hb hc hd he hf"><h2 id="9aa8" class="kr ks hi bd kt ku kv kw kx ky kz la lb jx lc ld le kb lf lg lh kf li lj lk ll bi translated">数据集描述</h2><p id="1839" class="pw-post-body-paragraph jo jp hi jq b jr lm ij jt ju ln im jw jx lo jz ka kb lp kd ke kf lq kh ki kj hb bi translated">在这里找到数据集<a class="ae jn" href="https://www.kaggle.com/datasets/dhruvalpatel30/driver-dataset" rel="noopener ugc nofollow" target="_blank"><strong class="jq hj"><em class="lr"/></strong></a>。为了简单起见，只取两个特征:</p><ol class=""><li id="dee9" class="ls lt hi jq b jr js ju jv jx lu kb lv kf lw kj lx ly lz ma bi translated">平均每天行驶的距离</li><li id="8901" class="ls lt hi jq b jr mb ju mc jx md kb me kf mf kj lx ly lz ma bi translated">司机超过限速每小时5英里以上的平均时间百分比</li></ol><p id="b630" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">以下是数据所代表的内容:</p><ul class=""><li id="e3ce" class="ls lt hi jq b jr js ju jv jx lu kb lv kf lw kj mg ly lz ma bi translated"><strong class="jq hj"> id: </strong>司机的唯一id</li><li id="60cc" class="ls lt hi jq b jr mb ju mc jx md kb me kf mf kj mg ly lz ma bi translated"><strong class="jq hj"> mean_dist_day: </strong>驾驶员每天驾驶的平均距离</li><li id="666e" class="ls lt hi jq b jr mb ju mc jx md kb me kf mf kj mg ly lz ma bi translated"><strong class="jq hj"> mean_over_speed_perc: </strong>司机超过限速5英里/小时的平均时间百分比&gt;</li></ul></div><div class="ab cl kk kl gp km" role="separator"><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp"/></div><div class="hb hc hd he hf"><p id="8a75" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj"> <em class="lr"> (1)导入所需库和数据集— </em> </strong></p><pre class="iy iz ja jb fd mh mi mj mk aw ml bi"><span id="2d89" class="kr ks hi mi b fi mm mn l mo mp">import numpy as pn<br/>import pandas as pd<br/>import sklearn<br/>import matplotlib.pyplot as plt<br/>import seaborn as sns<br/>sns.set()<br/>import warnings<br/>warnings.filterwarnings(‘ignore’)<br/>%matplotlib inline</span></pre><p id="f9ff" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">首先，导入所需的库，然后导入数据集。</p><pre class="iy iz ja jb fd mh mi mj mk aw ml bi"><span id="143f" class="kr ks hi mi b fi mm mn l mo mp">df=pd.read_csv('driver-data.csv')<br/>df.head()</span></pre></div><div class="ab cl kk kl gp km" role="separator"><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp"/></div><div class="hb hc hd he hf"><p id="ea92" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj"> <em class="lr"> (2)检查信息和必要数据分布— </em> </strong></p><pre class="iy iz ja jb fd mh mi mj mk aw ml bi"><span id="3b26" class="kr ks hi mi b fi mm mn l mo mp"># Check the no. of records - it should be 4000<br/>df.info()</span><span id="6a19" class="kr ks hi mi b fi mq mn l mo mp"># Check the basic distribution of data<br/>df.describe()</span></pre><p id="cbd2" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我们准备使用聚类技术，但是有一个问题。我们应该使用多少个集群？因此，我们将利用肘方法来确定集群的数量。</p></div><div class="ab cl kk kl gp km" role="separator"><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp"/></div><div class="hb hc hd he hf"><p id="d636" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj"> <em class="lr"> (3)用肘法确定聚类数— </em> </strong></p><p id="6aa9" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">WCSS(聚类平方和内)是聚类中每个点与其质心之间距离的平方和。当我们用K值绘制WCSS时，我们得到一个<a class="ae jn" href="https://www.scikit-yb.org/en/latest/api/cluster/elbow.html" rel="noopener ugc nofollow" target="_blank"><strong class="jq hj"><em class="lr"/></strong></a>。</p><p id="eb94" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">WCSS值随着集群数量的增加而减小。当K = 1时，WCSS值最高。</p><p id="dc62" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我们将使用Yellowbrick，它是一个结合了scikit-learn和matplotlib的Python库。Yellowbrick增强了Scikit-Learn API，使模型选择和超参数调整更加容易。Matplotlib在后台使用。</p><pre class="iy iz ja jb fd mh mi mj mk aw ml bi"><span id="5c38" class="kr ks hi mi b fi mm mn l mo mp">!pip install yellowbrick #if you haven't install yellowbrick yet<br/>from yellowbrick.cluster import KElbowVisualizer<br/>model = KMeans()<br/>visualizer = KElbowVisualizer(model, k=(1,12)).fit(df)<br/>visualizer.show()</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mr"><img src="../Images/55275986bd52f5bb9243c427eaccb68b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1076/format:webp/1*eLUVNCvxNWaqVtK8vALpeA.png"/></div><figcaption class="jj jk et er es jl jm bd b be z dx translated"><strong class="bd kt">用于k均值聚类的弯头</strong></figcaption></figure><p id="42e9" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这里，聚类的最佳数量= 3或k = 3。</p></div><div class="ab cl kk kl gp km" role="separator"><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp"/></div><div class="hb hc hd he hf"><p id="1b35" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj"> <em class="lr"> (4)运行K=3的算法— </em> </strong></p><pre class="iy iz ja jb fd mh mi mj mk aw ml bi"><span id="8875" class="kr ks hi mi b fi mm mn l mo mp"><strong class="mi hj"># using the KMeans from sklearn<br/></strong>from sklearn.cluster import KMeans</span><span id="7b0c" class="kr ks hi mi b fi mq mn l mo mp"><strong class="mi hj"># create an instance of a k-means model with 3 clusters<br/></strong>kmeans = KMeans(n_clusters = 3)<br/>df_analyze = df.drop('id',axis=1)</span><span id="56d6" class="kr ks hi mi b fi mq mn l mo mp"><strong class="mi hj"># fit the model to all the data, except for the id label<br/></strong>kmeans.fit(df_analyze)</span><span id="c85e" class="kr ks hi mi b fi mq mn l mo mp"><strong class="mi hj"># get cluster center vectors<br/></strong>kmeans.cluster_centers_</span><span id="fefb" class="kr ks hi mi b fi mq mn l mo mp"><strong class="mi hj"># <em class="lr">Output</em><br/></strong>array([[  50.04763438,    8.82875   ],<br/>       [ 180.017075  ,   18.29      ]])</span></pre><p id="ce7f" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">让我们检查数据点的标签。标签的大小应该与数据集计数相匹配。</p><pre class="iy iz ja jb fd mh mi mj mk aw ml bi"><span id="e1f7" class="kr ks hi mi b fi mm mn l mo mp"><strong class="mi hj"># check the labels of the data points</strong><br/>kmeans.labels_</span><span id="a0a9" class="kr ks hi mi b fi mq mn l mo mp"><strong class="mi hj"># how many drivers are there in 1st, 2nd and 3rd cluster<br/></strong>from collections import Counter<br/>Counter(kmeans.labels_)</span><span id="0f4a" class="kr ks hi mi b fi mq mn l mo mp"><strong class="mi hj"><em class="lr"># Output</em></strong><br/>Counter({0: 3200, 2: 104, 1: 696})</span></pre><p id="61eb" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">现在我们已经准备好绘图了，但是首先，让我们制作一个表示每个数据点的聚类数的列。</p><pre class="iy iz ja jb fd mh mi mj mk aw ml bi"><span id="4217" class="kr ks hi mi b fi mm mn l mo mp"><strong class="mi hj"># create a column for cluster label</strong><br/>df_analyze['cluster'] = kmeans.labels_</span><span id="4b26" class="kr ks hi mi b fi mq mn l mo mp"><strong class="mi hj"># plot the data</strong><br/>sns.set_style('whitegrid')<br/>sns.lmplot(x = 'mean_dist_day', y = 'mean_over_speed_perc', <br/>data = df_analyze, hue = 'cluster', palette = 'cubehelix', <br/>size = 5, aspect = 2, fit_reg = False)</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ms"><img src="../Images/7c8bced5646229dd1103cd6c4fa2f54e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6vFhJbB0Io1KiKw6ppN6YA.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated"><strong class="bd kt">k均值聚类</strong></figcaption></figure></div><div class="ab cl kk kl gp km" role="separator"><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp"/></div><div class="hb hc hd he hf"><h2 id="bf03" class="kr ks hi bd kt ku kv kw kx ky kz la lb jx lc ld le kb lf lg lh kf li lj lk ll bi translated">洞察力</h2><p id="5ffb" class="pw-post-body-paragraph jo jp hi jq b jr lm ij jt ju ln im jw jx lo jz ka kb lp kd ke kf lq kh ki kj hb bi translated">我得出了一些见解，如下:</p><ol class=""><li id="6f71" class="ls lt hi jq b jr js ju jv jx lu kb lv kf lw kj lx ly lz ma bi translated">有696名司机平均每天行驶超过110英里，但平均超速百分比不到40%。</li><li id="ca78" class="ls lt hi jq b jr mb ju mc jx md kb me kf mf kj lx ly lz ma bi translated">在4000名司机中，有104人喜欢超速行驶(&gt; 40%)，平均每天行驶超过110英里。</li><li id="1619" class="ls lt hi jq b jr mb ju mc jx md kb me kf mf kj lx ly lz ma bi translated">3200名司机每天开车不到90英里，最高超速率为60%。</li></ol></div><div class="ab cl kk kl gp km" role="separator"><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp"/></div><div class="hb hc hd he hf"><h2 id="8055" class="kr ks hi bd kt ku kv kw kx ky kz la lb jx lc ld le kb lf lg lh kf li lj lk ll bi translated">参考</h2><ol class=""><li id="aafe" class="ls lt hi jq b jr lm ju ln jx mt kb mu kf mv kj lx ly lz ma bi translated">https://www.scikit-yb.org/en/latest/api/cluster/elbow.html<a class="ae jn" href="https://www.scikit-yb.org/en/latest/api/cluster/elbow.html" rel="noopener ugc nofollow" target="_blank"/></li><li id="5f5f" class="ls lt hi jq b jr mb ju mc jx md kb me kf mf kj lx ly lz ma bi translated">【https://www.scikit-yb.org/en/latest/index.html T4】</li></ol></div><div class="ab cl kk kl gp km" role="separator"><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp"/></div><div class="hb hc hd he hf"><p id="09ed" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">感谢您的阅读！如果您关注我或与他人分享这篇文章，我将不胜感激。最美好的祝愿。</p><h2 id="8a6f" class="kr ks hi bd kt ku kv kw kx ky kz la lb jx lc ld le kb lf lg lh kf li lj lk ll bi translated">你会支持awesome❤️</h2></div></div>    
</body>
</html>