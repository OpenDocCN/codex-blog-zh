# 你永远也不会相信 UICollectionView 能教给我们什么样的代码设计

> 原文：<https://medium.com/codex/youll-never-believe-what-uicollectionview-can-teach-us-about-code-design-72d340d87535?source=collection_archive---------0----------------------->

![](img/6a2dda92287d5b95387f725fb4ea9a65.png)

## UICollectionView 和 UIViewControllerTransitionDelegate 可以教会我们很多如何在代码中设计重要的分离

# 介绍

UICollectionView 和 UIViewControllerTransitionDelegate 已经存在很长时间了。他们都解决了 iOS 开发在用户体验的灵活性和定制化方面的一些关键问题。

更有趣的是，它们都提供了一个很好的例子，说明如何创建一个灵活的设计模式，让我们可以做几乎任何我们可以想象的事情

# 为了理解这一点，我们需要回到许多年前的历史。

多少年了？嗯，我们说的是 2012 年。在移动开发方面，它意味着古老的历史。

作为 iOS 开发者，我们唯一拥有的 UI 元素集合是 UITableView。

UITableView 是一个优秀的组件，可以帮助我们显示项目列表。但是开发人员最需要的组件之一是显示项目网格的能力，或者至少垂直显示它们。

但苹果没有为 UITableView 提供垂直的选项，而是给了我们 UICollectionView，它将布局逻辑委托给开发人员，让他选择如何处理它。

为什么会令人印象深刻或“戏剧性”？让我们看看。

# 关注点分离

我们都知道 SOC(关注点分离)原则。在讨论设计模式时，我们总是谈论它(尤其是在的求职面试中)。

然而，我们并不总是**遵循这个原则**，并深刻理解它意味着什么，为什么它是必不可少的。

让我们来看看 UICollectionView 这样的组件的职责列表:

-作为细胞循环的一部分，添加和移除细胞的机制。

-提供细胞。

-提供装修视图。

-处理触摸和其他用户事件。

-处理布局(任何类型的布局)计算。

哇，这个小小的组件承担了这么多的责任！

如果仔细观察，您会发现这些职责中的任何一个都属于不同的对象/部分。

添加和删除单元格是集合视图的责任。

提供单元格是其数据源的一部分。

装饰是从外部设置的，触摸和其他用户事件是集合视图委托的一部分。

并且布局是其 UICollectionViewLayout 的一部分(大部分时候，流布局)。

最后一个是关键。

在 UITableView 中，布局责任是表视图本身的一部分。

在 UICollectionView 中去掉它是苹果的一个戏剧性的举动，给了我们开发者一个机会去创造我们想要的任何布局。

# 他们也在 UIViewControllerTransitionDelegate 中这样做了

确实如此。

我们都知道 UIViewController 是一种奇怪的生物。它在 MVC 中的角色很尴尬，多年来，我们所有人都成为了寻找减少其臃肿大小的方法的大师(MVC —“怪物”视图控制器)。

问题就在墙上——UIViewController 包含许多不同的职责，其中一些职责彼此之间没有任何关系。

因此，苹果公司决定移除视图控制器之外的演示转换逻辑，并给我们以我们想要的方式定制它，这并不是巧合。

这就引出了我们可以从 SOC 学到的另一件事(同样，“关注点分离”，你们应该已经记住了)—

当我们将我们的关注点分离到不同的组件中时，它给了我们创建一个接口的选择，其他开发人员可以使用我们的优秀代码，并快速适应他们的需求。

当创建一个库或 SDK 时是这样，但是当我们想要修改它来满足我们的需求时，对于我们自己的项目也是这样。

# 让我们总结一下

SOC(看上面是什么意思，我不打算告诉你)很重要，但是要真正理解我为什么给出 UICollectionView 这个很好的例子。

我认为 UICollectionView 是一个非凡的设计。它真正宣告了一个好的 API 应该是什么样子，就我个人而言，这些年来我从它身上学到了很多。

关注点的分离有助于我们轻松地维护不同的组件，将行为委托给其他对象，并提供灵活性和健壮的代码。

当我们可以不同地测试每个组件时，这是一个很好的测试我们代码的方法。

此外，SOC 创建更小的代码片段，从而帮助我们轻松调试代码。

这并不是说苹果在他们的 SDK 里做的任何事情都是令人惊叹的设计(我之前提到过 UIViewController)，但是如果我们可以借鉴好的部分，为什么不呢？