<html>
<head>
<title>How To Score ~80% Accuracy in Kaggle’s Spaceship Titanic Competition</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Kaggle的宇宙飞船泰坦尼克号比赛中获得~80%的准确率</h1>
<blockquote>原文：<a href="https://medium.com/codex/how-to-score-80-accuracy-in-kaggles-spaceship-titanic-competition-using-random-forest-classifier-e7d06ce25bad?source=collection_archive---------2-----------------------#2022-06-13">https://medium.com/codex/how-to-score-80-accuracy-in-kaggles-spaceship-titanic-competition-using-random-forest-classifier-e7d06ce25bad?source=collection_archive---------2-----------------------#2022-06-13</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="285e" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">这是一个逐步指导您提交。csv”文件的预测，以Kaggle为新的泰坦尼克号的竞争。</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/dfc9b756e641a3cf0a0ef75da67ece95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OmoqdehwIUtvm2MakA5Xmw.jpeg"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">由<a class="ae jn" href="http://unsplash.com" rel="noopener ugc nofollow" target="_blank"> unsplash </a>拍摄的图像</figcaption></figure><h1 id="054b" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated">介绍</h1><p id="5866" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">Kaggle最近推出了一项名为“泰坦尼克号飞船”的有趣比赛。它旨在更新广受欢迎的泰坦尼克号竞赛，帮助数据科学新手学习机器学习的基础知识，熟悉Kaggle的平台，并结识社区中的其他人。这篇文章是一篇对初学者友好的关于泰坦尼克号比赛的分析。它涵盖了从数据中获得任何有意义的见解，以及使用RandomForestClassifier以大约80%的准确度预测测试集的“基础事实”的步骤。</p><h2 id="c28f" class="lc jp hi bd jq ld le lf ju lg lh li jy kp lj lk ka kt ll lm kc kx ln lo ke lp bi translated">索引</h2><ol class=""><li id="71dc" class="lq lr hi ki b kj kk km kn kp ls kt lt kx lu lb lv lw lx ly bi translated">问题定义和指标</li><li id="14c4" class="lq lr hi ki b kj lz km ma kp mb kt mc kx md lb lv lw lx ly bi translated">关于数据</li><li id="7d3f" class="lq lr hi ki b kj lz km ma kp mb kt mc kx md lb lv lw lx ly bi translated">探索性数据分析</li><li id="0411" class="lq lr hi ki b kj lz km ma kp mb kt mc kx md lb lv lw lx ly bi translated">数据清理和预处理</li><li id="b24c" class="lq lr hi ki b kj lz km ma kp mb kt mc kx md lb lv lw lx ly bi translated">特征提取和特征选择</li><li id="d5e3" class="lq lr hi ki b kj lz km ma kp mb kt mc kx md lb lv lw lx ly bi translated">基线模型性能和模型构建</li><li id="a20f" class="lq lr hi ki b kj lz km ma kp mb kt mc kx md lb lv lw lx ly bi translated">提交和功能重要性</li></ol><h2 id="53cc" class="lc jp hi bd jq ld le lf ju lg lh li jy kp lj lk ka kt ll lm kc kx ln lo ke lp bi translated">1.问题定义和指标</h2><p id="a33a" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">首先，我们必须了解这个问题。这是2912年，星际客轮泰坦尼克号与隐藏在尘埃云中的时空异常相撞。可悲的是，它和1000年前的同名物遭遇了相似的命运。虽然飞船完好无损，但几乎一半的乘客被运送到了另一个维度！为了帮助救援人员找回失踪的乘客，我们面临的挑战是使用从飞船受损的计算机系统中恢复的记录来预测哪些乘客被运送到了另一个维度。</p><blockquote class="me mf mg"><p id="7dbf" class="kg kh mh ki b kj mi ij kl km mj im ko mk ml kr ks mm mn kv kw mo mp kz la lb hb bi translated">这个问题是一个二元分类问题，我们必须预测哪些乘客被运送到另一个维度，我们将使用准确性作为衡量标准来评估我们的结果。</p></blockquote><h2 id="87b7" class="lc jp hi bd jq ld le lf ju lg lh li jy kp lj lk ka kt ll lm kc kx ln lo ke lp bi translated">2.关于数据</h2><p id="f481" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">我们将使用3个CSV文件:</p><ul class=""><li id="fd77" class="lq lr hi ki b kj mi km mj kp mq kt mr kx ms lb mt lw lx ly bi translated"><strong class="ki hj">火车文件</strong>(space ship _ titanic _ train . CSV)——包含乘客的个人记录，这些记录将用于建立机器学习模型。</li><li id="7419" class="lq lr hi ki b kj lz km ma kp mb kt mc kx md lb mt lw lx ly bi translated"><strong class="ki hj">测试文件</strong>(space ship _ titanic _ test . CSV)—包含剩余三分之一乘客(~4300)的个人记录，但不包含目标变量(即为乘客运输的值)。它将用于查看我们的模型在看不见的数据上表现如何。</li><li id="5f22" class="lq lr hi ki b kj lz km ma kp mb kt mc kx md lb mt lw lx ly bi translated">样本提交文件(sample _ submission . CSV)——包含我们必须提交预测的格式。</li></ul><p id="206d" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">我们将使用python来解决这个问题。你可以从Kaggle <a class="ae jn" href="https://www.kaggle.com/competitions/spaceship-titanic/data" rel="noopener ugc nofollow" target="_blank">这里</a>下载数据集。</p><p id="c128" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated"><strong class="ki hj">导入所需的库</strong></p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mu mv l"/></div></figure><p id="0855" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated"><strong class="ki hj">读取数据</strong></p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mu mv l"/></div></figure><p id="0e82" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">让我们复制一份训练和测试数据，这样即使我们对这些数据集进行任何更改，也不会影响原始数据集。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mu mv l"/></div></figure><p id="1d18" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">接下来，我们将查看训练和测试数据集的结构。我们将首先检查现有的特性，然后查看它们的数据类型。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mu mv l"/></div></figure><pre class="iy iz ja jb fd mw mx my mz aw na bi"><span id="4875" class="lc jp hi mx b fi nb nc l nd ne">Index(['PassengerId', 'HomePlanet', 'CryoSleep', 'Cabin', 'Destination', 'Age',<br/>       'VIP', 'RoomService', 'FoodCourt', 'ShoppingMall', 'Spa', 'VRDeck',<br/>       'Name', 'Transported'],<br/>      dtype='object')</span></pre><p id="da47" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">在训练数据集中，我们有13个自变量和1个目标变量(已传输)。让我们看看测试数据集的列。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mu mv l"/></div></figure><pre class="iy iz ja jb fd mw mx my mz aw na bi"><span id="0ca7" class="lc jp hi mx b fi nb nc l nd ne">Index(['PassengerId', 'HomePlanet', 'CryoSleep', 'Cabin', 'Destination', 'Age',<br/>       'VIP', 'RoomService', 'FoodCourt', 'ShoppingMall', 'Spa', 'VRDeck',<br/>       'Name'],<br/>      dtype='object')</span></pre><p id="4f80" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">我们在测试数据集中具有与训练数据集相似的特征，除了我们将使用由训练数据构建的模型预测的运输。</p><p id="aeca" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">下面给出了每个变量的描述。</p><ul class=""><li id="9df0" class="lq lr hi ki b kj mi km mj kp mq kt mr kx ms lb mt lw lx ly bi translated"><strong class="ki hj">乘客Id </strong> —每位乘客的唯一Id。每个Id采用gggg_pp的形式，其中gggg表示与乘客一起旅行的组，pp是他们在组中的编号。一个群体中的人往往是家庭成员，但不总是。</li><li id="6778" class="lq lr hi ki b kj lz km ma kp mb kt mc kx md lb mt lw lx ly bi translated"><strong class="ki hj">母星</strong> —乘客离开的星球，通常是他们永久居住的星球。</li><li id="56f1" class="lq lr hi ki b kj lz km ma kp mb kt mc kx md lb mt lw lx ly bi translated"><strong class="ki hj">低温睡眠</strong>——表示乘客是否选择在航行期间进入假死状态。低温睡眠中的乘客被限制在他们的船舱里。</li><li id="73f4" class="lq lr hi ki b kj lz km ma kp mb kt mc kx md lb mt lw lx ly bi translated"><strong class="ki hj">客舱</strong> —乘客所住的客舱号。采用deck/num/side的形式，其中side可以是P表示左舷，也可以是S表示右舷。</li><li id="dc28" class="lq lr hi ki b kj lz km ma kp mb kt mc kx md lb mt lw lx ly bi translated"><strong class="ki hj">目的地</strong>——乘客将要下船的星球。</li><li id="e3f4" class="lq lr hi ki b kj lz km ma kp mb kt mc kx md lb mt lw lx ly bi translated"><strong class="ki hj">年龄</strong> —乘客的年龄。</li><li id="ee67" class="lq lr hi ki b kj lz km ma kp mb kt mc kx md lb mt lw lx ly bi translated"><strong class="ki hj">VIP</strong>——旅客在航程中是否为特殊VIP服务付费。</li><li id="c17f" class="lq lr hi ki b kj lz km ma kp mb kt mc kx md lb mt lw lx ly bi translated">客房服务、美食广场、购物中心、水疗中心、VR deck——乘客在泰坦尼克号飞船的众多豪华设施中支付的费用。</li><li id="f29d" class="lq lr hi ki b kj lz km ma kp mb kt mc kx md lb mt lw lx ly bi translated"><strong class="ki hj">姓名</strong> —乘客的名和姓。</li><li id="e3e5" class="lq lr hi ki b kj lz km ma kp mb kt mc kx md lb mt lw lx ly bi translated"><strong class="ki hj">传送</strong> —乘客是否被传送到另一个维度。这是目标，我们试图预测的列。</li></ul><p id="04aa" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">让我们打印训练数据集的每个变量的数据类型。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mu mv l"/></div></figure><pre class="iy iz ja jb fd mw mx my mz aw na bi"><span id="873a" class="lc jp hi mx b fi nb nc l nd ne">PassengerId      object<br/>HomePlanet       object<br/>CryoSleep        object<br/>Cabin            object<br/>Destination      object<br/>Age             float64<br/>VIP              object<br/>RoomService     float64<br/>FoodCourt       float64<br/>ShoppingMall    float64<br/>Spa             float64<br/>VRDeck          float64<br/>Name             object<br/>Transported        bool<br/>dtype: object</span></pre><p id="1932" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">我们可以看到在训练数据集中有三种格式的数据类型:</p><ul class=""><li id="9556" class="lq lr hi ki b kj mi km mj kp mq kt mr kx ms lb mt lw lx ly bi translated"><strong class="ki hj">对象</strong>(分类变量)——训练数据集中的分类变量有:乘客Id、母星、低温睡眠、客舱、目的地、VIP和姓名</li><li id="45ba" class="lq lr hi ki b kj lz km ma kp mb kt mc kx md lb mt lw lx ly bi translated"><strong class="ki hj"> float64 </strong> (Float变量，即包含一些小数值的数值变量)——我们的训练数据集中的数值变量:年龄、客房服务、美食广场、购物中心、水疗中心和VRDeck</li><li id="2df5" class="lq lr hi ki b kj lz km ma kp mb kt mc kx md lb mt lw lx ly bi translated"><strong class="ki hj"> bool </strong>(布尔变量，即具有两个可能值之一的变量，例如真或假)——我们的数据集中的布尔变量被传输</li></ul><p id="b452" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">让我们看看我们的训练和测试数据集的形状。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mu mv l"/></div></figure><pre class="iy iz ja jb fd mw mx my mz aw na bi"><span id="b1c6" class="lc jp hi mx b fi nb nc l nd ne">The shape of the train dataset is:  (8693, 14)<br/>The shape of the test dataset is:  (4277, 13)</span></pre><p id="d77c" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">我们在训练数据集中有8693行和14列，在测试数据集中有4277行和13列。</p><ol class=""><li id="d3a1" class="lq lr hi ki b kj mi km mj kp mq kt mr kx ms lb lv lw lx ly bi translated">探索性数据分析</li></ol><p id="1344" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated"><strong class="ki hj"> <em class="mh">单因素分析</em> </strong></p><p id="2ed6" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">单变量分析是分析数据的最简单形式，我们单独检查每个数据以了解其值的分布。</p><p id="1244" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated"><strong class="ki hj"> <em class="mh">目标变量</em> </strong></p><p id="4662" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">我们将首先查看目标变量，即运输。由于它是一个分类变量，让我们看看它的百分比分布和柱状图。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mu mv l"/></div></figure><pre class="iy iz ja jb fd mw mx my mz aw na bi"><span id="9b08" class="lc jp hi mx b fi nb nc l nd ne">True     0.503624<br/>False    0.496376<br/>Name: Transported, dtype: float64</span></pre><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mu mv l"/></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es nf"><img src="../Images/c136388bba0d33048d6d904c63e67390.png" data-original-src="https://miro.medium.com/v2/resize:fit:704/format:webp/1*18KEiUyKFLMropJQud3lMA.png"/></div></figure><p id="ea3c" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">在列车数据集中的8693名乘客中，有4378人(约50%)被运送到了另一个维度。</p><p id="cdf3" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">接下来让我们想象一下独立的分类特征。</p><p id="3289" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated"><strong class="ki hj"> <em class="mh">【自变量(分类)</em> </strong></p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mu mv l"/></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ng"><img src="../Images/bf9cf08a8d1ef84b82ea3b1c8fb0056a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pkbRJ29XlWAtBaCG5eHorg.png"/></div></div></figure><p id="e58d" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">从上面的柱状图可以推断:</p><ul class=""><li id="e637" class="lq lr hi ki b kj mi km mj kp mq kt mr kx ms lb mt lw lx ly bi translated">列车上大约50%的乘客离开了地球</li><li id="59fc" class="lq lr hi ki b kj lz km ma kp mb kt mc kx md lb mt lw lx ly bi translated">训练数据集中大约30%的乘客处于低温睡眠状态(即被限制在他们的客舱内。)</li><li id="e757" class="lq lr hi ki b kj lz km ma kp mb kt mc kx md lb mt lw lx ly bi translated">训练数据集中大约69%的乘客会去TRAPPIST-1e</li><li id="da2f" class="lq lr hi ki b kj lz km ma kp mb kt mc kx md lb mt lw lx ly bi translated">训练数据集中不到1%的乘客为VIP服务付费</li></ul><p id="0ad3" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">座舱列采用甲板/编号/侧面的形式。因此，让我们提取并可视化CabinDeck和CabinSide特征。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mu mv l"/></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nh"><img src="../Images/2c55ea6b4ab609e6a363c5576fb7a4c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qMsLf9RVwIehspN3WwucUg.png"/></div></div></figure><p id="ddce" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">从上面的图中我们可以推断:</p><ul class=""><li id="d420" class="lq lr hi ki b kj mi km mj kp mq kt mr kx ms lb mt lw lx ly bi translated">列车组中大约60%的乘客在F层和G层</li><li id="59d5" class="lq lr hi ki b kj lz km ma kp mb kt mc kx md lb mt lw lx ly bi translated">与P相比，在客舱侧的乘客百分比没有太大差别</li></ul><p id="2429" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">我们已经看到了分类变量。现在让我们把数字变量形象化。</p><p id="d1c4" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated"><strong class="ki hj"> <em class="mh">年龄</em> </strong></p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mu mv l"/></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ni"><img src="../Images/b1c094e95c0f21e25617ba172fc70219.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*guzRd7y9SOl8GLwPYDXi9g.png"/></div></div></figure><p id="400d" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">年龄变量中有异常值，分布相当正常。</p><p id="4fed" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated"><strong class="ki hj"> <em class="mh">客房服务</em> </strong></p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mu mv l"/></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nj"><img src="../Images/b3429fe8781ec3b9b78b69eadc24a104.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Uk7FXdJOg8WC68XdOhzcCA.png"/></div></div></figure><p id="6063" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">我们可以看到，RoomService的分布中，大部分数据都是偏左的，也就是说不是正态分布，有大量的离群值。我们以后会努力让它正常起来。</p><p id="4c38" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated"><strong class="ki hj"> <em class="mh">温泉</em> </strong></p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mu mv l"/></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nk"><img src="../Images/19fdc91fd4e1dacbacecc66f9ac0e54c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Hbg1BMatogybsdyEr3Qgxg.png"/></div></div></figure><p id="7352" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">有一个与客房服务类似的分布。它包含许多异常值，并且不是正态分布的。</p><p id="f5a4" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">客房服务、美食广场、购物中心、水疗中心、VRDeck是乘客在泰坦尼克号飞船的许多豪华设施中的每一个的账单金额，所以让我们看看VRDeck、美食广场和购物中心是否有类似的分布。</p><p id="a6b3" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated"><strong class="ki hj"> <em class="mh"> VRDeck </em> </strong></p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mu mv l"/></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nk"><img src="../Images/18bb90efd687bce697381c43810000b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2W8sGBLqES355k8tFShuDQ.png"/></div></div></figure><p id="51e7" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated"><strong class="ki hj"> <em class="mh">美食广场</em> </strong></p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mu mv l"/></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nj"><img src="../Images/735c904c43be8625423982b04235e63f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5vAXAUzopZEYjpW_yPdNbg.png"/></div></div></figure><p id="b031" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated"><strong class="ki hj"> <em class="mh"> ShoppingMall </em> </strong></p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mu mv l"/></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nj"><img src="../Images/196597b68a1ffd4c176575156521244f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rnW1Dp_AJCz-6l2ia15vrA.png"/></div></div></figure><p id="ec91" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">我们可以看到VRDeck、FoodCourt和ShoppingMall也有类似的分布。都不是正态分布，都有离群值。</p><p id="fdc4" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated"><strong class="ki hj"> <em class="mh">双变量分析</em> </strong></p><p id="86ac" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">在单独查看每个变量后，我们将再次探究它们，以查看它们与目标变量的关系。首先，我们将找到分类变量和目标变量之间的关系。</p><p id="6a49" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">为此，我们将首先创建一个数据帧来存储运送的乘客数量，以及每个分类变量运送的乘客百分比。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mu mv l"/></div></figure><p id="5db8" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">现在，让我们看看分类变量是如何与运输相关的。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mu mv l"/></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nl"><img src="../Images/b6f2b22c2ec0f4e247a58f4469af8919.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6TysIOcw5iELNTFu3UYKfA.png"/></div></div></figure><p id="fd84" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">我们可以推断:</p><ul class=""><li id="7e47" class="lq lr hi ki b kj mi km mj kp mq kt mr kx ms lb mt lw lx ly bi translated">大约64%来自欧罗巴的乘客被运送</li><li id="cf05" class="lq lr hi ki b kj lz km ma kp mb kt mc kx md lb mt lw lx ly bi translated">大约78%的低温睡眠乘客被运送</li><li id="9653" class="lq lr hi ki b kj lz km ma kp mb kt mc kx md lb mt lw lx ly bi translated">与PSO j 318.5–22和TRAPPIST-1e的乘客相比，55 can care的乘客比例更高</li><li id="b982" class="lq lr hi ki b kj lz km ma kp mb kt mc kx md lb mt lw lx ly bi translated">大约38%为特殊VIP服务付费的乘客被运送</li></ul><p id="9fcb" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">接下来，让我们看看CabinDeck和CabinSide列如何与transported相关联。我们将遵循与上面相同的步骤。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mu mv l"/></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nl"><img src="../Images/7c7c23db0e31b7bfeb923f4c1cfebaee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LfrGIsXD-y9bk-Q4ysBI3g.png"/></div></div></figure><ul class=""><li id="32c2" class="lq lr hi ki b kj mi km mj kp mq kt mr kx ms lb mt lw lx ly bi translated">B舱和C舱运送的乘客比例最高</li><li id="b3f6" class="lq lr hi ki b kj lz km ma kp mb kt mc kx md lb mt lw lx ly bi translated">与机舱侧P的乘客相比，机舱侧S的乘客被运送到另一维度的比例更大</li></ul><p id="11bc" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">PassengerId列采用gggg_pp的形式，其中gggg表示与乘客一起旅行的团队，pp表示他们在团队中的人数。我们想知道一个组中的人数与他们是否被运送的关系，因此，我们将从PassengerId列中提取PassengerGroup要素，获取一个组中的人数，然后可视化它与运送的要素的关系。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mu mv l"/></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es nm"><img src="../Images/3fe5ad3466f09f22864f6e060cc0843e.png" data-original-src="https://miro.medium.com/v2/resize:fit:766/format:webp/1*JOOVMycAaxla1RKKG4QGPA.png"/></div></figure><p id="61f3" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">没有一个清晰的模式来说明一个团体中的人数如何影响他们是否被运送。所以，我们将看看“如果乘客是一个人或不是”如何影响他们是否被运送。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mu mv l"/></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es nm"><img src="../Images/0e51c17b7f28e9cc27455e6261bc18c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:766/format:webp/1*1U48jjwO8RvkfHKnswBCyw.png"/></div></figure><p id="08d8" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">与孤独的乘客相比，似乎更多不孤独的乘客被传送到了另一个维度。<br/>姓名列还包含乘客的名和姓。所以，让我们提取每个乘客的姓氏，看看家庭规模是否会影响乘客是否被运送。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mu mv l"/></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es nm"><img src="../Images/832c7df30a6f87434695f36227b53a11.png" data-original-src="https://miro.medium.com/v2/resize:fit:766/format:webp/1*HaxFbLNuFpPDRceQxMX9zA.png"/></div></figure><p id="3fec" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">被转移的小家庭的百分比高于大家庭。这可能是较小的家庭是富裕的家庭，并被运送。让我们看看家庭规模如何影响收入。</p><p id="5c25" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">为了做到这一点，我们将把每位乘客在泰坦尼克号飞船的许多豪华设施上的所有账单金额加起来。然后，我们将根据FamilySizeCat绘制它</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mu mv l"/></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es nn"><img src="../Images/d2d087d236be1e8487ec15912c18f5df.png" data-original-src="https://miro.medium.com/v2/resize:fit:906/format:webp/1*HuiS4f1KbM2dSaxN7cdTQA.png"/></div></figure><p id="8d7a" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">我们的假设似乎是正确的。似乎家庭规模较小的乘客更富有。</p><p id="c829" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">现在，让我们想象一下相对于目标变量的独立变量的数值。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mu mv l"/></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es no"><img src="../Images/77b026d3b2beb2d395dbbcee46409e9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:884/format:webp/1*IRxKJwLIzchw1mhkGF7_zQ.png"/></div></figure><p id="b692" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">看起来0岁到4岁的乘客的比例比年长的乘客的比例要高。我们将创建一个新的专栏AgeCat，以确认与老年乘客相比，是否运送了更多的年轻乘客。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mu mv l"/></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es nm"><img src="../Images/15b89edaf553876f091676b7b95ad4fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:766/format:webp/1*u-Oq0oL-nuTkkAw_X853cw.png"/></div></figure><p id="e7d1" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">从上面的图中我们可以推断:</p><ul class=""><li id="5fb2" class="lq lr hi ki b kj mi km mj kp mq kt mr kx ms lb mt lw lx ly bi translated">大约74%的0-4岁乘客被运送</li><li id="6fe3" class="lq lr hi ki b kj lz km ma kp mb kt mc kx md lb mt lw lx ly bi translated">大约60%的5-12岁的乘客被运送</li></ul><p id="44c1" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">现在，对剩余的数字自变量做同样的操作。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mu mv l"/></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es np"><img src="../Images/b5c4a5ecc8a82b1f1759ea45a35a33ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:894/format:webp/1*50aUmFVts7onAQkqLQnLWw.png"/></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es np"><img src="../Images/8797394e7223d9dc51dd38897bc622fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:894/format:webp/1*O8s3BJqqsi_dIHq-tbwXrA.png"/></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es np"><img src="../Images/4eb7f6793a142deda588554052748550.png" data-original-src="https://miro.medium.com/v2/resize:fit:894/format:webp/1*OCMyGFU2DuQ7PK0tEI-M9g.png"/></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es np"><img src="../Images/b6a0d43893ce5a10a241361cf2e64d82.png" data-original-src="https://miro.medium.com/v2/resize:fit:894/format:webp/1*VfATEHyG4sTXTuvLMl7IfQ.png"/></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es np"><img src="../Images/0f76adb32a199b2600a6930bda4da841.png" data-original-src="https://miro.medium.com/v2/resize:fit:894/format:webp/1*xL0I0XCali_KhdiVMcSOYg.png"/></div></figure><p id="f0c4" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">观察结果:</p><ul class=""><li id="01b0" class="lq lr hi ki b kj mi km mj kp mq kt mr kx ms lb mt lw lx ly bi translated">被运输的乘客花费的账单看起来很集中，接近于零。</li><li id="8906" class="lq lr hi ki b kj lz km ma kp mb kt mc kx md lb mt lw lx ly bi translated">VRDeck、Spa和RoomService似乎有类似的分布，而ShoppingMall和RoomService似乎也有类似的分布。</li></ul><p id="18c2" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">我们已经看到家庭规模如何影响支出。现在让我们来看看在Cryosleep中当选的乘客与支出的关系。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mu mv l"/></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es nn"><img src="../Images/3f4d41ec9183f440bef89e7b24fc11df.png" data-original-src="https://miro.medium.com/v2/resize:fit:906/format:webp/1*8BEY2TnyzjVmdJY2KNIFDg.png"/></div></figure><p id="d53c" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">从上图可以看出，低温睡眠中的乘客支出为0。现在我们来看看VIP身份是如何影响支出的。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mu mv l"/></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es nn"><img src="../Images/065128c2b9ab3bbda37296e2f6c62340.png" data-original-src="https://miro.medium.com/v2/resize:fit:906/format:webp/1*NQpHwDZGIWc0kzhG0XoPGQ.png"/></div></figure><p id="88d1" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">可以看出，有VIP身份的乘客比没有VIP身份的乘客支出更高。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mu mv l"/></div></figure><p id="947a" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">让我们看看年龄类别如何与乘客的总支出相关联。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es nn"><img src="../Images/8277e970adf95a6245d0cf835e199279.png" data-original-src="https://miro.medium.com/v2/resize:fit:906/format:webp/1*fXg5PBEb-Au1n9zrPDYiQg.png"/></div></figure><p id="434b" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">从上图可以推断:</p><ul class=""><li id="484f" class="lq lr hi ki b kj mi km mj kp mq kt mr kx ms lb mt lw lx ly bi translated">年龄在0-12岁之间的乘客没有支出</li><li id="4030" class="lq lr hi ki b kj lz km ma kp mb kt mc kx md lb mt lw lx ly bi translated">开支随着年龄的增长而增加</li></ul><h2 id="72c9" class="lc jp hi bd jq ld le lf ju lg lh li jy kp lj lk ka kt ll lm kc kx ln lo ke lp bi translated">4.清洗和预处理</h2><p id="a2e5" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">在研究了数据中的变量后，我们现在可以估算缺失值并处理异常值。</p><p id="e30e" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">首先，让我们删除为探索性数据分析创建的列。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mu mv l"/></div></figure><p id="7c41" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">我们将结合训练和测试数据，使清理和预处理更容易</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mu mv l"/></div></figure><p id="30a6" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">让我们看看新数据集的形状。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mu mv l"/></div></figure><pre class="iy iz ja jb fd mw mx my mz aw na bi"><span id="58ea" class="lc jp hi mx b fi nb nc l nd ne">(12970, 13)</span></pre><p id="fa68" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">数据集有12970行和13列。让我们看看数据集中每个变量缺失的百分比。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mu mv l"/></div></figure><pre class="iy iz ja jb fd mw mx my mz aw na bi"><span id="a0e4" class="lc jp hi mx b fi nb nc l nd ne">PassengerId     0.000<br/>HomePlanet      2.221<br/>CryoSleep       2.390<br/>Cabin           2.305<br/>Destination     2.113<br/>Age             2.082<br/>VIP             2.282<br/>RoomService     2.028<br/>FoodCourt       2.228<br/>ShoppingMall    2.359<br/>Spa             2.190<br/>VRDeck          2.066<br/>Name            2.267<br/>dtype: float64</span></pre><p id="f103" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">除了PassengerId列之外，每个列中都有缺失值，但缺失值不到变量的50%。我们将首先通过使用模式进行插补来处理分类列中的缺失值。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mu mv l"/></div></figure><pre class="iy iz ja jb fd mw mx my mz aw na bi"><span id="fd5e" class="lc jp hi mx b fi nb nc l nd ne">['PassengerId',<br/> 'HomePlanet',<br/> 'CryoSleep',<br/> 'Cabin',<br/> 'Destination',<br/> 'VIP',<br/> 'Name']</span></pre><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mu mv l"/></div></figure><p id="5626" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">现在，让我们找到一种方法来填充数字特征中缺失的值。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mu mv l"/></div></figure><pre class="iy iz ja jb fd mw mx my mz aw na bi"><span id="7859" class="lc jp hi mx b fi nb nc l nd ne">['Age', 'RoomService', 'FoodCourt', 'ShoppingMall', 'Spa', 'VRDeck']</span></pre><p id="b08d" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">我们将从年龄开始。在执行EDA时，我们看到如果乘客年龄小于13岁或处于低温睡眠状态，客房服务、美食广场、购物中心、水疗中心和VRDeck总计为0，因此让我们创建一个函数来处理这种情况。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mu mv l"/></div></figure><p id="efb2" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">现在，让我们使用平均值来填充剩余的缺失值。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mu mv l"/></div></figure><pre class="iy iz ja jb fd mw mx my mz aw na bi"><span id="56a2" class="lc jp hi mx b fi nb nc l nd ne">PassengerId     0<br/>HomePlanet      0<br/>CryoSleep       0<br/>Cabin           0<br/>Destination     0<br/>Age             0<br/>VIP             0<br/>RoomService     0<br/>FoodCourt       0<br/>ShoppingMall    0<br/>Spa             0<br/>VRDeck          0<br/>Name            0<br/>dtype: int64</span></pre><p id="4166" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">正如我们所看到的，所有缺失的值都已填充到数据集中。</p><p id="51ed" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated"><strong class="ki hj"> <em class="mh">异常值处理</em> </strong></p><p id="08a7" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">正如我们在前面的单变量分析中看到的，RoomService、FoodCourt、ShoppingMall、Spa和VRDeck包含异常值，因此我们必须将它们视为异常值，因为异常值的存在会影响我们数据的分布。为此，我们将剪切99%分位数上的异常值。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mu mv l"/></div></figure><p id="b793" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">我们的数据集现在是干净的！</p><h2 id="e0a0" class="lc jp hi bd jq ld le lf ju lg lh li jy kp lj lk ka kt ll lm kc kx ln lo ke lp bi translated">5.特征提取和特征选择</h2><p id="3235" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">基于我们的EDA，让我们创建一个函数来创建可能影响目标变量的新特性。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mu mv l"/></div></figure><p id="b850" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">现在，让我们删除用于创建这些特征的变量，这些变量与从数据集中去除噪声没有太大关系。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mu mv l"/></div></figure><pre class="iy iz ja jb fd mw mx my mz aw na bi"><span id="da48" class="lc jp hi mx b fi nb nc l nd ne">(12970, 15)</span></pre><p id="8098" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">现在，我们将把我们的分类数据转换成模型可理解的数字数据。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mu mv l"/></div></figure><p id="8959" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">接下来，我们将拆分数据，以获得训练和测试数据。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mu mv l"/></div></figure><p id="98d0" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">让我们打印火车的形状和测试数据，以确保我们正确地分割数据。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mu mv l"/></div></figure><pre class="iy iz ja jb fd mw mx my mz aw na bi"><span id="9c09" class="lc jp hi mx b fi nb nc l nd ne">(8693, 23)<br/>(4277, 23)</span></pre><h2 id="f57d" class="lc jp hi bd jq ld le lf ju lg lh li jy kp lj lk ka kt ll lm kc kx ln lo ke lp bi translated">6.基线模型性能和模型构建</h2><p id="8cde" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">是时候准备好输入模型的数据了。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mu mv l"/></div></figure><p id="6d87" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">特征选择在模型构建中一直起着关键作用。我们将执行χ运算来检索22个最佳特征，如下所示。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mu mv l"/></div></figure><pre class="iy iz ja jb fd mw mx my mz aw na bi"><span id="07c6" class="lc jp hi mx b fi nb nc l nd ne">Index(['Age', 'CabinDeck', 'DeckPosition', 'Regular', 'Luxury',<br/>       'TotalSpendings', 'DeckAverageSpent', 'NoRelatives', 'FamilySizeCat',<br/>       'HomePlanet_Earth', 'HomePlanet_Europa', 'HomePlanet_Mars',<br/>       'CryoSleep_False', 'CryoSleep_True', 'Destination_55 Cancri e',<br/>       'Destination_TRAPPIST-1e', 'VIP_False', 'VIP_True', 'CabinSide_P',<br/>       'CabinSide_S', 'IsAlone_Alone', 'IsAlone_Not Alone'],<br/>      dtype='object')</span></pre><p id="e5bb" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">接下来，为了我们的模型构建，我们将使用随机森林，一种树集成算法，并试图提高准确性。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mu mv l"/></div></figure><p id="f1ed" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">我们将使用交叉验证分数来评估基线模型的准确性。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mu mv l"/></div></figure><pre class="iy iz ja jb fd mw mx my mz aw na bi"><span id="3186" class="lc jp hi mx b fi nb nc l nd ne">0.7889098998887654<br/>0.01911345656998776</span></pre><p id="918e" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">我们得到了78.9%的平均精确度，现在我们将通过调整模型的超参数来提高精确度。我们将使用网格搜索来获得超参数的优化值。网格搜索是从一系列超参数中选择最佳参数的一种方式，通过参数网格将<strong class="ki hj"> </strong>参数化。</p><p id="607f" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">我们将调整max_depth和n _ estimators参数。max_depth决定树的最大深度，n_estimators决定将在随机森林模型中使用的树的数量。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mu mv l"/></div></figure><pre class="iy iz ja jb fd mw mx my mz aw na bi"><span id="c1d7" class="lc jp hi mx b fi nb nc l nd ne">RandomForestClassifier(max_depth=11, n_estimators=101, random_state=1)</span></pre><p id="71cb" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">因此，max_depth变量的优化值是11，n_estimators的优化值是101。现在，让我们使用这些优化值来构建最终模型。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mu mv l"/></div></figure><pre class="iy iz ja jb fd mw mx my mz aw na bi"><span id="da6d" class="lc jp hi mx b fi nb nc l nd ne">RandomForestClassifier(max_depth=11, n_estimators=101, random_state=1)</span></pre><p id="48c8" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">现在，让我们用优化的参数来查看我们的模型的新精度分数，以确认它得到了改进。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mu mv l"/></div></figure><pre class="iy iz ja jb fd mw mx my mz aw na bi"><span id="18b6" class="lc jp hi mx b fi nb nc l nd ne">0.8047907728163567<br/>0.018872624931449773</span></pre><p id="d42d" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">该模型现在的平均准确率为80.5%，这是一个进步。是时候使用我们选择的特征对测试数据集进行预测了。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mu mv l"/></div></figure><h2 id="0a29" class="lc jp hi bd jq ld le lf ju lg lh li jy kp lj lk ka kt ll lm kc kx ln lo ke lp bi translated">7.提交和功能重要性</h2><p id="6de8" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">在我们提交之前，让我们导入示例提交文件，看看我们的提交应该具有的格式。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mu mv l"/></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es nq"><img src="../Images/ccd1b86ab56832dbd017819b6e07ccd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:486/format:webp/1*SVVWtaD-Kn9Mnx78M2He9g.jpeg"/></div></figure><p id="f182" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">如我们所见，我们将只需要PassengerId和Transported用于最终提交。为此，我们将使用测试集的PassengerId和我们的预测。请记住，我们需要将0转换为False，将1转换为True。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mu mv l"/></div></figure><p id="0bd2" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">特征重要性允许您理解特征和目标变量之间的关系。让我们画出特性的重要性来理解什么特性是最重要的，什么特性对模型是不相关的。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mu mv l"/></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nr"><img src="../Images/d21ade7c7cb76e2a3bbbc7f92918de8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n5LWxHYyZOrOtuE1W07yAA.png"/></div></div></figure><p id="3297" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">从上面的图中我们可以看出，奢侈是最重要的特征，其次是总支出，以及常规。因此，特征工程帮助我们预测目标变量。</p><p id="b223" class="pw-post-body-paragraph kg kh hi ki b kj mi ij kl km mj im ko kp ml kr ks kt mn kv kw kx mp kz la lb hb bi translated">我希望你喜欢阅读。你可以在<a class="ae jn" href="https://github.com/ebunoluwazaynab/Spaceship-Titanic" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到我的代码。</p></div></div>    
</body>
</html>