<html>
<head>
<title>Reproducibility in Data Science</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">数据科学中的再现性</h1>
<blockquote>原文：<a href="https://medium.com/codex/reproducibility-in-data-science-1dab858107f0?source=collection_archive---------11-----------------------#2021-07-06">https://medium.com/codex/reproducibility-in-data-science-1dab858107f0?source=collection_archive---------11-----------------------#2021-07-06</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="b3e1" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">RIP:再现性就是力量</h2></div><p id="5d94" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在机器学习项目中经常被忽视的是，如果你想建立和部署一个机器学习模型，再现性是一个关键的组成部分。</p><p id="fdb4" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在本文中，我们将了解什么是可重复性，为什么它很重要，以及我们如何实施它。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div class="er es jt"><img src="../Images/ddd003cfd8fcc9b0a66a559eb8b9a0ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1146/format:webp/1*XeHsv76KB5KDmSolOucOmg.png"/></div><figcaption class="kb kc et er es kd ke bd b be z dx translated"><a class="ae kf" href="https://unsplash.com/@jeremythomasphoto?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">杰瑞米·托马斯</a>在<a class="ae kf" href="https://unsplash.com/s/photos/computer-science?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</figcaption></figure><h1 id="3901" class="kg kh hi bd ki kj kk kl km kn ko kp kq io kr ip ks ir kt is ku iu kv iv kw kx bi translated">一、什么是再现性？</h1><blockquote class="ky kz la"><p id="c080" class="ix iy lb iz b ja jb ij jc jd je im jf lc jh ji jj ld jl jm jn le jp jq jr js hb bi translated">再现性是精确复制机器学习模型的能力，使得相同的输入数据给出相同的输出。[1]</p></blockquote><p id="71aa" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这在以下几种情况下很有用:</p><ul class=""><li id="d380" class="lf lg hi iz b ja jb jd je jg lh jk li jo lj js lk ll lm ln bi translated">将您的模型与其以前的版本进行比较</li><li id="b39b" class="lf lg hi iz b ja lo jd lp jg lq jk lr jo ls js lk ll lm ln bi translated">为了确保在开发环境中创建的模型的结果与在生产环境中运行的模型相同</li><li id="6e14" class="lf lg hi iz b ja lo jd lp jg lq jk lr jo ls js lk ll lm ln bi translated">用于审计</li><li id="97e6" class="lf lg hi iz b ja lo jd lp jg lq jk lr jo ls js lk ll lm ln bi">…</li></ul><p id="1da1" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">但是为了更好地理解这种情况，让我们从更大的角度来看。当你从事机器学习项目时，你通常不是在一个简单的模型上工作，而是在一个流水线上工作:</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="er es lt"><img src="../Images/94b7b88146f986d9d881977914ec055d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8ywG1-m-rtER2cjEEIU6SA.png"/></div></div><figcaption class="kb kc et er es kd ke bd b be z dx translated">作者的典型机器学习管道</figcaption></figure><p id="06e4" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">根据我们考虑的环境，这个管道可能会有所不同</p><p id="f29a" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">事实上，创建和开发机器学习管道涉及整个项目中的多个不同环境。它通常(不总是)包括:研究环境、开发环境和生产环境:</p><ul class=""><li id="1cbf" class="lf lg hi iz b ja jb jd je jg lh jk li jo lj js lk ll lm ln bi translated">在研究环境中，数据科学家分析数据，构建模型，并对它们进行评估，以确保它们产生预期的结果。因此，他们建立了第一个机器学习管道。</li><li id="b579" class="lf lg hi iz b ja lo jd lp jg lq jk lr jo ls js lk ll lm ln bi translated">之后，软件开发人员在开发环境中复制相同的机器学习管道</li><li id="6384" class="lf lg hi iz b ja lo jd lp jg lq jk lr jo ls js lk ll lm ln bi translated">在最后一步，模型进入生产环境。</li></ul><p id="d054" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，就可重复性而言，这种情况非常具有挑战性，我们将在第3部分中看到。但是现在，让我们深入了解为什么我们必须确保我们的模型是可复制的</p><h1 id="b007" class="kg kh hi bd ki kj kk kl km kn ko kp kq io kr ip ks ir kt is ku iu kv iv kw kx bi translated">二。为什么要确保再现性？</h1><p id="35d2" class="pw-post-body-paragraph ix iy hi iz b ja ly ij jc jd lz im jf jg ma ji jj jk mb jm jn jo mc jq jr js hb bi translated">如果你还没有被说服，这里列出了为什么你必须建立一个可重复的机器学习管道:</p><ul class=""><li id="fa9e" class="lf lg hi iz b ja jb jd je jg lh jk li jo lj js lk ll lm ln bi translated">它消除了重新运行时的变化。例如，许多参数依赖于随机初始化(如神经网络的权重)，因此可再现性确保我们的性能变化是合理的</li><li id="841a" class="lf lg hi iz b ja lo jd lp jg lq jk lr jo ls js lk ll lm ln bi translated">管道中有很多随机性:数据集的洗牌、漏层、ML框架的变化、特征工程……最终，会涉及到很多随机过程，并且您的模型从一个培训会议到另一个培训会议可能会有明显的不同</li><li id="749f" class="lf lg hi iz b ja lo jd lp jg lq jk lr jo ls js lk ll lm ln bi translated">我们的生产和研究渠道应该预测同样的投入同样的产出。所以我们确切地知道我们将什么模型部署到生产中。</li><li id="bfd1" class="lf lg hi iz b ja lo jd lp jg lq jk lr jo ls js lk ll lm ln bi translated">如果不能复制以前的结果，就很难确定新模型是否真的比以前的模型更好</li><li id="07ba" class="lf lg hi iz b ja lo jd lp jg lq jk lr jo ls js lk ll lm ln bi">…</li></ul><h1 id="904d" class="kg kh hi bd ki kj kk kl km kn ko kp kq io kr ip ks ir kt is ku iu kv iv kw kx bi translated">二。如何保证再现性？</h1><p id="f98e" class="pw-post-body-paragraph ix iy hi iz b ja ly ij jc jd lz im jf jg ma ji jj jk mb jm jn jo mc jq jr js hb bi translated">我们将一起经历一个机器学习项目的生命，这样我就可以描述哪些是常见的再现性问题，以及我们如何解决它们。</p><p id="05fa" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">开始吧！我们已经通过创建研究管道开始了我们的机器学习项目，我们希望我们的模型结果是一致的。因此，我们必须确保我们管道的每一步都是可重复的。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="er es lt"><img src="../Images/94b7b88146f986d9d881977914ec055d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8ywG1-m-rtER2cjEEIU6SA.png"/></div></div><figcaption class="kb kc et er es kd ke bd b be z dx translated">按作者</figcaption></figure><ul class=""><li id="6a07" class="lf lg hi iz b ja jb jd je jg lh jk li jo lj js lk ll lm ln bi translated">数据收集:即使数据库(或数据源)不断更新/更改，训练集也必须相同。要解决这个问题，请保存训练数据的快照，并在SQL查询中使用ORDER BY等关键字对结果进行排序。如果我们不在更新的数据上进行训练，我们可能会看到性能下降，因为我们不再处理有代表性的数据样本(参见<a class="ae kf" href="https://en.wikipedia.org/wiki/Concept_drift" rel="noopener ugc nofollow" target="_blank">概念漂移</a>和<a class="ae kf" href="https://www.explorium.ai/blog/understanding-and-handling-data-and-concept-drift/" rel="noopener ugc nofollow" target="_blank">数据漂移</a></li><li id="d1df" class="lf lg hi iz b ja lo jd lp jg lq jk lr jo ls js lk ll lm ln bi translated">特征工程:为了确保这一步是可重复的，关键是要确保你的数据是可重复的。这还取决于您使用哪些函数来预处理您的要素。其中一些有一些随机成分，例如用随机值替换丢失的数据。在这种情况下，您必须修改函数，使其对于相同的输入始终给出相同的输出</li><li id="7350" class="lf lg hi iz b ja lo jd lp jg lq jk lr jo ls js lk ll lm ln bi translated">模型训练:许多ML模型依赖于训练中的随机性，如神经网络的权重初始化。如果您使用的是scikit-learn，通过固定参数“random_state”的值来设置种子:</li></ul><pre class="ju jv jw jx fd md me mf mg aw mh bi"><span id="accc" class="mi kh hi me b fi mj mk l ml mm">model = RandomForestClassifier(max_depth=100, random_state=42)</span></pre><ul class=""><li id="16c1" class="lf lg hi iz b ja jb jd je jg lh jk li jo lj js lk ll lm ln bi translated">记录超参数、使用的特征及其顺序。不要忘记保存您的模型及其版本</li></ul><p id="67e4" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在我们有了一个可重复的研究管道，严肃的事情开始了。我们必须确保管道可以从一个环境复制到另一个环境。因此，如果给研究管道或生产管道相同的输入，它应该给出相同的输出。它意味着:</p><ul class=""><li id="27f1" class="lf lg hi iz b ja jb jd je jg lh jk li jo lj js lk ll lm ln bi translated">对每个管道采用相同的训练数据。数据科学家可能在研究环境中使用一个训练数据集，但通常，试图在生产环境中实现模型的程序员不会访问相同的数据。</li><li id="1bbc" class="lf lg hi iz b ja lo jd lp jg lq jk lr jo ls js lk ll lm ln bi translated">取一个有代表性的样本。如果用于训练模型的样本不能代表生产环境中提供的数据。这两种环境要么以某种方式过滤其输入，要么创建模型的数据科学家不完全了解业务系统将如何使用模型。</li><li id="5c7b" class="lf lg hi iz b ja lo jd lp jg lq jk lr jo ls js lk ll lm ln bi translated">用不同的编程语言编写不同的管道。如果软件工程师必须用另一种编程语言重新实现一个代码，流水线之间的错误和差异的可能性就会增加。如果程序员和数据科学家自始至终使用相同的语言，因此使用相同的代码，他们可以避免大部分错误。</li></ul><p id="19a8" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">每一点都需要解决，以实现跨管道的再现性。</p><blockquote class="ky kz la"><p id="cd8b" class="ix iy lb iz b ja jb ij jc jd je im jf lc jh ji jj ld jl jm jn le jp jq jr js hb bi translated">请注意，在生产/开发流程中，您仍然必须通过在培训课程中始终采用相同的数据来使每一步都具有可重复性，修正您的模型的随机性……就像我们对研究流程所做的那样</p></blockquote><p id="a2b2" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">应对所有这些挑战的一个好方法是跨环境复制管道，如下所示:</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div class="er es mn"><img src="../Images/cc20ac3f8813abcfbb8d46f6c5e88aa5.png" data-original-src="https://miro.medium.com/v2/resize:fit:774/format:webp/1*RBPPTnZFvS5-JiESMRjXxQ.png"/></div><figcaption class="kb kc et er es kd ke bd b be z dx translated">灵感来自<a class="ae kf" href="https://trainindata.medium.com/how-to-build-and-deploy-a-reproducible-machine-learning-pipeline-20119c0ab941" rel="noopener">https://train data . medium . com/how-to-build-and-deploy-a-reproducible-machine-learning-pipeline-20119 c0ab 941</a></figcaption></figure><p id="f62a" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因此，我们的管道共享由数据、特征、评分和评估层组成的基础设施。通过这种方式，我们知道我们在每个管道中的处理方式完全相同，因为模块/步骤是相同的:</p><ul class=""><li id="7c8f" class="lf lg hi iz b ja jb jd je jg lh jk li jo lj js lk ll lm ln bi translated">数据层提供对数据源的访问，这些数据源将用于在研究和开发环境中训练模型</li><li id="ddc9" class="lf lg hi iz b ja lo jd lp jg lq jk lr jo ls js lk ll lm ln bi translated">模型构建层构建模型并生成预测。</li><li id="1db6" class="lf lg hi iz b ja lo jd lp jg lq jk lr jo ls js lk ll lm ln bi translated">最后，评估层评估模型的性能，并将其与任何其他模型进行比较</li></ul><p id="9c21" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这种跨环境的复制可以通过容器或虚拟机来完成，以确保硬件、文件系统和软件版本是相同的</p></div><div class="ab cl mo mp gp mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="hb hc hd he hf"><p id="50bd" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">结论:</strong>可再现性是精确复制模型的能力，它对于每个严肃的机器学习项目都至关重要，因为它使我们能够将模型与其以前的版本进行比较，并以适当的方式将模型部署在其他管道中。然而，说起来容易做起来难，因为在流水线的每一步(数据收集、模型构建等等)，甚至在不同的流水线上，都必须加强可再现性</p></div><div class="ab cl mo mp gp mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="hb hc hd he hf"><p id="626a" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这就对了。请记住，这不是你能找到的再现性问题的完整列表，但它应该给你一个很好的主题概述！</p><p id="e707" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">感谢阅读！</p><p id="e215" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">文章:</p><p id="606f" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">[1] : P. Sugimura，F. Hartl，构建可复制的机器学习管道(2018)。从https://arxiv.org/ftp/arxiv/papers/1810/1810.04570.pdf<a class="ae kf" href="https://arxiv.org/ftp/arxiv/papers/1810/1810.04570.pdf" rel="noopener ugc nofollow" target="_blank">取回</a></p><p id="cfcd" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">[2] : P .典狱长。机器学习可复制性危机(2018)。检索自:<a class="ae kf" href="https://petewarden.com/2018/03/19/the-machine-learning-reproducibility-crisis/" rel="noopener ugc nofollow" target="_blank">https://Pete warden . com/2018/03/19/the-machine-learning-reproducibility-crisis/</a></p></div></div>    
</body>
</html>