<html>
<head>
<title>Creating a Twitch Chat Bot</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">创建Twitch聊天机器人</h1>
<blockquote>原文：<a href="https://medium.com/codex/creating-a-twitch-chat-bot-ca368321b7f7?source=collection_archive---------2-----------------------#2022-01-03">https://medium.com/codex/creating-a-twitch-chat-bot-ca368321b7f7?source=collection_archive---------2-----------------------#2022-01-03</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/b3bc097a5127c0350aa1f0631e9a1c2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*wG3drZoE116EoFiK"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">卡斯帕·卡米尔·鲁宾在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="bb50" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">比方说，你喜欢上Twitch，观看游戏流和查看新游戏，观看知名艺术家的音乐流或观看一些ASMR的内容，因为你喜欢这样。</p><p id="424c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然后<strong class="ix hj">你决定开始流媒体</strong>，只是为了好玩。你喜欢把事情做对，因此，你喜欢像专业人士那样与观众进行多层次的互动。</p><p id="4a89" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">聊天听起来是个不错的地方，对吧？</p><p id="1f09" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">你听说过聊天机器人，但你不想用那些付费的！哦不不不，你才刚刚开始！开始把辛苦赚来的钱花在你甚至不知道自己是否真的喜欢做或想追求的事情上是不明智的！<strong class="ix hj">要是有免费选项就好了……</strong></strong></p><h1 id="a429" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">不要再看了</h1><p id="f5dc" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">在这篇文章中，我将指导你如何实现一个Twitch聊天机器人<strong class="ix hj">和</strong>，之后，我还将指导你如何设置它，并在你的(当然)史诗流中使用它！</p><p id="5ebd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果你只是想知道如何使用它，跳到“设置和使用机器人”部分。但是我建议至少读一下定义机器人行为的部分。</p><p id="3cd8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这个聊天机器人的代码也可以在GitHub上免费获得。</p><h1 id="9e9d" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">我们开始吧</h1><p id="0e8e" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">实现Twitch聊天机器人的第一步是确定它需要运行什么！换句话说，我们需要为机器人提供什么样的配置值才能成功地连接到twitch，连接到目标频道，并最终连接到聊天室。那么，<strong class="ix hj">让我们定义一下我们需要的配置文件结构吧！</strong></p><p id="3034" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这是我们将使用的配置文件结构:</p><figure class="kw kx ky kz fd ij"><div class="bz dy l di"><div class="la lb l"/></div></figure><p id="8f55" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们仔细分析一下:</p><ul class=""><li id="b63b" class="lc ld hi ix b iy iz jc jd jg le jk lf jo lg js lh li lj lk bi translated"><strong class="ix hj">token _ endpoint</strong>——由于我们的聊天机器人包含了为Twitch获取自己的访问令牌的逻辑，我们需要传递Twitch提供的端点，以便从中获取OAuth令牌。它总是相同的url，并且已经预先填充在上面的代码片段中。</li><li id="ddc6" class="lc ld hi ix b iy ll jc lm jg ln jk lo jo lp js lh li lj lk bi translated">用户名——我们希望机器人在twitch上使用的用户名，即使我认为它被覆盖了，我们还是应该把它传递给机器人。</li><li id="4fd1" class="lc ld hi ix b iy ll jc lm jg ln jk lo jo lp js lh li lj lk bi translated"><strong class="ix hj">client _ id</strong>—Twitch为聊天机器人应用程序指定的Id，在我们将它注册到平台上之后(我们稍后将对此进行研究)。</li><li id="e091" class="lc ld hi ix b iy ll jc lm jg ln jk lo jo lp js lh li lj lk bi translated"><strong class="ix hj">client _ Secret</strong>—Twitch为聊天机器人应用程序生成的秘密，在我们在平台上注册它之后(我们稍后将对此进行研究)。</li><li id="3dc8" class="lc ld hi ix b iy ll jc lm jg ln jk lo jo lp js lh li lj lk bi translated"><strong class="ix hj"> authorization_code </strong> —告诉Twitch聊天机器人被授权使用平台上的某个账户的代码(我们稍后会对此进行研究)。</li></ul><p id="ca91" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">所以，基本上，一堆需要连接到Twitch的东西，其中大部分你只会在本文后面知道更多的细节。希望这是有帮助的🤣。</p><p id="234d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">非常严肃地说，你现在需要的是对每个配置的简要描述，以便理解本指南接下来的内容，所以让我们继续。</p><h1 id="2905" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">配置摄取</h1><p id="878b" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">好了，现在我们知道了配置中必须包含什么，我们应该讨论如何将这些值集成到应用程序中。</p><p id="47b0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">配置摄取是一篇独立的文章的主题，但是在这里我们将稍微涉及一下我为这个聊天机器人所做的实现，以便读取配置文件并验证其中提供的内容是否符合应用程序的期望。</p><p id="aefd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">配置摄取可以分为两部分</strong>:</p><ul class=""><li id="773a" class="lc ld hi ix b iy iz jc jd jg le jk lf jo lg js lh li lj lk bi translated">模型的定义，一旦实例化，将包含配置值。</li><li id="cb08" class="lc ld hi ix b iy ll jc lm jg ln jk lo jo lp js lh li lj lk bi translated">为配置提供的值的<strong class="ix hj">验证</strong>。</li></ul><p id="74c9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">从模型</strong>开始，正如您在下面的代码片段中看到的，它基本上是一个值类，并使用了来自类验证器包的注释，这对于干净地为变量接受的值设置约束非常有帮助。</p><p id="783f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这里我们只使用了两个注释，因为这就是我们所需要的，但是它已经从至少两个离散的验证函数中剥离了我们的代码，这很棒！</p><figure class="kw kx ky kz fd ij"><div class="bz dy l di"><div class="la lb l"/></div></figure><p id="ad7a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">现在，进入配置验证</strong>部分。配置的验证嵌入在readConfig函数中，该函数读取作为参数传递的路径中的文件，并返回有效ChatBotConfig的承诺。</p><p id="4048" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">对于验证，由于我们已经用每个配置值的约束注释了模型，我们可以从类验证器中调用“验证”函数。</strong></p><p id="2668" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">它的工作方式非常简单:实例化带注释的类，然后用该实例作为参数调用validate。如果它返回一个空列表，那么您的配置没有问题，否则，某些东西不符合需求，在这个非空列表中，您可以找到所有的问题。</p><p id="c54c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">非常简单和干净，对不对？当我发现这个包裹时，我非常高兴🤩。</p><figure class="kw kx ky kz fd ij"><div class="bz dy l di"><div class="la lb l"/></div></figure><p id="72af" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">另外，你会注意到<strong class="ix hj">我为配置摄取</strong>定义了一个特定的错误类型，而不是仅仅使用一般的错误类型。<strong class="ix hj">我大多数时候都倾向于这样做，因为这样可以更容易地分析我在使用自己创建的应用程序时遇到的任何堆栈跟踪</strong>。</p><p id="fb4e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">如果我在日志中看到一个“InvalidTwitchConfigError ”,我会立刻知道它来自哪里。</strong></p><h1 id="4fbc" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">变成真正的聊天机器人</h1><p id="1e5b" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">所有这些文字和我们不进入聊天机器人本身，对不对？我很抱歉，但我想给你一个好主意，我是如何做的事情“浮动”的逻辑机器人本身！</p><p id="947c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在进入实质性的部分:<strong class="ix hj">这个机器人是如何工作的？</strong></p><p id="7353" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们从主要部分开始，然后深入细节。下面，是聊天机器人的构造器和“大脑”功能。</p><figure class="kw kx ky kz fd ij"><div class="bz dy l di"><div class="la lb l"/></div></figure><p id="5fde" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">基本上，它在初始化时需要一个配置对象，然后启动函数是这样的:</p><ol class=""><li id="4059" class="lc ld hi ix b iy iz jc jd jg le jk lf jo lg js lq li lj lk bi translated"><em class="lr">获取OAuth访问令牌，以便能够通过Twitch进行认证</em></li><li id="699f" class="lc ld hi ix b iy ll jc lm jg ln jk lo jo lp js lq li lj lk bi translated"><em class="lr">创建一个Twitch客户端实例，使用客户端支持的格式构建连接配置。</em></li><li id="894e" class="lc ld hi ix b iy ll jc lm jg ln jk lo jo lp js lq li lj lk bi translated">设置我们希望我们的机器人拥有的行为(它应该回答的命令，它应该忽略的消息，等等)。)</li><li id="dd7a" class="lc ld hi ix b iy ll jc lm jg ln jk lo jo lp js lq li lj lk bi translated"><em class="lr">连接Twitch，快乐起来！</em></li></ol><p id="692c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们深入这些步骤。</p><h2 id="129d" class="ls ju hi bd jv lt lu lv jz lw lx ly kd jg lz ma kh jk mb mc kl jo md me kp mf bi translated">获取访问令牌</h2><p id="06f6" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">下面是获取访问令牌的代码，以便机器人能够连接到Twitch。</p><figure class="kw kx ky kz fd ij"><div class="bz dy l di"><div class="la lb l"/></div></figure><p id="d3f3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">深入研究一下代码中实际发生的事情，您会发现它基本上可以转化为两个步骤:</p><ul class=""><li id="e8cb" class="lc ld hi ix b iy iz jc jd jg le jk lf jo lg js lh li lj lk bi translated">向twitch的令牌端点发出请求。</li><li id="aa7c" class="lc ld hi ix b iy ll jc lm jg ln jk lo jo lp js lh li lj lk bi translated">处理请求中发生的任何事情。</li></ul><p id="2635" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">该请求显然必须符合Twitch的预期参数，但我们在这方面不会有“大问题”，因为所有“可配置”的值都来自我们的config对象，这已经过验证。最坏的情况是，我们可能在配置中有错误的值，但这是在响应处理部分管理的。</p><p id="09a8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">在响应处理部分(第17–32行)，我们将端点的答案通过我们创建的验证器</strong>，<strong class="ix hj"> </strong>，它将:</p><ul class=""><li id="0124" class="lc ld hi ix b iy iz jc jd jg le jk lf jo lg js lh li lj lk bi translated">返回经过验证的令牌响应(因此fetchAccessToken的返回类型是TwitchTokenDetails的承诺)</li><li id="ded9" class="lc ld hi ix b iy ll jc lm jg ln jk lo jo lp js lh li lj lk bi translated">抛出我们创建的错误类型之一，以便在出现故障时更容易调试和分析根本原因。</li></ul><p id="712a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">底线是，<strong class="ix hj">一个与配置验证非常相似的逻辑。</strong></p><p id="ff4d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">你可以在下面查看<strong class="ix hj"> TwitchTokenDetails </strong>值类和<strong class="ix hj">TwitchTokenResponseValidator的代码。</strong></p><figure class="kw kx ky kz fd ij"><div class="bz dy l di"><div class="la lb l"/></div></figure><figure class="kw kx ky kz fd ij"><div class="bz dy l di"><div class="la lb l"/></div></figure><p id="3fcb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">你可能已经注意到了，我 <strong class="ix hj">在任何地方都找不到InvalidTwitchResponseError。</strong>这是因为，不存在端点回答正确(状态码200)但响应内容错误的情况。</p><p id="cb34" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">如果来自Twitch的API的契约发生了变化，但我们并不知道，因此也没有准备好</strong>来解释响应体，那么最终可能会触发验证器抛出这个错误。但是<strong class="ix hj">这实际上不能被认为是响应的错误，不是吗？</strong></p><p id="5f54" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这就是为什么我将这些错误归入fetchAccessToken()中响应处理部分的else分支。为了公平起见，基本上将这些情况转换为MalformedTwitchRequestError实例。</p><p id="1e10" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在<strong class="ix hj">invalidwitchresponseerror</strong>仅用于标记验证失败的信号，但我仍然决定保持这种类型，因为它现在不会造成任何伤害，将来会变得有用——例如，如果Twitch响应在任何时间点开始出错。</p><h2 id="3121" class="ls ju hi bd jv lt lu lv jz lw lx ly kd jg lz ma kh jk mb mc kl jo md me kp mf bi translated"><em class="mg">Twitch客户端的实例化</em></h2><p id="543a" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">Twitch Client是我们真正想要的:连接到Twitch频道的聊天。</p><p id="d0d8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Twitch客户端来自于<a class="ae iu" href="https://github.com/tmijs/tmi.js" rel="noopener ugc nofollow" target="_blank"> tmi.js </a>，这是一个用于Twitch消息传递接口的javascript库。它很容易使用和设置:只需要以它期望的格式传递一个配置。</p><figure class="kw kx ky kz fd ij"><div class="bz dy l di"><div class="la lb l"/></div></figure><p id="d694" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">正如你在上面看到的，没有太多的事情发生。<strong class="ix hj">有一个函数在需要提供给客户端时构建配置(并让我们在这个过程中可视化它的结构)，我将来自Bot配置和刚刚获取的令牌的值传递给它，然后我使用它的返回来使用tmi.js创建我们的客户端。</strong></p><h2 id="44c3" class="ls ju hi bd jv lt lu lv jz lw lx ly kd jg lz ma kh jk mb mc kl jo md me kp mf bi translated"><em class="mg">设置我们希望机器人拥有的行为</em></h2><p id="8216" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">在我启动机器人并连接到Twitch之前，我需要<strong class="ix hj">定义它将如何运行。这是通过回调函数完成的。</strong></p><figure class="kw kx ky kz fd ij"><div class="bz dy l di"><div class="la lb l"/></div></figure><p id="2786" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">回调函数定义了机器人对每条推送到聊天室的消息的行为。</strong></p><p id="678a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在代码的<a class="ae iu" href="https://github.com/PedroEFLourenco/Twitch-Chat-Bot/blob/master/src/app/chatBot/chatbot.ts" rel="noopener ugc nofollow" target="_blank">示例回调中，我定义了机器人将忽略来自自身的消息，我还定义了以“！”开头的消息是命令，我为机器人提供了一个命令来支持。</a></p><p id="9568" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这里定义的交互非常简单:一收到！你好”时，机器人应该回答“你好，<username>！欢迎来到频道。”。</username></p><p id="c2e9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这显然是一个起点，你可以有更复杂的行为，但这已经是一个好的开始。有礼貌总是好的，即使你是一个聊天机器人。</p><p id="13a6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">关于聊天机器人的实现，这就是全部内容！现在我们进入“如何设置和使用”部分。我想对于你们中的非编码人员来说这是最有趣的。</p><h1 id="503a" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">设置和使用机器人</h1><p id="916e" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">如果你不得不滚动这么远来找到你真正想要的，我很抱歉。但是开心点，你活下来了！</p><p id="630e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这一节中，我们将详细介绍如何获得配置文件所需的值，以及如何使用<a class="ae iu" href="https://github.com/PedroEFLourenco/Twitch-Chat-Bot" rel="noopener ugc nofollow" target="_blank"> Bot </a>。</p><p id="e497" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">首先，</strong>你需要安装npm和node.js。如果没有，就去做(从<a class="ae iu" href="https://docs.npmjs.com/downloading-and-installing-node-js-and-npm" rel="noopener ugc nofollow" target="_blank">这里</a>试)，然后回来。</p><p id="71d9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">要获得代码，你可以去<a class="ae iu" href="https://github.com/PedroEFLourenco/Twitch-Chat-Bot" rel="noopener ugc nofollow" target="_blank"> GitHub库</a>下载zip文件。拉开拉链后，机器人就在你身边了。</p><figure class="kw kx ky kz fd ij er es paragraph-image"><div class="er es mh"><img src="../Images/1846b570906f66b4e92aa06f185cbf01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1344/format:webp/1*H9vMObBwT9RqgzueRfr4kw.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">下载邮编按钮获取代码</figcaption></figure><h2 id="f080" class="ls ju hi bd jv lt lu lv jz lw lx ly kd jg lz ma kh jk mb mc kl jo md me kp mf bi translated">如何获取Bot配置的值</h2><p id="3ce3" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">为了运行Bot，您需要为它提供本文前面提到的配置文件。该文件包含以下值:</p><ul class=""><li id="91ac" class="lc ld hi ix b iy iz jc jd jg le jk lf jo lg js lh li lj lk bi translated"><strong class="ix hj">令牌_端点</strong></li><li id="8d3d" class="lc ld hi ix b iy ll jc lm jg ln jk lo jo lp js lh li lj lk bi translated"><strong class="ix hj">用户名</strong></li><li id="e044" class="lc ld hi ix b iy ll jc lm jg ln jk lo jo lp js lh li lj lk bi translated"><strong class="ix hj">客户端id </strong></li><li id="f8de" class="lc ld hi ix b iy ll jc lm jg ln jk lo jo lp js lh li lj lk bi translated"><strong class="ix hj">客户端_秘密</strong></li><li id="97ac" class="lc ld hi ix b iy ll jc lm jg ln jk lo jo lp js lh li lj lk bi translated"><strong class="ix hj">授权_代码</strong></li></ul><p id="a949" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">从中可以看出，<strong class="ix hj"> token_endpoint </strong>是一个常量值(显示在本文和GitHub存储库中的配置文件片段中)，而<strong class="ix hj">用户名</strong>则完全由您决定。这给我们留下了3个要去获取的值！</p><p id="dfa9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> Client_id </strong>和<strong class="ix hj"> client_secret </strong>均来自同一个地方，即<a class="ae iu" href="https://dev.twitch.tv/console/apps/create" rel="noopener ugc nofollow" target="_blank">Twitch portal for application registration</a>。这是一个门户，您可以在其中将您的应用程序注册为将连接到Twitch的实体。</p><figure class="kw kx ky kz fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mi"><img src="../Images/80a8686a1242a12a393bcc89010329ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ft-pqar8uCG7UVO_YprbIg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">在Twitch上注册应用程序</figcaption></figure><p id="3478" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">注册应用程序后，单击“管理”按钮访问client_id，并单击按钮生成client_secret(您应该将它存储在某个安全的地方，因为在此页面上不可能再看到它，但您可以随时生成一个新的)。</p><figure class="kw kx ky kz fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mj"><img src="../Images/0aed297f15f0b01b29ddf5478bce09cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7n5nhH5OodKPnavK6sktFw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">管理应用程序屏幕</figcaption></figure><p id="af64" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">client_secret✔️.client_id✔️两个下来，还有一个，那个是<strong class="ix hj">授权_码。</strong></p><p id="73c9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">授权码告诉twitch，拥有它的人(在本例中是机器人)被授权使用授权者的帐户登录Twitch。</p><p id="63ba" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">你知道当你试图用脸书、苹果ID或其他什么登陆某个网站时会出现的屏幕吗？当您单击“允许”时，您授权网站代表您连接到这些方以获取一些信息。对于这种情况，整个过程几乎是相同的。</p><p id="b4b4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">该授权以字母数字代码的形式出现，您需要向机器人提供该代码，以便它可以使用您用来授权它的帐户登录Twitch，而无需知道该帐户的实际凭证！</p><p id="9b82" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这意味着<strong class="ix hj">机器人在Twitch上没有自己的身份。它使用授权过程中使用的帐户的身份。</strong></p><p id="1567" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">通常，对于那些付费聊天机器人应用程序，要访问授权屏幕，会有一个带有漂亮的“在twitch上授权”按钮之类的网站。</p><p id="152b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">但是在DIY领域，我们不需要这个，因为我们可以通过这个url结构到达那里:</p><blockquote class="mk ml mm"><p id="a9aa" class="iv iw lr ix b iy iz ja jb jc jd je jf mn jh ji jj mo jl jm jn mp jp jq jr js hb bi translated">https://id.twitch.tv/oauth2/authorize?client _ id =<strong class="ix hj">&lt;client _ id&gt;</strong>T10】redirect _ uri = http://localhost&amp;response _ type = code&amp;scope = chat:read chat:edit</p></blockquote><p id="fb53" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">您可以将上述url复制到您的浏览器中，并用您在上一步中获得的应用程序的client_id替换<strong class="ix hj"> &lt; client_id &gt; </strong>。</p><p id="24fb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">您应该会看到如下所示的屏幕</p><figure class="kw kx ky kz fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mq"><img src="../Images/36ff0f5d89e76c127d7f9b1d3e5992bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1226/format:webp/1*qolOEzwK4bxMVStswxcAAw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">Twitch应用程序的授权页面</figcaption></figure><p id="80b6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">单击授权后，您将能够在浏览器的地址栏中看到您的授权码。</p><figure class="kw kx ky kz fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mr"><img src="../Images/bc513658421cdfdf8b46f1dc1f7bc79f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_9t7N3N5ZplzPlQT_NUFlQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">包含授权码的地址栏。</figcaption></figure><h2 id="8aaf" class="ls ju hi bd jv lt lu lv jz lw lx ly kd jg lz ma kh jk mb mc kl jo md me kp mf bi translated">运行聊天机器人！</h2><p id="3d7d" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">是时候了。👊</p><p id="2750" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在是时候把所有的东西都放在一起了:我们可以在我们的频道聊天时运行这个机器人了！🙌</p><p id="199f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">所以，先决条件:当你运行机器人时，你显然应该是流式的，否则就没有聊天可以连接。😅</p><p id="05b9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">除此之外，只需遵循以下步骤:</p><ol class=""><li id="283d" class="lc ld hi ix b iy iz jc jd jg le jk lf jo lg js lq li lj lk bi translated">转到包含从GitHub下载的解压缩文件的文件夹</li><li id="34d8" class="lc ld hi ix b iy ll jc lm jg ln jk lo jo lp js lq li lj lk bi translated">用Bot配置的值和您的通道名称填充您的config.ts文件</li></ol><figure class="kw kx ky kz fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ms"><img src="../Images/827ec8d7c717a199cb812874540dc997.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MipEnkofXGrSVAAPmcO1FA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">config.ts文件结构</figcaption></figure><p id="cc22" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">3.在命令提示符下键入“npm install ”,然后按enter键——这将下载Bot运行所需的所有内容。</p><p id="9d14" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">4.还是在命令提示符下，键入“npm start ”,然后按enter键运行Bot！最初的输出应该是这样的:</p><figure class="kw kx ky kz fd ij er es paragraph-image"><div class="er es mt"><img src="../Images/3b2deff728ba87d6f21280cebbda9f2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1092/format:webp/1*IgMG00VpyNShs87ZEqS1JA.png"/></div></figure><p id="b3b4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果是这样的话，<strong class="ix hj">恭喜你，你正在运行一个免费的聊天机器人！！！</strong></p><p id="46ea" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">要看到它的工作，只需写一个你支持的命令到聊天中，使用一个不同于机器人被授权的帐户，玩得开心！</p><figure class="kw kx ky kz fd ij er es paragraph-image"><div class="er es mu"><img src="../Images/2da2549288e8c2895e30b181c807f4bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:606/format:webp/1*TgZvLz1fjhmMZjD5ANn-CQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">工作聊天机器人🙌</figcaption></figure></div></div>    
</body>
</html>