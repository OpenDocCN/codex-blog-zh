<html>
<head>
<title>How to Convert TensorFlow h5 Models to Core ML</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何将TensorFlow h5型号转换为Core ML</h1>
<blockquote>原文：<a href="https://medium.com/codex/how-to-convert-tensorflow-h5-models-to-core-ml-70a28bbd5c60?source=collection_archive---------6-----------------------#2022-11-27">https://medium.com/codex/how-to-convert-tensorflow-h5-models-to-core-ml-70a28bbd5c60?source=collection_archive---------6-----------------------#2022-11-27</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/e5df0d62c7323e70fb675afb4410c100.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*4OMJA9qJFnGAWQ8K"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">艾莉娜·格鲁布尼亚克在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="a5a8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">CreateML使得开发用于Xcode的机器学习模型变得非常容易。近乎神奇。然而，尽管苹果的玫瑰园很漂亮，但有时也需要其他工具。</p><p id="9cfd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我将用我发现的最快最简单的方法将Keras h5模型文件转换成CoreML。</p><h2 id="74db" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated"><strong class="ak">先决条件</strong></h2><p id="81e4" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">遗憾的是，我们不会使用XCode，我们必须依赖python、<a class="ae iu" href="https://coremltools.readme.io/docs" rel="noopener ugc nofollow" target="_blank"> CoreML Tools </a>和你的模型需要的第三方包。要转换h5 Keras文件，我们需要安装<a class="ae iu" href="https://www.tensorflow.org/" rel="noopener ugc nofollow" target="_blank"> TensorFlow </a>。</p><p id="c5ae" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">假设您已经设置了python。您可以在终端中使用这两个命令。</p><pre class="kt ku kv kw fd kx ky kz bn la lb bi"><span id="115a" class="lc ju hi ky b be ld le l lf lg">pip install coremltools<br/><br/>pip install tensorflow</span></pre><p id="ffeb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">代码</strong></p><p id="52de" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果python不是你经常使用的东西，我推荐Sublime Text作为轻量级IDE。</p><pre class="kt ku kv kw fd kx ky kz bn la lb bi"><span id="dcb7" class="lc ju hi ky b be ld le l lf lg">import coremltools<br/>import tensorflow as tf<br/><br/>model_path = '/Users/You/YourModelPath.h5'<br/><br/>keras_model =  tf.keras.models.load_model(model_path)<br/><br/>model = coremltools.convert(keras_model, convert_to="mlprogram")<br/><br/>model.save("Model Name Comes Here")</span></pre><p id="009c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">写完之后，你可以将代码保存为python文件。例如“convert.py”并复制其目录路径。</p><p id="923a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">打开终端，将目录切换到您想要保存CoreML文件的位置。然后，像这样运行程序，就完成了。您可以将元数据添加到模型中，方法是用Xcode打开它，然后单击右上角的“编辑”。</p><pre class="kt ku kv kw fd kx ky kz bn la lb bi"><span id="9ac1" class="lc ju hi ky b be ld le l lf lg">cd Developer/CoreMLFiles<br/><br/>python /Users/YourPathToThePythonFile/convert.py</span></pre><p id="a249" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">感谢阅读。我真的很感激，并希望你的项目编译没有错误。</p><figure class="kt ku kv kw fd ij er es paragraph-image"><div class="er es lh"><img src="../Images/5600ba5b5614937d59a353cda9c5a6eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/1*ILJAGoI26zzD_tem9jUpQQ.gif"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">&lt; Me being appreciative&gt;来自Samurai Champloo的Gif</figcaption></figure></div></div>    
</body>
</html>