# Javascript 的设计模式——观察者模式 I

> 原文：<https://medium.com/codex/design-patterns-for-javascript-observer-pattern-i-f7c96ff8cdbf?source=collection_archive---------16----------------------->

这是两部分系列的第一部分。在本文中，您将了解到

*   观察者是什么。
*   发布-订阅模式有何不同。
*   它如何在您的架构中发挥作用。
*   它是如何用 Javascript 实现的。
*   当我们使用这种模式时，我们会得到什么好处。

![](img/59d15d23ecea38462200d230754edf03.png)

那边有个州变了，上校

今天是这个月的 23 号。你坐在拉各斯奥绍迪的 BRT 公交车上，试图做出关键的商业决策

我们应该从卖沙丁鱼转向卖沙丁鱼吗？？？

当然，撒丁岛很棒，市场很大，我们以前从未见过这样的事情。然而，撒丁岛鱼几乎从来没有供应过”，你对和你一起旅行的同事说。

撒丁岛运送了数千吨沙丁鱼，但实际上没有运输时间表。今天，我们得到一些批次，明天没有撒丁岛代表的迹象！然而，在 Oyingbo 市场的摊位上，你经常会用完沙丁鱼，你需要等到撒丁岛的代表过来送新的一批。

请记住这个类比。我们将回到这个故事。

![](img/69e8a9cfc1fa53e4d23453bbb312c032.png)

引自 google.com[的](https://google.com)

顾名思义，观察者模式处理需要观察的实体——是的，字面意思——另一个实体。

*我需要你的最新消息，不管你发生了什么，playa！*

现在很难找到一个独立存在的程序。大多数时候，我们需要程序之外的数据。观察者帮助我们实现这一点，同时仍然保持互连系统之间的松散耦合架构。紧密耦合使维护变得困难，我们试图在应用程序中摆脱这种情况。

# 定义

让我们看看一些走过这条路的人是如何定义观察者模式的。

根据“四人帮”的说法

一个或多个观察者对对象的状态感兴趣，并通过连接他们自己来记录他们对对象的兴趣。当观察者可能感兴趣的主题发生变化时，就会发送一条通知消息，调用每个观察者的更新方法。“当观察者对主体的状态不再感兴趣时，他们可以简单地将自己分离。”

请注意，这与发布/订阅模式的不同之处在于，发布/订阅为订阅者提供了订阅的通道/主题。频道/主题是订阅者感兴趣的状态/逻辑，他们将在该主题下注册以接收更新。用户可以注册到多个频道。

观察者是一种行为模式，它定义了一对多的关系。有一个主题，我们有许多实体在观察(观察者),他们想知道主题发生了什么。

这么想吧。我将继续假设你有一个 twitter 帐户？每个关注你的人都对你的内容感兴趣……但是那些打开你的通知的人会在你发布下一条微博时收到通知！看，主题不只是向程序中的所有实体广播消息(类讨厌垃圾邮件)。发送这样的数据将是多余的，这就是为什么观察者必须主动连接自己，并且当有趣的事情发生时，只有连接的观察者才会被通知！

你打电话给撒丁岛制作经理。你脸色铁青！！！怎么两周了，两周了，还没人来送新一批沙丁鱼？这些人不会是认真的，你心里想…毕竟，谁会两周不分发他们的产品呢？？？

撒丁岛生产经理告诉你一些让你震惊到资产负债表的事情！

我们已经停止把产品拿到商店，我们不再使用代表。现在，你必须注册成为我们的卖家之一，我们会告诉你，一旦有一个新的一批在你的地区！

现在，你有一个选择。要么订阅他们的卖家列表，继续将产品送到你的商店，要么保持现状，不购买任何产品。如果这是索菲的选择，这部电影会持续 2 秒钟！你继续工作，告诉经理给你报名，三天后你的电话响了。你所在的地区出现了新的一批，你又重操旧业了。

当我们使用观察者模式时，我们享受松耦合实体的好处——我们的观察者不需要知道任何关于主题的事情(在一些实现中，观察者可能确切地知道它需要哪种状态，并使用 getter 方法提取它，但这是它所知道的全部)。这对 javascript 来说非常好，因为 javascript 是非常事件驱动的，在浏览器和 nodejs 环境中都是如此。这给了我们容易扩展的代码，如果我们需要添加新的实体来观察(记住开闭原则)

当观察者注册自己时，主题可以按照我们想要的那样干净地修改，因为观察者没有耦合到主题的实现。他们非常松散地依赖于主题。然而，这给我们带来了实现观察器的一个关键方面

***观察者必须全部实现一个类似的接口***

由于失去了耦合，观察者和主体之间的知识非常少。他们对彼此内心发生的事情知之甚少，如果有的话。这意味着，当状态发生变化时，受试者会盲目地对所有观察者采用同样的方法。因此，一旦有更新，所有的观察者必须公开一个方法(有时，您会看到它被称为`update`)供主题调用。

# 在 Javascript 中实现观察者模式

在本系列的下一部分，我们将探索如何在 JavaScript 中实现这种模式。