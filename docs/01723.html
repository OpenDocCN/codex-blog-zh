<html>
<head>
<title>How to Handle Missing Data In Machine Learning Projects</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何处理机器学习项目中的缺失数据</h1>
<blockquote>原文：<a href="https://medium.com/codex/handle-missing-data-in-machine-learning-projects-8fcbe00d6b40?source=collection_archive---------5-----------------------#2021-05-24">https://medium.com/codex/handle-missing-data-in-machine-learning-projects-8fcbe00d6b40?source=collection_archive---------5-----------------------#2021-05-24</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/2b64d98f0f18ef7c55db8de685642b69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*zsjRZmhKJC8D7GoL"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">米利安·耶西耶在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="18f2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">您收到了一个包含大量缺失数据的数据集，现在该怎么办呢？这正是我今天要帮你做的。在本文中，我将与您分享一些处理缺失功能的流行方法。</p></div><div class="ab cl jt ju gp jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="hb hc hd he hf"><p id="2b52" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">注意:这些方法侧重于数字数据，请继续关注处理分类数据。</p><h1 id="ab34" class="ka kb hi bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">删除缺少值的记录</h1><p id="5566" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">处理缺失数据时要考虑的第一种方法是简单地从数据集中删除这些记录。但是，当您有一个较大的数据集时，通常应该采用这种方法。</p><p id="f489" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">假设您正在处理一个包含1000行的数据集，其中300行缺少一个值。删除这些记录可能会导致您丢失有价值的信息，并可能会损害您的模型。但是，假设您有一个包含100万条记录的数据集，其中100条记录包含一个缺失值，删除这些行不会造成这样的阻碍，因为您的模型仍然有大量信息要处理。</p><p id="730a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">总的来说，这种方法非常简单，但应该在数据集较大时使用。最后，如果你使用这种方法，评估你是否能承受失去这些信息的代价是值得考虑的事情。</p><h1 id="5554" class="ka kb hi bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">预测缺失值</h1><p id="5bb6" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">处理缺失数据时要考虑的第二种方法是预测那些缺失值。我们将使用来自sklearn的波士顿数据集来说明这种方法。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ld"><img src="../Images/16b068399e550e1dba7094a85a6c3304.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dgcZvYcbrb8QMh14JEfF_g.png"/></div></div></figure><figure class="le lf lg lh fd ij er es paragraph-image"><div class="er es li"><img src="../Images/80156f3adc2b14d26be40f3039876429.png" data-original-src="https://miro.medium.com/v2/resize:fit:472/format:webp/1*Ac4AZWJD7S4So7A8Zuse_Q.png"/></div></figure><p id="6f69" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如您所见，第9列有40个缺失值。我们可以使用的一种方法是使用机器学习用它们的预测值来填充这些缺失值。</p><p id="b550" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">首先，我们将在不丢失值的情况下隔离记录，这些值将用作模型的数据集。这个模型的特征将是所有的原始特征，不包括我们预测的特征列，在这个例子中是列#9。请注意，我们还在特性集中包含了我们的原始目标列。至于我们的目标列，我们将使用第9列，因为这是我们试图预测的。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lj"><img src="../Images/ae05c5af40314d3667dbbcae28ae6349.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V4MupVRj_0y5KYQMbHPOrw.png"/></div></div></figure><p id="7f8d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">接下来，我们将把数据集分成训练集和验证集。这将使我们对模型的准确性有所了解。然后，我们将使我们的训练集符合线性回归模型，并在我们的验证集上测试它。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lk"><img src="../Images/33aa07bde6b36657d56472d46a7c7929.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hNAAVP4CPkyCVVMCuPo8yw.png"/></div></div></figure><p id="b3bc" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如您所见，我们模型的R2分数很高，接近满分1。</p><p id="2c2f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最后一步是在我们的实际数据集上使用这个模型，并填充缺失的值。我们可以通过遍历数据集，传入缺少值的记录，并使用预测来代替它。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ll"><img src="../Images/19b0e5b38e0f5f5fc29718bb1126e6a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*csn86qTm00bmXRQ3TIFGwQ.png"/></div></div></figure><p id="eb22" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，你们都完成了！当数据集较小时，这种方法非常有用。但是，当数据集很大时，它会变得复杂。</p><p id="4808" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">例如，假设您有一个包含5亿条记录的数据集，现在您必须为填充缺失值和原始问题创建一个模型。</p><p id="a1fc" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">此外，在很多情况下，您会遇到包含多个缺失值列的数据集。现在，您必须为每个缺失的特性列创建一个模型。</p><p id="ac6e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果您还不知道，这种方法不是最有效的，因为似乎需要多个模型，但是，如果您有足够的时间和计算能力，这可能是适合您的方法。</p><h1 id="173f" class="ka kb hi bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">统计插补</h1><p id="27f1" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">最后，也是最流行的方法是统计插补。这里的想法是用该特定特征的平均值、中值或众数来填充缺失值。</p><p id="df1e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们将使用不同版本的波士顿数据集作为示例。这里我们可以看到第9列有89个缺失值。在本例中，我们将使用平均值进行估算。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div class="er es lm"><img src="../Images/c53a3e7c15428d9b498bb5837abfcd36.png" data-original-src="https://miro.medium.com/v2/resize:fit:468/format:webp/1*HJpjbybdjgvkBf2raO-NbQ.png"/></div></figure><p id="b60d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">必要的步骤是计算列的平均值，然后用这个平均值估算缺失值。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ln"><img src="../Images/21dd25e00a37f77f0760a7561e87900b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ACM7ly49wGB7R9pDRoExoQ.png"/></div></div></figure><p id="b45f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，如果有必要，您可以对其他列重复此操作。</p><p id="3d1f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如下所述，这种方法也可以通过输入中值或众数来使用。模式不是一个非常常见的用例，但中位数是。当您处理有许多异常值的数据集时，平均值可能不总是列的准确反映。相反，中位数可以更好地反映数据。在考虑这种方法时，一定要充分利用您的数据。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lo"><img src="../Images/babd9da3b4cfa73674a3c51612d4248b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Shl0IGWkPrbyNReBEHMHGQ.png"/></div></div></figure><p id="87a4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在本例中，输入平均值大大增加了值在11范围内的频率计数。这是任何一种估算的问题，因为它可能会导致偏向某一特定值。如果您的模型严重依赖于该特性，这种偏差可能会损害它的准确性。</p><p id="e3b5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这种方法还有其他问题，我鼓励你去研究它们。首先，请查看:</p><div class="lp lq ez fb lr ls"><a href="https://towardsdatascience.com/why-using-a-mean-for-missing-data-is-a-bad-idea-alternative-imputation-algorithms-837c731c1008" rel="noopener follow" target="_blank"><div class="lt ab dw"><div class="lu ab lv cl cj lw"><h2 class="bd hj fi z dy lx ea eb ly ed ef hh bi translated">为什么对缺失数据使用平均值是个坏主意。替代插补算法。</h2><div class="lz l"><h3 class="bd b fi z dy lx ea eb ly ed ef dx translated">当我们想要用于机器学习的数据集包含缺失数据时，我们都知道这种痛苦。快速简单的…</h3></div><div class="ma l"><p class="bd b fp z dy lx ea eb ly ed ef dx translated">towardsdatascience.com</p></div></div><div class="mb l"><div class="mc l md me mf mb mg io ls"/></div></div></a></div></div><div class="ab cl jt ju gp jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="hb hc hd he hf"><p id="b414" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">总的来说，在处理缺失数据时，采取任何方法都要谨慎，每种方法都有自己的注意事项。在决定一种方法之前，一定要充分理解你的数据。</p><p id="fbd6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这就是处理缺失数字数据的方法。如果您有任何问题或批评，请随时评论。感谢您的阅读，敬请期待更多内容！</p></div></div>    
</body>
</html>