<html>
<head>
<title>Don’t Rewrite that Code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">不要重写代码</h1>
<blockquote>原文：<a href="https://medium.com/codex/dont-rewrite-that-code-d75f1d4111e6?source=collection_archive---------10-----------------------#2021-07-30">https://medium.com/codex/dont-rewrite-that-code-d75f1d4111e6?source=collection_archive---------10-----------------------#2021-07-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="dc62" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">这是对所有开发人员中的完美主义者的恳求——不要重写代码！</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/e60e939e9e3e560757fe5fc3c1e27305.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*gIh_lH9Si-9U8msY"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">穆罕默德·诺哈西在<a class="ae jn" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="b535" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">大多数有多年项目经验的工程师都经历过这样的事情:</p><p id="3691" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">“好吧，我只是快速浏览一下这些布满灰尘的代码。我只需要在旧的遗留组件上添加一点东西。在这里，我找到了我需要的代码！轻松点。哦，等等…是在这里，还是这另一个相同的文件？亲爱的主啊，这已经贴了多少次了？这个州到底在哪里？等等，你是说我必须修改一个完全不相关的项目才能运行？你知道吗，我已经看完了。把它全部烧为平地，这需要重写。”</p><p id="e15d" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我明白了。真的。但是等等！不要让你的情绪战胜你。在你满意地按下删除键之前，我有一些观点支持“活下去，也让别人活下去”——给那些可怕的代码尽可能少的能量，然后继续前进。</p><h1 id="8b7b" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">“这段代码不好。”为什么？“嗯，不是我写的！”</h1><p id="6f81" class="pw-post-body-paragraph jo jp hi jq b jr lc ij jt ju ld im jw jx le jz ka kb lf kd ke kf lg kh ki kj hb bi translated">我听说编程一部分是数学，一部分是科学，一部分是艺术。在评估完全有效的“数学”和“科学”的价值时，不要让“艺术”这一点影响你的判断每个程序员的自我都坚持认为，他们，也只有他们，拥有组织代码的真正最佳方式。我们所有人本质上都是梦想家和创造者，并喜欢从零开始创造新事物，这是可以理解的。我们也讨厌阅读和理解别人写的代码，因为坦白地说，这是非常困难的。</p><p id="355e" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在看别人解决问题的选择时，对自己诚实很重要。这真的是一种糟糕的方法，还是仅仅是风格上的不同？没有两个人是相似的，为金钱而写代码的现实是，你将不得不与观点不同的人一起工作。即使这是一个“坏”的方法，在这一点上真的重要吗？</p><h1 id="3e2b" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">谁写了这段代码，什么时候写的？</h1><p id="bfc1" class="pw-post-body-paragraph jo jp hi jq b jr lc ij jt ju ld im jw jx le jz ka kb lf kd ke kf lg kh ki kj hb bi translated">向我推荐的关于成为软件工程师的最好的书之一是<a class="ae jn" href="https://amzn.to/3laWWlO" rel="noopener ugc nofollow" target="_blank">神话人月</a>。对于那些从未读过它的人来说，这是一篇描述工程过程和IBM开发OS/360的余波的事后分析，OS/360是当时世界上最复杂的软件系统之一。围绕它的工程努力是巨大的，并且吸取了许多痛苦的教训，直到今天仍然被谈论。</p><p id="b76a" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这本书宣扬的一个信息是，在任何成功的工程组织中，创造性的自主权<em class="lh">必须</em>连续向下授权。这意味着一个(软件)架构师负责架构，一个高级工程师负责一个端到端的特性，一个初级工程师负责用代码实现一个小的规范。毫无疑问，架构师更有经验，也是一个有成就的程序员，但是<em class="lh">不应该以任何方式干涉初级工程师的过程。让高水平的项目成员整天做基础工程工作是没有效率或可伸缩性的。</em></p><p id="1b3b" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我为什么要提这个？嗯，你应该问问你自己，你是否曾经是一个被初级工程师控制的建筑师。如果这是由软件行业的新手写的，这是一个学习练习。它可能并不完美。但是，如果这个代码还是他们的责任，就不要拆了！即使它没有你想做的那么“好”。使用客观的语言，解释你认为应该不同的地方和原因，并与他们一起找到解决方案。将批评的信息转化为建设性的信息。毕竟，初级工程师就是这样成长并成为高级工程师的。这项技术的一个额外好处是你不必重写它！</p><h1 id="bbb4" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">与你喜欢的风格不同？</h1><p id="88d9" class="pw-post-body-paragraph jo jp hi jq b jr lc ij jt ju ld im jw jx le jz ka kb lf kd ke kf lg kh ki kj hb bi translated">成为你团队风格指南的拥护者。创建一个linter配置并在您的代码库上运行它，然后为自己的出色表现而沾沾自喜。无需重写！</p><h1 id="b33b" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">代码可以理解吗？</h1><p id="07c2" class="pw-post-body-paragraph jo jp hi jq b jr lc ij jt ju ld im jw jx le jz ka kb lf kd ke kf lg kh ki kj hb bi translated">如果你能理解代码是如何工作的，并且能够用相对较少的编辑来修改它，你很可能从重写中一无所获。记住，阅读别人的代码比编写自己的代码要难得多！如果你设法做到这一点，而没有太多的挠头，那么代码实际上可能是相当织补<em class="lh">好</em>。</p><h1 id="0afc" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">网景的寓言</h1><p id="92e5" class="pw-post-body-paragraph jo jp hi jq b jr lc ij jt ju ld im jw jx le jz ka kb lf kd ke kf lg kh ki kj hb bi translated">如果你还没有听说过网景5.0的故事，男孩，你一定会喜欢的。虽然我可以从乔尔那里抄袭很长时间，但请阅读相关文章。对于那些外行的读者来说，Joel on Software可以说是有史以来最伟大的编程博客。</p><h1 id="31c7" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">这是为什么代码一开始就令人毛骨悚然的原因</h1><p id="f3dc" class="pw-post-body-paragraph jo jp hi jq b jr lc ij jt ju ld im jw jx le jz ka kb lf kd ke kf lg kh ki kj hb bi translated">没有计划能在与敌人的第一次接触中幸存。或者正如我们都喜欢说的，每个人都有一个计划，直到他们被打了一拳。软件设计也是如此。</p><p id="00d7" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">有时候，代码是复杂的，因为它需要提供复杂的功能！也许在第一次写作的时候，需求是不清楚或者不完整的。让我们不要忘记潜在的几十个错误修复程序，它们可能位于奇怪、棘手的地方。经过几周、几个月甚至几年的使用，这段代码被添加了一些令人毛骨悚然的片段来支持真实世界的用例。它总是漂亮吗？不。那是不是意味着你应该花时间重写它？嗯，我想这就是这篇文章的主旨。我个人的反应是强烈的不，如果“漂亮”是唯一的原因！</p><h1 id="5b46" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">哦，反正也用不了那么久</h1><p id="45db" class="pw-post-body-paragraph jo jp hi jq b jr lc ij jt ju ld im jw jx le jz ka kb lf kd ke kf lg kh ki kj hb bi translated">确保你对这一点非常有信心。众所周知，软件工程师擅长估计事情需要多长时间。</p><h1 id="c744" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">过早优化是万恶之源</h1><p id="4d2b" class="pw-post-body-paragraph jo jp hi jq b jr lc ij jt ju ld im jw jx le jz ka kb lf kd ke kf lg kh ki kj hb bi translated">理解重写这段代码的好处的一部分是理解清理这段代码能得到什么。</p><p id="435f" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">你有没有测量过，可验证的，这段代码“坏”的速度，痛苦，或者其他代价？你不需要进行双盲研究，但要获得比你自己和你的队友的普遍看法更多的东西。指出代码中的错误——git文件历史。从这个代码中检测和测量减速。记录下你和其他人为此付出的额外努力。如果您发现很难度量由代码引起的问题，也许它根本就没有引起任何问题？</p><p id="ab7f" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">注意——如果您没有办法分析您的性能密集型代码，请构建它！我们毕竟是计算机科学家，没有测量的科学家有什么用？我将把这个想法留给以后的文章。</p><h1 id="dc7b" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">这段代码有多活跃？</h1><p id="341f" class="pw-post-body-paragraph jo jp hi jq b jr lc ij jt ju ld im jw jx le jz ka kb lf kd ke kf lg kh ki kj hb bi translated">重写代码的最大好处之一是使它在将来更容易编辑。确保这段代码从现在开始每年会被修改不止一次。如果它是一段活跃的代码，那么重写的价值就会显著上升。</p><p id="93b5" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">也就是说，如果重写工作正常(执行是关键，人们！)中断基础架构的核心部分对您的团队来说成本很高。</p><h1 id="4930" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">我们是为了赚钱，而不是写代码</h1><p id="7f58" class="pw-post-body-paragraph jo jp hi jq b jr lc ij jt ju ld im jw jx le jz ka kb lf kd ke kf lg kh ki kj hb bi translated">我明白了，我们热爱开发的手艺。这是一份充实的职业。但归根结底，我们是来赚钱的。企业不是靠扔掉工作代码赚钱的。尤其不是为了美观。</p><p id="17dd" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">通过联想，你没有目的的写代码是拿不到工资的。重写的一个危险是与它实际完成的数量相比，它感觉有多好。在你进入那个兔子洞之前，我建议你考虑花时间做以下事情:</p><ul class=""><li id="b151" class="li lj hi jq b jr js ju jv jx lk kb ll kf lm kj ln lo lp lq bi translated">新功能</li><li id="ea5f" class="li lj hi jq b jr lr ju ls jx lt kb lu kf lv kj ln lo lp lq bi translated">提高测试覆盖率</li><li id="aa0b" class="li lj hi jq b jr lr ju ls jx lt kb lu kf lv kj ln lo lp lq bi translated">编写文档</li><li id="007a" class="li lj hi jq b jr lr ju ls jx lt kb lu kf lv kj ln lo lp lq bi translated">构建和发布自动化</li><li id="5270" class="li lj hi jq b jr lr ju ls jx lt kb lu kf lv kj ln lo lp lq bi translated">从待办事项中挑选一个bug</li></ul><p id="3b4c" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在你的下一次绩效评估中，你认为什么会让你得到更高的奖金——重写这段代码，还是我刚才提到的什么？不要因为你的公司不值得奖励的看不见的事情而毁掉自己的职业生涯。</p><h1 id="7451" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">好吧，那我应该永远不重写代码吗？</h1><p id="c9d4" class="pw-post-body-paragraph jo jp hi jq b jr lc ij jt ju ld im jw jx le jz ka kb lf kd ke kf lg kh ki kj hb bi translated">好吧，有趣的是我自相矛盾。显然，技术债是一个非常真实的东西。它不可能永远得不到解决。我们确实需要随着时间的推移更新代码，并投资于重构和重新设计，以保持软件项目的健康。对于任何软件重写，我将给出以下高水平的建议:</p><h2 id="79d5" class="lw kl hi bd km lx ly lz kq ma mb mc ku jx md me kw kb mf mg ky kf mh mi la mj bi translated"><em class="mk">一次做一点点，日积月累</em></h2><p id="052a" class="pw-post-body-paragraph jo jp hi jq b jr lc ij jt ju ld im jw jx le jz ka kb lf kd ke kf lg kh ki kj hb bi translated">我所知道的最好的软件工程师就是这样做的。边走边收拾。将大规模过程状态机块分割成接口。把不需要在一起的部分分开。将复制+粘贴垃圾移动到一个函数中。请避免大量的重写。<em class="lh">永远不要</em>扔掉它下面真正的功能。</p><h2 id="715e" class="lw kl hi bd km lx ly lz kq ma mb mc ku jx md me kw kb mf mg ky kf mh mi la mj bi translated"><em class="mk">了解需求</em></h2><p id="c51b" class="pw-post-body-paragraph jo jp hi jq b jr lc ij jt ju ld im jw jx le jz ka kb lf kd ke kf lg kh ki kj hb bi translated">我毫不怀疑你已经花了太多的脑细胞试图理解当前的代码做什么。但是<em class="lh">请</em>，至少花同样多的精力规划你的新设计。还是那句话，写代码比读代码容易。所以，当你把你的宏伟计划放在一起，用一个创新的设计让一切都棒极了的时候，考虑一下后果。</p><p id="8b4a" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这包括5年后出现在这个项目中的可怜的sap，他将永远不会见到你，并且纯粹用留下的代码工作。有时候，一个基本的、不太优雅的设计(10，000行文件中的过程化if语句)比一个广泛分布的过度工程化的设计模式更容易维护。</p><h2 id="e21e" class="lw kl hi bd km lx ly lz kq ma mb mc ku jx md me kw kb mf mg ky kf mh mi la mj bi translated"><em class="mk">证明业务影响</em></h2><p id="373f" class="pw-post-body-paragraph jo jp hi jq b jr lc ij jt ju ld im jw jx le jz ka kb lf kd ke kf lg kh ki kj hb bi translated"><em class="lh">始终</em>用业务影响来证明这一点。这可能是一个即将到来的功能，将有可能实现。可能是这个程序块产生的错误。它可能是性能，或者维护性能的量化工程成本。如果你能指出并说<em class="lh">为什么</em>，任何事情都会起作用。然后，他们往往会在结束时给你更多的钱！</p><h1 id="2b9b" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">不过，我确实想要干净的代码</h1><p id="8b8f" class="pw-post-body-paragraph jo jp hi jq b jr lc ij jt ju ld im jw jx le jz ka kb lf kd ke kf lg kh ki kj hb bi translated">作为本文的总结，我想澄清一些事情:</p><ul class=""><li id="8e57" class="li lj hi jq b jr js ju jv jx lk kb ll kf lm kj ln lo lp lq bi translated">我支持干净的代码</li><li id="d9be" class="li lj hi jq b jr lr ju ls jx lt kb lu kf lv kj ln lo lp lq bi translated">我认为合理的编码标准应该在项目中强制执行</li><li id="4ad8" class="li lj hi jq b jr lr ju ls jx lt kb lu kf lv kj ln lo lp lq bi translated">我总是喜欢编写模块化、层次化、面向对象的软件</li></ul><p id="ebd5" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">如果我看到不符合这些标准的代码，<em class="lh">我也会</em>感到重写的诱惑。但首先，我问自己对公司的好处是什么，也问自己。在那之后，我通常愉快地去做其他事情。当这种感觉变得太强烈时，我甚至可能会写一篇这样的文章来说服自己。</p><p id="0f4a" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">快乐改写(或没有)，并有一个美好的一天！</p><p id="76be" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><em class="lh">免责声明:本文包含一个附属链接</em></p></div></div>    
</body>
</html>