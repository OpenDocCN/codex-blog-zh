<html>
<head>
<title>💪Why is Azure Bicep your next choice for Infrastructure As Code?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">💪为什么Azure Bicep是您的下一个代码基础设施选择？</h1>
<blockquote>原文：<a href="https://medium.com/codex/why-is-azure-bicep-your-next-choice-for-infrastructure-as-code-f10a2b924ca7?source=collection_archive---------3-----------------------#2021-09-13">https://medium.com/codex/why-is-azure-bicep-your-next-choice-for-infrastructure-as-code-f10a2b924ca7?source=collection_archive---------3-----------------------#2021-09-13</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="93e5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">作为云工程师，您应该了解Azure Bicep对您的环境的影响。</p><p id="50cc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">本文将涵盖:</p><ul class=""><li id="90d5" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">为什么二头肌是相关的</li><li id="c646" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">Bicep将如何影响您的Azure环境</li><li id="2d9f" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">不使用二头肌的理由</li></ul><p id="653c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你熟悉使用Azure作为代码的基础设施，那么在JSON中创作Azure Resource Manager(ARM)模板会带来一系列挑战。</p><p id="1428" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi jr translated">【2020年5月，在<strong class="ih hj">微软Build </strong>大会上，一种用于声明式部署Azure资源的新领域特定语言(DSL)被引入，以改善ARM创作体验，并减少编写JSON代码的痛苦，除非你真的想这样做。</p><p id="6870" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我们深入探讨Bicep与您作为云工程师的关系之前，让我们回顾一些基线，以便更好地理解Bicep与您的关系。</p><h1 id="7dfa" class="ka kb hi bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">Azure资源管理器</h1><p id="1acb" class="pw-post-body-paragraph if ig hi ih b ii ky ik il im kz io ip iq la is it iu lb iw ix iy lc ja jb jc hb bi translated">这一切都始于Azure资源管理器。可以把Azure资源管理器看作是Azure中通过API提供的所有特定于服务的控制平面操作的前门。</p><p id="af0b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">事实上，Azure资源管理器是Azure中的底层服务层，它将帮助您在Azure中部署和管理资源。</p><p id="b837" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可以利用一些工具和语言，如Azure CLI、Azure PowerShell、SDK或Azure门户和第三方解决方案，与Azure资源管理器进行通信，并在Azure中创建、删除或更新审计和标记资源。</p><figure class="le lf lg lh fd li er es paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="er es ld"><img src="../Images/0d69b6868635378becbb7725efe904cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sFShdIGozVFxJmE_rnoq8w.png"/></div></div><figcaption class="lp lq et er es lr ls bd b be z dx translated">Azure资源管理器</figcaption></figure><p id="3716" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">简而言之，Azure资源管理器将以代码的形式为你提供所有与基础设施相关的能力，你可以执行两种类型的操作:控制平面操作和数据平面操作。</p><p id="1482" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">—控制平面操作与您在订阅中管理资源的方式相关。</p><p id="9aa9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">—数据平面操作允许您访问给定资源公开的特定功能。</p><p id="89c2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是这些操作类型的一个示例:您可以利用控制平面操作来调配虚拟机，并使用数据平面操作对虚拟机进行RDP。</p><p id="7981" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可以创建脚本来为Azure提供资源，或者通过ARM模板为您的资源使用声明性方法。</p><h1 id="c639" class="ka kb hi bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">为什么Azure二头肌相关？</h1><p id="332a" class="pw-post-body-paragraph if ig hi ih b ii ky ik il im kz io ip iq la is it iu lb iw ix iy lc ja jb jc hb bi translated">ARM模板可以包含您的部署的基础架构和配置的定义。</p><p id="35e1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">缺点是ARM模板是基于JSON的，虽然在处理更复杂的环境时，您可以采用声明式方法来提供资源，但是管理它们可能会有点麻烦。</p><p id="1f71" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后Bicep就派上了用场，因为它为您提供了更简单的语法。ARM模板不会消失；Bicep是新的领域特定语言(DSL ),用于以声明方式部署Azure资源，位于ARM模板之上。</p><p id="ac86" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当您创建一个新的Bicep模板并部署它时，它将转换成JSON文件，然后与Azure资源管理器对话，以在Azure中部署您的环境。</p><figure class="le lf lg lh fd li er es paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="er es lt"><img src="../Images/73fbd4095dd0246de13e698d07b296fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*qO5401vUXW59rTOR.png"/></div></div><figcaption class="lp lq et er es lr ls bd b be z dx translated">天蓝色二头肌</figcaption></figure><p id="4acd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这意味着我们将拥有ARM模板的所有优点和好处。我们将能够用更简单的语法在Azure中为我们的环境创建资源和配置的定义。</p><h1 id="f863" class="ka kb hi bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">模块化</h1><p id="b428" class="pw-post-body-paragraph if ig hi ih b ii ky ik il im kz io ip iq la is it iu lb iw ix iy lc ja jb jc hb bi translated">Bicep承诺通过将复杂的模板部署分解成更小的模块文件并在主模板中引用它们来实现真正的模块化。</p><p id="ac1e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">虽然模块化在ARM模板中通过嵌套或链接模板可用，但Bicep极大地简化了我们消费模块和调用外部资源的方式。</p><p id="1daf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">例如，我们可以有一个创建应用服务计划的Bicep模板和另一个创建web应用的Bicep模板。然后我们可以有一个主二头肌模板，它将前面的两个二头肌模板作为模块使用。</p><p id="a370" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下图显示了如何从主Bicep模板调用应用服务计划和web应用程序:</p><figure class="le lf lg lh fd li er es paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="er es lu"><img src="../Images/2c757b0bbc926b450dd57097ed4f5d59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-79wi7hMP-fUgNKTKVy6Bw.png"/></div></div><figcaption class="lp lq et er es lr ls bd b be z dx translated">蓝色二头肌——模块化</figcaption></figure><p id="4e27" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">注意Bicep是一种DSL语言，所以主要意图是方便你部署和配置Azure资源；然而，它不会取代任何现有的语言。</p><p id="167b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可以使用二头肌操场检查二头肌模板和手臂模板的比较:</p><p id="a348" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">👉<a class="ae lv" href="https://aka.ms/bicepdemo" rel="noopener ugc nofollow" target="_blank">https://aka.ms/bicepdemo</a></p><p id="f576" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请注意，Bicep模板大大降低了复杂性，并提供了更全面的语法。</p><h1 id="7991" class="ka kb hi bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">Bicep将如何影响您的Azure环境</h1><p id="3051" class="pw-post-body-paragraph if ig hi ih b ii ky ik il im kz io ip iq la is it iu lb iw ix iy lc ja jb jc hb bi translated">Bicep被认为是一种Azure原生语言，它将帮助您改进ARM模板的创作过程，并减少当前的一些棘手问题。</p><p id="68bd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是否意味着我们必须学习一门新的语言？简单的回答是肯定的，您会发现Bicep非常直观，并且提供了从JSON的简单过渡。</p><p id="5164" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，如果您已经熟悉ARM-JSON模板，您将能够通过“<em class="lw"> bicep decompile </em>”命令将它们反编译成Bicep模板。</p><pre class="le lf lg lh fd lx ly lz ma aw mb bi"><span id="d72d" class="mc kb hi ly b fi md me l mf mg">az bicep decompile --file main.json</span></pre><p id="5675" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从个人经验来看，如果将ARM-JSON模板反编译成Bicep模板，一定要检查变量、参数和资源属性的定义。</p><p id="d277" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要验证您的部署，您可以使用假设功能或使用标志-C来预览您的部署，如下图所示。</p><figure class="le lf lg lh fd li er es paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="er es mh"><img src="../Images/4162943fa15cb31aa421d8f359d622b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fKayqtBnIbXFaDYaEVPyGQ.png"/></div></div><figcaption class="lp lq et er es lr ls bd b be z dx translated">Azure Bicep —确认部署</figcaption></figure><p id="bd49" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">关于如何将ARM-JSON模板反编译成Bicep模板的更多细节，可以在以下网址查看:<a class="ae lv" href="https://docs.microsoft.com/en-us/azure/azure-resource-manager/bicep/decompile?tabs=azure-cli" rel="noopener ugc nofollow" target="_blank">https://docs . Microsoft . com/en-us/azure/azure-resource-manager/Bicep/decompile？tabs=azure-cli </a></p><p id="12d9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可以选择使用下面的命令从Bicep模板构建ARM-JSON模板:</p><pre class="le lf lg lh fd lx ly lz ma aw mb bi"><span id="bf32" class="mc kb hi ly b fi md me l mf mg">bicep build main.bicep --outfile azuredeploy.json</span></pre><p id="00ec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上面的命令将把你的二头肌模板转换成ARM-JSON模板。</p><h1 id="8e5d" class="ka kb hi bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">不使用二头肌的理由</h1><p id="e345" class="pw-post-body-paragraph if ig hi ih b ii ky ik il im kz io ip iq la is it iu lb iw ix iy lc ja jb jc hb bi translated">正如本文前面提到的，Bicep是一种针对代码部署的基础设施的特定语言。虽然它有一些优势，但它与其他云提供商不兼容。</p><p id="e51c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">也就是说，如果您的组织正在利用多个云提供商，Bicep可能不是不完全支持Bicep语言的云提供商的合适工具。</p><h1 id="774f" class="ka kb hi bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">结论</h1><p id="be7b" class="pw-post-body-paragraph if ig hi ih b ii ky ik il im kz io ip iq la is it iu lb iw ix iy lc ja jb jc hb bi translated">考虑到这一点，我鼓励您将Bicep作为代码部署尝试用于您的基础设施，并让您自己看到Bicep提供的好处和优势。</p><p id="2474" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">虽然Bicep处于早期阶段，但它支持Azure中的各种资源，你可以反编译现有的ARM模板，并比较语法和易用性。</p><p id="c08d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">事实上，Bicep的主要目标之一就是让代码一目了然，简单易学。</p><h1 id="6e7f" class="ka kb hi bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">后续步骤</h1><p id="6881" class="pw-post-body-paragraph if ig hi ih b ii ky ik il im kz io ip iq la is it iu lb iw ix iy lc ja jb jc hb bi translated">看看微软的学习之路—<a class="ae lv" href="https://docs.microsoft.com/en-us/learn/paths/bicep-deploy/" rel="noopener ugc nofollow" target="_blank">https://docs.microsoft.com/en-us/learn/paths/bicep-deploy/</a></p><p id="c19e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">查看如何使用Bicep部署虚拟机<a class="ae lv" href="https://blog.azinsider.net/deploy-kemp-loadmaster-in-azure-using-bicep-3b9f083997e9" rel="noopener ugc nofollow" target="_blank">https://blog . azin sider . net/deploy-Kemp-load master-in-azure-using-Bicep-3b9f 083997 e 9</a></p><p id="8ea9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae lv" href="http://eepurl.com/gKmLdf" rel="noopener ugc nofollow" target="_blank"> <em class="lw">在此加入</em><strong class="ih hj"><em class="lw">azin sider</em></strong><em class="lw">邮箱列表。</em>T13】</a></p><p id="33f2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="lw">-戴夫·r</em></p></div></div>    
</body>
</html>