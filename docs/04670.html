<html>
<head>
<title>5 Advanced Python scripts to Automate like a Pro!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">5个高级Python脚本，像专业人员一样实现自动化！</h1>
<blockquote>原文：<a href="https://medium.com/codex/5-advanced-automation-scripts-in-python-7dc0ff845099?source=collection_archive---------0-----------------------#2021-12-25">https://medium.com/codex/5-advanced-automation-scripts-in-python-7dc0ff845099?source=collection_archive---------0-----------------------#2021-12-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="b8c3" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">这些都是生活窍门！</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/982da00d3c7117b488dd3a6795b06962.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*sMNFj8Sl4oi6_4O-"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">卢西亚诺·德·萨在<a class="ae jn" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h1 id="744f" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated">1.家庭作业自动化脚本</h1><p id="09da" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">这个脚本没有完成你的家庭作业，但是已经足够接近了。这是你在docx文件中提到的谷歌搜索。</p><pre class="iy iz ja jb fd lc ld le lf aw lg bi"><span id="11bb" class="lh jp hi ld b fi li lj l lk ll">from docx import Document<br/>from googlesearch import search</span><span id="42a3" class="lh jp hi ld b fi lm lj l lk ll">filename = "PythonQuestions.docx"<br/>questions = []<br/>def getText(filename):<br/>    doc = Document(filename)<br/>    fullText = []<br/>    for para in doc.paragraphs:<br/>        questions.append(para.text)<br/>        fullText.append(para.text)<br/>    return '\n'.join(fullText)</span><span id="b5a1" class="lh jp hi ld b fi lm lj l lk ll">doc = Document()<br/>doc.add_heading('Homework', 0)</span><span id="b121" class="lh jp hi ld b fi lm lj l lk ll">for i in questions:<br/>    doc.add_heading(i, level = 1)<br/>    for j in search(i,                  # query<br/>                    lang="en",          <br/>                    num=5,              # number of results<br/>                    start=0,            # start page<br/>                    stop=2,             # stop page<br/>                    pause=2):           # delay between each call<br/>        doc.add_paragraph(j)</span><span id="7df6" class="lh jp hi ld b fi lm lj l lk ll">doc.save('Homework.docx')</span></pre><p id="ce1e" class="pw-post-body-paragraph kg kh hi ki b kj ln ij kl km lo im ko kp lp kr ks kt lq kv kw kx lr kz la lb hb bi translated">以上脚本中使用的库:</p><pre class="iy iz ja jb fd lc ld le lf aw lg bi"><span id="48e2" class="lh jp hi ld b fi li lj l lk ll">pip install python-docx<br/>pip install googlesearch-python</span></pre></div><div class="ab cl ls lt gp lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="hb hc hd he hf"><h1 id="302d" class="jo jp hi bd jq jr lz jt ju jv ma jx jy io mb ip ka ir mc is kc iu md iv ke kf bi translated">2.文件管理自动化脚本</h1><p id="35cc" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">我曾经在网上课堂上遇到过这个想法，因为我必须为多个主题下载多个文件，然后手动将它们分成不同主题的文件夹，这变成了一项单调乏味的任务。</p><p id="c2ed" class="pw-post-body-paragraph kg kh hi ki b kj ln ij kl km lo im ko kp lp kr ks kt lq kv kw kx lr kz la lb hb bi translated">感谢StackOverflow的回答，我发现了关于看门狗库跟踪目录中的变化。</p><pre class="iy iz ja jb fd lc ld le lf aw lg bi"><span id="f769" class="lh jp hi ld b fi li lj l lk ll">from watchdog.observers import Observer<br/>from watchdog.events import FileSystemEventHandler<br/>import os<br/>import time<br/>import re<br/>import shutil</span><span id="18d5" class="lh jp hi ld b fi lm lj l lk ll">regexSearch = "Util.py$"  # replace your regex here</span><span id="a29f" class="lh jp hi ld b fi lm lj l lk ll">class MyHandler(FileSystemEventHandler):</span><span id="cd25" class="lh jp hi ld b fi lm lj l lk ll">def on_modified(self, event):<br/>  for filename in os.listdir(folder_to_track):<br/>   if(re.search(regexSearch, filename)):        <br/>    src = folder_to_track + "\\" + filename<br/>    new_destination = folder_destination + "\\" + filename<br/>    shutil.move(src, new_destination)</span><span id="1cda" class="lh jp hi ld b fi lm lj l lk ll">folder_to_track = ""  # Source<br/>folder_destination = ""  # Destination</span><span id="7753" class="lh jp hi ld b fi lm lj l lk ll">event_handler = MyHandler()<br/>observer = Observer()<br/>observer.schedule(event_handler, folder_to_track, recursive = True)<br/>observer.start()</span><span id="a862" class="lh jp hi ld b fi lm lj l lk ll">try:<br/> while True:<br/>  time.sleep(2)<br/>except KeyboardInterrupt:<br/> observer.stop()</span><span id="be8b" class="lh jp hi ld b fi lm lj l lk ll">observer.join()</span></pre><p id="70e1" class="pw-post-body-paragraph kg kh hi ki b kj ln ij kl km lo im ko kp lp kr ks kt lq kv kw kx lr kz la lb hb bi translated">要下载的库</p><pre class="iy iz ja jb fd lc ld le lf aw lg bi"><span id="ce9c" class="lh jp hi ld b fi li lj l lk ll">pip install watchdog</span></pre></div><div class="ab cl ls lt gp lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="hb hc hd he hf"><h1 id="21b5" class="jo jp hi bd jq jr lz jt ju jv ma jx jy io mb ip ka ir mc is kc iu md iv ke kf bi translated">3.即时制作有声读物</h1><p id="5fdb" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">如果你是一个期待听有声读物的人，那么你肯定想要这个脚本，它可以将PDF中的所有文本转换成MP3文件。</p><pre class="iy iz ja jb fd lc ld le lf aw lg bi"><span id="3304" class="lh jp hi ld b fi li lj l lk ll">from PyPDF2 import PdfFileReader<br/>from pyttsx3 import init</span><span id="c453" class="lh jp hi ld b fi lm lj l lk ll">def getTextFromAllPages():<br/>    txt = ""<br/>    with open('PythonQuestions.pdf', 'rb') as f:<br/>        pdfReaderObj = PdfFileReader(f)<br/>        numPages = pdfReaderObj.getNumPages()<br/>        for pageN in range(numPages):<br/>            page = pdfReaderObj.getPage(pageN)<br/>            pageContent = page.extractText()<br/>            txt += pageContent<br/>    return txt</span><span id="b4b2" class="lh jp hi ld b fi lm lj l lk ll">txt = getTextFromAllPages()<br/>engine = init()<br/>engine.save_to_file(txt, 'test.mp3')<br/>engine.runAndWait()</span></pre><p id="0a68" class="pw-post-body-paragraph kg kh hi ki b kj ln ij kl km lo im ko kp lp kr ks kt lq kv kw kx lr kz la lb hb bi translated">要下载的库</p><pre class="iy iz ja jb fd lc ld le lf aw lg bi"><span id="264a" class="lh jp hi ld b fi li lj l lk ll">pip install PyPDF2<br/>pip install pyttsx3</span></pre></div><div class="ab cl ls lt gp lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="hb hc hd he hf"><h1 id="6e9b" class="jo jp hi bd jq jr lz jt ju jv ma jx jy io mb ip ka ir mc is kc iu md iv ke kf bi translated">4.批量文件重命名自动化脚本</h1><p id="42ef" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">这个脚本是所有程序员的必备:P</p><p id="0995" class="pw-post-body-paragraph kg kh hi ki b kj ln ij kl km lo im ko kp lp kr ks kt lq kv kw kx lr kz la lb hb bi translated">当我们从网上大量下载文件时，我们只是给文件起了个糟糕的名字，然后忘记给它们重新命名，那么不用再看了，这个脚本可以为你节省几个小时的重新命名文件的时间。</p><pre class="iy iz ja jb fd lc ld le lf aw lg bi"><span id="30e1" class="lh jp hi ld b fi li lj l lk ll">import os</span><span id="12f5" class="lh jp hi ld b fi lm lj l lk ll">root = os.path.join('..', 'test')</span><span id="70e5" class="lh jp hi ld b fi lm lj l lk ll">targetName = "textFile"<br/>iter = 1</span><span id="0384" class="lh jp hi ld b fi lm lj l lk ll">for directory, subDirList, fileList in os.walk(root):<br/>    for name in fileList:<br/>        sourceName = os.path.join(directory, name)<br/>        modName = os.path.join(directory, f'{targetName} {iter}')<br/>        iter  += 1<br/>        print(f'Changed from: {sourceName} to {modifiedName}')<br/>        os.rename(sourceName, modName)</span></pre></div><div class="ab cl ls lt gp lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="hb hc hd he hf"><h1 id="6d6d" class="jo jp hi bd jq jr lz jt ju jv ma jx jy io mb ip ka ir mc is kc iu md iv ke kf bi translated">5.本地备份自动化脚本</h1><p id="6ec7" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">该脚本允许您将文件夹和文件备份到zip文件中，以便保存到云上。</p><pre class="iy iz ja jb fd lc ld le lf aw lg bi"><span id="47c3" class="lh jp hi ld b fi li lj l lk ll">from zipfile import ZipFile<br/>from os import path, walk</span><span id="014a" class="lh jp hi ld b fi lm lj l lk ll">root = path.join('..', 'test')</span><span id="16cb" class="lh jp hi ld b fi lm lj l lk ll">def zipFiles(root):<br/>    zipName = ''.join(path.basename(root) + '.zip')<br/>    backupZipFile = ZipFile(zipName , 'w')<br/>    print(f'Creating {zipName}')<br/>    for directory, subDirList, fileList in walk(root):<br/>        print(f'Adding files in {directory}')<br/>        backupZipFile.write(directory)<br/>        for name in fileList:<br/>            backupZipFile.write(path.join(directory, name))   <br/>    backupZipFile.close()<br/>    print('Done!')<br/>zipFiles(root)</span></pre></div><div class="ab cl ls lt gp lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="hb hc hd he hf"><p id="f848" class="pw-post-body-paragraph kg kh hi ki b kj ln ij kl km lo im ko kp lp kr ks kt lq kv kw kx lr kz la lb hb bi translated">如果您喜欢这篇文章，并且想了解更多关于Python的内容，请查看这些文章。</p><div class="me mf ez fb mg mh"><a rel="noopener follow" target="_blank" href="/codex/5-advanced-code-snippets-for-your-python-programs-3377baa3d544"><div class="mi ab dw"><div class="mj ab mk cl cj ml"><h2 class="bd hj fi z dy mm ea eb mn ed ef hh bi translated">Python程序的5个高级代码片段</h2><div class="mo l"><h3 class="bd b fi z dy mm ea eb mn ed ef dx translated">使用它们，让人们惊奇</h3></div><div class="mp l"><p class="bd b fp z dy mm ea eb mn ed ef dx translated">medium.com</p></div></div><div class="mq l"><div class="mr l ms mt mu mq mv jh mh"/></div></div></a></div><div class="me mf ez fb mg mh"><a href="https://python.plainenglish.io/python-functions-that-make-life-easier-9d0c41b986a8" rel="noopener  ugc nofollow" target="_blank"><div class="mi ab dw"><div class="mj ab mk cl cj ml"><h2 class="bd hj fi z dy mm ea eb mn ed ef hh bi translated">让生活更简单的5个Python函数</h2><div class="mo l"><h3 class="bd b fi z dy mm ea eb mn ed ef dx translated">让生活更简单的Python函数列表。</h3></div><div class="mp l"><p class="bd b fp z dy mm ea eb mn ed ef dx translated">python .平原英语. io</p></div></div><div class="mq l"><div class="mw l ms mt mu mq mv jh mh"/></div></div></a></div><div class="me mf ez fb mg mh"><a href="https://python.plainenglish.io/if-you-are-using-assert-you-must-read-this-7256e46dc816" rel="noopener  ugc nofollow" target="_blank"><div class="mi ab dw"><div class="mj ab mk cl cj ml"><h2 class="bd hj fi z dy mm ea eb mn ed ef hh bi translated">停止使用Assert进行数据验证</h2><div class="mo l"><h3 class="bd b fi z dy mm ea eb mn ed ef dx translated">对于那些使用断言操作进行数据验证的人来说，这是一篇必读的文章。</h3></div><div class="mp l"><p class="bd b fp z dy mm ea eb mn ed ef dx translated">python .平原英语. io</p></div></div><div class="mq l"><div class="mx l ms mt mu mq mv jh mh"/></div></div></a></div></div><div class="ab cl ls lt gp lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="hb hc hd he hf"><p id="f17d" class="pw-post-body-paragraph kg kh hi ki b kj ln ij kl km lo im ko kp lp kr ks kt lq kv kw kx lr kz la lb hb bi translated">你可以在我的个人资料中找到更多这样的内容。</p><div class="me mf ez fb mg mh"><a rel="noopener follow" target="_blank" href="/@rahulbhatt1899"><div class="mi ab dw"><div class="mj ab mk cl cj ml"><h2 class="bd hj fi z dy mm ea eb mn ed ef hh bi translated">拉胡尔·布哈特-中等</h2><div class="mo l"><h3 class="bd b fi z dy mm ea eb mn ed ef dx translated">阅读媒体上的拉胡尔·布哈特作品。我写Python脚本和文章。GitHub…</h3></div><div class="mp l"><p class="bd b fp z dy mm ea eb mn ed ef dx translated">medium.com</p></div></div><div class="mq l"><div class="my l ms mt mu mq mv jh mh"/></div></div></a></div></div></div>    
</body>
</html>