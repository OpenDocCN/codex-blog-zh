<html>
<head>
<title>React useState() hook usage.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React useState()挂钩用法。</h1>
<blockquote>原文：<a href="https://medium.com/codex/react-usestate-hook-usage-693310f5d894?source=collection_archive---------21-----------------------#2021-07-22">https://medium.com/codex/react-usestate-hook-usage-693310f5d894?source=collection_archive---------21-----------------------#2021-07-22</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/d07fc467968048a7b38f67b38822fda1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*cXh-pN2ayG0K8SrN"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">照片由<a class="ae iu" href="https://unsplash.com/@ffstop?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">福蒂斯·福托普洛斯</a>在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</figcaption></figure><p id="0768" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">大家好，今天我们将看到如何使用React useState钩子。钩子是React 16.8的新增功能。它们允许您使用状态和其他React特性，而无需编写类。在React 16.8之前，我们没有在功能组件中声明特性用法，好像它们就像React中的辅助字符一样。</p><p id="5eff" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">从React 16.8开始，React团队通过引入钩子，决定将功能组件作为React开发中的主要角色。钩子在弥合状态和功能组件之间的鸿沟方面起着关键的作用。现在，我们可以开发主要使用功能组件的React应用程序(我现在正在做同样的事情，尽管我不敢重写现有的基于类的组件)。</p><p id="8519" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">好了，让我们进入React.useState(“相信我，我不会用经典、传统的<code class="du jt ju jv jw b">You clicked {count} times</code>例子来烦你”)。</p><p id="e72c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在基于类的组件中，我们使用this.state()来声明状态变量及其初始值。下面是一个很好的fat例子，其中state维护多个数据。</p><pre class="jx jy jz ka fd kb jw kc kd aw ke bi"><span id="8982" class="kf kg hi jw b fi kh ki l kj kk">constructor(props) {<br/>        super(props);<br/>        this.state = {<br/>            currentPageBuilds: [],<br/>            downloadedData: [],<br/>            filteredData: [],<br/>            builds: [],<br/>            _sort: 'submittedDate',<br/>            _page: 1,<br/>            _order: 'desc',<br/>            _limit: 10,<br/>            _Type: 0,<br/>            _boxId: '',<br/>            boxName: '',<br/>            selectedRows: { data: [] },<br/>            q: '',<br/>            totalCount: 0,<br/>            loading: false,<br/>            isFiltered: false,<br/>            failure: false,<br/>        };</span></pre><p id="953f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在我们将看到如何在功能组件中使用useState()。首先，我们将从react导入所需的模块。</p><pre class="jx jy jz ka fd kb jw kc kd aw ke bi"><span id="5f34" class="kf kg hi jw b fi kh ki l kj kk">import React,{useState} from 'react'<br/>/*here we have imported the useState to maintain the state of the React component.<br/>*/</span></pre><p id="cedb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在我们将创建一个测试功能组件来使用状态。</p><pre class="jx jy jz ka fd kb jw kc kd aw ke bi"><span id="b470" class="kf kg hi jw b fi kh ki l kj kk">import React,{useState} from 'react'</span><span id="83eb" class="kf kg hi jw b fi kl ki l kj kk">function State() {</span><span id="d7db" class="kf kg hi jw b fi kl ki l kj kk">    return (<br/>        &lt;div&gt;</span><span id="775f" class="kf kg hi jw b fi kl ki l kj kk">        &lt;/div&gt;<br/>    )<br/>}</span><span id="9a6f" class="kf kg hi jw b fi kl ki l kj kk">export default State</span></pre><p id="eff1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在我们将使用React.useState()创建一个状态变量来存储自由JSON API <a class="ae iu" href="https://mocki.io/v1/d4867d8b-b5d5-4a48-a4ab-79131b5809b8" rel="noopener ugc nofollow" target="_blank">链接</a>返回的数据。</p><pre class="jx jy jz ka fd kb jw kc kd aw ke bi"><span id="d464" class="kf kg hi jw b fi kh ki l kj kk">const [characters, setCharactersData] = useState([]);</span></pre><p id="de21" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在上面的状态声明中，我们使用数组析构为我们的当前状态命名，并使用函数更新该状态，<strong class="ix hj"> characters </strong>保存API返回的字符数据，<strong class="ix hj"> setCharactersData </strong>函数用于设置/更新数据到<strong class="ix hj"> characters </strong>变量。作为<strong class="ix hj"> useState([]) </strong>的一部分，您正在使用react hook创建一个具有数组数据类型的状态，并且初始数据是一个空数组。<strong class="ix hj"> useState() </strong>将初始值作为参数。这里我们用一个空数组初始化。</p><p id="0604" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们将它作为CharacterSummary功能组件的一部分，从API获取数据，并将名称存储为状态的一部分。</p><pre class="jx jy jz ka fd kb jw kc kd aw ke bi"><span id="af23" class="kf kg hi jw b fi kh ki l kj kk">import "./styles.css";<br/>import React, { useState } from "react";<br/>export default function App() {<br/>  const [characters, setCharactersData] = useState([]);</span><span id="51cc" class="kf kg hi jw b fi kl ki l kj kk">  const fetchData = async () =&gt; {<br/>    await fetch("https://mocki.io/v1/d4867d8b-b5d5-4a48-a4ab-79131b5809b8")<br/>      .then((res) =&gt; res.json())<br/>      .then((data) =&gt; {<br/>        let names = [];<br/>        data.forEach(function (item) {<br/>          names.push(item.name)<br/>        });</span><span id="2e47" class="kf kg hi jw b fi kl ki l kj kk">        setCharactersData(names);</span><span id="001d" class="kf kg hi jw b fi kl ki l kj kk">      });<br/>  };<br/>  return (<br/>    &lt;div&gt;<br/>      &lt;label&gt;Data is&lt;/label&gt;<br/>      &lt;p&gt;{characters}&lt;/p&gt;<br/>      &lt;button onClick={() =&gt; fetchData()}&gt;Click&lt;/button&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span></pre><p id="20fb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在上面的组件中，我们在UI中显示一个按钮。当上面的JSX被渲染时，UI中将显示一个按钮。数据将为空，因为state是一个空数组。</p><p id="ee18" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">当我们点击按钮时，fetch将从API获取详细信息，所有名称将作为<strong class="ix hj">字符</strong>状态的一部分存储。同样的内容也会显示在用户界面上。</p><figure class="jx jy jz ka fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es km"><img src="../Images/19e8d5f4e93f79663b78afdb506cf6cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Q-t5IJs8QgU_kVjw.PNG"/></div></div></figure><h1 id="190e" class="kn kg hi bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">关于React.useState()的一些问题</h1><ol class=""><li id="0ce6" class="lk ll hi ix b iy lm jc ln jg lo jk lp jo lq js lr ls lt lu bi translated"><strong class="ix hj">如果我们想要使用不止一个状态变量</strong>怎么办:——简单地多次使用useState()来声明多个状态变量。如果您只想使用一个useState()变量，那么在一个useState()中将所有变量声明为一个对象。下面的例子。</li></ol><pre class="jx jy jz ka fd kb jw kc kd aw ke bi"><span id="062d" class="kf kg hi jw b fi kh ki l kj kk">const [multiple, setMultiple] = useState({currentPageBuilds: [],<br/>            downloadedData: [],<br/>            filteredData: [],<br/>            builds: [],<br/>            _sort: 'submittedDate',<br/>            _page: 1,<br/>            _order: 'desc',<br/>            _limit: 10,<br/>            _Type: 0,<br/>            _boxId: '',<br/>            boxName: '',<br/>            selectedRows: { data: [] },<br/>            q: '',<br/>            totalCount: 0,<br/>            loading: false,<br/>            isFiltered: false,<br/>            failure: false,});</span></pre><p id="9159" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">你可以像这样更新复杂状态下的任何变量。</p><pre class="jx jy jz ka fd kb jw kc kd aw ke bi"><span id="df38" class="kf kg hi jw b fi kh ki l kj kk">setMultiple({...multiple,failure:true});</span></pre><ol class=""><li id="2b3f" class="lk ll hi ix b iy iz jc jd jg lv jk lw jo lx js lr ls lt lu bi translated"><strong class="ix hj">我们能在任何地方使用useState()吗</strong> :-不能，React钩子只能在顶级使用。不要在循环、条件或嵌套函数中调用钩子。通过遵循这条规则，您可以确保每次组件呈现时都以相同的顺序调用钩子。这使得React能够正确地保存多个<code class="du jt ju jv jw b">useState</code>和<code class="du jt ju jv jw b">useEffect</code>调用之间的钩子状态。</li></ol><p id="80dc" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">只在React函数中调用钩子，不从任何Java脚本函数中调用。</p><p id="76d4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">关于useState()的更多内容</strong> :-</p><ul class=""><li id="1cc3" class="lk ll hi ix b iy iz jc jd jg lv jk lw jo lx js ly ls lt lu bi translated">useState()的update函数不会立即更新值。它是异步的。</li><li id="b5b2" class="lk ll hi ix b iy lz jc ma jg mb jk mc jo md js ly ls lt lu bi translated">如果相同的值被更新为状态，React不会重新渲染组件，因为React使用对象。将更新的状态值与以前的状态值进行比较。</li><li id="f415" class="lk ll hi ix b iy lz jc ma jg mb jk mc jo md js ly ls lt lu bi translated">在复杂对象的情况下，useState()替换对象，而不是合并。</li><li id="5afe" class="lk ll hi ix b iy lz jc ma jg mb jk mc jo md js ly ls lt lu bi translated">如果使用前一个值来更新状态，则必须传递一个接收前一个值并返回更新值的函数。下面的例子。</li></ul><pre class="jx jy jz ka fd kb jw kc kd aw ke bi"><span id="87e5" class="kf kg hi jw b fi kh ki l kj kk">setMessage(previousVal =&gt; previousVal + currentVal)</span></pre><p id="c69b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这就是我所有的reg useState()。一旦我发现更多的细节，我会更新文章。谢了。</p></div></div>    
</body>
</html>