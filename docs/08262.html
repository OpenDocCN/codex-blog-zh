<html>
<head>
<title>Use Django and the Dev.to API to Display Posts</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Django和Dev.to API来显示帖子</h1>
<blockquote>原文：<a href="https://medium.com/codex/use-django-and-the-dev-to-api-to-display-posts-c269f8172e1a?source=collection_archive---------13-----------------------#2022-07-27">https://medium.com/codex/use-django-and-the-dev-to-api-to-display-posts-c269f8172e1a?source=collection_archive---------13-----------------------#2022-07-27</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/e619d0fe9e42a4071d32244f790bcefc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*hSZ2fesXZKYOQYKR.png"/></div></div></figure><p id="b00d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">作为一名开发者，你可能想知道你是否需要一个博客。老实说，我写博客已经有一段时间了，我能告诉你的是，在你的网站上写博客有巨大的好处。这么说吧，你有一个网站，你有一个投资组合，你卖产品或服务。你如何为你的网站带来更多的流量，让潜在的招聘者或客户发现你的产品或服务？</p><p id="e0b9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">增加网站流量的最好方法是拥有一个包含有用内容的博客。一个包含有用内容的博客向你的读者和客户展示你是一个值得信赖的信息来源。</p><p id="7ab8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然而，要在你的网站上有一个博客，你需要一个内容管理系统，缩写为CMS。CMS是一个软件解决方案，它帮助人们创建、管理和修改网站上的内容，而不需要专门的技术知识。</p><p id="d372" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">大多数CMS是付费的，如果你想节省一些钱，付费的CMS是你最不想要的。在这篇文章中，我将向你展示如何在你的网站上添加一个博客，而不用花一分钱。我将使用Django、Dev.to API、PostgreSQL和Arctype SQL客户端。</p><h1 id="ea0c" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">什么是开发。去，姜戈，还有波斯格里斯？</h1><p id="37d6" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated"><a class="ae jo" href="https://dev.to/" rel="noopener ugc nofollow" target="_blank"> Dev.to </a>是一个博客平台，开发者可以在这里发布主题文章，帮助其他开发者解决问题或学习新事物。Dev.to是一个软件开发人员的社区，他们聚在一起互相帮助。Django是一个基于Python的免费开源web框架，遵循模型-模板-视图架构模式。Django鼓励快速开发和干净、实用的设计。</p><p id="2660" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">PostgreSQL，也称为Postgres，是一个强调SQL合规性的免费开源关系数据库管理系统。</p><h1 id="b9dc" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">先决条件</h1><p id="6303" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">首先，为了能够完成本教程，您需要在您的机器上安装一个文本编辑器。在这种情况下，我将使用<a class="ae jo" href="https://code.visualstudio.com/" rel="noopener ugc nofollow" target="_blank"> Visual Studio代码</a>编辑器，但是您也可以使用您选择的代码编辑器。另外，确保您的机器上安装了<a class="ae jo" href="https://www.python.org/downloads/" rel="noopener ugc nofollow" target="_blank"> Python </a>和<a class="ae jo" href="https://www.postgresql.org/download/" rel="noopener ugc nofollow" target="_blank"> PostgreSQL </a>。</p><h1 id="d6c6" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">项目设置</h1><p id="7133" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">要开始学习本教程，请在您的机器上创建一个名为<em class="ks"> Blog </em>的文件夹。右击文件夹，用Visual Studio代码文本编辑器或您选择的文本编辑器打开它。使用Visual Studio代码时，点击顶部的终端选项，选择<em class="ks">新建终端</em>，如下图所示。</p><figure class="kt ku kv kw fd ij er es paragraph-image"><div class="ab fe cl kx"><img src="../Images/11ad5047548b35750c841b19079c2e8c.png" data-original-src="https://miro.medium.com/v2/0*_2kWl6skJdJNHhze"/></div></figure><p id="1e67" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在让我们将<em class="ks"> Django </em>安装到我们的博客Django项目中。为了安装Django，我们将使用一个名为<em class="ks"> Pipenv </em>的python打包工具。Pipenv用于管理Django项目中的虚拟环境。您可以使用本指南<a class="ae jo" href="https://pipenv-fork.readthedocs.io/en/latest/install.html" rel="noopener ugc nofollow" target="_blank">将Pipenv安装到您的机器上</a>。现在运行下面的命令将Django安装到您的项目中:</p><pre class="kt ku kv kw fd ky kz la lb aw lc bi"><span id="a5e3" class="ld jq hi kz b fi le lf l lg lh">pipenv install django</span></pre><p id="3222" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然后通过运行下面显示的命令在项目中创建一个虚拟环境。</p><pre class="kt ku kv kw fd ky kz la lb aw lc bi"><span id="8c83" class="ld jq hi kz b fi le lf l lg lh">pipenv shell</span></pre><p id="16d1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，您应该在命令行上看到Blog的括号，如下所示。</p><pre class="kt ku kv kw fd ky kz la lb aw lc bi"><span id="d504" class="ld jq hi kz b fi le lf l lg lh">((Blog))</span></pre><p id="2f30" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Blog周围的括号表示虚拟环境已经被激活。</p><p id="c319" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在让我们通过运行下面显示的命令来创建一个名为Articles的新Django项目。别忘了句号(。)在最后。</p><pre class="kt ku kv kw fd ky kz la lb aw lc bi"><span id="cdb6" class="ld jq hi kz b fi le lf l lg lh">django-admin startproject Articles .</span></pre><p id="a3b4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在运行下面显示的命令，然后访问<a class="ae jo" href="http://127.0.0.1:8000:" rel="noopener ugc nofollow" target="_blank"> http://127.0.0.1:8000: </a></p><pre class="kt ku kv kw fd ky kz la lb aw lc bi"><span id="a7de" class="ld jq hi kz b fi le lf l lg lh">python manage.py runserver</span></pre><p id="9525" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您应该会看到如下所示的Django欢迎页面。</p><figure class="kt ku kv kw fd ij er es paragraph-image"><div class="ab fe cl kx"><img src="../Images/8edbed680ea809cd0d789b4f25a90b39.png" data-original-src="https://miro.medium.com/v2/0*PYXitBzM6EHFcVT9"/></div></figure><p id="0c03" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在让我们在Django项目中创建一个名为<em class="ks"> posts </em>的应用程序。在命令行中，用<em class="ks"> control+c. </em>退出服务器，然后运行如下所示的命令。</p><pre class="kt ku kv kw fd ky kz la lb aw lc bi"><span id="5767" class="ld jq hi kz b fi le lf l lg lh">python manage.py startapp posts</span></pre><p id="8890" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在Visual Studio代码编辑器窗口中，单击<em class="ks"> Articles </em>文件夹并打开<em class="ks"> settings.py </em>文件，如下所示。</p><figure class="kt ku kv kw fd ij er es paragraph-image"><div class="ab fe cl kx"><img src="../Images/ffb162f3aed1d60e2078bfb588207801.png" data-original-src="https://miro.medium.com/v2/0*5VzY1GhT6lym38MC"/></div></figure><p id="9314" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在settings.py文件中，向下滚动到<code class="du li lj lk kz b">INSTALLED_APPS</code>部分，您会看到已经有六个内置的Django应用程序。如下所示，在底部添加我们的新帖子应用程序。</p><pre class="kt ku kv kw fd ky kz la lb aw lc bi"><span id="c4c0" class="ld jq hi kz b fi le lf l lg lh">INSTALLED_APPS = [<br/>   'django.contrib.admin',<br/>   'django.contrib.auth',<br/>   'django.contrib.contenttypes',<br/>   'django.contrib.sessions',<br/>   'django.contrib.messages',<br/>   'django.contrib.staticfiles',<br/>   'posts',  # new<br/>]</span></pre><h1 id="9641" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">设置Postgres</h1><p id="b1ca" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">在您的机器上安装Postgres之后，运行下面的命令来确认安装。</p><pre class="kt ku kv kw fd ky kz la lb aw lc bi"><span id="046a" class="ld jq hi kz b fi le lf l lg lh">psql --version</span></pre><p id="0ef6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您应该能够看到安装在您系统中的Postgres版本。现在运行下面显示的命令来打开Postgres提示符。</p><pre class="kt ku kv kw fd ky kz la lb aw lc bi"><span id="c1c3" class="ld jq hi kz b fi le lf l lg lh">sudo -u postgres psql postgres</span></pre><p id="f6fe" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">PostgreSQL在命令行上打开后，运行下面的命令为其设置密码。</p><pre class="kt ku kv kw fd ky kz la lb aw lc bi"><span id="8dfb" class="ld jq hi kz b fi le lf l lg lh">\password postgres</span></pre><p id="1b62" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">要退出PostgreSQL提示符，请运行如下所示的命令。</p><pre class="kt ku kv kw fd ky kz la lb aw lc bi"><span id="4f8b" class="ld jq hi kz b fi le lf l lg lh">\q</span></pre><p id="0da7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">要再次打开postgres提示符，请运行下面显示的命令，并输入您为Postgres设置的密码。</p><pre class="kt ku kv kw fd ky kz la lb aw lc bi"><span id="4c07" class="ld jq hi kz b fi le lf l lg lh">psql -U postgres -W</span></pre><p id="a13e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在让我们在Postgres中创建一个数据库，通过运行下面的命令来存储我们的博客项目的帖子。</p><pre class="kt ku kv kw fd ky kz la lb aw lc bi"><span id="f0a2" class="ld jq hi kz b fi le lf l lg lh">CREATE DATABASE posts;</span></pre><p id="2793" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然后运行下面显示的命令，查看您创建的数据库是否在Postgres的数据库列表中。</p><pre class="kt ku kv kw fd ky kz la lb aw lc bi"><span id="ae2f" class="ld jq hi kz b fi le lf l lg lh">\l</span></pre><p id="8726" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">从下面的截图可以看出，post数据库是在PostgreSQL中创建的。</p><figure class="kt ku kv kw fd ij er es paragraph-image"><div class="ab fe cl kx"><img src="../Images/f062ed941af79be3f049a7a3e8370139.png" data-original-src="https://miro.medium.com/v2/0*vh9BXzFI4EiSu3xi"/></div></figure><h1 id="fd42" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">集成Postgres和Django</h1><p id="f79b" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">让我们安装psycopg2包，它将允许我们使用通过运行下面的命令创建的Postgres数据库。</p><pre class="kt ku kv kw fd ky kz la lb aw lc bi"><span id="0761" class="ld jq hi kz b fi le lf l lg lh">pipenv install psycopg2</span></pre><p id="5c23" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">打开Articles文件夹中的settings.py文件，向下滚动到DATABASES部分，如下所示。</p><pre class="kt ku kv kw fd ky kz la lb aw lc bi"><span id="0a3b" class="ld jq hi kz b fi le lf l lg lh">DATABASES = {<br/>   'default': {<br/>       'ENGINE': 'django.db.backends.sqlite3',<br/>       'NAME': BASE_DIR / 'db.sqlite3',<br/>   }<br/>}</span></pre><p id="78f1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">该项目被配置为使用SQLite作为数据库。您需要做的是更改这一点，以便项目可以使用我们创建的Postgres数据库。</p><p id="32f0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">更改引擎，使其使用Postgres适配器而不是sqlite3适配器。对于名称，使用数据库的名称，在本例中是<em class="ks"> posts。</em>您还需要为您的数据库添加登录凭证。</p><p id="cc01" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">用户应该是postgres，密码应该是您为postgres设置的密码。settings.py文件的DATABASES部分现在应该如下所示。</p><pre class="kt ku kv kw fd ky kz la lb aw lc bi"><span id="590b" class="ld jq hi kz b fi le lf l lg lh">DATABASES = {<br/>   'default': {<br/>       'ENGINE': 'django.db.backends.postgresql',<br/>       'NAME': 'posts',<br/>       'USER': 'postgres',<br/>       'PASSWORD': 'password',<br/>       'HOST': 'localhost',<br/>       'PORT': '',<br/>   }<br/>}</span></pre><h1 id="f764" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">Django模型</h1><p id="adf7" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">现在让我们创建一个Django模型，它定义了我们希望存储在Postgres数据库中的数据字段。要创建模型，导航到posts文件夹中的<em class="ks"> models.py </em>文件，如下所示。</p><figure class="kt ku kv kw fd ij er es paragraph-image"><div class="ab fe cl kx"><img src="../Images/0d3d1568a0522b0e33159aaec089c2bb.png" data-original-src="https://miro.medium.com/v2/0*Iim64QM1jjpElALm"/></div></figure><p id="a742" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您的models.py文件现在应该如下所示。</p><pre class="kt ku kv kw fd ky kz la lb aw lc bi"><span id="bf9f" class="ld jq hi kz b fi le lf l lg lh">from django.db import models<br/>import datetime<br/><br/><br/>class Article(models.Model):<br/>   title = models.TextField(blank=True)<br/>   description = models.TextField(blank=True)<br/>   cover_image = models.TextField(blank=True)<br/>   article_body = models.TextField(blank=True)<br/>   published_at = models.DateTimeField(<br/>       default=datetime.date.today, blank=True, null=True)<br/><br/>   def __str__(self):<br/>       return self.title</span></pre><p id="d0f9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们通过运行下面的命令来创建迁移并将其应用到数据库中。</p><pre class="kt ku kv kw fd ky kz la lb aw lc bi"><span id="0d57" class="ld jq hi kz b fi le lf l lg lh">python manage.py makemigrations</span><span id="645a" class="ld jq hi kz b fi ll lf l lg lh">python manage.py migrate</span></pre><p id="5780" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在让我们通过打开posts文件夹中的<em class="ks"> admin.py </em>文件来注册这个模型。admin.py文件现在应该如下所示。</p><pre class="kt ku kv kw fd ky kz la lb aw lc bi"><span id="9c60" class="ld jq hi kz b fi le lf l lg lh">from django.contrib import admin<br/>from django.contrib.auth.admin import UserAdmin<br/><br/>from .models import Article<br/><br/><br/>class ArticleAdmin(admin.ModelAdmin):<br/>   list_display = ('id', 'title')<br/><br/><br/>admin.site.register(Article, ArticleAdmin)</span></pre><p id="99cc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下一步是通过运行下面的命令创建一个管理员帐户。您将被要求选择用户名，提供电子邮件地址，选择并确认帐户密码。</p><pre class="kt ku kv kw fd ky kz la lb aw lc bi"><span id="dcfb" class="ld jq hi kz b fi le lf l lg lh">python manage.py createsuperuser</span></pre><h1 id="985a" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">Django观点</h1><p id="01d6" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">现在访问<a class="ae jo" href="https://developers.forem.com/api/" rel="noopener ugc nofollow" target="_blank"> Dev.to API文档</a>来学习如何获得API密匙和各种API端点。在网页左侧，选择<em class="ks">认证</em>部分，了解如何获取API密钥。</p><figure class="kt ku kv kw fd ij er es paragraph-image"><div class="ab fe cl kx"><img src="../Images/079bc4d325bce33b3cbac0f04da593f6.png" data-original-src="https://miro.medium.com/v2/0*CWTNVcOwEI8y-Glm"/></div></figure><p id="a83f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然后在身份验证部分下面，选择文章部分。向下滚动下拉菜单至用户发表的文章。这是允许客户端代表经过身份验证的用户检索已发布文章列表的端点。</p><figure class="kt ku kv kw fd ij er es paragraph-image"><div class="ab fe cl kx"><img src="../Images/5ed35ba8a9ad6227bc36f1669eafa7b6.png" data-original-src="https://miro.medium.com/v2/0*urq1QXvIa2fDL-Cj"/></div></figure><p id="9989" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在页面的右侧，您可以看到可以向Dev.to API发出的请求示例。</p><p id="0bc9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在让我们在views.py文件上创建一个python视图函数，它向Dev.to API发出http请求，如下所示。</p><pre class="kt ku kv kw fd ky kz la lb aw lc bi"><span id="bd5e" class="ld jq hi kz b fi le lf l lg lh">from django.shortcuts import render<br/>import requests<br/>from .models import Article<br/><br/><br/>def get_articles(request):<br/>   all_articles = {}<br/><br/>   API_KEY = 'Your_API_KEY'<br/><br/>   url = 'https://dev.to/api/articles/me/published'<br/><br/>   headers = {'api-key': API_KEY}<br/><br/>   response = requests.get(url, headers=headers)<br/><br/>   data = response.json()<br/><br/>   for i, item in enumerate(data):<br/>       article_data = Article(<br/>           title=data[i]['title'],<br/>           description=data[i]['description'],<br/>           cover_image=data[i]['cover_image'],<br/>           article_body=data[i]['body_markdown'],<br/>           published_at=data[i]['published_at']<br/>       )<br/><br/>       article_data.save()<br/><br/>       all_articles = Article.objects.all().order_by(<br/>           '-published_at').distinct('published_at')<br/><br/>       return render(request, "blog.html", {"all_articles": all_articles})</span></pre><p id="332d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了显示文章的正文，我们需要创建另一个视图函数，通过id查询文章。</p><pre class="kt ku kv kw fd ky kz la lb aw lc bi"><span id="e64a" class="ld jq hi kz b fi le lf l lg lh">def blogBody(request, id):<br/>   article = Article.objects.get(id=id)<br/><br/>   return render(request, "blogBody.html", {"article": article})</span></pre><p id="8368" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您的views.py文件现在应该如下所示。</p><pre class="kt ku kv kw fd ky kz la lb aw lc bi"><span id="8343" class="ld jq hi kz b fi le lf l lg lh">from django.shortcuts import render<br/>import requests<br/>from .models import Article<br/><br/><br/>def get_articles(request):<br/>   all_articles = {}<br/><br/>   API_KEY = 'Your_API_KEY'<br/><br/>   url = 'https://dev.to/api/articles/me/published'<br/><br/>   headers = {'api-key': API_KEY}<br/><br/>   response = requests.get(url, headers=headers)<br/><br/>   data = response.json()<br/><br/>   for i, item in enumerate(data):<br/>       article_data = Article(<br/>           title=data[i]['title'],<br/>           description=data[i]['description'],<br/>           cover_image=data[i]['cover_image'],<br/>           article_body=data[i]['body_markdown'],<br/>           published_at=data[i]['published_at']<br/>       )<br/><br/>       article_data.save()<br/><br/>       all_articles = Article.objects.all().order_by(<br/>           '-published_at').distinct('published_at')<br/><br/>       return render(request, "blog.html", {"all_articles": all_articles})<br/><br/><br/>def blogBody(request, id):<br/>   article = Article.objects.get(id=id)<br/><br/>   return render(request, "blogBody.html", {"article": article})</span></pre><h1 id="99f5" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">Django URLs</h1><p id="b1fe" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">现在我们需要通过在posts文件夹中创建一个新的urls.py文件来配置项目的URL。urls.py文件现在应该如下所示。</p><pre class="kt ku kv kw fd ky kz la lb aw lc bi"><span id="8ca3" class="ld jq hi kz b fi le lf l lg lh">from django.urls import path<br/>from .views import blogBody<br/><br/><br/>urlpatterns = [<br/>   path("blog", blog, name="blog"),<br/>   path("article/&lt;int:id&gt;", blogBody, name="article"),<br/>]</span></pre><p id="3a26" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最后一步是更新Articles/urls.py文件—该文件应该如下所示。</p><pre class="kt ku kv kw fd ky kz la lb aw lc bi"><span id="3d89" class="ld jq hi kz b fi le lf l lg lh">from django.contrib import admin<br/>from django.urls import path, include<br/><br/>urlpatterns = [<br/>   path('admin/', admin.site.urls),<br/>   path("", include("posts.urls"))<br/>]</span></pre><h1 id="1478" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">Django模板</h1><p id="d3bc" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">创建一个名为<em class="ks">模板</em>的目录，然后像这样创建两个名为<em class="ks">blog.html</em>和<em class="ks">blogBody.html</em>的HTML文件。</p><pre class="kt ku kv kw fd ky kz la lb aw lc bi"><span id="3bf5" class="ld jq hi kz b fi le lf l lg lh">mkdir templates</span><span id="f6f4" class="ld jq hi kz b fi ll lf l lg lh">touch templates/blog.html</span><span id="12cb" class="ld jq hi kz b fi ll lf l lg lh">touch templates/blogBody.html</span></pre><p id="4200" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在让我们更新Articles/settings.py文件，告诉Django新模板目录的位置。这是对模板部分下的设置“DIRS”的一行更改，如下所示。</p><pre class="kt ku kv kw fd ky kz la lb aw lc bi"><span id="3574" class="ld jq hi kz b fi le lf l lg lh">TEMPLATES = [<br/>   {<br/>       'BACKEND': 'django.template.backends.django.DjangoTemplates',<br/>       'DIRS': [os.path.join(BASE_DIR, 'templates')], #new<br/>       'APP_DIRS': True,<br/>       'OPTIONS': {<br/>           'context_processors': [<br/>               'django.template.context_processors.debug',<br/>               'django.template.context_processors.request',<br/>               'django.contrib.auth.context_processors.auth',<br/>               'django.contrib.messages.context_processors.messages',<br/>           ],<br/>       },<br/>   },<br/>]</span></pre><p id="ade1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">不要忘记在<em class="ks"> settings.py </em>文件的顶部指定<em class="ks">导入操作系统</em>，否则会出现操作系统未定义的错误。您的templates/blog.html文件现在应该如下所示。</p><pre class="kt ku kv kw fd ky kz la lb aw lc bi"><span id="012b" class="ld jq hi kz b fi le lf l lg lh">{% for article in all_articles %}<br/>&lt;img src="" alt=""&gt;<br/>&lt;h4&gt;&lt;/h4&gt;<br/>&lt;p&gt;&lt;/p&gt;<br/>&lt;a href="{% url 'article' article.id %}"&gt;Read More...&lt;/a&gt;<br/>{% endfor %}</span></pre><p id="0bab" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">导航到<a class="ae jo" href="http://127.0.0.1:8000/blog" rel="noopener ugc nofollow" target="_blank"> 127.0.01:800/blog </a>，你应该会看到从Dev到的文章，如下所示。</p><figure class="kt ku kv kw fd ij er es paragraph-image"><div class="ab fe cl kx"><img src="../Images/969841834d948f2d2571ce85086c482c.png" data-original-src="https://miro.medium.com/v2/0*x4l6cxu_JFhMY1c4"/></div></figure><h1 id="1eda" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">文章正文</h1><p id="4b7d" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">当我们进行API调用时，文章主体被提取为<code class="du li lj lk kz b">article markdown</code>。减价是从API作为字符串接收的。这意味着它将看起来像你在DEV上输入的原始内容，而不是预览/发布的版本(即，带有所有的markdown语法，如#表示标题)。要将它显示在您的网站上，就像它出现在DEV To上一样，您需要添加一个额外的步骤来将字符串markdown转换为HTML。有很多markdown解析库可以帮你做到这一点，但是在这个项目中，我们将为Django使用一个名为<code class="du li lj lk kz b">Markdown</code>的markdown解析库。</p><p id="9630" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">要使用<code class="du li lj lk kz b">Markdown</code>,我们需要使用下面的命令将其安装到我们的项目中:</p><pre class="kt ku kv kw fd ky kz la lb aw lc bi"><span id="2571" class="ld jq hi kz b fi le lf l lg lh">pipenv install markdown</span></pre><p id="8ee2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们创建一个使用<code class="du li lj lk kz b">Markdown</code>的定制模板过滤器。在我们的帖子应用程序中创建一个<code class="du li lj lk kz b">templatetags</code>目录，然后创建一个<code class="du li lj lk kz b">markdown_extras.py</code>文件，如下所示。</p><pre class="kt ku kv kw fd ky kz la lb aw lc bi"><span id="9cec" class="ld jq hi kz b fi le lf l lg lh">mkdir posts/templatetags</span><span id="7344" class="ld jq hi kz b fi ll lf l lg lh">touch posts/templatetags/markdown_extras.py</span></pre><p id="3ccd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">文件本身将导入markdown包并使用fenced代码块扩展。</p><pre class="kt ku kv kw fd ky kz la lb aw lc bi"><span id="96a5" class="ld jq hi kz b fi le lf l lg lh"># posts/templatetags/markdown_extras.py<br/>from django import template<br/>from django.template.defaultfilters import stringfilter<br/><br/>import markdown as md<br/><br/>register = template.Library()<br/><br/><br/>@register.filter()<br/>@stringfilter<br/>def markdown(value):<br/>   return md.markdown(value, extensions=['markdown.extensions.fenced_code'])</span></pre><p id="093e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在让我们将自定义过滤器加载到模板中，这样用Markdown编写的内容将输出为HTML。我们的<code class="du li lj lk kz b">blogBody.html</code>文件现在应该是这样的:</p><pre class="kt ku kv kw fd ky kz la lb aw lc bi"><span id="fd04" class="ld jq hi kz b fi le lf l lg lh">{% load markdown_extras %}<br/><br/>&lt;h4&gt;&lt;/h4&gt;<br/>&lt;img src="" alt=""&gt;<br/>&lt;span&gt;{{article.published_at }}&lt;/span&gt;<br/>&lt;p&gt;&lt;/p&gt;</span></pre><p id="5c20" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">导航至<a class="ae jo" href="http://127.0.0.1:8000/blog" rel="noopener ugc nofollow" target="_blank"> 127.0.01:800/blog </a>并点击底部的阅读更多按钮。您应该被重定向到文章正文，如下所示。</p><figure class="kt ku kv kw fd ij er es paragraph-image"><div class="ab fe cl kx"><img src="../Images/c7f7f5235986dd1afb96d2030b3cac2f.png" data-original-src="https://miro.medium.com/v2/0*0iuXv4dUzdjpcPyn"/></div></figure><h1 id="68a0" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">使用Arctype SQL客户端查询Postgres数据</h1><p id="4fab" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">要查看PostgreSQL中存储的博客数据或与之交互，您可以使用SQL客户端和数据库管理工具，如<a class="ae jo" href="https://arctype.com" rel="noopener ugc nofollow" target="_blank"> Arctype </a>。要使用Arctype，请导航到Arctype主页并将Arctype应用程序下载到您的计算机上。目前，Arctype支持Linux、Windows和MacOS:</p><figure class="kt ku kv kw fd ij er es paragraph-image"><div class="ab fe cl kx"><img src="../Images/6691fa667d262ce7d93cffd946fcfbdf.png" data-original-src="https://miro.medium.com/v2/0*ioTMlqtDlCorTJfG"/></div></figure><p id="b038" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">安装好应用程序后，打开它，系统会提示您创建一个帐户，如下所示。</p><figure class="kt ku kv kw fd ij er es paragraph-image"><div class="ab fe cl kx"><img src="../Images/07f3755fe06811cabe44afabcc25eb1a.png" data-original-src="https://miro.medium.com/v2/0*CvXTY124-svWBEln"/></div></figure><p id="1fc5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">创建帐户后，系统会提示您选择数据库。在这种情况下，选择Postgres。</p><figure class="kt ku kv kw fd ij er es paragraph-image"><div class="ab fe cl kx"><img src="../Images/66828bef1a18346c9129d349da86f5a2.png" data-original-src="https://miro.medium.com/v2/0*KsxavSIygSo2cj5L"/></div><figcaption class="lm ln et er es lo lp bd b be z dx translated">Arctype中可用的数据库</figcaption></figure><p id="99ed" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下一步是添加Postgres凭据以将Arctype连接到Postgres数据库。使用在Postgres提示符下创建数据库时创建的凭据。</p><figure class="kt ku kv kw fd ij er es paragraph-image"><div class="ab fe cl kx"><img src="../Images/a6b2e459ebc4022961094f4f5fb3aff7.png" data-original-src="https://miro.medium.com/v2/0*A1kGp97z5KijFalx"/></div></figure><p id="6c39" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一旦数据库连接成功，您应该能够访问Postgres中的posts数据库中的表，如下所示。</p><figure class="kt ku kv kw fd ij er es paragraph-image"><div class="ab fe cl kx"><img src="../Images/760059116c3e8d2d15b0f68c685d88ed.png" data-original-src="https://miro.medium.com/v2/0*zGdbXzQ7RdVscUFA"/></div></figure><p id="02ec" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果您想了解如何在Arctype中创建和运行查询，<a class="ae jo" href="https://docs.arctype.com/getting-started/making-a-query" rel="noopener ugc nofollow" target="_blank">请查看本指南</a>。</p><h1 id="0791" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">结论</h1><p id="2e75" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">在本文中，您了解了如何在自己的网站上创建博客，而不必使用付费内容管理系统或从头开始创建。我已经向您展示了使用Django和Dev.to API在您的博客上成功显示Dev.to帖子的步骤。在这个博客<a class="ae jo" href="https://github.com/TheGreatBonnie/Blog" rel="noopener ugc nofollow" target="_blank">中提供的所有代码都可以在GitHub </a>上获得，如果你喜欢这篇文章，请确保在Arctype博客上逗留<a class="ae jo" href="https://arctype.com/blog/" rel="noopener ugc nofollow" target="_blank">以获得更多内容，直到下次。</a></p></div></div>    
</body>
</html>