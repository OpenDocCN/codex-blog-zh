<html>
<head>
<title>Improving our code readability with C# 9</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用C# 9提高我们的代码可读性</h1>
<blockquote>原文：<a href="https://medium.com/codex/improving-our-code-readability-with-c-9-18b5ce30f629?source=collection_archive---------3-----------------------#2022-10-17">https://medium.com/codex/improving-our-code-readability-with-c-9-18b5ce30f629?source=collection_archive---------3-----------------------#2022-10-17</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><blockquote class="if ig ih"><p id="c50e" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">在C# 9中，有一些新的语言特性使得我们的代码更加清晰易读。其中一个主要的是<code class="du jh ji jj jk b">Top-level statements.</code></p></blockquote><figure class="jm jn jo jp fd jq er es paragraph-image"><div class="er es jl"><img src="../Images/8abb282a653d53dc30ebfbb1e561333a.png" data-original-src="https://miro.medium.com/v2/resize:fit:918/format:webp/1*yM44jX7-kJXuWX16FK12aQ.png"/></div></figure><h2 id="3285" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">顶级语句:</h2><blockquote class="if ig ih"><p id="ce0f" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">该特性的主要目标是为了学习者和代码的清晰，允许C#程序周围没有不必要的样板文件。</p></blockquote><p id="1cd1" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ke iv iw ix ki iz ja jb km jd je jf jg hb bi translated">这是主程序的默认结构:</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kr ks l"/></div></figure><p id="6445" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ke iv iw ix ki iz ja jb km jd je jf jg hb bi translated">如果您仔细观察，您会发现只有一行代码将字符串“Hello World”打印到控制台。我们使用12行代码来执行一行。</p><p id="9106" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ke iv iw ix ki iz ja jb km jd je jf jg hb bi translated"><code class="du jh ji jj jk b">Top-level statements</code>使我们能够摆脱这些样板代码，直接执行我们的代码。样板代码包装仍然是必要的，但它是自动生成的，我们不必自己编写。我们的代码保持清晰。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kr ks l"/></div></figure><p id="d5f7" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ke iv iw ix ki iz ja jb km jd je jf jg hb bi translated"><code class="du jh ji jj jk b">Program</code>类的<code class="du jh ji jj jk b">Main</code>方法是程序的入口点，因此在我们的项目中只能有一个<code class="du jh ji jj jk b">Main</code>方法。同样的原则也适用于<code class="du jh ji jj jk b">top-level statements,</code>，在我们的项目中只能有一个带<code class="du jh ji jj jk b">top-level statements</code>的编译单元(类)。</p><p id="eef5" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ke iv iw ix ki iz ja jb km jd je jf jg hb bi translated">在C# 9中，我们可以为我们的应用程序创建一个更简单、更清晰的入口点。它适用于同步和异步代码。</p><p id="5266" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ke iv iw ix ki iz ja jb km jd je jf jg hb bi translated"><strong class="il hj">我们能传递论点吗？</strong>是的，如果您需要向应用程序入口点传递参数，您可以直接访问<code class="du jh ji jj jk b">string[] args</code>，如下所示:</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kr ks l"/></div></figure><h2 id="35ee" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">目标类型的新表达式</h2><p id="42bc" class="pw-post-body-paragraph ii ij hi il b im kt io ip iq ku is it ke kv iw ix ki kw ja jb km kx je jf jg hb bi translated">当类型已知时，这个特性允许我们避免为构造函数指定类型。这个特性的动机是允许字段初始化而不复制类型，这使得我们的代码干净。</p><p id="4ef7" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ke iv iw ix ki iz ja jb km jd je jf jg hb bi translated">正如我们在下面的例子(第7行)中看到的，它适用于更复杂的构造函数。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kr ks l"/></div></figure><p id="b545" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ke iv iw ix ki iz ja jb km jd je jf jg hb bi translated">你可能会问，<strong class="il hj">这个特性和使用</strong> <code class="du jh ji jj jk b"><strong class="il hj">var</strong></code> <strong class="il hj">数据类型的选项有什么不同？显然，它给了我们相同的解决方案(正如你在第5行看到的)。</strong></p><p id="6e7e" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ke iv iw ix ki iz ja jb km jd je jf jg hb bi translated"><code class="du jh ji jj jk b">Var</code>关键字只对局部变量有效。这意味着目标类型的<code class="du jh ji jj jk b">new</code>表达式在初始化属性和字段(第9，22行)时特别强大，因为在那里<code class="du jh ji jj jk b">var</code>关键字不是一个选项。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kr ks l"/></div><figcaption class="ky kz et er es la lb bd b be z dx translated">目标类型的<code class="du jh ji jj jk b">new</code>表达式与var</figcaption></figure><h2 id="2bfe" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">模式匹配</h2><blockquote class="if ig ih"><p id="8ced" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated"><a class="ae lc" href="https://learn.microsoft.com/en-us/dotnet/csharp/fundamentals/functional/pattern-matching" rel="noopener ugc nofollow" target="_blank"> <em class="hi">模式匹配</em> </a>是一种测试表达式以确定其是否具有某些特征的技术。C#模式匹配为测试表达式和在表达式匹配时采取行动提供了更简洁的语法。</p></blockquote><p id="c24a" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ke iv iw ix ki iz ja jb km jd je jf jg hb bi translated">模式匹配在早期版本的C#中就存在，其中之一就是<code class="du jh ji jj jk b">is</code>模式表达式。</p><p id="412a" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ke iv iw ix ki iz ja jb km jd je jf jg hb bi translated"><strong class="il hj">关系模式</strong></p><p id="85e4" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ke iv iw ix ki iz ja jb km jd je jf jg hb bi translated">在关系模式中，您可以使用任何一个<a class="ae lc" href="https://learn.microsoft.com/en-us/dotnet/csharp/language-reference/operators/comparison-operators" rel="noopener ugc nofollow" target="_blank">关系操作符</a> <code class="du jh ji jj jk b">&lt;</code>、<code class="du jh ji jj jk b">&gt;</code>、<code class="du jh ji jj jk b">&lt;=</code>或<code class="du jh ji jj jk b">&gt;=</code>来测试一个值与常量相比如何。您不仅可以在<code class="du jh ji jj jk b">is</code>表达式中使用它们，也可以在<code class="du jh ji jj jk b">switch</code>表达式中使用它们。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kr ks l"/></div></figure><p id="5a2b" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ke iv iw ix ki iz ja jb km jd je jf jg hb bi translated">如果没有r<em class="ik">relational patterns，</em>我们将不得不使用多个if-else语句，这使得我们的代码不够优雅，也更加复杂。</p><p id="219b" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ke iv iw ix ki iz ja jb km jd je jf jg hb bi translated">如果您仔细看前面的例子，您会发现我们使用了另一个新功能:</p><p id="76d9" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ke iv iw ix ki iz ja jb km jd je jf jg hb bi translated"><strong class="il hj">逻辑模式</strong></p><blockquote class="if ig ih"><p id="8d5b" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">从C# 9.0开始，使用<code class="du jh ji jj jk b">not</code>、<code class="du jh ji jj jk b">and</code>和<code class="du jh ji jj jk b">or</code>模式组合子</p></blockquote><p id="ca04" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ke iv iw ix ki iz ja jb km jd je jf jg hb bi translated">在以下示例中，您可以看到使用此模式来检查<em class="ik">产品</em>是否不为空，并检查其价格是否在某个范围内:</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kr ks l"/></div></figure><p id="2a7a" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ke iv iw ix ki iz ja jb km jd je jf jg hb bi translated">正如你所看到的，在C# 9新特性之后，我们的代码看起来可读性更好了。</p></div></div>    
</body>
</html>