# iOS 访谈:Struct vs Class[性能指标——哪个更快]

> 原文：<https://medium.com/codex/ios-interview-struct-vs-class-performance-metrics-which-one-is-faster-574bf3c8d9d4?source=collection_archive---------1----------------------->

我们经常会看到一个争论或者一个 iOS 面试问题，问结构和类的区别，什么时候我们应该使用结构，什么时候我们应该使用类。

![](img/1d1b4842587bc1332fed5611db6bd5f1.png)

# **基本面:**

> 在 Swift 中，类是引用类型，而结构是值类型。这意味着当你把一个类的实例传递给一个函数或者把它赋给一个常量或变量时，你传递的是对对象的引用，而不是对象本身。另一方面，当您将结构的实例传递给函数或将它赋给常数或变量时，您传递的是对象的副本。

# 以下是 Swift 中类和结构的一些主要区别:

> 1.继承:类可以从其他类继承，而结构不能。这意味着一个类可以是另一个类的子类，并且可以从它的超类继承属性和方法。另一方面，结构不能有超类，也不能有子类。
> 
> 2.内存管理:类使用引用计数进行内存管理，而结构不使用。这意味着当你创建一个类的实例时，它被存储在堆中，对它的引用被存储在栈中。当不再有对该对象的引用时，就从堆中释放它。另一方面，结构是通过值来存储和传递的，所以当它们被赋给常量或变量或传递给函数时，总是被复制。
> 
> 3.可变性:类可以是可变的或不可变的，而结构总是可变的。这意味着您可以在创建类实例后更改它的属性，而结构的属性一旦创建就不能更改。

# **什么时候用 Class，什么时候用 struct？**

在 swift 中，我们有两种类型的对象，一种是值类型，另一种是引用类型。如上所述，类是引用类型，结构是值类型，除此之外，我们还有值类型的枚举。

应用程序性能还取决于值类型和引用类型对象的使用，因为当我们创建一个类或结构并编写任何方法时，就会编译代码并使用见证表跟踪方法，这样我们就可以访问这些方法编译器，直接转到见证表并执行该方法。这个过程叫调度【调度队列不一样】。有三种类型的派遣:

1-静态分派(也称为直接分派)

2-动态分派(也称为表分派)

3-消息发送

所以每当你从一个结构调用一个函数时，编译器会直接转到那个方法，因为一个**结构**是一个值类型，编译器知道那个实例只有一个值，这个调度叫做**静态调度**，这是最快的一个。

但是，当从引用类型的实例调用函数时，编译器会生成一个函数指针数组(见证表)。当一个函数被调用时，在运行时在见证表中搜索它的地址，然后调用发生。这是因为我们可以在引用类型中执行继承。编译器需要一些时间来执行确切的方法，方法是从见证表中找到它的引用。

因此，我们可以得出结论，struct 比类更快更有效，但是我们可以通过调整一些关键字，如 Final 和 private，使我们的类使用静态调度。

# 在类和结构之间进行选择时，需要记住以下一些额外的注意事项:

> 性能:结构通常比类更快，使用的内存更少，因为它们是通过值而不是通过引用来存储和传递的。如果您正在处理大型数据结构，或者如果您需要优化应用程序的性能，这可能非常重要。
> 
> 可变性:结构总是可变的，而类可以是可变的或不可变的。如果你需要一个不可变的对象，你应该使用一个类，并将其属性标记为`let`。
> 
> 写入时复制:结构使用写入时复制优化，这意味着它们只在被修改时才被复制。如果您有一个很大的数据结构想要传递，但是除非您需要修改它，否则您不想支付复制它的成本，这可能很有用。
> 
> 引用周期:类可以创建引用周期，如果管理不当，会导致内存泄漏。结构没有这个问题，因为它们在传递时总是被复制。

***如果您喜欢这个，点击💚尽你所能在下面为这篇文章鼓掌，这样其他人会在媒体上看到。也请在 Linkedin 和 Twitter 上与你的朋友和同事分享。如有任何疑问或建议，欢迎随时评论或打我***[***Twitter***](https://twitter.com/b_banzara)***，或***[***Linkedin***](https://www.linkedin.com/in/rranjanchchn/)***。***