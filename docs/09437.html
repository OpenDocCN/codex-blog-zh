<html>
<head>
<title>How to export varbinary record fields from MS SQL Server to file</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何将varbinary记录字段从MS SQL Server导出到文件</h1>
<blockquote>原文：<a href="https://medium.com/codex/how-to-export-varbinary-record-fields-from-ms-sql-server-to-file-ed1e6414b810?source=collection_archive---------6-----------------------#2022-10-20">https://medium.com/codex/how-to-export-varbinary-record-fields-from-ms-sql-server-to-file-ed1e6414b810?source=collection_archive---------6-----------------------#2022-10-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="48b6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">示例SQL脚本和注意事项。</p><p id="d5b3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面嵌入的T-SQL，由yours truly编写，<a class="ae jd" href="https://gist.github.com/aev-mambro2/ca8fb742b3544c1cef33bfbb8f70fbb3" rel="noopener ugc nofollow" target="_blank">通过GitHub </a>分享:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="jj jk l"/></div></figure><p id="1bbe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi jl translated">我们使用的应用程序中没有一个是由第三方构建的。我们可以访问数据存储，但不应该改变它的结构或过程。它的众多功能之一是存储文档和一些元数据。我们需要导出这些文档，以便在其他地方查看。上面的T-SQL过程允许。它可以在数据库版本12 (2014)的Microsoft SQL Server上运行。</p><blockquote class="ju"><p id="7f11" class="jv jw hi bd jx jy jz ka kb kc kd jc dx translated">主要问题是写入映射驱动器。</p></blockquote><p id="dd14" class="pw-post-body-paragraph if ig hi ih b ii ke ik il im kf io ip iq kg is it iu kh iw ix iy ki ja jb jc hb bi translated">procedure runner是SQL Server计算机上的本地服务帐户或网络服务帐户，这意味着它确实会看到与您登录的帐户相同的映射驱动器。因此，将文档导出到的驱动器必须连接到计算机。</p><blockquote class="ju"><p id="8bd9" class="jv jw hi bd jx jy jz ka kb kc kd jc dx translated">它们必须显示在计算机的磁盘管理中(在计算机管理面板内)。</p></blockquote><p id="ddb3" class="pw-post-body-paragraph if ig hi ih b ii ke ik il im kf io ip iq kg is it iu kh iw ix iy ki ja jb jc hb bi translated">否则，您必须想办法提前为过程运行器映射驱动器。</p><h1 id="3dd9" class="kj kk hi bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">其他问题:</h1><ul class=""><li id="06c0" class="lh li hi ih b ii lj im lk iq ll iu lm iy ln jc lo lp lq lr bi translated">因为我们调用的是OLE对象，所以很难看到处理过程和错误。这导致了偏执的错误处理，并在退出之前对可能发生的错误数量进行了限制。没有上限，我们就耗尽了内存，并迫使SQL Management Studio暂停并重新启动。</li><li id="d29c" class="lh li hi ih b ii ls im lt iq lu iu lv iy lw jc lo lp lq lr bi translated">检索错误信息时应该小心，将它捕获到变量中，然后显示出来。相反，如果我们让错误检索立即写入控制台/屏幕，我们就会耗尽内存。</li><li id="678f" class="lh li hi ih b ii ls im lt iq lu iu lv iy lw jc lo lp lq lr bi translated">尽管有print语句，但在过程执行完毕之前，打印不会发生。这导致服务器上的内存使用增加，但也延迟了对可能发生的任何错误的可见性。在错误计数达到阈值时停止循环增加了可见性，但是最好是立即输出不会导致内存问题的结果。</li></ul><p id="f8b3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让软件变得更好！</p><h1 id="8b20" class="kj kk hi bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">关于作者</h1><p id="43f4" class="pw-post-body-paragraph if ig hi ih b ii lj ik il im lk io ip iq lx is it iu ly iw ix iy lz ja jb jc hb bi translated">Veltstra作为软件架构师和开发人员已经专业工作了20多年。Veltstra在大学里学习了ETL和SQL，对优化运行持续时间、错误可见性、可测试性和各种数据存储中的数据锁定问题产生了浓厚的兴趣，包括SQLServer和Oracle数据库。总会有办法的——有时这种办法很难。</p></div></div>    
</body>
</html>