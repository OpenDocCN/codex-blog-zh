<html>
<head>
<title>💪Creating an Azure Machine Learning Workspace and Datastores using Bicep</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">💪使用Bicep创建Azure机器学习工作区和数据存储</h1>
<blockquote>原文：<a href="https://medium.com/codex/creating-an-azure-machine-learning-workspace-and-datastores-using-bicep-eda683a8579f?source=collection_archive---------0-----------------------#2021-10-12">https://medium.com/codex/creating-an-azure-machine-learning-workspace-and-datastores-using-bicep-eda683a8579f?source=collection_archive---------0-----------------------#2021-10-12</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="1bb2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">通过Azure Bicep使用基础设施即代码在Azure中快速部署机器学习解决方案。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/5e74d007f11883d7421574ea16f96294.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bYMmSNq6wIs_A8ZJocWeYw.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">使用Bicep创建Azure机器学习工作区和数据存储</figcaption></figure></div><div class="ab cl jt ju gp jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="hb hc hd he hf"><p id="03d8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你在Azure中利用机器学习作为云服务来加速和管理机器学习项目的生命周期。</p><p id="ec5f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在之前的文章中，我提到了Azure机器学习服务的核心组件:</p><ul class=""><li id="cf6a" class="ka kb hi ih b ii ij im in iq kc iu kd iy ke jc kf kg kh ki bi translated"><strong class="ih hj">工作区</strong>:这是核心组件。查看如何创建Azure机器学习<a class="ae kj" rel="noopener" href="/codex/using-bicep-to-create-workspace-resources-and-get-started-with-azure-machine-learning-bcc57fd4fd09?source=user_profile---------2----------------------------">工作空间</a>。</li><li id="f250" class="ka kb hi ih b ii kk im kl iq km iu kn iy ko jc kf kg kh ki bi translated"><strong class="ih hj">托管资源</strong>:这些是Azure机器学习<a class="ae kj" rel="noopener" href="/codex/create-an-azure-machine-learning-compute-instance-using-azure-bicep-491783578656?source=user_profile---------1----------------------------">计算节点</a>用于你的开发环境。<a class="ae kj" rel="noopener" href="/codex/create-an-azure-machine-learning-compute-cluster-using-azure-bicep-dd43f367f36a?source=user_profile---------0----------------------------">计算集群</a>用于提交训练运行。</li><li id="ed04" class="ka kb hi ih b ii kk im kl iq km iu kn iy ko jc kf kg kh ki bi translated"><strong class="ih hj">链接服务</strong>:包括<strong class="ih hj">数据存储</strong>和计算目标。</li><li id="9161" class="ka kb hi ih b ii kk im kl iq km iu kn iy ko jc kf kg kh ki bi translated"><strong class="ih hj">资产</strong>:这可以是环境、实验、管道、<strong class="ih hj">数据集</strong>、模型和/或端点。</li><li id="8e04" class="ka kb hi ih b ii kk im kl iq km iu kn iy ko jc kf kg kh ki bi translated"><strong class="ih hj">依赖关系</strong>:这些是正确执行AML工作区所需的资源。</li></ul><p id="f6fd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下图代表了Azure机器学习架构:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kp"><img src="../Images/c6d7dc71f4bb13751a3c430246c2bf42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*jD1i_xvsQkdenPyl.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">Azure机器学习架构</figcaption></figure><p id="c33a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">本文将使用Azure Bicep，一种用于以声明方式部署Azure资源的新DSL语言，来提供一个具有多个数据存储的Azure机器学习工作区。</p><p id="801b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，我们来看两个基本概念。AzureML提供了两种处理数据的基本资产:</p><ul class=""><li id="ab2d" class="ka kb hi ih b ii ij im in iq kc iu kd iy ke jc kf kg kh ki bi translated"><em class="kq">数据存储库</em></li><li id="e399" class="ka kb hi ih b ii kk im kl iq km iu kn iy ko jc kf kg kh ki bi translated"><em class="kq">数据集</em></li></ul><h1 id="6581" class="kr ks hi bd kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo bi translated">Azure机器学习中的数据存储是什么？</h1><p id="276b" class="pw-post-body-paragraph if ig hi ih b ii lp ik il im lq io ip iq lr is it iu ls iw ix iy lt ja jb jc hb bi translated">可以把数据存储想象成实际存储资源到Azure机器学习工作空间的映射。</p><p id="bb31" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据存储为您的Azure机器学习存储帐户提供了一个接口。</p><h1 id="c12d" class="kr ks hi bd kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo bi translated">Azure机器学习中的数据集是什么？</h1><p id="9698" class="pw-post-body-paragraph if ig hi ih b ii lp ik il im lq io ip iq lr is it iu ls iw ix iy lt ja jb jc hb bi translated"><em class="kq">数据集</em>是机器学习工作空间中的一项资产，它将帮助您连接到数据和存储服务，并使数据可用于您的机器学习实验。</p><p id="b868" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当您在Azure Machine Learning中创建数据集时，您正在创建对您的存储服务中的数据的引用。Azure没有复制你的数据。</p><p id="cba9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这意味着在创建数据集时不会产生存储成本。将<em class="kq">数据集</em>视为存储在存储资源上的其他数据的指针。</p><p id="2b4c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可以使用数据集来简化整个团队对数据的访问，而不是直接指向您的存储资源。您只需注册一次数据，然后就可以在不同的实验中重复使用它。</p><p id="8b81" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据集的另一个好处是能够将它们用作脚本或管道的直接输入，并帮助您检查数据的使用位置。</p><p id="4760" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">可以使用Azure Machine Learning Studio门户的数据集选项创建数据集，并从本地文件、数据存储、数据库或打开的数据集创建数据集，如下图所示:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lu"><img src="../Images/e0928de30fd1d57ab66e744b08785f14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1346/format:webp/1*DT_-c0H8q3hRL7qywEtC_g.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">Azure机器学习工作室-数据集</figcaption></figure><p id="3088" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请注意，我们必须先创建一个工作区，然后才能与Azure Machine Learning Studio门户进行交互。</p><p id="047e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们已经了解了基础知识，我们将使用Bicep模板，使用基础架构代码来简化创建带有数据存储和数据集的Azure机器学习工作区的过程。</p><p id="0bd9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Bicep是用于声明式部署Azure资源的新DSL语言。在之前的<a class="ae kj" href="https://blog.azinsider.net/why-is-azure-bicep-your-next-choice-for-infrastructure-as-code-f10a2b924ca7" rel="noopener ugc nofollow" target="_blank">文章中，</a>我们讨论了Bicep对于Azure的基础设施即代码的重要性，以及它将如何影响你在Azure中的环境。</p><h2 id="3298" class="lv ks hi bd kt lw lx ly kx lz ma mb lb iq mc md lf iu me mf lj iy mg mh ln mi bi translated">先决条件:</h2><ul class=""><li id="3c24" class="ka kb hi ih b ii lp im lq iq mj iu mk iy ml jc kf kg kh ki bi translated">在你的本地机器上安装Bicep</li><li id="e263" class="ka kb hi ih b ii kk im kl iq km iu kn iy ko jc kf kg kh ki bi translated">安装在本地计算机上的Azure PowerShell或Azure CLI</li><li id="14f2" class="ka kb hi ih b ii kk im kl iq km iu kn iy ko jc kf kg kh ki bi translated">有效的Azure订阅</li><li id="cf8e" class="ka kb hi ih b ii kk im kl iq km iu kn iy ko jc kf kg kh ki bi translated">资源组</li><li id="25f4" class="ka kb hi ih b ii kk im kl iq km iu kn iy ko jc kf kg kh ki bi translated">在Azure订阅中启用了所有者/参与者角色的用户</li></ul><p id="384c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将使用下面的Bicep文件创建一个新的Azure机器学习工作区，其中包含多个数据存储:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="mm mn l"/></div></figure><p id="bb96" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们将传递几个参数来使用一个单独的参数文件。</p><p id="fceb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">参数文件将如下所示:</p><pre class="je jf jg jh fd mo mp mq mr aw ms bi"><span id="a09d" class="lv ks hi mp b fi mt mu l mv mw">{<br/> "$schema": "<a class="ae kj" href="https://schema.management.azure.com/schemas/2019-04-01/deploymentParameters.json#" rel="noopener ugc nofollow" target="_blank">https://schema.management.azure.com/schemas/2019-04-01/deploymentParameters.json#</a>",<br/> "contentVersion": "1.0.0.0",<br/> "parameters": {<br/>  "workspaceName": {<br/>   "value": "azinsiderj"<br/>  },<br/>  "location": {<br/>   "value": "eastus"<br/>  }<br/> }<br/>}</span></pre><p id="b343" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">注意，我们只传递新工作区的名称和位置。然后，我们将使用以下代码将Bicep文件部署到Azure订阅中的资源组:</p><pre class="je jf jg jh fd mo mp mq mr aw ms bi"><span id="be64" class="lv ks hi mp b fi mt mu l mv mw">$date = Get-Date -Format "MM-dd-yyyy"<br/>$deploymentName = "AzInsiderDeployment"+"$date"</span><span id="0f0f" class="lv ks hi mp b fi mx mu l mv mw">New-AzResourceGroupDeployment -Name $deploymentName -ResourceGroupName AzInsiderML -TemplateFile .\azuredeploy.json -TemplateParameterFile .\azuredeploy.parameters.json -c</span></pre><p id="7eaf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">验证完成后，我们将执行部署。</p><p id="d37d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下图显示了部署的预览:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es my"><img src="../Images/0739d064f6f99849fedc59c81d318746.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5mULEjGoKgh8QLm5_Y3RGg.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">部署预览</figcaption></figure><p id="85bf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下图显示了部署输出。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mz"><img src="../Images/be108a7c162bdd63bc76401438a10fc5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6btXbJ1lCYOFl3wJMH4skQ.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">部署输出</figcaption></figure><p id="0d6a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">几分钟后，我们的Azure机器工作区和数据存储就准备好了。</p><p id="fa64" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以访问机器学习工作室门户，然后从web文件创建我们的数据存储。你可以去Azure门户，从我们刚刚部署的机器学习服务，启动Studio门户:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es na"><img src="../Images/16b42f5d644c212d981e808faba4f5e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*drGM_tTc7sujc5nHmIsW9w.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">Azure门户—资源组</figcaption></figure><p id="1f29" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这将把你重定向到Azure机器学习工作室门户。</p><p id="c862" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">进入Studio门户后，您可以转到Datastores选项，您将看到最近使用Bicep文件创建的数据存储:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es nb"><img src="../Images/63e1b0a20e4959c6e7fcbe81ed91a65d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jOmR5qleZc_J7n3UktqiXQ.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">Azure机器学习工作室-数据存储</figcaption></figure><p id="fe5d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">之后，您可以使用Bicep或Azure Machine Learning Studio门户创建附加的数据存储或新的数据集。</p><p id="6f94" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">希望这能让你更好地理解在使用Azure机器学习时，如何利用Bicep来自动创建所需的资源。</p><p id="d36f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae kj" href="http://eepurl.com/gKmLdf" rel="noopener ugc nofollow" target="_blank"> <em class="kq">在此加入</em><strong class="ih hj"><em class="kq">azin sider</em></strong><em class="kq">邮箱列表。</em>T9】</a></p><p id="af0d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="kq">-戴夫·r·</em></p></div></div>    
</body>
</html>