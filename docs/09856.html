<html>
<head>
<title>Pyspark: Setup on Windows and run your first pyspark program</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Pyspark:在Windows上安装并运行您的第一个pyspark程序</h1>
<blockquote>原文：<a href="https://medium.com/codex/pyspark-setup-on-windows-and-run-your-first-pyspark-program-7ce7c2833338?source=collection_archive---------4-----------------------#2022-11-14">https://medium.com/codex/pyspark-setup-on-windows-and-run-your-first-pyspark-program-7ce7c2833338?source=collection_archive---------4-----------------------#2022-11-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/339f44ca5417c5dba3735c75e7860b81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9A36RPGqsCvCvdTd"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">Jez Timms 在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="5cf0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Apache Spark是一个广泛用于处理和使用大数据和数据工程项目的框架。<strong class="ix hj"> Python </strong>是一种用于数据分析、数据工程等等的编程语言。大多数数据专业人员都熟悉Python，并在工作流中使用它。PySpark允许他们使用自己熟悉的语言工作，而不需要学习另一种语言的语法。</p><p id="4557" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">PySpark是Python中Apache Spark的接口。使用PySpark，您可以编写类似Python的命令来操作和分析数据。它的发布是为了支持Apache Spark和Python之间的协作。如果您熟悉python的用法，那么使用pyspark就不会那么困难了。</p><h1 id="c888" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">在Windows上安装Pyspark</h1><p id="6b49" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">必备软件</p><p id="f07e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Python 3</p><p id="9d16" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Java 17</p><p id="7f58" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Winutils</p><p id="14f7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">7-zip</p><p id="098c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> Python </strong></p><p id="9453" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><a class="ae iu" href="https://www.python.org/downloads/windows/" rel="noopener ugc nofollow" target="_blank">在这里下载python</a>。下载版本至少高于3.7</p><p id="3ba8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在安装过程中，记得点击将python添加到path的选项。</p><p id="dbd7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">下载和安装后，检查python是否安装成功。</p><p id="625a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">打开命令提示符并输入python。您应该会得到下面的输出</p><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kw"><img src="../Images/51a62ff7f5acccd915118d701b6dbd1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QUo3PWh4dHiDGRmiMg4deA.png"/></div></div></figure><h1 id="7755" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated"><strong class="ak"> Java </strong>:</h1><p id="5f87" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">Apache Spark对Java有依赖性。下载Java 17 x64安装程序并运行其安装</p><p id="cac6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><a class="ae iu" href="https://www.oracle.com/java/technologies/downloads/#java17" rel="noopener ugc nofollow" target="_blank"> Java 17这里</a></p><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lb"><img src="../Images/f5e3190fe15f2a9d938fefe88a218e98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*irzZPaBK4whULnrxtLfWpw.png"/></div></div></figure><h1 id="2c27" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">Winutils</h1><p id="e5d4" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">要在本地运行Apache Spark，需要winutils。<a class="ae iu" href="https://github.com/cdarlint/winutils/tree/master/hadoop-3.2.2/bin" rel="noopener ugc nofollow" target="_blank">在此下载</a></p><h1 id="b040" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">7-zip</h1><p id="c532" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated"><a class="ae iu" href="https://www.7-zip.org/download.html" rel="noopener ugc nofollow" target="_blank">在此下载</a></p><p id="0bca" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Spark以GZIP档案文件的形式压缩而来。tgz)文件。默认情况下，windows<br/>并没有提供一种本地方式来提取这种文件。一个流行的解压选项是7-zip。访问网站，下载软件，并按照<br/>安装指南操作</p><h1 id="4c3a" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">阿帕奇火花</h1><p id="7dd8" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">点击访问他们的网站<a class="ae iu" href="https://spark.apache.org/downloads.html" rel="noopener ugc nofollow" target="_blank">并下载。</a></p><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lc"><img src="../Images/88434188f56c9f46874b8b4b3ea848d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sMp6vcO4woj2IZpnMHex6g.png"/></div></div></figure><p id="5125" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">下载完成后，解压文件并将文件夹移动到C:\驱动器目录。我的是这样放的。<strong class="ix hj">C:\ spark-3 . 3 . 1-bin-Hadoop 3</strong></p><p id="f683" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">注意:您可能需要解压文件两次</p><p id="19f5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">将下载的winutils.exe文件移动到spark的bin目录中。</p><p id="142f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这里是我的<strong class="ix hj">C:\ spark-3 . 3 . 1-bin-Hadoop 3 \ bin</strong></p><p id="2d8a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">一旦完成了以上工作，接下来就是设置环境变量了</p><h1 id="b373" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">设置环境变量</h1><p id="72c3" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">单击Windows按钮，在搜索栏中键入env，并从显示的可用选项中单击“编辑您帐户的环境变量”。</p><figure class="kx ky kz la fd ij er es paragraph-image"><div class="er es ld"><img src="../Images/adde8c4cde31d0d7400875ecb7d77b3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*JWl8VfXAi3N-3AooYauMcg.png"/></div></figure><p id="460f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">单击new，并设置以下环境变量。</p><figure class="kx ky kz la fd ij er es paragraph-image"><div class="er es le"><img src="../Images/f40b806983d0cfc96871a868da755ef5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1306/format:webp/1*cJtpfEy4BEltzhoHcfFuVQ.png"/></div></figure><figure class="kx ky kz la fd ij er es paragraph-image"><div class="er es lf"><img src="../Images/aefc6d2156b43d69790ba8025a9bf0a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1312/format:webp/1*VmxlvnBqaK9m1GLdTXeh8g.png"/></div></figure><figure class="kx ky kz la fd ij er es paragraph-image"><div class="er es lg"><img src="../Images/8b65b14f950c82004236de1ee545ce5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1298/format:webp/1*AS9BgIABNBOMgum0lA0wSw.png"/></div></figure><p id="766a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">转到您移动winutils软件的spark文件夹路径。这里是我的:<strong class="ix hj">C:\ spark-3 . 3 . 1-bin-Hadoop 3 \ bin。</strong>复制这条路径。</p><p id="a97c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在系统变量下，单击路径，然后单击编辑。点击新建，粘贴你复制的路径。单击确定三次。</p><figure class="kx ky kz la fd ij er es paragraph-image"><div class="er es lh"><img src="../Images/35e282de1210fa36fe0833bf310e7450.png" data-original-src="https://miro.medium.com/v2/resize:fit:1188/format:webp/1*eVCJavdgxdAAeQdGXvlJRQ.png"/></div></figure><p id="308f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">按照windows的一贯要求，您可能需要重新启动计算机，环境变量才能生效。</p><h1 id="1fb4" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">测试PySpark</h1><p id="469a" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">一旦一切都设置好了，启动命令提示符并键入pyspark。如果在安装过程中一切正常，您将看到下面的输出。</p><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es li"><img src="../Images/8ae72137b2012a061cdf9dd20da1ee81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AgljMRXuvJyfukgFWA6puA.png"/></div></div></figure><p id="4e8f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">酷毙了。PySpark现已启动并运行。访问<a class="ae iu" href="http://localhost:4040" rel="noopener ugc nofollow" target="_blank"> http://localhost:4040 </a>查看pyspark运行情况。</p><p id="2dfa" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">注意:确保pyspark仍然在命令提示符下运行</p><h1 id="54ec" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">在jupyter笔记本上运行pyspark</h1><p id="d024" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">要用pyspark写一些代码，我们需要启动jupyter notebook。</p><p id="8992" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">首先，安装jupyter笔记本</p><pre class="kx ky kz la fd lj lk ll bn lm ln bi"><span id="d217" class="lo ju hi lk b be lp lq l lr ls">pip install jupyter</span></pre><p id="c503" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了让jupyter与pyspark一起正常工作，我们需要安装另一个名为findspark的库。</p><p id="c0a1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">它使得pyspark可以作为常规库导入。<a class="ae iu" href="https://pypi.org/project/findspark/" rel="noopener ugc nofollow" target="_blank">文档</a></p><pre class="kx ky kz la fd lj lk ll bn lm ln bi"><span id="8bf4" class="lo ju hi lk b be lp lq l lt ls">pip install findspark</span></pre><p id="f35f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在命令提示符下，键入jupyter notebook。笔记本的一个实例应该已经启动并正在运行。</p><p id="1345" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">导入下面的库，并从您的jupyter笔记本上观看pyspark的神奇之处</p><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lu"><img src="../Images/9a74a9653ea021c48f60d54644316940.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SemFmulG9u5koVHEETDp_A.png"/></div></div></figure><p id="7424" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在我们可以使用jupyter和pyspark，导入我们的数据集，并做一些令人惊讶的事情。</p><p id="d156" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果你到了这里，恭喜你。一切都应该运行良好，您应该准备好开始处理大数据了，在您的机器上本地安装pyspark。</p><p id="dbb7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在本指南中，我们介绍了如何在本地机器上安装pyspark，使其工作所需的依赖项，以及如何在jupyter notebook上启动pyspark。</p></div></div>    
</body>
</html>