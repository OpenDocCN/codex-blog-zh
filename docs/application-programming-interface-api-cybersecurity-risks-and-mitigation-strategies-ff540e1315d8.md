# 应用程序接口:网络安全风险和缓解策略

> 原文：<https://medium.com/codex/application-programming-interface-api-cybersecurity-risks-and-mitigation-strategies-ff540e1315d8?source=collection_archive---------8----------------------->

[最初发表于 cyberbakery.net](https://cyberbakery.net/api_security/)

在全球范围内，企业通过采用新的经营方式和快速高效地向市场交付产品，充分利用了业务转型带来的好处。数字化转型为这一努力做出了独特贡献。组织使用现代高效的应用程序来交付上述业务成果。幕后的 API 是帮助 web 和移动应用程序交付创新产品和服务的最关键的组件。

API 是一个可以直接访问上游或下游应用程序的软件，在某些情况下，还可以直接访问数据。下图描述了一个 web 应用程序调用 API 的典型场景，API 调用下游资源和数据。不幸的是，由于 API 的性质，对数据的直接访问引入了一种称为“API 违规”的新攻击面，这种攻击面正在不断增加，导致假冒、数据窃取和金融欺诈。

![](img/cbe574f52eb6a148d56c384459a0b1eb.png)

据 [Gartner、](https://www.gartner.com/en/documents/3956746/api-security-what-you-need-to-do-to-protect-your-apis)称，到 2022 年，API 漏洞的前景将从不常发生的漏洞变成最频繁的攻击媒介，这将导致企业 web 应用程序频繁丢失数据。这种不断变化的趋势使人们意识到，需要采取一些措施来保护 API 和数字接口级别的数据。

![](img/a9bad156fcce523dac35a652dcef4821.png)

# API 违规示例

API 违规有许多因素，其中一个常见问题是应用程序生态系统中用于非人类交互的广泛权限。更严格的用户访问控制确保只有授权用户才能访问应用程序。一旦用户通过身份验证，API 就可以频繁地访问任何数据。所有这些都已经说过和做过了，但是当一个坏的参与者绕过用户认证从下游系统访问数据时，问题就开始了。

![](img/0c2f843f8c6f439f4cf23ababd05bfa3.png)

上图显示了用户使用 API 访问移动应用程序，而桌面用户通过 web 接口连接相同的 API 访问相同的后端。移动 API 调用包括 URIs、方法、头和其他参数，就像基本的 web 请求一样。因此，API 调用暴露于类似的 web 攻击，如注入、凭证暴力、参数篡改和会话窥探。黑客可以采用与传统 web 应用相同的策略，如暴力或注入攻击，来破坏移动 API。保护移动应用本来就很困难。因此，攻击者不断对移动应用程序进行反编译和逆向工程，以寻找漏洞或发现硬编码凭证或弱访问控制方法的机会。

# API 安全威胁

[OWASP.ORG](https://owasp.org/)，2019 年发布了一份十大 API 安全威胁清单，就缓解 API 独特的安全挑战和安全风险的策略和解决方案提出了建议。以下是十大 API 安全威胁。

# API1:2019:破坏对象级授权

API 通常公开处理对象标识符的端点。这种暴露导致了广泛的攻击面，其中用于访问数据源的用户函数产生了级别访问控制问题。因此，建议对所有此类访问数据的功能进行对象级授权检查。

# API2:2019:用户身份验证失败

用户身份验证是访问应用程序的第一道控制关口，攻击者通常会利用不正确应用的身份验证机制。人们发现，攻击者可能会破坏认证令牌或利用漏洞暂时或永久地冒充其他用户的身份。一旦受到损害，API 的整体安全性也会受到损害。

# API3:2019:过度的数据暴露

为了简单起见，开发人员通常会公开比所需更多的数据，依赖客户端功能在向用户显示数据之前过滤数据。这是一个严重的数据暴露问题，因此建议在服务器端过滤数据，只向用户暴露相关数据。

# API4:2019:缺乏资源和速率限制

系统资源不是无限的，通常设计糟糕的 API 不会限制资源的数量或大小。过度使用资源可能会导致性能下降，有时还会导致拒绝服务(DoS)，包括恶意的 DoS 攻击。在没有应用速率限制的情况下，API 也暴露于认证漏洞，包括暴力攻击。

# API5:2019:功能级授权中断

授权缺陷更为常见，通常是过于复杂的访问控制政策造成的。特权访问控制没有得到很好的定义，常规功能和管理功能之间不明确的界限暴露了意想不到的功能缺陷。攻击者可以通过获取资源的访问权限或执行特权管理功能来利用这些缺陷。

# API6:2019:批量分配

在一个典型的 web 应用程序中，用户将数据更新到一个数据模型中，这个数据模型通常与用户不能绑定的数据绑定在一起。如果 API 端点自动将客户端参数转换为内部对象属性，而不考虑这些属性的敏感性和公开级别，则该端点容易受到攻击。这可能允许攻击者更新他们无权访问的对象属性。

# API7:2019:安全错误配置

安全错误配置是一个非常普遍的安全问题。通常，不适当的默认值、临时或不完整的配置、错误配置的 HTTP 标头或不适当的 HTTP 方法、限制不足的跨源资源共享(CORS)、开放云存储或包含敏感信息的错误消息会使系统存在易受数据失窃和财务损失影响的漏洞。

# API8:2019:注射

当不受信任的数据与命令或查询一起发送到解释器时，会导致注入缺陷(包括 SQL 注入、NoSQL 注入和命令注入)。攻击者可以发送恶意数据来欺骗解释器执行命令，从而允许攻击者在没有适当授权的情况下访问数据。

# API9:2019:资产管理不当

由于 API 的性质，现代应用程序中可能会暴露许多端点。缺乏最新的文档可能会导致使用旧的 API，从而增加攻击面。建议维护正确主机和部署的 API 版本的清单。

# API10:2019:记录和监控不足

攻击者可以利用日志记录和监控的不足，加上事件响应集成的无效或缺乏，在系统中持续提取或破坏数据而不被检测到。

# 针对 API 的常见攻击

与传统应用程序类似，API 也面临着许多与我们为保护网络和 web 应用程序而防御的攻击类型相同的攻击。下面是一些很容易被用来攻击 API 的攻击。

![](img/765417a88fd1842ef475070016ef4c5d.png)

# 如何保护 API

除了上表中提到的缓解策略之外，组织可以实施一些其他更广泛的控制措施来保护其公共共享的 API。

# “安全第一”，安全第一。

通常安全性是事后才想到的，被认为是别人的问题，API 安全性也不例外。API 安全性不能是事后的想法。使用不安全的 API，组织会损失很多。因此，确保安全性仍然是组织的首要任务，并融入到您的软件开发生命周期中。

# 维护一份完整的原料药清单。

几个 API 被公开共享是很常见的，通常，组织可能不知道所有的 API。为了保护这些 API，组织必须首先了解它们。定期扫描应发现和清点原料药。考虑实现一个 API 网关，对 API 进行严格的治理和管理。

# 使用强大的身份验证和授权解决方案。

认证和授权控制差或不存在是公共共享 API 的主要问题。API 被设计成不强制认证。私有 API 通常就是这种情况，它们仅供内部使用。由于 API 提供对组织数据库的访问，组织必须对这些 API 采用严格的访问控制。

# 最少特权。

“最小特权”的基本安全原则适用于 API 安全。所有用户、流程、程序、系统和设备必须仅被授予完成规定功能的最低访问权限。

# 加密传输中的流量。

当 API 交换敏感数据(如登录凭证、信用卡、社会保险、银行信息、健康信息等)时，API 有效负载数据必须加密。因此，TLS 加密应该被认为是必须的。

# 限制数据暴露。

确保开发数据，如开发密钥、密码和其他在 API 公开之前必须删除的信息。组织必须在其 DevSecOps 流程中使用扫描工具，以限制凭据的意外泄露。

# 输入验证。

必须实现输入验证，并且永远不要通过 API 发送到端点。

# 使用速率限制。

设置一个阈值(例如，每个帐户每天 10，000 个请求)可以防止拒绝服务攻击。

# 部署 web 应用程序防火墙。

部署 web 应用程序并对其进行配置，以确保它能够理解 API 负载。

# 结论

API 是现代应用程序访问数据的最有效的方法。移动应用和物联网(IoT)设备利用这种效率来推出创新产品和服务。由于对原料药的依赖，一些组织可能没有意识到原料药的特定风险。然而，大多数组织已经有控制措施来对抗众所周知的攻击，如跨站脚本、注入、分布式拒绝服务和其他可以针对 API 的攻击。此外，上述最佳实践也可能在这些组织中实施。如果您正在努力开始或知道从哪里开始，最好的方法可能是从顶部开始，并开始沿着堆栈向下移动。你的组织选择公开分享多少 API 并不重要。最终目标应该是建立基于原则的全面而有效的 API 安全策略，并随着时间的推移主动管理它们。

参考资料:

1. [OWASP API 安全项目](https://owasp.org/www-project-api-security/)

2.【2019 年应用保护报告

3.[什么是 API 安全，如何保护它们](https://outpost24.com/blog/what-is-api-security-and-how-to-protect-them)