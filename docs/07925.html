<html>
<head>
<title>AWS Redshift connects with Python Part 2 — Python code to connect AWS Redshift</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">AWS红移与Python连接第2部分-连接AWS红移的Python代码</h1>
<blockquote>原文：<a href="https://medium.com/codex/aws-redshift-connects-with-python-part-2-python-code-to-connect-aws-redshift-96f81523a733?source=collection_archive---------10-----------------------#2022-07-05">https://medium.com/codex/aws-redshift-connects-with-python-part-2-python-code-to-connect-aws-redshift-96f81523a733?source=collection_archive---------10-----------------------#2022-07-05</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="0093" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在第1部分会议中，我们设置了AWS红移帐户来连接外部世界。</p><p id="28cf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本次会议中，我将演示一些代码，这些代码将被设置并连接到python world to AWS Redshift。</p><p id="f9a1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我的主要目标是在AWS红移上传一个熊猫的数据帧。</p><p id="529a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首次登录AWS红移会话，或者我们可以转到红移仪表板。</p><p id="3b5c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">访问控制面板页面后，我们将在集群概述会话中看到集群列表。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/52df7c2b61f775ef3915068977484df8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XCMN7ccEgUPpQwZ8mKaMQA.jpeg"/></div></div></figure><p id="6a86" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们看到我创建了两个群集，一个是活动的，即“可用”，另一个是非活动的，即“暂停”。我将使用红移-星团-3。</p><p id="5161" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我还将向您展示如何激活或我们可以说如何使红移-集群-2可用。</p><p id="d940" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">单击“redshift-cluster-2”名称或您的集群名称，它会重定向到集群页面，单击“Action”，它会显示一个下拉菜单。</p><p id="2116" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在菜单里，你会看到“简历”，请点击它。单击后，需要几分钟时间来激活群集。因此，您将在AWS红移集群仪表板上看到集群的状态，消息将为“Resume Modifying ”,过一段时间后，它将变为可用。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jp"><img src="../Images/745d9ea6881934b9903408e48a130036.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4eXTPWnRM1-TkEK3adz4MA.jpeg"/></div></div></figure><p id="1a03" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一旦我们的集群“可用”，现在，让我们开始使用python代码。</p><p id="12cd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将通过运行下面给出的命令来安装红移连接器。</p><blockquote class="jq jr js"><p id="4eea" class="if ig jt ih b ii ij ik il im in io ip ju ir is it jv iv iw ix jw iz ja jb jc hb bi translated">pip安装红移连接器</p></blockquote><p id="4169" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了通过python连接AWS Redshift，我们需要某些凭证，如主机名、数据库名、端口号、用户和密码。</p><p id="9c51" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果我们在群集端，我们将转到“Properties ”,我们将看到我们正在寻找的凭据。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jx"><img src="../Images/9506660c8dfd519b12f583f20fa53614.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ct0_du7js8O3DiZRLnvPbg.jpeg"/></div></div></figure><p id="e154" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们将运行python中的查询来创建一个关于红移的表。</p><p id="7d8d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在此之前，让我们创建一个样本数据帧</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="jy jz l"/></div></figure><p id="4add" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们将在AWS红移集群中创建一个表。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="jy jz l"/></div></figure><p id="3614" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将看到表被创建。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ka"><img src="../Images/2986e18ca10ff7a208726b5e813484f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:750/format:webp/1*KOmoATIo4hi2-NpUjtlg9Q.jpeg"/></div></figure><p id="a97b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们将在表中插入DataFrame。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="jy jz l"/></div></figure><p id="4770" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，在查询编辑器中，我们将看到我们的表已经创建，并在表中填充了数据。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kb"><img src="../Images/f22382734033152291c5c0f6dfc3a2a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:814/format:webp/1*2bQjBXdJJCsygP-_85NMNQ.png"/></div></figure><p id="2a70" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">整个示例演示了如何创建AWS红移集群以及如何插入pandas数据帧。</p><p id="1461" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以在红移集群的数据帧中上传n个数据。</p></div></div>    
</body>
</html>