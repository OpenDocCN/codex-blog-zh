<html>
<head>
<title>Using image recognition to send an email, GUI automation series II.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用图像识别发送电子邮件，GUI自动化系列II。</h1>
<blockquote>原文：<a href="https://medium.com/codex/using-image-recognition-to-send-an-email-gui-automation-series-ii-511bb7660fe2?source=collection_archive---------3-----------------------#2021-02-27">https://medium.com/codex/using-image-recognition-to-send-an-email-gui-automation-series-ii-511bb7660fe2?source=collection_archive---------3-----------------------#2021-02-27</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><h2 id="8a3f" class="hg hh hi bd b fp hj hk hl hm hn ho dx hp translated" aria-label="kicker paragraph"><a class="ae ge" href="http://medium.com/codex" rel="noopener">法典</a></h2><div class=""/><p id="44ad" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">今天我们将使用PyAutoGUI打开一个新的chrome标签，登录到一个电子邮件帐户，写一个草稿，然后发送它。这是GUI自动化教程系列的第二部分，所以如果您还没有Python和PyAutoGUI的经验，请查看第一篇教程中的<a class="ae jm" href="https://thefounder.medium.com/how-to-make-a-google-search-bot-gui-automation-series-i-9eb5618d3a27" rel="noopener">。我们还将使用gmail作为示例，但当我们完成后，您应该能够使用任何电子邮件帐户进行操作。有一个TL；如果你想直接跳到代码。也可以访问我的</a><a class="ae jm" href="https://github.com/wwidjaja1/GUI" rel="noopener ugc nofollow" target="_blank"> Github </a>获取这里解释的代码。</p><p id="759a" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">让我们从我们的步骤列表开始:</p><ol class=""><li id="1bb0" class="jn jo hi iq b ir is iv iw iz jp jd jq jh jr jl js jt ju jv bi translated">点击windows键，搜索chrome，打开chrome(在第一个教程中有介绍)</li><li id="c8b2" class="jn jo hi iq b ir jw iv jx iz jy jd jz jh ka jl js jt ju jv bi translated">打开新选项卡(在第一个教程中介绍)</li><li id="8f73" class="jn jo hi iq b ir jw iv jx iz jy jd jz jh ka jl js jt ju jv bi translated">键入<a class="ae jm" href="http://gmail.com/" rel="noopener ugc nofollow" target="_blank">gmail.com</a>(或者<a class="ae jm" href="http://mail.yahoo.com/" rel="noopener ugc nofollow" target="_blank">mail.yahoo.com</a>或者另一个域名，如果你愿意的话)</li><li id="ea4d" class="jn jo hi iq b ir jw iv jx iz jy jd jz jh ka jl js jt ju jv bi translated">在用户名框中输入光标。输入密码。登录</li><li id="89cf" class="jn jo hi iq b ir jw iv jx iz jy jd jz jh ka jl js jt ju jv bi translated">通过对话框验证成功登录</li><li id="1e7f" class="jn jo hi iq b ir jw iv jx iz jy jd jz jh ka jl js jt ju jv bi translated">找到“撰写”按钮</li><li id="bb07" class="jn jo hi iq b ir jw iv jx iz jy jd jz jh ka jl js jt ju jv bi translated">输入收件人、主题和电子邮件。发送电子邮件</li></ol><p id="663d" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">在上一个教程中，我们复习了一些基本的PyAutoGUI函数(写，热键，按，截图)。这一次，我们想使用PyAutoGUI。<strong class="iq hs">locate center screen</strong>(" image . png "，confidence = float)，其中0 &lt; float &lt; 1。</p><p id="4184" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">这个功能很酷。您可以对任何图像进行截图(如通缉令)，然后让PyAutoGUI在“野外”再次找到该图像</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es kb"><img src="../Images/ee0401a25e12730bc6dadaddd6e61637.png" data-original-src="https://miro.medium.com/v2/resize:fit:1122/format:webp/1*V9VkGKqyEHXqvrLNG7qm9Q.png"/></div><figcaption class="kj kk et er es kl km bd b be z dx translated">完全艺术化的谷歌幻灯片演示PyScreeze如何找到图像。</figcaption></figure><p id="9021" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">PyAutoGUI通过使用PyScreeze来实现这一点，PyScreeze是PyAutoGUI自动安装的另一个Python模块。它从左上角开始扫描你的屏幕，然后向右下方扫描，直到找到与你传递到locateCenterOnScreen函数中的文件相匹配的图像。置信区间允许您要求它查找的图像与屏幕上显示的图像之间存在一定的差异。因此，90%的置信度意味着只需要90%的像素匹配，允许微小的差异。</p><p id="e6d2" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">locateCenterOnScreen()函数还返回屏幕上图像中心的x和y坐标，允许我们自动点击鼠标。</p><p id="12f7" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">关于这个简洁函数如何工作的文档在<a class="ae jm" href="https://pyautogui.readthedocs.io/en/latest/screenshot.html" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><p id="2e74" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated"><strong class="iq hs">设计流程</strong>:</p><ol class=""><li id="2060" class="jn jo hi iq b ir is iv iw iz jp jd jq jh jr jl js jt ju jv bi translated">打开一个名为autoEmailer.py的新Python文件，或者打开autoSearcher.py文件，从try/except块中删除一些代码，直到我们只剩下步骤1和2(打开Chrome标签)。然后将该代码移动到它自己的名为“openChrome”的函数中</li></ol><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es kn"><img src="../Images/87e52a448dafe5b91e886315915a71cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1048/format:webp/1*EF1TbNt8Pqb8HRILqgPkGw.png"/></div><figcaption class="kj kk et er es kl km bd b be z dx translated">你也可以从我的Github中复制这段代码</figcaption></figure><p id="6801" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">2.好了，现在事情变得有趣了。你需要截取一些你桌面上的截图。我喜欢剪贴工具(或剪贴和草图),因为我们可以从一开始就捕捉到我们想要的精确区域，但完整的截图和随后的裁剪也一样有效。我们获取这些图像，并告诉我们的代码，这些是它应该注意的按钮。</p><p id="6d29" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">当你在Gmail主页上时，记下你看到的内容:</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="er es ko"><img src="../Images/78950c83353c71911428aed029b8b2a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*JYBeb0Z4hp6sHs5w"/></div></div><figcaption class="kj kk et er es kl km bd b be z dx translated">注销后您会看到什么</figcaption></figure><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="er es kt"><img src="../Images/5333f5be4179201dae6d6992d7463be8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*bfdu1zIXEhGwx4xG"/></div></div><figcaption class="kj kk et er es kl km bd b be z dx translated">登录后您会看到什么</figcaption></figure><p id="84d6" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">如果您已注销，您会看到类似顶部的内容。如果你登录了，你会看到类似底部的东西</p><p id="4b2e" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">3.现在我们问自己，下一步是什么？嗯，我们设计我们的代码，让它通过一个主循环处理这两种情况。我们将在“编写代码”一节中讨论如何创建一个主循环，但是现在，让我们只收集数据并假设您需要登录。让我们假设我们是鼠标光标，并注意它的行程:</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es ku"><img src="../Images/1ee10a578c181661fc220e4dbc26ccfe.png" data-original-src="https://miro.medium.com/v2/resize:fit:118/0*wEAXczyJNOaVfCs3"/></div><figcaption class="kj kk et er es kl km bd b be z dx translated">截屏或截取文本中的签名，将其保存为“signInButton.png”</figcaption></figure><p id="6722" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">4.我们假设你有一个gmail帐户，所以我们只需点击登录按钮或文本。截屏显示“登录”文本，并将其保存为“signInButton.png”(稍后，我们将在signInButton.png中传递一个函数来自动点击它)</p><p id="dcc0" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">5.现在点击“登录”,看看下一个屏幕上有什么</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es kv"><img src="../Images/71f82a36a107e405f44303fd76cfcab1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1026/0*XDbfut_KvfjolvX6"/></div></figure><p id="6643" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">6.你下一步会点击什么？当然是“电子邮件或电话”箱。截屏并将其命名为“signInBoxBlank.png”</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es kw"><img src="../Images/c57a1778865433993964d577533caac8.png" data-original-src="https://miro.medium.com/v2/resize:fit:258/0*0nlCW_ECk1-RSHjZ"/></div><figcaption class="kj kk et er es kl km bd b be z dx translated">signInBoxBlank.png</figcaption></figure><p id="608c" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">7.你也有可能得到这样的屏幕。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es kx"><img src="../Images/a76e6044e686d0c9412e88c7c7d1d612.png" data-original-src="https://miro.medium.com/v2/resize:fit:858/0*3S2HkCN9klB4sy2G"/></div></figure><p id="e913" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">8.发现尽可能多的分支是一个好主意，这样我们的代码可以处理不同的屏幕(尽管有时这是不可能的，因为有些屏幕不能被“召唤”，比如2FA提醒)。现在，让我们保持简单，为90%的情况编程。我们将假设您是唯一的用户，并且想要重新登录。截屏你的图标或“注销”文本。请注意，如果您想为多次登录实现这一点，您需要选择您的图标，甚至是整个电子邮件。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es ky"><img src="../Images/a390021a3c76d6e7978c7d2fc59cf203.png" data-original-src="https://miro.medium.com/v2/resize:fit:72/format:webp/1*259pbY0KD9BEiM_5dLxh2A.png"/></div><figcaption class="kj kk et er es kl km bd b be z dx translated">我的偶像。我把它命名为“smallSignInIcon.png”</figcaption></figure><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es kz"><img src="../Images/2ba3aaa1479245cd70c97473225bf0d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:128/format:webp/1*iMHSMbkBr0iYuraHA8JR6w.png"/></div><figcaption class="kj kk et er es kl km bd b be z dx translated">“已注销”的文本。如果你是从我的Github复制的，这个叫做“chooseAccount.png”</figcaption></figure><p id="5550" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">9.现在，单击开始您的帐户的登录过程。下一页很可能是这两种情况之一:</p><p id="b084" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">A.)密码字段已经突出显示。在这种情况下，蓝色的文本框显示，我们只需要让我们的程序键入密码，然后点击“enter”请注意，这是我们识别图像的时间，但是一旦我们看到它，就做一些事情而不是点击它。</p><p id="f2f4" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">A.)密码字段已经突出显示。在这种情况下，蓝色的文本框显示，我们只需要让我们的程序键入密码，然后点击“enter”请注意，这是我们识别图像的时间，但是一旦我们看到它，就做一些事情而不是点击它。当密码字段已经突出显示时，显示蓝色文本。我把它叫做“cursorAlreadySet.png”</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es la"><img src="../Images/36f94d5bb86488e0e301297c23482e5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:234/0*KLppE7_-lLeE5cz8"/></div></figure><p id="af51" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">B.)密码字段不会突出显示。在这种情况下，会显示灰色文本，我们希望单击它来键入我们的密码。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es lb"><img src="../Images/356b080adf85e776d63008f458ae8ed8.png" data-original-src="https://miro.medium.com/v2/resize:fit:338/0*c4aBc_8tm9aeQF4e"/></div><figcaption class="kj kk et er es kl km bd b be z dx translated">当光标没有自动选择字段时，会显示此文本。我把它叫做“cursorNotSetforPass.png”</figcaption></figure><p id="3ccd" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">10.这是我们的代码逻辑:键入密码，如果cursorAlreadySet.png是可见的，按回车键。否则，单击“cursorNotSetforPass.png”字段，然后键入密码并按回车键。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="er es kt"><img src="../Images/5333f5be4179201dae6d6992d7463be8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*bfdu1zIXEhGwx4xG"/></div></div><figcaption class="kj kk et er es kl km bd b be z dx translated">登录后您会看到什么</figcaption></figure><p id="d9d5" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">11.这里，我们假设我们已经登录(如果我们已经登录，我们也可以从步骤1直接到达这里)</p><p id="a120" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">12.找到撰写按钮，截屏后点击它。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es lc"><img src="../Images/3bd15807ed0e002ba77076b3267fade3.png" data-original-src="https://miro.medium.com/v2/resize:fit:248/0*EahPt6TIAbIJadoE"/></div><figcaption class="kj kk et er es kl km bd b be z dx translated">我称之为“composeButton.png”</figcaption></figure><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es kv"><img src="../Images/471bc924cf25fb68ed62b4fac021b8a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1026/format:webp/1*Fns3Ev2BQdA5JXe6SXFCfw.png"/></div><figcaption class="kj kk et er es kl km bd b be z dx translated">在gmail中撰写电子邮件时弹出的窗口。请注意,“到”字段是自动选择的。</figcaption></figure><p id="b3bc" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">13.点击后，一个新的迷你窗口出现。由于“To”字段是自动选择的，我们的代码可能会开始使用write()函数键入收件人(在我的代码中，我让它在循环中按每个收件人的tab键，直到所有收件人都被添加)。</p><p id="0a36" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">14.完成收件人后，只需再次按tab键，用write()键输入主题。</p><p id="6935" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">15.再次点击tab键进入正文。现在您已经在正文中，用write()键入消息。</p><p id="e15f" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">16.现在用热键()按ctrl+Enter发送。</p><p id="9087" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated"><strong class="iq hs">编写代码</strong></p><p id="279e" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">好了，现在我们完成了数据收集，我们需要将这个设计转化为代码。我们可以分两步走。</p><ol class=""><li id="f2c4" class="jn jo hi iq b ir is iv iw iz jp jd jq jh jr jl js jt ju jv bi translated">创建“主循环”或“游戏循环”结构</li><li id="9383" class="jn jo hi iq b ir jw iv jx iz jy jd jz jh ka jl js jt ju jv bi translated">创建阶段或状态以便在主循环中跳转</li></ol><p id="78c1" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">在我们的上一个教程中，我们两个都没有做。我们刚刚经历了5个步骤。但是这个任务有更多的分支步骤，简单地浏览可能会导致错误。我们可以很容易地从我们的主循环开始，然后我们可以花另一个教程通过添加定义的状态来改进它。</p><p id="15ab" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated"><strong class="iq hs">回路设计</strong>:</p><ol class=""><li id="0abd" class="jn jo hi iq b ir is iv iw iz jp jd jq jh jr jl js jt ju jv bi translated">主循环继续执行，直到出现停止或中断条件。像游戏一样，计算机不断检查其环境的变化，然后更新或刷新代码中的某些变量，从而改变其他内部变量或屏幕上显示的内容。</li><li id="bc3a" class="jn jo hi iq b ir jw iv jx iz jy jd jz jh ka jl js jt ju jv bi translated">每一个可能存在的步骤或动作都被放入主循环中，只有在满足条件时才会被触发(在我们的例子中，是看到图像、文本或按钮)。循环运行速度很快，以毫秒或微秒级刷新每个循环运行的条件值。</li><li id="eb8c" class="jn jo hi iq b ir jw iv jx iz jy jd jz jh ka jl js jt ju jv bi translated">在任何时候，我们都可以放入中断，甚至状态(未来教程)。现在，像这样做一个循环可以让我们无论是否登录都可以发送电子邮件，而不必考虑分支！</li></ol><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es ld"><img src="../Images/d1bd20de0d8a4829864fa2a94ed54c01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1288/format:webp/1*RWU5_htQZ7uMsmpZDW1d9Q.png"/></div><figcaption class="kj kk et er es kl km bd b be z dx translated">游戏循环设计工作原理的一般框图</figcaption></figure><p id="42b6" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">这是一个为随机“闲置”游戏(如cookie clicker)制作的游戏循环示例，奖励用户按下“s”键:</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="er es le"><img src="../Images/bc7e3c147890de11d66b9bfcb622b9d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qYVSd_MV3fEawY5mswAMiw.png"/></div></div><figcaption class="kj kk et er es kl km bd b be z dx translated">空闲游戏的伪代码循环</figcaption></figure><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es lf"><img src="../Images/a478376c231492a66e2890b680750b52.png" data-original-src="https://miro.medium.com/v2/resize:fit:926/format:webp/1*lmA9DoesAIq9zZLBo8WrVA.png"/></div><figcaption class="kj kk et er es kl km bd b be z dx translated">上述“游戏”的实际代码。不要担心运行这个。重点是在一些简单的东西上看到一个真实的例子</figcaption></figure><p id="1793" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">现在回到我们的电子邮件设计，每个自动决策过程可以总结如下:</p><ol class=""><li id="4e93" class="jn jo hi iq b ir is iv iw iz jp jd jq jh jr jl js jt ju jv bi translated">我看到这个图像了吗？如果没有，抓紧直到我开始(再做一次循环)</li><li id="3f57" class="jn jo hi iq b ir jw iv jx iz jy jd jz jh ka jl js jt ju jv bi translated">好的，我看到了这个图像，现在我需要做这个动作(如果是按钮，点击它。如果是字段，就在里面写。)</li><li id="6a71" class="jn jo hi iq b ir jw iv jx iz jy jd jz jh ka jl js jt ju jv bi translated">…就是这样。事实证明，这导致了看起来非常简单的代码。让我们尝试一个带有登录按钮的示例:</li></ol><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es ku"><img src="../Images/f860493947059c76b8b6e90818e1dc58.png" data-original-src="https://miro.medium.com/v2/resize:fit:118/0*6GCbl54Wp8xdkrf0"/></div><figcaption class="kj kk et er es kl km bd b be z dx translated">当你想点击这张图片时</figcaption></figure><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es lg"><img src="../Images/9f95fe5d49e440fd2a2b9532f7d1203d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1366/format:webp/1*JKjJr-BIdt1xPatLwYzn6w.png"/></div><figcaption class="kj kk et er es kl km bd b be z dx translated">使用此代码</figcaption></figure><p id="f532" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">现在，每隔一幅图像重复一次，并加入书写函数。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="er es lh"><img src="../Images/24630764331c62fd4839e9b6aa00c0f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xkzs-TaI_VIC6TGurjkz7w.png"/></div></div></figure><p id="9afe" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">在更改了硬编码字段之后，您可以用我的文件亲自尝试一下。在未来的教程中，我们可能会讨论这些类型的改进:</p><ol class=""><li id="e6db" class="jn jo hi iq b ir is iv iw iz jp jd jq jh jr jl js jt ju jv bi translated">创建事件侦听器和线程，而不是任意休眠</li><li id="6f12" class="jn jo hi iq b ir jw iv jx iz jy jd jz jh ka jl js jt ju jv bi translated">创建固定的帧速率并使用PyGame获得更好的游戏循环</li><li id="9530" class="jn jo hi iq b ir jw iv jx iz jy jd jz jh ka jl js jt ju jv bi translated">创建一个配置文件，这样我们就不会硬编码任何变量</li><li id="8726" class="jn jo hi iq b ir jw iv jx iz jy jd jz jh ka jl js jt ju jv bi translated">使用OCR和/或机器学习训练的图像识别ai，所以我们不需要收集参考图像</li><li id="4e84" class="jn jo hi iq b ir jw iv jx iz jy jd jz jh ka jl js jt ju jv bi translated">介绍其他API和软件包</li></ol><p id="ffc8" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated"><strong class="iq hs">TL；博士</strong>:</p><ol class=""><li id="907c" class="jn jo hi iq b ir is iv iw iz jp jd jq jh jr jl js jt ju jv bi translated">如果您还不熟悉Python和PyAutoGUI，请完成教程1。</li><li id="b45f" class="jn jo hi iq b ir jw iv jx iz jy jd jz jh ka jl js jt ju jv bi translated">进入我的<a class="ae jm" href="https://github.com/wwidjaja1/GUI" rel="noopener ugc nofollow" target="_blank"> Github </a>，下载名为“autoEmailer.py”的python文件和名为“autoEmailerImages.zip”的图片压缩文件(解压图片并确保它们与autoEmailer.py在同一个文件夹中)</li><li id="7b63" class="jn jo hi iq b ir jw iv jx iz jy jd jz jh ka jl js jt ju jv bi translated">编辑硬编码字段，例如writeRecipients()函数中的“用户名”、“密码”和recipientList变量。(或者，创建一个配置文件)。运行autoEmailer.py文件</li></ol><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es li"><img src="../Images/5c14778bf9346c9766d44c66bfb6e3a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:482/format:webp/1*8H52Ayym-1G21CnDwnom7Q.png"/></div><figcaption class="kj kk et er es kl km bd b be z dx translated">更改这些字段中的文本</figcaption></figure><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es lj"><img src="../Images/fdeada6009f9ecf71e4722e5e0e65662.png" data-original-src="https://miro.medium.com/v2/resize:fit:908/format:webp/1*3rbNNNxKWWxqkMAL2x--LA.png"/></div><figcaption class="kj kk et er es kl km bd b be z dx translated">同时更改突出显示的值</figcaption></figure><p id="287f" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated"><strong class="iq hs">脚注</strong>:</p><ol class=""><li id="c235" class="jn jo hi iq b ir is iv iw iz jp jd jq jh jr jl js jt ju jv bi translated">从数学的角度来看，这是大量的计算。PyAutoGUI文档显示，在1920 x 1080的屏幕上定位一幅图像需要1-2秒。计算机一个像素一个像素地移动一个窗口，并将它所看到的与参考图像进行比较。如果它在寻找一个40 x 40的图像，它将从[左上，右下] = [(0，0)，(40，-40)]定义的矩形开始，然后移动到[(0，0)，(41，-40)]，[(0，0)，(42，-40)]……[(0，0)，(1879，-40)]，[(0，0)，(1880，-40)]，[(0，-1)，(40，-41)]，[(0，-1)，(41，-41)]对于你们这些算法迷来说，这是O( (a -c + 1)*(b-d+1))的最坏情况复杂度，其中屏幕尺寸是a×b像素，而我们想要的图像是c×d像素。对于一个40 x 40的图像，如果图像直到右下角才被找到，那么就要比较超过190万个像素。</li></ol></div></div>    
</body>
</html>