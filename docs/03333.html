<html>
<head>
<title>Bayesian Approach in Logistic Regression</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">逻辑回归中的贝叶斯方法</h1>
<blockquote>原文：<a href="https://medium.com/codex/bayesian-approach-in-logistic-regression-981f1387505b?source=collection_archive---------8-----------------------#2021-08-28">https://medium.com/codex/bayesian-approach-in-logistic-regression-981f1387505b?source=collection_archive---------8-----------------------#2021-08-28</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="72a5" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">随着数据科学领域的发展，机器学习和深度学习正在受到人们的关注。我们是否忘记了隐藏在这些复杂方法背后的基本知识？我们倾向于将复杂但强大的模型称为“黑盒模型”，因为它在获得给出最终期望输出的能力时正在失去可解释性，但我们正在失去对发展的跟踪和超越这些数据的一些洞察力。所以，让我们回到关于统计学的基本问题上来，它的重要性不应该减弱。</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/bf2286da66b1f0a5781a1e531f11ceae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*V99KUKXOiyu4f0K9"/></div></div></figure><p id="1d19" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">自从我上次做贝叶斯分析已经很久了。直到最近，我才接触到它在逻辑回归中的应用。值得一提的是，巧合的是，我看到了一篇研究无监督自然语言案例的论文，同时将贝叶斯概念应用于生成分布。让我们来看看经典分析和贝叶斯分析之间的区别。</p><p id="7a68" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">如果你是统计学出身，不管是纯统计学、分析学还是像我一样的精算，相信你对‘经典统计学’和‘贝叶斯统计学’这两个名词都不会陌生。高中第一堂统计学课，有人问我们，“什么是概率？”。而且，今天我们会被以稍微有点棘手的方式提问，“概率在频率统计和贝叶斯统计中意味着什么？”?'。频率主义者将概率解释为一个事件在大量可重复实验中出现的频率。然而，贝叶斯概率是一种表达我们对一个事件的信任程度的方式。</p><p id="6a0d" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">当时，在我攻读学位期间，我们接触了将分布参数视为随机变量的理论应用，使用提供的数据更新参数的先验信念，并因此得出关于具有参数更新后验分布的预测模型的结论。本主题的概述仅限于众所周知的正式定义的发行版。直到我偶然发现贝叶斯机器学习这个术语，我一直很好奇它在机器学习中的应用。然后，我的旅程从这里开始，一个简单的关于逻辑回归的例子，使用贝叶斯统计和马尔可夫链蒙特卡罗(MCMC)方法，而不需要经过详细和更正式的管道，包括重复数据删除和异常值检查。假设数据集没有这些数据质量问题。</p></div><div class="ab cl kf kg gp kh" role="separator"><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk"/></div><div class="hb hc hd he hf"><p id="6f52" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">数据加载和检查:</strong></p><p id="d609" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">给定数据集中的目标变量是数字数据，但我们的目标是在这里执行逻辑回归，其中目标变量应该只取值0/1。我们假设，6分以上是好酒(y=1)。数据集中没有缺失值。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es km"><img src="../Images/16a193209334d725e488ec0e9d876b03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pQvZUYjd3kon7vEnbbgfXA.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">R1:数据加载和NA检查。</figcaption></figure><p id="2407" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">数据汇总和经典分析(广义线性模型，GLM): </strong></p><p id="ad44" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">统计摘要:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es kr"><img src="../Images/f71dede8c1af0f19150e1a7e39457554.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S_mJSQAOILeukletogUBFQ.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">表1:统计摘要。</figcaption></figure><p id="6f0d" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">变量的标准偏差:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ks"><img src="../Images/165532b04b5b82631d43093623c943d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OVcY8FoPzWLzUvknG_hkGw.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">表2:变量的标准偏差。</figcaption></figure><p id="4939" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">葡萄酒等级频率表:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es kt"><img src="../Images/d0a8cdebeba337c72da4d9a62f37e60d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wFAjhqcwBpTCtUYw7P8shw.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">表3:频率表。</figcaption></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es ku"><img src="../Images/0a972066c3dc1a775b7f299a0f6d8a9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:672/format:webp/1*ik6VLOD8KmEDwkBp_uGFQQ.png"/></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">图1:葡萄酒等级直方图。</figcaption></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es kv"><img src="../Images/9deacb8e0a03423a39085a3f5a6c8a4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ek1DuMM20kpe6fNPzMuO5w.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">R2:统计摘要。</figcaption></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es kw"><img src="../Images/6bd4612c4ff1b2c9561ad4f2f004ce08.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*24dnRJRiVyx7uC5UfTLhpg.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">R3:标准差。</figcaption></figure></div><div class="ab cl kf kg gp kh" role="separator"><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk"/></div><div class="hb hc hd he hf"><p id="52aa" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">广义线性模型(逻辑回归模型):</strong></p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es kx"><img src="../Images/a749ca7681b71a9990a1383efd3cbbed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GB6eVUIxw3NeqTPmRQ-kUg.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">R4: GLM模式。</figcaption></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ky"><img src="../Images/efc51791a335f69d450468b18ed4c93c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DKmbxayBAMHJoIHif_22XQ.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">R5:置信区间。</figcaption></figure><p id="a70c" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">变量值的范围变化很大，从最小值0.0136到最大值283。总二氧化硫报告的标准偏差为32.895，密度的标准偏差为0.002，这是所有变量中的最大值和最小值。有217种好酒(质量分数&gt; = 6.5)，1382种酒没有被归类为好酒。</p><p id="9193" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">假设变量k的零假设陈述系数为零，在5%的显著性水平下，变量pH、游离二氧化硫和柠檬酸的p值分别为0.822、0.376和0.498。因此，对于这三个系数，没有显著的统计证据来拒绝零假设。它可能会从模型中删除。除此之外，与假设除截距之外所有系数为零的零偏差相比，残差偏差明显下降，这意味着训练的饱和模型更适合。</p><p id="e7d4" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">无显著变量的广义线性模型(Logistic回归模型):</strong></p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es kw"><img src="../Images/e0995dbb9300f04055652af7d72c25fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PzI7S4O3Ua1MqRe_rhqTIw.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">R6:删除了无关紧要变量的GLM模型。</figcaption></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es kz"><img src="../Images/367aa53edfcb271c2238f5f18490d7d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_DuUgm8wIgsICjLYGhvmTA.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">R7:去除了不重要变量的置信区间。</figcaption></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es la"><img src="../Images/e4bc1da9ac3c0cfeefde0781aaa7c393.png" data-original-src="https://miro.medium.com/v2/resize:fit:1088/format:webp/1*4D8TlChS9hiUCkmdedhF3w.png"/></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">图2:R4模型的ROC曲线</figcaption></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es kv"><img src="../Images/5de77223af67d0322c95daf28d278c83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DRmW57j5WC-UPSK1PgGLTA.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">R8:位于R4的AUC之下的地区。</figcaption></figure><p id="d03f" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">在去除无关紧要的变量后，剩余的变量在该模型中仍然具有统计显著性。该模型报告了890.08的较低AIC，它没有提供最佳模型的信息，但它表明了所有实验中更适合的模型。但是剩余偏差有很小的增量2，这意味着与第一个模型相比，第二个模型有很少量的无法解释的变化。两种模型的ROC曲线几乎重叠，曲线下的面积量相似，表明分类性能相同。尽管如此，第一个逻辑回归模型系数将用于贝叶斯分析。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lb"><img src="../Images/7507bf8ef21fc98597328991e8aba333.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h1sqf0eMgsZ6uaYIeUSotQ.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">R9:在其他变量保持不变的情况下，总二氧化硫含量不同的优质葡萄酒的概率。</figcaption></figure></div><div class="ab cl kf kg gp kh" role="separator"><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk"/></div><div class="hb hc hd he hf"><p id="4402" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">贝叶斯分析</strong></p><p id="5aa0" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">考虑下面的逻辑回归方程:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es lc"><img src="../Images/f1d7f74ef36789e9b0abefb14e9c1185.png" data-original-src="https://miro.medium.com/v2/resize:fit:1104/0*OoXW1qytu5PzSxJV"/></div></figure><p id="a82c" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">我们将为线性模型的系数生成样本。假设独立的分布系数，取系数的先验分布为:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es ld"><img src="../Images/423da27229db58e736b37fd719db14e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:578/format:webp/1*sTyS5M5o02u0JaL8gRVLxA.png"/></div></figure><p id="2a22" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">用β表示对数似然方程:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es le"><img src="../Images/113c8b39e26f1edda742556d56127f42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SJnLCh0cbfNDJh4JsCu5CA.png"/></div></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es lf"><img src="../Images/e105ddb2348ca3c2e1addd630546856d.png" data-original-src="https://miro.medium.com/v2/resize:fit:764/format:webp/1*OZZuSTVuXOdOWctztw-LEg.png"/></div></figure><p id="278c" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">根据β和X找出p，然后代入似然函数。然后，我们使用上面的公式生成β向量的后验分布。这里省略推导过程。为了像往常一样简化计算，我们将把它转换成对数似然函数。一种多元正态分布，它不可能通过推导微分方程找到最大值点来解析地导出。因此，后验样本是由MCMC采样过程产生的，因此我们相信，如果运行足够长的时间，链将收敛到一个点，而不管初始化状态如何。测试了多次初始化，以观察它如何影响MCMC采样过程(MH采样)。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lg"><img src="../Images/bcb53831b1e05c074e7806f60056bde9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cCSqF1-0kzvip2wQBLOj7Q.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">表4:MH算法的初始化。</figcaption></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lh"><img src="../Images/3319026a739d67c1323f6e4d2806e696.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q8cim0MsSzn2gfvt6UTB9A.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">R10: MH算法和类别预测(步骤5:预测)</figcaption></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es li"><img src="../Images/ae6fdfb2b212f0c274c65e0342cec7d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6N4YXgXx_Pp7EwUw2gqW0A.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">R11:不同初始化的模拟。</figcaption></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lj"><img src="../Images/514226922bdaab67d5643bea258dada8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O1frEdAm7SC5CWWdzNuzqQ.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">R12:模拟的链图。</figcaption></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lk"><img src="../Images/1e97bb5bb0b8e9475169f6d0e9ab0200.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WhVVbWv6ZzCvqDS_dhuoUA.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">图3:模拟的马尔可夫链。</figcaption></figure><p id="52a6" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">通过调整代码中的参数<strong class="jl hj"> c </strong>，专家建议的理想接受水平约为20–30 %,我们使用该参数来调整MCMC过程中使用的多元正态分布的方差。</p><p id="e124" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">用不同初始化生成的所有四个链在10000次模拟内收敛，但是在链的开始处有一些波动。用frequentist分析的系数初始化的链收敛最快，第三个初始化选项在所有四个选项中波动最大。然而，不管te初始化如何应用，从贝叶斯分析中获得的一些系数并不收敛到MLE估计。截距、固定酸度、挥发酸度、残糖、密度、pH和酒精的系数不会收敛到传统的估计值。如果我们设置一个非常奇怪的初始向量，链将需要更长的运行时间来达到收敛，不管它是否收敛到频率分析获得的估计。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ll"><img src="../Images/b9af4a1031a0143630126f08f50d4797.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qT2_92hTy5LTK4uZt8JCow.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">图4:用不同初始化为模型预测的目标变量的柱状图。</figcaption></figure><p id="2e1e" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">好酒的概率:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es lm"><img src="../Images/c3c3fbfb0228c187d366a2d0d1f034e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1190/format:webp/1*MZJDL03nRSfcRh8nfCYbtA.png"/></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">表5:好酒的概率。</figcaption></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ln"><img src="../Images/142cef0a808e2cb0f732d0f0a65c282b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MMU2A89l4LHI0VTDXFAf9A.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">R13:柱状图和概率计算。</figcaption></figure><p id="a64e" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">对于用不同初始化形成的贝叶斯模型，在预测为好的样本数量上观察到差异。第三次初始化给出了与原始数据(0.1570)最不同概率(0.0885)。其余三个相互接近，但仍略微远离0.1570。</p><p id="66cf" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">带库metrop的MH算法:</strong></p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es kv"><img src="../Images/54bfec535da67aa298003b2b264fde6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NDFrPSJzXU82bTcUwxgYQA.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">R14:用r中的库metrop()生成样本。</figcaption></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lo"><img src="../Images/dd89dc48b335893ef82759db1b18a087.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SIkT5NS8_QjQMwqYK7oo5g.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">r15:metrop()的接受概率。</figcaption></figure><p id="4b4d" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">运行上面的代码，在达到稳定状态或收敛后，您将获得与上面的图3相同的图。与前者相比，在链的起点有一些波动。这种方法简单易用，只需一行代码就能实现，但挑战在于为每个系数调整最佳比例参数，尤其是当我们有一组变化程度差异很大的变量时。这个项目的数据集是最好的例子，变化范围从0.00005到0.1。当我们将初始化设置为一个奇怪值的向量，与可能的系数相差很大时，情况变得更加复杂。如果参数调整不当，我们甚至可能面临收敛的问题。这种情况的一个例子如下所示。不是反转自定义M-H算法中c*omega给出的多元正态分布的方差计算来获得metrop()函数的参数标度，而是将标度参数设置为不同的矩阵。大多数链即使在长时间运行后也不会收敛。下面的例子说明了在函数中设置正确参数的重要性。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es lp"><img src="../Images/eaae687cca36f0eff2321e27da9c1055.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*sfP5CdT6Xs5YN92g17ppzA.png"/></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">图5:为缩放设置了不适当参数的失败案例。</figcaption></figure><p id="8032" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">有时，现成的MCMC函数可以简化编写冗长代码的工作，但它并不总是能给出好的结果，如果在发布之前不仔细分析结果，还会带来负面影响。最佳或最合适的方法取决于我们可获得的数据。我们可以通过对数据进行标准化或缩放来简化定义函数，而不是冒险定义过程中可能会出现错误的函数。但是，请注意，所构建的模型是基于转换后的数据的。因此，当我们试图对新数据进行任何预测时，需要在代入模型之前进行转换。</p></div><div class="ab cl kf kg gp kh" role="separator"><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk"/></div><div class="hb hc hd he hf"><p id="8480" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">结论</strong></p><p id="21f3" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">由于这项工作的目的是获得贝叶斯和MCMC的实践经验，因此可以通过将样本分成训练和测试数据集来改进实验，以便进行更有说服力的性能评估。通过检查频率统计中的p值，进一步的统计推断起到与假设检验相似的作用，是通过计算最高密度区间。搜索给出指定置信水平的最短区间，然后检查您测试的值是否超出该区间以得出结论。</p><p id="9d63" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">除了frequentist和Bayesian之间的争论，我相信每一个新想法的创新和发表都是为了克服现有方法的缺点，或者提供一个看待问题的不同视角。现有的不应该被完全取代和消灭。为每种情况选择正确的方法来提高性能，您可能会发现数字背后的宝石。</p></div></div>    
</body>
</html>