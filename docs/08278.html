<html>
<head>
<title>How Kotlin supports default function parameters when Java does not</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">当Java不支持缺省函数参数时，Kotlin是如何支持的</h1>
<blockquote>原文：<a href="https://medium.com/codex/how-kotlin-supports-default-function-parameters-when-java-does-not-cd3b839b8089?source=collection_archive---------6-----------------------#2022-07-28">https://medium.com/codex/how-kotlin-supports-default-function-parameters-when-java-does-not-cd3b839b8089?source=collection_archive---------6-----------------------#2022-07-28</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="29c2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可能已经使用了Kotlin的默认函数参数来简化函数调用和封装默认行为。但是，Java不提供这种支持。然而，两种语言都是可互操作的，当目标是Kotlin/JVM时，Kotlin代码甚至被编译成Java字节码。本文帮助您理解Kotlin如何在支持默认参数的同时保持与Java的互操作性。我们走吧！</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/2925eb7cbbd368da6d19712cb1e565b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pJ-YYGaOKY3SSCBEO_mvAg.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">图片由<a class="ae jt" href="https://pixabay.com/photos/ribblehead-viaduct-viaduct-bridge-2443085/" rel="noopener ugc nofollow" target="_blank">蒂姆希尔</a></figcaption></figure><h1 id="16ca" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">互操作性的含义是什么？</h1><p id="b415" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">在本文中，我们讨论了Kotlin与Java的互操作性，也就是说，当Kotlin被编译成目标Kotlin/JVM时。简而言之，</p><blockquote class="kx ky kz"><p id="ef2d" class="if ig la ih b ii ij ik il im in io ip lb ir is it lc iv iw ix ld iz ja jb jc hb bi translated">Kotlin和Java文件可以存在于同一个项目中，可以直接相互通信。你可以从Kotlin调用Java方法，从Java调用Kotlin函数。同样，你可以在Kotlin中使用Java的API和框架，反之亦然。</p></blockquote><h1 id="4bf1" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">默认参数(缺乏)互操作性</h1><p id="55cd" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">让我们来看看当我们用默认参数编译一个Kotlin函数时，在幕后发生了什么。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="le lf l"/></div></figure><p id="46d5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">将字节码反编译成Java，我们得到了不支持任何缺省参数的<code class="du lg lh li lj b">sample</code>的这个定义(为了清楚起见进行了简化):</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="le lf l"/></div></figure><p id="43b7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">注意，Kotlin版本的<code class="du lg lh li lj b">sample</code>有四种不同的调用方式:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="le lf l"/></div></figure><p id="7920" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然而，只有显式传递了所有两个参数，才能调用更详细的Java版本。也就是说，当从Java文件中调用Kotlin函数时，我们会得到:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="le lf l"/></div></figure><h1 id="2bbf" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">默认参数(更好的)互操作性</h1><p id="64e9" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">为了在更具体的情况下提供与Java更好的互操作性，JVM提供了几个注释来指导编译器如何编译Kotlin代码。例如，<code class="du lg lh li lj b">@JvmOverloads</code>的注解</p><blockquote class="kx ky kz"><p id="8580" class="if ig la ih b ii ij ik il im in io ip lb ir is it lc iv iw ix ld iz ja jb jc hb bi translated"><em class="hi">指示Kotlin编译器为给定函数生成替换默认参数值的重载。</em></p></blockquote><p id="0e97" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">实际上，这意味着通过向Kotlin函数添加<code class="du lg lh li lj b">@JvmOverloads</code>注释，您可以要求Kotlin编译器通过以不同方式重载该方法来尝试重现默认的参数行为。例如:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="le lf l"/></div></figure><p id="b7eb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在反编译成下面的方法重载。为了简单起见，我们抽象了使用合成方法的Java实现逻辑。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="le lf l"/></div></figure><p id="421a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">实际上，这意味着我们现在可以从Java调用，而不会出错:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="le lf l"/></div></figure><h1 id="b910" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">限制</h1><p id="2dd0" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">很好，我们了解到通过使用方法重载，Java能够与Kotlin的默认参数函数提供更好的互操作性。但是你可能已经注意到在上面的例子中仍然有一个缺失的案例。如果我们想用默认的<code class="du lg lh li lj b">a</code>参数和自定义的<code class="du lg lh li lj b">b</code>来调用<code class="du lg lh li lj b">sample</code>呢？</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="le lf l"/></div></figure><p id="52b3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这在Kotlin中是可能的，因为它支持<a class="ae jt" href="https://kotlinlang.org/docs/functions.html#named-arguments" rel="noopener ugc nofollow" target="_blank">命名参数</a>，但在Java中不支持。由于参数<code class="du lg lh li lj b">a</code>和<code class="du lg lh li lj b">b</code>都是类型<code class="du lg lh li lj b">String</code>，方法重载不能区分它们，所以我们不能用Java复制上面的调用。</p></div><div class="ab cl lk ll gp lm" role="separator"><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp"/></div><div class="hb hc hd he hf"><p id="6449" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">感谢阅读！如果你喜欢的内容，不要忘记鼓掌，并关注更多！</p></div></div>    
</body>
</html>