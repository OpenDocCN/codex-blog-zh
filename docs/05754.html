<html>
<head>
<title>Run your Docker containers for free in the cloud and for unlimited time</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在云中无限期免费运行Docker容器</h1>
<blockquote>原文：<a href="https://medium.com/codex/run-your-docker-containers-for-free-in-the-cloud-and-for-unlimited-time-361515cb0876?source=collection_archive---------0-----------------------#2022-03-27">https://medium.com/codex/run-your-docker-containers-for-free-in-the-cloud-and-for-unlimited-time-361515cb0876?source=collection_archive---------0-----------------------#2022-03-27</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/21c93fab597ee6b71faf2e697803022c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ik7kZM-hNgge3AwC.png"/></div></div></figure><p id="b706" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">拥有一个除了自己的机器之外的地方来运行docker容器会很方便。它有助于您加快个人项目的开发或减轻机器的繁重负担。</p><p id="f4ca" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最近有人向我介绍了<a class="ae jo" href="https://www.oracle.com/cloud/" rel="noopener ugc nofollow" target="_blank"> Oracle cloud </a>，以及它的无限期免费层。检查支持的<a class="ae jo" href="https://www.oracle.com/cloud/free/#always-free" rel="noopener ugc nofollow" target="_blank">永远免费服务</a>:</p><ul class=""><li id="416d" class="jp jq hi is b it iu ix iy jb jr jf js jj jt jn ju jv jw jx bi translated">2个基于AMD的计算虚拟机，每个具有1/8 OCPU**和1 GB内存</li><li id="35b0" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx bi translated">4个基于Arm的Ampere A1内核和24 GB内存可用作一个虚拟机或最多4个虚拟机</li><li id="612a" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx bi translated">2个数据块卷存储，总共200 GB</li><li id="c61b" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx bi translated">10 GB对象存储—标准</li><li id="e55e" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx bi translated">10 GB对象存储—不常访问</li><li id="ee96" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx bi translated">10 GB归档存储</li><li id="56e0" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx bi translated">资源管理器:托管地形</li><li id="7368" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx bi translated">5 OCI堡垒</li></ul><p id="dd36" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如您所见，他们对免费层非常慷慨，我们可以利用这一点做很多事情。</p><h2 id="ffdb" class="kd ke hi bd kf kg kh ki kj kk kl km kn jb ko kp kq jf kr ks kt jj ku kv kw kx bi translated">创建您的远程Docker服务</h2><ol class=""><li id="e365" class="jp jq hi is b it ky ix kz jb la jf lb jj lc jn ld jv jw jx bi translated">创建一个Oracle云基础设施帐户(只需点击<a class="ae jo" href="https://bit.ly/free-oci-dat-k8s-on-arm" rel="noopener ugc nofollow" target="_blank">此链接</a>)。</li><li id="ef9d" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ld jv jw jx bi translated"><a class="ae jo" href="https://learn.hashicorp.com/tutorials/terraform/install-cli?in=terraform/oci-get-started" rel="noopener ugc nofollow" target="_blank">安装地形</a>。</li><li id="b41c" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ld jv jw jx bi translated">安装OCI命令行界面。</li><li id="bc5b" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ld jv jw jx bi translated">配置<a class="ae jo" href="https://learn.hashicorp.com/tutorials/terraform/oci-build?in=terraform/oci-get-started" rel="noopener ugc nofollow" target="_blank"> OCI凭证</a>。</li></ol><p id="dddd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在您可能已经猜到了，我们将使用terraform来提供Docker服务。基本上，terraform将创建一个虚拟机实例，让它尽可能大，让它准备好，这样我们就可以ssh到机器中，并使用docker启动我们的容器。</p><p id="dd8d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">5.使用terraform配置签出<a class="ae jo" href="https://github.com/rafaelzimmermann/remote-docker" rel="noopener ugc nofollow" target="_blank"> remote-docker </a>项目，并输入其目录。</p><p id="8a1b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">6.运行<code class="du le lf lg lh b">terraform init</code>和<code class="du le lf lg lh b">terraform apply</code></p><p id="84d3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果您得到这样的错误:</p><p id="fb8b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du le lf lg lh b">timeout -- last error: dial tcp IP_ADDRESS:22: connect: connection refused</code></p><p id="d1cc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">尝试将terraform生成的id_rsa添加到您的ssh-agent ( <code class="du le lf lg lh b">ssh-add id_rsa</code>)中，并再次运行<code class="du le lf lg lh b">terraform apply</code>，id_rsa应该被本地化到项目的根目录中。</p><p id="fc2f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果您能够达到这一点，那么您现在已经有了一个虚拟机，您可以随心所欲地运行它(请查看Oracle关于此服务的条款和条件)。在流程的最后，terraform被配置为显示新创建的实例的公共IP。</p><p id="70f5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我喜欢做的是将这个添加到<code class="du le lf lg lh b">/etc/hosts</code>中，这样我就不需要通过IP地址调用它了。</p><p id="aec1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">使用ssh连接到远程服务器，并运行<code class="du le lf lg lh b">docker ps</code>来检查docker是否按预期运行。</p><h2 id="0b7c" class="kd ke hi bd kf kg kh ki kj kk kl km kn jb ko kp kq jf kr ks kt jj ku kv kw kx bi translated">部署您的容器</h2><p id="2c8f" class="pw-post-body-paragraph iq ir hi is b it ky iv iw ix kz iz ja jb li jd je jf lj jh ji jj lk jl jm jn hb bi translated">好了，现在你想从你的本地机器开始运行容器，但是出于某种原因你也在本地运行一些容器。因此，我们需要以一种容易在两种环境之间切换的方式来做这件事。</p><p id="c800" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Docker有一个嵌入在其客户端的工具，用于检查您可以运行的上下文:</p><p id="28c4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du le lf lg lh b">docker context ls</code></p><p id="be29" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们为远程docker服务创建一个上下文:</p><p id="164e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du le lf lg lh b">docker context create remote --docker "host=ssh://docker@IP_PROVIDED_BY_TERRAFORM</code></p><p id="1ef0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，如果您再次列出您的上下文，您应该会看到您新创建的上下文。下一步是在上下文之间切换:</p><p id="a3ee" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du le lf lg lh b">docker context use remote</code></p><p id="bb6c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，您可以运行通常在本地执行的任何命令。要检查它是否工作，请尝试部署一个nginx容器。</p><p id="6e82" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du le lf lg lh b">docker run -d -p 8080:80 nginx</code></p><p id="7d3a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这之后，你应该能够在你的浏览器上打开:<code class="du le lf lg lh b"><a class="ae jo" href="http://IP_PROVIDED_BY_TERRAFORM" rel="noopener ugc nofollow" target="_blank">http://IP_PROVIDED_BY_TERRAFORM</a>:8080</code>并且你应该看到docker的默认index.html。</p><h2 id="c00c" class="kd ke hi bd kf kg kh ki kj kk kl km kn jb ko kp kq jf kr ks kt jj ku kv kw kx bi translated">结论</h2><p id="6e4d" class="pw-post-body-paragraph iq ir hi is b it ky iv iw ix kz iz ja jb li jd je jf lj jh ji jj lk jl jm jn hb bi translated">这个项目无耻地基于<a class="ae jo" href="https://github.com/jpetazzo/ampernetacle" rel="noopener ugc nofollow" target="_blank">jérme Petazzoni项目</a>，其中他描述了如何使用免费层在Oracle基础设施上构建Kubernetes集群。他的项目非常有助于理解地形和库伯内特的构造。我强烈推荐你去看看。</p><p id="9419" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我从他的项目中衍生出这个产品，因为学习如何部署K8S集群是很棒的，但是把它放在身边对我来说并没有多大用处。Docker服务在你开发的时候有它更有用。</p><p id="bead" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我知道这有什么帮助，特别是当你的机器达到极限的时候</p><h2 id="1030" class="kd ke hi bd kf kg kh ki kj kk kl km kn jb ko kp kq jf kr ks kt jj ku kv kw kx bi translated">来源</h2><ul class=""><li id="5c1b" class="jp jq hi is b it ky ix kz jb la jf lb jj lc jn ju jv jw jx bi translated"><a class="ae jo" href="https://www.oracle.com/cloud/free/#always-free" rel="noopener ugc nofollow" target="_blank">https://www.oracle.com/cloud/free/#always-free</a></li><li id="a684" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx bi translated">创建自己的Kubernetes集群:<a class="ae jo" href="https://github.com/jpetazzo/ampernetacle" rel="noopener ugc nofollow" target="_blank">https://github.com/jpetazzo/ampernetacle</a></li></ul></div></div>    
</body>
</html>