<html>
<head>
<title>Making Word Cloud of Tweets Using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python制作Tweets的单词云</h1>
<blockquote>原文：<a href="https://medium.com/codex/making-wordcloud-of-tweets-using-python-ca114b7a4ef4?source=collection_archive---------1-----------------------#2021-05-29">https://medium.com/codex/making-wordcloud-of-tweets-using-python-ca114b7a4ef4?source=collection_archive---------1-----------------------#2021-05-29</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="6eb8" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">一篇关于从包含特定标签(如#SpaceX)的推文中生成词云的帖子</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/11c226dcf81f2ac3f683c4d7c81318eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1wmnT0sS4p1ViypQ9vAzXg.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">用#SpaceX发布的文字云</figcaption></figure><p id="b0f1" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">Word Cloud是一款流行的可视化工具，用于可视化文本数据。根据单词在语料库中出现的频率来确定它们的大小，并以随机顺序排列。Word Cloud提供了关于文本语料库内部内容的快速而肮脏的洞察。</p><p id="f127" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">众所周知，Twitter是一个微博客网站，以实时快速更新正在发生的事情而闻名。Word Cloud可用于获得Twitter上提到的单词以及特定标签或关键字的概述。我们能想到的一个词云可视化的快速用例是，品牌可以跟踪他们的客户对他们的评价。</p></div><div class="ab cl kj kk gp kl" role="separator"><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko"/></div><div class="hb hc hd he hf"><h1 id="7d3b" class="kq kr hi bd ks kt ku kv kw kx ky kz la io lb ip lc ir ld is le iu lf iv lg lh bi translated"><strong class="ak">抓取并下载推文:</strong></h1><p id="a5bc" class="pw-post-body-paragraph jn jo hi jp b jq li ij js jt lj im jv jw lk jy jz ka ll kc kd ke lm kg kh ki hb bi translated">在这篇文章中，我们将从包含#SpaceX标签的推文中创建一个词云。您可以使用任何标签或关键字。</p><p id="c16a" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">导入所需的库:</p><pre class="iy iz ja jb fd ln lo lp lq aw lr bi"><span id="fb60" class="ls kr hi lo b fi lt lu l lv lw">import tweepy<br/>import pandas as pd</span></pre><p id="3a2b" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><a class="ae lx" href="https://docs.tweepy.org/en/latest/index.html" rel="noopener ugc nofollow" target="_blank"> <em class="ly"> Tweepy </em> </a> <em class="ly">是一个易于使用的Python库，用于访问Twitter API。</em></p><p id="fc00" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">使用Tweepy，我们将从Twitter中抓取推文。要使用Tweepy，我们需要Twitter开发人员证书。申请<a class="ae lx" href="https://developer.twitter.com/en" rel="noopener ugc nofollow" target="_blank">此处</a>为开发者账户。你会被问到关于目的的问题。审批过程可能需要几天时间。获得批准后，在dashboard中设置开发环境，并转到应用程序的“密钥和令牌”选项卡以检索开发人员凭据— <em class="ly">消费者API密钥、消费者API密钥、访问令牌和访问令牌密钥</em>。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lz"><img src="../Images/bf590442ce78f9b40a8b754a5089467a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ej_IdS2HG8hyL_lr2TuVNQ.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">Twitter上的开发者证书页面</figcaption></figure><p id="83d5" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">现在你有了开发人员证书，你需要向Twitter申请授权来使用他们的数据。下面的代码片段完成了这项工作:</p><pre class="iy iz ja jb fd ln lo lp lq aw lr bi"><span id="2f14" class="ls kr hi lo b fi lt lu l lv lw">consumer_key = "Enter your consumer key" <strong class="lo hj"><em class="ly">#Enter your key as string</em></strong><br/>consumer_secret = "Enter your consumer key secret"<br/>access_token = "Enter your access token"<br/>access_token_secret = "Enter your access token secret"</span><span id="03f3" class="ls kr hi lo b fi ma lu l lv lw">auth = tweepy.OAuthHandler(consumer_key, consumer_secret)<br/>auth.set_access_token(access_token, access_token_secret)<br/>api = tweepy.API(auth, wait_on_rate_limit=True)</span></pre><p id="2214" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">我们将使用<a class="ae lx" href="https://towardsdatascience.com/how-to-scrape-tweets-from-twitter-59287e20f0f1" rel="noopener" target="_blank"> keyword_to_csv() </a>方法来抓取与所需关键字相关的推文，并将其保存到一个csv文件中。首先使用<em class="ly"> tweepy创建一个查询方法。Cursor() </em>方法输入我们的关键字作为参数。接下来，从iterable对象“tweets”中提取与twitter文本相关的信息，并将其保存在<em class="ly"> tweets_list </em>中。然后从<em class="ly"> tweets_list </em>创建一个熊猫数据框架。当调用这个方法时，将使用抓取的tweets创建一个csv文件。</p><pre class="iy iz ja jb fd ln lo lp lq aw lr bi"><span id="232d" class="ls kr hi lo b fi lt lu l lv lw">def <strong class="lo hj">keyword_to_csv(keyword,recent)</strong>:<br/>    <strong class="lo hj">try:</strong><br/>        <strong class="lo hj">tweets</strong> = tweepy.Cursor(api.search,q=keyword).items(recent) <em class="ly">#creates query method</em></span><span id="181e" class="ls kr hi lo b fi ma lu l lv lw">        <strong class="lo hj">tweets_list</strong> = [[tweet.text] for tweet in tweets] <br/><em class="ly">#pulls text information from tweets</em></span><span id="9c2d" class="ls kr hi lo b fi ma lu l lv lw">        <strong class="lo hj">df</strong> = pd.DataFrame(tweets_list,columns=['Text']) <br/><em class="ly">#creates a pandas dataframe</em></span><span id="2739" class="ls kr hi lo b fi ma lu l lv lw"><strong class="lo hj">        df.to_csv</strong>('{}.csv'.format(keyword), sep=',', index = False) <br/> <em class="ly">#creates a csv from data frame</em></span><span id="30c1" class="ls kr hi lo b fi ma lu l lv lw">    <strong class="lo hj">except</strong> BaseException as e:<br/>        print('failed on_status,',str(e))<br/>        time.sleep(3)</span></pre><p id="e1fb" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">我们现在有兴趣抓取最近3000条带有#SpaceX标签的推文，转发将被排除在外。</p><pre class="iy iz ja jb fd ln lo lp lq aw lr bi"><span id="c434" class="ls kr hi lo b fi lt lu l lv lw">keyword = 'SpaceX'+ " -filter:retweets" <em class="ly">#excludes retweets</em><br/>recent  = 3000<br/>keyword_to_csv(keyword, recent)</span></pre><p id="fb57" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">一个包含标签的csv文件(<em class="ly"># spacex-filter:retweets . CSV</em>)将被下载到你的路径中。</p></div><div class="ab cl kj kk gp kl" role="separator"><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko"/></div><div class="hb hc hd he hf"><h1 id="2893" class="kq kr hi bd ks kt ku kv kw kx ky kz la io lb ip lc ir ld is le iu lf iv lg lh bi translated">数据清理:</h1><p id="46cc" class="pw-post-body-paragraph jn jo hi jp b jq li ij js jt lj im jv jw lk jy jz ka ll kc kd ke lm kg kh ki hb bi translated">我们需要在用我们的推文制作文字云之前清理我们的数据。首先将生成的csv文件加载到pandas dataframe中。</p><pre class="iy iz ja jb fd ln lo lp lq aw lr bi"><span id="afd3" class="ls kr hi lo b fi lt lu l lv lw">df = pd.read_csv("./#spacex-filter:retweets.csv") <em class="ly">#loads csv file into pandas dataframe</em></span><span id="497d" class="ls kr hi lo b fi ma lu l lv lw">pd.options.display.max_colwidth = 200 </span><span id="f8b8" class="ls kr hi lo b fi ma lu l lv lw">df.head() <em class="ly">#prints out first few columns in a dataframe</em></span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mb"><img src="../Images/8d53291022b35f3dd412871723338c6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JjCup_jqcg3JuTgskMVu0A.png"/></div></div></figure><pre class="iy iz ja jb fd ln lo lp lq aw lr bi"><span id="61af" class="ls kr hi lo b fi lt lu l lv lw"><strong class="lo hj">df.shape</strong> <em class="ly">#prints the shape of dataframe</em></span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mc"><img src="../Images/65af493e53d36042242744405ccd4aa8.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*z024NqkifWjkrWa2cOZATQ.png"/></div></figure><p id="5c9b" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">然后，我们将分四步清理加载到pandas dataframe中的数据。</p><p id="5b43" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><strong class="jp hj">步骤1:删除表情符号和符号</strong></p><p id="4102" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">表情符号、符号等。将使用Python中的<a class="ae lx" href="https://www.youtube.com/watch?v=K8L6KVGG-7o&amp;t=2408s" rel="noopener ugc nofollow" target="_blank">正则表达式</a>移除。</p><pre class="iy iz ja jb fd ln lo lp lq aw lr bi"><span id="f501" class="ls kr hi lo b fi lt lu l lv lw">a = df.loc[1272].to_string() #loads the row from dataframe<br/>print(a)</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es md"><img src="../Images/25cdfe371cb495e7c1c44303c496b8a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RuLN8bg87DVtI1LUGwtiRw.png"/></div></div></figure><p id="6c97" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">下面的<a class="ae lx" href="https://stackoverflow.com/questions/33404752/removing-emojis-from-a-string-in-python" rel="noopener ugc nofollow" target="_blank">图案</a>将删除文本中的大部分表情符号和符号。</p><pre class="iy iz ja jb fd ln lo lp lq aw lr bi"><span id="36ce" class="ls kr hi lo b fi lt lu l lv lw">regex_pattern = re.compile(pattern = "["<br/>        u"\U0001F600-\U0001F64F"  # emoticons<br/>        u"\U0001F300-\U0001F5FF"  # symbols &amp; pictographs<br/>        u"\U0001F680-\U0001F6FF"  # transport &amp; map symbols<br/>        u"\U0001F1E0-\U0001F1FF"  # flags (iOS)<br/>                           "]+", flags = re.UNICODE)</span><span id="f87a" class="ls kr hi lo b fi ma lu l lv lw">match = re.sub(regex_pattern,'',a) <em class="ly">#replaces pattern with ''</em><br/>print(match)</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es me"><img src="../Images/64b6ce1665bdc79932722fe516b4309c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*beN602iuH9Gydm41E5cg5w.png"/></div></div></figure><p id="a74b" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><strong class="jp hj">第二步:删除网址</strong></p><pre class="iy iz ja jb fd ln lo lp lq aw lr bi"><span id="2857" class="ls kr hi lo b fi lt lu l lv lw">a = df.loc[0].to_string()<br/>print(a)</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mf"><img src="../Images/fd624d69f19dc8dd571d1b093b884304.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JsMS_NBgFbFzfPGTyJWjOA.png"/></div></div></figure><p id="b093" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">下面的代码块从文本中删除了URL。</p><pre class="iy iz ja jb fd ln lo lp lq aw lr bi"><span id="94e4" class="ls kr hi lo b fi lt lu l lv lw">pattern = re.compile(r'(https?://)?(www\.)?(\w+\.)?(\w+)(\.\w+)(/.+)?')<br/>match = re.sub(pattern,'',a)<br/>print(match)</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mg"><img src="../Images/c93a422b494507060595f1f777f7275a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s1KtI19zgKDtCUGRLLMX-w.png"/></div></div></figure><p id="8fff" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><strong class="jp hj">步骤3:删除@提及和散列符号</strong></p><pre class="iy iz ja jb fd ln lo lp lq aw lr bi"><span id="376d" class="ls kr hi lo b fi lt lu l lv lw">a = df.loc[3].to_string()<br/>print(a)</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mh"><img src="../Images/dd089b9daa7d6b33f3ba8a9c2ad54a31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0Kk8fNA0HsEQUZZy31f1JA.png"/></div></div></figure><p id="3ef1" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">下面的块从文本中删除了@ references和hashes。</p><pre class="iy iz ja jb fd ln lo lp lq aw lr bi"><span id="e9b6" class="ls kr hi lo b fi lt lu l lv lw">re_list = [’@[A-Za-z0–9_]+’, '#']<br/>combined_re = re.compile( '|'.join( re_list) )<br/>match = re.sub(combined_re,’’,a)<br/>print(match)</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mi"><img src="../Images/15db857134d5ec39204b41a2a98069be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LZfBb2N3L6eZG7YI4c9TAA.png"/></div></div></figure><p id="3279" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><strong class="jp hj">步骤4: HTML到文本</strong></p><p id="1e0a" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">当HTML编码没有转换成文本时，我们会在文本中看到&amp;amp，&amp;quot，\n等字符。为了转换成文本，我们将使用<a class="ae lx" href="https://www.youtube.com/watch?v=ng2o98k983k&amp;t=1185s" rel="noopener ugc nofollow" target="_blank"> BeautifulSoup </a>来实现。</p><pre class="iy iz ja jb fd ln lo lp lq aw lr bi"><span id="4714" class="ls kr hi lo b fi lt lu l lv lw"><strong class="lo hj">from bs4 import BeautifulSoup</strong></span><span id="a640" class="ls kr hi lo b fi ma lu l lv lw">a = df.loc[27].to_string()<br/>print(a)</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mj"><img src="../Images/075487ce40667d502a132bbf28ee3d86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CIqHSMUyX1x5E8G6kCWwhQ.png"/></div></div></figure><p id="aaf9" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">下面的块将从文本中删除html字符。</p><pre class="iy iz ja jb fd ln lo lp lq aw lr bi"><span id="b588" class="ls kr hi lo b fi lt lu l lv lw">del_amp = BeautifulSoup(a, 'lxml')<br/>del_amp_text = del_amp.get_text()<br/>print(del_amp_text)</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mk"><img src="../Images/ef728bf01877c1fd1c39861ef6d4c45b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ct004XwVklVb0BZzR-p4Rw.png"/></div></div></figure><p id="0fa4" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">现在我们将所有这些步骤聚合成一个函数<a class="ae lx" href="https://github.com/tthustla" rel="noopener ugc nofollow" target="_blank"> cleaning_tweets() </a>。<strong class="jp hj"> <em class="ly"> </em> </strong>此外，我们将对单词进行分词，以去除空格。此外，所有的单词都将被转换成小写，以避免类似“猎鹰”&amp;“猎鹰”出现在单词云中。我们也将只考虑那些至少有三个字符的单词。</p><pre class="iy iz ja jb fd ln lo lp lq aw lr bi"><span id="bd41" class="ls kr hi lo b fi lt lu l lv lw">from bs4 import BeautifulSoup<br/>from nltk.tokenize import WordPunctTokenizer<br/>token = WordPunctTokenizer()</span><span id="08a4" class="ls kr hi lo b fi ma lu l lv lw">def cleaning_tweets(t):<br/>    del_amp = BeautifulSoup(t, 'lxml')<br/>    del_amp_text = del_amp.get_text()<br/>    del_link_mentions = re.sub(combined_re, '', del_amp_text)<br/>    del_emoticons = re.sub(regex_pattern, '', del_link_mentions)<br/>    lower_case = del_emoticons.lower()<br/>    words = token.tokenize(lower_case)<br/>    result_words = [x for x in words if len(x) &gt; 2]<br/>    return (" ".join(result_words)).strip()</span></pre><p id="0ff9" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">现在将数据帧传递给我们的函数，并清理文本。该函数将返回一个清理过的tweets列表。您可以在输出窗口中看到进程的进度。</p><pre class="iy iz ja jb fd ln lo lp lq aw lr bi"><span id="ed6f" class="ls kr hi lo b fi lt lu l lv lw">print("Cleaning the tweets...\n")<br/>cleaned_tweets = []<br/>for i in range(0,3000): <em class="ly">#3000 columns in our dataframe</em><br/>    if( (i+1)%100 == 0 ):<br/>        print("Tweets {} of {} have ben processed".format(i+1,3000))                                                                  <br/>    cleaned_tweets.append(cleaning_tweets((df.Text[i])))</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ml"><img src="../Images/a3cd93df0cdaadc6a4cbe008a454d78e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QinRt2IJ9obzqLddLxSYzw.png"/></div></div></figure><p id="1f60" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">接下来我们将使用<em class="ly">熊猫。Series.str.cat() </em>将列表中的字符串串联起来c<em class="ly">lean _ tweets</em>用' '隔开。</p><pre class="iy iz ja jb fd ln lo lp lq aw lr bi"><span id="9f6e" class="ls kr hi lo b fi lt lu l lv lw">string = pd.Series(cleaned_tweets).str.cat(sep=' ')</span></pre></div><div class="ab cl kj kk gp kl" role="separator"><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko"/></div><div class="hb hc hd he hf"><h1 id="d28c" class="kq kr hi bd ks kt ku kv kw kx ky kz la io lb ip lc ir ld is le iu lf iv lg lh bi translated">生成单词云:</h1><p id="dd26" class="pw-post-body-paragraph jn jo hi jp b jq li ij js jt lj im jv jw lk jy jz ka ll kc kd ke lm kg kh ki hb bi translated">在这最后一节，我们将使用python的<a class="ae lx" href="https://github.com/amueller/word_cloud" rel="noopener ugc nofollow" target="_blank"> <em class="ly"> wordcloud </em> </a>库来生成tweets的wordcloud。</p><p id="296e" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">停用词是英语中常见的词，如“the”、“a”、“an”、“in”…这些词对句子没有多大意义。这些词在自然语言处理任务中被忽略。我们可以根据需要添加自己的停用词。我们知道，像“埃隆马斯克”、“埃隆马斯克”、“埃隆”、“马斯克”……这样的词在带有标签<em class="ly"> #SpaceX </em>的推文中会很常见。所以我们将它们添加到停用词列表中，它们就不会出现在词云中。</p><pre class="iy iz ja jb fd ln lo lp lq aw lr bi"><span id="ad48" class="ls kr hi lo b fi lt lu l lv lw">from wordcloud import WordCloud, STOPWORDS<br/>import matplotlib.pyplot as plt</span><span id="e967" class="ls kr hi lo b fi ma lu l lv lw">stopwords = set(STOPWORDS)</span><span id="6d9e" class="ls kr hi lo b fi ma lu l lv lw">stopwords.update(["elonmusk","elon musk","elon","musk","spacex"]) <em class="ly">#adding our own stopwords</em></span></pre><p id="8192" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在<em class="ly"> WordCloud() </em>函数中，我们可以根据需要传递参数。</p><p id="178f" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><em class="ly"> max_words: </em>默认值为200字；建议使用50-100个单词，这样我们的单词云才会清晰易读。</p><p id="67c8" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><em class="ly">搭配:</em>默认值为<em class="ly">真值为</em>。我们将选择<em class="ly">假</em>来避免单词的二元模型<em class="ly">。</em></p><p id="88c1" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><em class="ly">背景颜色:</em>使用任何你想要的颜色，如“蓝色”、“绿色”、“灰色”…黑色是默认值。</p><p id="1c73" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">最后，我们用这段代码生成单词云。您可以使用<em class="ly"> WordCloud() </em>函数中的参数来生成不同颜色和大小的云。</p><pre class="iy iz ja jb fd ln lo lp lq aw lr bi"><span id="cec7" class="ls kr hi lo b fi lt lu l lv lw">wordcloud = WordCloud(width=1600, stopwords=stopwords,height=800,max_font_size=200,max_words=50,collocations=False, background_color='black').generate(string)<br/>plt.figure(figsize=(40,30))<br/>plt.imshow(wordcloud, interpolation="bilinear")<br/>plt.axis("off")<br/>plt.show()</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mm"><img src="../Images/fc52884b9b826fdb75c7d51830684de1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9E2Ky33pufYGK_K-6FNx8Q.png"/></div></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mm"><img src="../Images/471f633b7f23edcecb6fc4e00df2497c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ysR_oNFmOBT-N4SRrVOK_w.png"/></div></div></figure><p id="0364" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">看着上面的云，我们可以看到#SpaceX提到了哪些词——starlink、space、nasa、falcon9等。单词越大，它们在推特上出现的频率就越高。</p></div><div class="ab cl kj kk gp kl" role="separator"><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko"/></div><div class="hb hc hd he hf"><h1 id="7f79" class="kq kr hi bd ks kt ku kv kw kx ky kz la io lb ip lc ir ld is le iu lf iv lg lh bi translated"><strong class="ak">自定义字云:</strong></h1><p id="86a3" class="pw-post-body-paragraph jn jo hi jp b jq li ij js jt lj im jv jw lk jy jz ka ll kc kd ke lm kg kh ki hb bi translated">我们可以用<em class="ly"> WordCloud()中的附加参数<em class="ly"> mask </em>生成自定义的词云。</em></p><p id="b74a" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在你的路径中上传你自己的图片，下面的代码会完成剩下的工作。这对于白色背景的图像效果最好。你可以看到一些样本图像和相应的云。</p><pre class="iy iz ja jb fd ln lo lp lq aw lr bi"><span id="93f1" class="ls kr hi lo b fi lt lu l lv lw">import numpy as np<br/>from PIL import Image</span><span id="6ce5" class="ls kr hi lo b fi ma lu l lv lw">mask = np.array(Image.open('./your_image.jpg'))<strong class="lo hj"><br/>wordcloud = WordCloud(</strong>width=1600, mask =   mask,stopwords=stopwords,height=800,max_font_size=200,max_words=50,collocations=False<strong class="lo hj">)</strong>.<strong class="lo hj">generate(string)</strong></span><span id="bd08" class="ls kr hi lo b fi ma lu l lv lw">f = plt.figure(figsize=(50,50))<br/>f.add_subplot(1,2, 1)<br/>plt.imshow(mask, cmap=plt.cm.gray, interpolation='bilinear')<br/>plt.title('Original Image', size=40)<br/>plt.axis("off")<br/>f.add_subplot(1,2, 2)<br/>plt.imshow(wordcloud, interpolation='bilinear')<br/>plt.title('Generated Word Cloud', size=40)<br/>plt.axis("off")<br/>plt.show()</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mn"><img src="../Images/3561e026fd5af3f4a3bf7ae64a3c03a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B3muyJyuGgzH27TA7v8OQQ.png"/></div></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mn"><img src="../Images/88b68c09d2befa98413a139f8470ece3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*go6D39x6gJEAvRsPUmaabA.png"/></div></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mn"><img src="../Images/e50f5768959b7992d57a270c0da6e99a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Hx31vi_MT5KhI_poMhvKLQ.png"/></div></div></figure><p id="25e4" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">包含代码的Jupyter笔记本的链接可以在<a class="ae lx" href="https://github.com/vijayv500/Machine-Learning" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p></div></div>    
</body>
</html>