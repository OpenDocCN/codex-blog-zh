<html>
<head>
<title>Full Stack App Development /w Flutter, NodeJs, MySQL and Heroku</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">全栈应用开发/w Flutter、NodeJs、MySQL和Heroku</h1>
<blockquote>原文：<a href="https://medium.com/codex/full-stack-app-development-w-flutter-nodejs-mysql-and-heroku-caeba4671107?source=collection_archive---------4-----------------------#2022-06-03">https://medium.com/codex/full-stack-app-development-w-flutter-nodejs-mysql-and-heroku-caeba4671107?source=collection_archive---------4-----------------------#2022-06-03</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/657923ac4d39698af652754b78df8a33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I1wFSXhsHeZbvFeHIBlVaw.png"/></div></div></figure><p id="05be" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">你好！这是我第一篇关于媒介的文章。本文的目标是总结全栈应用的所有阶段。另一个目标是帮助Flutter开发者向后端开发迈进一步。首先，我们将创建一个应用程序与Flutter在一起。然后，我们将使用NodeJS创建一个服务器应用程序，并连接到一个远程MySQL数据库。最后，我们将在Heroku上部署我们的服务器应用。开始吧！</p><h2 id="103b" class="jo jp hi bd jq jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki bi translated">1.创建Flutter应用程序</h2><p id="2ec6" class="pw-post-body-paragraph iq ir hi is b it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj kn jl jm jn hb bi translated"><em class="ko"> 1.1。main.dart </em></p><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="d0e9" class="jo jp hi ku b fi ky kz l la lb">void main() {<br/>  runApp(const FullStackExampleApp());<br/>}</span><span id="0525" class="jo jp hi ku b fi lc kz l la lb">class FullStackExampleApp extends StatelessWidget {<br/>  const FullStackExampleApp({Key? key}) : super(key: key);</span><span id="c6df" class="jo jp hi ku b fi lc kz l la lb">  @override<br/>  Widget build(BuildContext context) {<br/>    return MaterialApp(<br/>      title: 'Flutter Full Stack Example',<br/>      debugShowCheckedModeBanner: false,<br/>      theme: ThemeData(<br/>        primarySwatch: Colors.amber,<br/>      ),<br/>      home: const HomePage(),<br/>    );<br/>  }<br/>}</span></pre><p id="8a96" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="ko"> 1.2.1。home_page.dart(主要代码)</em></p><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="4b62" class="jo jp hi ku b fi ky kz l la lb">class HomePage extends StatefulWidget {<br/>  const HomePage({<br/>    Key? key,<br/>  }) : super(key: key);</span><span id="b017" class="jo jp hi ku b fi lc kz l la lb">  @override<br/>  State&lt;HomePage&gt; createState() =&gt; _HomePageState();<br/>}</span><span id="2f01" class="jo jp hi ku b fi lc kz l la lb">class _HomePageState extends State&lt;HomePage&gt; {<br/>  final _network = Network();</span><span id="caf1" class="jo jp hi ku b fi lc kz l la lb">  late TextEditingController _nameController;<br/>  late TextEditingController _surNameController;</span><span id="992c" class="jo jp hi ku b fi lc kz l la lb">  String buttonText = 'Save';<br/>  int? id;</span><span id="51d4" class="jo jp hi ku b fi lc kz l la lb">  @override<br/>  void initState() {<br/>    _nameController = TextEditingController();<br/>    _surNameController = TextEditingController();<br/>    super.initState();<br/>  }</span><span id="8621" class="jo jp hi ku b fi lc kz l la lb">  @override<br/>  void dispose() {<br/>   _nameController.dispose();<br/>   _surNameController.dispose();<br/>   super.dispose();<br/>}</span><span id="9fdf" class="jo jp hi ku b fi lc kz l la lb">  @override<br/>  Widget build(BuildContext context) {<br/>    return GestureDetector(<br/>      onTap: () {<br/>        unFocus(context);<br/>      },<br/>      child: Scaffold(<br/>        resizeToAvoidBottomInset: false,<br/>        appBar: appBar,<br/>        body: body,<br/>        floatingActionButton: fabAction(context),<br/>      ),<br/>    );<br/>  }<br/>}</span></pre><p id="8c0d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="ko"> 1.2.2。将其他代码添加到_HomePageState类</em></p><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="96e0" class="jo jp hi ku b fi ky kz l la lb">  void unFocus(BuildContext context) {<br/>    FocusScopeNode scope = FocusScope.of(context);<br/>    if (scope.hasFocus) scope.unfocus();<br/>  }</span><span id="c0a2" class="jo jp hi ku b fi lc kz l la lb">  FloatingActionButton fabAction(BuildContext context) {<br/>    return FloatingActionButton.extended(<br/>      onPressed: () {<br/>        seeAll(context);<br/>      },<br/>      label: Row(<br/>        children: const [<br/>          Icon(Icons.person),<br/>          Text('See All'),<br/>        ],<br/>      ),<br/>    );<br/>  }</span><span id="d7ec" class="jo jp hi ku b fi lc kz l la lb">  AppBar get appBar {<br/>    return AppBar(<br/>      title: const Text('Full Stack Example'),<br/>      centerTitle: true,<br/>    );<br/>  }</span><span id="79ec" class="jo jp hi ku b fi lc kz l la lb">  Center get body {<br/>    return Center(<br/>      child: Padding(<br/>        padding: const EdgeInsets.symmetric(horizontal: 18.0),<br/>        child: Column(<br/>          mainAxisAlignment: MainAxisAlignment.center,<br/>          children: [<br/>            TextFormField(<br/>              controller: _nameController,<br/>              maxLength: 45,<br/>              decoration: const InputDecoration(<br/>                labelText: 'Name',<br/>              ),<br/>            ),<br/>            TextFormField(<br/>              controller: _surNameController,<br/>              maxLength: 45,<br/>              decoration: const InputDecoration(<br/>                labelText: 'Surname',<br/>              ),<br/>            ),<br/>            ElevatedButton(<br/>              onPressed: saveButtonAction,<br/>              child: Text(buttonText),<br/>            ),<br/>            const SizedBox(<br/>              height: 50,<br/>            ),<br/>          ],<br/>        ),<br/>      ),<br/>    );<br/>  }</span><span id="600b" class="jo jp hi ku b fi lc kz l la lb">  void seeAll(BuildContext context) async {<br/>    await showModalBottomSheet(<br/>      elevation: 10,<br/>      backgroundColor: Colors.amber,<br/>      context: context,<br/>      builder: (c) {<br/>        return FutureBuilder&lt;List&lt;Person&gt;?&gt;(<br/>          future: _network.read,<br/>          builder: (c, s) {<br/>            return Container(<br/>              width: MediaQuery.of(context).size.width,<br/>              height: MediaQuery.of(context).size.width * 0.8,<br/>              color: Colors.amber,<br/>              child: allPersons(s),<br/>            );<br/>          },<br/>        );<br/>      },<br/>    );<br/>  }</span><span id="3eab" class="jo jp hi ku b fi lc kz l la lb">  Widget allPersons(AsyncSnapshot&lt;List&lt;Person&gt;?&gt; s) {<br/>    if (!s.hasData) {<br/>      return const Center(<br/>        child: SizedBox(<br/>          width: 50,<br/>          height: 50,<br/>          child: CircularProgressIndicator(),<br/>        ),<br/>      );<br/>    } else {<br/>      return ListView.builder(<br/>        physics: const BouncingScrollPhysics(),<br/>        itemCount: s.data!.length,<br/>        itemBuilder: (c, i) {<br/>          return PersonCard(<br/>            person: s.data![i],<br/>            delete: () {<br/>              setState(() {});<br/>            },<br/>            update: () {<br/>              setState(<br/>                () {<br/>                  buttonText = 'Update';<br/>                  Person p = s.data![i];<br/>                  id = p.id;<br/>                  _nameController.text = p.name;<br/>                  _surNameController.text = p.surName;<br/>                },<br/>              );<br/>            },<br/>          );<br/>        },<br/>      );<br/>    }<br/>  }</span><span id="ae57" class="jo jp hi ku b fi lc kz l la lb">   Future&lt;void&gt; saveButtonAction() async {<br/>    switch (buttonText) {<br/>      case 'Update':<br/>        await updateAction();<br/>        break;<br/>      default:<br/>        await saveAction();<br/>    }<br/>    _nameController.clear();<br/>    _surNameController.clear();<br/>    setState(() {<br/>      buttonText = 'Save';<br/>    });<br/>  }</span><span id="8184" class="jo jp hi ku b fi lc kz l la lb">  bool get condition {<br/>    bool c1 = _nameController.text.isNotEmpty;<br/>    bool c2 = _surNameController.text.isNotEmpty;<br/>    bool condition = c1 &amp;&amp; c2;<br/>    return condition;<br/>  }</span><span id="c46d" class="jo jp hi ku b fi lc kz l la lb">  Future&lt;void&gt; updateAction() async {<br/>    if (condition) {<br/>      var p = Person(<br/>        name: _nameController.text,<br/>        surName: _surNameController.text,<br/>        id: id,<br/>      );<br/>      await _network.update(p);<br/>      await dialog('${p.name} ${p.surName} updated.');<br/>    } else {<br/>      await dialog('Fields cannot be empty.');<br/>    }<br/>  }</span><span id="eb4c" class="jo jp hi ku b fi lc kz l la lb">  Future&lt;void&gt; saveAction() async {<br/>    if (condition) {<br/>      var p = Person(<br/>        name: _nameController.text,<br/>        surName: _surNameController.text,<br/>        id: null,<br/>      );<br/>      bool c = await _network.check(p);<br/>      if (c) {<br/>        await _network.write(p);<br/>        await dialog(<br/>          '${p.name} ${p.surName} saved',<br/>        );<br/>      } else {<br/>        await dialog(<br/>          '${p.name} ${p.surName} already exist',<br/>        );<br/>      }<br/>    } else {<br/>      await dialog('Fields cannot be empty.');<br/>    }<br/>  }</span><span id="0a37" class="jo jp hi ku b fi lc kz l la lb">  Future&lt;void&gt; dialog(<br/>    String message,<br/>  ) async {<br/>    return await showDialog(<br/>      context: context,<br/>      builder: (c) {<br/>        return Dialog(<br/>          child: Padding(<br/>            padding: const EdgeInsets.all(18.0),<br/>            child: Text(message),<br/>          ),<br/>        );<br/>      },<br/>    );<br/>  }</span></pre><p id="eb9c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="ko"> 1.3。person_card.dart(个人卡片小工具)</em></p><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="6cfc" class="jo jp hi ku b fi ky kz l la lb">import 'package:flutter/cupertino.dart';<br/>import 'package:flutter/material.dart';</span><span id="8f1b" class="jo jp hi ku b fi lc kz l la lb">import 'model.dart';<br/>import 'network.dart';</span><span id="4270" class="jo jp hi ku b fi lc kz l la lb">class PersonCard extends StatelessWidget {<br/>  const PersonCard({<br/>    Key? key,<br/>    required this.person,<br/>    required this.delete,<br/>    required this.update,<br/>  }) : super(key: key);</span><span id="e51f" class="jo jp hi ku b fi lc kz l la lb">  final VoidCallback delete;<br/>  final VoidCallback update;<br/>  final Person person;</span><span id="3607" class="jo jp hi ku b fi lc kz l la lb">  @override<br/>  Widget build(BuildContext context) {<br/>    return Card(<br/>      margin: const EdgeInsets.all(8),<br/>      color: Colors.white70,<br/>      child: Padding(<br/>        padding: const EdgeInsets.all(8.0),<br/>        child: Row(<br/>          children: [<br/>            Expanded(<br/>              child: Column(<br/>                crossAxisAlignment: CrossAxisAlignment.stretch,<br/>                children: [<br/>                  Text('ID: ${person.id}'),<br/>                  Text('Name: ${person.name}'),<br/>                  Text('Surname: ${person.surName}'),<br/>                ],<br/>              ),<br/>            ),<br/>            Column(<br/>              children: [<br/>                IconButton(<br/>                  constraints: const BoxConstraints(),<br/>                  padding: EdgeInsets.zero,<br/>                  onPressed: () {<br/>                    update();<br/>                    Navigator.pop(context);<br/>                  },<br/>                  icon: const Icon(<br/>                    CupertinoIcons.arrow_clockwise_circle,<br/>                  ),<br/>                ),<br/>                const SizedBox(<br/>                  height: 8,<br/>                ),<br/>                IconButton(<br/>                  constraints: const BoxConstraints(),<br/>                  padding: EdgeInsets.zero,<br/>                  onPressed: () async {<br/>                    await Network()<br/>                               .delete(person)<br/>                               .whenComplete(delete);<br/>                  },<br/>                  icon: const Icon(<br/>                    CupertinoIcons.delete,<br/>                  ),<br/>                ),<br/>              ],<br/>            ),<br/>          ],<br/>        ),<br/>      ),<br/>    );<br/>  }<br/>}</span></pre><p id="1cec" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="ko"> 1.4。model.dart(对象模型)</em></p><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="19db" class="jo jp hi ku b fi ky kz l la lb">class Person {<br/>  final String name;<br/>  final String surName;<br/>  final int? id;</span><span id="dd6a" class="jo jp hi ku b fi lc kz l la lb">Person({<br/>    required this.name,<br/>    required this.surName,<br/>    required this.id,<br/>  });</span><span id="c69c" class="jo jp hi ku b fi lc kz l la lb">factory Person.fromJson(Map&lt;String, dynamic&gt; json) {<br/>    return Person(<br/>      id: json["id"],<br/>      name: json["name"],<br/>      surName: json["surName"],<br/>    );<br/>  }</span><span id="60d4" class="jo jp hi ku b fi lc kz l la lb">Map&lt;String, dynamic&gt; get toJson =&gt; {<br/>        "id": id.toString(),<br/>        "name": name,<br/>        "surName": surName,<br/>      };<br/>}</span></pre><p id="6fe3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="ko"> 1.5。network.dart(需要从服务器获取数据)</em></p><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="6e41" class="jo jp hi ku b fi ky kz l la lb">import 'dart:convert';</span><span id="4f9a" class="jo jp hi ku b fi lc kz l la lb">import 'package:http/http.dart' as http;</span><span id="b421" class="jo jp hi ku b fi lc kz l la lb">import 'model.dart';</span><span id="f00d" class="jo jp hi ku b fi lc kz l la lb">class Network {<br/>  final _baseUrl = 'https://this-will-be-your-app-name.herokuapp.com/';</span><span id="db8e" class="jo jp hi ku b fi lc kz l la lb">Future&lt;List&lt;Person&gt;?&gt; get read async {<br/>    final url = '${_baseUrl}cr/read';<br/>    final uri = Uri.parse(url);<br/>    final response = await http.get(uri);</span><span id="37e0" class="jo jp hi ku b fi lc kz l la lb">if (response.statusCode == 200) {<br/>      return _personsFromJson(response.body);<br/>    }<br/>    return null;<br/>  }</span><span id="4564" class="jo jp hi ku b fi lc kz l la lb">Future&lt;void&gt; write(<br/>    Person person,<br/>  ) async {<br/>    final url = '${_baseUrl}cr/write';<br/>    final uri = Uri.parse(url);<br/>    await http.post(<br/>      uri,<br/>      body: person.toJson,<br/>    );<br/>  }</span><span id="18a8" class="jo jp hi ku b fi lc kz l la lb">Future&lt;bool&gt; check(Person person) async {<br/>    final url = '${_baseUrl}cr/check';<br/>    final uri = Uri.parse(url);<br/>    final response = await http.post(<br/>      uri,<br/>      body: person.toJson,<br/>    );<br/>    switch (response.statusCode) {<br/>      case 200:<br/>        return true;<br/>      default:<br/>        return false;<br/>    }<br/>  }</span><span id="ad8b" class="jo jp hi ku b fi lc kz l la lb">Future&lt;void&gt; update(<br/>    Person person,<br/>  ) async {<br/>    final url = '${_baseUrl}ud/update';<br/>    final uri = Uri.parse(url);<br/>    await http.post(<br/>      uri,<br/>      body: person.toJson,<br/>    );<br/>  }</span><span id="239f" class="jo jp hi ku b fi lc kz l la lb">Future&lt;void&gt; delete(<br/>    Person person,<br/>  ) async {<br/>    final url = '${_baseUrl}ud/delete';<br/>    final uri = Uri.parse(url);<br/>    await http.post(<br/>      uri,<br/>      body: {<br/>        "id": person.id.toString(),<br/>      },<br/>    );<br/>  }</span><span id="968d" class="jo jp hi ku b fi lc kz l la lb">List&lt;Person&gt; _personsFromJson(String str) {<br/>    return List&lt;Person&gt;.from(<br/>      json.decode(str).map(<br/>            (x) =&gt; Person.fromJson(x),<br/>          ),<br/>    );<br/>  }<br/>}</span></pre><h2 id="9dd9" class="jo jp hi bd jq jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki bi translated">2.创建NodeJS应用程序</h2><p id="12bc" class="pw-post-body-paragraph iq ir hi is b it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj kn jl jm jn hb bi translated"><em class="ko"> 2.1。app.js(或server.js) </em></p><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="597e" class="jo jp hi ku b fi ky kz l la lb">const express = require('express');<br/>const app = express();<br/>const PORT = process.env.PORT || 3000; <br/>// If you change process.env.PORT won't work on Heroku.</span><span id="3f71" class="jo jp hi ku b fi lc kz l la lb">const writeRead = require('./routes/writeRead');<br/>const updateDelete = require('./routes/updateDelete');</span><span id="9aff" class="jo jp hi ku b fi lc kz l la lb">app.use('/cr', writeRead);<br/>app.use('/ud', updateDelete);</span><span id="18d3" class="jo jp hi ku b fi lc kz l la lb">app.use('/', function (req, res, next) {<br/>    res.sendStatus(404);<br/>});</span><span id="d65f" class="jo jp hi ku b fi lc kz l la lb">app.listen(PORT, () =&gt;<br/>    console.log('Server running on port: ' + PORT<br/>    ));</span></pre><p id="ae0c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="ko"> 2.2。创建一个名为“routes”的目录，然后在其中创建两个名为“writeRead.js”和“updateDelete.js”的文件</em></p><p id="a374" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="ko"> 2.2.1。writeRead.js </em></p><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="2230" class="jo jp hi ku b fi ky kz l la lb">'use strict';</span><span id="d0f1" class="jo jp hi ku b fi lc kz l la lb">const express = require('express');<br/>const crRoute = express.Router();<br/>const connection = require('../db');</span><span id="bed0" class="jo jp hi ku b fi lc kz l la lb">crRoute.post('/write', function (req, res, next) {<br/>    connection.execute(`INSERT INTO persons <br/>    (name, surName) <br/>    VALUES (?, ?);`,<br/>        [req.body.name, req.body.surName])<br/>        .then(() =&gt; {<br/>            console.log('ok');<br/>        }).catch((err) =&gt; {<br/>            console.log(err);<br/>        });<br/>    res.end();<br/>});</span><span id="e23d" class="jo jp hi ku b fi lc kz l la lb">crRoute.get('/read', function (req, res, next) {<br/>    connection.execute('SELECT * FROM persons;')<br/>        .then((result) =&gt; {<br/>            var rawData = result[0];<br/>            res.send(JSON.stringify(rawData));<br/>        }).catch((err) =&gt; {<br/>            console.log(err);<br/>            res.end();<br/>        });<br/>});</span><span id="3085" class="jo jp hi ku b fi lc kz l la lb">crRoute.post('/check', function (req, res, next) {<br/>    connection.execute('SELECT * FROM persons WHERE name=? AND surName=?;',<br/>    [req.body.name, req.body.surName])<br/>        .then((result) =&gt; {<br/>            var data = result[0];<br/>            if (data.length === 0) {<br/>                res.sendStatus(200);<br/>            } else {<br/>                res.sendStatus(400);<br/>            }<br/>        }).catch((err) =&gt; {<br/>            console.log(err);<br/>            res.sendStatus(404);<br/>        });<br/>});</span><span id="d8a0" class="jo jp hi ku b fi lc kz l la lb">crRoute.use('/', function (req, res, next) {<br/>    res.sendStatus(404);<br/>})</span><span id="feb0" class="jo jp hi ku b fi lc kz l la lb">module.exports = crRoute;</span></pre><p id="e1de" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="ko"> 2.2.2。updateDelete.js </em></p><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="35ef" class="jo jp hi ku b fi ky kz l la lb">'use strict';</span><span id="7cdc" class="jo jp hi ku b fi lc kz l la lb">const express = require('express');<br/>const udRoute = express.Router();<br/>const connection = require('../db');</span><span id="cbc8" class="jo jp hi ku b fi lc kz l la lb">udRoute.post('/update', function (req, res, next) {<br/>    connection.execute("UPDATE persons SET name=?, surName=? WHERE id=?;",<br/>        [req.body.name, req.body.surName, req.body.id])<br/>        .then(() =&gt; {<br/>            console.log('ok');<br/>        }).catch((err) =&gt; {<br/>            console.log(err);<br/>        });<br/>    res.end();<br/>});</span><span id="8cf7" class="jo jp hi ku b fi lc kz l la lb">udRoute.post('/delete', function (req, res, next) {<br/>    connection.execute("DELETE FROM persons WHERE id=?;",<br/>        [req.body.id])<br/>        .then(() =&gt; {<br/>            console.log('ok');<br/>        }).catch((err) =&gt; {<br/>            console.log(err);<br/>        });<br/>    res.end();<br/>});</span><span id="16c6" class="jo jp hi ku b fi lc kz l la lb">udRoute.use('/', function (req, res, next) {<br/>    res.sendStatus(404);<br/>})</span><span id="01b2" class="jo jp hi ku b fi lc kz l la lb">module.exports = udRoute;</span></pre><p id="bb1c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="ko"> 2.3。在项目根目录下创建一个名为“db.js”的文件。</em></p><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="48c8" class="jo jp hi ku b fi ky kz l la lb">const mysql = require('mysql2');<br/>const dbConfig = require('./db.config');</span><span id="d9ff" class="jo jp hi ku b fi lc kz l la lb">const connection = mysql.createPool({<br/>    host: dbConfig.HOST,<br/>    user: dbConfig.USER,<br/>    database: dbConfig.DATABASE,<br/>    password: dbConfig.PASSWORD,<br/>    port: dbConfig.PORT,<br/>});</span><span id="b028" class="jo jp hi ku b fi lc kz l la lb">module.exports = connection.promise();</span></pre><p id="475f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="ko"> 2.4。在项目根目录下创建一个名为“db.config.js”的文件。</em></p><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="87da" class="jo jp hi ku b fi ky kz l la lb">// We will create a database on remotemysql.com shortly.</span><span id="ec9d" class="jo jp hi ku b fi lc kz l la lb">module.exports = {<br/>    HOST: 'remotemysql.com',<br/>    USER: 'YOUR USER',<br/>    DATABASE: 'YOUR DATABASE',<br/>    PASSWORD: 'YOUR PASSWORD',<br/>    PORT: '3306'<br/>  };</span></pre><p id="11d4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="ko"> 2.5。让我们安装软件包</em></p><p id="91be" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在项目根目录中打开终端，然后键入:</p><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="e5ca" class="jo jp hi ku b fi ky kz l la lb">$ npm init -y<br/>$ npm i express nodemon mysql2</span></pre><p id="c6e2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 2.6。编辑自动生成的package.json文件中的“脚本”字段。</strong></p><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="c80d" class="jo jp hi ku b fi ky kz l la lb">"scripts": {<br/>    "start": "nodemon app.js", &lt;-- CHANGE THIS<br/>    "test": "echo \"Error: no test specified\" &amp;&amp; exit 1"<br/>  },</span><span id="1b86" class="jo jp hi ku b fi lc kz l la lb">/* If you gave to main file another name instead of app.js, type its name. (eg "nodemon server.js") */</span></pre><p id="7e5a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">并检查它是否工作</p><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="e99d" class="jo jp hi ku b fi ky kz l la lb">$ npm start</span></pre><h2 id="772e" class="jo jp hi bd jq jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki bi translated">3.创建MySQL数据库</h2><p id="04dd" class="pw-post-body-paragraph iq ir hi is b it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj kn jl jm jn hb bi translated">我不做详细解释，因为它使用起来非常简单。</p><ul class=""><li id="9337" class="ld le hi is b it iu ix iy jb lf jf lg jj lh jn li lj lk ll bi translated">去remotemysql.com</li><li id="a3dd" class="ld le hi is b it ln ix lo jb lp jf lq jj lr jn li lj lk ll bi translated">创建一个帐户</li><li id="5adc" class="ld le hi is b it ln ix lo jb lp jf lq jj lr jn li lj lk ll bi translated">转到数据库选项卡并创建一个数据库</li><li id="feae" class="ld le hi is b it ln ix lo jb lp jf lq jj lr jn li lj lk ll bi translated">将主机、用户、数据库、密码和端口信息保存到nodejs应用程序的db.config.js文件中。</li><li id="8a0c" class="ld le hi is b it ln ix lo jb lp jf lq jj lr jn li lj lk ll bi translated">到remotemysql的phpMyAdmin模块，用刚才给你的用户名和密码登录。</li><li id="e550" class="ld le hi is b it ln ix lo jb lp jf lq jj lr jn li lj lk ll bi translated">创建一个名为“persons”的表，字段名称为“id”、“name”和“surName”。指向id字段的A_I选项和索引。</li><li id="ce2d" class="ld le hi is b it ln ix lo jb lp jf lq jj lr jn li lj lk ll bi translated">id类型:int(255) |姓名类型:varchar(45) |姓氏类型:varchar(45)</li></ul><h2 id="dade" class="jo jp hi bd jq jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki bi translated">4.1.让我们通过Heroku部署我们的服务器应用程序</h2><p id="a501" class="pw-post-body-paragraph iq ir hi is b it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj kn jl jm jn hb bi translated"><em class="ko"> 4.1.1。下载并安装Heroku </em></p><p id="629e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">转到<a class="ae lm" href="https://devcenter.heroku.com/articles/heroku-cli#download-and-install" rel="noopener ugc nofollow" target="_blank"> <em class="ko"> Heroku开发中心</em> </a>，然后按照说明安装Heroku CLI。</p><p id="c7ab" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="ko"> 4.1.2。键入以下命令，并通过提供给您的链接登录。登录后可以关闭浏览器。</em></p><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="9632" class="jo jp hi ku b fi ky kz l la lb">$ heroku login</span></pre><p id="1d26" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="ko"> 4.1.3。返回NodeJS应用并激活GIT </em></p><ul class=""><li id="634c" class="ld le hi is b it iu ix iy jb lf jf lg jj lh jn li lj lk ll bi translated">创建一个名为“”的文件。gitignore”并在其中写下以下内容:</li></ul><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="63b7" class="jo jp hi ku b fi ky kz l la lb">/node_modules<br/>npm-debug.log<br/>.DS_Store<br/>/*.env</span></pre><ul class=""><li id="2a49" class="ld le hi is b it iu ix iy jb lf jf lg jj lh jn li lj lk ll bi translated">在项目根目录中打开终端，然后键入:</li></ul><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="a0d0" class="jo jp hi ku b fi ky kz l la lb">$ git init<br/>$ git add .<br/>$ git commit -m "initial commit"</span></pre><p id="609e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="ko"> 4.1.4。创建Heroku app </em></p><ul class=""><li id="0476" class="ld le hi is b it iu ix iy jb lf jf lg jj lh jn li lj lk ll bi translated">键入以下命令创建Heroku应用:<br/>(您应该用自己的应用名称替换【您的应用名称】。例如:heroku创建我的服务器应用程序)</li></ul><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="b8ac" class="jo jp hi ku b fi ky kz l la lb">$ <!-- -->heroku create [your-app-name]</span></pre><ul class=""><li id="1af8" class="ld le hi is b it iu ix iy jb lf jf lg jj lh jn li lj lk ll bi translated">转到network.dart，将基本url更改为您的应用程序名称。例如:https://my-server-app.herokuapp.com/</li><li id="bae9" class="ld le hi is b it ln ix lo jb lp jf lq jj lr jn li lj lk ll bi translated">将NodeJS应用推送到Heroku</li></ul><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="5e6c" class="jo jp hi ku b fi ky kz l la lb">$ git push heroku master</span></pre><ul class=""><li id="313c" class="ld le hi is b it iu ix iy jb lf jf lg jj lh jn li lj lk ll bi translated">激活Heroku上的节点</li></ul><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="ec5f" class="jo jp hi ku b fi ky kz l la lb">$ heroku buildpacks:set heroku/nodejs</span></pre><ul class=""><li id="a377" class="ld le hi is b it iu ix iy jb lf jf lg jj lh jn li lj lk ll bi translated">黄金镜头:)</li></ul><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="6067" class="jo jp hi ku b fi ky kz l la lb">$ heroku run npm start</span></pre><ul class=""><li id="f093" class="ld le hi is b it iu ix iy jb lf jf lg jj lh jn li lj lk ll bi translated">如果出现错误类型:</li></ul><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="f3d7" class="jo jp hi ku b fi ky kz l la lb">$ heroku run npm install<br/>$ heroku restart<br/>$ heroku run npm start</span></pre><ul class=""><li id="2a05" class="ld le hi is b it iu ix iy jb lf jf lg jj lh jn li lj lk ll bi translated">要使服务器空闲，请执行以下操作:</li></ul><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="9c5a" class="jo jp hi ku b fi ky kz l la lb">//check server<br/>$ heroku ps</span><span id="6893" class="jo jp hi ku b fi lc kz l la lb">//stop<br/>$ heroku ps:stop web.1</span></pre><p id="0ba0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对于其他Heroku命令，请转到<a class="ae lm" href="https://devcenter.heroku.com/articles/heroku-cli-commands" rel="noopener ugc nofollow" target="_blank"> <em class="ko"> Heroku CLI命令</em> </a>或键入:</p><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="fa2a" class="jo jp hi ku b fi ky kz l la lb">$ heroku -h</span></pre></div></div>    
</body>
</html>