# ä¸€å…ƒçº¿æ€§å›å½’

> åŸæ–‡ï¼š<https://medium.com/codex/linear-regression-on-single-variable-f35e6a73dab6?source=collection_archive---------13----------------------->

![](img/004d40bad700321cc8af22af5e175cda.png)

è‰¾è¨å…‹Â·å²å¯†æ–¯åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) ä¸Šæ‹æ‘„çš„ç…§ç‰‡

å¤§å®¶å¥½ã€‚ä»Šå¤©æˆ‘ä»¬å°†æ­¥å…¥æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªç›‘ç£å­¦ä¹ ç®—æ³•ã€‚çº¿æ€§å›å½’æ˜¯æ¸¸æˆçš„åå­—ã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†ç¼–ç æˆ‘ä»¬çš„ç®—æ³•ï¼Œç„¶åç”¨å®ƒä½œä¸ºæˆ‘ä»¬çš„é¢„æµ‹æ¨¡å‹ã€‚

## ä»€ä¹ˆæ˜¯çº¿æ€§å›å½’ï¼Ÿ

çº¿æ€§å›å½’æ˜¯ä¸€ç§ç»Ÿè®¡ç›‘ç£å­¦ä¹ æŠ€æœ¯ï¼Œä½¿ç”¨ä¸€ä¸ªæˆ–å¤šä¸ªç‹¬ç«‹ç‰¹å¾å»ºç«‹çº¿æ€§å…³ç³»æ¥é¢„æµ‹å› å˜é‡ã€‚å®ƒä¹Ÿè¢«ç§°ä¸ºâ€œæœ€ä½³æ‹Ÿåˆçº¿â€ã€‚çº¿æ€§å›å½’çš„åŸºæœ¬æ€æƒ³æ˜¯æ‰¾åˆ°ä¸€æ¡ç¬¦åˆæ•°æ®ç‚¹é›†çš„ç›´çº¿ã€‚

## æ¨¡å‹è¡¨ç¤º

**ç¬¦å·:**

![](img/5c2230df93cf747e9597d1683b2a5da4.png)

è®°å·

ä¸€èˆ¬æ¥è¯´ï¼Œå›å½’è¿‡ç¨‹ç”±ä¸‹é¢çš„æµç¨‹å›¾è§£é‡Š:

![](img/ee01c5045e15ef2aa1fa36146409e275.png)

ä¸ºäº†ç”Ÿæˆå‡è®¾(çº¿)ï¼Œå°†è®­ç»ƒæ•°æ®æ¤å…¥å­¦ä¹ è¿‡ç¨‹ã€‚å‡è®¾æ˜¯ä½¿ç”¨è¾“å…¥æ•°æ®é¢„æµ‹è¾“å‡ºå€¼çš„å‡½æ•°ã€‚å‡è®¾(h)æ˜¯ä¸€ä¸ªå°† x æ˜ å°„åˆ° y çš„å‡½æ•°ã€‚

åœ¨çº¿æ€§å›å½’çš„æƒ…å†µä¸‹ï¼Œå‡è®¾(h)ç”±ä»¥ä¸‹ç­‰å¼è¡¨ç¤º:

![](img/3b0bc032e0fc9db7867d1fa4f76c8b99.png)

ä¸€å…ƒå›å½’å…¬å¼

å‚æ•°çš„å›¾å½¢è¡¨ç¤º:

![](img/abb1d949279b27bd7a1c77dfeb78e3cd.png)

å‡è®¾çš„å›¾ç¤º:

![](img/f3f9479e30c0cefe602792414ba8edc2.png)

å‡è®¾

ä»ä¸Šå›¾ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ¸…æ¥šåœ°è§è¯ï¼Œæœ‰ä¸€ä¸ªçº¿æ€§çš„è¶‹åŠ¿ã€‚éšç€â€œxâ€å€¼çš„å¢åŠ ï¼Œâ€œyâ€å€¼ä¹Ÿä¼šå¢åŠ ã€‚

è¿™é‡Œï¼Œx æ˜¯ç‹¬ç«‹å˜é‡ï¼Œy æ˜¯è¾“å‡ºå˜é‡ï¼ŒÎ¸â‚€æ˜¯æˆªè·ï¼Œæˆªè·æ˜¯å¸¸æ•°ï¼ŒÎ¸â‚æ˜¯æ–œç‡ã€‚

è€ƒè™‘ä¸€ä¸ªæ•°æ®é›†ï¼Œå…¶ä¸­åŒ…å«åŸºäºåŸå¸‚äººå£çš„å¿«é¤è½¦åˆ©æ¶¦ä¿¡æ¯ã€‚

è®©æˆ‘ä»¬å¯¼å…¥æ‰€éœ€çš„åº“:

```
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
```

å¹¶å°†æ•°æ®é›†åŠ è½½åˆ°ç†ŠçŒ«æ•°æ®æ¡†æ¶ä¸­

```
data = pd.read_csv('ex1data1.txt', header=None)
data.head()
```

![](img/5895ce138fb8dd2fdf528aa155fa5d40.png)

è¾“å‡º:data.head()

è¿™é‡Œ 0( å³ xï¼Œ ***ä¸‡äººåŸå¸‚çš„*** æ˜¯è¾“å…¥å˜é‡)å’Œ 1(å³ yï¼Œ ***ä¸‡å…ƒåˆ©æ¶¦*** æ˜¯è¾“å‡ºå˜é‡)

```
data.describe()
```

![](img/e00c32321496790e928f24b3de9bb2a4.png)

è¾“å‡º:data.describe()

åœ¨å¼€å§‹ä»»ä½•ä»»åŠ¡ä¹‹å‰ï¼Œé€šè¿‡å¯è§†åŒ–æ¥ç†è§£æ•°æ®é€šå¸¸æ˜¯æœ‰ç”¨çš„ã€‚å¯¹äºè¿™ä¸ªæ•°æ®é›†ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æ•£ç‚¹å›¾æ¥å¯è§†åŒ–æ•°æ®ï¼Œå› ä¸ºå®ƒåªæœ‰ä¸¤ä¸ªå±æ€§å¯ä»¥ç»˜åˆ¶(åˆ©æ¶¦å’Œäººå£)ã€‚æˆ‘ä»¬åœ¨ç°å®ç”Ÿæ´»ä¸­é‡åˆ°çš„è®¸å¤šå…¶ä»–é—®é¢˜éƒ½æ˜¯å¤šç»´çš„ï¼Œä¸èƒ½ç”¨äºŒç»´å›¾æ¥è¡¨ç¤ºã€‚

```
plt.scatter(data[0], data[1], marker="x", c='red', alpha=0.5)
plt.xticks(np.arange(5, 30, step=5))
plt.yticks(np.arange(-5, 30, step=5))
plt.xlabel("Population of a city(10,000s)")
plt.ylabel("Profit($10,000)")
plt.title("Profit vs. Population")
```

![](img/cd5725fee08c5401d73adf4b3f4d7b9e.png)

è¾“å‡º:æ•£ç‚¹å›¾

ä»è¿™å¼ å›¾ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°çº¿æ€§è¶‹åŠ¿ï¼Œéšç€äººå£çš„å¢åŠ ï¼Œåˆ©æ¶¦ä¹Ÿå¢åŠ ã€‚

å› ä¸ºæˆ‘ä»¬ç”¨çš„æ˜¯çº¿æ€§å›å½’ï¼Œå‡è®¾ç±»ä¼¼äºç›´çº¿çš„æ–¹ç¨‹ã€‚ä¸ºäº†æ‹Ÿåˆæ•°æ®ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ä»»ä½•ä¸€ç§å‡½æ•°ä½œä¸ºå‡è®¾(***ã€h(x)ã€‘***)ã€‚

## å¦‚ä½•ä¸ºå‡è®¾é€‰æ‹©å¥½çš„å‚æ•°ï¼Ÿ

ç›®æ ‡æ˜¯è®¾ç½®å‚æ•°ï¼Œä½¿ h(x)æ¥è¿‘æ¯ä¸ª x çš„ y å€¼ã€‚ä¾‹å¦‚ï¼Œé€‰æ‹©Î¸â‚€å’ŒÎ¸â‚ï¼Œä½¿ h(x)æ¥è¿‘æ¯ä¸ª x çš„ y å€¼ã€‚
è¯¥æ¡ä»¶å¯ä»¥ç”¨æ•°å­—è¡¨ç¤ºå¦‚ä¸‹:

![](img/153f5601fe4be58ec756d9883d94237e.png)

ä»·å€¼å‡½æ•°

è¿™ä¸ªè¡¨è¾¾å¼å«åšæˆæœ¬å‡½æ•°ï¼ŒæŸå¤±å‡½æ•°ï¼Œç­‰ç­‰â€¦è¿™ä¸ªè¡¨è¾¾å¼çš„ç»“æœå«åšæˆæœ¬ï¼ŒæŸå¤±ï¼Œç­‰ç­‰â€¦æœ€ç»ˆï¼Œä¸€åˆ‡éƒ½æ˜¯ä¸€æ ·çš„ã€‚æœ‰è®¸å¤šç±»å‹çš„æˆæœ¬å‡½æ•°å¯ç”¨ã€‚å‡æ–¹å·®(MSE)æˆæœ¬å‡½æ•°æ˜¯å›å½’é—®é¢˜ä¸­é€šå¸¸ä½¿ç”¨çš„å‡½æ•°ï¼Œå¦‚ä¸Šæ‰€ç¤ºã€‚

å¥½ä¸åå‡è®¾çš„å›¾ç¤º:

![](img/34c4f09daf54f6b88b06ac3ca7d9d890.png)

å¥½ä¸åçš„å‡è®¾

ä»ä¸Šå›¾æˆ‘ä»¬å¯ä»¥æ¨æ–­ï¼Œç‚¹ä¸æ£•è‰²çº¿ä¹‹é—´çš„è·ç¦»å½¼æ­¤è¾ƒè¿œï¼Œç‚¹ä¸ç»¿è‰²çº¿ä¹‹é—´çš„è·ç¦»å½¼æ­¤è¾ƒè¿‘ã€‚å› æ­¤ï¼Œç»¿çº¿å°†å…·æœ‰æœ€å°æˆæœ¬( ***å¥½å‡è®¾*** )ï¼Œè€Œæ£•è‰²çº¿å°†å…·æœ‰æœ€å¤§æˆæœ¬( ***åå‡è®¾*** )ã€‚ä¸Šé¢çš„ç­‰å¼å°†è¯•å›¾æ‰¾åˆ°å‡å°‘ h(x)æŸå¤±çš„çº¿ã€‚

è®©æˆ‘ä»¬è¿›ä¸€æ­¥åˆ†ææˆæœ¬å‡½æ•°:

![](img/5b8dce3eae7a904c618b9dbd150fb7e9.png)

èµ„æ–™æ¥æº:å´æ©è¾¾

```
def compute_cost(X, y, theta):
    m = len(y)
    h_theta = X.dot(theta)
    J = 1/(2*m) * np.sum((h_theta-y)**2)
    return J
```

```
mod_data = data.values
m = len(mod_data[:,-1])
X = np.column_stack((np.ones((m, 1)), mod_data[:, 0].reshape(m, 1)))
y = mod_data[:, 1].reshape(m, 1)
theta = np.zeros((2, 1))

iterations = 1500
alpha = 0.01
J = compute_cost(X, y, theta)
```

## æœ€å°åŒ–æˆæœ¬å‡½æ•°çš„æ¢¯åº¦ä¸‹é™

æ¢¯åº¦ä¸‹é™æ³•æ˜¯ä¸€ç§æµè¡Œçš„æœ€å°åŒ–ä»£ä»·å‡½æ•°æŸå¤±çš„ç®—æ³•ã€‚

*   J(Î¸â‚€ã€Î¸â‚)æœ‰æŸç§åŠŸèƒ½
*   ç›®æ ‡:

![](img/279ec83fa817c4201972230a6d0fb76a.png)

*   ä»Î¸â‚€ï¼ŒÎ¸â‚.å¼€å§‹
*   ä¸æ–­æ”¹å˜Î¸â‚€ï¼ŒÎ¸â‚ï¼Œä»¥å‡å°‘ J(Î¸â‚€ï¼ŒÎ¸â‚)ï¼Œç›´åˆ°æˆ‘ä»¬æœ‰å¸Œæœ›åœ¨æœ€ä½é™åº¦ç»“æŸã€‚

![](img/8763bc6d70a49f5ceea6507e33ffd557.png)

èµ„æ–™æ¥æº:å´æ©è¾¾

æ›´æ–°å‚æ•°è§„åˆ™:

*   æ‰¾åˆ°å‡è®¾â†’ h(x) = Î¸â‚€ + Î¸â‚x
*   ç„¶åä½¿ç”¨å‡è®¾å’Œæ•°æ®ä¸­çš„è¾“å‡ºå˜é‡æ¥è®¡ç®—æˆæœ¬:

![](img/153f5601fe4be58ec756d9883d94237e.png)

*   ç„¶åæ›´æ–° thetaï¼Œå¦‚ä¸‹æ‰€ç¤º:

![](img/e598d7b8c6e20043ceefac8a8fd3b75c.png)

Alpha æˆ–å­¦ä¹ ç‡å†³å®šäº†ç®—æ³•è¾¾åˆ°æœ€å°æˆæœ¬å€¼(å³ï¼Œç»™å‡ºæœ€å°æˆæœ¬å€¼çš„å‚æ•°å€¼)æ‰€é‡‡å–çš„æ­¥é•¿ã€‚æˆ‘ä»¬å¿…é¡»æ³¨æ„çš„éå¸¸é‡è¦çš„ç»†èŠ‚æ˜¯ï¼Œæˆ‘ä»¬å¿…é¡»**åŒæ—¶æ›´æ–°Î¸â‚å’ŒÎ¸â‚€**ã€‚æˆ‘ä»¬ä¸åº”è¯¥æ›´æ–°Î¸â‚€ï¼Œç„¶åå‡çº§æˆæœ¬å‡½æ•°ï¼Œç„¶åÎ¸â‚ï¼Œè¿™ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„å·¥ä½œæ–¹å¼ã€‚

```
def gradientDescent(X, y, theta, alpha, n_iters, graph=True):
    m = len(y)
    J_history = []

    for i in range(n_iters):
        h_theta = X.dot(theta)
        err = np.dot(X.T, (h_theta - y))
        descent = alpha * 1/m * err
        theta -= descent

        J_history.append(compute_cost(X, y, theta))
    if graph:
        plt.plot(J_history)
        plt.xlabel("No. of Iterations")
        plt.ylabel("J(theta)")
        plt.title("Cost function using Gradient Descent")

    return theta, J_historytheta, J_history = gradientDescent(X, y, theta, alpha, iterations)
print(f"h(x)= {round(theta[0, 0], 2)} + {round(theta[1, 0], 2)} x1")
```

![](img/8f7cf9625a50f9e9870308dfe360d6f1.png)

å‚æ•°çš„åˆå§‹å€¼è¢«è®¾ç½®ä¸ºé›¶ã€‚å­¦ä¹ ç‡è®¾ç½®ä¸º 0.01ã€‚æœ€å¤šå…è®¸ 1400 ä¸ªé‡å¤æˆ–æ—¶æœŸã€‚ç›¸å¯¹äºè¿­ä»£æ¬¡æ•°ç»˜åˆ¶æˆæœ¬å‡½æ•°ç»™å‡ºäº†è‰¯å¥½çš„ä¸‹é™è¶‹åŠ¿ï¼Œè¡¨æ˜æ¢¯åº¦ä¸‹é™å®ç°åœ¨é™ä½æˆæœ¬å‡½æ•°æ–¹é¢èµ·ä½œç”¨ã€‚

ç°åœ¨ï¼Œæœ‰äº†ä¼˜åŒ–çš„Î¸å€¼ï¼Œæˆ‘å°†æŠŠé¢„æµ‹å€¼(æœ€ä½³æ‹Ÿåˆçº¿)ä¸€èµ·ç»˜åˆ¶æˆå›¾

![](img/9508331402838ba40d2641875bc00959.png)

## é¢„è¨€

è¦è¿›è¡Œé¢„æµ‹:

![](img/42cbe126a0d60009671bdea6a136eead.png)

```
def predict(X, theta):
    predictions = np.dot(theta.T, X)
    return predictions[0]
```

```
predict1 = predict(np.array([1,3.5]),theta)*10000
print(f'For population=35000, we predict a profit of ${round(predict1, 0)}')
```

![](img/3d7dbaf8b075b0be0707e0f29d973190.png)

```
predict2 = predict(np.array([1,7]),theta)*10000
print(f'For population=70000, we predict a profit of ${round(predict2, 0)}')
```

![](img/91acc6344411849cb38afa42b59f2076.png)

## ç»“è®º

ä»Šå¤©ï¼Œæˆ‘ä»¬çœ‹åˆ°äº†å‡è®¾ã€æˆæœ¬å‡½æ•°å’Œå•å˜é‡çº¿æ€§å›å½’çš„æ¢¯åº¦ä¸‹é™èƒŒåçš„æ¦‚å¿µï¼Œå¹¶ä½¿ç”¨ä¸Šè¿°æ¦‚å¿µåœ¨æˆ¿ä»·æ•°æ®é›†çš„è¦ç´ ä¸Šæ„å»ºäº†ä¸€æ¡å›å½’çº¿ã€‚ç„¶åä½¿ç”¨ python çš„ numpyã€pandas å’Œ matplotlib ä»å¤´å¼€å§‹åˆ›å»ºå®ƒã€‚æ•°æ®é›†å’Œæœ€ç»ˆä»£ç ä¸Šä¼ åˆ° githubã€‚

ç‚¹å‡»è¿™é‡ŒæŸ¥çœ‹[çº¿æ€§å›å½’](https://github.com/jagajith23/Andrew-Ng-s-Machine-Learning-in-Python/tree/gh-pages/Linear%20Regression)ã€‚

# å¦‚æœä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œé‚£ä¹ˆçœ‹çœ‹æˆ‘åœ¨è¿™ä¸ªç³»åˆ—ä¸­çš„å…¶ä»–æ–‡ç« 

## 1.[ä»€ä¹ˆæ˜¯æœºå™¨å­¦ä¹ ï¼Ÿ](/@jagajith23/what-is-machine-learning-daeac9a2ceca)

## 2.[æœºå™¨å­¦ä¹ æœ‰å“ªäº›ç±»å‹ï¼Ÿ](/codex/what-are-the-types-of-machine-learning-53360b7db8b4)

## 3.[å¤šå…ƒçº¿æ€§å›å½’](/@jagajith23/linear-regression-on-multiple-variables-1893e4d940b1)

## 4.[é€»è¾‘å›å½’](/@jagajith23/logistic-regression-eee2fd028ffd)

## 5.[ä»€ä¹ˆæ˜¯ç¥ç»ç½‘ç»œï¼Ÿ](/@jagajith23/what-are-neural-networks-3a0965e2ebfb)

## 6.[ä½¿ç”¨ç¥ç»ç½‘ç»œçš„æ•°å­—åˆ†ç±»å™¨](/@jagajith23/digit-classifier-using-neural-networks-ad17749a8f00)

## 7.[åˆ©ç”¨ K å‡å€¼èšç±»è¿›è¡Œå›¾åƒå‹ç¼©](/@jagajith23/image-compression-with-k-means-clustering-48e989055729)

## 8.[ä½¿ç”¨ PCA å¯¹äººè„¸è¿›è¡Œé™ç»´](/@jagajith23/dimensionality-reduction-on-face-using-pca-e3fec3bb4cee)

## 9.[ä½¿ç”¨å¼‚å¸¸æ£€æµ‹æ¥æ£€æµ‹ç½‘ç»œä¸Šçš„æ•…éšœæœåŠ¡å™¨](https://jagajith23.medium.com/detect-failing-servers-on-a-network-using-anomaly-detection-1c447bc8a46a)

# æœ€ååšçš„äº‹

å¦‚æœä½ å–œæ¬¢æˆ‘çš„æ–‡ç« ï¼Œè¯·é¼“æŒğŸ‘ä¸€ä¸ªè¿½éšè€…å°†ä¼šæ˜¯æƒŠäººçš„å’Œå®ƒæœ‰åŠ©äºåª’ä½“æ¨å¹¿è¿™ç¯‡æ–‡ç« ï¼Œä»¥ä¾¿å…¶ä»–äººå¯ä»¥é˜…è¯»å®ƒã€‚æˆ‘æ˜¯ Jagajithï¼Œæˆ‘ä¼šåœ¨ä¸‹ä¸€ä¸ªé‡ŒæŠ“ä½ä½ ã€‚