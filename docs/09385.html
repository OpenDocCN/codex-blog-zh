<html>
<head>
<title>Data Frames in Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">熊猫中的数据框</h1>
<blockquote>原文：<a href="https://medium.com/codex/data-frames-in-pandas-146abdb03180?source=collection_archive---------10-----------------------#2022-10-17">https://medium.com/codex/data-frames-in-pandas-146abdb03180?source=collection_archive---------10-----------------------#2022-10-17</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><h2 id="d538" class="hg hh hi bd b fp hj hk hl hm hn ho dx hp translated" aria-label="kicker paragraph">引用</h2><div class=""/><div class=""><h2 id="ba6d" class="pw-subtitle-paragraph io hr hi bd b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf dx translated"><em class="jg">摘自鲁文·勒纳的</em> <a class="ae jh" href="https://www.manning.com/books/pandas-workout?utm_source=medium&amp;utm_medium=referral&amp;utm_campaign=book_lerner2_pandas_8_3_21" rel="noopener ugc nofollow" target="_blank"> <em class="jg">熊猫健身</em> </a> <em class="jg"/></h2></div><p id="5f51" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated"><em class="ke">本文讨论在Pandas中使用数据帧。</em></p></div><div class="ab cl kf kg gp kh" role="separator"><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk"/></div><div class="hb hc hd he hf"><p id="7a1e" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">在<a class="ae jh" href="https://www.manning.com/books/pandas-workout?utm_source=medium&amp;utm_medium=referral&amp;utm_campaign=book_lerner2_pandas_8_3_21" rel="noopener ugc nofollow" target="_blank">manning.com</a>结账时，将<strong class="jk hs"> fcclerner2 </strong>输入折扣代码框，即可享受<a class="ae jh" href="https://www.manning.com/books/pandas-workout?utm_source=medium&amp;utm_medium=referral&amp;utm_campaign=book_lerner2_pandas_8_3_21" rel="noopener ugc nofollow" target="_blank"> <em class="ke">熊猫健身</em></a>35%的折扣。</p></div><div class="ab cl kf kg gp kh" role="separator"><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk"/></div><div class="hb hc hd he hf"><p id="9228" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">在<code class="du km kn ko kp b">pandas</code>中，人们使用和想要使用的主要数据结构是数据帧。数据框是二维表格，其外观和工作方式类似于Excel电子表格。可以通过索引访问这些行。只要您使用<code class="du km kn ko kp b">.loc</code>和<code class="du km kn ko kp b">.iloc</code>通过索引检索元素，就不会有问题。</p><p id="fe32" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">但是当然，数据帧也有<strong class="jk hs">列</strong>，每个列都有名字。每个列实际上都是自己的系列，这意味着它有一个独立于其他列的<code class="du km kn ko kp b">dtype</code>。</p><figure class="kr ks kt ku fd kv er es paragraph-image"><div class="er es kq"><img src="../Images/9a2283bee4ca572e486513f96f4b475f.png" data-original-src="https://miro.medium.com/v2/resize:fit:790/format:webp/0*xtUmhSCAtE_CsLvd.png"/></div><figcaption class="ky kz et er es la lb bd b be z dx translated">图一。具有五行(<code class="du km kn ko kp b">'row0'</code>到<code class="du km kn ko kp b">'row4'</code>)和五列(<code class="du km kn ko kp b">'col0'</code>到<code class="du km kn ko kp b">'col4'</code>)的简单数据帧</figcaption></figure><p id="85e7" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">在典型的数据框中，每一列代表数据的一个特征或属性，而每一行代表一个样本。因此，在描述公司雇员的数据框中，每个雇员占一行，名、姓、ID号、电子邮件地址和薪水列。</p><p id="1c20" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">在本文中，我们将练习在各种设置下使用数据框。我们将练习创建、修改、选择和更新数据框。我们还将了解几乎所有的series方法如何在数据框上工作，为每个数据框列返回一个值。</p><p id="af82" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated"><strong class="jk hs">有用的参考资料</strong></p><p id="f655" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated"><code class="du km kn ko kp b">s.loc</code>通过标签或布尔数组<code class="du km kn ko kp b">s.loc['a']</code> <a class="ae jh" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.loc.html" rel="noopener ugc nofollow" target="_blank">访问系列的元素https://pandas . pydata . org/pandas-docs/stable/reference/API/pandas。Series.loc.html</a></p><p id="74b2" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated"><code class="du km kn ko kp b">s.iloc</code></p><p id="083c" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">按位置访问系列的元素</p><p id="7151" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated"><code class="du km kn ko kp b">s.iloc[0]</code></p><p id="49ee" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated"><a class="ae jh" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.iloc.html" rel="noopener ugc nofollow" target="_blank">https://pandas . pydata . org/pandas-docs/stable/reference/API/pandas。Series.iloc.html</a></p><p id="1e9d" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated"><code class="du km kn ko kp b">s.quantile</code></p><p id="361e" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">获取特定百分比值的值</p><p id="679b" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated"><code class="du km kn ko kp b">s.quantile(0.25)</code></p><p id="5cf6" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated"><a class="ae jh" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.quantile.html" rel="noopener ugc nofollow" target="_blank">https://pandas . pydata . org/pandas-docs/stable/reference/API/pandas。Series.quantile.html</a></p><p id="6a30" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated"><code class="du km kn ko kp b">pd.concat</code></p><p id="0c81" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">将两个数据框连接在一起</p><p id="8f28" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated"><code class="du km kn ko kp b">df = pd.concat([df, new_products])</code></p><p id="f3eb" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated"><a class="ae jh" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.concat.html" rel="noopener ugc nofollow" target="_blank">https://pandas . pydata . org/pandas-docs/stable/reference/API/pandas . concat . html</a></p><p id="b39b" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated"><code class="du km kn ko kp b">df.query</code></p><p id="cf33" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">编写一个类似SQL的查询</p><p id="5d89" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated"><code class="du km kn ko kp b">df.query('v &gt; 300')</code></p><p id="1aa6" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated"><a class="ae jh" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.query.html" rel="noopener ugc nofollow" target="_blank">https://pandas . pydata . org/pandas-docs/stable/reference/API/pandas。DataFrame.query.html</a></p><p id="23a2" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated"><code class="du km kn ko kp b">pd.read_csv</code></p><p id="421e" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">返回基于单列文件的新系列</p><p id="f7c4" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated"><code class="du km kn ko kp b">s = pd.read_csv('filename.csv', squeeze=True)</code></p><p id="131a" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated"><a class="ae jh" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_csv.html" rel="noopener ugc nofollow" target="_blank">https://pandas . pydata . org/pandas-docs/stable/reference/API/pandas . read _ CSV . html</a></p><p id="45a6" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated"><code class="du km kn ko kp b">interpolate</code></p><p id="ed4c" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">返回内插了<code class="du km kn ko kp b">NaN</code>值的新数据帧</p><p id="2931" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated"><code class="du km kn ko kp b">df = df.interpolate()</code></p><p id="ee34" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated"><a class="ae jh" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.interpolate.html" rel="noopener ugc nofollow" target="_blank">https://pandas . pydata . org/pandas-docs/stable/reference/API/pandas。DataFrame.interpolate.html</a></p><p id="72fa" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated"><strong class="jk hs">括号还是圆点？</strong></p><p id="8659" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">当我们处理一个系列时，我们可以用几种不同的方法来检索值:使用索引(和<code class="du km kn ko kp b">loc</code>)，使用位置(和<code class="du km kn ko kp b">iloc</code>)，还可以使用普通的ol '方括号，这基本上相当于<code class="du km kn ko kp b">loc</code>。</p><p id="ca87" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">当我们处理数据帧时，我们必须使用<code class="du km kn ko kp b">loc</code>或<code class="du km kn ko kp b">iloc</code>。那是因为方括号指的是列。如果您尝试使用方括号通过索引检索一行，您将得到一条错误消息，指出不存在这样的列。</p><p id="7e67" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">因此，许多人习惯于使用方括号来检索列就不足为奇了。通常，我们将把列名作为字符串放在方括号内传递。例如:</p><pre class="kr ks kt ku fd lc kp ld le aw lf bi"><span id="41e9" class="lg lh hi kp b fi li lj l lk ll">df['a']  ❶<br/> df['first name']  ❷<br/> df[['a', 'b']] ❸<br/> df['c':'d'] ❹</span></pre><p id="ebbc" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">❶ <strong class="jk hs">返回一个数列，列</strong> <code class="du km kn ko kp b">a</code> <strong class="jk hs">。</strong></p><p id="e878" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">❷ <strong class="jk hs">返回一个数列，列</strong> <code class="du km kn ko kp b">'first name'</code> <strong class="jk hs">。请注意，列名包含一个空格。</strong></p><p id="adcb" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">❸ <strong class="jk hs">返回两列数据帧，列</strong> <code class="du km kn ko kp b">a</code> <strong class="jk hs">和</strong> <code class="du km kn ko kp b">b</code> <strong class="jk hs">从</strong> <code class="du km kn ko kp b">df</code>开始。</p><p id="a7d7" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">❹ <strong class="jk hs">返回</strong> <strong class="jk hs">行</strong> <code class="du km kn ko kp b">'c'</code> <strong class="jk hs">到</strong> <code class="du km kn ko kp b">'d'</code> <strong class="jk hs">、</strong> <strong class="jk hs">包含在内。</strong></p><p id="2e73" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">注意上面的最后一个例子:方括号总是指向列，而不是行。除非，当你传递给他们一个切片，在这种情况下，他们看行。如果您想要检索多个列，那么您必须使用高级索引。您不能使用切片。</p><p id="e20c" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">所有这些都很好，但事实证明还有另一种处理列的方法，即“点标记法”也就是说，如果你想从数据帧<code class="du km kn ko kp b">df</code>中检索列<code class="du km kn ko kp b">colname</code>，你可以说<code class="du km kn ko kp b">df.colname</code>。</p><p id="0b29" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">出于各种原因，这种语法吸引了许多人:它更容易键入，字符更少，因此更容易阅读，而且看起来更自然一些。</p><p id="e4c3" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">但是也有不喜欢它的理由:包含空格和其他非法的Python标识符字符的列将不起作用。我个人发现很难记住<code class="du km kn ko kp b">df.whatever</code>是名为<code class="du km kn ko kp b">whatever</code>的列还是名为<code class="du km kn ko kp b">whatever</code>的<code class="du km kn ko kp b">pandas</code>方法。有太多的方法需要记忆，我会尽我所能帮助你。</p><p id="44f5" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">我个人使用括号符号。如果你更喜欢点符号，你是一个很好的公司——但要意识到有些地方你将无法使用它。</p><p id="56df" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated"><strong class="jk hs">练习8:净收入</strong></p><p id="9723" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">对于许多在工作中使用<code class="du km kn ko kp b">pandas</code>的人来说，从头创建一个新的数据框是很少见的。您将从CSV文件创建它，或者对现有数据框(或多个现有系列)执行一些变换。但是有时您需要创建一个新的数据框，知道如何做是非常有用的。</p><p id="4a17" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">在本练习中，我希望您创建一个数据框，代表一家公司销售的五种不同产品。对于每个产品，我们需要知道产品ID号(任何唯一的两位整数都可以)、产品名称、批发价、零售价以及该产品上个月的销售数量。我们只是在这里弥补，所以如果你一直想成为一个有利可图的星舰经销商，这是你的机会！</p><p id="018c" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">这个练习的任务是计算你从所有这些销售中获得了多少净收入。</p><p id="4087" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated"><strong class="jk hs">讨论</strong></p><p id="ab5a" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">此任务的第一部分涉及创建新的数据框。有许多方法可以做到这一点，包括:</p><ul class=""><li id="eea0" class="lm ln hi jk b jl jm jo jp jr lo jv lp jz lq kd lr ls lt lu bi translated">列表/系列的列表，其中每个内部列表代表一行，列名按位置取值</li><li id="db42" class="lm ln hi jk b jl lv jo lw jr lx jv ly jz lz kd lr ls lt lu bi translated">dict列表，其中的dict键表示每行设置了哪些列</li><li id="7fec" class="lm ln hi jk b jl lv jo lw jr lx jv ly jz lz kd lr ls lt lu bi translated">列表/系列的字典，其中字典键确定列名，然后垂直赋值</li><li id="274c" class="lm ln hi jk b jl lv jo lw jr lx jv ly jz lz kd lr ls lt lu bi translated">二维数字阵列</li></ul><p id="8b26" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">哪一种最合适取决于手头的任务。在这种情况下，因为我想创建和描述单个产品，所以我决定使用字典列表。</p><p id="0b9f" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">注意，多亏了字典键，我不必定义或传递任何列名。这个索引是默认的位置索引，所以我不需要设置它。</p><p id="ebbe" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">有了数据框，我如何计算总收入？这就要求我们从每件产品的零售价中减去批发价，也就是净收入:</p><pre class="kr ks kt ku fd lc kp ld le aw lf bi"><span id="7d04" class="lg lh hi kp b fi li lj l lk ll">df['retail_price'] - df['wholesale_price']</span></pre><p id="651b" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">这里，我们正在检索序列<code class="du km kn ko kp b">df['retail_price']</code>并从中减去序列<code class="du km kn ko kp b">df['wholesale_price']</code>。因为这两个序列彼此平行，具有相同的索引，所以将对每一行进行减法，并将返回一个具有相同索引的新序列，但它们之间存在差异。</p><p id="0323" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">一旦我们有了这个系列，我们将把它乘以每个产品的销售数量:</p><pre class="kr ks kt ku fd lc kp ld le aw lf bi"><span id="90eb" class="lg lh hi kp b fi li lj l lk ll">(df['retail_price'] - df['wholesale_price']) * df['sales'] ❶</span></pre><p id="7f5a" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">❶ <strong class="jk hs">如果没有括号，*操作符就会有优先权，从而打乱计算</strong></p><p id="9ca3" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">这将产生一个新的序列，它与<code class="du km kn ko kp b">df</code>共享一个索引，但是它的值代表每种产品的总销售额。我们可以用<code class="du km kn ko kp b">sum</code>法将这些加在一起:</p><pre class="kr ks kt ku fd lc kp ld le aw lf bi"><span id="2fcd" class="lg lh hi kp b fi li lj l lk ll">((df['retail_price'] - df['wholesale_price']) * df['sales']).sum() ❶</span></pre><p id="8fd2" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">❶ <strong class="jk hs">现在我用括号表示我想对从这组操作中得到的序列调用sum，而不是直接对df['sales']调用。</strong></p><p id="d920" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">解决办法</p><pre class="kr ks kt ku fd lc kp ld le aw lf bi"><span id="0a75" class="lg lh hi kp b fi li lj l lk ll">df = DataFrame([{'product_id':23, 'name':'computer', 'wholesale_price': 500,<br/>                  'retail_price':1000, 'sales':100},<br/>                {'product_id':96, 'name':'Python Workout', 'wholesale_price': 35,<br/>                 'retail_price':75, 'sales':1000},<br/>                {'product_id':97, 'name':'Pandas Workout', 'wholesale_price': 35,<br/>                 'retail_price':75, 'sales':500},<br/>                {'product_id':15, 'name':'banana', 'wholesale_price': 0.5,<br/>                 'retail_price':1, 'sales':200},<br/>                {'product_id':87, 'name':'sandwich', 'wholesale_price': 3,<br/>                 'retail_price':5, 'sales':300},<br/>                ])<br/>  <br/> ((df['retail_price'] - df['wholesale_price']) * df['sales']).sum() ❶<br/> (df['price'] * df['sales']).sum()❶</span></pre><p id="3f8d" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">❶ <strong class="jk hs">返回110700 </strong></p><p id="b8c5" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated"><strong class="jk hs">超越锻炼</strong></p><ul class=""><li id="1441" class="lm ln hi jk b jl jm jo jp jr lo jv lp jz lq kd lr ls lt lu bi translated">在哪些产品上我们的零售价是批发价的两倍以上？</li><li id="72f4" class="lm ln hi jk b jl lv jo lw jr lx jv ly jz lz kd lr ls lt lu bi translated">这家商店从食物、电脑和书籍中赚了多少钱？(您可以只基于索引值进行检索，而不是任何更复杂的东西。)</li><li id="761d" class="lm ln hi jk b jl lv jo lw jr lx jv ly jz lz kd lr ls lt lu bi translated">因为你的商店做得很好，你可以在商品批发价的基础上打7折。计算新的净收入。</li></ul><p id="5f6c" class="pw-post-body-paragraph ji jj hi jk b jl jm is jn jo jp iv jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">本文到此为止。如果你想了解更多，请在曼宁的liveBook平台<a class="ae jh" href="https://livebook.manning.com/book/pandas-workout?origin=product-look-inside" rel="noopener ugc nofollow" target="_blank">点击</a>查看这本书。</p></div></div>    
</body>
</html>