<html>
<head>
<title>Beyond the basics: here are 3 ways I have used JavaScript in Selenium</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">超越基础:以下是我在Selenium中使用JavaScript的3种方式</h1>
<blockquote>原文：<a href="https://medium.com/codex/beyond-the-basics-here-are-3-ways-i-have-used-javascript-in-selenium-272e9417270a?source=collection_archive---------13-----------------------#2021-07-27">https://medium.com/codex/beyond-the-basics-here-are-3-ways-i-have-used-javascript-in-selenium-272e9417270a?source=collection_archive---------13-----------------------#2021-07-27</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="b448" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们大多数人都是从基本的WebDriver命令开始的。是的，他们几乎可以做任何需要与网页互动的事情，比如定位网页元素、点击按钮、发送文本等。但是，你有没有想过<a class="ae jd" href="https://cran.r-project.org/web/packages/RSelenium/vignettes/basics.html#injecting-javascript" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> executeScript </strong> </a>这个命令，为什么Selenium WebDriver一开始会提供JavaScriptExecutor？</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/1620b227f560c27423e17ec74810e902.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*V_o1e4SwaR6QHAXk"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">照片由<a class="ae jd" href="https://unsplash.com/@sigmund?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">西格蒙德</a>在<a class="ae jd" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="0761" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们先来看看Selenium WebDriver是如何工作的。</p><p id="dd82" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">WebDriver通过这些在客户端库中定义的命令来工作(例如，RSelenium用于用R编写的测试脚本)。为了让它们工作，这些命令必须首先通过JSON wire协议进行翻译，然后通过浏览器特定的驱动程序(例如Chrome驱动程序)与浏览器进行通信，最后在浏览器中的web元素上执行。</p><p id="d0dd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">相比之下，JavaScriptExecutor是一个允许JavaScript在当前网页上直接运行的接口。由于JavaScript是浏览器理解的编程语言，所以不需要翻译！这也意味着JavaScriptExecutor允许您执行Selenium命令提供的任务之外的任务，或者当这些命令由于各种原因无法工作时。</p><p id="2fb1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本文中，我将分享JavaScriptExecutor派上用场的三个场景。<strong class="ih hj"> executeScript </strong>是所有这些情况下使用的方法。这种方法在当前选择的窗口/框架中注入JavaScript，不需要信号延迟等特定的时序要求；后者由<strong class="ih hj"> executeAsyncScript </strong>覆盖。</p><ol class=""><li id="be04" class="jv jw hi ih b ii ij im in iq jx iu jy iy jz jc ka kb kc kd bi translated">当WebDriver方法不起作用时:</li></ol><blockquote class="ke kf kg"><p id="27e0" class="if ig ju ih b ii ij ik il im in io ip kh ir is it ki iv iw ix kj iz ja jb jc hb bi translated"><strong class="ih hj">问题:</strong> <strong class="ih hj"> click()方法在Salesforce的lightning框架中不起作用</strong></p></blockquote><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kk"><img src="../Images/a72e700ce30e66df44e934228d6aa9d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1398/format:webp/1*mYCIQRPeGyvL0BAf3vE5mw.png"/></div></div></figure><p id="3f4e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是一个<a class="ae jd" href="https://help.salesforce.com/articleView?id=000352057&amp;language=en_US&amp;mode=1&amp;type=1" rel="noopener ugc nofollow" target="_blank">已知的</a>问题；但是由于它没有被广泛的记录，我花了一些时间去谷歌并找出原因和解决方案。</p><p id="1162" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从2019年底开始，Salesforce开始实施一个标准化框架，该框架以这些lightning web组件(LWC)为特色——如果你想了解更多信息，我推荐<a class="ae jd" href="https://www.youtube.com/watch?v=myrTYZf9roA" rel="noopener ugc nofollow" target="_blank">这个</a> Youtube视频。然而，对于运行自动化来说，对Lightning框架的直接影响是Selenium WebDriver使用的click()方法不能再与web元素交互，因此我在本例中使用clickElement()得到了错误消息。顺便提一下，findElement()仍然有效，可以用来定位web元素。</p><p id="6e8f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">解决方案是使用JavaScript来执行“点击”:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es kl"><img src="../Images/dd62a11cd8d94bca5349c36620fa9480.png" data-original-src="https://miro.medium.com/v2/resize:fit:1392/format:webp/1*vDyO9F9eiLl1zXQt3bIgqA.png"/></div></figure><p id="b466" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.当需要对HTML进行某种修改时:</p><blockquote class="ke kf kg"><p id="762d" class="if ig ju ih b ii ij ik il im in io ip kh ir is it ki iv iw ix kj iz ja jb jc hb bi translated"><strong class="ih hj">问题:发送文本，但字段默认为只读</strong></p></blockquote><p id="178d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我在<a class="ae jd" href="https://siqi-zhu.medium.com/yes-you-can-enter-text-into-a-read-only-text-box-1e330a996e07" rel="noopener">的上一篇文章</a>中谈到过这个技巧，其中<strong class="ih hj"> sendKeysToElement </strong>命令没有立即工作，因为文本被发送到一个只读输入字段。该解决方案需要一个两步过程，在应用WebDriver命令之前，首先注入JavaScript来删除“readonly”属性:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es km"><img src="../Images/f5acf7f3634b927bcbeee9917e2ab8bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TBZWUCm7FC-diaqiNlIsPQ.png"/></div></div></figure><p id="0230" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3.当开发测试脚本时需要验证时:</p><blockquote class="ke kf kg"><p id="aa2f" class="if ig ju ih b ii ij ik il im in io ip kh ir is it ki iv iw ix kj iz ja jb jc hb bi translated"><strong class="ih hj">问题:一次定位多个web元素，但需要一种快速的方法来区分它们</strong></p></blockquote><p id="d4ec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可能已经注意到，在第一期文章中，findElements() 没有定位单个web元素，而是用于部分文本匹配，这将返回一个包含多个元素的列表。您可能想知道我是如何计算出第二个元素“All_reports[[2]]”应该是接收单击操作的元素。嗯，为了识别DOM中与正确元素相对应的元素，我设计了一行代码，以便在我有疑问时可以快速查看:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kn"><img src="../Images/3eaaefef5c7017d917e214b7fc224f7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*04sYJ8QeM5OIvTsBdOt_6g.png"/></div></div></figure><p id="7f2f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个JavaScript可以通过改变所选元素的样式(例如颜色)来提供视觉确认:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ko"><img src="../Images/c7af97a99c987bffac8e35a396c16ea6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VKiL1mfKekxhOnggqGOQkA.png"/></div></div></figure><p id="9b19" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这些就是我的“3美分”。您在Selenium代码中使用过JavaScript吗？如果有，你是如何使用它们的？</p></div></div>    
</body>
</html>