<html>
<head>
<title>WTF JavaScript: A Variable with Side Effects</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">WTF JavaScript:一个有副作用的变量</h1>
<blockquote>原文：<a href="https://medium.com/codex/wtf-javascript-a-variable-with-side-effects-e1f44d2efc06?source=collection_archive---------16-----------------------#2022-01-17">https://medium.com/codex/wtf-javascript-a-variable-with-side-effects-e1f44d2efc06?source=collection_archive---------16-----------------------#2022-01-17</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/02cc1286329b72b6d5f8df9c6588a2bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*--iwlpXmT-D6jChomjgPPg.jpeg"/></div></div></figure><p id="fade" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">JavaScript有许多古怪和难以理解的行为。还有像<a class="ae jo" href="https://www.youtube.com/watch?v=et8xNAc2ic8" rel="noopener ugc nofollow" target="_blank"> WTFJS </a>和<a class="ae jo" href="https://www.destroyallsoftware.com/talks/wat" rel="noopener ugc nofollow" target="_blank"> WAT </a>这样的爆笑言论，取笑JavaScript的怪异之处。</p><p id="28c2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因为我从事重构工作，所以我不得不考虑JavaScript的许多怪异甚至有趣的方面。我将分享我遇到的一些令人惊讶的行为，所以如果你看到了它们(希望你永远不会看到)，它可能会暗示正在发生什么。</p><p id="cd03" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这篇博文探讨了一个看似无辜的说法:</p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="0ab9" class="jy jz hi ju b fi ka kb l kc kd">// ... some code</span><span id="9587" class="jy jz hi ju b fi ke kb l kc kd">helloWorld;</span></pre><p id="83f9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您可能会直觉地认为这里不应该发生任何事情——该语句似乎什么都不做，因为这里没有明显的函数调用。</p><p id="bd5b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然而，它可以做任何事情，例如，打印“Hello World！”到控制台。</p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="0e30" class="jy jz hi ju b fi ka kb l kc kd">// ... some code</span><span id="4a18" class="jy jz hi ju b fi ke kb l kc kd">helloWorld;           // prints "Hello World!"</span></pre><p id="88ec" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这怎么可能呢？</p><p id="b3c9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">原来全局变量(在本例中是<code class="du kf kg kh ju b">helloWorld</code>)是<a class="ae jo" href="https://developer.mozilla.org/en-US/docs/Glossary/Global_object" rel="noopener ugc nofollow" target="_blank">全局对象</a>的属性。和属性不必是简单的值。它们可以使用能够执行代码的<a class="ae jo" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/get" rel="noopener ugc nofollow" target="_blank">getter</a>和<a class="ae jo" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/set" rel="noopener ugc nofollow" target="_blank">setter</a>来实现。因为在现代JavaScript引擎中，全局对象继承自<code class="du kf kg kh ju b">Object.prototype</code>，所以向<code class="du kf kg kh ju b">Object.prototype</code>添加属性会在全局对象上创建属性。</p><p id="6145" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这里，<code class="du kf kg kh ju b">helloWorld</code>被定义为这样一个吸气剂:</p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="ae30" class="jy jz hi ju b fi ka kb l kc kd">Object.defineProperty(Object.prototype, 'helloWorld', {<br/>  get() { console.log("Hello World!"); },<br/>});</span><span id="c7a3" class="jy jz hi ju b fi ke kb l kc kd">helloWorld;           // prints "Hello World!"</span></pre><p id="b785" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">幸运的是，这只会发生在全局变量上，而不会发生在参数或局部变量上。</p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="46ef" class="jy jz hi ju b fi ka kb l kc kd">Object.defineProperty(Object.prototype, 'helloWorld', {<br/>  get() { console.log("Hello World!"); },<br/>});</span><span id="c952" class="jy jz hi ju b fi ke kb l kc kd">const a = helloWorld; // getter is evaluated, prints "Hello World!"<br/>a;                    // does nothing</span></pre><p id="32f7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我在一篇关于 <code class="du kf kg kh ju b"><a class="ae jo" href="https://mathiasbynens.be/notes/globalthis" rel="noopener ugc nofollow" target="_blank">globalThis</a></code> <a class="ae jo" href="https://mathiasbynens.be/notes/globalthis" rel="noopener ugc nofollow" target="_blank">聚划算</a>的<a class="ae jo" href="https://mathiasbynens.be/notes/globalthis" rel="noopener ugc nofollow" target="_blank">博文中了解到了这种奇怪的行为。在polyfill中，全局属性getter用于在不同的环境(如浏览器、web workers、框架、Node.js和es模块)中访问全局<code class="du kf kg kh ju b">this</code>对象。想了解更多就看看吧！</a></p></div></div>    
</body>
</html>