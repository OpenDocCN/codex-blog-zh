<html>
<head>
<title>How to use Promise.all in React to speed up API requests</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在React中使用Promise.all来加速API请求</h1>
<blockquote>原文：<a href="https://medium.com/codex/how-to-use-promise-all-in-react-to-speed-up-api-requests-f13250d64491?source=collection_archive---------17-----------------------#2022-09-04">https://medium.com/codex/how-to-use-promise-all-in-react-to-speed-up-api-requests-f13250d64491?source=collection_archive---------17-----------------------#2022-09-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="e333" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">无论何时创建React应用程序，发出API请求实际上都是一种需要。他们可以非常慢(像https://www.twilio.com的<a class="ae jd" href="https://www.twilio.com" rel="noopener ugc nofollow" target="_blank"/>)或者超级快(https://www.telize.com的<a class="ae jd" href="https://www.telize.com" rel="noopener ugc nofollow" target="_blank"/>)。如果您的应用程序很复杂，要在缓存之前获取必要的数据，您可能需要使用两个或更多API调用，即使使用快速API，它也可能仍然很慢。在本文中，我们将创建一个环境来尽可能快地获取数据。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/12e5ac84e1a9132ebaeeb0891e354b44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VpxOyVsachRrhaPc3PduHA.png"/></div></div></figure><p id="17c8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当我们第一次在<a class="ae jd" href="https://bitraptors.com/" rel="noopener ugc nofollow" target="_blank">bitraphorn</a>开始使用Strapi时，我不得不开始考虑api请求的新方法。</p><pre class="jf jg jh ji fd jq jr js jt aw ju bi"><span id="f9d3" class="jv jw hi jr b fi jx jy l jz ka">💡 Strapi = A Headless Content Manager System, basically a customizable content API</span></pre><p id="65a6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对页面上的内容(如标题、副标题、正文、图片等)有一个调用。)，可能还会有更多的博客帖子、用户评论和其他内容。在缓存之前，单个页面可能偶尔需要两到三次调用，这可能会非常慢。</p><p id="83b7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我的高级开发同事随后向我演示了如何使用<code class="du kb kc kd jr b">Promise.all()</code>来加速这个过程。</p><p id="0e16" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在此之前，我的API调用如下所示:</p><pre class="jf jg jh ji fd jq jr js jt aw ju bi"><span id="ea69" class="jv jw hi jr b fi jx jy l jz ka">❌ THIS PATTERN COULD BE VERY SLOW, THEY RUN AFTER EACH OTHER</span><span id="33a0" class="jv jw hi jr b fi ke jy l jz ka">const pageData = await axios.get(...)<br/>const blogPostsData = await axios.get(...)<br/>const reviewsData = await axios.get(...)</span></pre><p id="822b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">关键字<code class="du kb kc kd jr b">await</code>导致调用顺序运行，而不是并行运行，这是这个解决方案中的问题；整个过程需要3-6秒，1-2秒的API调用，这是一个糟糕的web体验。</p><p id="cd2c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="kf">最好的选择是并行运行这些调用，只需要三个调用中最慢的一个调用完成。</em></p><p id="1ed8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这就是<code class="du kb kc kd jr b">Promise.all</code>的作用</p><pre class="jf jg jh ji fd jq jr js jt aw ju bi"><span id="b0eb" class="jv jw hi jr b fi jx jy l jz ka">🔥 WITH Promise.all() YOU CAN RUN THEM IN PARALLEL WITHOUT await</span><span id="e844" class="jv jw hi jr b fi ke jy l jz ka">const [ pageData, blogPostsData, reviewsData ] = await Promise.all([<br/>  axios.get(...),<br/>  axios.get(...),<br/>  axios.get(...)<br/>])</span></pre><p id="ab8a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">本质上，您必须在一个数组中声明您的数据变量，并且根据变量的顺序将调用传递给<code class="du kb kc kd jr b">Promise.all()</code>的数组。</p><p id="07e2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请注意，在这种情况下，您不需要将<code class="du kb kc kd jr b">await</code>放在呼叫前面；如果您这样做了，调用将一个接一个地执行，从而消除了好处！</p></div><div class="ab cl kg kh gp ki" role="separator"><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl"/></div><div class="hb hc hd he hf"><p id="fba3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">👋我希望这在你寻找新的学习材料时对你有用。感谢您花时间阅读这篇文章！</p><p id="a8b7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你从我的文章中更好地理解了一些东西，你可以请我喝咖啡来支持我:<a class="ae jd" href="https://www.buymeacoffee.com/daanworks" rel="noopener ugc nofollow" target="_blank">https://www.buymeacoffee.com/daanworks</a></p><p id="9e9d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">📯订阅我的电子邮件列表，如果你想在未来读到更多这样的故事，请在这里或Twitter上关注我</p><h1 id="2aef" class="kn jw hi bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">Bit:构建更好的UI组件库</h1><p id="9c8a" class="pw-post-body-paragraph if ig hi ih b ii lk ik il im ll io ip iq lm is it iu ln iw ix iy lo ja jb jc hb bi translated">向<a class="ae jd" href="https://bit.cloud" rel="noopener ugc nofollow" target="_blank">的<strong class="ih hj">位</strong>的</a>问好。它是组件驱动应用程序开发的首选工具。</p><p id="b4b1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用Bit，您可以将应用程序的任何部分创建为可组合和可重用的“组件”。您和您的团队可以共享一个组件工具箱，以便更快、更一致地构建更多应用。</p><ul class=""><li id="f0d8" class="lp lq hi ih b ii ij im in iq lr iu ls iy lt jc lu lv lw lx bi translated">创建和编写“<strong class="ih hj">应用构建模块</strong>”:UI元素、完整功能、页面、应用、无服务器或微服务。任何JS栈。</li><li id="5c01" class="lp lq hi ih b ii ly im lz iq ma iu mb iy mc jc lu lv lw lx bi translated">轻松地<strong class="ih hj">共享，并作为一个团队重用</strong>组件。</li><li id="d585" class="lp lq hi ih b ii ly im lz iq ma iu mb iy mc jc lu lv lw lx bi translated">快速<strong class="ih hj">跨项目更新</strong> <strong class="ih hj">组件</strong>。</li><li id="6a72" class="lp lq hi ih b ii ly im lz iq ma iu mb iy mc jc lu lv lw lx bi translated">化难为易:<a class="ae jd" href="https://bit.cloud/blog/painless-monorepo-dependency-management-with-bit-l4f9fzyw" rel="noopener ugc nofollow" target="_blank"> Monorepos </a>，<a class="ae jd" href="https://blog.bitsrc.io/how-we-build-our-design-system-15713a1f1833" rel="noopener ugc nofollow" target="_blank">设计系统</a> &amp; <a class="ae jd" href="https://blog.bitsrc.io/how-we-build-micro-front-ends-d3eeeac0acfc" rel="noopener ugc nofollow" target="_blank">微前端</a>。</li></ul><p id="9789" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jd" href="https://bit.cloud" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">尝试Bit开源免费→ </strong> </a></p><figure class="jf jg jh ji fd jj er es paragraph-image"><a href="https://bit.cloud"><div class="er es md"><img src="../Images/9e504def49038e8ee350049355d52d01.png" data-original-src="https://miro.medium.com/v2/resize:fit:752/format:webp/1*p3UFa6xnmmbrkTzfRm_EmQ.png"/></div></a></figure></div><div class="ab cl kg kh gp ki" role="separator"><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl"/></div><div class="hb hc hd he hf"><h1 id="cad4" class="kn jw hi bd ko kp me kr ks kt mf kv kw kx mg kz la lb mh ld le lf mi lh li lj bi translated">了解更多信息</h1><div class="mj mk ez fb ml mm"><a href="https://blog.bitsrc.io/how-we-build-micro-front-ends-d3eeeac0acfc" rel="noopener  ugc nofollow" target="_blank"><div class="mn ab dw"><div class="mo ab mp cl cj mq"><h2 class="bd hj fi z dy mr ea eb ms ed ef hh bi translated">我们如何构建微前端</h2><div class="mt l"><h3 class="bd b fi z dy mr ea eb ms ed ef dx translated">构建微前端来加速和扩展我们的web开发过程。</h3></div><div class="mu l"><p class="bd b fp z dy mr ea eb ms ed ef dx translated">blog.bitsrc.io</p></div></div><div class="mv l"><div class="mw l mx my mz mv na jo mm"/></div></div></a></div><div class="mj mk ez fb ml mm"><a href="https://blog.bitsrc.io/how-we-build-our-design-system-15713a1f1833" rel="noopener  ugc nofollow" target="_blank"><div class="mn ab dw"><div class="mo ab mp cl cj mq"><h2 class="bd hj fi z dy mr ea eb ms ed ef hh bi translated">我们如何构建一个组件设计系统</h2><div class="mt l"><h3 class="bd b fi z dy mr ea eb ms ed ef dx translated">用组件构建一个设计系统来标准化和扩展我们的UI开发过程。</h3></div><div class="mu l"><p class="bd b fp z dy mr ea eb ms ed ef dx translated">blog.bitsrc.io</p></div></div><div class="mv l"><div class="nb l mx my mz mv na jo mm"/></div></div></a></div><div class="mj mk ez fb ml mm"><a href="https://bit.cloud/blog/how-to-reuse-react-components-across-your-projects-l3bhezsg" rel="noopener  ugc nofollow" target="_blank"><div class="mn ab dw"><div class="mo ab mp cl cj mq"><h2 class="bd hj fi z dy mr ea eb ms ed ef hh bi translated">如何在项目中重用React组件</h2><div class="mt l"><h3 class="bd b fi z dy mr ea eb ms ed ef dx translated">最后，您完成了在应用程序中为时事通讯创建一个奇妙的输入字段的任务。你对…很满意</h3></div><div class="mu l"><p class="bd b fp z dy mr ea eb ms ed ef dx translated">比特云</p></div></div><div class="mv l"><div class="nc l mx my mz mv na jo mm"/></div></div></a></div><div class="mj mk ez fb ml mm"><a href="https://blog.bitsrc.io/5-ways-to-build-a-react-monorepo-a294b6c5b0ac" rel="noopener  ugc nofollow" target="_blank"><div class="mn ab dw"><div class="mo ab mp cl cj mq"><h2 class="bd hj fi z dy mr ea eb ms ed ef hh bi translated">构建React Monorepo的5种方法</h2><div class="mt l"><h3 class="bd b fi z dy mr ea eb ms ed ef dx translated">构建生产级React monorepo:从快速构建到代码共享和依赖。</h3></div><div class="mu l"><p class="bd b fp z dy mr ea eb ms ed ef dx translated">blog.bitsrc.io</p></div></div><div class="mv l"><div class="nd l mx my mz mv na jo mm"/></div></div></a></div></div></div>    
</body>
</html>