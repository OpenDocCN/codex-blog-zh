<html>
<head>
<title>Starting new web service business from IT point of view — ChatPilot case study</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从IT角度开始新的web服务业务— ChatPilot案例研究</h1>
<blockquote>原文：<a href="https://medium.com/codex/starting-new-web-service-business-from-it-point-of-view-chatpilot-case-study-cc89c0877d9e?source=collection_archive---------39-----------------------#2022-06-14">https://medium.com/codex/starting-new-web-service-business-from-it-point-of-view-chatpilot-case-study-cc89c0877d9e?source=collection_archive---------39-----------------------#2022-06-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="1417" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一家公司想要启动一项新的web服务——一个用于客户支持的消息聚合器。你如何从一个想法变成一个Python/Vue/Socket。IO web应用？这是it开发团队讲的一个<a class="ae jd" href="https://chatpilot.io/" rel="noopener ugc nofollow" target="_blank"> ChatPilot.io </a>的故事。</p><h1 id="df8a" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">通信聚合器</h1><p id="fb6d" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated"><a class="ae jd" href="https://chatpilot.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> ChatPilot </strong> </a>是一个用于客户支持的通信聚合器。你经营一家企业，你有自己的脸书粉丝页面、Instagram个人资料，甚至可能有一个WhatsApp号码——客户会通过所有这些渠道联系你。为了管理所有这样的通信，公司倾向于使用聚合器。这些应用程序将Facebook Messenger或WhatsApp等消息平台聚合成一个(通常)网络应用程序，企业员工可以在其中更有效地管理企业与客户的沟通。</p><p id="2757" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有聚合通信的应用程序，甚至有公司提供API/服务来制作这样的应用程序。这类应用的市场已经相当成熟，与其他在线服务相比，这些服务并不便宜。如果你做了你的聚合器，它将很快面对许多成熟的应用程序，这些应用程序已经有了固定的品牌和客户基础。那么怎么做，怎么做呢？</p><p id="e9ca" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">答案是开发一个比现有应用程序更有价值的应用程序。你不能只做一个应用程序，它必须从一开始就以提供独特的价值为目标，并且非常敏捷地适应早期的客户反馈或商业机会。说起来容易做起来难…</p><h1 id="bf71" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">团队</h1><p id="2b78" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">我在<a class="ae jd" href="https://socialwifi.com" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">社交WiFi </strong> </a>工作，该公司为开放WiFi网络提供强制门户服务。从代码方面来看，它由几个微服务组成，其中大多数运行Flask，并提供某种API或处理芹菜队列。很少有像仪表板一样是在Ember.js中制作的。该项目部署到谷歌云。这个服务的最初版本，在5年多以前，是作为一个整体的Django应用程序编写的，随着时间的推移，它开始出现问题，包括地理缩放；)</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es kh"><img src="../Images/c2be9d4a924a1adbaf84e91a1a47e7a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wbA9LHrlAaEFZ9OEIT2aoA.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">用Ember.js制作的社交WiFi仪表盘</figcaption></figure><p id="b379" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ChatPilot计划作为公司产品组合中的一项附加服务，同时也与强制网络门户服务有一些协同作用。为了这个项目，我们创建了一个2人团队:CTO——规划、开发运维、代码评审和rubber ducky。Fullstack (Python/Fronted)开发人员——也就是我——来完成任务。我们也有一个产品负责人的职位，主要负责UX/用户界面的规划和审查。</p><h1 id="ae99" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">研究</h1><p id="8564" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">在我们开始对公司的业务部分进行编码之前，我们的首席技术官已经做了研究——查看了现有的聚合器，也联系了一些使用这类应用的客户，过了一段时间，他们对这个市场有了一些了解。其中一个发现是，我们的一个合作伙伴的客户使用的是旧的聚合器，不是很好，主要是因为消息在应用程序中显示很慢，或者根本没有显示。低质量/破损的应用程序是你可以与之竞争的，但是你的竞争对手不太可能都有如此明显的问题。</p><p id="40d8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了启动许多应用程序，你可以使用一个服务提供者来为你做所有的粗活，并公开好的API来工作。不利的一面是，它不是免费的，你成为供应商锁定给定的服务提供商。在某些情况下，使用第三方服务来绕过应用程序的一些原始部分可能是值得的——无论是永久地，还是对于在所述原始数据基础上快速交付价值的早期版本。</p><p id="95a7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们最初确实考察了一家通信服务提供商和该公司的业务部门，甚至与他们进行了交谈，并为开发建立了一个沙盒。然而，很快就发现他们的定价对于早期版本和小规模客户来说是不可行的。因此，我们决定将它们作为未来大批量客户的选择。这样的开发者服务将允许我们快速处理多种渠道，但价格不菲。我们必须开发自己对Messenger和Instagram的支持，以便能够首先推出和扩展。</p><h1 id="8889" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">选择技术</h1><p id="f1e7" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">我们的目标是在应用程序和WhatsApp或Messenger等沟通渠道之间实现近乎实时的沟通。该应用程序必须在消息到达时接收并显示消息，尽可能减少延迟。那么，你如何获得传入的消息呢？您可以拉一个REST API端点，但是不断地用HTTP请求访问您的后端不是很有效。Websockets 将是首选，尽管浏览器支持和处理仍有一些不同，所以我们要么必须处理它，要么找到一个为我们处理它的库。这样的库确实存在，叫做<strong class="ih hj"> socket.io </strong>。</p><p id="a1ef" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用socket.io，您可以在SPA JS网页中创建一个客户端，连接到用Python等语言编写的socket.io服务器。业务代理打开仪表板，它将他连接到服务器并等待事件——如新消息、新对话，但也允许他向服务器发送事件，如<strong class="ih hj">发送回复</strong>。你可以在<a class="ae jd" href="https://socket.io/" rel="noopener ugc nofollow" target="_blank"> socket.io </a>原例子上看到基本流程。</p><p id="7b8d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在开始ChatPilot之前，我们使用Ember.js作为我们的SPA仪表盘，但对于这个项目，我们考虑了其他选项，如Angular和Vue。尽管Ember对我们来说工作得很好，但我们还是想看看更受欢迎的平台是否能提供一些优势。有了Ember，我们可以更快地开始开发应用程序，并且我们会熟悉所有的解决方案和库。有了新的平台，我们将在没有经验或不了解所有细节的情况下全新进入。</p><p id="0c92" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">那么<strong class="ih hj"> Ember </strong>还是<strong class="ih hj"> Vue </strong>？我们有点担心Ember较低的受欢迎程度会随着时间的推移限制方便的第三方解决方案的可用性，并且切换到一个更受欢迎的框架会允许我们在未来雇佣已经知道它的开发人员。我们在Vue中做了一些hello world类型的简单项目，我们检查了socket.io集成看起来如何，以及其他开发者如何/是否做了与我们类似的项目。它看起来不错，所以我们决定为这个项目选择vue而不是ember。</p><ul class=""><li id="3419" class="kx ky hi ih b ii ij im in iq kz iu la iy lb jc lc ld le lf bi translated">Flask/JSONApi微服务</li><li id="1bfe" class="kx ky hi ih b ii lg im lh iq li iu lj iy lk jc lc ld le lf bi translated">Vue.js仪表板</li><li id="c6f7" class="kx ky hi ih b ii lg im lh iq li iu lj iy lk jc lc ld le lf bi translated">顺风CSS和顺风UI</li><li id="6e3b" class="kx ky hi ih b ii lg im lh iq li iu lj iy lk jc lc ld le lf bi translated">Socket.io服务器</li><li id="0bf4" class="kx ky hi ih b ii lg im lh iq li iu lj iy lk jc lc ld le lf bi translated">谷歌云</li><li id="1f25" class="kx ky hi ih b ii lg im lh iq li iu lj iy lk jc lc ld le lf bi translated">Kubernetes和Docker</li><li id="7de1" class="kx ky hi ih b ii lg im lh iq li iu lj iy lk jc lc ld le lf bi translated">敏捷开发</li></ul><h1 id="c25d" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">原型</h1><p id="8bce" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">项目从原型开始—展示技术并了解项目的风险。我们从一个非常基本的Vue项目开始，该项目必须提供一组非常简单的功能，并逐步增加:</p><ol class=""><li id="787f" class="kx ky hi ih b ii ij im in iq kz iu la iy lb jc ll ld le lf bi translated">连接到SIO服务器，并显示服务器在连接事件时发送回的固定消息</li><li id="4183" class="kx ky hi ih b ii lg im lh iq li iu lj iy lk jc ll ld le lf bi translated">发送消息，使服务器发送一个固定的响应。</li><li id="f7f8" class="kx ky hi ih b ii lg im lh iq li iu lj iy lk jc ll ld le lf bi translated">使用socket.io room功能，允许两个独立的连接互相通话(查看对方消息)</li></ol><p id="af50" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对原型的这种增量工作使我们能够验证Socket.io和vue.js，因为它们对我们来说都是新技术。我们确实使用了<strong class="ih hj"> Vue 3 </strong>，这是相当新的，并不是每个第三方Vue库都支持它。我们确实遇到过几次这个问题，不得不寻找vue3分叉(比如vue-3-socket.io)之类的。最后，我们放弃了vue-3-socket.io，转而直接使用socket.io客户端，以获得额外的灵活性(如身份验证等)。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es lm"><img src="../Images/cf23700bed0674665722e5c85a0262d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DfZVG8Q92bOTYsLWiF8u7Q.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">第一个带有固定消息的原型</figcaption></figure><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es ln"><img src="../Images/d7358c7d9ea17eee7b7e49f64edcdf21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LnV62i2AGEwDHENABgjQjA.jpeg"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">布局的初始版本，在Tailwind CSS和Tailwind UI的帮助下</figcaption></figure><h1 id="f59c" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">从原型到生产</h1><p id="d8aa" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">第一次使用一个框架，并在一开始就制作一个基本的原型，并不会导致所有的东西都被编码和优化设计，甚至从一开始就是好的。我们使用Ember，但我们从来没有使用Vue，所以这种变化是一个学习曲线。我们并没有从一开始就使用所有流行的Vue扩展。早期的原型不需要路由，所以没有vue路由器，我们甚至没有使用任何像Vuex这样的存储层，但后来改用了Pinia。</p><p id="781e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们从一个简单的原型开始，致力于基本特性的列表。随着事情从原型转移到预期的产品特性，我们不得不大量重构代码库——用真实的解决方案重新实现占位符解决方案。像开始时一样，服务器将消息存储在Python列表中，然后用数据库替换。从前端/原型方面来看，一切都没有改变(除了在服务器重启后没有丢失消息；)然而项目还是向前推进了。同样的变化也发生在vue中——我们使用JS阵列，但转移到Pinia进行存储处理，并从Vue组件中转移此类逻辑。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es lo"><img src="../Images/a4f085109d98520105299192b40aa9cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SFwwlV8vPl85qppz56guQA.jpeg"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">仪表板的当前版本</figcaption></figure><p id="3f5e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">做一个非常愚蠢的早期原型让我们开始验证技术和应用程序的想法，更不用说早期的UX/UI工作了。由于这还不是生产级别，我们还被允许进行突破性的更改，根据需要创建和删除数据。我们从使用通常愚蠢的占位符解决方案的基本功能原型开始，当它对展示有效时，我们继续将其重构为永久的解决方案。这就形成了一个循环，在这个循环中，企业看到了一些新的功能或工作原型，然后在一段时间内，当我们重构/重新实现事物时，外部没有任何变化，然后就可以开始实现虚拟占位符解决方案不可能实现的功能。这一点已经传达给了企业，因此缺少变化并不意味着什么都没有发生。</p><p id="d150" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">即使有永久性的解决方案，这些解决方案也是为早期原型设计的，所以随着时间的推移，很多事情都发生了变化。例如，随着时间的推移，我们从简单的消息模型开始，我们必须开始区分客户和代理消息，然后处理其他特殊的消息类型。您可以开始向表中添加可选列，但这不是很干净。因此，在SQLAlchemy模型的帮助下，我们在基本消息模型和从它继承的所有消息类型模型之间建立多态关系。这样，您可以轻松地选择所有消息的时间线/日期范围，并为每种消息类型创建独特的模型。</p><p id="231f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该项目设法转移到生产，并在开发过程中获得了一些早期客户。事情不能再中断了(消息模型迁移必须有计划，并且Vue dashboard与两个版本兼容),但是我们仍然可以继续推进项目。当我们学习新的软件堆栈，当新的东西变得需要或对我们有益时，我们实现并重构，这似乎是早期原型/生产方法的发展方向。</p></div><div class="ab cl lp lq gp lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="hb hc hd he hf"><p id="0883" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="lw">最初发布于</em><a class="ae jd" href="https://rk.edu.pl/en/starting-new-web-service-business-from-it-point-of-view-chatpilot-case-study/" rel="noopener ugc nofollow" target="_blank"><em class="lw">https://rk . edu . pl</em></a><em class="lw">。</em></p></div></div>    
</body>
</html>