<html>
<head>
<title>Introduction to Algorithmic Trading with Quantopian</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Quantopian算法交易简介</h1>
<blockquote>原文：<a href="https://medium.com/codex/introduction-to-algorithmic-trading-with-quantopian-7ac424a28d49?source=collection_archive---------3-----------------------#2020-09-11">https://medium.com/codex/introduction-to-algorithmic-trading-with-quantopian-7ac424a28d49?source=collection_archive---------3-----------------------#2020-09-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/510babbf635d6ebf84647dfad2a95511.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*I5a3vEvxS1SFx0D5"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">米卡·鲍梅斯特在<a class="ae hv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><div class=""/><div class=""><h2 id="140e" class="pw-subtitle-paragraph iv hx hy bd b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm dx translated">了解如何在Quantopian中创建简单的交易算法</h2></div><h1 id="f2de" class="jn jo hy bd jp jq jr js jt ju jv jw jx je jy jf jz jh ka ji kb jk kc jl kd ke bi translated">算法交易</h1><p id="0245" class="pw-post-body-paragraph kf kg hy kh b ki kj iz kk kl km jc kn ko kp kq kr ks kt ku kv kw kx ky kz la hb bi lb translated">在开始研究算法交易之前，了解算法是很重要的。基本上，算法是用来解决简单或复杂问题的一组指令。由于技术和编程的发展趋势，交易者和投资者改变了股票交易系统，以适应技术，这就是算法交易开始发挥作用的地方。算法交易是股票交易的自动化过程，当一组给定的指令被满足时，该过程执行指令。这种特殊类型的交易主要是为了速度和克服市场情绪而开发的。</p><h1 id="609a" class="jn jo hy bd jp jq jr js jt ju jv jw jx je jy jf jz jh ka ji kb jk kc jl kd ke bi translated">算法交易的量子乌托邦</h1><p id="0667" class="pw-post-body-paragraph kf kg hy kh b ki kj iz kk kl km jc kn ko kp kq kr ks kt ku kv kw kx ky kz la hb bi translated">Quantopian是一家总部位于美国的公司，人们可以在这里合作、学习、开发、测试和分享他们的交易算法和回溯测试结果。Quantopian为其用户提供免费教育、各种quant工具和数据，这样任何人都可以从事定量分析和算法交易。要获得Quantopian的实际操作，您必须对python代码有一些基本的了解，因为它是Quantopian控制台上唯一支持的编程语言。让我们用Quantopian编写一个算法，并对其进行回测！</p><h1 id="5d6a" class="jn jo hy bd jp jq jr js jt ju jv jw jx je jy jf jz jh ka ji kb jk kc jl kd ke bi translated">在Quantopian中创建算法</h1><p id="bd29" class="pw-post-body-paragraph kf kg hy kh b ki kj iz kk kl km jc kn ko kp kq kr ks kt ku kv kw kx ky kz la hb bi translated">在本文中，我们将创建一个基本的简单移动平均线(SMA)交易策略来交易FAANG(脸书、亚马逊、苹果、网飞和谷歌)的股票。除此之外，我们还将利用我们的交易获得更好的夏普比率和回报</p><h2 id="275f" class="lk jo hy bd jp ll lm ln jt lo lp lq jx ko lr ls jz ks lt lu kb kw lv lw kd lx bi translated">步骤1:在Quantopian中创建帐户</h2><p id="5126" class="pw-post-body-paragraph kf kg hy kh b ki kj iz kk kl km jc kn ko kp kq kr ks kt ku kv kw kx ky kz la hb bi translated">在进入我们的编码部分之前，请记住，您必须拥有一个Quantopian帐户才能访问其编码控制台和笔记本。如果您在Quantopian中成功创建或拥有了一个帐户，您可以在导航栏中找到“研究”,然后在选项下选择“算法”。之后，你将登陆“算法”页面，在那里你可以找到“新算法”选项。选择该选项，您将进入一个编码控制台页面，我们将在这里对我们的交易算法进行编码。</p><h2 id="eabf" class="lk jo hy bd jp ll lm ln jt lo lp lq jx ko lr ls jz ks lt lu kb kw lv lw kd lx bi translated">步骤2:初始化和安排我们的交易功能</h2><p id="beee" class="pw-post-body-paragraph kf kg hy kh b ki kj iz kk kl km jc kn ko kp kq kr ks kt ku kv kw kx ky kz la hb bi translated">按照下面提到的代码及其解释来初始化和安排我们的交易功能。</p><figure class="ly lz ma mb fd hk"><div class="bz dy l di"><div class="mc md l"/></div></figure><p id="2683" class="pw-post-body-paragraph kf kg hy kh b ki me iz kk kl mf jc kn ko mg kq kr ks mh ku kv kw mi ky kz la hb bi translated"><strong class="kh hz">解释:</strong>首先，我们定义一个名为‘initialize’的函数，它将context(一个存储信息的Python字典)作为参数，只在我们的程序开始运行时运行一次。在里面，我们使用一个名为“sid”的函数来存储我们感兴趣的公司的信息。不要担心里面的数字，因为当你在Quantopian控制台中键入“sid”时，会弹出一个搜索栏，你只需输入你感兴趣的公司名称。之后，我们调用“schedule_function”来运行我们的交易算法，稍后我们将创建该算法。</p><h2 id="5110" class="lk jo hy bd jp ll lm ln jt lo lp lq jx ko lr ls jz ks lt lu kb kw lv lw kd lx bi translated">步骤3:创建交易算法</h2><p id="a438" class="pw-post-body-paragraph kf kg hy kh b ki kj iz kk kl km jc kn ko kp kq kr ks kt ku kv kw kx ky kz la hb bi translated">我们创建交易算法的第三步分为三个部分:获取历史数据，创建SMA指标，最后创建交易策略和杠杆。</p><p id="6421" class="pw-post-body-paragraph kf kg hy kh b ki me iz kk kl mf jc kn ko mg kq kr ks mh ku kv kw mi ky kz la hb bi translated"><strong class="kh hz"> a)获取历史数据:</strong></p><p id="1fe8" class="pw-post-body-paragraph kf kg hy kh b ki me iz kk kl mf jc kn ko mg kq kr ks mh ku kv kw mi ky kz la hb bi translated">正如我之前提到的，我们将获得FAANG的股票价格，并使用它们来制定我们的战略。按照代码和解释提取FAANG的价格数据。在此之前，我们必须定义一个函数“ma_strategy ”,我们已经在前面的代码中初始化了它。</p><figure class="ly lz ma mb fd hk"><div class="bz dy l di"><div class="mc md l"/></div></figure><p id="5222" class="pw-post-body-paragraph kf kg hy kh b ki me iz kk kl mf jc kn ko mg kq kr ks mh ku kv kw mi ky kz la hb bi translated"><strong class="kh hz">解释:</strong>正如我说过的，我们通过定义一个函数‘ma _ strategy’来开始我们的代码，我们创建的所有算法都在这个函数中实现。定义函数后，我们使用一个名为“history”的函数提取历史价格数据。在这个函数中，我们传递一些特定的参数来获取公司的价格数据。</p><p id="8657" class="pw-post-body-paragraph kf kg hy kh b ki me iz kk kl mf jc kn ko mg kq kr ks mh ku kv kw mi ky kz la hb bi translated"><strong class="kh hz"> b)创建SMA指示器:</strong></p><p id="d47e" class="pw-post-body-paragraph kf kg hy kh b ki me iz kk kl mf jc kn ko mg kq kr ks mh ku kv kw mi ky kz la hb bi translated">在我们刚刚创建的函数“ma_strategy”下，我们将计算FAANG的SMA 20和SMA 50，以建立我们的交易策略。按照代码和说明创建FAANG的SMA指标。</p><figure class="ly lz ma mb fd hk"><div class="bz dy l di"><div class="mc md l"/></div></figure><p id="9a39" class="pw-post-body-paragraph kf kg hy kh b ki me iz kk kl mf jc kn ko mg kq kr ks mh ku kv kw mi ky kz la hb bi translated"><strong class="kh hz">解释:</strong>我们通过使用简单的函数‘mean’为FAANG创建SMA 20指标，然后创建SMA 50指标来开始我们的代码。</p><p id="fd45" class="pw-post-body-paragraph kf kg hy kh b ki me iz kk kl mf jc kn ko mg kq kr ks mh ku kv kw mi ky kz la hb bi translated"><strong class="kh hz"> c)创建交易策略和杠杆:</strong></p><p id="d16a" class="pw-post-body-paragraph kf kg hy kh b ki me iz kk kl mf jc kn ko mg kq kr ks mh ku kv kw mi ky kz la hb bi translated">在本节中，我们将创建一个SMA交叉交易策略，我们还将创建一个变量，以避免为一个单一的SMA交叉交易执行多个订单。通过查看代码和解释，您将清楚地了解我所说的内容，并记住每个代码都属于“ma_strategy”函数。</p><figure class="ly lz ma mb fd hk"><div class="bz dy l di"><div class="mc md l"/></div></figure><p id="31be" class="pw-post-body-paragraph kf kg hy kh b ki me iz kk kl mf jc kn ko mg kq kr ks mh ku kv kw mi ky kz la hb bi translated"><strong class="kh hz">解释:</strong>首先，我们通过传递函数“get_open_orders”来创建一个名为“open_orders”的变量，该函数只返回具有活动状态的订单对象。之后，我们正在创建一个“买入”策略，当FAANG的SMA 20大于SMA 50时，返回买入。您还可以观察到，只有在变量“open_orders”中没有列出时，订单才会被执行，这有助于我们避免在一次交易中多次执行订单。在我们的“买入”策略之后，我们正在创建一个“卖出”策略，当FAANG的SMA 50大于SMA 20时，做空该股票。在我们的整个策略中，我们使用了“order_target_percent”函数，该函数帮助我们执行指定公司和指定百分比的订单。例如，我们在所有的“买入”策略中都提到了“0.20”，也就是说，我们的投资组合中有20%是这只股票。最后，我们使用“记录”功能创建一个自定义变量，以创建一个利用我们所有交易的变量“杠杆”。</p><p id="0c3a" class="pw-post-body-paragraph kf kg hy kh b ki me iz kk kl mf jc kn ko mg kq kr ks mh ku kv kw mi ky kz la hb bi translated">我们现在开始回测我们的交易算法。为此，您可以点击“构建算法”选项进行样本回溯测试，或者点击“运行完整回溯测试”获得完整的回溯测试报告。</p><h1 id="40f8" class="jn jo hy bd jp jq jr js jt ju jv jw jx je jy jf jz jh ka ji kb jk kc jl kd ke bi translated"><strong class="ak">回溯测试结果</strong></h1><figure class="ly lz ma mb fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mj"><img src="../Images/5b125f05d2d3114ffc79be895eda8d81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H5mlTpE92OkTQ8F5x6koWw.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">作者图片</figcaption></figure><p id="bdd7" class="pw-post-body-paragraph kf kg hy kh b ki me iz kk kl mf jc kn ko mg kq kr ks mh ku kv kw mi ky kz la hb bi translated">我们得到了很好的回溯测试结果！我们创建的交易算法总回报率为60.02%，相对高于我们的基准(间谍)。我们还获得了2.65%的夏普比率。上述结果的时间范围为2019年9月11日至2020年9月10日，我的初始资本金额为1000万英镑。您还可以通过将鼠标悬停在“风险”、“性能”等其他选项上来查看更多详细信息。您还可以在“活动”选项中查看您的交易。请注意，每一段代码和解释都严格用于教育目的，不应被视为投资建议。如果您错过了任何编码部分，请不要担心，因为我已经提供了这个交易算法的完整代码</p><p id="0dc8" class="pw-post-body-paragraph kf kg hy kh b ki me iz kk kl mf jc kn ko mg kq kr ks mh ku kv kw mi ky kz la hb bi translated">除了这个算法，你还可以用Quantopian做更多的事情。您还可以利用Quantopian中的笔记本部分进行进一步的分析，并使用pipeline等工具。更多工具可以参考Quantopian文档。所以永远不要停止学习，永远不要停止编码！</p><p id="4031" class="pw-post-body-paragraph kf kg hy kh b ki me iz kk kl mf jc kn ko mg kq kr ks mh ku kv kw mi ky kz la hb bi translated"><strong class="kh hz">快乐的Algo交易！</strong></p><p id="d8df" class="pw-post-body-paragraph kf kg hy kh b ki me iz kk kl mf jc kn ko mg kq kr ks mh ku kv kw mi ky kz la hb bi translated"><strong class="kh hz">完整代码:</strong></p><figure class="ly lz ma mb fd hk"><div class="bz dy l di"><div class="mc md l"/></div></figure></div></div>    
</body>
</html>