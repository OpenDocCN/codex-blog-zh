<html>
<head>
<title>Funny Leetcode Hard Problem — Basic Calculator</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">有趣的Leetcode难题—基本计算器</h1>
<blockquote>原文：<a href="https://medium.com/codex/funny-leetcode-hard-problem-basic-calculator-79e86c8fa26b?source=collection_archive---------3-----------------------#2022-09-18">https://medium.com/codex/funny-leetcode-hard-problem-basic-calculator-79e86c8fa26b?source=collection_archive---------3-----------------------#2022-09-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="e6ff" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">解决leetcode难题的全部故事和我的错误</h2></div><p id="e5ac" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">今天是星期天！！！我想在leetcode上解决一些计算器问题，因为最近我正在解决包含按位and，按位or和按位not的表达式，我将在以后的其他帖子中告诉你这个故事。</p><p id="f44d" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">首先，只谈基本的计算器问题，所以阅读问题陈述。</p><h1 id="d47d" class="jt ju hi bd jv jw jx jy jz ka kb kc kd io ke ip kf ir kg is kh iu ki iv kj kk bi translated">问题</h1><p id="d18a" class="pw-post-body-paragraph ix iy hi iz b ja kl ij jc jd km im jf jg kn ji jj jk ko jm jn jo kp jq jr js hb bi translated">224.<strong class="iz hj">基础计算器</strong> ( <strong class="iz hj">硬</strong> ) 4069喜欢325不喜欢</p><div class="kq kr ez fb ks kt"><a href="https://leetcode.com/problems/basic-calculator/" rel="noopener  ugc nofollow" target="_blank"><div class="ku ab dw"><div class="kv ab kw cl cj kx"><h2 class="bd hj fi z dy ky ea eb kz ed ef hh bi translated">基本计算器- LeetCode</h2><div class="la l"><h3 class="bd b fi z dy ky ea eb kz ed ef dx translated">给定一个表示有效表达式的字符串s，实现一个基本的计算器来计算它，并返回…</h3></div><div class="lb l"><p class="bd b fp z dy ky ea eb kz ed ef dx translated">leetcode.com</p></div></div><div class="lc l"><div class="ld l le lf lg lc lh li kt"/></div></div></a></div><p id="efc8" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">给定一个表示有效表达式的字符串<code class="du lj lk ll lm b">s</code>，实现一个基本的计算器来计算它，并返回<em class="ln">计算结果</em>。</p><p id="e2e4" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">注意:</strong>你<strong class="iz hj">不</strong>被允许使用任何将字符串作为数学表达式求值的内置函数，比如<code class="du lj lk ll lm b">eval()</code>。</p><p id="6cf2" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">例1: </strong></p><pre class="lo lp lq lr fd ls lm lt lu aw lv bi"><span id="e77b" class="lw ju hi lm b fi lx ly l lz ma"><strong class="lm hj">Input:</strong> s = "1 + 1"<br/><strong class="lm hj">Output:</strong> 2</span></pre><p id="685e" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">例2: </strong></p><pre class="lo lp lq lr fd ls lm lt lu aw lv bi"><span id="69e3" class="lw ju hi lm b fi lx ly l lz ma"><strong class="lm hj">Input:</strong> s = " 2-1 + 2 "<br/><strong class="lm hj">Output:</strong> 3</span></pre><p id="d1ba" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">例3: </strong></p><pre class="lo lp lq lr fd ls lm lt lu aw lv bi"><span id="4313" class="lw ju hi lm b fi lx ly l lz ma"><strong class="lm hj">Input:</strong> s = "(1+(4+5+2)-3)+(6+8)"<br/><strong class="lm hj">Output:</strong> 23</span></pre><p id="a600" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">约束:</strong></p><ul class=""><li id="7ce5" class="mb mc hi iz b ja jb jd je jg md jk me jo mf js mg mh mi mj bi translated"><code class="du lj lk ll lm b">1 &lt;= s.length &lt;= 3 * 105</code></li><li id="4fd8" class="mb mc hi iz b ja mk jd ml jg mm jk mn jo mo js mg mh mi mj bi translated"><code class="du lj lk ll lm b">s</code>由数字、<code class="du lj lk ll lm b">'+'</code>、<code class="du lj lk ll lm b">'-'</code>、<code class="du lj lk ll lm b">'('</code>、<code class="du lj lk ll lm b">')'</code>和<code class="du lj lk ll lm b">' '</code>组成。</li><li id="f0a2" class="mb mc hi iz b ja mk jd ml jg mm jk mn jo mo js mg mh mi mj bi translated"><code class="du lj lk ll lm b">s</code>代表一个有效的表达式。</li><li id="14e4" class="mb mc hi iz b ja mk jd ml jg mm jk mn jo mo js mg mh mi mj bi translated"><code class="du lj lk ll lm b">'+'</code>是不是<strong class="iz hj">不是</strong>用作一元运算(即<code class="du lj lk ll lm b">"+1"</code>和<code class="du lj lk ll lm b">"+(2 + 3)"</code>无效)。</li><li id="1070" class="mb mc hi iz b ja mk jd ml jg mm jk mn jo mo js mg mh mi mj bi translated"><code class="du lj lk ll lm b">'-'</code>可以作为一元运算(即<code class="du lj lk ll lm b">"-1"</code>和<code class="du lj lk ll lm b">"-(2 + 3)"</code>有效)。</li><li id="663b" class="mb mc hi iz b ja mk jd ml jg mm jk mn jo mo js mg mh mi mj bi translated">输入中不会有两个连续的运算符。</li><li id="5d97" class="mb mc hi iz b ja mk jd ml jg mm jk mn jo mo js mg mh mi mj bi translated">每个数字和运行的计算将适合一个有符号的32位整数。</li></ul><h1 id="5df9" class="jt ju hi bd jv jw jx jy jz ka kb kc kd io ke ip kf ir kg is kh iu ki iv kj kk bi translated">解决办法</h1><p id="9ef6" class="pw-post-body-paragraph ix iy hi iz b ja kl ij jc jd km im jf jg kn ji jj jk ko jm jn jo kp jq jr js hb bi translated">让我们开始吧，如果你没有读过，不要担心，我相信你在高中时已经做过这些简单的数学。</p><p id="6d4e" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我在这个问题上尝试了几乎3次，其中2次是错误的，后来它被接受了。(内部错误是由网络问题引起的，所以不要考虑它)</p><figure class="lo lp lq lr fd mq er es paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="er es mp"><img src="../Images/756cc08dac25be7e47f374b159bff134.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4ORzdtMzIepd8KdHsvKfkw.png"/></div></div></figure><h2 id="ebbe" class="lw ju hi bd jv mw mx my jz mz na nb kd jg nc nd kf jk ne nf kh jo ng nh kj ni bi translated">解决方案#1 [ 09/18/2022 13:36 <a class="ae nj" href="https://leetcode.com/submissions/detail/802724993/" rel="noopener ugc nofollow" target="_blank">错误答案</a></h2><p id="7d33" class="pw-post-body-paragraph ix iy hi iz b ja kl ij jc jd km im jf jg kn ji jj jk ko jm jn jo kp jq jr js hb bi translated">我确信空格需要被丢弃，并且数字可以大于1，所以我将跟踪一个临时变量中的数字，并且在这种情况下将跟踪操作符'+'或'-'。</p><p id="76bc" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这就是我的解决方案简单，干净，甜蜜，直到我提交它。</p><pre class="lo lp lq lr fd ls lm lt lu aw lv bi"><span id="5032" class="lw ju hi lm b fi lx ly l lz ma">class Solution {<br/>    public int calculate(String s) {<br/>        // ignore space and brackets<br/>        // care about only digits and '+' and '-'<br/>        int temp = 0;<br/>        int result = 0;<br/>        int plusSign = 1;<br/>        for(char x: s.toCharArray()) {<br/>            if(x == '+' || x == '-') {<br/>                result += (plusSign)*temp;<br/>                plusSign = (x=='+') ? 1 : -1;<br/>                temp = 0;<br/>            } else if(x &gt;= '0' &amp;&amp; x &lt;= '9') {<br/>                temp = 10*temp + (x-'0');<br/>            }<br/>        }<br/>        result += (plusSign*temp);<br/>        return result;<br/>    }<br/>}</span></pre><h2 id="8027" class="lw ju hi bd jv mw mx my jz mz na nb kd jg nc nd kf jk ne nf kh jo ng nh kj ni bi translated">解决方案#2 [ 09/18/2022 13:43 <a class="ae nj" href="https://leetcode.com/submissions/detail/802728571/" rel="noopener ugc nofollow" target="_blank">错误答案</a></h2><p id="f566" class="pw-post-body-paragraph ix iy hi iz b ja kl ij jc jd km im jf jg kn ji jj jk ko jm jn jo kp jq jr js hb bi translated">当我执行解决方案#1时，我得到了以下情况的错误答案</p><figure class="lo lp lq lr fd mq er es paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="er es nk"><img src="../Images/a312b2d1b6e466a6320d40b8c1e612f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m6mEL8d0DWFXWJ-Bw7OipQ.png"/></div></div></figure><p id="b810" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">于是我深吸一口气，心想作为一名数学系的学生，我怎么能忘记这个案例呢？</p><p id="f4bc" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然后我修改了我的代码，通过检查括号前的符号，如果括号前的符号是负号，我会把所有的内部符号反过来，如果是负号，我会把它当作正号，如果是正号，我会把它当作负号。</p><p id="7d71" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然后我写了这个简单、干净、费力的代码，直到我提交了它。</p><pre class="lo lp lq lr fd ls lm lt lu aw lv bi"><span id="59ae" class="lw ju hi lm b fi lx ly l lz ma">class Solution {<br/>    public int calculate(String s) {<br/>        int temp = 0;<br/>        int result = 0;<br/>        int plusSign = 1;<br/>        boolean invertMode = false;<br/>        for(char x: s.toCharArray()) {<br/>            if(x == '+' || x == '-') {<br/>                result += (plusSign)*temp;<br/>                plusSign = (x=='+') ? 1 : -1;<br/>                if(invertMode) plusSign *= -1;<br/>                temp = 0;<br/>            } else if(x &gt;= '0' &amp;&amp; x &lt;= '9') {<br/>                temp = 10*temp + (x-'0');<br/>            } else if(x == '(') {<br/>                if(plusSign == -1) invertMode = true;<br/>                else invertMode = false;<br/>            } else if(x == ')') {<br/>                invertMode = false;<br/>            }<br/>        }<br/>        result += (plusSign*temp);<br/>        return result;<br/>    }<br/>}</span></pre><h2 id="e38a" class="lw ju hi bd jv mw mx my jz mz na nb kd jg nc nd kf jk ne nf kh jo ng nh kj ni bi translated">解决方案# 3[2022年9月18日13时47分<a class="ae nj" href="https://leetcode.com/submissions/detail/802730675/" rel="noopener ugc nofollow" target="_blank">已接受</a></h2><p id="fdcf" class="pw-post-body-paragraph ix iy hi iz b ja kl ij jc jd km im jf jg kn ji jj jk ko jm jn jo kp jq jr js hb bi translated">猜猜我得到了什么？</p><figure class="lo lp lq lr fd mq er es paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="er es nk"><img src="../Images/1b81f536aee9df24e1536b7e6b888afe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a9R99vxnRBzf7tw1oFuIBA.png"/></div></div></figure><p id="2031" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在两次快速尝试后，我对自己的编码技能产生了一些怀疑，但随后我意识到应该受到指责的是我的数学技能，因为我没有考虑嵌套括号。</p><pre class="lo lp lq lr fd ls lm lt lu aw lv bi"><span id="ab3b" class="lw ju hi lm b fi lx ly l lz ma">💡 <strong class="lm hj">Whenever you have to deal with nested brackets then Stack is what you are looking for.</strong></span></pre><p id="973c" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">所以我取了一个堆栈，并把指示符号是否反转的布尔值压入，当遇到右括号时弹出。</p><p id="1868" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然后我修改代码，然后执行这个复杂的sh*t代码。</p><pre class="lo lp lq lr fd ls lm lt lu aw lv bi"><span id="d6f3" class="lw ju hi lm b fi lx ly l lz ma">class Solution {<br/>    public int calculate(String s) {<br/>        int temp = 0;<br/>        int result = 0;<br/>        int plusSign = 1;<br/>        Stack&lt;Boolean&gt; stack = new Stack&lt;&gt;();<br/>        for(char x: s.toCharArray()) {<br/>            if(x == '+' || x == '-') {<br/>                result += (plusSign)*temp;<br/>                plusSign = (x=='+') ? 1 : -1;<br/>                if(!stack.isEmpty() &amp;&amp; stack.peek()) plusSign *= -1;<br/>                temp = 0;<br/>            } else if(x &gt;= '0' &amp;&amp; x &lt;= '9') {<br/>                temp = 10*temp + (x-'0');<br/>            } else if(x == '(') {<br/>                if(plusSign == -1) {<br/>                    stack.push(true);<br/>                } else {<br/>                    stack.push(false);<br/>                }<br/>            } else if(x == ')') {<br/>                stack.pop();<br/>            }<br/>        }<br/>        result += (plusSign*temp);<br/>        return result;<br/>    }<br/>}</span></pre><p id="44ab" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">猜猜我得到了什么？</p><p id="8ef2" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">呀！你猜对了，聪明的孩子。(我知道你看过标题)</p><figure class="lo lp lq lr fd mq er es paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="er es nk"><img src="../Images/fd80e11de4184247131d63fa8119ed8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5zvaZcWAwaJxDCynN2qWxg.png"/></div></div></figure><p id="6520" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我深吸一口气，打开媒体告诉你们整个故事，我的意思是我不知道为什么它被标记为难题，可能是因为我们在匆忙中错过了愚蠢的错误或边缘情况。</p><p id="1ed1" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">谁在乎(我不是在面试)？我解决了问题！！！</p><p id="51d0" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">下面是我的代码，经过一些巧妙的代码优化，使代码变得干净。</p><ol class=""><li id="1a5d" class="mb mc hi iz b ja jb jd je jg md jk me jo mf js nl mh mi mj bi translated">首先，我删除了对空堆栈的检查，所以我推1值。</li><li id="df42" class="mb mc hi iz b ja mk jd ml jg mm jk mn jo mo js nl mh mi mj bi translated">我推的是整数值而不是布尔值。</li></ol><pre class="lo lp lq lr fd ls lm lt lu aw lv bi"><span id="d56a" class="lw ju hi lm b fi lx ly l lz ma">class Solution {<br/>    public int calculate(String s) {<br/>        <br/>        int temp = 0;<br/>        int result = 0;<br/>        int plusSign = 1;<br/>        <br/>        Stack&lt;Integer&gt; stack = new Stack&lt;&gt;();<br/>        stack.push(1);<br/>        <br/>        for(char x: s.toCharArray()) {<br/>            if(x == '+' || x == '-') {<br/>                result += (plusSign)*temp;<br/>                plusSign = stack.peek() * (x=='+' ? 1 : -1);<br/>                temp = 0;<br/>            } else if(x &gt;= '0' &amp;&amp; x &lt;= '9') {<br/>                temp = 10*temp + (x-'0');<br/>            } else if(x == '(') {<br/>                stack.push(plusSign);<br/>            } else if(x == ')') {<br/>                stack.pop();<br/>            }<br/>        }<br/>        <br/>        result += (plusSign*temp);<br/>        return result;<br/>    }<br/>}</span></pre><p id="18d2" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">所以如果你一直读到最后，请投赞成票，这样我就能知道你们中有多少人和我一起读到最后。</p><h2 id="67c0" class="lw ju hi bd jv mw mx my jz mz na nb kd jg nc nd kf jk ne nf kh jo ng nh kj ni bi translated">谢谢各位。！！</h2><h2 id="de8c" class="lw ju hi bd jv mw mx my jz mz na nb kd jg nc nd kf jk ne nf kh jo ng nh kj ni bi translated">祝你周日愉快！！！</h2></div></div>    
</body>
</html>