<html>
<head>
<title>Run a Python code on AWS Batch Part — 3: Creation of Job Queues, Job definitions and Run Jobs.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在AWS批处理上运行Python代码第3部分:创建作业队列、作业定义和运行作业。</h1>
<blockquote>原文：<a href="https://medium.com/codex/run-a-python-code-on-aws-batch-part-3-creation-of-job-queues-job-definitions-and-run-jobs-6ee0dd49e582?source=collection_archive---------2-----------------------#2022-08-10">https://medium.com/codex/run-a-python-code-on-aws-batch-part-3-creation-of-job-queues-job-definitions-and-run-jobs-6ee0dd49e582?source=collection_archive---------2-----------------------#2022-08-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/6e1cd041c6751198e229b2c50a02affd.png" data-original-src="https://miro.medium.com/v2/resize:fit:924/format:webp/1*-QNpJmRsC7Tv2tKWoDXOkQ.jpeg"/></div><figcaption class="im in et er es io ip bd b be z dx translated">标志；徽标</figcaption></figure><p id="d627" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在前面的文章中，我们看到了如何创建容器并将容器上传到AWS存储库。如果您没有访问该文章，请单击下面的名称:</p><ol class=""><li id="2da5" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated"><a class="ae jx" rel="noopener" href="/codex/run-a-python-code-on-aws-batch-part-1-creation-of-python-script-and-docker-container-1b01dc89eaed"> <strong class="is hj">在AWS批处理part-1上运行Python代码:创建Python脚本和Docker容器</strong>:</a><a class="ae jx" rel="noopener" href="/codex/run-a-python-code-on-aws-batch-part-1-creation-of-python-script-and-docker-container-1b01dc89eaed">https://medium . com/codex/Run-a-Python-code-on-AWS-Batch-Part-1-Creation-of-Python-Script-and-Docker-Container-1 b 01 DC 89 eaed</a></li><li id="c61f" class="jo jp hi is b it jy ix jz jb ka jf kb jj kc jn jt ju jv jw bi translated"><a class="ae jx" rel="noopener" href="/codex/run-a-python-code-on-aws-batch-part-2-uploading-data-to-ecr-and-creation-of-computing-c5dab12cd3eb"> <strong class="is hj">在AWS批处理Part-2上运行Python代码:上传数据到ECR并创建计算环境</strong> </a> <strong class="is hj">。:</strong><a class="ae jx" rel="noopener" href="/codex/run-a-python-code-on-aws-batch-part-2-uploading-data-to-ecr-and-creation-of-computing-c5dab12cd3eb">https://medium . com/codex/run-a-python-code-on-AWS-batch-part-2-uploading-data-to-ECR-and-creation-of-computing-C5 dab 12 CD 3 EB</a></li></ol><p id="0d9b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在本节课中，我们将运行python代码:</p><ol class=""><li id="3827" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated">创建作业队列</li><li id="4b4e" class="jo jp hi is b it jy ix jz jb ka jf kb jj kc jn jt ju jv jw bi translated">创建作业定义</li><li id="911c" class="jo jp hi is b it jy ix jz jb ka jf kb jj kc jn jt ju jv jw bi translated">创造就业机会</li><li id="845c" class="jo jp hi is b it jy ix jz jb ka jf kb jj kc jn jt ju jv jw bi translated">运行作业</li></ol><p id="7e82" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们开始吧</p><ol class=""><li id="babe" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated">创建作业队列</li></ol><p id="a04c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">首先，单击AWS仪表板上的作业队列，然后单击“创建”。</p><figure class="ke kf kg kh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es kd"><img src="../Images/7416d8d92cc61f77947cb7c290327c7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZHTWqSjhzk1ykbP0gnqslQ.jpeg"/></div></div><figcaption class="im in et er es io ip bd b be z dx translated">作业队列AWS批处理仪表板</figcaption></figure><p id="89ad" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我将给出作业队列名称“test-queue-batch-v1 ”,您可以给出自己感兴趣的名称。我将给出的优先级是1000，因为对于计算环境来说，优先级的整数值较高的作业队列具有优先权。</p><figure class="ke kf kg kh fd ij er es paragraph-image"><div class="er es km"><img src="../Images/25e73bf736ae54556864fce8dcd994b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:940/format:webp/1*0ppl3u6HJv4SdrroF3Vg3g.jpeg"/></div><figcaption class="im in et er es io ip bd b be z dx translated">创建作业队列— 1</figcaption></figure><p id="aec1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我将选择计算环境，这是容器运行该计算环境所必需的。在我的例子中，我将计算环境命名为“demo-batch-python-v1”。请单击单选按钮，确保单选按钮为蓝色。</p><figure class="ke kf kg kh fd ij er es paragraph-image"><div class="er es kn"><img src="../Images/a7e872578f69f24cc81060d5a0f3d957.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/format:webp/1*mVZ9wnKT-IIO-_UQZWTf9A.jpeg"/></div><figcaption class="im in et er es io ip bd b be z dx translated">创建作业队列— 2</figcaption></figure><p id="e91a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">单击“create ”,我们将在状态中看到一条“VALID”消息。绿色横幅将出现在页面的顶部。</p><figure class="ke kf kg kh fd ij er es paragraph-image"><div class="er es ko"><img src="../Images/775395b137cd62ba96941f54e1c078a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1094/format:webp/1*BFpSaXT0pKAkdFmQt1Uf1A.jpeg"/></div><figcaption class="im in et er es io ip bd b be z dx translated">作业队列仪表板</figcaption></figure><p id="61ac" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">2.创建作业定义</p><p id="9e25" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果我们看到AWS Batch Dashboard导航栏的左侧，我们会看到作业定义，单击它，然后单击“Create”按钮，就像我们在作业队列中所做的那样。</p><figure class="ke kf kg kh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es kp"><img src="../Images/779b792083f4a31de3fd5f8d0734f7c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZpMQP2HZ6dgCYg5s6G08pw.jpeg"/></div></div><figcaption class="im in et er es io ip bd b be z dx translated">作业定义仪表板</figcaption></figure><p id="154f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">点击“创建”按钮后，将进入表格，我们需要在表格中填写作业定义的某些参数。我取的名字是“test-job-def-v1 ”,我取的代码执行超时大约为1小时，如果我们的代码执行时间超过1小时，它将终止代码的执行。</p><figure class="ke kf kg kh fd ij er es paragraph-image"><div class="er es kq"><img src="../Images/35cf242af719d2267e4e34aeeae9cd6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:968/format:webp/1*x8dRPD8HQclHngL-MIaRMw.jpeg"/></div><figcaption class="im in et er es io ip bd b be z dx translated">工作定义表— 1</figcaption></figure><p id="af34" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，为了平台兼容性，我们必须选择EC2，如果您熟悉的话，也可以选择Fargate。</p><figure class="ke kf kg kh fd ij er es paragraph-image"><div class="er es kr"><img src="../Images/80a6279cfeaef80c2dcf012cd96b0611.png" data-original-src="https://miro.medium.com/v2/resize:fit:988/format:webp/1*ou6IQOtsrOW0pI8xw2iZ4Q.jpeg"/></div></figure><p id="3d87" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">之后，我们会给你你的码头集装箱的位置，你保存它。你可以在下面的图片中看到，我将我的容器存储在sider Amazon ECR中，并复制了那个公共ECR，它是图片中的绿色标记</p><figure class="ke kf kg kh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es ks"><img src="../Images/cf0133dc04c189a1be001d7fa503add4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RKhS6I-TE5yMmPJTGZHWZQ.jpeg"/></div></div></figure><p id="1047" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">并将链接粘贴到图像字段中。</p><figure class="ke kf kg kh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es kt"><img src="../Images/7ac618b7d869e41d93b76d6fe85d75e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ua_HCY6VErZbXmgNpin2Mw.jpeg"/></div></div></figure><p id="8416" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">设置所有作业配置后，然后点击创建按钮。</p><p id="3011" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，我们的下一个任务是通过创建一个作业来运行该映像文件，即AWS Batch上的Docker容器。</p><p id="d3d7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在点击导航栏左侧的<strong class="is hj"> Jobs </strong>。现在点击<strong class="is hj">提交新工作</strong></p><figure class="ke kf kg kh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es ku"><img src="../Images/6835c9b46464f41f82b54b64288d58e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ioPdvnO5wTddWmsZse5k9A.jpeg"/></div></div></figure><p id="5930" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">点击提交新工作后，我们将被重定向到表单页面，我们必须一步一步地填写一些详细信息。<br/>在<strong class="is hj">名称</strong>字段中，我们可以添加自己的作业名称，我们已经创建了作业定义和作业队列。</p><figure class="ke kf kg kh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es kv"><img src="../Images/3aeafa3a41c53ade2690ea57e3a535c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QNhfCxjbEtywDzTElVNj1g.jpeg"/></div></div></figure><p id="197b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果我们选择<strong class="is hj">作业定义</strong>，所有字段将由<strong class="is hj"> AWS </strong>自动填充。</p><p id="48cb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">同样对于<strong class="is hj">作业配置</strong>也是自动填充的，我们只需要验证即可。</p><figure class="ke kf kg kh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es kw"><img src="../Images/c2e2aa98eeb5fed3faf946977e46b0b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s1PU5mnVb8-oQNjxndln3g.jpeg"/></div></div></figure><p id="4efd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">之后，点击提交。然后转到<strong class="is hj">仪表板</strong>，我们可以看到我们的任务已提交。</p><figure class="ke kf kg kh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es kx"><img src="../Images/39f9b5681388d07cd869bd7328224d77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*38j2GzjbCo_RMX3WW2DRmg.jpeg"/></div></div></figure><p id="5f69" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们可以在上面的图像中看到不同的列，它们显示了我们的AWS批处理作业的状态，或者我们可以说批处理作业的不同阶段。</p><pre class="ke kf kg kh fd ky kz la lb aw lc bi"><span id="6f3c" class="ld le hi kz b fi lf lg l lh li">Stages ranges from Submitted -&gt; Runnable -&gt; Starting -&gt;Running -&gt; Succeeded/Failed.</span></pre><p id="75a4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">所有阶段都是自动完成的，我们可以在Succeeded/ Failed列中观察输出。</p><p id="4650" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在我的场景中，我的作业被正确执行，我可以通过单击数字<strong class="is hj">“2”看到结果，</strong>我以前运行过相同的作业，这就是为什么它显示2，否则它将显示1，如果您的作业失败，它将在失败列中显示1。</p><figure class="ke kf kg kh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lj"><img src="../Images/fdd598258ca0a80516e0168bdd512da5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*txZmU4QcnqewJETCPOB50g.jpeg"/></div></div></figure><p id="f7af" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在我的场景中的上图中，我将单击2，它将被重定向到成功的作业列表。</p><p id="3edb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我将点击<strong class="is hj">“我的工作-v1”。因为我们现在已经运行了该作业。</strong></p><figure class="ke kf kg kh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lk"><img src="../Images/7ab5ef08a625baaea31d822c0c6f6d0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c7tvYyK3jYucF0uLV_vjcg.jpeg"/></div></div></figure><p id="5a8f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">并且它将移动到<strong class="is hj">工作信息</strong>页面。我们看到<strong class="is hj">日志流名称，下面的</strong>提供了链接，请点击它包含的输出。该链接将到达<strong class="is hj"> AWS Cloudwatch </strong>。</p><figure class="ke kf kg kh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es ll"><img src="../Images/ca8652d5ee1951d5bfbb0bab7e03adc2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nnnHd2jJERRg2V0QIKky_A.jpeg"/></div></div></figure><p id="49a7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">什么是AWS Cloudwatch？用我的话来说，我可以说它用于查看任何服务的输出，如AWS Batch、AWS Lambda等。</p><p id="0d95" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">而你只要点击<a class="ae jx" href="https://aws.amazon.com/cloudwatch/" rel="noopener ugc nofollow" target="_blank"><strong class="is hj">AWS cloud watch</strong></a><strong class="is hj">就可以获得更多细节。</strong></p><figure class="ke kf kg kh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lm"><img src="../Images/3c8587966dff647fc0ec8f4def971b53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YUaKRq9zX78Q-4mKAXnISA.jpeg"/></div></div><figcaption class="im in et er es io ip bd b be z dx translated">AWS批处理的输出</figcaption></figure><p id="eb2c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们可以看到上面的图像，即作业的输出。</p><p id="de55" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们已经成功运行了AWS批处理。</p></div></div>    
</body>
</html>