<html>
<head>
<title>Creating a Simple Stock Application with Python and APIs</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python和API创建简单的股票应用程序</h1>
<blockquote>原文：<a href="https://medium.com/codex/creating-a-simple-stock-application-with-python-and-apis-e535f1f1fc1?source=collection_archive---------4-----------------------#2021-12-03">https://medium.com/codex/creating-a-simple-stock-application-with-python-and-apis-e535f1f1fc1?source=collection_archive---------4-----------------------#2021-12-03</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="92ae" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">一个简单而有趣的项目，用Python可以在一天内完成</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/80d9ce3fcab730bf08325a39a09e754d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*F5-IkWhSDg-oEnGX"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">克里斯汀·休姆在<a class="ae jn" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h1 id="ce0e" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated">介绍</h1><p id="4f20" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">我在学习编码时明白的最重要的事情是，除了项目，没有什么能教会你你需要知道的真实世界的东西。项目是编程最有趣的方面，因为你可以创造你想象的东西。从现在起，我已经在股票市场呆了一段时间，自从我知道Python之后，我开始创建许多基于股票的编程项目。</p><p id="e0d0" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">在本文中，我将向您介绍我的一个最简单而有趣的股票市场项目，它利用EOD历史数据公司(EODhd)提供的搜索API来构建一个搜索应用程序，并允许用户搜索不同的股票以及其他类型的资产。事不宜迟，让我们进入文章吧！</p><blockquote class="lh li lj"><p id="9a93" class="kg kh lk ki b kj lc ij kl km ld im ko ll le kr ks lm lf kv kw ln lg kz la lb hb bi translated"><strong class="ki hj">注</strong>:本文强烈基于<a class="ae jn" href="https://eodhistoricaldata.com/?utm_source=medium&amp;utm_medium=post&amp;utm_campaign=creating_a_simple_stock_application_with_python_and_apis" rel="noopener ugc nofollow" target="_blank"> EOD史料</a>提供的API。因此，为了顺利地跟进即将到来的内容，请确保您拥有自己的帐户，因为它使您能够访问您的私有API密钥。您可以在 处使用<a class="ae jn" href="https://eodhistoricaldata.com/register?utm_source=medium&amp;utm_medium=post&amp;utm_campaign=creating_a_simple_stock_application_with_python_and_apis" rel="noopener ugc nofollow" target="_blank"> <strong class="ki hj">链接创建账户。此外，并非本文中提到的所有API都是免费提供的，但需要订阅。点击</strong> </a>查看所有套餐的价格，并选择最适合您的套餐。</p></blockquote><h1 id="7d5a" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated">用Python构建应用程序</h1><h2 id="9b10" class="lo jp hi bd jq lp lq lr ju ls lt lu jy kp lv lw ka kt lx ly kc kx lz ma ke mb bi translated">1.导入包</h2><p id="b8a8" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">让我们首先将所需的包导入到我们的python环境中，因为这是任何编程项目中最重要的过程。本文中我们需要的唯一包是进行API调用的请求和处理数据的Pandas。如果您尚未安装这两个软件包，请在命令行中输入以下代码行:</p><pre class="iy iz ja jb fd mc md me mf aw mg bi"><span id="a293" class="lo jp hi md b fi mh mi l mj mk">pip install requests<br/>pip install pandas</span></pre><p id="fdc7" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">安装完包后，我们现在可以使用下面的代码将它们导入到我们的python环境中:</p><pre class="iy iz ja jb fd mc md me mf aw mg bi"><span id="f7ea" class="lo jp hi md b fi mh mi l mj mk">import requests<br/>import pandas as pd</span><span id="b2f1" class="lo jp hi md b fi ml mi l mj mk">api_key = 'YOUR API KEY'</span></pre><p id="beb8" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">现在，我们已经成功地将基本包导入到我们的环境中，并将API键存储到<code class="du mm mn mo md b">api_key</code>变量中。</p><h2 id="8ad8" class="lo jp hi bd jq lp lq lr ju ls lt lu jy kp lv lw ka kt lx ly kc kx lz ma ke mb bi translated">2.创建搜索功能</h2><p id="d5cc" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">在这一步中，我们将定义一个函数，该函数根据给定的输入搜索资产，并返回一个数据帧，该数据帧包含资产的搜索结果以及其他市场信息。该函数听起来可能包含很多功能，但可以很容易地用Python编程，代码如下所示:</p><pre class="iy iz ja jb fd mc md me mf aw mg bi"><span id="ae18" class="lo jp hi md b fi mh mi l mj mk">def search_asset(asset, search_input, api_key):<br/>    url = f'https://eodhistoricaldata.com/api/search/{search_input}?api_token={api_key}&amp;type={asset}'<br/>    results_json = requests.get(url).json()<br/>    results_df = pd.DataFrame(results_json).drop('ISIN', axis = 1).rename(columns = {'Code':'Symbol'})<br/>    <br/>    return results_df</span></pre><p id="a401" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">现在让我们分解上面显示的代码片段。我们要做的第一件事是定义一个名为<code class="du mm mn mo md b">search_asset</code>的函数，它将资产的类型(<code class="du mm mn mo md b">asset</code>)、我们想要运行搜索的资产的名称(<code class="du mm mn mo md b">search_input</code>)和API键(<code class="du mm mn mo md b">api_key</code>)作为参数。</p><p id="ed42" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">在函数内部，我们首先将API URL存储到<code class="du mm mn mo md b">url</code>变量中，并使用请求包提供的<code class="du mm mn mo md b">get</code>函数，我们进行API调用来提取数据。在继续下一步之前，让我们花点时间看看API URL并分析它的结构:</p><pre class="iy iz ja jb fd mc md me mf aw mg bi"><span id="0795" class="lo jp hi md b fi mh mi l mj mk">https://eodhistoricaldata.com/api/search/{search_input}?api_token={api_key}&amp;type={asset}</span></pre><p id="7d6a" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">在上面的URL中，我们首先要看的是跟在<code class="du mm mn mo md b">/search</code>后面的<code class="du mm mn mo md b">query_string</code>，在这里我们必须指定我们想要搜索的资产的名称，它可以是公司名称或股票代码。</p><p id="fcd6" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">接下来，有两个参数:第一个是放入API键的<code class="du mm mn mo md b">api_token</code>参数，第二个是<code class="du mm mn mo md b">type</code>参数，其中我们必须提到我们正在寻找的资产类型(可用资产:股票、ETF、基金、债券、指数、商品、加密货币)。除了这里使用的参数之外，还有几个不同的参数可用于进一步过滤数据，但这两个参数对于我们的应用来说已经足够了。</p><p id="287a" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">回到代码，在进行API调用并存储提取的数据后，我们将JSON数据转换成Pandas数据帧，以使其更有意义，我们还做了一些数据操作来清理它，最后，我们返回数据帧。</p><h2 id="e3d8" class="lo jp hi bd jq lp lq lr ju ls lt lu jy kp lv lw ka kt lx ly kc kx lz ma ke mb bi translated">3.提取输入并显示结果</h2><p id="8003" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">这个项目的下一步也是最后一步是从用户那里获得必要的输入，并使用这些输入到我们之前创建的函数中，以显示最终结果。对于这个应用程序，我们将提取两个不同的输入:资产的类型(股票、ETF、债券、加密货币等。)，以及要搜索的资产的名称。</p><p id="4d33" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">现在，在Python中有几种不同的方式从用户那里获得输入，但最基本和有效的方式是利用Python中的内置特性<code class="du mm mn mo md b">input</code>函数。为我们的应用程序获取正确输入并显示最终结果的代码如下所示:</p><pre class="iy iz ja jb fd mc md me mf aw mg bi"><span id="70ea" class="lo jp hi md b fi mh mi l mj mk">assets = pd.DataFrame(pd.Series(['stock', 'etf', 'fund', 'bonds', 'index', 'commodity', 'crypto'])).rename(columns = {0:'asset'})<br/>asset = input('Type of asset [stock, etf, fund, bonds, index, commodity, crypto]: ')<br/><br/>if len(assets[assets.asset == asset]) == 0:<br/>    print(cl('Input Error: Asset not found', color = 'red'))<br/>else:<br/>    search_input = input(f'Search {asset}: ')<br/>    print(cl(f'\nSearch Results for {search_input}', attrs = ['bold']), '\n')<br/>    search_results = search_asset(asset, search_input, api_key)<br/>    display(search_results)</span></pre><p id="99ed" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">在上面的代码中，我们首先创建一个包含所有可用资产的dataframe。接下来，我们创建一个输入字段，使用内置的<code class="du mm mn mo md b">input</code>函数获取用户正在寻找的资产类型，从用户那里提取的输入将被存储到<code class="du mm mn mo md b">asset</code>变量中。</p><p id="ef02" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">然后，我们创建一个if语句，如果用户输入了随机的东西或不可用的资产，它会抛出一条错误消息。但是当提取的输入看起来不错时，if语句将继续从用户那里获取下一种类型的输入，即他们想要运行搜索的资产名称。</p><p id="f18d" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">提取所需的输入后，我们将这些输入到我们之前创建的<code class="du mm mn mo md b">search_asset</code>函数中以运行搜索，最终结果存储在<code class="du mm mn mo md b">search_results</code>变量中，然后使用Pandas包提供的<code class="du mm mn mo md b">display</code>表示数据帧。下面是一个使用我们创建的应用程序搜索股票的例子:</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mp mq l"/></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">作者提供的视频</figcaption></figure><h1 id="343d" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated">结束语</h1><p id="e86f" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">在本文中，我们了解了如何使用EODhd的Search API构建一个简单的搜索应用程序，并且还有很大的改进空间。</p><p id="467c" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">一种有趣的方法是，使用我们在本文前面创建的搜索功能作为基本功能，根据输入运行搜索，并使用EODhd的实时资产API以及一些有趣的图表和视觉效果来表示实时数据，并最终将其转化为仪表板。</p><p id="1a68" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">本文中需要注意的最重要的一点是，用Python构建整个应用程序至少需要25行代码，这主要是因为EODhd提供的搜索API简化了提取搜索结果的过程。如果没有这些，我们将不得不徒劳地经历更多的编程步骤，但是由于现有的强大API，我们现在不需要这些了。</p><p id="82d5" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">话虽如此，你已经到了文章的结尾。希望你学到了新的有用的东西。此外，如果您想查看原始文档以了解更多信息，请使用以下链接查看:<a class="ae jn" href="https://eodhistoricaldata.com/financial-apis/calendar-upcoming-earnings-ipos-and-splits?utm_source=medium&amp;utm_medium=post&amp;utm_campaign=creating_a_simple_stock_application_with_python_and_apis" rel="noopener ugc nofollow" target="_blank">https://eodhistoricaldata . com/financial-APIs/search-API-for-stocks-ETFs-mutual-funds-and-indexes/</a></p></div></div>    
</body>
</html>