<html>
<head>
<title>Update String Over The Air in Flutter for Free</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">免费更新Flutter中的无线字符串</h1>
<blockquote>原文：<a href="https://medium.com/codex/update-string-over-the-air-in-flutter-for-free-8a652062c109?source=collection_archive---------8-----------------------#2021-11-30">https://medium.com/codex/update-string-over-the-air-in-flutter-for-free-8a652062c109?source=collection_archive---------8-----------------------#2021-11-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/641ae66bc23212f0935394e011ef2579.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UrxPMcQdhKs-U-HNOl2kag.png"/></div></div></figure><p id="289c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">是的，你没看错，免费的。你可以随时更新你的文本或字符串，并且会立即反映在你的Flutter应用程序上，而不需要提交应用程序。</p><h1 id="72fb" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">为什么，谁，何时，何地&amp;什么</h1><figure class="kn ko kp kq fd ij er es paragraph-image"><div class="er es km"><img src="../Images/5b1e96dba03611faa6f15dfbdeae4cc6.png" data-original-src="https://miro.medium.com/v2/resize:fit:980/format:webp/1*xvyywSEfRQjPfKS-qr2xnA.png"/></div></figure><p id="e7cb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">当另一个团队经常想要改变我们应用程序中的翻译时，故事就开始了。有一天，他们决定使用经典的“<a class="ae kr" href="https://en.wikipedia.org/wiki/Lorem_ipsum" rel="noopener ugc nofollow" target="_blank"> Lorem Ipsum </a>”，第二天，另一个人出现了，他们想要“<a class="ae kr" href="http://khaledipsum.com" rel="noopener ugc nofollow" target="_blank"> Khaled Ipsum </a>”一切都很好，后来，在发布前一天，他们再次将其改为“<a class="ae kr" href="https://obamaipsum.com" rel="noopener ugc nofollow" target="_blank"> Obama Ipsum </a>”。它还没有停止，在应用程序运行之后，团队终于可以松一口气，放松一下了。然后，你瞧，就在第二天，他们认为“<a class="ae kr" href="https://heisenbergipsum.com" rel="noopener ugc nofollow" target="_blank">海森堡Ipsum </a>”会很好。</p><p id="0290" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">好吧，改变翻译字符串是小菜一碟，它可以在仅仅几秒或几分钟内完成，但这是一个乏味的过程。这取决于您的项目有多大，以及您如何设置CI/CD管道。对我来说，在我们的CI/CD管道中编译应用程序至少需要一个小时，直到它可供另一个团队在TestFlight或Playstore的内部测试器上测试。如果应用程序正在生产，那么你需要再次提交应用程序，等待一天或一周，直到苹果审查人员和Playstore审查人员审查你的更新，并希望苹果团队没有改变或更新他们审查指南上的新项目。</p><h1 id="fe23" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">怎么</h1><p id="0b13" class="pw-post-body-paragraph iq ir hi is b it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj kw jl jm jn hb bi translated">有一种软件即服务可以让你维护一个可扩展的软件本地化平台，比如本地化的<a class="ae kr" href="https://localizely.com/flutter-over-the-air/" rel="noopener ugc nofollow" target="_blank"/>或<a class="ae kr" href="https://help.phrase.com/help/phrase-over-the-air-introduction" rel="noopener ugc nofollow" target="_blank">短语</a>，它们给你一个无线更新，集成快捷方便，文档也很好。如果你有预算，那么没有必要进一步阅读。但是，如果您没有预算，那么您可以继续阅读，看看这个解决方案是否适合您的使用案例。</p><h1 id="e1a2" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">限制</h1><figure class="kn ko kp kq fd ij er es paragraph-image"><div class="er es kx"><img src="../Images/41d30ec30a998e4e8a04dd21c4720bd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1218/format:webp/1*51XT3FBZrGmyCa5y-YsOHQ.png"/></div></figure><p id="1625" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在我们开始之前，我需要告诉你在实现OtaString 0 . 0 . 1的初始版本时的一些限制。</p><ol class=""><li id="5a3e" class="ky kz hi is b it iu ix iy jb la jf lb jj lc jn ld le lf lg bi translated"><strong class="is hj">你的字符串是公共的，没有控制台或翻译编辑器</strong> <br/>要在发布版本上更新你的字符串，你需要将你的翻译JSON文件托管在你的服务器或S3桶中的某个地方。此外，您需要手动管理您的JSON文件没有花哨的编辑器来帮助非技术人员更新翻译，如短语或本地化。</li><li id="b8d6" class="ky kz hi is b it lh ix li jb lj jf lk jj ll jn ld le lf lg bi translated"><strong class="is hj">不支持Dart </strong> <a class="ae kr" href="https://api.flutter.dev/flutter/dart-ui/Locale-class.html" rel="noopener ugc nofollow" target="_blank"> <strong class="is hj">区域设置</strong> </a> <br/>这意味着如果你的应用需要遵循设备语言，那么这个包不适合你。如果你的应用仅支持一种语言，你可以使用此包；如果你的应用有多种语言可供用户在应用中选择，用户可以设置他们的首选语言。</li><li id="a2d3" class="ky kz hi is b it lh ix li jb lj jf lk jj ll jn ld le lf lg bi translated"><strong class="is hj">使用之前需要初始化Hive。</strong> <br/>这个初始版本依赖于<a class="ae kr" href="https://docs.hivedb.dev/#/" rel="noopener ugc nofollow" target="_blank"> Hive </a>包，所以你需要先使用或初始化<a class="ae kr" href="https://docs.hivedb.dev/#/" rel="noopener ugc nofollow" target="_blank"> Hive </a>。</li><li id="2d75" class="ky kz hi is b it lh ix li jb lj jf lk jj ll jn ld le lf lg bi translated">你不能嘲笑它，但你可以假装它。 <br/>如果你想使用<a class="ae kr" href="https://pub.dev/packages/mockito" rel="noopener ugc nofollow" target="_blank"> Mockito </a>进行测试并试图模仿，那么它将会失败，但是当然，如果需要在单元测试中测试它，你可以模仿它。</li><li id="3947" class="ky kz hi is b it lh ix li jb lj jf lk jj ll jn ld le lf lg bi translated"><strong class="is hj">默认语言只有一种语言</strong> <br/>如果您的JSON中缺少一种翻译，它将获得您定义的默认值。当应用程序第一次启动时，将使用默认语言，这意味着你的用户只能看到一种语言，直到你完成更新翻译。</li></ol><p id="ee7f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">所有这些限制都是在初始版本0.0.1上。希望有一天在下一个版本中所有的限制都消失了。</p><h1 id="2add" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">概观</h1><figure class="kn ko kp kq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lm"><img src="../Images/adf70633635ecb920fceab620148c070.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TjDaADaQTAd1RtStj_yNaQ.png"/></div></div></figure><p id="95a4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果首次启动应用程序，将使用默认语言，之后，如果您触发更新翻译功能，它将获取您的翻译文件并将其放入Hive Db，下一次应用程序启动将从缓存中获取数据。</p><h1 id="cab7" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">如何</h1><p id="c58d" class="pw-post-body-paragraph iq ir hi is b it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj kw jl jm jn hb bi translated"><strong class="is hj"> 1。安装依赖项</strong></p><pre class="kn ko kp kq fd ln lo lp lq aw lr bi"><span id="8fba" class="ls jp hi lo b fi lt lu l lv lw">dependencies:<br/>  ota_string: ^0.0.1<br/>  <br/>dev_dependencies:<br/>  build_runner: any<br/>  ota_generator: ^0.0.1</span></pre><p id="147c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 2。为你的字符串创建一个新类</strong></p><figure class="kn ko kp kq fd ij"><div class="bz dy l di"><div class="lx ly l"/></div></figure><p id="0a11" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您需要用“@OtaStringClass”注释您的类，并导入hive和ota_string。翻译服务器是你的公共翻译JSON翻译文件，语言键是你的app有多少种语言。你翻译的JSON文件的结构现在需要遵循这个<a class="ae kr" href="https://aldychris.github.io/JsonMocks/OtaJson/BasicSample.json" rel="noopener ugc nofollow" target="_blank">例子</a></p><p id="5892" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 3。运行build_runner </strong></p><pre class="kn ko kp kq fd ln lo lp lq aw lr bi"><span id="ec37" class="ls jp hi lo b fi lt lu l lv lw">flutter packages pub run build_runner build</span></pre><p id="abe1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果成功，就会生成app_localize.g.dart，您就可以使用它了。</p><p id="d5a9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 4。初始化、加载、更新语言</strong></p><pre class="kn ko kp kq fd ln lo lp lq aw lr bi"><span id="0248" class="ls jp hi lo b fi lt lu l lv lw">await Hive.initFlutter();<br/><strong class="lo hj">OtaAppLocalize</strong>.<em class="lz">load</em>('en');<br/><strong class="lo hj">OtaAppLocalize</strong>.<em class="lz">current</em>.updateData();</span></pre><p id="d845" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">当您加载语言时，它需要与您放在语言键上的语言相匹配。要更新翻译，您可以调用updateData()函数。</p><p id="022f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 5。显示&amp;替换字符串</strong></p><p id="ab6e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">要显示字符串，只需调用生成的文件，就大功告成了。</p><pre class="kn ko kp kq fd ln lo lp lq aw lr bi"><span id="a1aa" class="ls jp hi lo b fi lt lu l lv lw"><strong class="lo hj">var helloString = OtaAppLocalize</strong>.<em class="lz">current</em>.hello;</span></pre><p id="e6f6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在JSON中你可以有动态值，要放动态值你只需要在{}中放任何字符。</p><pre class="kn ko kp kq fd ln lo lp lq aw lr bi"><span id="942b" class="ls jp hi lo b fi lt lu l lv lw">My Name is {name}, Im from {location}</span></pre><p id="d0d4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">名称和位置将被您的应用程序中的字符串替换，替换您可以调用的函数的字符串。replaceOtaStringWith</p><pre class="kn ko kp kq fd ln lo lp lq aw lr bi"><span id="e7e7" class="ls jp hi lo b fi lt lu l lv lw">var res = <strong class="lo hj">OtaAppLocalize</strong>.<em class="lz">current</em>.name_location<br/>    .replaceOtaStringWith(['Spock', 'Vulcan']);</span></pre><p id="4ef8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 6。分期与生产</strong></p><p id="9b6a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您需要在OtaStringClass中传递另一个JSON文件，用于Stagging和生产字符串翻译</p><pre class="kn ko kp kq fd ln lo lp lq aw lr bi"><span id="781b" class="ls jp hi lo b fi lt lu l lv lw">@OtaStringClass(<br/>    translationServerStg: 'https://aldychris.github.io/JsonMocks/OtaJson/BasicSample.json',<br/>    translationServer: 'https://aldychris.github.io/JsonMocks/OtaJson/BasicSampleProduction.json',<br/>    languageKey: ['en', 'zh', 'tlh'])</span></pre><p id="ca4e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然后在运行项目时，您需要将变量otaStringProdEnv定义为true或false。</p><pre class="kn ko kp kq fd ln lo lp lq aw lr bi"><span id="e336" class="ls jp hi lo b fi lt lu l lv lw">--dart-define=otaStringProdEnv=false</span></pre><h1 id="28b8" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">例子</h1><figure class="kn ko kp kq fd ij"><div class="bz dy l di"><div class="ma ly l"/></div></figure><h1 id="3818" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">下一步是什么</h1><p id="88f5" class="pw-post-body-paragraph iq ir hi is b it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj kw jl jm jn hb bi translated">看看这个包，我希望这篇短文能帮助你理解这些包的思想。</p><div class="mb mc ez fb md me"><a href="https://pub.dev/packages/ota_string" rel="noopener  ugc nofollow" target="_blank"><div class="mf ab dw"><div class="mg ab mh cl cj mi"><h2 class="bd hj fi z dy mj ea eb mk ed ef hh bi translated">ota_string | Dart包</h2><div class="ml l"><h3 class="bd b fi z dy mj ea eb mk ed ef dx translated">一个新的颤振项目。</h3></div><div class="mm l"><p class="bd b fp z dy mj ea eb mk ed ef dx translated">公共开发</p></div></div><div class="mn l"><div class="mo l mp mq mr mn ms io me"/></div></div></a></div><div class="mb mc ez fb md me"><a href="https://pub.dev/packages/ota_generator" rel="noopener  ugc nofollow" target="_blank"><div class="mf ab dw"><div class="mg ab mh cl cj mi"><h2 class="bd hj fi z dy mj ea eb mk ed ef hh bi translated">ota_generator | Dart包</h2><div class="ml l"><h3 class="bd b fi z dy mj ea eb mk ed ef dx translated">源代码生成器，帮助创建多语言字符串翻译，通过无线方式免费更新…</h3></div><div class="mm l"><p class="bd b fp z dy mj ea eb mk ed ef dx translated">公共开发</p></div></div><div class="mn l"><div class="mt l mp mq mr mn ms io me"/></div></div></a></div><p id="ade7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">希望，如果我有时间，然后将保持这个项目更新，并做这个改进:</p><ul class=""><li id="a346" class="ky kz hi is b it iu ix iy jb la jf lb jj lc jn mu le lf lg bi translated">支持Flutter语言环境，日期格式和复数</li><li id="5e6e" class="ky kz hi is b it lh ix li jb lj jf lk jj ll jn mu le lf lg bi translated">支持基于应用版本的更新字符串</li><li id="0d47" class="ky kz hi is b it lh ix li jb lj jf lk jj ll jn mu le lf lg bi translated">支持多个默认翻译</li><li id="9c2c" class="ky kz hi is b it lh ix li jb lj jf lk jj ll jn mu le lf lg bi translated">有控制台和用户界面来添加或修改翻译</li></ul><p id="a3af" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">最后但同样重要的一点是，点击“鼓掌”按钮👏支持我或按住鼓掌按钮，留下更多的掌声。</strong></p></div></div>    
</body>
</html>