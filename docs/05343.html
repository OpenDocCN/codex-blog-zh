<html>
<head>
<title>Getting Started with Svelte and d3.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Svelte和d3.js入门</h1>
<blockquote>原文：<a href="https://medium.com/codex/getting-started-with-svelte-and-d3-js-ea915d2c2c2c?source=collection_archive---------1-----------------------#2022-02-20">https://medium.com/codex/getting-started-with-svelte-and-d3-js-ea915d2c2c2c?source=collection_archive---------1-----------------------#2022-02-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/a043748f98547149dcd2334601d21d62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Nyi76RKZdGDUTNTy"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">由<a class="ae hv" href="https://unsplash.com/@flowforfrank?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">费伦茨·阿尔马西</a>在<a class="ae hv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><div class=""/><p id="1406" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">自2013年以来，我一直使用<a class="ae hv" href="http://idl.cs.washington.edu/files/2011-D3-InfoVis.pdf" rel="noopener ugc nofollow" target="_blank"> d3.js作为我的标准可视化库，大约是在Mike Bostock在</a><a class="ae hv" href="http://ieeevis.org/year/2011/info/infovis-welcome/infovis-welcome" rel="noopener ugc nofollow" target="_blank"> InfoVis 2011 </a>大会上介绍它的2年之后。首先，我使用d3创建了自己的普通JS web应用程序。最终，我开始使用Angular和React，我的程序引入了额外的复杂性，不知何故，我花了更多的时间思考如何整合某些视觉元素，而不是简单地使用它并从中获得乐趣。然而，这只是我的主观观点——我确信许多开发人员可能会反对我😜。</p><p id="e649" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">去年我遇到了Svelte，我喜欢它的轻量级概念，也喜欢开发者抛弃了虚拟DOM。希望这篇文章是以后许多文章中的第一篇，在这里我将一步一步从头开始创建一个成熟的可视化web应用程序。</p><p id="3e6b" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">话说够了，开始吧！🚀</p><p id="f097" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在本文中，我将介绍vis应用程序的以下步骤:</p><ul class=""><li id="95c0" class="jt ju hy ix b iy iz jc jd jg jv jk jw jo jx js jy jz ka kb bi translated">使用TypeScript实例化一个简单的应用程序</li><li id="2468" class="jt ju hy ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated">将d3.js集成到苗条应用中</li><li id="8fb7" class="jt ju hy ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated">第一可调整大小的d3.js散点图</li></ul><h1 id="78b3" class="kh ki hy bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le bi translated">创建一个简单的应用程序</h1><p id="52f9" class="pw-post-body-paragraph iv iw hy ix b iy lf ja jb jc lg je jf jg lh ji jj jk li jm jn jo lj jq jr js hb bi translated">首先，我们必须在我们的系统上安装<a class="ae hv" href="https://nodejs.org/en/" rel="noopener ugc nofollow" target="_blank">节点</a>。然后，打开我们的终端并执行以下命令:</p><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="9dce" class="lt ki hy lp b fi lu lv l lw lx">$ npx degit sveltejs/template svelte-d3<br/>$ cd svelte-d3<br/>$ npm install</span></pre><p id="f1c1" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">第一行将创建一个名为<strong class="ix hz"> /svelte-d3 </strong>的基于模板的新项目。然后，我们将目录切换到项目文件夹并执行<strong class="ix hz"> npm install </strong>，这将把所有依赖项安装到文件夹<strong class="ix hz"> /node_modules </strong>(依赖项在package.json中定义)。项目文件夹应该如下所示:</p><figure class="lk ll lm ln fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ly"><img src="../Images/814664860d667b1d8464e93d47388d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*guMtcj_LSm6-5WC9DuzNcg.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">安装完所有依赖项后的项目文件夹。</figcaption></figure><p id="d7a7" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最后，为了将模板项目用作TypeScript项目，我们运行以下命令:</p><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="dde2" class="lt ki hy lp b fi lu lv l lw lx">$ node scripts/setupTypeScript.js<br/>$ npm install. # run a second time to </span></pre><p id="c640" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果我们将属性<code class="du lz ma mb lp b">lang="ts"</code>添加到<code class="du lz ma mb lp b">&lt;script&gt;&lt;/script&gt;</code>标签中，我们现在可以使用TypeScript。在此处找到附加文档<a class="ae hv" href="https://svelte.dev/blog/svelte-and-typescript" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="04d0" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然后我们在终端中运行<code class="du lz ma mb lp b">npm run dev</code>，在浏览器中打开<a class="ae hv" href="http://localhost:8080" rel="noopener ugc nofollow" target="_blank"> http://localhost:8080 </a>。我们开始了，我们第一个苗条的网站！</p><figure class="lk ll lm ln fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mc"><img src="../Images/f0a2794e2fd0c923d19419bd84b3e756.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q87ny4MEJ1RGQxd0iSEa3w.png"/></div></div></figure><h1 id="0858" class="kh ki hy bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le bi translated">安装d3.js依赖项</h1><p id="5c24" class="pw-post-body-paragraph iv iw hy ix b iy lf ja jb jc lg je jf jg lh ji jj jk li jm jn jo lj jq jr js hb bi translated">首先，我们在项目文件夹中运行以下两个命令:</p><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="14bf" class="lt ki hy lp b fi lu lv l lw lx">$ npm install d3<br/>$ npm install @types/d3</span></pre><p id="88a2" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们将能够在<code class="du lz ma mb lp b">&lt;script&gt;&lt;/script&gt;</code>标签内的苗条应用程序中以如下方式开始使用d3:</p><figure class="lk ll lm ln fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es md"><img src="../Images/108bd969237d911d6fe61754869bce82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Kp0rbrPAL1UcxQjTIaMe7A.png"/></div></div></figure><h1 id="3541" class="kh ki hy bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le bi translated">可调整大小的散点图</h1><p id="3ae7" class="pw-post-body-paragraph iv iw hy ix b iy lf ja jb jc lg je jf jg lh ji jj jk li jm jn jo lj jq jr js hb bi translated">为了简单起见，我们将使用主要的苗条组件<strong class="ix hz">app . svelete</strong>。在本例中，我们将创建一个包含100个点的随机数据数组，随机x和y值在[0，10]范围内:</p><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="de0a" class="lt ki hy lp b fi lu lv l lw lx">let data = [];<br/>for (let i = 0; i &lt; 100; ++i) {<br/> data.push({x: Math.random() * 10, y: Math.random() * 10})<br/>}</span></pre><p id="e125" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">此外，我们必须创建一组初始变量:</p><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="0863" class="lt ki hy lp b fi lu lv l lw lx">let xScale = d3.scaleLinear().domain([0, 10]);<br/>let yScale: = d3.scaleLinear().domain([0, 10]);<br/>let width: number;<br/>let height: number;<br/>const margin = {<br/>  top: 20,<br/>  right: 20,<br/>  bottom: 30,<br/>  left: 30<br/> };</span></pre><p id="254d" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然后，为了支持调整大小，我们将添加一个redraw()函数。如果您熟悉任何2D或3D api，通常会在帧中发生变化(如不同的大小)时调用redraw/repaint/…方法。对于这个例子，我们将采用完全相同的概念。</p><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="c217" class="lt ki hy lp b fi lu lv l lw lx">onMount(() =&gt; {<br/> redraw();<br/> window.addEventListener('resize', redraw);<br/>})</span></pre><p id="1608" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">请注意，<strong class="ix hz"> onMount() </strong>是一个简单的特定方法，在组件被呈现到DOM后会被自动调用。除了最初的<strong class="ix hz"> redraw() </strong>之外，我们还添加了一个事件监听器。每当调整窗口大小时，这个监听器调用<strong class="ix hz"> redraw() </strong>方法。</p><p id="ae38" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们来看看<strong class="ix hz"> redraw() </strong>方法:</p><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="e39d" class="lt ki hy lp b fi lu lv l lw lx">function redraw(): void {<br/>  // empty vis div<br/>  d3.select(vis).html(null);</span><span id="f85f" class="lt ki hy lp b fi me lv l lw lx">  // determine width &amp; height of parent element minus the margin<br/>  width = d3.select(vis).node().getBoundingClientRect().width - margin.left - margin.right;<br/>  height = d3.select(vis).node().getBoundingClientRect().height - margin.top - margin.bottom;</span><span id="f833" class="lt ki hy lp b fi me lv l lw lx">  // init scales according to new width &amp; height<br/>  xScale.range([0, width]);<br/>  yScale.range([height, 0]);</span><span id="ddee" class="lt ki hy lp b fi me lv l lw lx">  // create svg and group that is translated by the margin<br/>  const svg = d3.select(vis)<br/>   .append('svg')<br/>   .attr('width', width + margin.left + margin.right)<br/>   .attr('height', height + margin.top + margin.bottom)<br/>   .append('g')<br/>   .attr('transform', `translate(${[margin.left, margin.top]})`)</span><span id="d8f4" class="lt ki hy lp b fi me lv l lw lx">  // draw x and y axes<br/>  svg.append("g")<br/>   .attr("transform", `translate(${[0, height]})`)<br/>   .call(d3.axisBottom(xScale));<br/>  svg.append("g")<br/>      .call(d3.axisLeft(yScale));</span><span id="c2c3" class="lt ki hy lp b fi me lv l lw lx">  // draw data points<br/>  svg.append('g').selectAll('circle')<br/>   .data(data)<br/>   .enter()<br/>   .append('circle')<br/>   .attr('cx', function (d) { <br/>    return xScale(d.x); <br/>   })<br/>   .attr('cy', function (d) { <br/>    return yScale(d.y); <br/>   })<br/>   .attr('r', 7)<br/>   .style('fill', '#ff3e00')<br/>   .style('fill-opacity', '0.5')<br/>   .style('stroke', '#ff3e00');<br/> }</span></pre><p id="a365" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们将所有这些联系在一起，用我们的可视化逻辑连接一个专用的<code class="du lz ma mb lp b">&lt;div&gt;&lt;/div&gt;</code>。注意，在上面的代码中，<code class="du lz ma mb lp b">div</code>是通过<code class="du lz ma mb lp b">d3.select(vis)</code>选择的。</p><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="5514" class="lt ki hy lp b fi lu lv l lw lx">&lt;script lang=”ts”&gt;<br/>  let vis;<br/>&lt;/script&gt;</span><span id="2c9f" class="lt ki hy lp b fi me lv l lw lx">&lt;main&gt;<br/> &lt;div id="vis" bind:this{vis}&gt;&lt;/div&gt;<br/>&lt;/main&gt;</span><span id="b207" class="lt ki hy lp b fi me lv l lw lx">&lt;style&gt;<br/> /* some styles */<br/>&lt;/style&gt;</span></pre><p id="9516" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">第<code class="du lz ma mb lp b">bind:this{vis}</code>行创建了一个只读绑定，并给出了对这个特定div元素的引用。访问该元素的另一种方法是通过<code class="du lz ma mb lp b">d3.select('#vis')</code>访问id。</p><p id="a80b" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">下面是<strong class="ix hz"> App.svelte </strong>组件的代码:</p><figure class="lk ll lm ln fd hk"><div class="bz dy l di"><div class="mf mg l"/></div></figure><p id="989f" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最终结果应该类似于:</p><figure class="lk ll lm ln fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mh"><img src="../Images/2b955171823e72fe6f18b0140c1bb3bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*irE7Fh_yOyJYmcxzEdfiXw.png"/></div></div></figure><p id="6fba" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">接下来，检查窗口大小调整功能，并观察由于重绘，缩放比例如何适应窗口大小。你可能想知道这对于散点图是否有意义，答案是:可能没有。然而，这里有几个用例，您可能想要扩展规模。敬请期待，更多即将到来；)</p><p id="6de5" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="mi">参考文献</em>:</p><div class="hh hi ez fb hj mj"><a href="https://svelte.dev" rel="noopener  ugc nofollow" target="_blank"><div class="mk ab dw"><div class="ml ab mm cl cj mn"><h2 class="bd hz fi z dy mo ea eb mp ed ef hx bi translated">苗条的</h2><div class="mq l"><h3 class="bd b fi z dy mo ea eb mp ed ef dx translated">控制论增强的网络应用</h3></div><div class="mr l"><p class="bd b fp z dy mo ea eb mp ed ef dx translated">苗条的人</p></div></div><div class="ms l"><div class="mt l mu mv mw ms mx hp mj"/></div></div></a></div><div class="hh hi ez fb hj mj"><a href="https://d3js.org" rel="noopener  ugc nofollow" target="_blank"><div class="mk ab dw"><div class="ml ab mm cl cj mn"><h2 class="bd hz fi z dy mo ea eb mp ed ef hx bi translated">D3.js -数据驱动的文档</h2><div class="mq l"><h3 class="bd b fi z dy mo ea eb mp ed ef dx translated">D3是一个用HTML、SVG和CSS可视化数据的JavaScript库。</h3></div><div class="mr l"><p class="bd b fp z dy mo ea eb mp ed ef dx translated">d3js.org</p></div></div><div class="ms l"><div class="my l mu mv mw ms mx hp mj"/></div></div></a></div><div class="hh hi ez fb hj mj"><a href="https://svelte.dev/blog/virtual-dom-is-pure-overhead" rel="noopener  ugc nofollow" target="_blank"><div class="mk ab dw"><div class="ml ab mm cl cj mn"><h2 class="bd hz fi z dy mo ea eb mp ed ef hx bi translated">虚拟DOM是纯粹的开销</h2><div class="mq l"><h3 class="bd b fi z dy mo ea eb mp ed ef dx translated">如果您在过去几年中使用过JavaScript框架，让我们彻底抛弃“虚拟DOM很快”的神话吧…</h3></div><div class="mr l"><p class="bd b fp z dy mo ea eb mp ed ef dx translated">苗条的人</p></div></div><div class="ms l"><div class="mz l mu mv mw ms mx hp mj"/></div></div></a></div></div></div>    
</body>
</html>