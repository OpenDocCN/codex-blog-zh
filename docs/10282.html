<html>
<head>
<title>Single database column anonymization with sqlcmdcli</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用sqlcmdcli匿名化单个数据库列</h1>
<blockquote>原文：<a href="https://medium.com/codex/single-database-column-anonymization-with-sqlcmdcli-49f2f428578c?source=collection_archive---------10-----------------------#2022-12-17">https://medium.com/codex/single-database-column-anonymization-with-sqlcmdcli-49f2f428578c?source=collection_archive---------10-----------------------#2022-12-17</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="d127" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">匿名长度超过两个字符的文本列！</h2></div><p id="753d" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在上一篇文章<a class="ae jt" rel="noopener" href="/@segovoni/data-masking-with-sqlcmdcli-975924f2935d">使用sqlcmdcli进行数据屏蔽</a>中，我们讨论了当您不得不在开发环境中甚至在客户公司外围使用生产数据库来执行测试时，数据匿名化的复杂活动。一种可能的解决方案是，在授权我们撤回数据的匿名副本之前，要求客户执行适当的检查，从而掩盖生产数据库副本上的敏感数据。</p><p id="29a7" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">sqlcmdcli的anonymizedb命令允许您对数据库的所有文本类型列执行这种不可逆的匿名化。anonymizedb命令最近增加了新的选项，允许您对特定列执行匿名化操作，将操作限制在公司的敏感数据或个人的私人数据。</p><p id="e9b1" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们从GitHub下载sqlcmdcli的最新版本，你可以在这里找到它<a class="ae jt" href="https://github.com/segovoni/sqlcmdcli" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="721d" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们提取sqlcmdcli.zip中包含的可执行文件，并将其放在C:\SQL\Tools\sqlcmdcli目录中。</p><p id="3cd4" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们将用来测试新选项的虚拟机有一个SQL Server 2022 Developer Edition的本地实例，其中有一个WideWorldImporters示例数据库的副本，您可以在这里下载<a class="ae jt" href="https://learn.microsoft.com/en-us/sql/samples/wide-world-importers-oltp-install-configure?WT.mc_id=DP-MVP-4029181" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="3f8a" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们希望匿名化应用程序的PhoneNumber列。WideWorldImporters数据库中的People表。PhoneNumber列包含公司员工的电话号码，因此出于隐私原因，我们必须匿名。之后，我们将把相同的作业扩展到LogonName列，以此类推。</p><p id="459f" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">sqlcmdcli可以通过运行以下命令匿名化PhoneNumber列。</p><pre class="ju jv jw jx fd jy jz ka bn kb kc bi"><span id="0280" class="kd ke hi jz b be kf kg l kh ki">sqlcmdcli.exe anonymizedb -servername:sql2022 -databasename:WideWorldImporters -username:xxxxx -password:xxxxx -schemaname:Application -tablename:People -columnname:PhoneNumber -verbose</span></pre><p id="570f" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">输出如下图所示。</p><figure class="ju jv jw jx fd kk er es paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="er es kj"><img src="../Images/234ba1e96ef8939cae087862937d756d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IM2q2cv3GzSkPtV66vzxXg.jpeg"/></div></div></figure><p id="7985" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">PhoneNumber列已被匿名化，让我们继续进行LogonName列的匿名化。让我们运行下面的命令。</p><pre class="ju jv jw jx fd jy jz ka bn kb kc bi"><span id="765f" class="kd ke hi jz b be kf kg l kh ki">sqlcmdcli.exe anonymizedb -servername:sql2022 -databasename:WideWorldImporters -username:xxxxx -password:xxxxx -schemaname:Application -tablename:People -columnname:LogonName -verbose</span></pre><p id="6394" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">输出如下图所示。</p><figure class="ju jv jw jx fd kk er es paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="er es kr"><img src="../Images/e61341649c1c6c0cce35c7d9b983aa17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q1mYosVSM7z7ojU6SiXjKA.jpeg"/></div></div></figure><p id="9bc5" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">LogonName列已被匿名化，这是结果。</p><pre class="ju jv jw jx fd jy jz ka bn kb kc bi"><span id="bba5" class="kd ke hi jz b be kf kg l kh ki">PersonID    LogonName                                          FullName<br/>----------- -------------------------------------------------- ---------------------<br/>2           qgrg}F}ojk}uxrjosvuxzkxy4ius                       Kayla Woodcock<br/>3           n{jyutuF}ojk}uxrjosvuxzkxy4ius                     Hudson Onslow<br/>4           oyghkrrgxF}ojk}uxrjosvuxzkxy4ius                   Isabella Rupp<br/>5           k|gsF}ojk}uxrjosvuxzkxy4ius                        Eva Muirden<br/>6           yuvnognF}ojk}uxrjosvuxzkxy4ius                     Sophia Hinton<br/>7           gszF}ojk}uxrjosvuxzkxy4ius                         Amy Trefl<br/>8           gtznutmF}ojk}uxrjosvuxzkxy4ius                     Anthony Grosse<br/>9           groiglF}ojk}uxrjosvuxzkxy4ius                      Alica Fatnowna<br/>10          yzkrrgxF}ojk}uxrjosvuxzkxy4ius                     Stella Rosenhain<br/>11          kzngtuF}ojk}uxrjosvuxzkxy4ius                      Ethan Onslow<br/>12          nktxlF}ojk}uxrjosvuxzkxy4ius                       Henry Forlonge<br/>13          n{jyutnF}ojk}uxrjosvuxzkxy4ius                     Hudson Hollinworth<br/>14          roriF}ojk}uxrjosvuxzkxy4ius                        Lily Code<br/>15          zgpyF}ojk}uxrjosvuxzkxy4ius                        Taj Shand<br/>16          gxinkxrF}ojk}uxrjosvuxzkxy4ius                     Archer Lamble<br/>17          vovkxqF}ojk}uxrjosvuxzkxy4ius                      Piper Koch<br/>18          qgzokjF}ojk}uxrjosvuxzkxy4ius                      Katie Darwin<br/>19          pgoyF}ojk}uxrjosvuxzkxy4ius                        Jai Shand<br/>20          pgiqvF}ojk}uxrjosvuxzkxy4ius                       Jack Potter</span></pre><p id="7843" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">请记住，这种匿名技术是不可逆的，请不要在生产环境中使用它！</p><p id="3f0c" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">享受sqlcmdcli！</p></div></div>    
</body>
</html>