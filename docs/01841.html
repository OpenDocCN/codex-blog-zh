<html>
<head>
<title>Turn Neo4j into a Genome Browser</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将Neo4j变成基因组浏览器</h1>
<blockquote>原文：<a href="https://medium.com/codex/turn-neo4j-into-a-genome-browser-e94c7311dfab?source=collection_archive---------2-----------------------#2021-06-07">https://medium.com/codex/turn-neo4j-into-a-genome-browser-e94c7311dfab?source=collection_archive---------2-----------------------#2021-06-07</a></blockquote><div><div class="dt gx gy gz ha hb"/><div class="hc hd he hf hg"><div class=""/><div class=""><h2 id="c224" class="pw-subtitle-paragraph ig hi hj bd b ih ii ij ik il im in io ip iq ir is it iu iv iw ix dy translated">基因簇发现、注释管理和序列管理集于一身</h2></div><p id="0a70" class="pw-post-body-paragraph iy iz hj ja b jb jc ik jd je jf in jg jh ji jj jk jl jm jn jo jp jq jr js jt hc bi translated">如果说21世纪是生物学的时代(<a class="ae ju" href="https://www.oecd.org/sti/emerging-tech/A%20Glover.pdf" rel="noopener ugc nofollow" target="_blank"> 1 </a>)，那么基因组测序就是先兆。基因组测序基本上是将DNA分子转化为计算机中的文本。DNA序列存储在简单的ASCII文本文件中，如Fasta和Fastq。生物学家然后对它们运行程序来发现蛋白质(开放阅读框架预测)。这些预测的蛋白质的功能可以通过它们在数据库中的近亲来猜测(蛋白质注释，请阅读我的文章<a class="ae ju" rel="noopener" href="/geekculture/analyzing-genomes-in-a-graph-database-27a45faa0ae8">这里</a>和<a class="ae ju" href="https://towardsdatascience.com/graph-database-graphql-and-machine-learning-for-carbohydrate-active-enzymes-dba8500b45cf" rel="noopener" target="_blank">这里</a>了解更多信息)。生物学家把所有这些作品保存成GBK或EMBL这样的文件:</p><figure class="jw jx jy jz fe ka es et paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="es et jv"><img src="../Images/e30e0e3fffe357e6ca27fc28590bbc91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bnnxwB3GGE0OOcXuLfz8uQ.png"/></div></div><figcaption class="kh ki eu es et kj kk bd b be z dy translated">图一。EMBL文件的示例。图片作者。</figcaption></figure><p id="e28c" class="pw-post-body-paragraph iy iz hj ja b jb jc ik jd je jf in jg jh ji jj jk jl jm jn jo jp jq jr js jt hc bi translated">GBK或EMBL的文件仍然只是文本文件。他们的数据一览无余，这是我能想到的唯一优势。生物学家可以将文件导入工具，如经典的Artemis 用于基因可视化。但是Artemis只是一个GUI程序，而不是查询引擎。因此它不允许生物学家执行查询，例如:</p><ol class=""><li id="974f" class="kl km hj ja b jb jc je jf jh kn jl ko jp kp jt kq kr ks kt bi translated">显示基因组中的GH13蛋白序列；</li><li id="7713" class="kl km hj ja b jb ku je kv jh kw jl kx jp ky jt kq kr ks kt bi translated">显示每个GH16基因周围的五个邻近基因；</li><li id="2c81" class="kl km hj ja b jb ku je kv jh kw jl kx jp ky jt kq kr ks kt bi translated">显示所有TonB依赖性受体和SusD样蛋白基因对，只要它们之间的距离小于10，000个碱基对。</li></ol><p id="1e0e" class="pw-post-body-paragraph iy iz hj ja b jb jc ik jd je jf in jg jh ji jj jk jl jm jn jo jp jq jr js jt hc bi translated">在大数据时代，将文本文件放入数据仓库进行存储、版本控制和分析是一种常见的做法。生物学家求助于GenDB等系统来完成这项任务。GenDB是2003年的一款单片软件，它依靠复杂的关系表网络来管理基因组、基因和注释。GenDB强调了关系数据库在基因组分析中的缺点。首先，GBK和EMBL文件是半结构化数据，它们的数据字段在不同的提交者之间会有所不同。这使得严格的模式设计变得困难。设计者需要经常改变模式以适应新的字段。或者他们决定创建新表并保持旧表不变。结果，基因属性分散在许多不同的地方，以至于即使一个简单的查询也需要几个“连接”。其次，关系数据库将基因的线性关系分解成表项。这使得很难制定基因簇查找查询。最后但并非最不重要的一点是，它对于大型项目的可扩展性很差，并且它不是云就绪的。</p><p id="e684" class="pw-post-body-paragraph iy iz hj ja b jb jc ik jd je jf in jg jh ji jj jk jl jm jn jo jp jq jr js jt hc bi translated">生物信息学家当然可以自己动手制作一些Biopython Jupyter笔记本来逐一回答这些问题。但这将每个查询变成了一个编程项目，并将许多生物学家拒之门外。此外，这不是一个长期的数据仓库解决方案。</p><p id="a6d7" class="pw-post-body-paragraph iy iz hj ja b jb jc ik jd je jf in jg jh ji jj jk jl jm jn jo jp jq jr js jt hc bi translated">如果我们能有一个这样的数据库，那不是很好吗:</p><ol class=""><li id="f0ca" class="kl km hj ja b jb jc je jf jh kn jl ko jp kp jt kq kr ks kt bi translated">允许导入和导出EMBL或GBK文件；</li><li id="e6ab" class="kl km hj ja b jb ku je kv jh kw jl kx jp ky jt kq kr ks kt bi translated">反映了基因之间的线性关系；</li><li id="5c9a" class="kl km hj ja b jb ku je kv jh kw jl kx jp ky jt kq kr ks kt bi translated">以NoSQL方式存储基因属性，而不是表；</li><li id="2f5f" class="kl km hj ja b jb ku je kv jh kw jl kx jp ky jt kq kr ks kt bi translated">可视化查询结果；</li><li id="0341" class="kl km hj ja b jb ku je kv jh kw jl kx jp ky jt kq kr ks kt bi translated">为手动数据编辑提供GUI</li><li id="22f6" class="kl km hj ja b jb ku je kv jh kw jl kx jp ky jt kq kr ks kt bi translated">有一个简单但强大的查询语言；</li><li id="da28" class="kl km hj ja b jb ku je kv jh kw jl kx jp ky jt kq kr ks kt bi translated">具有可扩展性和云就绪性。</li></ol><p id="a575" class="pw-post-body-paragraph iy iz hj ja b jb jc ik jd je jf in jg jh ji jj jk jl jm jn jo jp jq jr js jt hc bi translated">虽然NoSQL数据库可以检查这个列表中的几个项目，但它们没有内置的机制来表示基因之间的线性关系。此外，NoSQL将查询结果作为文档返回，没有任何图形表示。这对许多生物学家来说是一个障碍，因为他们需要目测检查结果。</p><p id="3103" class="pw-post-body-paragraph iy iz hj ja b jb jc ik jd je jf in jg jh ji jj jk jl jm jn jo jp jq jr js jt hc bi translated">图形数据库Neo4j符合这个要求。我以前文章的读者(<a class="ae ju" rel="noopener" href="/geekculture/analyzing-genomes-in-a-graph-database-27a45faa0ae8">这里</a>，这里<a class="ae ju" href="https://towardsdatascience.com/neo4j-for-diseases-959dffb5b479" rel="noopener" target="_blank">这里</a>和<a class="ae ju" href="https://towardsdatascience.com/graph-database-graphql-and-machine-learning-for-carbohydrate-active-enzymes-dba8500b45cf?source=your_stories_page-------------------------------------" rel="noopener" target="_blank">这里</a>)可能已经知道Neo4j可以为生物信息学中的许多分析项目提供动力。在这篇文章中，我将向您展示它也可以作为基因组浏览器和仓库。EMBL文件可以导入和导出。图形是表达基因组中基因排列的一种自然而直观的方式。基因属性作为键值对存储在每个节点中。graph app<strong class="ja hk">Neo4j Commander</strong>是一个很棒的用于手动基因注释的GUI编辑器。Neo4j使用简单而强大的Cypher语言。有了它，我们可以用非常简单的语句来表达复杂的查询。它的企业版包含<strong class="ja hk"> Fabric </strong>，可以对图形数据进行分片以实现可伸缩性。对于云原生用户，Neo4j提供了数据库即服务(DaaS)选项<strong class="ja hk"> Aura </strong>，一些用户可以通过云中的虚拟机轻松托管自己的数据库。</p><p id="0f4a" class="pw-post-body-paragraph iy iz hj ja b jb jc ik jd je jf in jg jh ji jj jk jl jm jn jo jp jq jr js jt hc bi translated">这个项目的代码存放在我的Github库中。</p><div class="kz la fa fc lb lc"><a href="https://github.com/dgg32/neo4j_genome_browser" rel="noopener  ugc nofollow" target="_blank"><div class="ld ab dx"><div class="le ab lf cl cj lg"><h2 class="bd hk fj z dz lh eb ec li ee eg hi bi translated">dgg 32/neo4j _基因组_浏览器</h2><div class="lj l"><h3 class="bd b fj z dz lh eb ec li ee eg dy translated">这个存储库包含我的文章“将Neo4j变成基因组浏览器”的代码和数据。Neo4j桌面python…</h3></div><div class="lk l"><p class="bd b fq z dz lh eb ec li ee eg dy translated">github.com</p></div></div><div class="ll l"><div class="lm l ln lo lp ll lq kf lc"/></div></div></a></div><h1 id="481c" class="lr ls hj bd lt lu lv lw lx ly lz ma mb ip mc iq md is me it mf iv mg iw mh mi bi translated">1.数据准备和导入</h1><p id="cbc6" class="pw-post-body-paragraph iy iz hj ja b jb mj ik jd je mk in jg jh ml jj jk jl mm jn jo jp mn jr js jt hc bi translated">我只用两个基因组来做这个演示:Werner <em class="mo">等人</em>的<a class="ae ju" href="https://www.ebi.ac.uk/ena/browser/view/HF571520.1" rel="noopener ugc nofollow" target="_blank">Halorhabdus tiamateaSARL4B</a>的完整染色体。曼恩<em class="mo">等人</em>的<a class="ae ju" href="https://www.ebi.ac.uk/ena/browser/view/HG315671" rel="noopener ugc nofollow" target="_blank"> <em class="mo">台湾沉香</em> KMM 3901 </a>的全基因组..这两个EMBL文件都通过我的脚本转换成JSON格式。您可以在我的存储库中找到原始文件和JSON文件。</p><p id="b4c2" class="pw-post-body-paragraph iy iz hj ja b jb jc ik jd je jf in jg jh ji jj jk jl jm jn jo jp jq jr js jt hc bi translated">在<a class="ae ju" href="https://neo4j.com/download/" rel="noopener ugc nofollow" target="_blank"> Neo4j桌面</a>创建一个项目并启用APOC插件。使用<code class="dv mp mq mr ms b">Open folder -&gt; Import</code>菜单打开<code class="dv mp mq mr ms b">import</code>文件夹。将JSON文件放入文件夹。然后向上一级到<code class="dv mp mq mr ms b">conf</code>文件夹，创建一个名为<code class="dv mp mq mr ms b">apoc.conf</code>的文本文件，并将这两行粘贴到其中:</p><pre class="jw jx jy jz fe mt ms mu mv aw mw bi"><span id="053c" class="mx ls hj ms b fj my mz l na nb">apoc.import.file.enabled=true</span><span id="6067" class="mx ls hj ms b fj nc mz l na nb">apoc.export.file.enabled=true</span></pre><p id="b858" class="pw-post-body-paragraph iy iz hj ja b jb jc ik jd je jf in jg jh ji jj jk jl jm jn jo jp jq jr js jt hc bi translated">因此，您的项目文件夹应该具有这样的文件结构:</p><figure class="jw jx jy jz fe ka es et paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="es et nd"><img src="../Images/b14afc40d94922d7c3a65f11ad315dd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X_kosJ7hrE-1nAxsWJv6qg.png"/></div></div><figcaption class="kh ki eu es et kj kk bd b be z dy translated">图二。此项目的文件结构。图片作者。</figcaption></figure><p id="b1dc" class="pw-post-body-paragraph iy iz hj ja b jb jc ik jd je jf in jg jh ji jj jk jl jm jn jo jp jq jr js jt hc bi translated">现在运行以下命令导入数据:</p><figure class="jw jx jy jz fe ka"><div class="bz dz l di"><div class="ne nf l"/></div></figure><p id="8d0a" class="pw-post-body-paragraph iy iz hj ja b jb jc ik jd je jf in jg jh ji jj jk jl jm jn jo jp jq jr js jt hc bi translated">数据库具有以下简单的数据结构(模式):</p><figure class="jw jx jy jz fe ka es et paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="es et ng"><img src="../Images/137f8bc3316af9f8b0b3229ab9b80edc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NO9sHGu6DxubzlDET52okw.png"/></div></div><figcaption class="kh ki eu es et kj kk bd b be z dy translated">图3。此项目的架构</figcaption></figure><p id="3d92" class="pw-post-body-paragraph iy iz hj ja b jb jc ik jd je jf in jg jh ji jj jk jl jm jn jo jp jq jr js jt hc bi translated"><code class="dv mp mq mr ms b">Contig</code>节点包含所有EMBL元数据，包括分类法、出版物和排序信息。<code class="dv mp mq mr ms b">Lead</code>节点是EMBL文件中的第一个特征，即<code class="dv mp mq mr ms b">source</code>特征。<code class="dv mp mq mr ms b">Gene</code>节点代表基因，包含关于其功能、基因组坐标和翻译的蛋白质序列的键值对。下面是两个具体的例子:</p><figure class="jw jx jy jz fe ka es et paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="es et nh"><img src="../Images/87e896eba9e3779afbd9a59ed83c2345.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wmY9q66IkSJvZ032yQ0NOA.png"/></div></div><figcaption class="kh ki eu es et kj kk bd b be z dy translated">图4。两个基因组的前四个节点。图片作者。</figcaption></figure><h1 id="4474" class="lr ls hj bd lt lu lv lw lx ly lz ma mb ip mc iq md is me it mf iv mg iw mh mi bi translated">2.基因组统计学</h1><p id="57c2" class="pw-post-body-paragraph iy iz hj ja b jb mj ik jd je mk in jg jh ml jj jk jl mm jn jo jp mn jr js jt hc bi translated">一旦数据在Neo4j内部，计算一些复杂的基因组统计数据就相当容易了。例如，以下查询计算了<em class="mo"> Halorhabdus tiamatea </em>染色体中GH的数量:</p><figure class="jw jx jy jz fe ka"><div class="bz dz l di"><div class="ne nf l"/></div></figure><p id="b3d0" class="pw-post-body-paragraph iy iz hj ja b jb jc ik jd je jf in jg jh ji jj jk jl jm jn jo jp jq jr js jt hc bi translated">查询返回“42 ”,它与Werner <em class="mo">等人</em>报告的数字一致..</p><p id="a7c9" class="pw-post-body-paragraph iy iz hj ja b jb jc ik jd je jf in jg jh ji jj jk jl jm jn jo jp jq jr js jt hc bi translated">据报道，富含at和GC的微生物基因组中氨基酸的使用是不同的。我们可以像这样研究两个基因组之间的原始氨基酸计数:</p><figure class="jw jx jy jz fe ka"><div class="bz dz l di"><div class="ne nf l"/></div></figure><figure class="jw jx jy jz fe ka"><div class="bz dz l di"><div class="ne nf l"/></div></figure><p id="e70f" class="pw-post-body-paragraph iy iz hj ja b jb jc ik jd je jf in jg jh ji jj jk jl jm jn jo jp jq jr js jt hc bi translated">该查询使用<code class="dv mp mq mr ms b">REDUCE</code>函数来聚合两个基因组的结果。他们清楚地表明，亮氨酸(L)和异亮氨酸(I)这两种支链氨基酸在<em class="mo">福尔摩沙</em>中比在<em class="mo">盐杆菌</em>中更常见。这两个基因组确实有一些共同点:两种含硫氨基酸:蛋氨酸(M)和半胱氨酸(C)都出现在列表的底部。</p><h1 id="7cd9" class="lr ls hj bd lt lu lv lw lx ly lz ma mb ip mc iq md is me it mf iv mg iw mh mi bi translated">3.寻找基因簇</h1><p id="8e60" class="pw-post-body-paragraph iy iz hj ja b jb mj ik jd je mk in jg jh ml jj jk jl mm jn jo jp mn jr js jt hc bi translated">在基因组学中，对单个基因的分析当然很重要。但有时对基因簇的分析更能揭示问题。基因簇是功能相关基因共同定位的基因组区域。操纵子是经典的基因簇。操纵子内的基因一起被转录和调节。另一个例子是多糖利用位点(PUL)。它是碳水化合物活性酶(CAZymes)基因和膜转运基因的集合体。它们的基因产物可以解聚和动员碳水化合物分子，因此它们在我们生态系统中多糖的生物再循环中起着关键作用。</p><p id="3e55" class="pw-post-body-paragraph iy iz hj ja b jb jc ik jd je jf in jg jh ji jj jk jl jm jn jo jp jq jr js jt hc bi translated">发现基因簇才是Neo4j真正出彩的地方。例如，以下查询搜索以<code class="dv mp mq mr ms b">SusD-like protein</code>和<code class="dv mp mq mr ms b">TonB-dependent receptor</code>结尾的基因簇，只要片段短于<em class="mo"> Formosa agariphila </em>中的10，000个碱基对。</p><figure class="jw jx jy jz fe ka"><div class="bz dz l di"><div class="ne nf l"/></div></figure><figure class="jw jx jy jz fe ka es et paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="es et ni"><img src="../Images/b18d66f120facee02a5022a9e07ddd7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kp6IkXI_ANM4tsZXCX-QtA.png"/></div></div><figcaption class="kh ki eu es et kj kk bd b be z dy translated">图5。琼胶蕈中的TonB依赖受体。图片作者。</figcaption></figure><p id="34e3" class="pw-post-body-paragraph iy iz hj ja b jb jc ik jd je jf in jg jh ji jj jk jl jm jn jo jp jq jr js jt hc bi translated">该查询很快检索到18个这样的聚类。TonB依赖受体和SusD样蛋白一起形成转运蛋白，允许聚糖和其他分子流入。它们是脉冲部件。基因组中这种簇的数量暗示了细菌的多糖降解能力。</p><p id="dcf8" class="pw-post-body-paragraph iy iz hj ja b jb jc ik jd je jf in jg jh ji jj jk jl jm jn jo jp jq jr js jt hc bi translated">从绿藻<em class="mo">中分离出尖端管藻</em>，细菌<em class="mo"> F </em>。<em class="mo">木耳</em>不仅能降解绿藻中的多糖，还能降解褐藻中的多糖。GH16 CAZymes负责其许多琼胶分解活性。和GH16基因通常与其他CAZymes或TonB依赖的受体一起形成PULs。下面的查询将返回所有以GH16为中心的基因簇，在<em class="mo"> F </em>中每边有五个邻居。<em class="mo"> agariphila </em>:</p><figure class="jw jx jy jz fe ka"><div class="bz dz l di"><div class="ne nf l"/></div></figure><figure class="jw jx jy jz fe ka es et paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="es et nj"><img src="../Images/4686b4cc53623cb8a5191a6e6d60d75c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4xYAUS4qO5vWsi_NhjczSg.png"/></div></div><figcaption class="kh ki eu es et kj kk bd b be z dy translated">图6。台湾沉香中的五个GH16中心基因簇。图片作者。</figcaption></figure><p id="20ed" class="pw-post-body-paragraph iy iz hj ja b jb jc ik jd je jf in jg jh ji jj jk jl jm jn jo jp jq jr js jt hc bi translated">该命令返回五个脉冲。其中三个正好有11个基因。第四个有十二个，因为两个GH16 CAZymes是直接相邻的。最后，揭示了一个具有35个基因的超级脉冲。这种超级PUL包含四种GH16 CAZymes:两种β-卟啉酶和两种β-琼脂酶。此外，GH2、GH28、GH29和GH117都在附近出现两次。因为海藻多糖有时会被硫酸化，<em class="mo"> F </em>。<em class="mo"> agariphila </em>在降解前必须用硫酸酯酶去除硫酸基团。集群中有四种硫酸酯酶。最后，TonB依赖性受体、SusD样蛋白和ABC转运蛋白也分散在该片段中。</p><p id="2083" class="pw-post-body-paragraph iy iz hj ja b jb jc ik jd je jf in jg jh ji jj jk jl jm jn jo jp jq jr js jt hc bi translated">总之，这些簇包含许多碳水化合物降解基因，这些基因是<em class="mo"> F </em>琼胶分解生活方式的特征。<em class="mo">琼脂糖凝胶</em>。这个问题也向我们展示了简单的“海藻多糖降解”活动背后的酶协同工作的规模。对这些簇的进一步研究可以加深我们对该过程的理解，甚至导致工业应用。</p><h1 id="9e07" class="lr ls hj bd lt lu lv lw lx ly lz ma mb ip mc iq md is me it mf iv mg iw mh mi bi translated">4.数据编辑</h1><p id="6d3c" class="pw-post-body-paragraph iy iz hj ja b jb mj ik jd je mk in jg jh ml jj jk jl mm jn jo jp mn jr js jt hc bi translated">Neo4j不仅显示信息，还允许编辑。这对生物学家尤其重要，因为他们经常需要手动纠正基因组注释。应用程序Galary中的应用程序Neo4j Commander是实现这一目的的便捷工具。</p><figure class="jw jx jy jz fe ka es et paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="es et nk"><img src="../Images/cfe4fd68aac2d34446dfe11865424f94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q4a-d7cLi9ot_mgzNWDFkg.png"/></div></div><figcaption class="kh ki eu es et kj kk bd b be z dy translated">图7。Neo4j Commander应用程序为Neo4j添加了编辑功能。</figcaption></figure><p id="0a69" class="pw-post-body-paragraph iy iz hj ja b jb jc ik jd je jf in jg jh ji jj jk jl jm jn jo jp jq jr js jt hc bi translated">您可以按照Neo4j桌面中的说明安装该应用程序。安装并打开后，我们可以在GUI中添加、删除和编辑基因属性。</p><figure class="jw jx jy jz fe ka es et paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="es et nl"><img src="../Images/baf3b304d94301f54eba7f218d18f1bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o9GNzYyuto5pzggNJbiXrA.png"/></div></div><figcaption class="kh ki eu es et kj kk bd b be z dy translated">图8。Neo4j Commander中的基因注释编辑。</figcaption></figure><p id="16db" class="pw-post-body-paragraph iy iz hj ja b jb jc ik jd je jf in jg jh ji jj jk jl jm jn jo jp jq jr js jt hc bi translated">如图8所示。，我们可以首先使用查询来定位基因条目。然后，我们可以单击属性字段并开始编辑。当我们单击“保存”时，更改将被写回数据库。</p><h1 id="5dd1" class="lr ls hj bd lt lu lv lw lx ly lz ma mb ip mc iq md is me it mf iv mg iw mh mi bi translated">5.出口</h1><p id="819c" class="pw-post-body-paragraph iy iz hj ja b jb mj ik jd je mk in jg jh ml jj jk jl mm jn jo jp mn jr js jt hc bi translated">最后，我们的Neo4j基因组仓库也可以将序列导出到Fasta或EMBL文件中。它甚至支持跨基因组输出。例如，如果我们想要两个<em class="mo"> H. tiamatea </em>和<em class="mo"> F </em>的所有GH3序列。<em class="mo"> agariphila </em>对于比较基因组分析，以下命令一次性返回它们:</p><figure class="jw jx jy jz fe ka"><div class="bz dz l di"><div class="ne nf l"/></div></figure><figure class="jw jx jy jz fe ka es et paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="es et nj"><img src="../Images/c20d4b674ba548883c5c5f002ff3fb6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PR7esE50F3jTCoK2OTCU_A.png"/></div></div><figcaption class="kh ki eu es et kj kk bd b be z dy translated">图7。GH3序列通过简单的查询检索。图片作者。</figcaption></figure><p id="e313" class="pw-post-body-paragraph iy iz hj ja b jb jc ik jd je jf in jg jh ji jj jk jl jm jn jo jp jq jr js jt hc bi translated">上面的查询通过正则表达式捕获产品名称中的“GH3”关键字。我们可以通过将查询封装在<code class="dv mp mq mr ms b">apoc.export.json.query</code>函数中，将结果导出到Json文件中:</p><figure class="jw jx jy jz fe ka"><div class="bz dz l di"><div class="ne nf l"/></div></figure><p id="0366" class="pw-post-body-paragraph iy iz hj ja b jb jc ik jd je jf in jg jh ji jj jk jl jm jn jo jp jq jr js jt hc bi translated">Json文件也位于<code class="dv mp mq mr ms b">import</code>文件夹中。然后可以从我的存储库中通过Python脚本将其转换成Fasta文件。</p><p id="04f8" class="pw-post-body-paragraph iy iz hj ja b jb jc ik jd je jf in jg jh ji jj jk jl jm jn jo jp jq jr js jt hc bi translated">我们也可以在人工处理后将整个基因组导出到EMBL文件中:</p><figure class="jw jx jy jz fe ka"><div class="bz dz l di"><div class="ne nf l"/></div></figure><p id="d615" class="pw-post-body-paragraph iy iz hj ja b jb jc ik jd je jf in jg jh ji jj jk jl jm jn jo jp jq jr js jt hc bi translated">这个命令写一个Json文件。然后，我的Python脚本json_2_embl.py可以将其转换成embl文件。</p></div><div class="ab cl nm nn gq no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="hc hd he hf hg"><h1 id="9f40" class="lr ls hj bd lt lu nt lw lx ly nu ma mb ip nv iq md is nw it mf iv nx iw mh mi bi translated">结论</h1><p id="d176" class="pw-post-body-paragraph iy iz hj ja b jb mj ik jd je mk in jg jh ml jj jk jl mm jn jo jp mn jr js jt hc bi translated">本文展示了Neo4j如何同时成为强大的基因组浏览器和数据仓库。目前，在线数据库，如国家生物技术信息中心(NCBI)或欧洲生物信息学研究所(EBI)仍然存有基因组文本文件。他们的网站允许一些简单的全文搜索。但是像本文中提出的复杂查询在那里还不可能实现。如果这两个研究所可以使用Neo4j作为他们的后端仓库，用户可以执行更复杂的查询，并在服务器端进行比较分析。事实上，他们甚至可以用相同的设计在Neo4j中存储元基因组。我相信这一转变将加速基因组学和宏基因组学的新发现。</p><p id="8659" class="pw-post-body-paragraph iy iz hj ja b jb jc ik jd je jf in jg jh ji jj jk jl jm jn jo jp jq jr js jt hc bi translated">但是，我的Neo4j设计并不完美。我试图将几兆字节的DNA序列存储到<code class="dv mp mq mr ms b">Contig</code>节点中。令我惊讶的是，臃肿的<code class="dv mp mq mr ms b">Contig</code>节点严重降低了数据库性能。因此，我决定在图表中省略DNA序列的输入。这就是为什么<code class="dv mp mq mr ms b">json_2_embl.py</code>剧本需要原始的EMBL文件的原因。我希望Neo4j的未来版本可以解决性能问题。</p><p id="7608" class="pw-post-body-paragraph iy iz hj ja b jb jc ik jd je jf in jg jh ji jj jk jl jm jn jo jp jq jr js jt hc bi translated">你们的基因组研究也用Neo4j吗？如果有，请和我分享一下你的经历。</p><div class="kz la fa fc lb lc"><a href="https://dgg32.medium.com/membership" rel="noopener follow" target="_blank"><div class="ld ab dx"><div class="le ab lf cl cj lg"><h2 class="bd hk fj z dz lh eb ec li ee eg hi bi translated">加入媒介与我的介绍链接-黄思兴</h2><div class="lj l"><h3 class="bd b fj z dz lh eb ec li ee eg dy translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="lk l"><p class="bd b fq z dz lh eb ec li ee eg dy translated">dgg32.medium.com</p></div></div><div class="ll l"><div class="ny l ln lo lp ll lq kf lc"/></div></div></a></div></div></div>    
</body>
</html>