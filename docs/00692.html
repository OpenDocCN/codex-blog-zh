<html>
<head>
<title>Creating a Multifaceted Grocery Recommender System</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">创建一个多方面的杂货推荐系统</h1>
<blockquote>原文：<a href="https://medium.com/codex/creating-a-multifaceted-grocery-recommender-system-c394208f5e0b?source=collection_archive---------2-----------------------#2021-03-11">https://medium.com/codex/creating-a-multifaceted-grocery-recommender-system-c394208f5e0b?source=collection_archive---------2-----------------------#2021-03-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><h2 id="818e" class="hg hh hi bd b fp hj hk hl hm hn ho dx hp translated" aria-label="kicker paragraph"><a class="ae ge" href="http://medium.com/codex" rel="noopener">法典</a></h2><div class=""/><p id="7b79" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">为了这个项目，我基于2017年Kaggle比赛中使用的Instacart数据创建了一个多方面的杂货推荐系统。</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div class="er es jm"><img src="../Images/3f985552eff6067f5435bf8515aa977f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1392/format:webp/1*dxmoKN22lsWYdAOm_7I0uw.jpeg"/></div></figure><p id="f642" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">作为一名受过市场营销教育的终身“美食家”，我在完成数据科学课程时，立即被创建一个杂货推荐系统的想法吸引住了。我经常从当地的杂货店收到优惠券，这些优惠券要么是我过去购买过的物品，要么是商店认为“我会感兴趣”的物品。我也收到当地药店发来的电子邮件，提供优惠券，让我知道“我可能喜欢的商品”何时打折。这些是推荐系统运行的例子。</p><h1 id="79fd" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">数据</h1><p id="2e66" class="pw-post-body-paragraph io ip hi iq b ir ks it iu iv kt ix iy iz ku jb jc jd kv jf jg jh kw jj jk jl hb bi translated">只需探索数据中的购买模式，就可以获得有用的信息。我们可以看到哪些过道和部门的订单从最多，甚至下降到产品级别。我们可以看到每个订单中的典型商品数量，以及用户在下一个订单之前还有多少天。例如，订购最多的产品如下所示。</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es kx"><img src="../Images/372c2a0b7639234ba579bbed17629563.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w1BRq16kizYoEZutmoBT3A.png"/></div></div></figure><h1 id="ca65" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">客户聚类</h1><p id="c747" class="pw-post-body-paragraph io ip hi iq b ir ks it iu iv kt ix iy iz ku jb jc jd kv jf jg jh kw jj jk jl hb bi translated">我的第一个建模步骤是使用K-Means聚类算法，根据相似性将我的用户聚类在一起。在商业环境中，拥有这些信息可以让你针对不同的用户群进行个性化营销。一个群体似乎被定义为大量购买婴儿用品。另一群人买了很多酒。有些很大，有些很小但很具体。我觉得查看每个集群的“购买力”很重要，我通过集群中的用户数量、来自该集群的订单和产品的百分比以及下面看到的其他购买指标来定义购买力。</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es lc"><img src="../Images/4fe02539c6e63ef0fd9181c8550b1d70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xDavjso_cXxWL7DwUvxyXw.png"/></div></div></figure><h1 id="d19d" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">NLP产品搜索引擎</h1><p id="b62f" class="pw-post-body-paragraph io ip hi iq b ir ks it iu iv kt ix iy iz ku jb jc jd kv jf jg jh kw jj jk jl hb bi translated">超过3200万个订单id和产品id组合的数据规模，禁止使用基于记忆的推荐器，如KNN，它将查看客户与客户的相似性和项目与项目的相似性。然而，比较相似商品的想法驱使我使用自然语言处理来创建一个搜索引擎，人们可以在其中输入任何文本值并获得推荐的产品。具体来说，我对每个产品的通道、部门和产品名称进行了标记化和词干化，然后使用计数矢量器计算每个产品的余弦相似性矩阵。示例搜索输出如下所示。</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es ld"><img src="../Images/c8fa69ec1fb447dbc266b285c9bfc7a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kNQeEghSeRi41ioAC3ubcw.png"/></div></div></figure><h1 id="5b06" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">奇异值分解推荐器</h1><p id="273a" class="pw-post-body-paragraph io ip hi iq b ir ks it iu iv kt ix iy iz ku jb jc jd kv jf jg jh kw jj jk jl hb bi translated">接下来，我使用了奇异值分解，这是一种矩阵分解方法，可以在降低数据维度的同时发现客户和商品的潜在特征，从而为每个用户生成产品“评级”。在没有明确的产品评级的情况下，我使用用户购买特定产品的次数作为评级的代表，给我的评级范围是1-100。我最初的RMSE是3.46，在1-100的范围内，这似乎不是一个很大的误差，但是进一步检查后，我意识到评级较高的项目有非常大的预测误差。</p><p id="1d38" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">因此，我将我的评级重新调整到1-5的范围内，通过超参数网格搜索，我的RMSE降到了1.26。然而，数据中的大流行性偏差导致最受欢迎的项目(即香蕉)被高度推荐给每个用户。经过一些研究，我决定对每个用户的推荐产品进行个性化的重新排序，指定一定比例的推荐产品来自产品分布的“长尾”或“远尾”。我将产品的“短头”定义为占订单前80%的前15%的产品。</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es le"><img src="../Images/cb91a5a322a0b2cfaf0baddebb4f2a2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0JSz-eiouA1Mlmni3_6YSQ.png"/></div></div></figure><p id="93cb" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">对于新客户，我创建了一个函数，允许他们提交一定数量的产品(如果需要的话，来自某个通道)的评级，然后该模型将生成所需数量的推荐(如果需要的话，也来自特定的通道)，并提供分布长尾中指定百分比的产品。</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es lf"><img src="../Images/d9f64443a61df117ac65fffcf488fc30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TpTt7Mek3Ff0FG3E54CQEg.png"/></div></div></figure><h1 id="8269" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">关联规则—购物篮分析</h1><p id="9ec5" class="pw-post-body-paragraph io ip hi iq b ir ks it iu iv kt ix iy iz ku jb jc jd kv jf jg jh kw jj jk jl hb bi translated">我在Medium上找到了其他数据科学家的一些很棒的博客，他们为这些数据中的产品创建了关联规则。通过计算每个产品和产品组合的频率和支持，以及产品B将与产品A一起购买的置信度，然后计算产品组合的提升，这基本上是产品一起购买的频率除以它们一起出现的概率(如果它们是独立的)。主要是重用他们的代码(我记在笔记本上)，我为每个用户群中一起购买的每对产品生成产品关联规则。以下是第19类提升分数最高的项目组合。</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es lg"><img src="../Images/e469b12897d67b0f4d17789995524749.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1Z_uDKC86bQcI5lSqmtGqg.png"/></div></div></figure><p id="9e1f" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">我意识到这些计算方法考虑到了数据中的受欢迎程度偏差。因此，即使香蕉几乎与所有东西一起购买，它们的信心和提升分数也会根据它们的相对频率而打折扣。</p><h1 id="2f33" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">烧瓶应用</h1><p id="8fe9" class="pw-post-body-paragraph io ip hi iq b ir ks it iu iv kt ix iy iz ku jb jc jd kv jf jg jh kw jj jk jl hb bi translated">最后，我创建了一个FLASK应用程序来将我的建模部署到web浏览器。这个应用程序有一个主页以及NLP和SVD推荐器的单独页面。还有一个评级页面，供新用户提交评级，然后接收来自SVD模型的推荐。希望以后能把关联规则推荐器作为单独的页面添加进去。</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es lh"><img src="../Images/cc8926bc78f771754546894d2dfbdf58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oN3OX8MvzrU9yX9zKgiuLQ.png"/></div></div></figure><h1 id="b353" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated"><strong class="ak">感谢阅读！</strong></h1><p id="247f" class="pw-post-body-paragraph io ip hi iq b ir ks it iu iv kt ix iy iz ku jb jc jd kv jf jg jh kw jj jk jl hb bi translated">查看<a class="ae li" href="https://github.com/melodygr/grocery_recommendation" rel="noopener ugc nofollow" target="_blank"> Github此处</a> <br/>联系我<a class="ae li" href="https://www.linkedin.com/in/melody-peterson-7092852/" rel="noopener ugc nofollow" target="_blank"> LinkedIn此处</a> <br/>我目前公开招聘！</p></div></div>    
</body>
</html>