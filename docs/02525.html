<html>
<head>
<title>Introducing splines to describe nonlinear relationships</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">引入样条来描述非线性关系</h1>
<blockquote>原文：<a href="https://medium.com/codex/introducing-splines-to-describe-nonlinear-relationships-e8b9c6edbacc?source=collection_archive---------9-----------------------#2021-07-24">https://medium.com/codex/introducing-splines-to-describe-nonlinear-relationships-e8b9c6edbacc?source=collection_archive---------9-----------------------#2021-07-24</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/1a5fcd3e562d1cb447509fa37adecd3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*lPkoz0afbIVuq7oK"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">里卡多·戈麦斯·安吉尔在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="bf18" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">每个模型都是错的。什么？是的，每个模型都是错的。尤其是线性关系，因为现实世界中的大多数关系都不是线性的。想想吧。随着你花更多的钱，你对购物的满意度会直线上升吗？一个公司的利润会随着在一个项目上花费更多的时间而线性增长吗？因此，为了更好地预测，我们需要一种方法来表示非线性关系。有很多，这里有一些你可以使用的样条。</p><h1 id="adc5" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">多项式回归</h1><p id="43c6" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">这是实现非线性的最简单方法。你只需要</p><ol class=""><li id="945f" class="kw kx hi ix b iy iz jc jd jg ky jk kz jo la js lb lc ld le bi translated">包括多项式项作为预测值</li><li id="b4a2" class="kw kx hi ix b iy lf jc lg jg lh jk li jo lj js lb lc ld le bi translated">为了获得更高的灵活性，使用更高的功效，并通过交叉验证或方差分析来检查它们的有效性</li></ol><p id="f016" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这种方法的局限性之一来自于模型的灵活性。增加灵活性的唯一方法是通过包含更高的预测项。然而，随着最高功率的增加，该模型的两端可能会变得过于摆动。因此，很难期望拟合良好的多项式回归具有高于3或4的幂。</p><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="9f42" class="lt ju hi lp b fi lu lv l lw lx">fit.n = lm(response~poly(predictor, n), data=Data.set)</span><span id="ac24" class="lt ju hi lp b fi ly lv l lw lx">plot(predictor, response, bty="l")<br/>preds = predict(fit.n, newdata=list(predictor.grid), se=T)<br/>lines(predictor.grid, preds$fit)<br/>se.bands=cbind(preds$fit+2*preds$se.fit, preds$fit-2*preds$se.fit)<br/>matlines(predictor.grid, se.bands)</span></pre><figure class="lk ll lm ln fd ij er es paragraph-image"><div class="er es lz"><img src="../Images/b4f2eab10bfe72441ca7b14da025f0eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*FYe6n8S_Rpw2c9E_Ao3Jxg.gif"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">随着功率的增加，曲线显示了摆动的末端</figcaption></figure><p id="0945" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这种方法的另一个限制是它总是产生全局结构。也就是说，一个公式适用于整个预测值范围，因此您不能实施区域更改，因为模型中的一个小修改会完全改变模型的形状。因此，对不同区域应用不同公式的算法将是优选的。</p><h1 id="cebd" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">阶跃函数</h1><p id="7fc8" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">与多项式回归不同，阶跃函数给出了一个非全局结构。因此，其过程在拟合模型之前有一个额外的步骤。</p><ol class=""><li id="2f5f" class="kw kx hi ix b iy iz jc jd jg ky jk kz jo la js lb lc ld le bi translated">将预测值的范围划分为K个不同的区间</li><li id="5d19" class="kw kx hi ix b iy lf jc lg jg lh jk li jo lj js lb lc ld le bi translated">将不同的常数放入这些容器中</li><li id="e32a" class="kw kx hi ix b iy lf jc lg jg lh jk li jo lj js lb lc ld le bi translated">要获得更高的灵活性，请增加箱子的数量</li></ol><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="0c7a" class="lt ju hi lp b fi lu lv l lw lx">fit.n = lm(response~cut(predictor, n), data=Data.set)</span></pre><figure class="lk ll lm ln fd ij er es paragraph-image"><div class="er es ma"><img src="../Images/8cf9ba79ff8b1f3d6263ca68735bff23.png" data-original-src="https://miro.medium.com/v2/resize:fit:480/1*yuZfb5b8u8rt_zodudCmmQ.gif"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">灵活性随着箱数量的增加而增加</figcaption></figure><p id="f01f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">从图中可以看出，阶跃函数类似于如下所述的分段常数函数。</p><figure class="lk ll lm ln fd ij er es paragraph-image"><div class="er es mb"><img src="../Images/ce5b3de473e7e67e38e62cdba9c27851.png" data-original-src="https://miro.medium.com/v2/resize:fit:1242/format:webp/1*jBU_dK2rkFE_FoEErXOWeQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">阶跃函数方程</figcaption></figure><p id="5fab" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">那么阶跃函数的限制是什么呢？因为它将预测值划分为不同的范围，所以如果没有任何自然断点(如下图中的红圈所示),它可能无法识别趋势。</p><figure class="lk ll lm ln fd ij er es paragraph-image"><div class="er es mc"><img src="../Images/fff727723cf14549bb15851825f234de.png" data-original-src="https://miro.medium.com/v2/resize:fit:632/format:webp/1*HIid01Gx72PTzH5FKgF3eg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">红色圆圈表示阶跃函数未能检测到上升趋势的区域</figcaption></figure><p id="27d6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然而，如果我们换句话说，这意味着如果有自然断点，阶跃函数可能是有用的。因此，在生物统计学和流行病学中使用它是很常见的，在那里你可以将年龄分解成不同的类别。</p><h1 id="d1b0" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">回归样条</h1><p id="4814" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">解决多项式回归局限性的另一种方法是回归样条。其过程介于多项式回归和阶跃函数之间。</p><ol class=""><li id="c34b" class="kw kx hi ix b iy iz jc jd jg ky jk kz jo la js lb lc ld le bi translated">用结划分预测器的范围</li><li id="2ebb" class="kw kx hi ix b iy lf jc lg jg lh jk li jo lj js lb lc ld le bi translated">将多项式函数拟合到每个区域</li><li id="f349" class="kw kx hi ix b iy lf jc lg jg lh jk li jo lj js lb lc ld le bi translated">为了灵活，通过交叉验证调整结的数量</li></ol><p id="a917" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因此，就像阶跃函数一样，回归样条可以视为分段多项式回归。</p><figure class="lk ll lm ln fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es md"><img src="../Images/55b83b6a58b474b58c227411d0bf15cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HP_Hiw28Ji_2Ry4LAqwi0g.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">三次样条方程</figcaption></figure><p id="d566" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">分段函数的优点是，它在提高灵活性方面比多项式回归更稳定，因为它需要增加节点数而不是幂。</p><p id="7277" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">使用没有任何修改的回归样条的一个问题是，模型在节点处是不连续的，如下图所示。或者换句话说，样条太灵活了。因此，降低灵活性以使其更加自然会有所帮助，您可以通过向模型添加约束来实现这一点。</p><figure class="lk ll lm ln fd ij er es paragraph-image"><div class="er es lz"><img src="../Images/f08b401a31a03063a2a857c8eabd651d.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*Ks5xI8dWs6icCT1rsWE6wQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">显示结处不连续性的三次样条曲线</figcaption></figure><p id="d482" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">您可以添加的第一个约束是使模型在结处连续。</p><figure class="lk ll lm ln fd ij er es paragraph-image"><div class="er es lz"><img src="../Images/ecaf7bf1f16ad84883be0c6c70bc56e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*tPX7wKds2_FYdAKZJDOWqg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">一个三次样条显示了结处的V形/这个图形被人为地修改以证明一个点</figcaption></figure><p id="7eaa" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">但是，由于结处的v字形，模型看起来仍然不自然。为了解决这个问题，您可以添加另外两个约束:一阶和二阶导数——曲线的斜率和粗糙度——在节点处保持连续。</p><figure class="lk ll lm ln fd ij er es paragraph-image"><div class="er es lz"><img src="../Images/e6ad0ef17adf7c670a50d1a5d1281bb2.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*AqjPma5YQCalidBJBCTTcg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">具有5个约束的光滑三次样条</figcaption></figure><p id="410d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因此，要制作平滑的样条，二阶导数应该存在，以便我们可以应用约束。因此，通常使用三次多项式来拟合回归样条。</p><p id="c483" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">所以现在你明白了，给模型添加约束会使模型更平滑，灵活性更差。但是这样做的代价是什么呢？</p><p id="acab" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">原始回归样条由两个三次多项式组成，每个多项式有4个系数。因此，该模型总共有8个自由度。这些自由度是增加约束的代价。一个约束对应一个自由度。因此，在上面的最终模型中，有8–3 = 5个自由度。另一种计算三次样条自由度的方法是通过<em class="me"> 4+K </em>，其中K代表使用的节点数。</p><p id="5a42" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在的问题是，你应该把结放在哪里？</p><p id="5e9e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这个问题没有一个最佳答案，但基础是在数据点聚集的地方放置更多的结，以便模型可以处理非线性。一种方法是在你认为数据点变化快的地方多打几个结，这需要领域知识。另一种更常见的方法是根据自由度均匀分布结。例如，当您用三次样条曲线要求7个自由度时，在第25、50和75个百分点处将有3个节点。</p><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="3ff2" class="lt ju hi lp b fi lu lv l lw lx">fit = lm(response~bs(predictor, knots=c(n1, n2, n3)), data=Data.set)<br/>fit = lm(response~bs(predictor, df=n), data=Data.set)</span></pre><div class="lk ll lm ln fd ab cb"><figure class="mf ij mg mh mi mj mk paragraph-image"><img src="../Images/471d68cc5e64c454882fd1930e085a1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*mGsREzpzbcbXcHrbhN_JkQ.png"/></figure><figure class="mf ij mg mh mi mj mk paragraph-image"><img src="../Images/c5e351d39f0f2b616426b2f4a535b7ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*NZTSOyl6jcacBH71SuS6AA.png"/><figcaption class="iq ir et er es is it bd b be z dx ml di mm mn translated">带有用户选择的节点的三次样条/带有由函数自动选择的节点的三次样条</figcaption></figure></div><h1 id="f025" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">自然三次样条</h1><p id="c5c6" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">尽管三次样条曲线中的约束使模型的中间部分变得平滑，但在没有应用约束的样条曲线的两端，模型可能会有很大的变化。为了解决这个问题，我们可以在每一端设置两个约束:一阶和二阶导数都为0。有了这些额外的约束，两端变成了具有较低方差的线性，我们称这种方法为自然三次样条。</p><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="0c9d" class="lt ju hi lp b fi lu lv l lw lx">fit.n = lm(response~ns(predictor, df=n), data=Data.set)</span></pre><figure class="lk ll lm ln fd ij er es paragraph-image"><div class="er es lz"><img src="../Images/8130b55ecb00f937fb8b3c102c41abfd.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*q0sgSdeCDrt4iDhGDP59TA.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">显示三次样条比自然三次样条的置信区间更宽的图</figcaption></figure><h1 id="08b0" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">平滑样条</h1><p id="6c2e" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">另一种生成样条曲线的方法遵循脊和套索回归的类似概念。</p><ol class=""><li id="9445" class="kw kx hi ix b iy iz jc jd jg ky jk kz jo la js lb lc ld le bi translated">找到一个使σ(yᵢ最小的函数g(x)——g(xᵢ)</li><li id="1bc1" class="kw kx hi ix b iy lf jc lg jg lh jk li jo lj js lb lc ld le bi translated">为灵活起见，选择一个合适的λ值</li></ol><figure class="lk ll lm ln fd ij er es paragraph-image"><div class="er es lz"><img src="../Images/0181e21579cbc5552ceaadfd38e92084.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*_JSdAsrctZmo9vDL2HwdzA.gif"/></div></figure><figure class="lk ll lm ln fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mo"><img src="../Images/3ed7300e62a39b7e494ebff443f084d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dd08SIAympGq12OguHrywA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">随着lambda的减少，显示灵活性增加的图(上)/平滑样条方程(下)</figcaption></figure><p id="8c03" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因此，就像脊和套索回归一样，平滑样条方程由损失函数-σ(yᵢ-g(xᵢ)-和代表模型粗糙度总和的惩罚项- λ∫g"(t) dt -组成。因此，当λ=0时，罚项对模型的粗糙度没有影响。因此，g(x)将尝试对大多数训练观测值进行插值。另一方面，当λ增加时，惩罚项对粗糙度的影响更大。因此，模型变得更加平滑，并最终达到完美的线性。因此，使用平滑样条时，通过交叉验证选择合适的λ至关重要。</p><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="0e47" class="lt ju hi lp b fi lu lv l lw lx">fit.n = smooth.spline(predictor, response, cv=T) </span></pre><figure class="lk ll lm ln fd ij er es paragraph-image"><div class="er es lz"><img src="../Images/e8f1cfc83ce9fc95e476d59fd795898d.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*kGpIDC-fQ_zyEI8ORD9QOg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">由CV选择的lambda值为0.0233 / 6.895 df的平滑样条线</figcaption></figure><h1 id="8eec" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">局部回归</h1><p id="0f58" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">与以前的方法不同，以前的方法是一次给出所有的观测值来拟合一个模型，局部回归在拟合过程中使用来自目标点的局部观测值。</p><ol class=""><li id="a1b7" class="kw kx hi ix b iy iz jc jd jg ky jk kz jo la js lb lc ld le bi translated">选择多少个观测值将被包含在跨度s中，跨度s通过<em class="me">邻近观测值</em> / <em class="me">总观测值</em>来计算</li><li id="c8d2" class="kw kx hi ix b iy lf jc lg jg lh jk li jo lj js lb lc ld le bi translated">将较大的权重- Kᵢ₀ -应用于更接近目标点的观测</li><li id="e34e" class="kw kx hi ix b iy lf jc lg jg lh jk li jo lj js lb lc ld le bi translated">拟合最小化σkᵢ₀(yᵢ-β₀-β₁xᵢ的加权最小二乘回归)</li><li id="c158" class="kw kx hi ix b iy lf jc lg jg lh jk li jo lj js lb lc ld le bi translated">要获得更高的灵活性，请选择较小的s值</li></ol><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="2b6e" class="lt ju hi lp b fi lu lv l lw lx">fit.n = loess(response~predictor, span=n, data=Data.set)</span></pre><figure class="lk ll lm ln fd ij er es paragraph-image"><div class="er es lz"><img src="../Images/4db82ee472095bf64d767f094b7f1040.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*AIWH8WAumQDrH7vbcH550Q.gif"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">随着跨度的减小，曲线显示灵活性增加</figcaption></figure><p id="688f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因为局部回归使用附近的观测值进行预测，所以当局部观测值很少时，它的局限性就很明显。但是这是什么时候发生的呢？</p><p id="fb36" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们假设所有的预测值都显示正态分布，我正在尝试找出10个附近的观测值与目标点有多大关系。为了衡量这一点，我使用了欧几里德距离。</p><figure class="lk ll lm ln fd ij er es paragraph-image"><div class="er es lz"><img src="../Images/87151c771e5a1d9e0c07677c739e5652.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*uRY6e8QjdV8K8phR_h4rWA.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">根据预测值数量显示不同平均距离分布的图</figcaption></figure><p id="f6ec" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">随着预测值数量的增加，目标点和附近观测值之间的平均距离也会增加。这意味着随着p的增加，获得与目标点密切相关的观测值变得更加困难，这最终会降低模型的性能。因此，我们可以说，当有大量预测因子时，局部回归往往表现不佳。</p><p id="bb55" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">即使有这个缺点，局部回归还是有用的，因为没有固定的结构。因此，如果有足够的数据点，这是一个建模复杂结构的好选择，其他方法不能。</p><h1 id="9f88" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">以此为基础的广义可加模型</h1><p id="b2a5" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">到目前为止，我给了你各种方法，你可以使用非线性拟合。有了广义加性模型(GAM ),你就不必局限于只应用其中的一个。GAM作为一个框架，上面的所有方法，加上你知道的其他方法，作为构建模块，这样你就可以将你选择的方法组合到GAM中，并做出预测。</p><p id="cfa0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">使用GAM的主要优势来自于它的附加性质，因为它允许我们在保持其他因素不变的情况下，检查每个预测因素对反应的单独影响。因此，如果您对推理感兴趣，GAM可能是一个不错的选择，因为您可以从其输出中直观地看到每个人的效果。</p><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="7254" class="lt ju hi lp b fi lu lv l lw lx">gam.mix = gam(response~ns(predictor1,df=4) + lo(predictor2,span=n) <br/>              + predictor3,data=Data.set)</span></pre><figure class="lk ll lm ln fd ij er es paragraph-image"><div class="er es mp"><img src="../Images/4c0e2509ee094a86ff75954ed715087d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1028/format:webp/1*ptPnDdXQcBG4KDFdADViRg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">GAM的输出允许我们检查每个人的效果</figcaption></figure><p id="27db" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">具有讽刺意味的是，其中一个缺点也来自于加法行为，因为它不考虑交互项，除非我们明确地指定它们。因此，我们可能会错过一些重要的。</p><h1 id="f3a4" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">最后的话</h1><p id="25c3" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">正如所有事情一样，没有一种方法在任何情况下都可以支配所有其他方法。使用哪种方法几乎总是取决于数据集的样子。因此，与其偏爱一种方法，不如先探索数据集，尝试不同的方法，看看哪种更适合。如果上面的任何样条曲线不符合数据集，您可能需要考虑其他方法，如决策树。</p></div><div class="ab cl mq mr gp ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="hb hc hd he hf"><h1 id="f164" class="jt ju hi bd jv jw mx jy jz ka my kc kd ke mz kg kh ki na kk kl km nb ko kp kq bi translated">参考</h1><p id="4d8f" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">[1]红衣主教。“在r中设置自然三次样条中的结”.<em class="me">交叉验证</em>，2011年2月17日，stats . stack exchange . com/questions/7316/Setting-Knots-in-Natural-Cubic-Splines-in-r。</p><p id="a9c5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">[2]威廉·格思里。【4.1.4.4】T2。黄土，【www.itl.nist.gov/div898/handbook/pmd/section1/pmd144.htm.】黄土</p><p id="5380" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">[3]詹姆斯，加雷斯。统计学习介绍:在R中的应用。斯普林格，2021。</p><p id="525c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">[4]拉尔森，金。" GAM:预测建模银弹."<em class="me">多线程</em>，2015年7月30日，multithreaded.stitchfix.com/blog/2015/07/30/gam/.</p><p id="b7ca" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">[5]用户11852。"为什么自然样条几乎总是三次的？"<em class="me">交叉验证</em>，2018年10月28日，stats . stack exchange . com/questions/374081/why-are-natural-splines-almost-almost-cubic。</p></div></div>    
</body>
</html>