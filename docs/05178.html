<html>
<head>
<title>Linear Regression for Causal Inference</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">因果推断的线性回归</h1>
<blockquote>原文：<a href="https://medium.com/codex/linear-regression-for-causal-inference-242da2a01086?source=collection_archive---------6-----------------------#2022-02-06">https://medium.com/codex/linear-regression-for-causal-inference-242da2a01086?source=collection_archive---------6-----------------------#2022-02-06</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="50e3" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">深入探究相关性和因果关系。</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/8033bc788cefe0ca72bb021deda54811.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*aOkqabqk54Y3barl"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">照片由<a class="ae jn" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae jn" href="https://unsplash.com/@sunder_2k25?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Sunder Muthukumaran </a>拍摄</figcaption></figure><p id="0143" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">相关性并不意味着因果关系。</p><p id="4d25" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">是的，你可能已经听过很多次了。在我的数据科学本科培训中，我一次又一次地听到，它已经在我的灵魂中留下了永恒的印记。但事实证明，线性回归不仅仅可以预测(利用相关性)。它还能帮助我们做出<em class="kk">因果推论</em>！也许相关性和因果关系之间的关系比我们最初想象的更复杂。</p><p id="3f8a" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在这篇博客中，让我们来看看:</p><ul class=""><li id="a5d3" class="kl km hi jq b jr js ju jv jx kn kb ko kf kp kj kq kr ks kt bi translated">如何解读因果图，</li><li id="6fc3" class="kl km hi jq b jr ku ju kv jx kw kb kx kf ky kj kq kr ks kt bi translated">混淆和虚假的关系是什么，和</li><li id="933b" class="kl km hi jq b jr ku ju kv jx kw kb kx kf ky kj kq kr ks kt bi translated">如何通过r中的一个简单例子用线性回归进行因果推断。</li></ul><h1 id="cc94" class="kz la hi bd lb lc ld le lf lg lh li lj io lk ip ll ir lm is ln iu lo iv lp lq bi translated">因果图</h1><p id="f71d" class="pw-post-body-paragraph jo jp hi jq b jr lr ij jt ju ls im jw jx lt jz ka kb lu kd ke kf lv kh ki kj hb bi translated">我们可以用因果<a class="ae jn" href="https://en.wikipedia.org/wiki/Directed_acyclic_graph" rel="noopener ugc nofollow" target="_blank">有向无环图</a> (DAG)或<a class="ae jn" href="https://en.wikipedia.org/wiki/Causal_graph" rel="noopener ugc nofollow" target="_blank">因果图</a>来表示因果关系。例如，这是一个因果DAG。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lw"><img src="../Images/537748d5212ac9ee89e1272f7c430be0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1OqpJzQONhTL6HzxMXCGqA.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">作者图片</figcaption></figure><p id="fe0e" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">a和B是两个变量。从A到B的箭头表示A导致B，差不多就是这样。Dag清晰地描绘了你对变量之间因果关系的假设。在你知道之前，因果图会变得非常复杂。</p><pre class="iy iz ja jb fd lx ly lz ma aw mb bi"><span id="7c8e" class="mc la hi ly b fi md me l mf mg"># a bit of R code<br/>library(dagitty) <br/>library(ggdag)  <br/>dag &lt;- dagitty("dag{ A -&gt; B; C -&gt; B; A -&gt; C; D -&gt; C; E -&gt; C; F -&gt; E; F -&gt; D; G -&gt; A; G -&gt; C; E -&gt; A; }")<br/>ggdag(dag)</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mh"><img src="../Images/ad052132e4f6881747912cd836137261.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LQyZStfaYfUYMMQ0sFagPg.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">作者图片</figcaption></figure><p id="8049" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">然而，正如有向无环图(DAG)这个名字所暗示的，无论因果图变得多么复杂，都有两条规则:</p><ol class=""><li id="7e5c" class="kl km hi jq b jr js ju jv jx kn kb ko kf kp kj mi kr ks kt bi translated">任何边都只能是<strong class="jq hj">单向</strong>，或者单向的，意思是A和B不能互为因果。因为时间只能单向流动。A和b之间总是有一个时序。然而，有时可能存在双向弧，但这意味着这两个变量是相关的，但<em class="kk">原因不清楚</em>【1】。</li><li id="0cec" class="kl km hi jq b jr ku ju kv jx kw kb kx kf ky kj mi kr ks kt bi translated">图中没有<strong class="jq hj">循环</strong>，意味着不可能是A导致B，B导致C，然后C导致A(或者任何涉及更多变量的循环)。出于与上述相同的原因，如果A首先发生，C最后发生，则不可能有从C指向A的边</li></ol><p id="4d57" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">因此，对于相关但不一定有因果关系的变量，因果图中的边可能存在，也可能不存在。如果有，方向未定。如果我们确实相信一种相关性可以导致一种可能的因果关系，我们通常有一个强大的理论基础来支持我们的假设。</p><p id="921e" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">现在，我们可以用因果图来理解混杂和虚假的关系。</p><h1 id="1afa" class="kz la hi bd lb lc ld le lf lg lh li lj io lk ip ll ir lm is ln iu lo iv lp lq bi translated">混杂和虚假的关系</h1><p id="048d" class="pw-post-body-paragraph jo jp hi jq b jr lr ij jt ju ls im jw jx lt jz ka kb lu kd ke kf lv kh ki kj hb bi translated"><em class="kk">混杂变量</em>，或<a class="ae jn" href="https://www.scribbr.com/methodology/confounding-variables/" rel="noopener ugc nofollow" target="_blank">混杂变量</a>/因子，是影响自变量和因变量的第三个变量。实际上并不存在的自变量和因变量之间的虚假关系因此被称为<a class="ae jn" href="https://en.wikipedia.org/wiki/Spurious_relationship" rel="noopener ugc nofollow" target="_blank"> <em class="kk">虚假关系</em> </a>。</p><p id="754e" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这里，我们引入变量C作为自变量A和因变量B的唯一混杂因素，假设C引起A和B，那么我们可以去掉A和B之间的边缘。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mj"><img src="../Images/6f894912d39ac9901dbe5a1f14ba1b90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FcX0CNPMRwhoAZvhfuBFeA.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">作者图片</figcaption></figure><p id="9c5d" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">但是，很多时候，A和B之间的边缘并不是那么容易跨出去的。正常情况下，不会有唯一的混淆因素。从C1到中国会有一长串混杂因素，我们很难找到所有的混杂因素。</p><p id="0736" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">一个经典的例子是，A =冰淇淋销量，B =犯罪率。统计数据显示，冰淇淋的销量与犯罪率高度相关，但这是否意味着卖出更多的冰淇淋会导致更多的犯罪？你的理智可能会告诉你不，不会的。那么，在这种情况下，混杂因素C是什么呢？</p><p id="fff6" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">答案:<em class="kk"> </em> <strong class="jq hj"> <em class="kk">炎热的夏天天气里的炎热</em> </strong> <em class="kk">。</em></p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mk"><img src="../Images/b967dda0d7e77b25d2d76b927e006077.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NFKWKoFvku2Tc3aGVEPflw.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">作者图片</figcaption></figure><p id="de61" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">很容易看出热量是如何导致冰淇淋销量上升的。至于犯罪率，也许人们在天气炎热时更容易冲动，因此更容易犯罪。我们可以推测，但很难证明。这就是为什么因果图是我们假设的代表。不做实验，光靠观察数据，我们说不出多少肯定的话。然而，因果图是简单而有用的，足以区分人类逻辑的关键过程。</p><h1 id="1daa" class="kz la hi bd lb lc ld le lf lg lh li lj io lk ip ll ir lm is ln iu lo iv lp lq bi translated">带R的示例</h1><p id="f1bc" class="pw-post-body-paragraph jo jp hi jq b jr lr ij jt ju ls im jw jx lt jz ka kb lu kd ke kf lv kh ki kj hb bi translated">终于可以开始编码了。在这个<a class="ae jn" href="https://github.com/AlisonYao/Violence-Against-Women" rel="noopener ugc nofollow" target="_blank">项目</a>中，我们调查了饮酒和暴力侵害妇女行为之间的关系。这里涉及的数据集有:</p><ol class=""><li id="556e" class="kl km hi jq b jr js ju jv jx kn kb ko kf kp kj mi kr ks kt bi translated"><a class="ae jn" href="https://github.com/AlisonYao/Violence-Against-Women/blob/main/Data/prevalence.csv" rel="noopener ugc nofollow" target="_blank">暴力侵害妇女行为的普遍程度</a>来自<a class="ae jn" href="https://data.oecd.org/inequality/violence-against-women.htm#indicator-chart" rel="noopener ugc nofollow" target="_blank"> 2019年经合组织研究</a></li><li id="61c0" class="kl km hi jq b jr ku ju kv jx kw kb kx kf ky kj mi kr ks kt bi translated"><a class="ae jn" href="https://github.com/AlisonYao/Violence-Against-Women/blob/main/Data/alcohol.csv" rel="noopener ugc nofollow" target="_blank">酒精消费数据</a>来自<a class="ae jn" href="https://data.worldbank.org/indicator/SH.ALC.PCAP.LI" rel="noopener ugc nofollow" target="_blank">世界银行</a></li><li id="89c9" class="kl km hi jq b jr ku ju kv jx kw kb kx kf ky kj mi kr ks kt bi translated"><a class="ae jn" href="https://github.com/AlisonYao/Violence-Against-Women/blob/main/Data/poverty_cleaned.csv" rel="noopener ugc nofollow" target="_blank">贫困人口统计数据</a>来自<a class="ae jn" href="https://data.worldbank.org/indicator/SI.POV.NAHC" rel="noopener ugc nofollow" target="_blank">世界银行</a></li></ol><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="ml mm l"/></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lw"><img src="../Images/70b36f0b11c1326026691815e7c50c49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4v3QSZjmtxP5UR6dynAc6Q.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">作者图片</figcaption></figure><p id="e6a0" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">剧情挺奇怪的。我们预计更多的酒精消费会导致暴力侵害妇女行为的增加，甚至会导致暴力侵害妇女行为的增加，但这条线的斜率是负的，表明情况正好相反。</p><p id="03d4" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">更准确地说，我们可以进行一元线性回归。</p><pre class="iy iz ja jb fd lx ly lz ma aw mb bi"><span id="2ca4" class="mc la hi ly b fi md me l mf mg">reg_uni &lt;- brm(formula = Prevalence ~ Alcohol_pc,                              <br/>               data=df,                        <br/>               refresh = 0,                        <br/>               seed = 123) # stabilize outcome for reproducibility <br/>summary(reg_uni)</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mn"><img src="../Images/04b1e8fe5de1c8f2e9403afbabdc4686.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qu7bXeWxkIfi-UvUI__Mxg.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">作者图片</figcaption></figure><p id="1a92" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我们预计酒精会导致更多针对女性的暴力行为，但数据显示情况并非如此。这让我们怀疑是否有一个混杂变量导致了这种虚假的关系。</p><p id="2c8a" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在做了一些文献回顾后，我们选择贫困作为我们的目标，并使用贫困人口比率作为贫困的指标。这一指标显示了每个国家生活在国家贫困线以下的人口百分比。我们认为，针对每个国家的指标比全球指标更好，因为它考虑到了每个国家对贫困的不同定义。现在，我们可以使用多元线性回归来看看贫困人口比率是否是一个混杂因素。</p><pre class="iy iz ja jb fd lx ly lz ma aw mb bi"><span id="6b94" class="mc la hi ly b fi md me l mf mg">reg_multi &lt;- brm(formula = Prevalence ~ Alcohol_pc + <br/>                 poverty_headcount_ratio,                  <br/>                 data=df,                  <br/>                 refresh = 0,                  <br/>                 seed = 123) # stabilize outcome for reproducibility <br/>summary(reg_multi)</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mo"><img src="../Images/119edd9528eb3fe94fa4064abbe85925.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n1Lk09eos1opWc26pf3Vrw.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">作者图片</figcaption></figure><p id="a960" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这一次，我们的最佳估计显示，总酒精消费量每增加1升，患病率就会下降0.96个百分点，不确定性区间为-1.65至-0.22。</p><p id="8a40" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">与早先的估计相比，包括贫困人口比率在内的因素使关联的规模减少了大约三分之一(1.52比0.96)。因此，<strong class="jq hj">最初的关联可以通过将poverty _ head _ ratio作为控制变量来部分解释。</strong></p><p id="96c6" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">为了绘制因果图，我们可以运行下面的代码。</p><pre class="iy iz ja jb fd lx ly lz ma aw mb bi"><span id="cc7c" class="mc la hi ly b fi md me l mf mg">library(dagitty) <br/>library(ggdag) <br/>vaw_dag &lt;- dagify(Prevalence ~ ph + ac,<br/>                  ac ~ ph, <br/>                  labels = c("Prevalence" = "Prevalence", <br/>                             "ph" = "Poverty Headcount", <br/>                             "ac" = "Alcohol Consumption")                       <br/>                  ) <br/># ggdag(vaw_dag, text = FALSE, use_labels = "label") # left graph <br/>ggdag(vaw_dag, text = TRUE) # right graph</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mp"><img src="../Images/37fed13dbee8b522e8dc5772f9081da7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*phbMLY_C68xX26CaNjyr8w.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">作者图片</figcaption></figure><p id="9888" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">每次运行代码时，图形都会略有不同。两个版本我都不完全满意。左边的标签遮住了箭头，右边的文字不完整。您可以运行几次，尝试找到最完美的版本。</p><h1 id="73fa" class="kz la hi bd lb lc ld le lf lg lh li lj io lk ip ll ir lm is ln iu lo iv lp lq bi translated">参考</h1><p id="46ef" class="pw-post-body-paragraph jo jp hi jq b jr lr ij jt ju ls im jw jx lt jz ka kb lu kd ke kf lv kh ki kj hb bi translated">[1]<a class="ae jn" href="https://en.wikipedia.org/wiki/Causal_graph" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/Causal_graph</a></p><p id="12f7" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">[2]<a class="ae jn" href="https://en.wikipedia.org/wiki/Directed_acyclic_graph" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/Directed_acyclic_graph</a></p><blockquote class="mq mr ms"><p id="7ae6" class="jo jp kk jq b jr js ij jt ju jv im jw mt jy jz ka mu kc kd ke mv kg kh ki kj hb bi translated"><em class="hi">该项目的所有代码都可以在这个</em><a class="ae jn" href="https://github.com/AlisonYao/Violence-Against-Women" rel="noopener ugc nofollow" target="_blank"><em class="hi">GitHub Repo</em></a><em class="hi">中找到。</em></p></blockquote></div><div class="ab cl mw mx gp my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="hb hc hd he hf"><p id="0074" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">特别感谢Kubinec教授向我介绍了因果关系，感谢我出色的队友Oscar帮助我实施项目。</p><p id="c250" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">感谢您的阅读！希望这对你有帮助。</p></div></div>    
</body>
</html>