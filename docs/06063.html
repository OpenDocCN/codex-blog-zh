<html>
<head>
<title>Data Engineering Project Retail Store — Part 4 — Analyzing the Data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">数据工程项目零售店—第4部分—分析数据</h1>
<blockquote>原文：<a href="https://medium.com/codex/data-engineering-project-retail-store-part-4-analyzing-the-data-630efad6e09a?source=collection_archive---------2-----------------------#2022-04-08">https://medium.com/codex/data-engineering-project-retail-store-part-4-analyzing-the-data-630efad6e09a?source=collection_archive---------2-----------------------#2022-04-08</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/ef8e38e24a62da0dde8cc4b300099a31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ZlqWvkzy9b4zRISv"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">艾萨克·史密斯在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h1 id="1b0c" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">介绍</h1><p id="c2cd" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">本文是“数据工程—零售店”系列的第四部分，也是最后一部分。在前面的文章中，我提取了威士忌数据，并使用MySQL为一个虚构的组织设计和实现了一个中央RDBMS和一个数据仓库。</p><p id="0eda" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">这一部分将重点分析数据仓库中的数据。更具体地说，数据仓库包含一个用作单点数据的事实表，它存储组织所做的所有事务。</p><p id="cb37" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">事实表是集中分析和创建可视化的好地方。</p><h1 id="d05d" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">项目步骤</h1><ol class=""><li id="b082" class="kw kx hi jv b jw jx ka kb ke ky ki kz km la kq lb lc ld le bi translated">将Python连接到MySQL数据仓库</li><li id="d686" class="kw kx hi jv b jw lf ka lg ke lh ki li km lj kq lb lc ld le bi translated">提取事实表数据</li><li id="145b" class="kw kx hi jv b jw lf ka lg ke lh ki li km lj kq lb lc ld le bi translated">分析数据</li></ol><h2 id="f783" class="lk iw hi bd ix ll lm ln jb lo lp lq jf ke lr ls jj ki lt lu jn km lv lw jr lx bi translated">导入和功能</h2><figure class="ly lz ma mb fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><blockquote class="me"><p id="1a9b" class="mf mg hi bd mh mi mj mk ml mm mn kq dx translated">第一步。将Python连接到MySQL数据仓库</p></blockquote><p id="58a7" class="pw-post-body-paragraph jt ju hi jv b jw mo jy jz ka mp kc kd ke mq kg kh ki mr kk kl km ms ko kp kq hb bi translated">我将使用pymysql库创建一个连接对象。我需要收集关于我使用的MySQL数据库的必要细节。</p><p id="c7cd" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated"><strong class="jv hj">详情如下:</strong></p><p id="6ab2" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated"><strong class="jv hj"> <em class="mt">主机</em></strong>——谁在运行服务器。</p><p id="26b1" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated"><strong class="jv hj"> <em class="mt">端口</em> </strong> —在哪个端口上。</p><p id="0262" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated"><strong class="jv hj"> <em class="mt">用户</em> </strong> —数据库的用户名是什么。</p><p id="6fea" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated"><strong class="jv hj"> <em class="mt">密码</em> </strong> —数据库的密码是什么。</p><p id="14cb" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated"><strong class="jv hj"> <em class="mt"> DB </em> </strong> —数据库模式的名称是什么。</p><p id="06c3" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">收集了这些详细信息后，我可以像这样连接到MySQL:</p><figure class="ly lz ma mb fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><blockquote class="me"><p id="29d3" class="mf mg hi bd mh mi mj mk ml mm mn kq dx translated">第二步。提取事实表数据</p></blockquote><p id="0657" class="pw-post-body-paragraph jt ju hi jv b jw mo jy jz ka mp kc kd ke mq kg kh ki mr kk kl km ms ko kp kq hb bi translated">为了从MySQL中提取数据，我将使用panda的库函数:read_sql_query。</p><p id="0366" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">这个有用函数的输入是:</p><ol class=""><li id="7f8d" class="kw kx hi jv b jw kr ka ks ke mu ki mv km mw kq lb lc ld le bi translated">SQL查询用于从MySQL中提取数据。</li><li id="43c3" class="kw kx hi jv b jw lf ka lg ke lh ki li km lj kq lb lc ld le bi translated">上一步中的连接对象。</li></ol><p id="735d" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">让我们来看一个演示，我将提取事实表数据，并将其连接到其他几个表，以获得组织事务的完整图片。</p><figure class="ly lz ma mb fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><p id="8d02" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">就是这样；现在我有了一个Pandas数据框架，其中包含了该组织所做的所有交易的相关数据。让我们看一个例子:</p><figure class="ly lz ma mb fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><figure class="ly lz ma mb fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><blockquote class="me"><p id="9490" class="mf mg hi bd mh mi mj mk ml mm mn kq dx translated">第三步。分析数据</p></blockquote><h2 id="5bff" class="lk iw hi bd ix ll mx ln jb lo my lq jf ke mz ls jj ki na lu jn km nb lw jr lx bi translated">1.预处理</h2><p id="41cd" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">首先，进行一些预处理以准备好数据。当前的数据类型有:</p><figure class="ly lz ma mb fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><figure class="ly lz ma mb fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><p id="d31c" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">让我们将一些数据类型更改为更合适的类型:</p><figure class="ly lz ma mb fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><p id="65f4" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">现在，让我们检查新的数据类型:</p><figure class="ly lz ma mb fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><figure class="ly lz ma mb fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><h2 id="0f1c" class="lk iw hi bd ix ll lm ln jb lo lp lq jf ke lr ls jj ki lt lu jn km lv lw jr lx bi translated">2.描述性分析和可视化</h2><p id="374c" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">在开始分析之前，我们需要了解可以对数据提出哪些有趣的问题。管理层感兴趣的是什么，我们如何通过回答这些问题来获取利润。</p><p id="4958" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">由于该项目处理关于销售威士忌的零售店的数据，一些有趣的问题可能是:</p><ol class=""><li id="4be1" class="kw kx hi jv b jw kr ka ks ke mu ki mv km mw kq lb lc ld le bi translated">哪些产品产生的利润最大？</li><li id="10ea" class="kw kx hi jv b jw lf ka lg ke lh ki li km lj kq lb lc ld le bi translated">人们通常会购买哪些产品？</li><li id="92f3" class="kw kx hi jv b jw lf ka lg ke lh ki li km lj kq lb lc ld le bi translated">关于顾客什么时候喜欢买威士忌，有什么有趣的模式吗？如果有，它们是什么？</li><li id="8bc7" class="kw kx hi jv b jw lf ka lg ke lh ki li km lj kq lb lc ld le bi translated">就利润而言，我们公司是否在成长？</li><li id="a304" class="kw kx hi jv b jw lf ka lg ke lh ki li km lj kq lb lc ld le bi translated">大部分客户来自哪些县？</li></ol><p id="b114" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">用数据回答这些问题会有一些非常有趣和有益的结果。如果数据支持，管理层可以选择将营销预算集中在某些产品、国家或日期上。他们可以选择放弃一些卖得不好的产品，或者提高卖得好的产品的价格。</p><p id="77cb" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">拥有这种关于组织的知识对于优化企业的绩效和利润至关重要。</p><p id="d138" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">注意，这个数据是我在之前的文章中随机生成的。所以我不指望在数据中发现太多有趣的行为。</p><p id="0aa3" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">Q1——哪种产品利润最高？</p><p id="ed39" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">提取利润最高的5种产品:</p><figure class="ly lz ma mb fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><figure class="ly lz ma mb fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><figure class="ly lz ma mb fd ij"><div class="bz dy l di"><div class="mc md l"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">绘制条形图</figcaption></figure><figure class="ly lz ma mb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nc"><img src="../Images/5f8f9c9f434a83f4e45e643d2a817459.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NUdEHWJ07X7_dk44DowyVw.png"/></div></div></figure><p id="973a" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated"><strong class="jv hj">Q2——人们通常会购买哪些产品？</strong></p><p id="c198" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">提取最常见的销售产品</p><figure class="ly lz ma mb fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><figure class="ly lz ma mb fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><p id="3ba9" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">创建概率质量函数</p><figure class="ly lz ma mb fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><figure class="ly lz ma mb fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><p id="391c" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">正如我们所看到的，这些是最常销售的前1%的产品。我们可以这样解释这张表。例如，产品“七印”是最畅销的商品。每当一个随机的顾客进入商店，他们会有0.6%的机会购买该产品。</p><p id="cf46" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated"><strong class="jv hj">Q3——顾客喜欢购买威士忌有什么有趣的规律吗？如果有，它们是什么？</strong></p><p id="1b29" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">让我们检查每天销售的产品数量是否有差异:</p><figure class="ly lz ma mb fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><figure class="ly lz ma mb fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><p id="c5b9" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">所以日子之间没有什么大的区别，让我们按日子和月份来检查一下:</p><figure class="ly lz ma mb fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><figure class="ly lz ma mb fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><figure class="ly lz ma mb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nd"><img src="../Images/c417665bee3c2c2c606b21131e7a2f5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GPQecHRyz9pJJPS62vZGyA.png"/></div></div></figure><p id="68dd" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">月和日没有明显的模式或差异。看起来客户并不真的介意他们购买威士忌的日期或月份。</p><p id="9aea" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated"><strong class="jv hj">Q4——就利润而言，我们公司是否在增长？</strong></p><p id="b24c" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">让我们计算并画出这些年的累计利润总额。</p><figure class="ly lz ma mb fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><figure class="ly lz ma mb fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><figure class="ly lz ma mb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ne"><img src="../Images/3739bd4ed36f97e54e87625514f6843b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L65iYVVTjW-kIaY48N5Wbw.png"/></div></div></figure><p id="614c" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">利润的增长是线性的。这些年来，销售威士忌的收入流似乎一直在持续。看起来这家公司并没有真正成长。</p><p id="152a" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated"><strong class="jv hj"> Q5 —大部分客户来自哪些县</strong></p><figure class="ly lz ma mb fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><figure class="ly lz ma mb fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><figure class="ly lz ma mb fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><figure class="ly lz ma mb fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><figure class="ly lz ma mb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ne"><img src="../Images/485371b239cebc7379cb63e1f0d18b2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RrQpRMmXRB_Rl2ZmUnglrQ.png"/></div></div></figure><p id="0340" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">看来英属维尔京群岛、巴哈马群岛、塞拉利昂和瑞士是顾客最多的国家。</p><p id="d370" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">“数据工程—零售商店”系列到此结束。希望你读得有趣。</p></div></div>    
</body>
</html>