<html>
<head>
<title>Understanding Swift Compiler</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">了解Swift编译器</h1>
<blockquote>原文：<a href="https://medium.com/codex/understanding-swift-compiler-862f0a291db6?source=collection_archive---------1-----------------------#2022-11-09">https://medium.com/codex/understanding-swift-compiler-862f0a291db6?source=collection_archive---------1-----------------------#2022-11-09</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="5f65" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">揭秘Swift源代码如何转换为可链接到可执行文件的目标代码</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/fd248162755ae29561f21cf5109ccfaf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*aFNeRmWFQchony6Q"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated"><a class="ae jn" href="https://unsplash.com/@zanilic?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Zan </a>在<a class="ae jn" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="c747" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在深入了解Swift编译器之前，我们将尝试理解什么是编译器和解释器编程语言。</p></div><div class="ab cl kk kl gp km" role="separator"><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp"/></div><div class="hb hc hd he hf"><p id="a93d" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">编译器<br/> 编译器和解释器都将高级语言翻译成低级语言。</p><p id="6f2d" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我们通常使用高级语言编写计算机程序。高级语言是我们人类可以理解的语言。这个叫做<strong class="jq hj">源代码</strong>。例如Swift、Java、C、C++等。另一方面，低级语言更多的是机器语言。这些需要汇编程序来翻译指令。然而，计算机不理解高级语言。它只懂二进制的0和1写的程序，叫做<strong class="jq hj">机器码</strong>。</p><ul class=""><li id="1995" class="kr ks hi jq b jr js ju jv jx kt kb ku kf kv kj kw kx ky kz bi translated">编译器扫描整个程序，并把它作为一个整体翻译成机器代码。</li><li id="a51a" class="kr ks hi jq b jr la ju lb jx lc kb ld kf le kj kw kx ky kz bi translated">编译器还会找出程序编译过程中遇到的各种错误。</li><li id="f4b7" class="kr ks hi jq b jr la ju lb jx lc kb ld kf le kj kw kx ky kz bi translated">编译器使用各种阶段将高级语言转换成低级语言。(关于这一点的更多信息在后面的部分)</li></ul><p id="43aa" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">口译员一步一步地翻译。解释器是一个直接执行程序代码的程序，而不仅仅是把它翻译成另一种格式。解释程序解释源程序所需的时间比编译器少。</p><ul class=""><li id="97aa" class="kr ks hi jq b jr js ju jv jx kt kb ku kf kv kj kw kx ky kz bi translated">没有用解释器生成的目标代码，因此内存效率高。</li><li id="7e8b" class="kr ks hi jq b jr la ju lb jx lc kb ld kf le kj kw kx ky kz bi translated">像JavaScript、Python和Ruby这样的编程语言使用解释器。</li></ul></div><div class="ab cl kk kl gp km" role="separator"><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp"/></div><div class="hb hc hd he hf"><h2 id="add3" class="lf lg hi bd lh li lj lk ll lm ln lo lp jx lq lr ls kb lt lu lv kf lw lx ly lz bi translated">Swift编译器</h2><p id="3e2b" class="pw-post-body-paragraph jo jp hi jq b jr ma ij jt ju mb im jw jx mc jz ka kb md kd ke kf me kh ki kj hb bi translated">Swift编译器主要负责将Swift源代码翻译成高效、可执行的机器代码。正如我之前说过的，将源代码翻译成机器码可以分多个阶段实现。我将解释<strong class="jq hj">降低的每个阶段(</strong>获取高级语言(Swift)并将其转换为可以在实际硬件上高效运行的机器代码的过程<strong class="jq hj"> ) </strong>过程。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mf"><img src="../Images/88e5337bb9a015c16731761fff289c43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DNeU4Z9YPhxWDlmeFPXZgw.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">Swift编译器基础版</figcaption></figure><p id="4993" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">翻译阶段</strong></p><ul class=""><li id="ed69" class="kr ks hi jq b jr js ju jv jx kt kb ku kf kv kj kw kx ky kz bi translated"><strong class="jq hj">解析</strong> : <strong class="jq hj"> <br/> </strong>将输入的源代码解析成令牌，放入抽象语法树中。在抽象树中，每个表达式都是一个节点。该节点保存源位置信息。解析器检查语法错误，并为输入源生成相同的警告或错误。在抽象树节点的帮助下，很容易判断问题发生在哪里。</li><li id="9124" class="kr ks hi jq b jr la ju lb jx lc kb ld kf le kj kw kx ky kz bi translated"><strong class="jq hj">语义分析:<br/> </strong>如果在解析阶段没有任何错误，我们将进入下一阶段，即语义分析阶段。在语义分析阶段，我们使用AST将其转换成一个更具类型检查的AST。</li><li id="b098" class="kr ks hi jq b jr la ju lb jx lc kb ld kf le kj kw kx ky kz bi translated"><strong class="jq hj">铿锵导入:</strong> <br/>一旦生成了经过类型检查的AST。它被传递到Clang Importer阶段，在此导入Clang模块，并将C或Objective-C API映射到Swift APIs。</li><li id="937a" class="kr ks hi jq b jr la ju lb jx lc kb ld kf le kj kw kx ky kz bi translated"><strong class="jq hj"> SILGen (Swift中间语言):</strong><br/>Swift代码的优化就发生在这里。在这里，它将经过类型检查的AST降低到所谓的原始SIL中</li><li id="b5a2" class="kr ks hi jq b jr la ju lb jx lc kb ld kf le kj kw kx ky kz bi translated"><strong class="jq hj"> SIL保证转换:<br/> </strong>这里它执行影响程序正确性的额外数据流诊断(比如使用未初始化的变量)。这种转换的最终结果导致了规范的SIL。</li><li id="a88d" class="kr ks hi jq b jr la ju lb jx lc kb ld kf le kj kw kx ky kz bi translated"><strong class="jq hj"> SIL Optimizer : <br/> </strong>在这里，它对程序执行额外的高级SWIFT特定优化，包括(例如)自动引用计数优化、调度规则、Swift类型和通用专门化。</li><li id="857a" class="kr ks hi jq b jr la ju lb jx lc kb ld kf le kj kw kx ky kz bi translated"><strong class="jq hj"> LLVM IR发生器:<br/></strong>SIL降低到LLVL的中间表示在这里发生。这里的说明不再与Swift相关，或者是Swift特定说明。</li><li id="2ce1" class="kr ks hi jq b jr la ju lb jx lc kb ld kf le kj kw kx ky kz bi translated"><strong class="jq hj"> LLVM : <br/> </strong>在这里，IR被优化并降低为特定平台的机器指令。</li></ul><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mg"><img src="../Images/8f1e43282056448c7bab65627b45286f.png" data-original-src="https://miro.medium.com/v2/resize:fit:318/format:webp/1*DGFQJEsJPUnwHv_aN5tlqA.png"/></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">Swift编译器管道</figcaption></figure></div><div class="ab cl kk kl gp km" role="separator"><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp"/></div><div class="hb hc hd he hf"><p id="6df4" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我希望你明白Swift编译器是如何工作的。请<strong class="jq hj">关注</strong>获取更多类似的帖子。祝你有美好的一天，❤️！！！</p></div></div>    
</body>
</html>