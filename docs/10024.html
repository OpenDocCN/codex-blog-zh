<html>
<head>
<title>Judgement Day: Evaluating Classification Models</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">审判日:评估分类模型</h1>
<blockquote>原文：<a href="https://medium.com/codex/judgement-day-evaluating-classification-models-c2667c9a7a47?source=collection_archive---------11-----------------------#2022-11-27">https://medium.com/codex/judgement-day-evaluating-classification-models-c2667c9a7a47?source=collection_archive---------11-----------------------#2022-11-27</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="5a34" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我记得在<a class="ae jd" href="https://banana-data.buzzsprout.com/" rel="noopener ugc nofollow" target="_blank"> Banana Data </a>上有一集，主持人在讨论人工智能写的笑话，并讨论当时Gmail预测文本功能的开端。这让我对模型评估产生了疑问:鉴于机器学习模型的广泛应用，到底什么是好模型，什么是坏模型？</p><p id="cfb7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在深入讨论之前，让我们先弄清楚模型评估中一个非常重要的词，这个词经常被错误地使用:准确性。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es je"><img src="../Images/6337198817260d5252af622515163e98.png" data-original-src="https://miro.medium.com/v2/resize:fit:846/format:webp/1*RSe_dunQtfKTIHHfbwoViA.png"/></div></figure><p id="fb93" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">看起来很简单，对吧？虽然准确性看起来是评估模型的一个很好的标准，但是在很多情况下，这可能更有问题。对于不平衡的数据集来说尤其如此:一个类的数据比其他类多。然后，我们的模型将在不平衡数据集上进行训练，从而产生有利于具有更多代表性的类的高准确度分数。然而，我们的测试集或看不见的数据的准确性分数可能会非常低。那么，该怎么办呢？</p><p id="841d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本文中，我将关注可以结合使用来判断我们的模型的各种模型度量。然而，重要的是要注意，有一些方法可以处理不平衡的数据集，甚至在创建模型之前就使它们平衡。查看<a class="ae jd" href="https://developers.google.com/machine-learning/data-prep/construct/sampling-splitting/imbalanced-data#:~:text=An%20effective%20way%20to%20handle,of%20the%20majority%20class%20examples." rel="noopener ugc nofollow" target="_blank">这篇文章</a>，它对处理不平衡数据有很好的总结。在其他情况下，由于项目成功的标准，准确性可能不是理想的分数；机器学习应用于众多学科，因此需要领域知识来确定最合适的指标。那么，各种度量标准是什么，我们如何计算它们呢？</p><h1 id="bde9" class="jm jn hi bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">混淆矩阵</h1><p id="3007" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">计算各种模型度量的一个很好的方法是首先查看混淆矩阵。混淆矩阵是矩阵的一种。你可以把它想象成一张表，在这张表中，我们列出了一个模型做出的正确和错误预测的数量，与被模拟的真实情况的数值进行了比较。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es kp"><img src="../Images/72ee1d4b02c873cc4b2ec84743ddeeca.png" data-original-src="https://miro.medium.com/v2/resize:fit:802/format:webp/1*n_TWtth2soidR0IBMUQ5Cg.png"/></div><figcaption class="kq kr et er es ks kt bd b be z dx translated">一个混淆矩阵的例子由<a class="ae jd" href="https://subscription.packtpub.com/book/data/9781838555078/6/ch06lvl1sec34/confusion-matrix" rel="noopener ugc nofollow" target="_blank">包装</a></figcaption></figure><p id="8493" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们快速浏览一下TN、FP、FN和TP的含义，然后再回到如何在模型评估中使用它们。</p><p id="59e1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">TN:</strong>True Negative-被正确预测为0类的预测数。<br/> <strong class="ih hj"> FP: </strong>误报——将0类对象分类为1类的错误预测数。<br/> <strong class="ih hj"> FN: </strong>假阴性-将1类对象分类为0类的错误预测数。<br/><strong class="ih hj">TP:</strong>True Positive-被正确预测为类别1的预测数。</p><p id="f678" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这些有什么用？让我们来看看分类模型中最常用的一些指标。</p><h1 id="7adb" class="jm jn hi bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">回忆:真实阳性率</h1><p id="eb7b" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">回忆有时被称为模型的敏感性。这有助于我们计算出该模型在预测正类中的对象方面有多好。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es ku"><img src="../Images/137756cd3033bf5baa3c575ea75c9ad6.png" data-original-src="https://miro.medium.com/v2/resize:fit:806/format:webp/1*hROxHeh0JJJx7pRb_bx2Ag.png"/></div></figure><h1 id="8fda" class="jm jn hi bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">精度:正预测值</h1><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es je"><img src="../Images/f14143ffb8b1099dac34a6eaca25482c.png" data-original-src="https://miro.medium.com/v2/resize:fit:846/format:webp/1*nawssC8oPm6Zl8avFzyqQA.png"/></div></figure><p id="58fc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们以我的<a class="ae jd" href="https://github.com/iban121/Springboard/blob/main/CapstoneProject_2/Notebooks/Preprocessing%20and%20Modelling.ipynb" rel="noopener ugc nofollow" target="_blank">乳腺癌分类</a>项目为例，来理解阳性预测值测量的是什么:它是从所有恶性样本中正确分类为恶性的数量。</p><p id="3d6c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">那么，我们应该使用哪一个呢？当然，在一个理想的世界里，或者在数据世界里，你在数据集中有完全可区分的类，我们可以让它们都有1.0分。这种情况很少发生。我们发现，当我们调整我们的模型并改进其中一个指标时，另一个指标将不可避免地下降。这不一定是一件坏事，但也不意味着我们的模式注定要失败。在很多情况下，优先考虑一个比另一个更有利。例如，在医学测试中，召回经常受到青睐，因为这给出了比精确度更高的假阳性率，因为医学诊断依赖于多个测试而不是一个测试。</p><p id="fa60" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们如何确定其中一个优先于另一个？我们设置一个由情况决定的阈值，以确定一个人应该被偏爱的比率。例如，如果我们有一个不平衡的数据集，我们可以针对不同的阈值绘制我们的精确度分数和召回分数，以确定最佳的阈值。<a class="ae jd" href="https://classeval.wordpress.com/introduction/introduction-to-the-precision-recall-plot/" rel="noopener ugc nofollow" target="_blank">看看这篇文章，它对精确召回曲线提供了很好的见解。</a></p><h1 id="989e" class="jm jn hi bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">F-1分数</h1><p id="1c21" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">这是一个范围从0到1的值，其中1表示完美的精确度和召回率，0表示两者的分数都很低。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="er es kv"><img src="../Images/652008c70033ed0a4395ce4a1b7c088b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xVoK3WRIbim8L1xdlYbCUA.png"/></div></div></figure><p id="ab39" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由于F-1分数取决于召回率<em class="la">和精确度</em>分数，它可以是一个更好的衡量标准来判断我们的模型。F-1得分越高，越接近1，<a class="ae jd" href="https://towardsdatascience.com/a-look-at-precision-recall-and-f1-score-36b5fd0dd3ec#:~:text=Some%20advantages%20of%20F1%2Dscore,metric%20across%20positive%2Fnegative%20samples." rel="noopener" target="_blank">其他两个指标的值</a>就越高。</p><h1 id="86f0" class="jm jn hi bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">脱落:假阳性率</h1><p id="40a4" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">正如我前面提到的，在评估一个模型时，有假阳性率比其他指标更受青睐的例子。这可以计算为:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es lb"><img src="../Images/e5369efe3c44f7fbeba92074bb249e68.png" data-original-src="https://miro.medium.com/v2/resize:fit:872/format:webp/1*Cqt6GUxOXdNgVy18TIZvqg.png"/></div></figure><h1 id="b30d" class="jm jn hi bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">特异性:真阴性率</h1><p id="9763" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">我喜欢把这个看作是负面类的回忆分数。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="er es lc"><img src="../Images/cf81835040bc214ff28fe6496570ab36.png" data-original-src="https://miro.medium.com/v2/resize:fit:866/format:webp/1*MMoi99csEnSpVuAorLLLUA.png"/></div></div></figure><p id="4cc3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有时使用<a class="ae jd" href="https://vitalflux.com/ml-metrics-sensitivity-vs-specificity-difference/" rel="noopener ugc nofollow" target="_blank">特异性比灵敏度</a>更有优势，但同样，这取决于情况的性质。</p><h1 id="af01" class="jm jn hi bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">中华民国和中华民国下的区域</h1><p id="d5d0" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">接受者-操作者特征曲线(ROC)是所有阈值的真阳性率对假阳性率(召回率对脱落率)的图。下面是我为我的二元分类项目创建的两个不同的K近邻模型的两个roc。</p><div class="jf jg jh ji fd ab cb"><figure class="ld jj le lf lg lh li paragraph-image"><img src="../Images/4a7afd531180ced654ae25719db54c39.png" data-original-src="https://miro.medium.com/v2/resize:fit:824/format:webp/1*T-8__ySWk12aAEQV_0S6OQ.png"/></figure><figure class="ld jj lj lf lg lh li paragraph-image"><img src="../Images/8650821643078349937cee78953a9a6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:858/format:webp/1*dWOmRRyan_NUraz7ukc9Ug.png"/></figure></div><p id="be66" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">左边的图表明模型有50%的机会正确预测类别，因此如果我们远离直线，那么模型在预测方面更好。右图显示了一个好得多的模型；在这种情况下，该模型在99.99%的情况下都能正确预测。这个“机会”由曲线下的面积表示，因此面积越高，模型越好。</p><h1 id="908b" class="jm jn hi bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">马修斯相关系数</h1><p id="21ad" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">MCC是解决不平衡数据集分类问题的另一个好方法。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="er es lk"><img src="../Images/0ed5ab3a9cd4d44acd958b2159b145f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mTnMwYBETb5FQlI2i4sU5Q.png"/></div></div></figure><p id="c665" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">看起来很复杂，对吧？我不会担心记住公式，而是理解公式的含义。最终，Scikit Learn或Stats model只需一行代码就能为我们提供MCC。那么什么是MCC呢？您可以将MCC视为类似卡方统计的东西，它适用于二元和多类分类问题。从上面的等式中我们可以看出，只有对 <strong class="ih hj"> <em class="la"> </em> </strong>正类和负类的<em class="la">都做出大量的正确预测，MCC才会有高分。<a class="ae jd" href="https://bmcgenomics.biomedcentral.com/articles/10.1186/s12864-019-6413-7#:~:text=As%20we%20explained%20earlier%2C%20the,any%20class%20balance%20or%20imbalance." rel="noopener ugc nofollow" target="_blank">与准确度分数和F1分数</a>相比，它可以更好地判断不平衡数据集的模型。</em></p><h1 id="3348" class="jm jn hi bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">使用Scikit Learn评估模型</h1><p id="a40d" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">如果您对模型评估的pythonic方法感兴趣，我推荐使用Scikit Learn。它不费吹灰之力就说出了几乎所有这些指标。下面是Python中必要的导入和典型输出的一个简单例子。下面的代码和数字来自我的项目，如果你感兴趣的话，请随意深入研究。</p><p id="7ec8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">典型的格式是:</p><pre class="jf jg jh ji fd ll lm ln bn lo lp bi"><span id="384d" class="lq jn hi lm b be lr ls l lt lu">from sklearn.metrics import &lt;metrics you want&gt;<br/><br/>metrics(actual_values , model_predictions)</span></pre><p id="f6ee" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，对于我的一个K近邻模型，这里有一个Scikit Learn给我们的例子。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="er es lv"><img src="../Images/2ba6d67e89d0284603565da7fb198170.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QdF0kl7GzV3gAtk0mUyehQ.png"/></div></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="er es lv"><img src="../Images/4e16f42b1d11c0810455991460591f50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fRAdkBSTOMcWP1br-9YEfg.png"/></div></div></figure><p id="7b60" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">输出:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es lw"><img src="../Images/9c54e875dc92a46b3022e088d450f09f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1332/format:webp/1*SFJZQWDr1koYSif9R2FB3Q.png"/></div></figure><p id="3f33" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如您所见，大部分指标也是在分类报告中为我们计算的，这是一个很好的单行程序，为我们节省了一点麻烦。</p><p id="f6b4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我总是喜欢将ROC曲线可视化，所以我为这个模型做了以下工作:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="er es lv"><img src="../Images/6dcb3bfb8f6732d05937d2dcb14a8f32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BK4HFNayadQWBu9TbQm5yA.png"/></div></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es lx"><img src="../Images/c9e9a27305d4a372932d6f92bc73f937.png" data-original-src="https://miro.medium.com/v2/resize:fit:1378/format:webp/1*DQWI4HsisfpbikwxWU2Ezg.png"/></div></figure><p id="fe48" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">总的来说，这是数据科学学科中又一个无价的工具。</p></div></div>    
</body>
</html>