<html>
<head>
<title>The Basics of Kubernetes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Kubernetes的基本知识</h1>
<blockquote>原文：<a href="https://medium.com/codex/the-basics-of-kubernetes-fae94ae09325?source=collection_archive---------6-----------------------#2021-10-13">https://medium.com/codex/the-basics-of-kubernetes-fae94ae09325?source=collection_archive---------6-----------------------#2021-10-13</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="00e1" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">Kubernetes组件及其工作方式概述</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/bc64eea341eb46704b2382e6bc2f7022.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*rtM7Vh0z-xh4ujLF"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">照片由<a class="ae jn" href="https://unsplash.com/@sigmund?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">西格蒙德</a>在<a class="ae jn" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><h2 id="b0d8" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">这篇文章有什么值得期待的？</h2><p id="786b" class="pw-post-body-paragraph km kn hi ko b kp kq ij kr ks kt im ku jz kv kw kx kd ky kz la kh lb lc ld le hb bi translated">在这篇文章中，我将解释Kubernetes的基本组件以及它们是如何相互作用的。我将对它们中的每一个做一个简短的描述，它们是如何使用的，它们解决了什么问题。</p><h2 id="634b" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">这篇文章有什么不可期待的？</h2><p id="e064" class="pw-post-body-paragraph km kn hi ko b kp kq ij kr ks kt im ku jz kv kw kx kd ky kz la kh lb lc ld le hb bi translated">这篇文章不会向你展示任何代码或YAML配置。在我看来，如果你想管理一个Kubernetes集群，你必须先理解概念，然后再编写代码。如果你理解了所有组件背后的逻辑，你就可以很容易地找到你想在网上做的事情的代码。</p><h2 id="90fb" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">我们开始吧！</h2><p id="9c3d" class="pw-post-body-paragraph km kn hi ko b kp kq ij kr ks kt im ku jz kv kw kx kd ky kz la kh lb lc ld le hb bi translated">Kubernetes是一个非常棒的工具，对于任何想要在服务器上托管代码的人来说都是如此，尤其是在云中。但是牛逼不代表轻松。这是一个理解Kubernetes为什么存在以及如何使用它的指南。我们将讨论Kubernetes集群的基本组件以及如何管理它们。</p><h2 id="0c76" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">Kubernetes解决什么问题？</h2><p id="783a" class="pw-post-body-paragraph km kn hi ko b kp kq ij kr ks kt im ku jz kv kw kx kd ky kz la kh lb lc ld le hb bi translated">随着向Docker等容器技术的转变，在互联网上托管代码比以往任何时候都容易。你不需要管理虚拟机，相反，你只需要将你的代码包装在一个容器中，并描述你的应用程序的依赖关系。这非常有用，但是容器技术并没有解决这样一个事实，即您仍然需要管理运行Docker容器的服务器。您需要手动启动服务器上的容器，当该服务器出现问题时，您需要找到一种方法将之前在其上运行的服务转移到一个新的位置。这项乏味的工作导致了Kubernetes的发展。Kubernetes就是我们所说的容器编排器。这意味着您将容器交给Kubernetes，它将处理容器的生命周期。它会自动在服务器上找到一个位置来运行该容器，如果服务器宕机，它会跟踪服务器上正在运行的服务，并将其迁移到其他地方，而无需任何人工交互。</p><p id="efec" class="pw-post-body-paragraph km kn hi ko b kp lf ij kr ks lg im ku jz lh kw kx kd li kz la kh lj lc ld le hb bi translated">在服务器管理方面，Kubernetes是一个游戏改变者，被许多大公司用于生产。也就是说，对于在一台服务器上运行多个服务的人来说，这是非常有用的。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lk"><img src="../Images/ae994da534f8ba84d039520499a42250.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*lxQIp6YcM-M61zrl"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">照片由<a class="ae jn" href="https://unsplash.com/@d_mccullough?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">丹尼尔·麦卡洛</a>在<a class="ae jn" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><h2 id="aacb" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">Kubernetes的基本服务器架构是什么</h2><p id="199e" class="pw-post-body-paragraph km kn hi ko b kp kq ij kr ks kt im ku jz kv kw kx kd ky kz la kh lb lc ld le hb bi translated">Kubernetes集群的基本架构实际上非常简单。运行Kubernetes时有两种类型的服务器。您有自己的控制平面服务器和工作节点。控制平面服务器负责做出集群中的所有决策。它将部署您的docker映像，并确保它们都运行良好。另一方面，工作节点负责实际运行容器。它们相当于传统世界中你所认为的服务器。他们负责运行您编写的代码的所有繁重工作。</p><p id="be94" class="pw-post-body-paragraph km kn hi ko b kp lf ij kr ks lg im ku jz lh kw kx kd li kz la kh lj lc ld le hb bi translated">就是这样！Kubernetes的服务器架构只由这两个部分组成。从小型Kubernetes集群到大型Kubernetes集群的唯一变化是Kubernetes管理的服务器数量。为了实现高可用性，建议您在控制面板中安装几台服务器和多个工作节点。假设您注意到您的容器需要更多的处理能力，您可以将新的工作节点连接到您的集群，控制平面将自动重新平衡您的容器以使用新的处理能力。就这么简单。</p><p id="c0cd" class="pw-post-body-paragraph km kn hi ko b kp lf ij kr ks lg im ku jz lh kw kx kd li kz la kh lj lc ld le hb bi translated">现在我们已经知道了Kubernetes的基本服务器架构，让我们来讨论用于实际管理那些我们想要部署在集群中的容器和服务的逻辑组件。</p><h2 id="e0dc" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">分离舱</h2><p id="b420" class="pw-post-body-paragraph km kn hi ko b kp kq ij kr ks kt im ku jz kv kw kx kd ky kz la kh lb lc ld le hb bi translated">我们将讨论的第一个组件是最简单的一个，pod。事实是，Kubernetes的控制平面并不真正部署容器，它部署包含容器的吊舱。您可以将pod视为容器的环境。大多数情况下，一个pod内部只有一个容器，但它可以有多个容器。假设您有一个度量服务器，它为您的应用程序获取不同的度量。您将在同一个pod中部署应用程序和度量服务。这意味着您知道这两个服务将同时部署在同一台机器上。这还意味着它们共享相同的存储和网络资源，这可能是某些应用程序工作所必需的。</p><p id="3aa1" class="pw-post-body-paragraph km kn hi ko b kp lf ij kr ks lg im ku jz lh kw kx kd li kz la kh lj lc ld le hb bi translated"><strong class="ko hj">警告</strong>:如果您有两个应用程序，它们不一定需要部署在同一个工作节点上才能工作，但是出于性能原因，您希望它们能够工作(例如一个web服务器和一个数据库)。调查<a class="ae jn" href="https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#inter-pod-affinity-and-anti-affinity" rel="noopener ugc nofollow" target="_blank">荚亲和</a>。这是一个高级主题，所以我不会在本文中涉及它。</p><p id="efed" class="pw-post-body-paragraph km kn hi ko b kp lf ij kr ks lg im ku jz lh kw kx kd li kz la kh lj lc ld le hb bi translated">为了简单起见，您通常可以将pod视为一个容器。这并不是100%正确，但在大多数情况下，它们的行为非常相似。</p><h2 id="deb1" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">部署</h2><p id="3721" class="pw-post-body-paragraph km kn hi ko b kp kq ij kr ks kt im ku jz kv kw kx kd ky kz la kh lb lc ld le hb bi translated">现在您知道了pod是什么，您需要一种方法来告诉Kubernetes如何部署它。在Kubernetes的世界中，这被称为部署。该组件负责描述您希望如何部署pod。假设您有一个web服务器，并且您希望拥有该web服务器的3个副本来实现负载平衡，您将在部署中定义该要求。这种部署将创建我们所说的副本集。该副本集负责保持web服务器的三个副本始终运行在您的工作节点上。副本集在控制平面内运行，而pod在工作节点内运行。简而言之，pod描述了容器将在其中运行的环境，而deployment描述了如何在您的worker节点上部署该环境。</p><h2 id="e879" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">服务</h2><p id="d8bd" class="pw-post-body-paragraph km kn hi ko b kp kq ij kr ks kt im ku jz kv kw kx kd ky kz la kh lb lc ld le hb bi translated">酷！现在您有了一个运行在服务器上的服务。代码正在执行，但是怎么从网上调用呢？服务的IP是什么？它在哪个端口上运行？所有这些问题都有一个服务来回答！该服务的工作是向外界公开您的应用程序。它可以通过简单的IP或更复杂的负载平衡器。有许多类型的服务将涵盖大多数(如果不是全部)向外界公开应用程序的不同方式。这也是您定义应用程序将暴露的端口的地方。简单地说，服务只是描述了您希望应用程序如何对外部世界可用。</p><h2 id="08d8" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">机密/配置映射</h2><p id="3844" class="pw-post-body-paragraph km kn hi ko b kp kq ij kr ks kt im ku jz kv kw kx kd ky kz la kh lb lc ld le hb bi translated">最后，秘密和配置图。Kubernetes集群的所有pod、部署、服务或任何其他组件都在YAML定义。虽然YAML很酷，但它是一种相当静态的语言。您不能定义可以在文件之间共享的变量或从磁盘获取值。在管理大型Kubernetes集群时，这可能会非常烦人，因为一些配置可能会在不同的服务之间共享(比如数据库登录信息、第三方服务的URL等)。).而且，正如我们从DRY原理中所知道的，手工重复这些配置会使它更难维护，更容易出错。Kubernetes对这个问题的解决方案是秘密和配置图。</p><p id="5e82" class="pw-post-body-paragraph km kn hi ko b kp lf ij kr ks lg im ku jz lh kw kx kd li kz la kh lj lc ld le hb bi translated">机密和配置映射是可以用来存储配置(URL、日志级别等)的组件。)或秘密(密码、API密钥等。)供你申请。理论上，它们都完成了同样的事情。它们存储配置的方式可以在Kubernetes的其他组件中访问。它们之间的区别在于，机密是为更敏感的数据(如DB password)创建的，而配置映射是为不太敏感的信息(如特性标志或数据库URL)创建的。还有一点要记住的是，如果你想把你的值保密，你必须对它们进行base64编码。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ll"><img src="../Images/d60ace60076f667f9849a410c7d14eb2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*w0GNHDhf9lbp8IDk"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">泰勒·维克在<a class="ae jn" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><h2 id="5a52" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">结论</h2><p id="abe9" class="pw-post-body-paragraph km kn hi ko b kp kq ij kr ks kt im ku jz kv kw kx kd ky kz la kh lb lc ld le hb bi translated">Kubernetes是现代技术堆栈中非常有用的技术。它允许您自动化容器部署，并确保您的应用程序在您的服务器上运行。设置确实需要一点时间，但每一秒都是值得的。如果您对DevOps或云感兴趣，这是添加到您的工具包中的必备工具。虽然在本文中我没有向您展示任何代码，但我认为不同类型组件的基本知识将有助于您迈向Kubernetes master。如果你想了解更多关于Kubernetes <a class="ae jn" href="https://kubernetes.io/docs/home/" rel="noopener ugc nofollow" target="_blank">的信息，这里有他们官方文件的链接</a>。感谢您的阅读！</p></div></div>    
</body>
</html>