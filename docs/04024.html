<html>
<head>
<title>Bring old images back to life using Real ESRGAN</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Real ESRGAN让旧图像重现生机</h1>
<blockquote>原文：<a href="https://medium.com/codex/bring-noisy-old-images-back-to-life-using-real-esrgan-fd3c57ca94f3?source=collection_archive---------4-----------------------#2021-10-18">https://medium.com/codex/bring-noisy-old-images-back-to-life-using-real-esrgan-fd3c57ca94f3?source=collection_archive---------4-----------------------#2021-10-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/794a6bc066c77ceb295458086df25edc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uk_zSjdLzTlR8XTeYbRIag.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">使用Real-ESRGAN合成的图像示例</figcaption></figure><p id="d13d" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">真实世界的图像在其一生中通常会经历各种退化。例如，使用旧设备拍摄的图像包含各种噪声和伪像。当图像经历多次编辑和压缩，同时使用互联网多次共享和传输时，也会添加伪像。</p><p id="871a" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">然而，从这种退化中恢复并使这些图像恢复生机是非常具有挑战性的，主要是因为退化过程是未知的，并且对于每个图像都是不同的。我们如何学习一个未定义退化映射的逆？让我们简要回顾一下以前解决这个问题的方法:</p><ul class=""><li id="408d" class="js jt hi iw b ix iy jb jc jf ju jj jv jn jw jr jx jy jz ka bi translated">显式退化预测:结合经典操作(例如模糊、缩减采样、噪声、JPEG压缩)来模拟退化过程，并通过应用显式退化来创建数据集。</li></ul><p id="3c31" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">问题:现实世界的退化可能太复杂，无法用如此简单的退化程度来建模。</p><ul class=""><li id="4123" class="js jt hi iw b ix iy jb jc jf ju jj jv jn jw jr jx jy jz ka bi translated">利用真实世界的退化处理数据集，例如使用旧相机和现代相机拍摄的成对图像，或者不成对的退化高质量图像。</li><li id="7a39" class="js jt hi iw b ix kc jb kd jf ke jj kf jn kg jr jx jy jz ka bi translated">退化预测:使用GANs单独或与恢复网络联合估计上述数据集的退化图。</li></ul><p id="342a" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><em class="kb">问题</em>:限于网络训练数据集的退化，无法推广到非分布图像。</p></div><div class="ab cl kh ki gp kj" role="separator"><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km"/></div><div class="hb hc hd he hf"><p id="6fcb" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">正如我们所看到的，建模退化映射对于盲SR至关重要:从有噪声的低分辨率真实世界图像合成高分辨率图像的问题。尽管这个问题很重要，但以前作品的结果无法与真正的高质量图像相比。Real-ESRGAN的作者解决了这个问题，并展示了惊人的结果。他们建议解决退化建模问题，并改善综合网络的多个方面。</p><p id="5747" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">特别是，该文件建议:</p><ul class=""><li id="9cc3" class="js jt hi iw b ix iy jb jc jf ju jj jv jn jw jr jx jy jz ka bi translated">更好地模拟真实世界的退化。</li><li id="e9a3" class="js jt hi iw b ix kc jb kd jf ke jj kf jn kg jr jx jy jz ka bi translated"><em class="kb"> sinc </em>滤波器解决退化造成的振铃和过冲现象。</li><li id="f359" class="js jt hi iw b ix kc jb kd jf ke jj kf jn kg jr jx jy jz ka bi translated">使用U-Net架构和频谱标准化正则化(SN)的更强大的鉴别器。</li></ul><p id="f056" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><a class="ae ko" href="https://arxiv.org/pdf/2107.10833.pdf" rel="noopener ugc nofollow" target="_blank"> <em class="kb">原文:Real-ESRGAN:用纯合成数据训练真实世界盲超分辨率</em> </a></p><h2 id="8825" class="kp kq hi bd kr ks kt ku kv kw kx ky kz jf la lb lc jj ld le lf jn lg lh li lj bi translated">降级操作</h2><p id="73ad" class="pw-post-body-paragraph iu iv hi iw b ix lk iz ja jb ll jd je jf lm jh ji jj ln jl jm jn lo jp jq jr hb bi translated">我们将首先查看如何典型地模拟每种退化效应的细节。请随意跳过这一部分。</p><p id="82d9" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">模糊</strong></p><p id="cadd" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">模糊被模拟为与模糊滤镜的卷积，在大多数情况下是高斯核(也称为高斯模糊核)。它被计算为2D空间中的高斯分布。为了使效果更加真实，本文采用了<em class="kb">广义</em>高斯模糊核。根据提出广义高斯(GG)函数的论文摘要，该函数对于模拟离焦模糊退化在理论上和实践上都是精确的，并且可以简化为单参数模型。</p><p id="816e" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">M <em class="kb">关于广义高斯模糊核的核心:</em> <a class="ae ko" href="https://ieeexplore.ieee.org/document/9079550" rel="noopener ugc nofollow" target="_blank"> <em class="kb">估计用于散焦图像去模糊的广义高斯模糊核</em> </a> <em class="kb">。</em></p><p id="ae12" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">噪音</strong></p><p id="e611" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">通过添加高斯噪声或泊松噪声来应用噪声。在加性高斯噪声中，噪声从高斯分布中采样，噪声的强度由标准偏差控制。泊松噪声从泊松分布中采样，并且它近似模拟由统计量子涨落引起的传感器噪声。泊松噪声的强度与图像成比例。</p><p id="efe7" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">当噪声的每个通道都独立时，噪声可以表示为“彩色噪声”;当三个通道具有相同的噪声时，噪声可以表示为“灰度噪声”。</p><p id="ce7d" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><em class="kb">一个</em> <a class="ae ko" href="https://www.youtube.com/watch?v=jmqZG6roVqU" rel="noopener ugc nofollow" target="_blank"> <em class="kb">关于泊松分布性质的大解说</em> </a> <em class="kb">。</em></p><p id="236c" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">下采样</strong></p><p id="789e" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">有几种具有独特特征的调整大小方法。考虑了区域大小调整、双线性插值和双三次插值。</p><p id="36a0" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> JPEG压缩</strong></p><p id="03c1" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">JPEG压缩是一种有损压缩方法，通常在保存和传输数字图像时使用。我们可以使用范围从0到100的质量因子在压缩图像的质量和更高的压缩率之间进行权衡。</p><h2 id="5d8a" class="kp kq hi bd kr ks kt ku kv kw kx ky kz jf la lb lc jj ld le lf jn lg lh li lj bi translated">sinc滤波器</h2><figure class="lq lr ls lt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lp"><img src="../Images/a579031e99ed19ec36caa6adfe5f2a8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pYOD-TjDsGMG2lHJwuLrkQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">用sinc滤波器模拟环路和过冲伪像</figcaption></figure><p id="9661" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">环状伪像是出现在图像中急剧转变附近的伪像。它们通常伴随着过冲伪像，被描述为边沿跃迁处的跳跃增加(例如右下图中的黑色环)。它们是图像中非常常见的伪像，需要模拟这种伪像。</p><p id="45da" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><em class="kb"> sinc </em>滤波器是一个模拟这些伪像的内核，用下面的公式表示。<em class="kb"> (i，j) </em>为核坐标，J₁为第一类一阶贝塞尔函数，ω_c为截止频率。绘制时，这些内核看起来像上图中每个示例左侧的图。</p><figure class="lq lr ls lt fd ij er es paragraph-image"><div class="er es lu"><img src="../Images/6e16d498f2e7fc732c7274908928e889.png" data-original-src="https://miro.medium.com/v2/resize:fit:1036/format:webp/1*YLz4b_X-v_xd5fMV1Nj3_g.png"/></div></figure><h2 id="63b9" class="kp kq hi bd kr ks kt ku kv kw kx ky kz jf la lb lc jj ld le lf jn lg lh li lj bi translated">高阶退化</h2><p id="4b8b" class="pw-post-body-paragraph iu iv hi iw b ix lk iz ja jb ll jd je jf lm jh ji jj ln jl jm jn lo jp jq jr hb bi translated">典型的退化模型将涉及多个退化操作，用于合成类似于真实世界样本的低分辨率图像。例如，给定地面实况图像y，退化过程D可以是模糊核k、具有比例因子r的下采样、添加噪声n和JPEG压缩的组合。我们可以用下面的等式来表达这个过程。</p><figure class="lq lr ls lt fd ij er es paragraph-image"><div class="er es lv"><img src="../Images/0c3ac687ef0977c3c9a2299f80970d91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1040/format:webp/1*tghKuyJjKJCLWJtEeLGTPQ.png"/></div></figure><p id="81a5" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这些经典的退化模型可以在某种程度上生成合成的训练对。然而，具有基本退化的模型——本文称之为“一阶建模”——不能模拟复杂的真实世界退化，这种退化是多样的，并且通常包括一系列多个程序。下图描述了这两种情况的示例。</p><figure class="lq lr ls lt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lw"><img src="../Images/0a0f757f51398d19769c3d496a9017ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H-sXVaQPjyr0te7DTIvEkA.png"/></div></div></figure><blockquote class="lx ly lz"><p id="56e0" class="iu iv kb iw b ix iy iz ja jb jc jd je ma jg jh ji mb jk jl jm mc jo jp jq jr hb bi translated">具体来说，原始图像可能是多年前用手机拍摄的，其中不可避免地包含相机模糊、传感器噪声、低分辨率和JPEG压缩等退化。然后对图像进行了锐化和尺寸调整操作，带来了过冲和模糊的伪影。之后，它被上传到一些社交媒体应用程序，这引入了进一步的压缩和不可预测的噪声。(来自Real-ESRGAN的示例)</p></blockquote><p id="62a5" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">一个简单的解决方案是多次重复随机退化。n阶模型是指将经典退化模型重复n次的过程。</p><figure class="lq lr ls lt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es md"><img src="../Images/6b2209d802e9a42c4bfdf06752a26d3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Evfha3EKdZKK5SzlRHr2Gw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">real-ESRGAN的数据生成流水线</figcaption></figure><p id="c254" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">上图展示了退化模拟过程的整个流程。详细来说，</p><ul class=""><li id="aa7c" class="js jt hi iw b ix iy jb jc jf ju jj jv jn jw jr jx jy jz ka bi translated">每个操作都是从一组可用选项中随机选择的。</li><li id="f77b" class="js jt hi iw b ix kc jb kd jf ke jj kf jn kg jr jx jy jz ka bi translated">该论文提出一个<em class="kb">二阶</em>退化过程足以模拟真实世界的退化。</li><li id="8049" class="js jt hi iw b ix kc jb kd jf ke jj kf jn kg jr jx jy jz ka bi translated">缩减像素采样被替换为随机调整大小，以控制图像分辨率。</li><li id="84f5" class="js jt hi iw b ix kc jb kd jf ke jj kf jn kg jr jx jy jz ka bi translated"><em class="kb"> sinc </em>滤波器应用于初始模糊处理和最终阶段。JPEG压缩和最终<em class="kb"> sinc </em>滤波器的顺序是随机的。</li><li id="575a" class="js jt hi iw b ix kc jb kd jf ke jj kf jn kg jr jx jy jz ka bi translated">文中提供了降解操作的细节和超参数。</li></ul><figure class="lq lr ls lt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es me"><img src="../Images/2e819f983b87b7c27f72c05e2aaa72f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I1om2WhQQ6hfqF5JkUgBSQ.png"/></div></div></figure><p id="5189" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">上图展示了sinc滤波器和二阶退化建模的有效性。我们观察到，当应用<em class="kb"> sinc </em>滤波器时，环形伪像如预期的那样被消除。</p><h2 id="96a2" class="kp kq hi bd kr ks kt ku kv kw kx ky kz jf la lb lc jj ld le lf jn lg lh li lj bi translated">网络</h2><figure class="lq lr ls lt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mf"><img src="../Images/4c3994c506845f3b7fd71a71d8aacd6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JmKUBSpk1-cY3Wfc0RvN9Q.png"/></div></div></figure><p id="02d4" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">作者还建议对合成网络进行多方面的改进。具有残余中残余致密嵌段(RRDB)的发生器骨架与原始ESRGAN相同。然而，通过应用像素去混洗(像素混洗的逆)来减小空间大小并增加通道数量以提高效率，输入层被调整为多个分辨率的输入图像。</p><figure class="lq lr ls lt fd ij er es paragraph-image"><div class="er es mg"><img src="../Images/308d20fa6aa2426ff77c7ef2dcec4a29.png" data-original-src="https://miro.medium.com/v2/resize:fit:940/format:webp/1*yR86ulSzVJph3YwWIMw9mw.png"/></div></figure><p id="4ce1" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">作者认为，Real-ESRGAN的鉴别器需要对复杂的训练输出有更大的鉴别能力，因为Real-ESRGAN旨在解决比ESRGAN大得多的退化空间。</p><p id="1e8d" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我同意GANs通常受益于强大的歧视者，并且论文的建议是有效的。然而，我不明白为什么作者认为Real-ESRGAN的判别空间比ESRGAN大。我相信生成器的问题复杂度会增加，因为它必须学习退化过程的逆过程以及原始的上采样问题，但是鉴别器的任务似乎是相同的:对合成图像和高分辨率图像进行分类。我想知道你的想法，🧐.</p><p id="b36b" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">作者将原来的VGG式鉴别器改进为U网结构。为了稳定训练，作者还应用了谱归一化正则化。这种修改是对合成图像的惊人改进。</p><figure class="lq lr ls lt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mh"><img src="../Images/1fc859d9de81e2b0059369fb57f2c2ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s6OWFMN-aQjoyC4h3tgNxA.png"/></div></div></figure><p id="1ac3" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><em class="kb">关于谱归一化的更多内容:</em> <a class="ae ko" href="https://arxiv.org/abs/1802.05957" rel="noopener ugc nofollow" target="_blank"> <em class="kb">用于生成性对抗网络的谱归一化</em> </a></p><p id="5b51" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">作者还评估了后处理算法的效果，尤其是反锐化掩模作为Real-ESRGAN+。作者在使用该算法时发现了过冲伪像，并提出了一种在训练期间锐化地面真实图像并平衡锐度和过冲伪像的技巧。</p><p id="2ad0" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">就每次损失的权重而言，训练超参数有微小的变化。</p><h2 id="9857" class="kp kq hi bd kr ks kt ku kv kw kx ky kz jf la lb lc jj ld le lf jn lg lh li lj bi translated">讨论</h2><p id="5480" class="pw-post-body-paragraph iu iv hi iw b ix lk iz ja jb ll jd je jf lm jh ji jj ln jl jm jn lo jp jq jr hb bi translated">我们清楚地观察到Real-ESRGAN的视觉质量优于以前的方法。Real-ESRGAN有效地消除了图像中的伪像，并生成照片级的高分辨率纹理。</p><figure class="lq lr ls lt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mi"><img src="../Images/0b87701b0c259d13acbd46f5e5704588.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uVjrZKKHQ11xJ7fcm9LFyg.png"/></div></div></figure><figure class="lq lr ls lt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mi"><img src="../Images/ccd66288532de64385fb61356560c7ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qRlLEVocS5hNRje9nW9eVQ.png"/></div></div></figure><p id="87e6" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">然而，作者也发现了Real-ESRGAN的局限性。虽然提出的高阶退化模型能够模拟更复杂的退化，但它并不完美。作者发现它的模型在合成扭曲线和非分布退化以及GAN伪影时有一些限制。</p><figure class="lq lr ls lt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mj"><img src="../Images/2e7539cb591d2404092945962541533d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4lUdb2I1TP-PmTegBWk59A.png"/></div></div></figure><h2 id="6de0" class="kp kq hi bd kr ks kt ku kv kw kx ky kz jf la lb lc jj ld le lf jn lg lh li lj bi translated">结论</h2><p id="2d57" class="pw-post-body-paragraph iu iv hi iw b ix lk iz ja jb ll jd je jf lm jh ji jj ln jl jm jn lo jp jq jr hb bi translated">我们研究了对真实世界图像合成的退化过程建模的挑战。作者提出了<em class="kb"> sinc </em>滤波器来消除振铃和过冲伪像，以及高阶退化模型来更好地表达复杂的真实世界退化。作者还对网络体系结构提出了改进建议。</p><p id="fec3" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">然而，我相信除了作者建议的样本之外，还必须进行更多的调查，以确定该管道是否能够真正推广到其他真实世界的退化。然而，在如何表现未知的退化过程方面的贡献是非常有趣的。本文讨论的策略可以应用于其他图像合成问题，甚至有监督的视觉问题。涉及所述管道的数据扩充可以提高网络的鲁棒性。</p></div></div>    
</body>
</html>