<html>
<head>
<title>Rust — Package Management</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Rust —包装管理</h1>
<blockquote>原文：<a href="https://medium.com/codex/rust-package-management-ad4fd85026fc?source=collection_archive---------11-----------------------#2021-09-09">https://medium.com/codex/rust-package-management-ad4fd85026fc?source=collection_archive---------11-----------------------#2021-09-09</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/c2e0578411002619e8f71762d72091d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*i-W7x_kYbMFpa0Er"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">照片由<a class="ae hv" href="https://unsplash.com/@brunnotozzo?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">布鲁诺·托佐</a>在<a class="ae hv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><div class=""/><p id="01c7" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这是我的<em class="jt">Rust</em>系列入门的第二部分。这篇文章将重点介绍<em class="jt"> cargo </em> cli工具和Rust的包管理系统，包括:</p><ul class=""><li id="5d72" class="ju jv hy ix b iy iz jc jd jg jw jk jx jo jy js jz ka kb kc bi translated">寻找<em class="jt">板条箱</em></li><li id="100f" class="ju jv hy ix b iy kd jc ke jg kf jk kg jo kh js jz ka kb kc bi translated">在自己的项目中使用板条箱</li><li id="c55f" class="ju jv hy ix b iy kd jc ke jg kf jk kg jo kh js jz ka kb kc bi translated">配置机箱<em class="jt">功能切换</em></li><li id="441d" class="ju jv hy ix b iy kd jc ke jg kf jk kg jo kh js jz ka kb kc bi translated">安装(并使用)一个名为<a class="ae hv" href="https://crates.io/crates/cargo-watch" rel="noopener ugc nofollow" target="_blank">的二进制板条箱。</a></li></ul><p id="f00c" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">关于<em class="jt">货物</em>和<a class="ae hv" href="https://www.rust-lang.org" rel="noopener ugc nofollow" target="_blank">生锈</a>的基础知识，请查看我的第一篇文章<a class="ae hv" href="https://gian-lorenzetto.medium.com/rust-a-beginner-cheat-sheet-8fd7b0ce49de" rel="noopener">生锈——初学者小抄</a></p></div><div class="ab cl ki kj gp kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="hb hc hd he hf"><h1 id="f16e" class="kp kq hy bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">板条箱</h1><p id="a4ff" class="pw-post-body-paragraph iv iw hy ix b iy ln ja jb jc lo je jf jg lp ji jj jk lq jm jn jo lr jq jr js hb bi translated">生锈的包装被称为<em class="jt">板条箱。你可以在<a class="ae hv" href="https://crates.io" rel="noopener ugc nofollow" target="_blank"> crates.io </a>找到完整的板条箱注册表。</em></p><p id="257d" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">你可以使用<em class="jt"> cargo </em> cli工具搜索板条箱。例如，搜索与<em class="jt"> sql — </em>相关的板条箱</p><p id="83cd" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><code class="du ls lt lu lv b">$ cargo search sql</code></p><p id="6d11" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">运行<em class="jt">搜索</em>命令的结果是与您的搜索词相关的板条箱名称和版本列表</p><figure class="lx ly lz ma fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lw"><img src="../Images/b8426c104631aba96e81cdbf87a621a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D38_ZQNtQ-K5kB3RUbNDXw.png"/></div></div></figure></div><div class="ab cl ki kj gp kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="hb hc hd he hf"><h1 id="2507" class="kp kq hy bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">使用板条箱</h1><p id="f923" class="pw-post-body-paragraph iv iw hy ix b iy ln ja jb jc lo je jf jg lp ji jj jk lq jm jn jo lr jq jr js hb bi translated">为了使用板条箱，你将它们添加到你的<em class="jt"> Cargo.toml </em>文件中。让我们来看看用<code class="du ls lt lu lv b">$ cargo new {project_name}</code>创建的默认<em class="jt"> Cargo.toml </em></p><pre class="lx ly lz ma fd mb lv mc md aw me bi"><span id="9807" class="mf kq hy lv b fi mg mh l mi mj">[package]<br/>name = "hello_world"<br/>version = "0.1.0"<br/>edition = "2018"</span><span id="b002" class="mf kq hy lv b fi mk mh l mi mj"># See more keys and their definitions at <a class="ae hv" href="https://doc.rust-lang.org/cargo/reference/manifest.html" rel="noopener ugc nofollow" target="_blank">https://doc.rust-lang.org/cargo/reference/manifest.html</a></span><span id="18d8" class="mf kq hy lv b fi mk mh l mi mj">[dependencies]</span></pre><p id="01ed" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了使用上面搜索中的<em class="jt"> sql </em> crate，编辑yout Cargo.toml，如下所示</p><pre class="lx ly lz ma fd mb lv mc md aw me bi"><span id="b457" class="mf kq hy lv b fi mg mh l mi mj">[package]<br/>name = "hello_world"<br/>version = "0.1.0"<br/>edition = "2018"</span><span id="cdde" class="mf kq hy lv b fi mk mh l mi mj"># See more keys and their definitions at <a class="ae hv" href="https://doc.rust-lang.org/cargo/reference/manifest.html" rel="noopener ugc nofollow" target="_blank">https://doc.rust-lang.org/cargo/reference/manifest.html</a></span><span id="2fe1" class="mf kq hy lv b fi mk mh l mi mj">[dependencies]<br/>sql = "0.4.3"           &lt;-- Add dependency here</span></pre><p id="04b3" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">注意<a class="ae hv" href="https://doc.rust-lang.org/cargo/reference/specifying-dependencies.html" rel="noopener ugc nofollow" target="_blank">货物依赖与SemVer语法</a>完全兼容，允许根据需要进行选择性更新。</p></div><div class="ab cl ki kj gp kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="hb hc hd he hf"><h1 id="fe0a" class="kp kq hy bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">板条箱、Git和功能开关</h1><p id="2424" class="pw-post-body-paragraph iv iw hy ix b iy ln ja jb jc lo je jf jg lp ji jj jk lq jm jn jo lr jq jr js hb bi translated">在帮你拿板条箱的时候，货物是非常强大的。您可以用几种不同的方式指定板条箱的位置。</p><p id="64c1" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">标准方法(如上，但注意SemVer语法)—</p><pre class="lx ly lz ma fd mb lv mc md aw me bi"><span id="9e40" class="mf kq hy lv b fi mg mh l mi mj">[dependencies]<br/>bracket-lib = “<strong class="lv hz">~</strong>0.8.1”</span></pre><p id="d218" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">你可以指定一个Git repo —</p><pre class="lx ly lz ma fd mb lv mc md aw me bi"><span id="b4f4" class="mf kq hy lv b fi mg mh l mi mj">[dependencies]<br/>bracket-lib = <strong class="lv hz">{ git = "https://github.com/thebracket/bracket-lib" }</strong></span></pre><p id="1f3b" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">你甚至可以指定<em class="jt">功能切换</em>！在下面的例子中，将使用<a class="ae hv" href="https://crates.io/crates/bracket-lib" rel="noopener ugc nofollow" target="_blank">支架库</a>机箱，但是默认渲染引擎被禁用，而使用vulkan引擎——</p><pre class="lx ly lz ma fd mb lv mc md aw me bi"><span id="e7f3" class="mf kq hy lv b fi mg mh l mi mj">[dependencies]<br/>bracket-lib = {<br/>  git = "https://github.com/thebracket/bracket-lib",<br/>  <strong class="lv hz">default-features = false,<br/>  features = [ "amethyst_engine_vulkan" ]</strong><br/>}</span></pre></div><div class="ab cl ki kj gp kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="hb hc hd he hf"><h1 id="b343" class="kp kq hy bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">源箱和二进制箱</h1><p id="f6c1" class="pw-post-body-paragraph iv iw hy ix b iy ln ja jb jc lo je jf jg lp ji jj jk lq jm jn jo lr jq jr js hb bi translated">如果您来自C#或NPM背景，您可能会有兴趣在添加一个板条箱后下次运行<code class="du ls lt lu lv b">$ cargo build </code>时注意控制台输出</p><pre class="lx ly lz ma fd mb lv mc md aw me bi"><span id="4682" class="mf kq hy lv b fi mg mh l mi mj"><strong class="lv hz">Compiling sql v0.4.3</strong><br/>Compiling hello_world v0.1.0 (/Users/gian/hello_world)<br/>    Finished dev [unoptimized + debuginfo] target(s) in 0.99s</span></pre><p id="17dd" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">大多数Rust板条箱都是基于源代码的，当你把它们添加到你的本地项目中时，cargo会帮你获取源代码，然后为你的本地平台编译板条箱。</p><p id="b087" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果你指定一个不同的<em class="jt">目标</em>平台，你会看到cargo重新编译你所有的箱子。有关针对WebAssembly的示例，请参见<a class="ae hv" href="https://gian-lorenzetto.medium.com/rust-a-beginner-cheat-sheet-8fd7b0ce49de" rel="noopener">上一篇文章</a>。</p><p id="8062" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">货物确实支持安装<em class="jt">二进制</em>板条箱。这些是指定可执行文件的箱子。所以cargo获取、编译然后安装生成的可执行文件。</p><p id="5f2d" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">要安装一个二进制板条箱，你可以直接使用货物—</p><p id="2f9b" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><code class="du ls lt lu lv b">$ cargo install {crate_name}</code></p><p id="c143" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hz">注意</strong> — <em class="jt">一开始</em>对我来说有点困惑。使用<code class="du ls lt lu lv b">cargo install</code>安装板条箱仅<em class="jt">支持二进制板条箱。你<em class="jt">不要</em>使用这个命令来安装/添加常规板条箱(就像你使用<code class="du ls lt lu lv b">dotnet add</code>一样)。</em></p><p id="1125" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们来看一个叫做<em class="jt">货物观察</em>的例子。</p></div><div class="ab cl ki kj gp kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="hb hc hd he hf"><h1 id="d703" class="kp kq hy bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">货物监视</h1><p id="e921" class="pw-post-body-paragraph iv iw hy ix b iy ln ja jb jc lo je jf jg lp ji jj jk lq jm jn jo lr jq jr js hb bi translated">对于大多数板条箱，你会直接用手把它们添加到<em class="jt"> Cargo.toml </em>中。你可能想用<code class="du ls lt lu lv b">cargo search</code>命令找最新版本，或者直接去<a class="ae hv" href="https://crates.io" rel="noopener ugc nofollow" target="_blank"> crates.io </a>，但是你<em class="jt">不会</em>用<code class="du ls lt lu lv b">cargo install</code>。</p><p id="f91a" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">但是，如果您想要安装的机箱<em class="jt">是</em>二进制机箱，那么您可以简单地直接使用<code class="du ls lt lu lv b">cargo install </code>，机箱将被获取、编译并安装，以供您使用。</p><p id="3def" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hz">注意</strong> —与其他板条箱不同，安装二进制板条箱只需一次(除非您正在更新二进制板条箱本身的版本)。尝试一下没有坏处，但是你会得到这样的东西——</p><pre class="lx ly lz ma fd mb lv mc md aw me bi"><span id="2fdd" class="mf kq hy lv b fi mg mh l mi mj">Updating crates.io index<br/>    <strong class="lv hz">Ignored</strong> package `cargo-watch v7.8.1` is already installed, use --force to override</span></pre><p id="a339" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们用<a class="ae hv" href="https://crates.io/crates/cargo-watch" rel="noopener ugc nofollow" target="_blank"> cargo-watch </a>来试试吧，这是一个漂亮的二进制机箱，它安装了一个可执行的实用程序，可以监视项目中的文件变化，并让您指定要运行的命令。</p><p id="0938" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">安装货舱观察器，带有—</p><p id="6a63" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><code class="du ls lt lu lv b">$ cargo install cargo-watch</code></p><p id="c1b4" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">一旦命令完成(成功),您将可以立即访问<em class="jt">货物观察</em> cli工具——</p><p id="93a0" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><code class="du ls lt lu lv b">$ cargo-watch -x build</code></p><p id="86e7" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">该命令将启动一个进程来观察项目中文件的变化，在这种情况下，当检测到变化时，自动运行<code class="du ls lt lu lv b">cargo build</code>。</p><p id="d6af" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">你可以像这样将多个命令链接在一起—</p><p id="9b7c" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><code class="du ls lt lu lv b">$ cargo-watch -x fmt -x test</code></p><p id="b6c6" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这个命令假设你已经安装了来自<a class="ae hv" href="https://gian-lorenzetto.medium.com/rust-a-beginner-cheat-sheet-8fd7b0ce49de" rel="noopener">上一篇文章</a>的Rust linter，但是它将触发linter，然后在每次文件改变时运行任何测试！</p><p id="a696" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">你可以用<em class="jt">货物监视</em>做更多的事情，所以去看看<a class="ae hv" href="https://crates.io/crates/cargo-watch" rel="noopener ugc nofollow" target="_blank">货物监视箱文档。</a></p></div><div class="ab cl ki kj gp kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="hb hc hd he hf"><h1 id="88fe" class="kp kq hy bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">摘要</h1><p id="f214" class="pw-post-body-paragraph iv iw hy ix b iy ln ja jb jc lo je jf jg lp ji jj jk lq jm jn jo lr jq jr js hb bi translated">铁锈板条箱与大多数其他包装系统没有什么特别的不同，但是如上所述，有一些事情需要注意。</p><p id="9c89" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="jt"> cargo-watch </em>板条箱是二进制板条箱的一个很好的例子，也是一个非常方便的实用工具，当你在开发像VSCode这样的东西，并且想要得到关于代码变化等的即时反馈时。</p><p id="5309" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">有很多板条箱可供选择，而且随时会有更多的板条箱推出，所以去看看<a class="ae hv" href="https://crates.io" rel="noopener ugc nofollow" target="_blank"> crates.io </a>并保持生锈:)</p><p id="8bc5" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">接下来我将<a class="ae hv" href="https://gian-lorenzetto.medium.com/rust-modules-and-project-structure-832404a33e2e" rel="noopener">处理Rust模块</a>——这可能是Rust中我发现的最令人困惑的方面(在借用检查器之外，但那是以后的文章；)</p></div></div>    
</body>
</html>