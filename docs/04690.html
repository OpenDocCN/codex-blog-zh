<html>
<head>
<title>What Went Wrong With Log4J | CVE-2021–44228</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Log4J | CVE-2021–44228出了什么问题</h1>
<blockquote>原文：<a href="https://medium.com/codex/what-went-wrong-with-log4j-cve-2021-44228-5d0aaae22977?source=collection_archive---------7-----------------------#2021-12-27">https://medium.com/codex/what-went-wrong-with-log4j-cve-2021-44228-5d0aaae22977?source=collection_archive---------7-----------------------#2021-12-27</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="bc5d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个漏洞像风暴一样席卷了互联网，成千上万的组织和数百万台电脑受到了影响。我们来详细看看这个漏洞的细节，以及为什么网络安全社区会出现这种错误。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es je"><img src="../Images/596e7065d02ecae2c01460f8a7c1b0e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:920/format:webp/0*KEVQ6z1uc3ZAaWse.jpg"/></div></figure><h1 id="2b03" class="jm jn hi bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">背景知识</h1><p id="e584" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">首先，在了解漏洞之前，我们需要了解这个原因的根源，以及它是如何导致过去几十年中最大的错误之一的。<strong class="ih hj"> Log4J是一个日志记录工具，允许用户将数据记录到远程服务器、文件或控制台或shell上</strong>。但是什么是伐木呢？在网络安全方面，该组织使用一种称为日志记录的方法，这种方法只不过是存储与服务器交互的用户的数据，一个简单的例子是，如果您使用谷歌服务器，谷歌将记录您的IP地址、您使用的浏览器以及所有其他信息的详细信息。这是组织级安全的重要任务之一，因为在受到攻击时，我们可以跟踪系统是如何被攻破的。</p><p id="2cfc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以log4j就是这样一种工具，它自动将日志存储在指定的位置。我们可以说，由于日志对于组织来说是一项重要的任务，大多数系统都使用log4j，这导致了这次bug风暴。但是log4j还有一些额外的特性，让我们来详细了解一下</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es kp"><img src="../Images/834afbda0307b968da14ef576024b5d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1238/0*xFCMVt_VLtOGAUiX"/></div></figure><p id="244d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">来源:<a class="ae jd" href="https://draft.blogger.com/blog/post/edit/3504568035593819778/9154690075045495769#" rel="noopener ugc nofollow" target="_blank">阿帕奇Log4j </a></p><p id="0b69" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是一个在java应用程序中使用log4j的简单示例，我们也可以使用XML文件来配置logger，这里需要注意的是，首先我们需要让logger对象与它交互，然后我们就可以使用它了，这里我们是通过给logger.info()来实现的，它将一条消息作为参数，在这里我们显示类似“进入应用程序”等消息。但是还有一个特性叫做查找。Lookups为log4j提供了额外的特性，比如使用额外的变量、任意常量，甚至环境变量。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es kq"><img src="../Images/7c7f5c5d57edf8310ae2c0748493bf28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1138/0*nTEJ37pM4TCR-Ynw"/></div></figure><p id="82d9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">编译器将理解＄＄{ env:USER },用户信息将打印在控制台中。有不同类型的查找，这里需要了解的另一个实用程序是<strong class="ih hj"> JNDI或Java命名和目录接口</strong>，它是一个java API，用于执行DNS查找和查找不同的应用程序。这里要记住的一点是<strong class="ih hj"> JNDI和Log$j是完全不同的工具，没有共同的特性</strong>。</p><h1 id="1e28" class="jm jn hi bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">这里出了什么问题？</h1><p id="5b00" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">正如你现在所知道的关于查找和一点点JDNI这不会敲响一些钟来利用这些特性，log4j的漏洞是log4j和JNDI的一种组合。我们知道查找可以有字符串和其他变量，但是如果有一个特制的字符串来执行特定的任务，然后被传递给JNDI，导致系统被利用怎么办？。这很容易理解，任何对网络安全知之甚少的人都可以利用这个漏洞。该过程开始时，攻击者首先向系统发送恶意代码并记录下来。为了理解这些，让我们举一个简单的例子，我们制作了一个应用程序，它也使用log4j来登录信息，但现在只有浏览器信息，所以我使用的是微软Chrome的Edge，它将记录到数据库或文件中，但如果你擅长操作系统，我们可以用一个文件配置我们的浏览器，并用其他浏览器命名它，例如firefox，所以记录器将记录firefox，而不是上面的浏览器，这只是让记录器存储错误的信息。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es kr"><img src="../Images/4c40e7eeb7afb4a81907983c548e91b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*IiyYIzvTog0L2Q5t.png"/></div></div></figure><p id="9359" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Log4j漏洞是这种方法的扩展，攻击者通过向系统发送恶意信息、导致RCE或远程代码执行并制造后门来危害系统。该工具的影响范围如此之大，以至于整个世界都受到了影响，甚至美国、澳大利亚等一些国家也将其作为网络安全的红色代码级别，并停止了所有使用该漏洞的服务器，有趣的是，该工具是在2011年至2013年开发的，但直到2021年12月才有人发现该漏洞。此事的<strong class="ih hj">首起事件于2021年12月10日</strong>被阿里云安全发现。但是人们也说这是被《我的世界》服务器的玩家发现的，用来入侵他们朋友的数据等等。</p><h1 id="5013" class="jm jn hi bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">我们应该从中学到什么？</h1><p id="de84" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">Log4J改变了当今网络安全和软件开发人员的思维模式。作为软件开发人员，我们在不知道库的内部实现的情况下使用由某人开发的来自互联网的库，我们甚至不知道它会如何影响我们的软件，它有什么样的安全问题。在log4j的例子中，大多数开发者使用它，但是不知道查找和JNDI的漏洞，这里需要注意的另一点是，当我们开发一个任何用户都可以使用的库或实用程序时，我们应该保持它的简单和透明，不要太复杂。<strong class="ih hj">每个开发人员都应该明白他在使用什么代码，以及它的后果和结果是什么</strong>，因为他们中的大多数人只考虑效率<strong class="ih hj">而不是安全</strong>这就是这个漏洞的根源所在。</p><p id="22f2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">欲了解更多信息，请访问:</p><p id="8d36" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jd" href="https://www.mayhemcode.com/2021/12/what-went-wrong-with-log4j-cve-2021.html" rel="noopener ugc nofollow" target="_blank">https://www . mayhemcode . com/2021/12/what-go-erry-with-log4j-CVE-2021 . html</a></p></div><div class="ab cl kw kx gp ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="hb hc hd he hf"><p id="b9b9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="ld">原载于2021年12月27日</em><a class="ae jd" href="https://www.mayhemcode.com/2021/12/what-went-wrong-with-log4j-cve-2021.html" rel="noopener ugc nofollow" target="_blank"><em class="ld">【https://www.mayhemcode.com】</em></a><em class="ld">。</em></p></div></div>    
</body>
</html>