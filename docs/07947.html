<html>
<head>
<title>Headers and Cookies for Web Scraping</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用于网页抓取的标题和Cookies</h1>
<blockquote>原文：<a href="https://medium.com/codex/headers-and-cookies-for-web-scraping-b91bd99a33a5?source=collection_archive---------8-----------------------#2022-07-06">https://medium.com/codex/headers-and-cookies-for-web-scraping-b91bd99a33a5?source=collection_archive---------8-----------------------#2022-07-06</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/ab44b5b8f7112a206abed67ccea92776.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YpnxVnJMulwiClaQ9JIw4w.jpeg"/></div></div></figure><p id="1384" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">关于Web抓取的标题和Cookies的文章最初发表在Scraper API上。</p><p id="3a23" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">随着技术的进步，web服务器在区分用户流量和web抓取器方面变得越来越好，这使得我们所有人都更难访问我们需要的数据。</p><p id="e77f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">尽管我们可以使用许多方法来规避许多安全措施，但是有一种方法特别没有得到足够的重视:自定义HTTP头。</p><p id="559e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在今天的文章中，我们将深入探讨什么是HTTP头，为什么它们对web抓取很重要，以及我们如何在代码中获取和使用它们。</p><h1 id="629d" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">什么是HTTP头？</h1><p id="1b94" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">根据<a class="ae jo" href="https://developer.mozilla.org/en-US/docs/Glossary/HTTP_header" rel="noopener ugc nofollow" target="_blank">MDN</a>“HTTP头是HTTP请求或响应的一个字段，它传递关于请求或响应的附加上下文和元数据”，由区分大小写的名称(如年龄、缓存控制、日期、cookie等)后跟冒号(:)及其值组成。</p><p id="a884" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">简而言之，用户/客户机发送一个包含请求头的请求，向服务器提供更多的细节。然后，服务器用符合请求头中包含的规范的结构中请求的数据进行响应。</p><p id="22cb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了清楚起见，下面是我们的浏览器在撰写本文时发送给<a class="ae jo" href="https://prerender.io/" rel="noopener ugc nofollow" target="_blank"> Prerender </a>的请求头:</p><p id="4854" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">1 authority: <strong class="is hj">in</strong>.hotjar.com</code></p><p id="6c78" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">2 :method: POST</code></p><p id="28d8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">3 :path: <strong class="is hj">/</strong>api<strong class="is hj">/</strong>v2<strong class="is hj">/</strong>client<strong class="is hj">/</strong>sites<strong class="is hj">/</strong>2829708<strong class="is hj">/</strong>visit<strong class="is hj">-</strong>data?sv<strong class="is hj">=</strong>7</code></p><p id="9b5f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">4 :scheme: https</code></p><p id="5de5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">5 accept: <strong class="is hj">*/*</strong></code></p><p id="6f7e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">6 accept<strong class="is hj">-</strong>encoding: gzip, deflate, br</code></p><p id="6d8e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">7 accept<strong class="is hj">-</strong>language: en<strong class="is hj">-</strong>US,en;q<strong class="is hj">=</strong>0.9,it;q<strong class="is hj">=</strong>0.8,es;q<strong class="is hj">=</strong>0.7</code></p><p id="951c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">8 content<strong class="is hj">-</strong>length: 112</code></p><p id="965f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">9 content<strong class="is hj">-</strong>type: text<strong class="is hj">/</strong>plain; charset<strong class="is hj">=</strong>UTF<strong class="is hj">-</strong>8</code></p><p id="cab5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">10 origin: <a class="ae jo" href="https://prerender.io" rel="noopener ugc nofollow" target="_blank">https:<strong class="is hj">//</strong>prerender.io</a></code></p><p id="0ebc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">11 referer: <a class="ae jo" href="https://prerender.io/" rel="noopener ugc nofollow" target="_blank">https:<strong class="is hj">//</strong>prerender.io<strong class="is hj">/</strong></a></code></p><p id="b2c2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">12 sec<strong class="is hj">-</strong>ch<strong class="is hj">-</strong>ua: " Not A;Brand";v<strong class="is hj">=</strong>"99", "Chromium";v<strong class="is hj">=</strong>"101", "Microsoft Edge";v<strong class="is hj">=</strong>"101"</code></p><p id="2722" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">13 sec<strong class="is hj">-</strong>ch<strong class="is hj">-</strong>ua<strong class="is hj">-</strong>mobile: ?0</code></p><p id="7baa" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">14 sec<strong class="is hj">-</strong>ch<strong class="is hj">-</strong>ua<strong class="is hj">-</strong>platform: "macOS"</code></p><p id="6cf3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">15 sec<strong class="is hj">-</strong>fetch<strong class="is hj">-</strong>dest: empty</code></p><p id="7944" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">16 sec<strong class="is hj">-</strong>fetch<strong class="is hj">-</strong>mode: cors</code></p><p id="6373" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">17 sec<strong class="is hj">-</strong>fetch<strong class="is hj">-</strong>site: cross<strong class="is hj">-</strong>site</code></p><p id="d76a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">18 user<strong class="is hj">-</strong>agent: Mozilla<strong class="is hj">/</strong>5.0</code> <code class="du ks kt ku kv b">(Macintosh; Intel Mac OS X 10_15_7) AppleWebKit<strong class="is hj">/</strong>537.36</code> <code class="du ks kt ku kv b">(KHTML, like Gecko) Chrome<strong class="is hj">/</strong>101.0.4951.64</code> <code class="du ks kt ku kv b">Safari<strong class="is hj">/</strong>537.36</code> <code class="du ks kt ku kv b">Edg<strong class="is hj">/</strong>101.0.1210.47</code></p><h1 id="25cc" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">什么是网络Cookies？</h1><p id="bffc" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">Web cookies，也称为HTTP cookies或浏览器cookie，是由服务器(HTTP响应头)发送到用户浏览器的一段数据，用于以后识别。在后面的请求(HTTP header请求)中，浏览器会将cookie发送回服务器，使服务器能够识别浏览器。</p><p id="d6cf" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">网站和web应用程序使用cookies进行会话管理(比如让您保持登录)、个性化(保存设置和首选项)、跟踪，在某些情况下还用于安全性。</p><p id="d5de" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们看看LinkedIn的请求头中的cookie是什么样的:</p><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kw"><img src="../Images/d26ed7ccb8a2a5de0fbbc3fad888d94a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*veCBnTfZxqcY6DQT.jpg"/></div></div></figure><h1 id="9ee7" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">为什么标题对网页抓取很重要？</h1><p id="fe20" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">许多网站所有者知道他们的数据会以某种方式被窃取，所以他们使用许多不同的工具和策略来识别机器人并阻止它们进入他们的网站。他们这样做有很多正当理由，因为优化不好的机器人会降低网站速度，甚至破坏网站。</p><p id="c808" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">注意:</strong>遵循这些<a class="ae jo" href="https://www.scraperapi.com/blog/web-scraping-best-practices/" rel="noopener ugc nofollow" target="_blank">网络抓取最佳实践</a>，你可以避免网络服务器不堪重负，并降低被阻塞的几率。</p><p id="68bb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然而，不太受关注的一种方法是使用HTTP头和cookies。因为您的浏览器/客户端在其请求中发送HTTP标头，所以服务器可以使用此信息来检测虚假用户，从而阻止他们访问网站或提供虚假/不良信息。</p><p id="f9d0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">但是反过来也是一样的。通过优化通过我们的机器人请求发送的头，我们可以模仿有机用户的行为，减少我们被列入黑名单的机会，在某些情况下，提高我们收集的数据的质量。</p><h1 id="be62" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">最常见的网页抓取HTTP头</h1><p id="ac14" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">我们可以在请求中学习和使用大量的HTTP头<a class="ae jo" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers" rel="noopener ugc nofollow" target="_blank">列表，但是在大多数情况下，我们真正关心的web抓取只有几个:</a></p><h1 id="2d43" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">1.用户代理</h1><p id="a749" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">这可能是最重要的标题，因为它标识了“请求软件用户代理的应用程序类型、操作系统、软件供应商或软件版本”，使其成为大多数服务器将运行的第一个检查。</p><p id="1585" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">例如，使用请求Python库发送请求时，用户代理字段将显示以下信息，具体取决于您的Python版本:</p><p id="e72b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">1 user<strong class="is hj">-</strong>agent: python<strong class="is hj">-</strong>requests<strong class="is hj">/</strong>2.22.0</code></p><p id="cc96" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">很容易被服务器发现和阻止。</p><p id="0b86" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">相反，我们希望我们的用户代理头看起来更像我们的第一个例子中所示的:</p><p id="661a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">1 user<strong class="is hj">-</strong>agent: Mozilla<strong class="is hj">/</strong>5.0</code><code class="du ks kt ku kv b">(Macintosh; Intel Mac OS X 10_15_7) AppleWebKit<strong class="is hj">/</strong>537.36</code><code class="du ks kt ku kv b">(KHTML, like Gecko) Chrome<strong class="is hj">/</strong>101.0.4951.64</code><code class="du ks kt ku kv b">Safari<strong class="is hj">/</strong>537.36</code>T5】</p><h1 id="6024" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">2.接受语言</h1><p id="2a1c" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">虽然并不总是必要的，但它告诉服务器应该提供哪种语言版本的数据。从语言的角度来看，当每个请求之间有很大的差异时，它可以告诉服务器有一个机器人参与其中。</p><p id="bfb5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然而，从技术上来说，“服务器应该始终注意不要覆盖明确的用户选择”，因此，如果您抓取的URL已经有特定的语言，它仍然可以被视为有机用户。</p><p id="8f8f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下面是它在我们的示例请求中的显示方式:</p><p id="e513" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">1 accept<strong class="is hj">-</strong>language: en<strong class="is hj">-</strong>US,en;q<strong class="is hj">=</strong>0.9,it;q<strong class="is hj">=</strong>0.8,es;q<strong class="is hj">=</strong>0.7</code></p><h1 id="c33f" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">3.接受编码</h1><p id="b6da" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">顾名思义，它告诉服务器哪种<a class="ae jo" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Compression" rel="noopener ugc nofollow" target="_blank">压缩算法</a>可以用于发回的资源，“节省某些文档所需带宽的70%，从而减轻我们的脚本给服务器带来的压力。</p><p id="faad" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">1 accept<strong class="is hj">-</strong>encoding: gzip, deflate, br</code></p><h1 id="20ff" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">4.推荐人</h1><p id="aa50" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">Referer HTTP头告诉服务器用户来自哪个页面。虽然它主要用于跟踪，但它也可以帮助我们模仿有机用户的行为，例如，告诉服务器我们来自谷歌这样的搜索引擎。</p><p id="4e52" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">1 referer: <a class="ae jo" href="https://prerender.io/" rel="noopener ugc nofollow" target="_blank">https:<strong class="is hj">//</strong>prerender.io<strong class="is hj">/</strong></a></code></p><h1 id="5333" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">5.饼干</h1><p id="74fd" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">我们已经讨论了什么是cookie，但是，我们可能没有清楚地说明为什么cookie对网络抓取很重要。</p><p id="b926" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">cookie允许服务器使用一小块数据进行通信，但是当服务器发送了一个cookie，但浏览器没有存储并在下一个请求中发回它时会发生什么呢？Cookies还可以用来识别请求是来自真实用户还是机器人。</p><p id="0cb0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">反之亦然，我们可以使用网络cookie来模仿用户浏览网站时的有机行为，方法是在每次交互后将cookie发送回服务器，并通过更改cookie本身，我们可以告诉服务器我们是新用户，使我们的抓取脚本更容易避免被阻止。</p><h1 id="9a03" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">如何查看HTTP头？[包括饼干]</h1><p id="bfa4" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">在我们可以在代码中使用头文件之前，我们需要能够从某个地方获取它们。为此，让我们使用自己的浏览器，并转到目标网站。对于我们的示例，让我们转到<em class="lb">google.com&gt;右键单击&gt;检查</em>以打开开发者工具。</p><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kw"><img src="../Images/e599b5a303bfc759265525e94450e698.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Oztzfmuf249y7h3E.png"/></div></div></figure><p id="a43e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">从那里，我们将导航到网络选项卡，回到谷歌，搜索查询“网页抓取标题”。</p><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kw"><img src="../Images/6c88319f7cd104ac2ad83ff82e833580.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*TalWWSYYP2k4j1UQ.jpg"/></div></div></figure><p id="84ee" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">随着页面的加载，我们将看到network选项卡被填充。我们将仔细查看Fetch/XHR选项卡，在这里我们可以找到浏览器正在获取的文档，当然还有请求中使用的HTTP头。</p><p id="f262" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">虽然我们要找的文件没有一个标准的名字，但它通常是一个与我们在页面上要做的事情相关的名字，或者是提供要呈现的数据的文件。</p><p id="f6a4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">单击该文件，我们将默认打开“Headers”选项卡，向下滚动，我们将看到“Request Headers”部分。</p><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kw"><img src="../Images/a1b80fa81b1b03386c1c0bd1b000e5c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*QpqPYXE2yIJIANm_.png"/></div></div></figure><p id="dcf7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，我们可以将标题字段及其值复制并粘贴到代码中。</p><h1 id="8660" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">如何使用自定义标题进行网页抓取</h1><p id="ff88" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">您使用自定义标题的方式将取决于您正在使用的编程语言，但是，我们将尝试添加尽可能多的示例。</p><p id="c1fc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">你会注意到的一件事是:是的，每个方法是不同的，但它们共享相同的逻辑，所以无论你使用什么代码库，都很容易翻译。</p><p id="14db" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对于我们所有的例子，我们将把我们的请求发送到<a class="ae jo" href="https://httpbin.org/headers" rel="noopener ugc nofollow" target="_blank">https://httpbin.org/headers</a>，这是一个旨在展示从服务器的角度看响应和请求的网站。</p><p id="3d80" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果我们在浏览器上打开上面的链接，会出现以下内容:</p><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kw"><img src="../Images/ba7f2700b020a18d8449158714964c03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*QgjSX9GJnFJmIrKR.png"/></div></div></figure><p id="d2a1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">网站用浏览器发送的标题进行响应，现在我们可以在通过代码发送请求时使用相同的标题。</p><h1 id="25ca" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">在Python中使用自定义头</h1><p id="0354" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">在使用我们的自定义头之前，让我们先发送一个测试请求，看看它返回什么:</p><p id="005f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b"><strong class="is hj">1 import</strong></code> <code class="du ks kt ku kv b">requests</code></p><p id="f537" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">2</code></p><p id="7014" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">3</code></p><p id="c61a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">4</code></p><p id="8b6a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">5 url <strong class="is hj">=</strong></code> <code class="du ks kt ku kv b">'<a class="ae jo" href="https://httpbin.org/headers" rel="noopener ugc nofollow" target="_blank">https://httpbin.org/headers</a>'</code></p><p id="2886" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">6</code></p><p id="8120" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">7</code></p><p id="b2d2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">8</code></p><p id="03f7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">9 response <strong class="is hj">=</strong></code>T11】</p><p id="71aa" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">10</code></p><p id="8c6c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">11</code></p><p id="87ca" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">12</code></p><p id="85f2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">13 print(response.text)</code></p><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kw"><img src="../Images/c2629561fd6343b1b1cd114e310d7af5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*WbO6Hjc5y2_yXbuc.png"/></div></div></figure><p id="c338" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">正如您所看到的，使用的用户代理是默认的python-requests/2.26.0，这将使服务器非常容易识别我们的bot。</p><p id="54e1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">了解了这一点，让我们进入下一步，向我们的请求添加我们的自定义标题:</p><p id="01bc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b"><strong class="is hj">1 import</strong></code> <code class="du ks kt ku kv b">requests</code></p><p id="9270" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">2</code></p><p id="10df" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">3 url <strong class="is hj">=</strong></code> <code class="du ks kt ku kv b">'<a class="ae jo" href="https://httpbin.org/headers" rel="noopener ugc nofollow" target="_blank">https://httpbin.org/headers</a>'</code></p><p id="3c49" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">4</code></p><p id="d5d1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">5 headers <strong class="is hj">=</strong></code> <code class="du ks kt ku kv b">{</code></p><p id="ddeb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">6 'accept': '*/*',</code></p><p id="0477" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">7 'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.64 Safari/537.36 Edg/101.0.1210.53',</code></p><p id="bab2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">8 'Accept-Language': 'en-US,en;q=0.9,it;q=0.8,es;q=0.7',</code></p><p id="c6d8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">9 'referer': '<a class="ae jo" href="https://www.google.com/" rel="noopener ugc nofollow" target="_blank">https://www.google.com/</a>',</code></p><p id="5136" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">10 'cookie': 'DSID=AAO-7r4OSkS76zbHUkiOpnI0kk-X19BLDFF53G8gbnd21VZV2iehu-w_2v14cxvRvrkd_NjIdBWX7wUiQ66f-D8kOkTKD1BhLVlqrFAaqDP3LodRK2I0NfrObmhV9HsedGE7-mQeJpwJifSxdchqf524IMh9piBflGqP0Lg0_xjGmLKEQ0F4Na6THgC06VhtUG5infEdqMQ9otlJENe3PmOQTC_UeTH5DnENYwWC8KXs-M4fWmDADmG414V0_X0TfjrYu01nDH2Dcf3TIOFbRDb993g8nOCswLMi92LwjoqhYnFdf1jzgK0'</code></p><p id="2dd1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">11 }</code></p><p id="66cf" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">12</code></p><p id="3bdd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">13 response <strong class="is hj">=</strong></code> <code class="du ks kt ku kv b">requests.get(url, headers<strong class="is hj">=</strong>headers)</code></p><p id="b8b8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">14</code></p><p id="e7b5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">15 print(response.text)</code></p><p id="b792" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">首先，我们用我们的头创建一个字典。其中一些是我们从HTTPbin获得的，但cookies来自MDN文档，我们将Google添加为referer，因为在大多数情况下，用户将通过单击来自Google的链接来访问网站。</p><p id="0a4d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">结果如下:</p><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kw"><img src="../Images/db4841558efd3d445f4756f8030f5c17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*qd3ZGklPbRqXYsJw.png"/></div></div></figure><p id="abf6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">理论上，你可以使用自定义的任意组合作为你的自定义头的值。但是，如果不发送一组特定的标题，有些网站不允许您访问它们。当你试图在抓取时使用自定义标题时，最好在浏览目标网站时查看你的浏览器已经发送了什么标题。</p><h1 id="9534" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">在节点中使用自定义标题。射流研究…</h1><p id="30cf" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">我们要做同样的事情，但是使用节点。JS Axios包发送我们的请求:</p><p id="8c1f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">1 const axios <strong class="is hj">=</strong></code>T11】</p><p id="6f0c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">2</code></p><p id="4c64" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">3 const url <strong class="is hj">=</strong></code> <code class="du ks kt ku kv b">'<a class="ae jo" href="https://httpbin.org/headers" rel="noopener ugc nofollow" target="_blank">https://httpbin.org/headers</a>';</code></p><p id="3474" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">4</code></p><p id="facb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">5 const headers <strong class="is hj">=</strong></code> <code class="du ks kt ku kv b">{</code></p><p id="7960" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">6 'accept': '*/*',</code></p><p id="cd17" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">7 'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.64 Safari/537.36 Edg/101.0.1210.53',</code></p><p id="aded" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">8 'Accept-Language': 'en-US,en;q=0.9,it;q=0.8,es;q=0.7',</code></p><p id="f97f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">9 'referer': '<a class="ae jo" href="https://www.google.com/" rel="noopener ugc nofollow" target="_blank">https://www.google.com/</a>',</code></p><p id="55b7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">10 'cookie': 'DSID=AAO-7r4OSkS76zbHUkiOpnI0kk-X19BLDFF53G8gbnd21VZV2iehu-w_2v14cxvRvrkd_NjIdBWX7wUiQ66f-D8kOkTKD1BhLVlqrFAaqDP3LodRK2I0NfrObmhV9HsedGE7-mQeJpwJifSxdchqf524IMh9piBflGqP0Lg0_xjGmLKEQ0F4Na6THgC06VhtUG5infEdqMQ9otlJENe3PmOQTC_UeTH5DnENYwWC8KXs-M4fWmDADmG414V0_X0TfjrYu01nDH2Dcf3TIOFbRDb993g8nOCswLMi92LwjoqhYnFdf1jzgK0',</code></p><p id="b4ac" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">11 };</code></p><p id="3214" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">12</code></p><p id="b735" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">13 axios.get(url, Headers<strong class="is hj">=</strong>{headers})</code></p><p id="d16c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">14 .then((response) <strong class="is hj">=</strong>&gt; {</code></p><p id="dcba" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">15 console.log(response.data);</code></p><p id="8dbf" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">16 }, (error) <strong class="is hj">=</strong>&gt; {</code></p><p id="286c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">17 console.log(error);</code></p><p id="fa57" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">18 });</code></p><p id="dcd6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">结果如下:</p><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kw"><img src="../Images/62beec5dcf2a4d8dae092bd96cc32d71.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*tB1TmN9HFTZDbiq4.png"/></div></div></figure><h1 id="adb4" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">在ScraperAPI中使用自定义标题</h1><p id="430a" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">ScraperAPI的一个很棒的特性是，它使用机器学习和多年的统计分析来确定我们发送的每个请求的最佳头组合。</p><p id="cb8f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然而，最近，我们看到越来越多的小网站改善他们的安全措施，但没有足够的数据让API自动确定最佳组合。因此，如果您注意到高失败率，就值得尝试使用我们上面展示的定制头。</p><p id="d6d9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在<a class="ae jo" href="https://www.scraperapi.com/documentation/#curl-CustomHeaders" rel="noopener ugc nofollow" target="_blank">我们的文档</a>中，您将能够找到Node编码示例的完整列表。JS、PHP、Ruby和Java，但为了节省时间，这里有一个完整的Python示例，用于使用带有自定义头的ScraperAPI:</p><p id="743b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b"><strong class="is hj">1 import</strong></code>T11】</p><p id="6ca5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">2</code></p><p id="7ccf" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">3 headers <strong class="is hj">=</strong></code> <code class="du ks kt ku kv b">{</code></p><p id="eb7f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">4 'accept': '*/*',</code></p><p id="97f4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">5 'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.64 Safari/537.36 Edg/101.0.1210.53',</code></p><p id="be08" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">6 'Accept-Language': 'en-US,en;q=0.9,it;q=0.8,es;q=0.7',</code></p><p id="4a01" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">7 'referer': '<a class="ae jo" href="https://www.google.com/" rel="noopener ugc nofollow" target="_blank">https://www.google.com/</a>',</code></p><p id="64a1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">8 'cookie': 'DSID=AAO-7r4OSkS76zbHUkiOpnI0kk-X19BLDFF53G8gbnd21VZV2iehu-w_2v14cxvRvrkd_NjIdBWX7wUiQ66f-D8kOkTKD1BhLVlqrFAaqDP3LodRK2I0NfrObmhV9HsedGE7-mQeJpwJifSxdchqf524IMh9piBflGqP0Lg0_xjGmLKEQ0F4Na6THgC06VhtUG5infEdqMQ9otlJENe3PmOQTC_UeTH5DnENYwWC8KXs-M4fWmDADmG414V0_X0TfjrYu01nDH2Dcf3TIOFbRDb993g8nOCswLMi92LwjoqhYnFdf1jzgK0'</code></p><p id="299f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">9 }</code></p><p id="7169" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">10</code></p><p id="e980" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">11 payload <strong class="is hj">=</strong></code> <code class="du ks kt ku kv b">{</code></p><p id="3eff" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">12 'api_key': '51e43be283e4db2a5afb62660xxxxxxx',</code></p><p id="4b56" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">13 'url': '<a class="ae jo" href="https://httpbin.org/headers" rel="noopener ugc nofollow" target="_blank">https://httpbin.org/headers</a>',</code></p><p id="edc2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">14 'keep_headers': 'true',</code></p><p id="19e6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">15 }</code></p><p id="20b5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">16</code></p><p id="c8a2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">17 response <strong class="is hj">=</strong></code>T11】</p><p id="e21c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">18</code></p><p id="1a35" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">19 print(response.text)</code></p><p id="905d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">所以在Python中使用定制头非常简单:</p><ul class=""><li id="d33b" class="lc ld hi is b it iu ix iy jb le jf lf jj lg jn lh li lj lk bi translated">我们需要在创建有效载荷之前和之后创建头部字典</li><li id="174f" class="lc ld hi is b it ll ix lm jb ln jf lo jj lp jn lh li lj lk bi translated">我们将添加到有效负载的第一个元素是我们的API密钥，我们可以通过<a class="ae jo" href="https://www.scraperapi.com/signup" rel="noopener ugc nofollow" target="_blank">创建一个免费的ScraperAPI帐户</a>来生成它</li><li id="344a" class="lc ld hi is b it ll ix lm jb ln jf lo jj lp jn lh li lj lk bi translated">接下来，我们将添加我们的目标URL——在本例中是<a class="ae jo" href="https://httpbin.org/headers" rel="noopener ugc nofollow" target="_blank">https://httpbin.org/headers</a></li><li id="f63a" class="lc ld hi is b it ll ix lm jb ln jf lo jj lp jn lh li lj lk bi translated">最后一个参数将是keep_headers，并将其设置为true，以告诉ScraperAPI保留我们的自定义标题</li><li id="9ad1" class="lc ld hi is b it ll ix lm jb ln jf lo jj lp jn lh li lj lk bi translated">最后，我们将所有元素一起添加到requests.get()方法中</li></ul><p id="40ce" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">综合所有这些，我们将得到这样一个URL:</p><p id="85f5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ks kt ku kv b">1 <a class="ae jo" href="http://api.scraperapi.com/?api_key=51e43be283e4db2a5afb62660xxxxxxx&amp;amp;url=http://httpbin.org/headers&amp;amp;keep_headers=true" rel="noopener ugc nofollow" target="_blank">http:<strong class="is hj">//</strong>api.scraperapi.com<strong class="is hj">/</strong>?api_key<strong class="is hj">=</strong>51e43be283e4db2a5afb62660xxxxxxx&amp;amp;url<strong class="is hj">=</strong>http:<strong class="is hj">//</strong>httpbin.org<strong class="is hj">/</strong>headers&amp;amp;keep_headers<strong class="is hj">=</strong>true</a></code></p><h1 id="a304" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">包扎</h1><p id="1afb" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">网络抓取既是一门艺术也是一门科学。因为每个网站都是不同的，没有唯一的做事方法，所以拥有尽可能多的工具对我们的项目成功至关重要。</p><p id="fd7d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">以正确的格式访问页面内容是这个过程的一个关键部分，在请求中使用正确的HTTP头会带来很大的不同。</p><p id="4c37" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">使用ScraperAPI时，您可以放心，在99%的情况下，我们的API会为您选择并发送正确的标题，让您从任务中解放出来。然而，在那些失败率很高的罕见情况下，尝试提取并使用浏览器发送到目标页面的标题。根据我们的经验，这就是诀窍。</p><p id="f139" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">尽管如此，如果你在保证成功请求方面有困难，请不要犹豫<a class="ae jo" href="https://www.scraperapi.com/blog/#" rel="noopener ugc nofollow" target="_blank">联系我们</a>。</p><p id="3016" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下次见，刮刮快乐！</p></div></div>    
</body>
</html>