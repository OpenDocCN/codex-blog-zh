<html>
<head>
<title>Run shell commands from a Kotlin script or application with ease</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">轻松地从Kotlin脚本或应用程序运行shell命令</h1>
<blockquote>原文：<a href="https://medium.com/codex/run-shell-commands-from-a-kotlin-script-or-application-with-ease-e5764a6c7cff?source=collection_archive---------3-----------------------#2021-04-22">https://medium.com/codex/run-shell-commands-from-a-kotlin-script-or-application-with-ease-e5764a6c7cff?source=collection_archive---------3-----------------------#2021-04-22</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/f2997ba9e6c7dad4a2ade0fc20135369.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9MSGBJnGKXGMufyX"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">兰德尔·鲁伊斯在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="7054" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">几天前，我在Kotlin应用程序中运行git命令时遇到了一个问题。首先，我使用jGit api直接在我的代码中运行Git。问题是，我需要自己处理所有的认证过程，不管ssh密钥或密码是否已经在我的机器上定义了。这意味着每次有人使用我的工具时，我们都需要读入git帐户的密码和用户名。我发现获得密码作为用户输入的唯一方法是通过console.readPassword()，每次我尝试时这个方法都会抛出一个错误。</p><p id="cbfc" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">需要一个更好的解决方案……而它就在那里。<a class="ae iu" href="https://github.com/lordcodes/turtle" rel="noopener ugc nofollow" target="_blank">乌龟</a></p><h1 id="c1be" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">什么是乌龟</h1><p id="74e1" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">Turtle简化了从Kotlin(或Java)代码运行外部命令和进程的过程。它捆绑了一系列内置功能，如打开MacOS应用程序和处理Git。在Kotlin脚本、命令行应用程序和Gradle任务中轻松运行shell命令尤其有用。</p><h1 id="971f" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">特征</h1><h2 id="3263" class="kw ju hi bd jv kx ky kz jz la lb lc kd jg ld le kh jk lf lg kl jo lh li kp lj bi translated">▶︎用最少的样板文件运行shell命令</h2><p id="c869" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">只需指定comamnd及其参数，就可以轻松运行和检索输出。</p><h2 id="d528" class="kw ju hi bd jv kx ky kz jz la lb lc kd jg ld le kh jk lf lg kl jo lh li kp lj bi translated">▶︎调用任何内置的shell命令</h2><p id="74d9" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">提供了各种命令，比如创建Git提交和打开文件。</p><h2 id="70dd" class="kw ju hi bd jv kx ky kz jz la lb lc kd jg ld le kh jk lf lg kl jo lh li kp lj bi translated">▶︎使用函数语法运行一系列命令</h2><p id="dea1" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">指定在功能块中运行的命令序列。</p><h2 id="6fdd" class="kw ju hi bd jv kx ky kz jz la lb lc kd jg ld le kh jk lf lg kl jo lh li kp lj bi translated">▶︎捕获错误退出代码并输出</h2><p id="1a94" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">当命令产生错误时，退出代码和错误输出将作为异常抛出。</p><p id="fac9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如您所见，这是我直接调用git cli并从我的Kotlin程序中运行这些命令的完美方式。这样，我不需要定义jGit的认证部分，因为这都是由Git本身在您的本地设备上处理的。</p><h1 id="76e4" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">装置</h1><p id="d3c2" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">Turtle在安装过程中非常简单。只需将gradle依赖项添加到build.gradle.kts文件中，我们就可以开始了。</p><h2 id="25e8" class="kw ju hi bd jv kx ky kz jz la lb lc kd jg ld le kh jk lf lg kl jo lh li kp lj bi translated">▶︎·格雷尔·科特林DSL</h2><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="7a96" class="kw ju hi lp b fi lt lu l lv lw">dependencies {<br/>  implementation("com.lordcodes.turtle:turtle:0.5.0")<br/>}</span></pre><h2 id="4254" class="kw ju hi bd jv kx ky kz jz la lb lc kd jg ld le kh jk lf lg kl jo lh li kp lj bi translated">▶︎ Gradle Groovy DSL</h2><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="715f" class="kw ju hi lp b fi lt lu l lv lw">dependencies {<br/>  implementation 'com.lordcodes.turtle:turtle:0.5.0'<br/>}</span></pre><p id="fcba" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">请确保使用最新版本的turtle，因为一些旧版本的问题在最新版本中得到了解决。</p><h1 id="ecec" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">如何使用它</h1><p id="a1f0" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">要运行自定义命令，只需运行shellRun()并提供命令和一些参数(如果需要的话)。</p><figure class="lk ll lm ln fd ij"><div class="bz dy l di"><div class="lx ly l"/></div></figure><p id="f411" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">可以向列表中添加多个参数。请记住，如果应该显示命令的输出以及与cmd行的交互，请打印出命令的输出。</p><h2 id="7815" class="kw ju hi bd jv kx ky kz jz la lb lc kd jg ld le kh jk lf lg kl jo lh li kp lj bi translated">改变工作方向</h2><p id="a00d" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">预先定义命令的工作目录。没有必要一直用cd来做这件事。</p><figure class="lk ll lm ln fd ij"><div class="bz dy l di"><div class="lx ly l"/></div></figure><p id="9d42" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">您可以在命令的参数列表后添加shellLocation。</p><h2 id="af6a" class="kw ju hi bd jv kx ky kz jz la lb lc kd jg ld le kh jk lf lg kl jo lh li kp lj bi translated">运行一系列命令</h2><p id="bfcf" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">它支持在shell块中运行多个shell命令，在shell块中还可以为所有shell命令设置shellLocation。</p><figure class="lk ll lm ln fd ij"><div class="bz dy l di"><div class="lx ly l"/></div></figure><h2 id="c5d1" class="kw ju hi bd jv kx ky kz jz la lb lc kd jg ld le kh jk lf lg kl jo lh li kp lj bi translated">Git命令</h2><p id="9354" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">运行git命令有两个选项:</p><ol class=""><li id="2865" class="lz ma hi ix b iy iz jc jd jg mb jk mc jo md js me mf mg mh bi translated">使用shellRun()命令，并像其他命令一样运行git。</li><li id="0395" class="lz ma hi ix b iy mi jc mj jg mk jk ml jo mm js me mf mg mh bi translated">使用turtle定义的git函数，享受它们的简单性。</li></ol><p id="1b97" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">一些可用的git命令:</p><figure class="lk ll lm ln fd ij"><div class="bz dy l di"><div class="lx ly l"/></div></figure><p id="87dd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">当然，您也可以手动执行所有这些命令，但是这种方式最终会更干净、可读性更好。</p><h2 id="0f46" class="kw ju hi bd jv kx ky kz jz la lb lc kd jg ld le kh jk lf lg kl jo lh li kp lj bi translated">处理文件</h2><p id="0ea1" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">Turtle还提供了一些处理文件的函数。除了你电脑上默认有的工具(nano，vim，mkdir…)，这个可以帮你处理文件。</p><figure class="lk ll lm ln fd ij"><div class="bz dy l di"><div class="lx ly l"/></div></figure><p id="b2f6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">尤其是openApplication()和createSymlink函数，使得创建功能丰富的Kotlin脚本变得更加容易。</p><h1 id="e2d4" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">反射</h1><h2 id="2d37" class="kw ju hi bd jv kx ky kz jz la lb lc kd jg ld le kh jk lf lg kl jo lh li kp lj bi translated">什么进展顺利？</h2><p id="23ab" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">该工具的安装和使用非常方便。文件很好，也很容易理解。我能够很快地使用git命令，并且配置它们很容易。</p><h2 id="ba6b" class="kw ju hi bd jv kx ky kz jz la lb lc kd jg ld le kh jk lf lg kl jo lh li kp lj bi translated">有哪些需要改进的地方？</h2><p id="818d" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">最大的问题是，我完全专注于jGit，对turtle等其他解决方案视而不见。当我最终换成turtle的时候，一切都变得简单直接了。下一次，我会多告诉自己一些不同的解决方案，而不是把自己固定在一个特定的解决方案上。</p><p id="6b98" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我希望这篇文章是有趣的，对你有帮助😃</p></div></div>    
</body>
</html>