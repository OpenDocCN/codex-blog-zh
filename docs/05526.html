<html>
<head>
<title>Buy And Hold Vs SMA Crossover: Big Profits With Simple Strategy</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">买入并持有Vs SMA交叉:简单策略带来丰厚利润</h1>
<blockquote>原文：<a href="https://medium.com/codex/buy-and-hold-vs-sma-crossover-big-profits-with-simple-strategy-92b4a117b50?source=collection_archive---------2-----------------------#2022-03-08">https://medium.com/codex/buy-and-hold-vs-sma-crossover-big-profits-with-simple-strategy-92b4a117b50?source=collection_archive---------2-----------------------#2022-03-08</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="54c9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">股票市场正在蓬勃发展，每个人都想跳上这趟列车创造财富。我敢打赌，这也是把你带到这里的原因，“最佳交易/投资策略”，但是一个简单的谷歌搜索这个报价可以给你一个复杂的交易策略的无底洞，声称是最好的。我们想用传奇投资家沃伦·巴菲特的话来解释这一点，“似乎有某种反常的人类特性，喜欢把简单的事情变得困难。”</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/f047b4054441d00b049471a6546f3899.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5k-9vT5UlSH0J3tT9Q0_9g.jpeg"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">由<a class="ae ju" href="https://unsplash.com/@kellysikkema?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">凯利·西克玛</a>在<a class="ae ju" href="https://unsplash.com/s/photos/stock-market?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="986e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">— — — — — — — — — — <strong class="ih hj">披露:</strong> <em class="jd">本帖内容均不应视为投资建议。过去的结果并不总是预测未来的结果。这些是一些典型的例子，说明如何使用Pandas导入不同时间间隔内的小样本股票数据，并比较它们各自的表现。所有与投资相关的疑问都应提交给你的财务顾问。</em></p><p id="95a5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi">— — — — — — — — — — — — — — — — — — — — — — — — — — — — — —</p><p id="3375" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你训练有素，目标明确，在股市赚钱是很容易的。说起来容易，但是当我们把我们的钱放在风险上时，我们的情感意图经常随着我们的纪律而移动；因此，我们不得不在这个赚钱机器，也就是股票市场中失去我们辛苦赚来的现金。</p><p id="04c0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">算法交易(也称为黑箱交易或算法交易)在现代零售商中越来越受欢迎，以消除情绪管理的障碍。在Algo交易中，计算机程序根据你提供的规则/指令执行买入或卖出指令。</p><p id="700b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">什么是Algo交易？</strong></p><p id="344d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">算法交易是一种基于数学模型识别机会的主动交易的系统方法。数学模型通常基于从股价、成交量、机构买入/卖出、大宗交易等得出的指标。有四种类型的技术指标——动量指标、波动指标和成交量指标，用于预测价格的未来走势。</p><p id="5715" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">算法交易的优势:</strong></p><p id="4c96" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">1)以尽可能好的价格执行</p><p id="21b5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2)即时下单</p><p id="6b2b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3)减少手动错误</p><p id="1db1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">4)减少了由情绪和心理因素引起的错误的可能性。</p><p id="6657" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">5)代码可以很容易地进行回测，并根据回测结果进行细化。</p><p id="ff5b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们打赌你已经对记录所有这些指标感到困惑了，但是正如阿尔伯特·爱因斯坦所说，“天才在于化繁为简”我们将坚持两个最有影响力和最有利可图的策略，并比较两者的结果。</p><h1 id="082e" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">策略1-简单移动平均线(SMA)交叉</h1><p id="65ad" class="pw-post-body-paragraph if ig hi ih b ii kt ik il im ku io ip iq kv is it iu kw iw ix iy kx ja jb jc hb bi translated">移动平均线或滚动平均线是分析时间序列数据最常用的方法之一。它包括从整个数据集的不同子集生成一系列平均值，并用于消除股票表现中的“噪音”。</p><p id="ab23" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">SMA的计算方法是将前“n”个天数的收盘价相加，再除以天数。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es ky"><img src="../Images/3d768629a48582224abb62dc5735e6bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1128/format:webp/1*M0prEpFHssdB8LuK9mY8aw.png"/></div><figcaption class="jq jr et er es js jt bd b be z dx translated">资料来源:<a class="ae ju" href="https://www.investopedia.com/terms/s/sma.asp" rel="noopener ugc nofollow" target="_blank"> Investopedia </a></figcaption></figure><p id="c246" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">SMA交叉策略通常使用两种长度的移动平均线:</p><ol class=""><li id="3c6a" class="kz la hi ih b ii ij im in iq lb iu lc iy ld jc le lf lg lh bi translated"><strong class="ih hj">短移动平均线- </strong>更快的移动平均线，对每日价格变化更敏感</li><li id="b713" class="kz la hi ih b ii li im lj iq lk iu ll iy lm jc le lf lg lh bi translated"><strong class="ih hj">长移动平均线- </strong>较慢的移动平均线，表示较长时期内的价格，更不活跃。</li></ol><p id="3048" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这个例子中，我们将使用50天的短期移动平均线和200天的长期移动平均线。其他流行的短均线和长均线分别是:9日和21日。</p><p id="9c5d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当短均线和长均线交叉时，会产生两个信号:</p><p id="43a1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">买入(买入)信号</strong>——当较短均线超过时，较长均线，即短均线从下方穿越长均线——也称黄金交叉。</p><p id="4484" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">卖出(做空)信号</strong>l——当较长均线超过较短均线时，即空头均线从上方穿越较长均线——也称为死叉。</p><h1 id="3004" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">策略2-买入并持有</h1><p id="3536" class="pw-post-body-paragraph if ig hi ih b ii kt ik il im ku io ip iq kv is it iu kw iw ix iy kx ja jb jc hb bi translated">这是一种被动投资策略，投资者购买一项资产并长期持有。遵循这种策略的交易者/投资者不关心市场和技术指标的短期价格波动。像沃伦·巴菲特和杰克·博格尔这样的投资者是买入并持有策略的拥护者。</p><p id="d7e7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是最容易获得的投资策略之一，我们长期的忠诚和承诺会得到回报。</p><p id="089a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">另一种选择是利用与资产货币价值变化相关的时间序列，而不是实际价值。这些时间序列可能并且确实呈现出负面特征，它们的统计特征通常比价格周期更稳定。最常见的回报是相对回报，其定义为</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es ln"><img src="../Images/4e763974ee36e39720379b5973b4d99c.png" data-original-src="https://miro.medium.com/v2/resize:fit:660/format:webp/1*R9z2wnydX3C5R_jpPbNV0Q.png"/></div><figcaption class="jq jr et er es js jt bd b be z dx translated"><a class="ae ju" href="https://www.investopedia.com/articles/investing/102715/computing-historical-volatility-excel.asp" rel="noopener ugc nofollow" target="_blank">资料来源:Investopedia </a></figcaption></figure><p id="612d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">和日志返回</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es lo"><img src="../Images/a9afa777d04dbd4f008650de25730666.png" data-original-src="https://miro.medium.com/v2/resize:fit:526/format:webp/1*HHPY8-V7Z9ZADtFImj648w.png"/></div><figcaption class="jq jr et er es js jt bd b be z dx translated"><a class="ae ju" href="https://www.investopedia.com/articles/investing/102715/computing-historical-volatility-excel.asp" rel="noopener ugc nofollow" target="_blank">资料来源:Investopedia </a></figcaption></figure><p id="caa5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了以数学方式执行这一策略，我们可以使用log return，它是通过取结束值除以开始值的自然对数来计算的。</p><p id="b767" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用对数回归的优点是:</p><p id="692a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">1)可以跨不同时间段添加日志返回。(另一方面，增加简单的回报可能会误导结果)</p><p id="3fad" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2)对数收益服从正态分布。</p><p id="f497" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3)对数回归可以转换成简单回归。</p><p id="c693" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由于测井返回是累加的，所以可以创建累积测井返回的时间序列。</p><h1 id="6d9e" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">两种策略的详细分析——买入并持有与SMA交叉</h1><p id="dda7" class="pw-post-body-paragraph if ig hi ih b ii kt ik il im ku io ip iq kv is it iu kw iw ix iy kx ja jb jc hb bi translated">要在真实市场中回测或运行策略，我们必须遵循以下结构:</p><p id="fba5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">1)选择股票/共同基金/交易所交易基金/加密货币</p><p id="79c0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2)提取他们的信息(收盘价、成交量等。)对于定义的时间范围内的所选股票</p><p id="860c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3)将数据可视化，以便更好地理解</p><p id="f3c8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">4)运行和比较数学模型</p><p id="221a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了在我们上面提到的两个策略中选出一个赢家，我们将从制作股票投资组合开始。</p><p id="cdd4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">这个投资组合中使用的股票有:</strong> (AMD)高级微设备公司，(谷歌)谷歌，(WST)西制药服务公司，(DXCM)德克斯康公司(葡萄糖监测)，(NVDA)英伟达公司，(AAPL)苹果公司，(AMZN)亚马逊，(MSFT)微软，(NFLX)网飞，(TSLA)特斯拉</p><p id="304f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">导入库:</p><pre class="jf jg jh ji fd lp lq lr ls aw lt bi"><span id="213a" class="lu jw hi lq b fi lv lw l lx ly">import numpy as np<br/>import pandas as pd<br/>from datetime import date<br/>!pip install yfinance <br/>import matplotlib.pyplot as plt<br/>import yfinance as yf<br/>%matplotlib inline</span></pre><p id="88e9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们要用雅虎财经！我们将提取2020年至2022年期间的收盘价</p><pre class="jf jg jh ji fd lp lq lr ls aw lt bi"><span id="b58d" class="lu jw hi lq b fi lv lw l lx ly">#choose starting date<br/>start_date = '2020-01-01'<br/>end_date= '2022-01-01'<br/>#if using a current date as end date<br/>#end_date=date.today().strftime("%Y-%m-%d")<br/>symbol =['AMD','GOOGL','WST','DXCM','NVDA','AAPL','AMZN','NFLX','TSLA','MSFT']#stock portfolio<br/>df = yf.download(symbol, start=start_date, end = end_date)['Close'] #getting only Closing price values <br/>df.head()</span></pre><p id="0623" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里我们将显示整个投资组合的前五行收盘价</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lz"><img src="../Images/05eaf494dd32086026a48449ee289f04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wxqlJQbDKt6AIlPGTnZnYQ.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">收盘价格</figcaption></figure><p id="dd82" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">可视化数据:</strong></p><p id="b0f2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当我们有时间序列数据时，我们可以在图表上绘制数据，使价格模式和趋势可以直观地识别。</p><p id="8e14" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这里，我们使用Matplotlib库来显示收盘价的变动，从中我们可以立即了解特定股票在一段时间内的表现是否良好。</p><pre class="jf jg jh ji fd lp lq lr ls aw lt bi"><span id="8ee1" class="lu jw hi lq b fi lv lw l lx ly">#Charting the stock prices for multiple stocks<br/>fig = plt.figure(figsize=(16,12))<br/>ax1 = fig.add_subplot(4,3,1)<br/>ax2 = fig.add_subplot(4,3,2)<br/>ax3 = fig.add_subplot(4,3,3)<br/>ax4 = fig.add_subplot(4,3,4)<br/>ax5 = fig.add_subplot(4,3,5)<br/>ax6 = fig.add_subplot(4,3,6)<br/>ax7 = fig.add_subplot(4,3,7)<br/>ax8 = fig.add_subplot(4,3,8)<br/>ax9 = fig.add_subplot(4,3,9)<br/>ax10 = fig.add_subplot(4,3,10)<br/>ax1.plot(df['AMZN'])<br/>ax1.set_title("Amazon")<br/>ax2.plot(df['AMD'])<br/>ax2.set_title("AMD")<br/>ax3.plot(df['GOOGL'])<br/>ax3.set_title("Google")<br/>ax4.plot(df['NFLX'])<br/>ax4.set_title("Netflix")<br/>ax5.plot(df['WST'])<br/>ax5.set_title("WST")<br/>ax6.plot(df['DXCM'])<br/>ax6.set_title("DXCM")<br/>ax7.plot(df['NVDA'])<br/>ax7.set_title("NVDA")<br/>ax8.plot(df['TSLA'])<br/>ax8.set_title("Tesla")<br/>ax9.plot(df['AAPL'])<br/>ax9.set_title("AAPL")<br/>ax10.plot(df['MSFT'])<br/>ax10.set_title("MSFT")<br/>plt.tight_layout()<br/># save the figure<br/>plt.savefig('Stock Price Movement.png')#format="png")<br/>plt.show()</span></pre><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ma"><img src="../Images/4335b04873efbb4cc7f6275f5f6fbf20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k0qIYhYVOaDRRrPwS_D5XA.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">股票价格变动(作者照片)</figcaption></figure><p id="eebd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 1。分析AMD股票</strong></p><p id="335d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了简单起见，我们将只在一只股票上测试我们的策略:高级微设备公司(股票代码:AMD)，然后应用于整个投资组合。</p><p id="d32c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将定义简单移动平均线的值:对于短期移动平均线，我们将使用50天，对于长期移动平均线，我们将使用200天。</p><p id="52db" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了计算移动平均，我们使用Pandas内置函数rolling(window='n ')。mean(我们可以用天数代替“n”。)</p><pre class="jf jg jh ji fd lp lq lr ls aw lt bi"><span id="e83e" class="lu jw hi lq b fi lv lw l lx ly"># Get the AMD timeseries.<br/>AMD = df.loc[:, 'AMD']<br/># Calculate the 50 and 200 days moving averages of the closing prices<br/>short_rolling_AMD= AMD.rolling(window=50, min_periods=1).mean()#min_periods calculate the arithmetic average starting from 1st numb <br/>long_rolling_AMD = AMD.rolling(window=200, min_periods=1).mean()</span></pre><p id="88dd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，我们用附加信息为AMD股票创建数据框架:信号和位置，使用每日日志回报计算回报率，并计算买入和持有策略的总交易系统回报。</p><p id="c01a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="jd">信号</em> </strong>列生成如下:如果50天SMA大于200天SMA，则设置值1，如果200天SMA大于50天SMA，则设置值0。</p><p id="cf64" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"><em class="jd"/></strong>'列是日差的‘信号’列</p><p id="f719" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="jd">交易'</em> </strong>栏的生成与信号相同，只是当200日SMA比50日SMA&gt;时，将值设置为-1而不是0。</p><p id="e681" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="jd"> Return </em> </strong>列是使用log return生成的，其中首先取价格的对数，然后取连续日志观察值的差值。</p><p id="428d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"><em class="jd">t Return</em></strong>’列是总回报，通过将‘Return’和‘Trade’列相乘来计算。</p><pre class="jf jg jh ji fd lp lq lr ls aw lt bi"><span id="3628" class="lu jw hi lq b fi lv lw l lx ly">#creating df for AMD stock<br/>AMD=pd.DataFrame ({'Close':df['AMD'],'50_MA':short_rolling_AMD,'200_MA':long_rolling_AMD})<br/>#generate signals<br/>AMD['Signal']=np.where(AMD['50_MA']&gt; AMD['200_MA'], 1, 0)<br/>#generate trading orders<br/>AMD['Position']=AMD['Signal'].diff()<br/>#calculating trading<br/>AMD['Trade'] = np.where(AMD['50_MA']&gt; AMD['200_MA'], 1, -1)<br/>#to calculate instantaneous rate of return (daily log returns)<br/>AMD['Return'] = np.log(AMD.Close).diff()<br/>#calculating trading system return<br/>AMD['Treturn']=AMD.Return*AMD.Trade<br/>AMD.head(100)</span></pre><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mb"><img src="../Images/b6466075cdf577c46d9e9305fce788ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S3dufihs-V563_vIUTZ1XQ.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">AMD DataFrame(作者提供照片)</figcaption></figure><p id="c47b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，我们可以可视化买卖点的交易策略。买入信号是绿色，卖出信号是红色。</p><pre class="jf jg jh ji fd lp lq lr ls aw lt bi"><span id="88c0" class="lu jw hi lq b fi lv lw l lx ly"># Plot moving averages <br/># plot closing price, short term moving averages and long term moving averages <br/>plt.figure(figsize=(20,10))<br/>AMD['Close'].plot(color = 'k', label= 'Closing Price') <br/>AMD['50_MA'].plot(color = 'm',label = '50 days rolling mean') <br/>AMD['200_MA'].plot(color = 'g', label = '200 days rolling mean')<br/># plot ‘buy’ signals<br/>plt.scatter(AMD.loc[AMD['Position'] == 1].index, <br/>         AMD['50_MA'][AMD['Position'] == 1], <br/>         marker='^', s=250,color = 'g', label = 'BUY signal')<br/># plot ‘sell’ signals<br/>plt.scatter(AMD.loc[AMD['Position'] == -1].index, <br/>         AMD['50_MA'][AMD['Position'] == -1], <br/>         marker='v',s=250, color = 'r', label = 'SELL signal')<br/>plt.title('AMD Buy and Sell signals')<br/>plt.xlabel('Date')<br/>plt.ylabel(' Closing price ($)')<br/>plt.savefig('AMD buying and selling signals.png')<br/>#plt.show()<br/>plt.legend();</span></pre><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mc"><img src="../Images/149acc147500c435543a4cf1d6939bcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F2kEug_nNlswsppc3Q2nVA.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">AMD买卖信号(作者图片)</figcaption></figure><p id="5c71" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们要对两种策略的回报求和:</p><pre class="jf jg jh ji fd lp lq lr ls aw lt bi"><span id="1e84" class="lu jw hi lq b fi lv lw l lx ly">#trading system return<br/>total_treturn=np.exp(AMD.Treturn.sum())#total return of moving averages trading system<br/>#Buy and hold return <br/>hold_return=np.exp(AMD.Return.sum())#total return of buy and hold strategy</span><span id="e768" class="lu jw hi lq b fi md lw l lx ly">print("AMD Trading System total return: {:&gt;10.2%}".format(total_treturn))<br/>print("AMD Hold strategy return: {:&gt;10.2%}".format(hold_return))</span></pre><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es me"><img src="../Images/89836789ee29fae653413fa317584919.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bzDzbRGY2dIH4LgKmr76IA.png"/></div></div></figure><p id="f9ff" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">结果我们可以看到持有策略的回报率为293.08%，而交易策略的回报率为141.76%。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mf"><img src="../Images/b595345aadba58923f709d74dee179cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pBxAjJN2eg96YepUMk2Q1Q.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">AMD交易系统vs买入并持有回报(作者图片)</figcaption></figure><p id="6188" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 2。分析投资组合回报</strong></p><p id="039d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这一部分，我们将分析整个投资组合的回报。从计算短均线和长均线开始，创建交易柱</p><pre class="jf jg jh ji fd lp lq lr ls aw lt bi"><span id="cc23" class="lu jw hi lq b fi lv lw l lx ly"># Calculating the short-window moving average for entire portfolio<br/>short_rolling= df.rolling(window=50,min_periods=1).mean()<br/>df_short = short_rolling.add_suffix('_short')<br/># Calculating the long-window moving average for entire portfolio<br/>long_rolling = df.rolling(window=200,min_periods=1).mean()<br/>df_long = long_rolling.add_suffix('_long')<br/>#to join two tables into one df <br/>new_df=pd.concat([df_short,df_long],axis=1)</span><span id="7a99" class="lu jw hi lq b fi md lw l lx ly">#calculating trading for entire portfolio<br/>new_df['AMD_Trade'] = np.where(new_df['AMD_short']&gt; new_df['AMD_long'], 1, -1)<br/>new_df['AMZN_Trade'] = np.where(new_df['AMZN_short']&gt; new_df['AMZN_long'], 1, -1)<br/>new_df['AAPL_Trade'] = np.where(new_df['AAPL_short']&gt; new_df['AAPL_long'], 1, -1)<br/>new_df['DXCM_Trade'] = np.where(new_df['DXCM_short']&gt; new_df['DXCM_long'], 1, -1)<br/>new_df['MSFT_Trade'] = np.where(new_df['MSFT_short']&gt; new_df['MSFT_long'], 1, -1)<br/>new_df['NFLX_Trade'] = np.where(new_df['NFLX_short']&gt; new_df['NFLX_long'], 1, -1)<br/>new_df['NVDA_Trade'] = np.where(new_df['NVDA_short']&gt; new_df['NVDA_long'], 1, -1)<br/>new_df['TSLA_Trade'] = np.where(new_df['TSLA_short']&gt; new_df['TSLA_long'], 1, -1)<br/>new_df['WST_Trade'] = np.where(new_df['WST_short']&gt; new_df['WST_long'], 1, -1)<br/>new_df['GOOGL_Trade'] = np.where(new_df['GOOGL_short']&gt; new_df['GOOGL_long'], 1, -1)</span><span id="5d1e" class="lu jw hi lq b fi md lw l lx ly"># creating return column<br/>log_returns = np.log(df).diff()<br/>df_return= log_returns.add_suffix('_Return')<br/>new_df=pd.concat([df_return,new_df],axis=1)</span><span id="a876" class="lu jw hi lq b fi md lw l lx ly">#remove NA values<br/>new_df.dropna(inplace=True)</span><span id="7194" class="lu jw hi lq b fi md lw l lx ly">#calculating instatenious rate of return<br/>new_df['AMD_Treturn']=new_df.AMD_Return*new_df.AMD_Trade<br/>AMD_total_treturn=np.exp(new_df.AMD_Treturn.sum())<br/>print('AMD_total_treturn is:',AMD_total_treturn)<br/>new_df['AMZN_Treturn']=new_df.AMZN_Return*new_df.AMZN_Trade<br/>AMZN_total_treturn=np.exp(new_df.AMZN_Treturn.sum())<br/>print('AMZN_total_treturn is:',AMZN_total_treturn)<br/>new_df['AAPL_Treturn']=new_df.AAPL_Return*new_df.AAPL_Trade<br/>AAPL_total_treturn=np.exp(new_df.AAPL_Treturn.sum())<br/>print('AAPL_total_treturn is:',AAPL_total_treturn)<br/>new_df['DXCM_Treturn']=new_df.DXCM_Return*new_df.DXCM_Trade<br/>DXCM_total_treturn=np.exp(new_df.DXCM_Treturn.sum())<br/>print('DXCM_total_treturn is:',DXCM_total_treturn)<br/>new_df['MSFT_Treturn']=new_df.MSFT_Return*new_df.MSFT_Trade<br/>MSFT_total_treturn=np.exp(new_df.MSFT_Treturn.sum())<br/>print('MSFT_total_treturn is:',MSFT_total_treturn)<br/>new_df['NFLX_Treturn']=new_df.NFLX_Return*new_df.NFLX_Trade<br/>NFLX_total_treturn=np.exp(new_df.NFLX_Treturn.sum())<br/>print('NFLX_total_treturn is:',NFLX_total_treturn)<br/>new_df['NVDA_Treturn']=new_df.NVDA_Return*new_df.NVDA_Trade<br/>NVDA_total_treturn=np.exp(new_df.NVDA_Treturn.sum())<br/>print('NVDA_total_treturn is:',NVDA_total_treturn)<br/>new_df['TSLA_Treturn']=new_df.TSLA_Return*new_df.TSLA_Trade<br/>TSLA_total_treturn=np.exp(new_df.TSLA_Treturn.sum())<br/>print('TSLA_total_treturn is:',TSLA_total_treturn)<br/>new_df['WST_Treturn']=new_df.WST_Return*new_df.WST_Trade<br/>WST_total_treturn=np.exp(new_df.WST_Treturn.sum())<br/>print('WST_total_treturn is:',WST_total_treturn)<br/>new_df['GOOGL_Treturn']=new_df.GOOGL_Return*new_df.GOOGL_Trade<br/>GOOGL_total_treturn=np.exp(new_df.GOOGL_Treturn.sum())<br/>print('GOOGL_total_treturn is;',GOOGL_total_treturn)</span></pre><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mg"><img src="../Images/64ee28e1784b8a675d4c26e2139a73c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lPoAmgrgM4h-FfPY3KWZ_A.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">交易策略回报(作者图片)</figcaption></figure><pre class="jf jg jh ji fd lp lq lr ls aw lt bi"><span id="3eb4" class="lu jw hi lq b fi lv lw l lx ly">treturns_total = [AMD_total_treturn,AMZN_total_treturn,AAPL_total_treturn,DXCM_total_treturn,MSFT_total_treturn,NFLX_total_treturn,NVDA_total_treturn,TSLA_total_treturn,WST_total_treturn,GOOGL_total_treturn]</span><span id="2d86" class="lu jw hi lq b fi md lw l lx ly">potrfolio_trade_strategy = sum(treturns_total) / len(treturns_total)<br/>print("Portfolio return using trade strategy: {:&gt;10.2%}".format(potrfolio_trade_strategy))</span></pre><p id="cb6a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">计算买入并持有策略的回报:</p><pre class="jf jg jh ji fd lp lq lr ls aw lt bi"><span id="70d1" class="lu jw hi lq b fi lv lw l lx ly">#calculating stock return hold strategy  <br/>log_returns_stock=np.exp(log_returns.sum())#total return of hold strategy<br/>log_returns_stock</span></pre><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es mh"><img src="../Images/34a21617b35658a5098445c40437499e.png" data-original-src="https://miro.medium.com/v2/resize:fit:824/format:webp/1*zXKw-SYWmIgO2bkAn-6O3A.png"/></div><figcaption class="jq jr et er es js jt bd b be z dx translated">购买并持有退货</figcaption></figure><pre class="jf jg jh ji fd lp lq lr ls aw lt bi"><span id="6b0c" class="lu jw hi lq b fi lv lw l lx ly">portfolio_return=log_returns_stock.mean(axis=0)<br/>print("Portfolio return using hold strategy: {:&gt;10.2%}".format(portfolio_return))</span><span id="7f53" class="lu jw hi lq b fi md lw l lx ly">Portfolio return using trade strategy:    241.10%</span></pre><p id="def1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以看到，买入并持有策略表现更好，年回报率为358%，而交易策略的回报率为241%。</p><p id="adf2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以用买入并持有策略来想象每只股票的回报。</p><pre class="jf jg jh ji fd lp lq lr ls aw lt bi"><span id="b36a" class="lu jw hi lq b fi lv lw l lx ly">fig, ax= plt.subplots(figsize=(20,10))<br/>for c in log_returns:<br/>    ax.plot(log_returns.index, 100*(np.exp(log_returns[c].cumsum()) - 1), label=str(c))</span><span id="217c" class="lu jw hi lq b fi md lw l lx ly">ax.set_ylabel('Total relative returns (%)')<br/>ax.set_xlabel('Time period')<br/>ax.set_title('Portfolio return using hold strategy')<br/>ax.legend(loc='best')<br/>plt.show()</span></pre><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mi"><img src="../Images/892ee8dc6da9ad80bb7aff5c0fe14c76.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*66yhqhA33Jqj3UaGwjCcaw.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">采用买入并持有策略的投资组合回报(作者提供图片)</figcaption></figure><p id="1bef" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">此外，收集的回报信息用于风险分析，风险分析是根据预期回报(股票的平均回报)和标准差(风险衡量-&gt;标准差越大，风险越大，反之亦然)计算的。</p><pre class="jf jg jh ji fd lp lq lr ls aw lt bi"><span id="608f" class="lu jw hi lq b fi lv lw l lx ly">returns = log_returns #using log_return <br/>plt.figure(figsize=(20,10)) <br/>plt.scatter(returns.mean(), returns.std())<br/>plt.xlabel('Expected returns')<br/>plt.ylabel('Risk')<br/>plt.title('Risk vs.Expected Return')<br/>for label, x, y in zip(returns.columns, returns.mean(), returns.std()):<br/>    plt.annotate(<br/>        label, <br/>        xy = (x, y), xytext = (50, 30),<br/>        textcoords = 'offset points', ha = 'right', va = 'bottom',<br/>        arrowprops = dict(arrowstyle = '-', connectionstyle = 'arc3,rad=0.5'))</span></pre><p id="52b7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">创建了一个散点图来比较股票的预期收益和风险。这有助于我们直观地了解各种股票的风险系数。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mj"><img src="../Images/fed84f48b0c1d01fd398e97e712504a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VHUrQZJjbk1uQDs750dDhg.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">风险与预期回报(作者提供图片)</figcaption></figure><p id="bcb4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从这个散点图我们可以得出结论，TSLA有最高的预期收益和最高的风险。另一方面，AMZN具有最小的预期收益和最小的风险。</p><h1 id="1c5f" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated"><strong class="ak">哪种策略更赚钱？</strong></h1><p id="6cfa" class="pw-post-body-paragraph if ig hi ih b ii kt ik il im ku io ip iq kv is it iu kw iw ix iy kx ja jb jc hb bi translated">在测试了这两种策略后，我们可以得出结论,<em class="jd">买入并持有</em>在AMD股票和整个投资组合上的表现优于交易策略。</p><p id="0140" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但请记住，“就像没有一种尺寸的t恤适合所有人一样，同样也没有一种策略适合所有资产类别。”上面分享的结果是AMD的股票，它可能与AAPL的股票(或你投资组合中的任何其他股票)不一致。</p><p id="d332" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们需要在两种策略下测试每只投资组合股票的表现，然后选择能产生最佳回报的策略。</p><p id="4e7d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">参考资料:</p><ol class=""><li id="e1f9" class="kz la hi ih b ii ij im in iq lb iu lc iy ld jc le lf lg lh bi translated">雅虎<a class="ae ju" href="https://finance.yahoo.com/" rel="noopener ugc nofollow" target="_blank">财经</a>！</li><li id="bd02" class="kz la hi ih b ii li im lj iq lk iu ll iy lm jc le lf lg lh bi translated"><a class="ae ju" href="https://www.investopedia.com/technical-analysis-4689657" rel="noopener ugc nofollow" target="_blank">投资媒体</a></li><li id="77ae" class="kz la hi ih b ii li im lj iq lk iu ll iy lm jc le lf lg lh bi translated">米（meter的缩写））Heydt，<a class="ae ju" href="https://www.packtpub.com/product/learning-pandas-second-edition/9781787123137" rel="noopener ugc nofollow" target="_blank">学习熊猫-第二版</a> (2017)</li></ol><p id="9242" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Jupyter笔记本的详细代码可以在这里找到:</p><div class="mk ml ez fb mm mn"><a href="https://github.com/sivosevic/TimeSeriesAnalysis-" rel="noopener  ugc nofollow" target="_blank"><div class="mo ab dw"><div class="mp ab mq cl cj mr"><h2 class="bd hj fi z dy ms ea eb mt ed ef hh bi translated">GitHub-sivosevic/times eries分析-:股票市场</h2><div class="mu l"><h3 class="bd b fi z dy ms ea eb mt ed ef dx translated">这个项目的目的是建立股票投资组合，从网上股票交易网站提取信息…</h3></div><div class="mv l"><p class="bd b fp z dy ms ea eb mt ed ef dx translated">github.com</p></div></div><div class="mw l"><div class="mx l my mz na mw nb jo mn"/></div></div></a></div><p id="a2e6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你可以在https://medium.com/@eellaaivo的<a class="ae ju" rel="noopener" href="/@eellaaivo">查看我的其他作品</a></p><p id="95d7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">感谢阅读！</p></div></div>    
</body>
</html>