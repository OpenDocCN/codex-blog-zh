<html>
<head>
<title>OSGI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">奥斯吉</h1>
<blockquote>原文：<a href="https://medium.com/codex/osgi-4a4656908a64?source=collection_archive---------11-----------------------#2022-06-11">https://medium.com/codex/osgi-4a4656908a64?source=collection_archive---------11-----------------------#2022-06-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/a83297b9fd2d4c923725359e16f40af3.png" data-original-src="https://miro.medium.com/v2/resize:fit:524/format:webp/0*fyOE8LKBj61skmKY.jpeg"/></div></figure><p id="057d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">首先让我们看看OSGi代表什么。OSGi代表<strong class="io hj">开放服务网关倡议</strong>。这基本上为用Java动态开发和部署模块化应用程序和库提供了一个架构。</p><figure class="jk jl jm jn fd ij er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es et"><img src="../Images/32f35c76ce21f62f6ba1235e4fe1d06c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*WK_yNqST8qSmOcWp"/></div></div><figcaption class="js jt et er es ju jv bd b be z dx translated">来源:<a class="ae jw" href="https://piraveenaparalogarajah.medium.com/osgi-in-a-nutshell-aafc3a86cff0" rel="noopener">https://piraveenaparalogarajah . medium . com/OSGi-in-a-through-aafc 3a 86 CFF 0</a></figcaption></figure><p id="7327" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在模块化应用程序中，其中的类将被封装在模块的逻辑边界内。对外公开使用的类和外部导入的类应分别在模块pom文件的<export-package>和<import-package>标签中定义。如果这没有给你太多的想法，它将在后面的部分讨论。</import-package></export-package></p><figure class="jk jl jm jn fd ij er es paragraph-image"><div class="er es jx"><img src="../Images/8bbaa826458fe0d24ab56be04350f440.png" data-original-src="https://miro.medium.com/v2/resize:fit:562/0*R0FIvF4iiuBvUrK5"/></div><figcaption class="js jt et er es ju jv bd b be z dx translated">来源:https://thiloshon . WordPress . com/2020/03/04/OSGi-for-dummies/</figcaption></figure><pre class="jk jl jm jn fd jy jz ka kb aw kc bi"><span id="1a06" class="kd ke hi jz b fi kf kg l kh ki">&lt;project ...&gt;  <br/>    &lt;groupId&gt;org.wso2.mbp&lt;/groupId&gt; <br/>    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;<br/>    &lt;artifactId&gt;sample01&lt;/artifactId&gt;<br/>    &lt;version&gt;1.0.0&lt;/version&gt;<br/>    &lt;packaging&gt;bundle&lt;/packaging&gt; <br/>    &lt;name&gt;Sample01&lt;/name&gt;  <br/>    &lt;description&gt;A Simple Bundle which print "Hello World" and "Goodbye World"&lt;/description&gt;<br/>    &lt;url&gt;https://www.wso2.org&lt;/url&gt;<br/>    &lt;build&gt;<br/>        &lt;plugins&gt;<br/>            &lt;plugin&gt;<br/>                &lt;groupId&gt;org.apache.felix&lt;/groupId&gt;<br/>                &lt;artifactId&gt;maven-bundle-plugin&lt;/artifactId&gt;<br/>                &lt;version&gt;1.4.0&lt;/version&gt;<br/>                &lt;extensions&gt;true&lt;/extensions&gt;<br/>                &lt;configuration&gt;<br/>                    &lt;instructions&gt;<br/>                        &lt;Bundle-SymbolicName&gt;${pom.groupId}.${pom.artifactId}&lt;/Bundle-SymbolicName&gt;<br/>                        &lt;Bundle-Name&gt;${pom.name}&lt;/Bundle-Name&gt;<br/>                        &lt;Bundle-Version&gt;${pom.version}&lt;/Bundle-Version&gt;<br/>                        &lt;Bundle-Activator&gt;org.wso2.mbp.sample01.Activator&lt;/Bundle-Activator&gt;<br/>                        &lt;Private-Package&gt;org.wso2.mbp.sample01&lt;/Private-Package&gt;<br/>                    &lt;/instructions&gt;<br/>                &lt;/configuration&gt;<br/>            &lt;/plugin&gt;<br/>        &lt;/plugins&gt;<br/>    &lt;/build&gt;<br/>    &lt;dependencies&gt;<br/>        &lt;dependency&gt;<br/>            &lt;groupId&gt;org.apache.felix&lt;/groupId&gt;<br/>            &lt;artifactId&gt;org.osgi.core&lt;/artifactId&gt;<br/>        &lt;/dependency&gt;<br/>    &lt;/dependencies&gt;<br/>&lt;/project&gt;</span></pre><p id="fd96" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">上面的代码片段来自sample01模块的pom.xml，其中包括关于项目的信息和Maven用来构建项目的配置细节。</p><p id="8721" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">基于pom文件中的这些指令，包插件决定在构建时应该复制到包中的类和资源。pom文件的配置将在下面讨论。</p><p id="08ac" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> &lt;打包&gt;捆绑&lt;/打包&gt; </strong>，配置maven构建OSGI捆绑。</p><p id="ad5c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">那么包的导出和导入将在下面讨论。</p><p id="597c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">使用Export-Package指令可以指定要导出的包的列表。从包中导出包将取决于值的模式。</p><blockquote class="kj kk kl"><p id="d2c6" class="im in km io b ip iq ir is it iu iv iw kn iy iz ja ko jc jd je kp jg jh ji jj hb bi translated"><strong class="io hj"> &lt;出口包&gt;org . WSO 2 . MBP . echo&lt;/出口包&gt; </strong></p><p id="d7d9" class="im in km io b ip iq ir is it iu iv iw kn iy iz ja ko jc jd je kp jg jh ji jj hb bi translated">上述包中的类将被复制到一个目标包中。</p><p id="2a95" class="im in km io b ip iq ir is it iu iv iw kn iy iz ja ko jc jd je kp jg jh ji jj hb bi translated"><strong class="io hj"> &lt;导出包&gt;org . WSO 2 . MBP . echo . *&lt;/导出包&gt; </strong></p><p id="6c73" class="im in km io b ip iq ir is it iu iv iw kn iy iz ja ko jc jd je kp jg jh ji jj hb bi translated">上述包中的类和所有子包中的类将被复制到目标包中。</p><p id="388a" class="im in km io b ip iq ir is it iu iv iw kn iy iz ja ko jc jd je kp jg jh ji jj hb bi translated"><strong class="io hj">&lt;Export-Package&gt;org . wso2 . MBP . echo . *，！org . WSO 2 . MBP . echo . string&lt;/Export-Package&gt;</strong></p><p id="cd6c" class="im in km io b ip iq ir is it iu iv iw kn iy iz ja ko jc jd je kp jg jh ji jj hb bi translated">"由于包列表是有序的，所以较早的模式在较晚的模式之前生效。因此，所有与模式org.wso2.mbp.echo.*匹配的包都被选择来包含目标包。第二种模式没有效果，因为org.wso2.carbon.mbp.echo.*包已经被选择包含在内。实现预期结果的正确方法是改变模式的顺序。”</p></blockquote><p id="3aee" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">当一个包中的类引用其他包中的类时，应该使用Import-Package指令来指定。该指令的默认值为“*”。价值观及其行为的模式如下。</p><blockquote class="kj kk kl"><p id="143e" class="im in km io b ip iq ir is it iu iv iw kn iy iz ja ko jc jd je kp jg jh ji jj hb bi translated"><strong class="io hj"> &lt;导入包&gt;org . WSO 2 . MBP . export sample . *&lt;/导入包&gt; </strong></p><p id="ecfb" class="im in km io b ip iq ir is it iu iv iw kn iy iz ja ko jc jd je kp jg jh ji jj hb bi translated">导入org.wso2.mbp.exportsample包及其所有子包中的类。</p><p id="5332" class="im in km io b ip iq ir is it iu iv iw kn iy iz ja ko jc jd je kp jg jh ji jj hb bi translated"><strong class="io hj"> &lt;导入-打包&gt;！org.wso2.carbon.ui，org . WSO 2 . MBP . export sample . *&lt;/Import-Package&gt;</strong></p><p id="2bcf" class="im in km io b ip iq ir is it iu iv iw kn iy iz ja ko jc jd je kp jg jh ji jj hb bi translated">使用否定模式，可以删除不需要的org.wso2.carbon.ui包的导入。</p><p id="b1ce" class="im in km io b ip iq ir is it iu iv iw kn iy iz ja ko jc jd je kp jg jh ji jj hb bi translated"><strong class="io hj"> &lt;进口-包装&gt; </strong></p><p id="38e0" class="im in km io b ip iq ir is it iu iv iw kn iy iz ja ko jc jd je kp jg jh ji jj hb bi translated"><strong class="io hj"> org.wso2.mbp.exportsample.*，</strong></p><p id="adaa" class="im in km io b ip iq ir is it iu iv iw kn iy iz ja ko jc jd je kp jg jh ji jj hb bi translated"><strong class="io hj">org . WSO 2 . carbon . ui；分辨率:=可选</strong></p><p id="74eb" class="im in km io b ip iq ir is it iu iv iw kn iy iz ja ko jc jd je kp jg jh ji jj hb bi translated"><strong class="io hj">&lt;/导入-打包&gt; </strong></p><p id="5d9d" class="im in km io b ip iq ir is it iu iv iw kn iy iz ja ko jc jd je kp jg jh ji jj hb bi translated">Resolution指令用于指示包org.wso2.carbon.ui是可选的。即使org.wso2.carbon.ui不存在，这个包也可以成功解析。resolution指令的默认值是“mandatory”。</p></blockquote><p id="87b9" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在让我们试着去理解<strong class="io hj"> OSGi框架</strong>。</p><p id="7abe" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">OSGI服务平台由OSGi框架和OSGi标准服务两部分组成。该框架提供了OSGi功能，而OSGi标准服务为常见任务定义了可重用的API。</p><p id="d461" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">OSGi框架具有如下的分层架构。</p><figure class="jk jl jm jn fd ij er es paragraph-image"><div class="er es kq"><img src="../Images/0aa09cb166565d676001ecd44368ec6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/0*tLKBNrzq3dv49qMp"/></div><figcaption class="js jt et er es ju jv bd b be z dx translated">来源:<a class="ae jw" href="https://www.wikiwand.com/en/OSGi" rel="noopener ugc nofollow" target="_blank">https://www.wikiwand.com/en/OSGi</a></figcaption></figure><p id="47fe" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在深入研究这些层之前，如果对图中所示的每个区域进行简单介绍，那么捆绑包通常是具有额外清单头的JAR组件，服务层以动态方式连接捆绑包，服务注册是用于管理服务的API，生命周期是用于捆绑包的生命周期管理的API，模块层定义封装和依赖性声明。</p><p id="1927" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在让我们讨论捆绑包、服务和生命周期层。</p><h1 id="e772" class="kr ke hi bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated"><strong class="ak">捆绑层</strong></h1><p id="50b4" class="pw-post-body-paragraph im in hi io b ip lo ir is it lp iv iw ix lq iz ja jb lr jd je jf ls jh ji jj hb bi translated">如上所述，OSGI应用程序由导出和导入包等的多个包组成。OSGI包是一个带有额外元数据的JAR文件。因此，当jar文件被转换成包时，应该为清单添加元数据。MF文件。</p><figure class="jk jl jm jn fd ij er es paragraph-image"><div class="er es lt"><img src="../Images/5a19f769ac44fb6c5faa3fd7a85c89f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:608/0*Lh1RCZcFeihbYUDZ"/></div><figcaption class="js jt et er es ju jv bd b be z dx translated"><a class="ae jw" href="http://www.liferaysavvy.com/2017/09/osgi-bundle-manifest-headers.html" rel="noopener ugc nofollow" target="_blank">http://www . liferaysavvy . com/2017/09/OSGi-bundle-manifest-headers . html</a></figcaption></figure><h1 id="d0a5" class="kr ke hi bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated"><strong class="ak">服务层</strong></h1><p id="9bda" class="pw-post-body-paragraph im in hi io b ip lo ir is it lp iv iw ix lq iz ja jb lr jd je jf ls jh ji jj hb bi translated">服务层提供了包之间的交互。</p><figure class="jk jl jm jn fd ij er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es lu"><img src="../Images/5b4e8f20bef6c4d052e39619c5778875.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ts_AQbRXnXSVuNm9"/></div></div><figcaption class="js jt et er es ju jv bd b be z dx translated"><a class="ae jw" href="https://www.researchgate.net/publication/321705781_Immersive_Exploration_of_OSGi_Based_Software_Architectures_in_Virtual_Reality" rel="noopener ugc nofollow" target="_blank">https://www . research gate . net/publication/321705781 _ Immersive _ Exploration _ of _ OSGi _ Based _ Software _ Architectures _ in _ Virtual _ Reality</a></figcaption></figure><figure class="jk jl jm jn fd ij er es paragraph-image"><div class="er es lv"><img src="../Images/6a3213e3df834b16ccf41ff6506bafef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1052/0*SKycxLBjASQrUNEQ"/></div><figcaption class="js jt et er es ju jv bd b be z dx translated"><a class="ae jw" href="https://piraveenaparalogarajah.medium.com/osgi-in-a-nutshell-aafc3a86cff0" rel="noopener">https://piraveenaparalogarajah . medium . com/OSGi-in-a-shell-aafc 3a 86 CFF 0</a></figcaption></figure><h1 id="6575" class="kr ke hi bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated"><strong class="ak">生命周期层</strong></h1><p id="9e50" class="pw-post-body-paragraph im in hi io b ip lo ir is it lp iv iw ix lq iz ja jb lr jd je jf ls jh ji jj hb bi translated">生命周期层提供运行时模块(包)管理。</p><figure class="jk jl jm jn fd ij er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es lw"><img src="../Images/e5fd1565bfbe0db835db7093fd024be3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*1IO2FOah0je3IGeA"/></div></div></figure><p id="b371" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">生命周期状态可以标识如下:</p><blockquote class="kj kk kl"><p id="9c5f" class="im in km io b ip iq ir is it iu iv iw kn iy iz ja ko jc jd je kp jg jh ji jj hb bi translated"><strong class="io hj">已安装</strong> —安装已成功完成。但是，在这种状态下，不进行依赖或类加载。</p><p id="7cb6" class="im in km io b ip iq ir is it iu iv iw kn iy iz ja ko jc jd je kp jg jh ji jj hb bi translated"><strong class="io hj">已解决</strong> —当OSGI解决并满足依赖关系并进行类加载操作时。</p><p id="cb57" class="im in km io b ip iq ir is it iu iv iw kn iy iz ja ko jc jd je kp jg jh ji jj hb bi translated"><strong class="io hj">启动</strong>——当调用捆绑包激活器的启动方法时</p><p id="da97" class="im in km io b ip iq ir is it iu iv iw kn iy iz ja ko jc jd je kp jg jh ji jj hb bi translated"><strong class="io hj">活动</strong> —启动方法已成功运行，且捆绑包已成功启动并运行。</p><p id="0aa8" class="im in km io b ip iq ir is it iu iv iw kn iy iz ja ko jc jd je kp jg jh ji jj hb bi translated"><strong class="io hj">停止</strong> —当调用束激活器的停止方法时。</p><p id="c121" class="im in km io b ip iq ir is it iu iv iw kn iy iz ja ko jc jd je kp jg jh ji jj hb bi translated"><strong class="io hj">已卸载</strong> —从系统中移除软件包时。</p></blockquote><p id="ec21" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">当服务器在OSGI模式下运行时，可以按如下方式检查现有包的列表。显示所有包的包ID、状态和包符号名。</p><blockquote class="kj kk kl"><p id="9bd8" class="im in km io b ip iq ir is it iu iv iw kn iy iz ja ko jc jd je kp jg jh ji jj hb bi translated">osgi&gt; ss</p><p id="48bc" class="im in km io b ip iq ir is it iu iv iw kn iy iz ja ko jc jd je kp jg jh ji jj hb bi translated">框架已启动。</p><p id="f35b" class="im in km io b ip iq ir is it iu iv iw kn iy iz ja ko jc jd je kp jg jh ji jj hb bi translated">id状态包</p><p id="e1e8" class="im in km io b ip iq ir is it iu iv iw kn iy iz ja ko jc jd je kp jg jh ji jj hb bi translated">0 ACTIVE org . eclipse . OSGi _ 3 . 4 . 0 . v 2008 06 05–1900</p><p id="af2d" class="im in km io b ip iq ir is it iu iv iw kn iy iz ja ko jc jd je kp jg jh ji jj hb bi translated">1解析helloworld_1.0.0</p></blockquote><p id="dcf0" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在未激活某个包的情况下，可以使用以下命令对该包进行诊断。它将显示丢失的导入包的列表。</p><blockquote class="kj kk kl"><p id="5416" class="im in km io b ip iq ir is it iu iv iw kn iy iz ja ko jc jd je kp jg jh ji jj hb bi translated"><strong class="io hj">OSGi&gt;diag&lt;bundle-id&gt;T13】</strong></p></blockquote><p id="bbc2" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">希望这对理解OSGI的基础有帮助！</p><h1 id="6788" class="kr ke hi bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">参考</h1><p id="62c0" class="pw-post-body-paragraph im in hi io b ip lo ir is it lp iv iw ix lq iz ja jb lr jd je jf ls jh ji jj hb bi translated"><a class="ae jw" href="https://piraveenaparalogarajah.medium.com/osgi-in-a-nutshell-aafc3a86cff0" rel="noopener">https://piraveenaparalogarajah . medium . com/OSGi-in-a-through-aafc 3a 86 CFF 0</a></p><p id="5fc0" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><a class="ae jw" href="https://wso2.com/library/tutorials/develop-osgi-bundles-using-maven-bundle-plugin/" rel="noopener ugc nofollow" target="_blank">https://wso2 . com/library/tutorials/develop-OSGi-bundles-using-maven-bundle-plugin/</a></p></div></div>    
</body>
</html>