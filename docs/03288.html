<html>
<head>
<title>Pressure Stall Information on CentOS7</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">CentOS7ä¸Šçš„å‹åŠ›å¤±é€Ÿä¿¡æ¯</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/codex/pressure-stall-information-on-centos7-a286fe23adea?source=collection_archive---------9-----------------------#2021-08-26">https://medium.com/codex/pressure-stall-information-on-centos7-a286fe23adea?source=collection_archive---------9-----------------------#2021-08-26</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/e545097154b827c6b4220d4873c8d663.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Dw7Jm6BTUUNy7cOU"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">ç…§ç‰‡ç”±<a class="ae iu" href="https://unsplash.com/@clark_fransa?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">é˜¿è¯ºå¾·Â·å¼—æœ—è¥¿æ–¯å¡</a>åœ¨<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>æ‹æ‘„</figcaption></figure><p id="c98c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">æˆ‘æ­£åœ¨è¿è¡Œæ•°æ®åº“ï¼ŒçŸ¥é“å‹åŠ›æ˜¯åœ¨CPUã€RAMè¿˜æ˜¯I/Oä¸Šè‡³å…³é‡è¦ï¼Œè¿™å¹¶ä¸å®¹æ˜“ä»CloudWatchæˆ–æ“ä½œç³»ç»Ÿæ—¥å¸¸ç›‘æ§ä¸­æä¾›çš„æŒ‡æ ‡ä¸­æ¨æ–­å‡ºæ¥ã€‚æœ€è¿‘çš„Linuxå†…æ ¸ä¸ºæ­¤æä¾›äº†PSI(å‹åŠ›å¤±é€Ÿä¿¡æ¯),æ‰€ä»¥è®©æˆ‘ä»¬å¯ç”¨å®ƒã€‚</p><p id="0ebf" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">æˆ‘æœ‰ä»<br/>AWS-market place/CentOS Linux 7æ˜ åƒä¾›åº”çš„EC2å®ä¾‹ï¼Œä½†CentOSè¿è¡Œé€Ÿåº¦ä¸å¿«ï¼Œè€Œä¸”å†…æ ¸è¾ƒæ—§:</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="ddde" class="kc kd hi jy b fi ke kf l kg kh">[yugabyte]$ cat /etc/system-release</span><span id="ff53" class="kc kd hi jy b fi ki kf l kg kh">CentOS Linux release 7.4.1708 (Core)</span><span id="0e5a" class="kc kd hi jy b fi ki kf l kg kh">[yugabyte]$ uname --kernel-release</span><span id="3908" class="kc kd hi jy b fi ki kf l kg kh">3.10.0-693.5.2.el7.x86_64</span></pre><p id="8080" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">æˆ‘éœ€è¦ä¸€ä¸ªæ›´æ–°çš„ç‰ˆæœ¬ï¼Œæˆ‘å°†ä»<a class="ae iu" href="http://elrepo.org/tiki/HomePage" rel="noopener ugc nofollow" target="_blank"> ELRepo </a>å®‰è£…</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="381c" class="kc kd hi jy b fi ke kf l kg kh">[yugabyte]$ sudo yum update -y</span><span id="5917" class="kc kd hi jy b fi ki kf l kg kh">No packages marked for update</span><span id="c60f" class="kc kd hi jy b fi ki kf l kg kh">[yugabyte]$ sudo yum install -y <a class="ae iu" href="https://www.elrepo.org/elrepo-release-7.el7.elrepo.noarch.rpm" rel="noopener ugc nofollow" target="_blank">https://www.elrepo.org/elrepo-release-7.el7.elrepo.noarch.rpm</a></span></pre><p id="685c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">ç°åœ¨åˆ—å‡ºä¸»çº¿å†…æ ¸(â€œmlâ€æ˜¯é•¿æœŸâ€œltâ€çš„åä¹‰è¯):</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="bdc4" class="kc kd hi jy b fi ke kf l kg kh">[yugabyte]$ yum list available --disablerepo='*' --enablerepo=elrepo-kernel kernel-ml.x86_64</span><span id="3ca4" class="kc kd hi jy b fi ki kf l kg kh">Loaded plugins: fastestmirror<br/>Loading mirror speeds from cached hostfile<br/> * elrepo-kernel: mirrors.coreix.net<br/>Available Packages<br/>kernel-ml.x86_64                                                5.13.12-1.el7.elrepo                                                 elrepo-kernel</span></pre><p id="23ee" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">å¹¶å®‰è£…å®ƒ:</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="0f8e" class="kc kd hi jy b fi ke kf l kg kh">[yugabyte]$ sudo yum --enablerepo=elrepo-kernel install -y kernel-ml</span></pre><p id="ef0b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">è¿™æ˜¯grubçš„ç¬¬ä¸€ä¸ªèœå•é¡¹:</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="44c6" class="kc kd hi jy b fi ke kf l kg kh">[centos]$ sudo grep ^menuentry /boot/grub2/grub.cfg</span><span id="90ba" class="kc kd hi jy b fi ki kf l kg kh">menuentry 'CentOS Linux (5.13.12-1.el7.elrepo.x86_64) 7 (Core)' --class centos --class gnu-linux --class gnu --class os --unrestricted $menuentry_id_option 'gnulinux-3.10.0-693.5.2.el7.x86_64-advanced-6f15c206-f516-4ee8-a4b7-89ad880647db' {<br/>menuentry 'CentOS Linux (3.10.0-1160.36.2.el7.x86_64) 7 (Core)' --class centos --class gnu-linux --class gnu --class os --unrestricted $menuentry_id_option 'gnulinux-3.10.0-693.5.2.el7.x86_64-advanced-6f15c206-f516-4ee8-a4b7-89ad880647db' {<br/>menuentry 'CentOS Linux (3.10.0-693.5.2.el7.x86_64) 7 (Core)' --class centos --class gnu-linux --class gnu --class os --unrestricted $menuentry_id_option 'gnulinux-3.10.0-693.5.2.el7.x86_64-advanced-6f15c206-f516-4ee8-a4b7-89ad880647db' {<br/>menuentry 'CentOS Linux (0-rescue-f073c429a7456b53ec3e2c53460c5c8f) 7 (Core)' --class centos --class gnu-linux --class gnu --class os --unrestricted $menuentry_id_option 'gnulinux-0-rescue-f073c429a7456b53ec3e2c53460c5c8f-advanced-6f15c206-f516-4ee8-a4b7-89ad880647db' {</span></pre><p id="7dee" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">æˆ‘å°†å®ƒè®¾ä¸ºé»˜è®¤è®¾ç½®(menuentry 0):</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="a3e0" class="kc kd hi jy b fi ke kf l kg kh">[yugabyte]$ sudo sed -e '/^GRUB_DEFAULT=saved/s/=.*/=0/' -i /etc/default/grub</span></pre><p id="a763" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">æˆ‘éœ€è¦åœ¨å†…æ ¸å‘½ä»¤è¡Œä¸­æ·»åŠ <code class="du kj kk kl jy b">psi</code>:</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="0e2b" class="kc kd hi jy b fi ke kf l kg kh">[yugabyte]$ sudo mkdir -p /etc/tuned/psi &amp;&amp; sudo tee /etc/tuned/psi/tuned.conf &lt;&lt;'TAC'</span><span id="d6ad" class="kc kd hi jy b fi ki kf l kg kh">[main]<br/>  summary=Enable Pressure Stall Information as in https://dev.to/aws-heroes/pressure-stall-information-on-ec2-centos-7-2nbb-temp-slug-5559720<br/>[bootloader]<br/>cmdline=psi=1</span><span id="77cf" class="kc kd hi jy b fi ki kf l kg kh">TAC</span></pre><p id="4ad3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">æ­£åœ¨æ£€æŸ¥å½“å‰é…ç½®æ–‡ä»¶:</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="53b4" class="kc kd hi jy b fi ke kf l kg kh">[yugabyte]$ tuned-adm profile<br/>Current active profile: virtual-guest</span></pre><p id="9892" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">æ·»åŠ æ–°çš„:</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="3381" class="kc kd hi jy b fi ke kf l kg kh">[yugabyte]$ sudo tuned-adm profile virtual-guest psi</span></pre><p id="7f75" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">å¯ç”¨æ‰€æœ‰è¿™äº›GRUBæ›´æ”¹:</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="81aa" class="kc kd hi jy b fi ke kf l kg kh">[yugabyte]$ sudo grub2-mkconfig -o /boot/grub2/grub.cfg</span></pre><p id="bc1d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">ç°åœ¨å‡†å¤‡é‡æ–°å¯åŠ¨èŠ‚ç‚¹ã€‚è¿™å°±æ˜¯æˆ‘æ¬£èµè¿è¡Œåˆ†å¸ƒå¼æ•°æ®åº“çš„åœ°æ–¹(YugabyteDBğŸš€)å› ä¸ºæˆ‘å¯ä»¥åœ¨ä¸ä¸­æ–­åº”ç”¨ç¨‹åºçš„æƒ…å†µä¸‹æ»šåŠ¨é‡å¯èŠ‚ç‚¹ã€‚</p><p id="4c01" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">æ­£åœ¨æ£€æŸ¥:</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="f704" class="kc kd hi jy b fi ke kf l kg kh">[yugabyte]$ tail /proc/pressure/*</span><span id="c816" class="kc kd hi jy b fi ki kf l kg kh">==&gt; /proc/pressure/cpu &lt;==<br/>some avg10=27.80 avg60=25.88 avg300=16.13 total=77572758<br/>full avg10=0.98 avg60=0.94 avg300=0.55 total=4422080</span><span id="28b8" class="kc kd hi jy b fi ki kf l kg kh">==&gt; /proc/pressure/io &lt;==<br/>some avg10=12.03 avg60=13.02 avg300=7.36 total=32530366<br/>full avg10=4.73 avg60=5.33 avg300=3.08 total=15034660</span><span id="d9a7" class="kc kd hi jy b fi ki kf l kg kh">==&gt; /proc/pressure/memory &lt;==<br/>some avg10=0.12 avg60=0.02 avg300=0.00 total=309168<br/>full avg10=0.12 avg60=0.02 avg300=0.00 total=307455</span></pre><p id="935a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">ç°åœ¨è¿˜æœ‰å¾…è§£é‡Šã€‚æˆ‘åœ¨è¿‡å»çš„åšå®¢æ–‡ç« ä¸­è§£é‡Šäº†ä¸€ç‚¹ï¼Œåœ¨å…³äºwww.kernel.orgçš„<a class="ae iu" href="https://www.kernel.org/doc/html/latest/accounting/psi.html" rel="noopener ugc nofollow" target="_blank">å’Œ</a>ä¸­æœ‰å®Œæ•´çš„æè¿°ã€‚åŸºæœ¬ä¸Š,â€œsomeâ€è¡Œæ˜¾ç¤ºäº†åœ¨è¿‡å»çš„10ç§’ã€1åˆ†é’Ÿå’Œ5åˆ†é’Ÿå†…ï¼Œä¸€ä¸ªä»»åŠ¡è¢«åœæ­¢çš„æ—¶é—´ç™¾åˆ†æ¯”ï¼Œä»¥åŠå½“æ‰€æœ‰éç©ºé—²ä»»åŠ¡éƒ½åœ¨ç­‰å¾…æ—¶çš„â€œfullâ€ã€‚æ‰€ä»¥å¦‚æœä½ è§‰å¾—æŸä¸ªä¸œè¥¿å¾ˆæ…¢ï¼Œåº”è¯¥æ›´å¿«ï¼Œä¸è¦ç›²ç›®ä¼¸ç¼©ã€‚æ‚¨çŸ¥é“å“ªä¸ªèµ„æºè´Ÿè´£å“åº”æ—¶é—´ã€‚</p></div></div>    
</body>
</html>