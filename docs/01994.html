<html>
<head>
<title>CMake: Add Remote Repository to Build Tree</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">CMake:添加远程存储库以构建树</h1>
<blockquote>原文：<a href="https://medium.com/codex/cmake-add-remote-repository-to-build-tree-b8566ead3e80?source=collection_archive---------4-----------------------#2021-06-21">https://medium.com/codex/cmake-add-remote-repository-to-build-tree-b8566ead3e80?source=collection_archive---------4-----------------------#2021-06-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/46a44bb9264c4e3c4b44b2031814b60f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1322/format:webp/1*KjYvI_0PZ9P_dUa6JVX0Lw.jpeg"/></div><figcaption class="im in et er es io ip bd b be z dx translated">cmake logo来源:cmake.org</figcaption></figure><p id="c41b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在使用CMake构建项目时，当我的项目依赖外部库组件时，我经常会遇到问题。例如，在开发的早期阶段最经常需要的测试框架必须在存储库中下载/克隆，然后在测试框架成为构建依赖树中的节点之前，必须在CMakeLists.txt中手动添加测试框架的路径。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="er es jo"><img src="../Images/153414607b6655e7303cb6d1edf6e094.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5JfoRpcJE0HsB-UCttoHGQ.jpeg"/></div></div></figure><p id="ad18" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">其他选项可能需要使用依赖管理器，如<a class="ae jx" href="https://conan.io/" rel="noopener ugc nofollow" target="_blank">柯南</a>或项目中的手工脚本来完成这项工作。不管用什么方法，解决这样的依赖问题都不是CMake的DNA。但这在CMake 3.11中有所改变，增加了FetchContent宏。<br/>让我们看看他们的行动。</p><p id="025f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">首先，让我们看看CMakeLists.txt的基本框架，其中创建了一个测试可执行文件并链接到gtest库:</p><pre class="jp jq jr js fd jy jz ka kb aw kc bi"><span id="9bee" class="kd ke hi jz b fi kf kg l kh ki">## CMakeLists.txt ##<br/>cmake_minimum_required(VERSION 3.11)<br/>project(FetchContentDemo LANGUAGES CXX)<br/><br/>enable_testing()<br/><br/>###############################<br/># FETCH GTEST FROM REPOSITORY #<br/>###############################</span><span id="4850" class="kd ke hi jz b fi kj kg l kh ki">add_executable(fetchGtestEg testMain.cpp)<br/>target_link_libraries(fetchGtestEg PRIVATE gtest)<br/>add_test(NAME fetchGtestEg COMMAND fetchGtestEg)</span></pre><p id="1f71" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">上面的CMakeLists.txt文件有序言，从远程获取<a class="ae jx" href="https://github.com/google/googletest" rel="noopener ugc nofollow" target="_blank"> gtest </a>库之后，测试可执行文件可以简单地链接到测试库。让我们看看如何获取gtest存储库并将其添加到构建树中。下面的代码片段表示应该替换注释块的部分</p><pre class="jp jq jr js fd jy jz ka kb aw kc bi"><span id="ea02" class="kd ke hi jz b fi kf kg l kh ki">include(FetchContent)    #Note this</span><span id="e633" class="kd ke hi jz b fi kj kg l kh ki">FetchContent_Declare<br/>(gtest                   #name of repository<br/> GIT_REPOSITORY https://github.com/google/googletest.git<br/> GIT_TAG        release-1.11.0<br/>)</span><span id="6bbf" class="kd ke hi jz b fi kj kg l kh ki">FetchContent_Populate(gtest)</span></pre><p id="2ae0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">通过CMakeList.txt中的这几行代码，开发人员可以指定测试框架的版本，并轻松地分发cmake文件，而无需担心测试框架的相关版本。希望你喜欢阅读这篇文章。</p></div></div>    
</body>
</html>