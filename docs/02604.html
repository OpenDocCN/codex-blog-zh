<html>
<head>
<title>Long story short.. An NLP use-case on Text Summarization</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">长话短说..文本摘要的自然语言处理用例</h1>
<blockquote>原文：<a href="https://medium.com/codex/long-story-short-an-nlp-use-case-on-text-summarization-2752a7daa5f7?source=collection_archive---------5-----------------------#2021-07-28">https://medium.com/codex/long-story-short-an-nlp-use-case-on-text-summarization-2752a7daa5f7?source=collection_archive---------5-----------------------#2021-07-28</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/ae6332da9ff418df8afd8923eb294c89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q_UwWKYiMdGv9IR3h6FyBQ.jpeg"/></div></div></figure><div class=""/><p id="520a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这个快节奏的时代，我们都想随时了解全球每天发生的事情，但很少有人有这种奢侈。至于阅读报纸和文章，略读是要点，即先浏览标题，然后只有当它有趣或值得阅读时才跳进去。特别是当点击一个按钮就可以看到内容时，我们都更喜欢浏览从流行报纸、网站、博客和杂志上收集的“摘要”新闻；用三到四句话来表达——而不是阅读冗长的、有时被高估和夸大的报纸文章。</p><blockquote class="jo jp jq"><p id="d3fe" class="iq ir jr is b it iu iv iw ix iy iz ja js jc jd je jt jg jh ji ju jk jl jm jn hb bi translated">人工智能领域中的文本摘要是一个重要的研究领域，它从一段文本中识别出相关的句子。通过文本摘要，我们可以通过保留文本的内容来获得简短而精确的信息。</p></blockquote><p id="2155" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">谷歌新闻、Inshorts、Pulse是一些利用文本摘要算法的新闻聚合应用。在这篇文章中，我将带你通过各种传统和先进的方法来实现自动文本摘要</p><p id="0004" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">文本摘要大致分为两类——提取摘要和抽象摘要。</p><ul class=""><li id="c9f4" class="jv jw ht is b it iu ix iy jb jx jf jy jj jz jn ka kb kc kd bi translated"><strong class="is hu">摘录摘要</strong> —这是一种传统方法，根据句子的重要性直接从原始文档中提取句子。请注意，获得的摘要包含原文中的精确句子。</li><li id="4cc2" class="jv jw ht is b it ke ix kf jb kg jf kh jj ki jn ka kb kc kd bi translated"><strong class="is hu">抽象概括——</strong>抽象概括更接近于人类通常所做的事情——即构思文本，将其与他/她的记忆和相关信息进行比较，然后在简短的文本中重新创建其核心。这就是为什么抽象摘要比抽取方法更具挑战性的原因，因为模型应该将源语料库分解成非常多的标记，并重新生成目标句子。在摘要中实现有意义和语法正确的句子是一件大事，需要高度精确和复杂的模型。</li></ul><p id="0602" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在接下来的部分中，让我们探索提取和抽象方法，您可以比较和熟悉每种方法的优点和局限性。</p></div><div class="ab cl kj kk gp kl" role="separator"><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko"/></div><div class="hb hc hd he hf"><p id="9e57" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">考虑一下来自商业新闻网站的特斯拉季度业绩摘录</p><pre class="kq kr ks kt fd ku kv kw kx aw ky bi"><span id="1a51" class="kz la ht kv b fi lb lc l ld le">text = """<br/>Tesla reported second-quarter earnings after the bell Monday, and it’s a beat on both the top and bottom lines. Shares rose about 2% after-hours. Here are the results.</span><span id="880f" class="kz la ht kv b fi lf lc l ld le">Earnings: $1.45 vs 98 cents per share adjusted expected, according to Refinitiv. Revenue: $11.96 billion vs $11.30 billion expected, according to Refinitiv</span><span id="9a16" class="kz la ht kv b fi lf lc l ld le">Tesla reported $1.14 billion in (GAAP) net income for the quarter, the first time it has surpassed $1 billion. In the year-ago quarter, net income amounted to $104 million.</span><span id="dc3d" class="kz la ht kv b fi lf lc l ld le">Overall automotive revenue came in at $10.21 billion, of which only $354 million, about 3.5%, came from sales of regulatory credits. That’s a lower number for credits than in any of the previous four quarters. Automotive gross margins were 28.4%, higher than in any of the last four quarters.</span><span id="882f" class="kz la ht kv b fi lf lc l ld le">Tesla had already reported deliveries (its closest approximation to sales) of 201,250 electric vehicles, and production of 206,421 total vehicles, during the quarter ended June 30, 2021.</span><span id="97ce" class="kz la ht kv b fi lf lc l ld le">The company also reported $801 million in revenue from its energy business, including solar photovoltaics and energy storage systems for homes, businesses and utilities, an increase of more than 60% from last quarter. While Tesla does not disclose how many energy storage units it sells each quarter, in recent weeks CEO Elon Musk said, in court, that the company would only be able to produce 30,000 to 35,000 at best during the current quarter, blaming the lag on chip shortages. Tesla also reported $951 million in services and other revenues. The company now operates 598 stores and service centers, and a mobile service fleet including 1,091 vehicles, an increase of just 34% versus a year ago. That compares with an increase of 121% in vehicle deliveries year over year. A $23 million impairment related to the value of its bitcoin holdings was reported as an operating expense under “Restructuring and other.”<br/>"""</span></pre><p id="fc14" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们从使用不同方法安装和导入运行总结过程所需的库开始。</p><pre class="kq kr ks kt fd ku kv kw kx aw ky bi"><span id="c82d" class="kz la ht kv b fi lb lc l ld le">!pip install bert-extractive-summarizer<br/>!pip install spacy<br/>!pip install transformers<br/>!pip install torch<br/>!pip install sentencepiece</span></pre><p id="cbad" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">导入库</p><pre class="kq kr ks kt fd ku kv kw kx aw ky bi"><span id="f998" class="kz la ht kv b fi lb lc l ld le">import gensim</span><span id="b64f" class="kz la ht kv b fi lf lc l ld le">from gensim.summarization import summarize</span><span id="5516" class="kz la ht kv b fi lf lc l ld le">import torch</span><span id="ef0e" class="kz la ht kv b fi lf lc l ld le">from transformers import pipeline<br/>from transformers import T5Tokenizer<br/>from transformers import T5ForConditionalGeneration<br/>from transformers import T5Config</span><span id="9759" class="kz la ht kv b fi lf lc l ld le">from summarizer import Summarizer<br/>from summarizer import TransformerSummarizer</span></pre><h2 id="a573" class="kz la ht bd lg lh li lj lk ll lm ln lo jb lp lq lr jf ls lt lu jj lv lw lx ly bi translated">使用Gensim(文本等级)的摘要</h2><p id="26d9" class="pw-post-body-paragraph iq ir ht is b it lz iv iw ix ma iz ja jb mb jd je jf mc jh ji jj md jl jm jn hb bi translated">gensim包用于自然语言处理和信息检索任务，如主题建模、文档索引、word2vec和相似性检索。这里我们使用TextRank算法将它用于文本摘要。</p><p id="39d9" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">TextRank是一种提取的和无监督的文本摘要技术，基于更频繁出现的单词是有意义的概念。因此，包含高频词的句子很重要。基于此，算法给文本中的每个句子分配分数。排名靠前的句子会进入摘要。</p><p id="2590" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们使用下面给出的不同汇总参数来使用gensim的<code class="du me mf mg kv b">summarize</code>功能</p><ol class=""><li id="e9bd" class="jv jw ht is b it iu ix iy jb jx jf jy jj jz jn mh kb kc kd bi translated"><code class="du me mf mg kv b">ratio</code>:取值范围为0-1。它表示摘要相对于原始文本的比例。</li><li id="68f4" class="jv jw ht is b it ke ix kf jb kg jf kh jj ki jn mh kb kc kd bi translated"><code class="du me mf mg kv b">word_count</code>:决定摘要的字数。</li></ol><p id="37d8" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu">按比例汇总:</strong></p><pre class="kq kr ks kt fd ku kv kw kx aw ky bi"><span id="7fbd" class="kz la ht kv b fi lb lc l ld le">summary_by_ratio = summarize(text, ratio=0.15) <br/>print("Summary : \n" + summary_by_ratio)</span><span id="b76b" class="kz la ht kv b fi lf lc l ld le"><strong class="kv hu">Output &gt;&gt;&gt;</strong></span><span id="fd36" class="kz la ht kv b fi lf lc l ld le">Summary :  The company also reported $801 million in revenue from its energy business, including solar photovoltaics and energy storage systems for homes, businesses and utilities, an increase of more than 60% from last quarter. Tesla also reported $951 million in services and other revenues.</span></pre><p id="ba7b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu">按字数总结</strong></p><pre class="kq kr ks kt fd ku kv kw kx aw ky bi"><span id="ea04" class="kz la ht kv b fi lb lc l ld le">summary_by_count=summarize(text, word_count=60)<br/>print("Summary : " + summary_by_count)</span><span id="f1cd" class="kz la ht kv b fi lf lc l ld le"><strong class="kv hu">Output &gt;&gt;&gt;</strong></span><span id="1710" class="kz la ht kv b fi lf lc l ld le">Summary : Overall automotive revenue came in at $10.21 billion, of which only $354 million, about 3.5%, came from sales of regulatory credits. The company also reported $801 million in revenue from its energy business, including solar photovoltaics and energy storage systems for homes, businesses and utilities, an increase of more than 60% from last quarter. Tesla also reported $951 million in services and other revenues.</span></pre><h1 id="24e8" class="mi la ht bd lg mj mk ml lk mm mn mo lo mp mq mr lr ms mt mu lu mv mw mx lx my bi translated">使用预先训练的模型进行抽象概括</h1><p id="c457" class="pw-post-body-paragraph iq ir ht is b it lz iv iw ix ma iz ja jb mb jd je jf mc jh ji jj md jl jm jn hb bi translated">这里我们使用Python中的transformers库对输入文本执行抽象文本摘要。变形金刚库的所有文档都可以在这个网站上找到:<a class="ae mz" href="https://huggingface.co/transformers/" rel="noopener ugc nofollow" target="_blank">https://huggingface.co/transformers/</a></p><p id="04dd" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在让我们用下面的方法来研究总结技术。</p><ul class=""><li id="f864" class="jv jw ht is b it iu ix iy jb jx jf jy jj jz jn ka kb kc kd bi translated">管道API</li><li id="5605" class="jv jw ht is b it ke ix kf jb kg jf kh jj ki jn ka kb kc kd bi translated">T5变压器</li><li id="6f22" class="jv jw ht is b it ke ix kf jb kg jf kh jj ki jn ka kb kc kd bi translated">伯特</li><li id="22aa" class="jv jw ht is b it ke ix kf jb kg jf kh jj ki jn ka kb kc kd bi translated">GPT2</li><li id="24a0" class="jv jw ht is b it ke ix kf jb kg jf kh jj ki jn ka kb kc kd bi translated">XLNet</li></ul><h1 id="21df" class="mi la ht bd lg mj mk ml lk mm mn mo lo mp mq mr lr ms mt mu lu mv mw mx lx my bi translated">使用管道API汇总</h1><p id="8068" class="pw-post-body-paragraph iq ir ht is b it lz iv iw ix ma iz ja jb mb jd je jf mc jh ji jj md jl jm jn hb bi translated">在transformers中使用模型最直接的方式是使用管道API。管道是使用模型进行推理的一种伟大而简单的方式。这些管道是从库中抽象出大多数复杂代码的对象，提供了一个专用于多项任务的简单API，包括命名实体识别、屏蔽语言建模、情感分析、特征提取和问题回答</p><p id="3a88" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">此管道可以使用的模型是已经针对摘要任务进行了微调的模型，当前为“bart-large-cnn”、“t5-small”、“t5-base”、“t5-large”、“t5–3b”、“t5–11b”</p><p id="b60c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">使用默认模型运行汇总管道</p><pre class="kq kr ks kt fd ku kv kw kx aw ky bi"><span id="6120" class="kz la ht kv b fi lb lc l ld le">summarization = pipeline("summarization")</span><span id="8c5f" class="kz la ht kv b fi lf lc l ld le">## Call the transformer's summarization api by passing text</span><span id="aeb4" class="kz la ht kv b fi lf lc l ld le">abstract_text = summarization(text)[0]['summary_text']<br/>print("Summary:", abstract_text)</span></pre><p id="5507" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">注意:当您第一次执行这个或者上面列出的任何一个技术时，下载模型架构和权重，以及在某些情况下的记号化器配置需要一些时间。</p><p id="8fc9" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下面是执行上述<code class="du me mf mg kv b">pipeline</code>代码后生成的摘要</p><pre class="kq kr ks kt fd ku kv kw kx aw ky bi"><span id="b2b3" class="kz la ht kv b fi lb lc l ld le"><strong class="kv hu">Output &gt;&gt;&gt;</strong></span><span id="c3ee" class="kz la ht kv b fi lf lc l ld le">Summary:  Tesla reported $1.14 billion in (GAAP) net income for the quarter, the first time it has surpassed $1 billion . The company also reported $801 million in revenue from its energy business, including solar photovoltaics and energy storage systems . Shares rose about 2% after-hours .</span></pre><p id="73fe" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">生成的抽象摘要看起来相当不错，不是吗！</p><p id="deb0" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">通过显式传递<code class="du me mf mg kv b">t5-base</code>模型来运行相同的管道</p><pre class="kq kr ks kt fd ku kv kw kx aw ky bi"><span id="69e5" class="kz la ht kv b fi lb lc l ld le">## setup the pipeline with t5-base model<br/>t5summarizer = pipeline("summarization", model="t5-base", tokenizer="t5-base", framework="tf")</span><span id="d548" class="kz la ht kv b fi lf lc l ld le">## Build the summary with min 5 and max 60 words<br/>t5summarizer(text, min_length=5, max_length=60)</span><span id="98aa" class="kz la ht kv b fi lf lc l ld le"><strong class="kv hu">Output &gt;&gt;&gt;</strong></span><span id="540e" class="kz la ht kv b fi lf lc l ld le">Summary: Tesla reported $1.45 vs 98 cents per share adjusted expected, according to Refinitiv . overall automotive revenue came in at $10.21 billion, of which only $354 million, about 3.5%, came from sales of regulatory credits</span></pre><h1 id="aeb8" class="mi la ht bd lg mj mk ml lk mm mn mo lo mp mq mr lr ms mt mu lu mv mw mx lx my bi translated">T5变压器概述</h1><p id="28b3" class="pw-post-body-paragraph iq ir ht is b it lz iv iw ix ma iz ja jb mb jd je jf mc jh ji jj md jl jm jn hb bi translated">T5是在非监督和监督任务的多任务混合上预先训练的编码器-解码器模型，并且对于该模型，每个任务被转换成文本到文本格式。T5通过在对应于每个任务的输入前添加不同的前缀，可以很好地处理各种现成的任务</p><p id="571c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">通过<code class="du me mf mg kv b">from_pretrained</code>方法实例化预训练的“t5-small”模型。</p><pre class="kq kr ks kt fd ku kv kw kx aw ky bi"><span id="0ffb" class="kz la ht kv b fi lb lc l ld le">t5model = T5ForConditionalGeneration.from_pretrained('t5-small')</span><span id="6cfa" class="kz la ht kv b fi lf lc l ld le">t5tokenizer = T5Tokenizer.from_pretrained('t5-small')</span><span id="59bb" class="kz la ht kv b fi lf lc l ld le">device = torch.device('cpu')</span></pre><p id="1d4d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在原始文本的开头添加字符串<code class="du me mf mg kv b">summarize: </code>并编码。T5转换器通过在输入文本前添加特定的前缀来执行不同的任务。</p><pre class="kq kr ks kt fd ku kv kw kx aw ky bi"><span id="bca0" class="kz la ht kv b fi lb lc l ld le">t5tokenized_text = t5tokenizer.encode("summarize:"+ text,<br/>                                truncation=True,<br/>                                return_attention_mask=True,<br/>                                add_special_tokens=True, <br/>                                padding='max_length',     <br/>                                return_tensors="pt").to(device)</span></pre><p id="720b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">接下来，您将传递encode函数返回的标记化文本中的<code class="du me mf mg kv b">input_ids</code>以及其他参数。这里使用的技术是“波束搜索”。波束搜索通过在每个时间步长保持最可能的假设波束数，并最终选择具有总体最高概率的假设，降低了丢失隐藏的高概率单词序列的风险</p><p id="02dd" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这里阅读更多关于贪婪搜索和光束搜索:<a class="ae mz" href="https://huggingface.co/blog/how-to-generate" rel="noopener ugc nofollow" target="_blank">https://huggingface.co/blog/how-to-generate</a></p><pre class="kq kr ks kt fd ku kv kw kx aw ky bi"><span id="5ebf" class="kz la ht kv b fi lb lc l ld le">t5summary_ids =  t5model.generate(input_ids=t5tokenized_text['input_ids'],<br/>                 attention_mask=t5tokenized_text['attention_mask'],<br/>                 num_beams=3,<br/>                 min_length=20,<br/>                 max_length=70,<br/>                 repetition_penalty=2.0,<br/>                 early_stopping=True)</span></pre><p id="ccbc" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">参数解释如下:</p><ul class=""><li id="1696" class="jv jw ht is b it iu ix iy jb jx jf jy jj jz jn ka kb kc kd bi translated"><code class="du me mf mg kv b">max_length</code>:生成令牌的最大数量。</li><li id="ae74" class="jv jw ht is b it ke ix kf jb kg jf kh jj ki jn ka kb kc kd bi translated"><code class="du me mf mg kv b">min_length</code>:这是要生成的最小令牌数。</li><li id="484f" class="jv jw ht is b it ke ix kf jb kg jf kh jj ki jn ka kb kc kd bi translated"><code class="du me mf mg kv b">length_penalty</code>:对长度的指数惩罚，1.0表示没有惩罚，增加该参数，将增加输出文本的长度。</li><li id="263b" class="jv jw ht is b it ke ix kf jb kg jf kh jj ki jn ka kb kc kd bi translated"><code class="du me mf mg kv b">num_beams</code>:指定该参数，将引导模型使用波束搜索而不是贪婪搜索，将num_beams设置为4，将允许模型前瞻4个可能的单词(贪婪搜索时为1)。</li><li id="c6f2" class="jv jw ht is b it ke ix kf jb kg jf kh jj ki jn ka kb kc kd bi translated"><code class="du me mf mg kv b">early_stopping</code>:我们将它设置为True，这样当所有的beam假设到达字符串标记的末尾(EOS)时，生成就完成了。</li></ul><pre class="kq kr ks kt fd ku kv kw kx aw ky bi"><span id="eb86" class="kz la ht kv b fi lb lc l ld le">output = t5tokenizer.decode(t5summary_ids[0],  <br/>                             skip_special_tokens=True, <br/>                             clean_up_tokenization_spaces=True)</span><span id="4f3a" class="kz la ht kv b fi lf lc l ld le">print ("Summary:", output)</span><span id="a866" class="kz la ht kv b fi lf lc l ld le"><strong class="kv hu">Output &gt;&gt;&gt;</strong></span><span id="8271" class="kz la ht kv b fi lf lc l ld le">Summary: shares rose about 2% after-hours, according to Refinitiv. in the year-ago quarter, net income amounted to $104 million. overall revenue came in at $10.21 billion, of which only $354 million came from regulatory credits.</span></pre><h1 id="d6c9" class="mi la ht bd lg mj mk ml lk mm mn mo lo mp mq mr lr ms mt mu lu mv mw mx lx my bi translated">用BERT模型总结</h1><p id="4d68" class="pw-post-body-paragraph iq ir ht is b it lz iv iw ix ma iz ja jb mb jd je jf mc jh ji jj md jl jm jn hb bi translated"><strong class="is hu"> BERT </strong>(双向转换器)是一种转换器，用于克服RNN和其他神经网络作为长期依赖的局限性。这是一个预先训练好的模型，自然是双向的。这个预先训练好的模型可以被调整以容易地执行指定的NLP任务，在我们的例子中是<strong class="is hu">总结</strong>。</p><pre class="kq kr ks kt fd ku kv kw kx aw ky bi"><span id="854c" class="kz la ht kv b fi lb lc l ld le">bert_model = Summarizer()</span><span id="2434" class="kz la ht kv b fi lf lc l ld le">bert_summary = ''.join(bert_model(text, min_length=60))</span><span id="e94c" class="kz la ht kv b fi lf lc l ld le">print("Summary: " + bert_summary)</span><span id="82f7" class="kz la ht kv b fi lf lc l ld le"><strong class="kv hu">Output &gt;&gt;&gt;</strong></span><span id="cdfe" class="kz la ht kv b fi lf lc l ld le">Summary: Tesla reported second-quarter earnings after the bell Monday, and it’s a beat on both the top and bottom lines. The company also reported $801 million in revenue from its energy business, including solar photovoltaics and energy storage systems for homes, businesses and utilities, an increase of more than 60% from last quarter. That compares with an increase of 121% in vehicle deliveries year over year.</span></pre><h1 id="e594" class="mi la ht bd lg mj mk ml lk mm mn mo lo mp mq mr lr ms mt mu lu mv mw mx lx my bi translated">用GPT2模型总结</h1><p id="c058" class="pw-post-body-paragraph iq ir ht is b it lz iv iw ix ma iz ja jb mb jd je jf mc jh ji jj md jl jm jn hb bi translated">OpenAI的生成式预训练转换器(GPT)模型通过引入非常强大的语言模型，在自然语言处理(NLP)社区掀起了风暴。这些模型可以执行各种NLP任务，如<a class="ae mz" href="https://en.wikipedia.org/wiki/Question_answering" rel="noopener ugc nofollow" target="_blank">问题回答</a>、<a class="ae mz" href="https://en.wikipedia.org/wiki/Textual_entailment#:~:text=Textual%20entailment%20(TE)%20in%20natural,hypothesis%20(h)%2C%20respectively." rel="noopener ugc nofollow" target="_blank">文本蕴涵</a>、文本摘要等。没有任何监督训练。</p><p id="2c6f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">GPT-2能够在更大和更复杂的规模上预测下一个单词。作为参考，最小的GPT-2有1.17亿个参数，而最大的(公众不可见)有超过15亿个参数。可供公众使用的最大的一个是他们主要的GPT-2模型的一半大小。</p><p id="99cb" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们加载模型，并获得生成的摘要！</p><pre class="kq kr ks kt fd ku kv kw kx aw ky bi"><span id="f281" class="kz la ht kv b fi lb lc l ld le">GPT2_model = TransformerSummarizer(transformer_type="GPT2",<br/>                         transformer_model_key="gpt2-medium")</span><span id="d6c7" class="kz la ht kv b fi lf lc l ld le">gpt_summary = ''.join(GPT2_model(text, min_length=60))</span><span id="e8f3" class="kz la ht kv b fi lf lc l ld le">print(gpt_summary)</span><span id="d550" class="kz la ht kv b fi lf lc l ld le"><strong class="kv hu">Output &gt;&gt;&gt;</strong></span><span id="9b56" class="kz la ht kv b fi lf lc l ld le">Summary: Tesla reported second-quarter earnings after the bell Monday, and it’s a beat on both the top and bottom lines. In the year-ago quarter, net income amounted to $104 million. The company also reported $801 million in revenue from its energy business, including solar photovoltaics and energy storage systems for homes, businesses and utilities, an increase of more than 60% from last quarter.</span></pre><p id="f416" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">哇！比伯特好太多了！看看这样一个<strong class="is hu">有见地的总结，它已经产生！</strong></p><p id="4422" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，让我们进入最后一个模型，<strong class="is hu">XLNet！</strong></p><h1 id="9b8b" class="mi la ht bd lg mj mk ml lk mm mn mo lo mp mq mr lr ms mt mu lu mv mw mx lx my bi translated">使用XLNet总结</h1><p id="1906" class="pw-post-body-paragraph iq ir ht is b it lz iv iw ix ma iz ja jb mb jd je jf mc jh ji jj md jl jm jn hb bi translated">XLNet是一种广义自回归语言模型，它学习文本序列的无监督表示。该模型将来自自动编码器(AE)模型(BERT)的建模技术结合到AR模型中，同时避免了AE的局限性。</p><p id="0de5" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们加载模型并打印出摘要/</p><pre class="kq kr ks kt fd ku kv kw kx aw ky bi"><span id="715e" class="kz la ht kv b fi lb lc l ld le">xlnet_model = TransformerSummarizer(transformer_type="XLNet",<br/>                     transformer_model_key="xlnet-base-cased")</span><span id="ee0f" class="kz la ht kv b fi lf lc l ld le">xlnet_summary = ''.join(xlnet_model(text, min_length=60))</span><span id="9d78" class="kz la ht kv b fi lf lc l ld le">print("Summary: " + xlnet_summary)</span><span id="3692" class="kz la ht kv b fi lf lc l ld le"><strong class="kv hu">Output &gt;&gt;&gt;</strong></span><span id="c2b2" class="kz la ht kv b fi lf lc l ld le">Summary: Tesla reported second-quarter earnings after the bell Monday, and it’s a beat on both the top and bottom lines. That’s a lower number for credits than in any of the previous four quarters. The company also reported $801 million in revenue from its energy business, including solar photovoltaics and energy storage systems for homes, businesses and utilities, an increase of more than 60% from last quarter.</span></pre><p id="c631" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对于所有的transformer模型，生成的结果说明它工作得非常好，这真是令人印象深刻！👌</p><h1 id="b8f9" class="mi la ht bd lg mj mk ml lk mm mn mo lo mp mq mr lr ms mt mu lu mv mw mx lx my bi translated">结论</h1><p id="9a37" class="pw-post-body-paragraph iq ir ht is b it lz iv iw ix ma iz ja jb mb jd je jf mc jh ji jj md jl jm jn hb bi translated">在当今快速发展的信息时代，文本摘要已经成为辅助和解释文本信息的重要和及时的工具。无论在什么领域，只要涉及文本文档，就可以看到它的应用。由于文本摘要的应用及其带来的便利性，文本摘要是自然语言处理领域的一个热门话题。</p><p id="8dd1" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我希望这篇文章能让你对文本摘要的不同类型和不同方法有所了解。如果是，请分享掌声..👏</p></div></div>    
</body>
</html>