<html>
<head>
<title>Vox Populi in the Stock Market</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">股票市场的民意</h1>
<blockquote>原文：<a href="https://medium.com/codex/vox-populi-in-the-stock-market-734b286fa962?source=collection_archive---------11-----------------------#2021-03-29">https://medium.com/codex/vox-populi-in-the-stock-market-734b286fa962?source=collection_archive---------11-----------------------#2021-03-29</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/03540c565ab5138731aad2498662ec33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p-gv_zMFztheqRPTKcbd-Q.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">照片由<a class="ae iu" href="https://www.pexels.com/@raybilcliff?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">雷·比尔克利夫</a>从<a class="ae iu" href="https://www.pexels.com/photo/ox-with-pointed-horns-walking-on-grass-lawn-4614489/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">派克斯</a>拍摄</figcaption></figure><p id="171d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">统计学中有一个流行的故事，1907年，弗朗西斯·高尔顿爵士写下了他在当地牲畜展览会上目睹的一场比赛。一只公牛出现了，参赛者购买纸条，写下他们对这头牛体重的猜测。猜得最接近实际体重的人将赢得公牛。与会者来自各行各业。有经验的个人，如农民和屠夫，以及对奖品有好奇心和兴趣的普通市民。</p><p id="19bb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">提交了近800个猜测，比赛结束后，高尔顿爵士被允许分析这些失误。这头牛的实际重量是1198磅，而猜测的平均值是1197磅。高尔顿爵士将他的论文命名为“大众之声”或“大多数人的意见或信仰”。他注意到的现象后来被称为“群体智慧”。</p><p id="debe" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在股票市场上，一家公司的真实价值是未知的。个人愿意为其股票支付的价格给出了一个估计，但这不是一个完美的系统；供求关系、大型机构投资者不断变化的目标以及市场对消息的反应都会导致股票价格的大幅波动。了解一家公司的真实价值肯定有助于更好地选择购买股票的时机，即在该公司似乎被低估时买入。这些波动还导致投资者试图通过一种叫做“对冲”的做法来保护他们的投资，在这种做法中，合同是为了给股东提供保险，防止他们的投资贬值。</p><p id="c701" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">一种常见的对冲工具是“期权”，即在未来某个时间点以特定价格买入或卖出特定股票的合约。期权有两种，一种是“看涨”期权，买方有权以预定的“执行”价格购买100股标的股票，而一种是“看跌”期权，买方有权以执行价格卖出。</p><p id="ee9d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果投资者认为他们持有的股票会上涨，但希望在下跌时保护自己，他们可以购买一个看跌期权，保证买家以可接受的价格购买，这被称为“罢工”。例如，如果某人目前拥有一只价格为每股10美元的股票，他们可以购买一只执行价格为10美元(或他们选择的任何价格)的看跌期权。如果股票价格在看跌合约到期前下跌，他们仍然可以以每股10美元的价格将股票出售给他们买入合约的实体。</p><p id="f57c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">本着“民意”的精神，我们可以把股票价格和期权合约看作是投资者对公司实际价值的猜测。当股价是直接估值时，每份看跌期权合约都是对股票将低于给定执行价格的信心(或恐惧)的投票。由于每个投资者都试图使利润最大化，他们有动机将执行价格设定得尽可能接近实际价值。</p><h2 id="ab25" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">数据</h2><p id="4e45" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">对于一家公司基于其看跌期权的隐含价值，我将使用来自https://www.historicaloptiondata.com/的免费样本数据。我将查看2018年11月30日到期的合同的一个月亚马逊数据。我已经将数据加载到我个人网络上的MariaDB数据库中。</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="fdaf" class="jt ju hi ky b fi lc ld l le lf"># dbConnect is hiding the connection information for the server on my network.<br/>import dbConnect<br/>con, cur = dbConnect.connect()<br/><br/># Pull the data for Amazon put options expiring on 2018-11-30<br/>symbol = "AMZN"<br/>expDate = "2018-11-30"<br/>optionType = "put"<br/><br/>sql = "select underlying, sampleDate, strike, bid, openInterest " +\<br/>      "from optionHistory where symbol = %s and " +\<br/>      "expiration = %s and optionType = %s"<br/><br/>cur.execute(sql, (symbol, expDate, optionType))<br/>optionHistory = cur.fetchall()<br/><br/>print(optionHistory[0])</span><span id="bb40" class="jt ju hi ky b fi lg ld l le lf">{'underlying': 1665.53, 'sampleDate': datetime.date(2018, 11, 1), 'strike': 900.0, 'bid': 0.13, 'openInterest': 61}</span></pre><h2 id="801d" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">执行价格与股价</h2><p id="b1c2" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">作为健全性检查，我们可以绘制给定一天的未平仓合约(称为未平仓“利息”)的直方图。我们看到大多数未平仓合约都集中在当前价格附近。</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="1db0" class="jt ju hi ky b fi lc ld l le lf">from itertools import groupby<br/>import matplotlib.pyplot as plt<br/><br/>dataset = []<br/>showHist = True<br/><br/># Group the entries by date<br/>for k, g in groupby(optionHistory, lambda x: x['sampleDate']):<br/>    group = list(g)<br/>    <br/>    # Show a histogram of the first day of data<br/>    if showHist:<br/>        plt.figure(figsize=(18, 7))<br/>        plt.bar([x['strike'] for x in group], <br/>                [x['openInterest'] for x in group])<br/>        plt.vlines([group[0]['underlying']], <br/>                   ymin=0, ymax=500, colors=['r'])<br/>        plt.title("Open Interest for AMZN by Strike, Date: {}, " +\<br/>                  "Close Price: {}".format(k, group[0]['underlying']))<br/>        showHist = False<br/>                <br/>    # Calculate the weighted average of the strike prices<br/>    totalOpen = sum([x['openInterest'] for x in group])<br/>    totalWeighted = sum([x['strike'] * x['openInterest'] for x in group])<br/>    <br/>    dataset.append({'date': k, <br/>                    'price': group[0]['underlying'], <br/>                    'impliedPrice': totalWeighted / totalOpen})<br/>plt.show()</span></pre><figure class="kt ku kv kw fd ij er es paragraph-image"><div class="ab fe cl lh"><img src="../Images/b7de9951a5c339b756667ef5dce1ef3c.png" data-original-src="https://miro.medium.com/v2/format:webp/1*ybR6siKe7134QUK7d3tn7g.png"/></div></figure><h2 id="263d" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">隐含的股价相当稳定</h2><p id="016f" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">我们可以从上面看到，大部分未平仓合约都在股票的收盘价附近，但最有兴趣的期权实际上低于当前价格。这意味着大多数合约持有者认为股票被高估了。我们可以通过对执行价格和该执行价格的合约数量进行加权平均来得到一个实际的数值。当我们绘制这个隐含价格随时间变化的曲线图时，我们可以看到它相当稳定。它几乎没有标的股票价格的可变性。有趣的是，在有限的(免费)数据集上，我们看到当实际价格偏离太远时，它会被拉回到隐含价格。</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="55f1" class="jt ju hi ky b fi lc ld l le lf">X = [x['date'] for x in dataset]<br/>closePrices = [x['price'] for x in dataset]<br/>weightedStrikes = [x['impliedPrice'] for x in dataset]<br/><br/>plt.figure(figsize=(18, 7))<br/><br/>plt.plot(X, closePrices, label="Close Price")<br/>plt.plot(X, weightedStrikes, label="Implied Price")<br/>plt.legend(loc="upper right")<br/>plt.show()</span></pre><figure class="kt ku kv kw fd ij er es paragraph-image"><div class="ab fe cl lh"><img src="../Images/1a97400ccd9570bd86c4d01370c594fa.png" data-original-src="https://miro.medium.com/v2/format:webp/1*059sjq33AfolVcP9UjfrFQ.png"/></div></figure><h2 id="9243" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">数据用完了！</h2><p id="00f7" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">在11月29日，一个大的转移发生在片尾。如果我们在期权数据用完后不久查看亚马逊的股价，我们会发现股价确实回到了更接近隐含价格的水平。事实上，股价并没有偏离隐含价值，这增加了估值的可信度。为了更进一步，我们可以计算有多个到期日的合约的隐含股价，然后对其进行平均，以估计股价是过高还是过低。</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="e683" class="jt ju hi ky b fi lc ld l le lf">import yfinance as yf<br/>import datetime<br/><br/>data = yf.download(symbol, start="2018-11-21", end="2018-12-31")<br/><br/>plt.figure(figsize=(18, 7))<br/>plt.annotate('Highly Overvalued', <br/>             xy=(datetime.date(2018, 11, 29), <br/>             data.loc["2018-11-29"]['Close']), <br/>             xytext=(datetime.date(2018, 11, 21), 1700),<br/>             arrowprops=dict(facecolor='black', shrink=0.05), <br/>             verticalalignment='top')<br/>print(data['Close'].plot())</span><span id="9ade" class="jt ju hi ky b fi lg ld l le lf">[*********************100%***********************]  1 of 1 completed<br/>AxesSubplot(0.125,0.2;0.775x0.68)</span></pre><figure class="kt ku kv kw fd ij er es paragraph-image"><div class="ab fe cl lh"><img src="../Images/9897e4dbade002cbfccdaf1da12a4899.png" data-original-src="https://miro.medium.com/v2/format:webp/1*EKb89aaZJXcVqM4WPtwmlQ.png"/></div></figure><h2 id="f0cc" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">链接</h2><ul class=""><li id="edc7" class="li lj hi ix b iy ko jc kp jg lk jk ll jo lm js ln lo lp lq bi translated">免费样本的历史期权数据:【https://www.historicaloptiondata.com/ T2】</li><li id="7466" class="li lj hi ix b iy lr jc ls jg lt jk lu jo lv js ln lo lp lq bi translated">雅虎！金融市场数据下载器:【https://pypi.org/project/yfinance/ T4】</li><li id="bc51" class="li lj hi ix b iy lr jc ls jg lt jk lu jo lv js ln lo lp lq bi translated">如何释放群众的智慧:<a class="ae iu" href="https://theconversation.com/how-to-unleash-the-wisdom-of-crowds-52774" rel="noopener ugc nofollow" target="_blank">https://the conversation . com/how-to-unleash-the-wisdom-of-crowds-52774</a></li></ul></div></div>    
</body>
</html>