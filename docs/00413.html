<html>
<head>
<title>Creating an ML Model and Serving it as a RESTful API: Part 2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">创建ML模型并将其作为RESTful API:第2部分</h1>
<blockquote>原文：<a href="https://medium.com/codex/creating-an-ml-model-and-serving-it-as-a-restful-api-part-2-450bd49dd17?source=collection_archive---------3-----------------------#2021-01-30">https://medium.com/codex/creating-an-ml-model-and-serving-it-as-a-restful-api-part-2-450bd49dd17?source=collection_archive---------3-----------------------#2021-01-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="0ec9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这篇文章是<a class="ae jd" href="https://notesandcodes.medium.com/creating-an-ml-model-and-serving-it-as-a-restful-api-part-1-4c8f7ed5e6ba" rel="noopener">模型和API创建</a>的延续，所以一定要先看看本系列的第1部分！</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/3cebe8a819049807049472149410730e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XaJ0bPHrko_RNPrktt0PLQ.jpeg"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">图片来源:【https://pixabay.com/images/id-4968987/ T2】</figcaption></figure><p id="bfdc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">本系列的第2部分将着重于创建一个非常简单的web应用程序，它要求Iris的花瓣和萼片的宽度和长度。然后，它将调用虹膜分类模型API，根据给定的用户数据对虹膜花的类型进行分类。web应用程序将使用PHP和HTML创建，托管在本地服务器上。</p><h1 id="645f" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">编写Web应用程序🖥️</h1><p id="54c6" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">web应用程序包含四个输入字段来接受用户数据。一旦用户点击提交，它将调用API并以JSON格式返回预测的分类。</p><p id="99b2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为此，我们创建了一个名为iris-app.php的文件，并在其中输入以下PHP和HTML代码:</p><pre class="jf jg jh ji fd kx ky kz la aw lb bi"><span id="fc53" class="lc jv hi ky b fi ld le l lf lg">&lt;?php<br/> $form = “<br/> &lt;!DOCTYPE html&gt;<br/> &lt;html&gt;<br/> &lt;body&gt;<br/> &lt;h1&gt;Iris Classification&lt;/h1&gt;<br/> &lt;form action=’iris-app.php’ method=’GET’&gt;<br/> &lt;p&gt;Enter Sepal Length&lt;/p&gt;<br/> &lt;input type=’text’ name=’slength’/&gt;<br/> &lt;br/&gt;<br/> &lt;p&gt;Enter Sepal Width&lt;/p&gt;<br/> &lt;input type=’text’ name=’swidth’/&gt;<br/> &lt;br/&gt;<br/> &lt;p&gt;Enter Petal Length&lt;/p&gt;<br/> &lt;input type=’text’ name=’plength’/&gt;<br/> &lt;br/&gt;<br/> &lt;p&gt;Enter Petal Width&lt;/p&gt;<br/> &lt;input type=’text’ name=’pwidth’/&gt;<br/> &lt;br/&gt;<br/> &lt;input type=’submit’ name=’Submit’/&gt;<br/> &lt;input type=’hidden’ name=’submitted’ value=’true’/&gt;<br/> &lt;/form&gt;</span><span id="c334" class="lc jv hi ky b fi lh le l lf lg">&lt;/body&gt;<br/> &lt;/html&gt;”;</span><span id="71a0" class="lc jv hi ky b fi lh le l lf lg">echo $form;</span></pre><p id="a869" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">注意Submit下面的额外输入标记。它将用于通知程序表单已经提交。</p><p id="499f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">它应该是这样的:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es li"><img src="../Images/dec2cf5cfe69ce7c56c1a2a0285a3d1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1084/format:webp/1*TCl-HQbonzJ5Q8kxE27ZJQ.png"/></div></figure><p id="e86f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当用户单击submit时，它将重定向回同一个文件，因为这是我们执行API请求的地方。然后，我们必须将表单包含在if-else语句中，这样，只有当用户单击submit时，请求才会发生。如果没有，那么表单就会一直显示出来。</p><p id="f554" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">代码将会是:</p><pre class="jf jg jh ji fd kx ky kz la aw lb bi"><span id="66d8" class="lc jv hi ky b fi ld le l lf lg">&lt;?php<br/> if(isset($_GET[‘submitted’])){<br/> //API Request Goes Here<br/> }<br/> else{<br/>   $form = “<br/>   &lt;!DOCTYPE html&gt;<br/>   &lt;html&gt;<br/>    &lt;body&gt;</span><span id="be1d" class="lc jv hi ky b fi lh le l lf lg">      &lt;h1&gt;Iris Classification&lt;/h1&gt;<br/>      &lt;form action=’home.php’ method=’GET’&gt;<br/>        &lt;p&gt;Enter Sepal Length&lt;/p&gt;<br/>        &lt;input type=’text’ name=’slength’/&gt;<br/>        &lt;br/&gt;<br/>        &lt;p&gt;Enter Sepal Width&lt;/p&gt;<br/>        &lt;input type=’text’ name=’swidth’/&gt;<br/>        &lt;br/&gt;<br/>        &lt;p&gt;Enter Petal Length&lt;/p&gt;<br/>        &lt;input type=’text’ name=’plength’/&gt;<br/>        &lt;br/&gt;<br/>        &lt;p&gt;Enter Petal Width&lt;/p&gt;<br/>        &lt;input type=’text’ name=’pwidth’/&gt;<br/>        &lt;br/&gt;<br/>        &lt;input type=’submit’ name=’Submit’/&gt;<br/>        &lt;input type=’hidden’ name=’submitted’ value=’true’/&gt;<br/>      &lt;/form&gt;</span><span id="fedb" class="lc jv hi ky b fi lh le l lf lg">    &lt;/body&gt;<br/>  &lt;/html&gt;”;</span><span id="6f16" class="lc jv hi ky b fi lh le l lf lg">  echo $form;<br/>}</span></pre><p id="127d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">cURL库可以用来在PHP中发出HTTP请求。我们首先使用curl_init()初始化一个curl会话，然后只使用curl_setopt()发出API请求，其中有三个参数:</p><p id="8109" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">* cURL_handler —使用` curl_init()` <br/> *选项初始化cURL时返回—要更改的设置的常数值。对于这个程序，我们使用“CURLOPT_URL ”,因为我们想要传递一个URL作为第三个参数<br/> * Value中的值——用于设置的值。在这种情况下，我们调用API以及用户的输入作为查询。</p><p id="a435" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一旦设置好，我们就用“curl_exec()”发出请求，最后用“curl_close”关闭curl会话。</p><p id="580d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">完整代码写在下面:</p><pre class="jf jg jh ji fd kx ky kz la aw lb bi"><span id="df51" class="lc jv hi ky b fi ld le l lf lg">$swidth = $_GET[‘swidth’];<br/>$slength = $_GET[‘slength’];<br/>$pwidth = $_GET[‘pwidth’];<br/>$plength = $_GET[‘plength’];<br/>$ch = curl_init();<br/>curl_setopt($ch, CURLOPT_URL, “<a class="ae jd" href="https://iris-classification-model.herokuapp.com/classify?swidth=" rel="noopener ugc nofollow" target="_blank">https://iris-classification-model.herokuapp.com/classify?swidth=</a>".$swidth."&amp;slength=".$slength."&amp;pwidth=".$pwidth."&amp;plength=".$plength);<br/>$result = curl_exec($ch);<br/>curl_close($ch);</span></pre><p id="ab88" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们完事了。如果我们用这些值运行程序:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lj"><img src="../Images/909cf2e3b83d3f61daa93cdd0ad331d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:650/format:webp/1*xTxIShNemL_z1IazyiTzrg.png"/></div></div></figure><p id="0ff3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们得到虹膜分类为:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es lk"><img src="../Images/4c266afbf3c6fc84e2f0779d0fcc79f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:452/format:webp/1*8Qxshijmxbyg3-bEnYscQA.png"/></div></figure><p id="e0a8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">万岁！现在我们有了模型API和接口🎉！</p></div><div class="ab cl ll lm gp ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="hb hc hd he hf"><p id="1b25" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">嘿，你好！如果你喜欢读我的文章，并且想请我喝杯茶🍵，<em class="ls">我将非常感谢您在</em><a class="ae jd" href="https://www.buymeacoffee.com/andreagon" rel="noopener ugc nofollow" target="_blank">https://www.buymeacoffee.com/andreagon</a>的支持</p><p id="41de" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="ls">祝您度过愉快的一天！</em></p></div></div>    
</body>
</html>