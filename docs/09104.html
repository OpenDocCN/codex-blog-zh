<html>
<head>
<title>Streamlit🔥+ FastAPI⚡️- The ingredients you need for your next Data Science Recipe</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">细流🔥+ FastAPI⚡️-你下一个数据科学配方所需的成分</h1>
<blockquote>原文：<a href="https://medium.com/codex/streamlit-fastapi-%EF%B8%8F-the-ingredients-you-need-for-your-next-data-science-recipe-ffbeb5f76a92?source=collection_archive---------0-----------------------#2022-09-25">https://medium.com/codex/streamlit-fastapi-%EF%B8%8F-the-ingredients-you-need-for-your-next-data-science-recipe-ffbeb5f76a92?source=collection_archive---------0-----------------------#2022-09-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/d602ef86e90fad842afed95d1153be5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KwDpCNjFZ9fg2cCUWTkiUw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd iu">作者图片</strong></figcaption></figure><p id="d5c2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><a class="ae jt" href="https://streamlit.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ix hj"> Streamlit </strong> </a>是一个<strong class="ix hj">开源、免费、全python框架，为数据科学/机器学习项目快速构建和共享交互式仪表盘和web应用</strong> <strong class="ix hj">。</strong></p><p id="e6dc" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Streamlit的口号是<strong class="ix hj"> <em class="ju">“构建和分享数据app的最快方式”</em> </strong> <em class="ju">，</em>哪个是真的<em class="ju">。</em>这个框架使得数据科学家和机器学习工程师可以轻松地创建强大的用户界面，并且<strong class="ix hj">将jupyter notebook/ python脚本转换为交互式应用</strong>和<strong class="ix hj">无需担心</strong>视图、模板和JS。要使其具有交互性，您只需编写一个python脚本，它就会从<strong class="ix hj">顶部运行到底部</strong>。</p><p id="6a61" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">虽然Streamlit可以用于生产，但它最适合快速原型制作。通过使用<a class="ae jt" href="https://fastapi.tiangolo.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="ix hj"> FastAPI </strong> </a>提供机器学习/数据科学模型，在原型获得批准后，您可以使用Dash或React快速转移到生产就绪的UI。</p><p id="c50a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这篇简短的博文中，我将介绍以下步骤:</p><ol class=""><li id="86f5" class="jv jw hi ix b iy iz jc jd jg jx jk jy jo jz js ka kb kc kd bi translated">创建一个基本的Python计算器模块。</li><li id="925a" class="jv jw hi ix b iy ke jc kf jg kg jk kh jo ki js ka kb kc kd bi translated"><strong class="ix hj">使用FastAPI从模块中提供函数。</strong></li><li id="e749" class="jv jw hi ix b iy ke jc kf jg kg jk kh jo ki js ka kb kc kd bi translated"><strong class="ix hj">使用Streamlit创建一个非常基本的用户界面。</strong></li><li id="1509" class="jv jw hi ix b iy ke jc kf jg kg jk kh jo ki js ka kb kc kd bi translated"><strong class="ix hj">整合细流&amp; FastAPI。</strong></li></ol><p id="ec45" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我在这里不打算使用任何花哨的机器学习模型，一旦我们掌握了FastAPI + Streamlit pipeline的知识，我们就可以<strong class="ix hj">将其扩展到任何数据科学/机器学习模型。</strong></p><figure class="kj kk kl km fd ij"><div class="bz dy l di"><div class="kn ko l"/></div></figure><h1 id="a1dc" class="kp kq hi bd iu kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">步骤1:创建计算器模块</h1><p id="97e0" class="pw-post-body-paragraph iv iw hi ix b iy lm ja jb jc ln je jf jg lo ji jj jk lp jm jn jo lq jq jr js hb bi translated">一个<a class="ae jt" href="https://docs.python.org/3/tutorial/modules.html" rel="noopener ugc nofollow" target="_blank"> <strong class="ix hj">模块</strong> </a>就是一个python脚本，包含了一组你想要包含在你的应用中的函数。在这里，我们正在构建一个计算器应用程序，所以我们需要的输入是数字和我们想要执行的操作。</p><p id="23dd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们创建一个函数<strong class="ix hj"> <em class="ju">计算</em> </strong>用于同样的目的，分别用参数<strong class="ix hj"> <em class="ju">运算，x</em></strong>&amp;<strong class="ix hj"><em class="ju">y</em></strong>并将其保存为<strong class="ix hj"><em class="ju">calculator . py</em></strong>模块。</p><p id="acbd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这是一个非常基本的函数，它简单地对使用<code class="du lr ls lt lu b"><strong class="ix hj"><em class="ju">if-elif</em></strong></code>块传递的操作名执行操作，并返回结果。</p><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lv"><img src="../Images/bcd24c15a65c81c9d07ebec46579e4c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qG5XxuhK_ZoSmyXaCZKIew.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd iu">带计算功能的计算器模块:作者图片</strong></figcaption></figure><h1 id="afa5" class="kp kq hi bd iu kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">步骤2:使用FastAPI ⚡创建API</h1><p id="2ffc" class="pw-post-body-paragraph iv iw hi ix b iy lm ja jb jc ln je jf jg lo ji jj jk lp jm jn jo lq jq jr js hb bi translated">想温习一下<strong class="ix hj"> FastAPI基础知识吗？阅读本</strong>👉<a class="ae jt" href="https://afaqueumer.medium.com/fastapi-fundamentals-getting-faster-with-fastapi-866545b841ca" rel="noopener">📖</a></p><p id="f772" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这里我们将创建一个基本的请求体。我们将创建一个User_input类，使用<a class="ae jt" href="https://pydantic-docs.helpmanual.io/usage/models/" rel="noopener ugc nofollow" target="_blank"> <strong class="ix hj"> pydantic的BaseModel </strong> </a>进行类型验证，并将参数发送到<strong class="ix hj"> <em class="ju">计算器函数</em> </strong>，我们将简单地从上面创建的<strong class="ix hj"> <em class="ju">计算器模块</em> </strong>中导入该函数。</p><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lw"><img src="../Images/981c76601d60f75f157c7c58594428ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wfefu_6Tl5wr97_qOEW94w.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd iu"> FastAPI脚本:作者图片</strong></figcaption></figure><p id="4259" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了运行FastAPI服务器，我们需要运行以下命令:</p><pre class="kj kk kl km fd lx lu ly bn lz ma bi"><span id="5c5a" class="mb kq hi lu b be mc md l me mf"><strong class="lu hj">uvicorn fast_api:app --reload</strong></span></pre><p id="7949" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们现在可以在这里打开Swagger UI👉<code class="du lr ls lt lu b"><a class="ae jt" href="http://127.0.0.1:8000/docs" rel="noopener ugc nofollow" target="_blank"><strong class="ix hj">http://127.0.0.1:8000/docs</strong></a></code></p><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mg"><img src="../Images/32543c28aeb9407f8899982ea0bbf2c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vN2IHcf-7OsLHh_ClI7V4w.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd iu"> Swagger UI:作者图片</strong></figcaption></figure><p id="2027" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们在<a class="ae jt" href="https://www.thunderclient.com/" rel="noopener ugc nofollow" target="_blank">迅雷客户端</a>中测试一下我们的路径操作。</p><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mh"><img src="../Images/a23ac0746987eca7383918f291350d8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nJ9hZUA-iGzuJQY1WGu0XQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd iu">请求&amp;响应:作者图片</strong></figcaption></figure><figure class="kj kk kl km fd ij"><div class="bz dy l di"><div class="mi ko l"/></div></figure><p id="b5c4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这就完成了我们的后端流程。我们已经创建了一个模块和一个API，通过导入模块来调用函数。</p><p id="b68f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">REST APIs的主要好处之一是<strong class="ix hj"> REST协议将数据存储(后端)和UI(前端)与服务器</strong>分离，从而允许客户端和服务器独立。</p><h1 id="2bc3" class="kp kq hi bd iu kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated"><strong class="ak">第三步。使用Streamlit </strong>创建网络应用🔥</h1><p id="6d41" class="pw-post-body-paragraph iv iw hi ix b iy lm ja jb jc ln je jf jg lo ji jj jk lp jm jn jo lq jq jr js hb bi translated">为了创建UI，我们将使用Streamlit，这是一个应用程序框架，使数据科学家和机器学习工程师可以在几分钟内轻松地将数据脚本创建到可共享的web应用程序中。全是纯Python。不需要前端经验，✨.</p><figure class="kj kk kl km fd ij"><div class="bz dy l di"><div class="mj ko l"/></div></figure><p id="eec7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">您可以通过pip安装streamlit:</p><pre class="kj kk kl km fd lx lu ly bn lz ma bi"><span id="6416" class="mb kq hi lu b be mc md l me mf"><strong class="lu hj">pip install streamlit</strong></span></pre><p id="17bc" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">您可以从这里了解更多关于Streamlit的信息👉<code class="du lr ls lt lu b"><a class="ae jt" href="https://streamlit.io/" rel="noopener ugc nofollow" target="_blank"><strong class="ix hj">https://streamlit.io/</strong></a></code></p><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mk"><img src="../Images/306d62144a50205fc82ece2456323e7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5ebJIe30kzjmAjjxB1PNwg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd iu"> Streamlit应用程序脚本:作者图片</strong></figcaption></figure><p id="2c5c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在上述应用程序中，我使用了以下组件:</p><pre class="kj kk kl km fd lx lu ly bn lz ma bi"><span id="da7a" class="mb kq hi lu b be mc md l me mf"><strong class="lu hj">st.title:</strong> Display text in title formatting.</span></pre><pre class="ml lx lu ly bn lz ma bi"><span id="eea8" class="mb kq hi lu b be mc md l me mf"><strong class="lu hj">st.write:</strong> Write arguments to the app.</span></pre><pre class="ml lx lu ly bn lz ma bi"><span id="460e" class="mb kq hi lu b be mc md l me mf"><strong class="lu hj">st.selectbox:</strong> Display a select widget.</span></pre><pre class="ml lx lu ly bn lz ma bi"><span id="d362" class="mb kq hi lu b be mc md l me mf"><strong class="lu hj">st.slider:</strong> Display a slider widget.</span></pre><pre class="ml lx lu ly bn lz ma bi"><span id="22a0" class="mb kq hi lu b be mc md l me mf"><strong class="lu hj">st.button:</strong> Display a button widget.</span></pre><p id="34e6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了运行streamlit服务器，我们需要运行以下命令:</p><pre class="kj kk kl km fd lx lu ly bn lz ma bi"><span id="275a" class="mb kq hi lu b be mc md l me mf"><strong class="lu hj">streamlit run stream_lit.py</strong></span></pre><p id="5986" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">它将在浏览器中启动应用程序，您可以转到<code class="du lr ls lt lu b"><a class="ae jt" href="http://localhost:8501/" rel="noopener ugc nofollow" target="_blank"><strong class="ix hj">http://localhost:8501</strong></a></code>web应用程序将如下所示👇</p><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mm"><img src="../Images/ac20fe05e432addfcdf72a64a953ce34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N0OvXQm788Z2WK1VsgtUOA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd iu"> Streamlit应用:作者图片</strong></figcaption></figure><p id="fb16" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因此，我们的UI只用几行代码就创建好了。这将允许用户从选择框中选择一个操作，使用滑块选择x和y的值(默认情况下，值分别定义为20和10)。它应该显示一些结果后，按下计算按钮。</p><h1 id="cdbe" class="kp kq hi bd iu kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">步骤4:用后端组装前端</h1><figure class="kj kk kl km fd ij"><div class="bz dy l di"><div class="mn ko l"/></div></figure><p id="a2f4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了避免错误和运行良好的应用程序，我们需要确保我们的前端和后端服务器启动和运行。</p><pre class="kj kk kl km fd lx lu ly bn lz ma bi"><span id="3896" class="mb kq hi lu b be mc md l me mf"># For running streamlit app<br/><strong class="lu hj">streamlit run stream_lit.py</strong></span></pre><pre class="ml lx lu ly bn lz ma bi"><span id="d924" class="mb kq hi lu b be mc md l me mf"># For running backend with FastAPI<br/><strong class="lu hj">uvicorn fast_api:app --reload</strong></span></pre><p id="b3e0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><code class="du lr ls lt lu b"><strong class="ix hj">st.button </strong></code>是一个布尔组件，如果按钮在应用程序的最后一次运行中被点击，它返回一个<strong class="ix hj">真</strong>，否则返回<strong class="ix hj">假</strong>。我们将在<strong class="ix hj"> if-else </strong>块&amp;中利用这一点。只有当按钮被点击时，我们才会发送请求。这将避免更大的应用程序中不必要的操作，并可以节省机器学习应用程序中的大量计算损失。</p><p id="e9ad" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们将使用<a class="ae jt" href="https://pypi.org/project/requests/" rel="noopener ugc nofollow" target="_blank"> <strong class="ix hj"> Python的请求</strong> </a>库来集成streamlit脚本中的后端。在streamlit应用程序中，我们将输入存储到一个字典变量<code class="du lr ls lt lu b"><strong class="ix hj">inputs = {"operation": option, "x": x, "y": y}</strong></code></p><p id="072b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">JSON是一种存储和交换数据的语法。如果您有一个Python对象，您可以使用<code class="du lr ls lt lu b"><strong class="ix hj">json.dumps()</strong></code>方法将其转换成JSON。</p><p id="d649" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们将把我们的python对象<strong class="ix hj"> <em class="ju">输入</em> </strong>转换成JSON格式，同时向我们的API发送请求。</p><pre class="kj kk kl km fd lx lu ly bn lz ma bi"><span id="1f06" class="mb kq hi lu b be mc md l me mf"><strong class="lu hj">requests.post(<em class="ju">url</em> = “http://127.0.0.1:8000/calculate", <br/>              <em class="ju">data</em> = json.dumps(inputs))</strong></span></pre><p id="faf7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们已经在步骤2中测试了对我们请求的响应。因此，我们将简单地在应用程序中编写响应作为操作的结果。</p><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mo"><img src="../Images/2bc84ed7142d5b7fdbcb9312e4048927.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j3qLbpaTZPwqugX_bVHS8g.png"/></div></div></figure><figure class="kj kk kl km fd ij"><div class="bz dy l di"><div class="mp ko l"/></div></figure><p id="6422" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">恭喜你！！！现在我们知道如何创建一个全功能的web应用程序。</p><p id="b90d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我将尝试提出更多机器学习/数据科学概念，并将尝试将听起来很花哨的术语和概念分解成更简单的术语和概念。</p><p id="9f97" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我希望你喜欢这篇文章！你可以<strong class="ix hj">关注我</strong> <a class="mq mr ge" href="https://medium.com/u/430bc504f9d9?source=post_page-----ffbeb5f76a92--------------------------------" rel="noopener" target="_blank"> Afaque Umer </a>获取<strong class="ix hj">更多</strong>这样的文章。</p><h2 id="2349" class="ms kq hi bd iu mt mu mv ku mw mx my ky jg mz na lc jk nb nc lg jo nd ne lk nf bi translated">感谢阅读🙏</h2><h2 id="c465" class="ms kq hi bd iu mt mu mv ku mw mx my ky jg mz na lc jk nb nc lg jo nd ne lk nf bi translated">继续学习🧠继续分享🤝保持敬畏🤘</h2></div></div>    
</body>
</html>