# å¦‚ä½•ä½¿ç”¨ Sendbird Chat åœ¨ React æœ¬æœºåº”ç”¨ç¨‹åºä¸­å®ç°æ¨é€é€šçŸ¥

> åŸæ–‡ï¼š<https://medium.com/codex/how-to-implement-push-notifications-in-a-react-native-app-using-sendbird-chat-a828f0aaca6f?source=collection_archive---------2----------------------->

![](img/f85edf89aa6d9ddc2251ab1aaee58e4c.png)

ä»™é¸Ÿ 2022

## å…³äºå¦‚ä½•ä½¿ç”¨ React Native for Android å’Œ iOS åŠæ—¶å‘é€æ¨é€é€šçŸ¥çš„åˆ†æ­¥æ•™ç¨‹

ç”±å¡”å“ˆÂ·è¨å‰å°”
è§£å†³æ–¹æ¡ˆå·¥ç¨‹å¸ˆ| [Sendbird](https://www.sendbird.com/)

*æˆ‘ä»¬å»ºè®®æ‚¨æŸ¥çœ‹* [*æ ·æœ¬ app*](https://github.com/sendbird/sendbird-chat-sdk-javascript) *è·å–æ‚¨å¯èƒ½éœ€è¦çš„ä»£ç ã€‚å¦‚æœæ‚¨éœ€è¦æ›´å¤šæŒ‡å¯¼ï¼Œè¯·è®¿é—®æˆ‘ä»¬çš„* [*æ–‡æ¡£*](https://sendbird.com/docs/chat/v4/javascript/guides/push-notifications#1-push-notifications) *ã€‚ä¸è¦å¿˜è®°æŸ¥çœ‹åº”ç”¨å†…èŠå¤©çš„* [*æ¼”ç¤º*](https://sendbird.com/demos/in-app-chat) *ï¼Œå¹¶è®¿é—®æˆ‘ä»¬çš„* [*ç½‘ç«™*](https://sendbird.com/features/chat-messaging) *äº†è§£æ›´å¤šå…³äº Sendbird Chat å¯ä»¥æä¾›çš„æœåŠ¡ã€‚*

> *ä¸ºäº†ç¬¬ä¸€ä¸ªäº†è§£æ–°æ•™ç¨‹ã€å¼€å‘è€…ç›¸å…³èŠå¤©/ç”µè¯å‘å¸ƒä»¥åŠå…¶ä»–é‡è¦æ›´æ–°ï¼Œ* [*æ³¨å†Œ*](https://get.sendbird.com/dev-newsletter-subscription.html) *è·å–æˆ‘ä»¬çš„å¼€å‘è€…ç®€è®¯ã€‚*

# ç®€ä»‹:ä»€ä¹ˆæ˜¯æ¨é€é€šçŸ¥ï¼Œä¸ºä»€ä¹ˆå®ƒä»¬å¾ˆé‡è¦ï¼Ÿ

æ¨é€é€šçŸ¥æ˜¯ç”±åº”ç”¨ç¨‹åºå‘å…¶ç”¨æˆ·å‘é€çš„è‡ªåŠ¨ã€å¯ç‚¹å‡»çš„å¼¹å‡ºæ¶ˆæ¯ã€‚å½“è®¾å¤‡ç©ºé—²æˆ–åœ¨åå°è¿è¡Œåº”ç”¨ç¨‹åºæ—¶ï¼Œæ¶ˆæ¯ä¼šç«‹å³å‘é€åˆ°è®¾å¤‡ã€‚æ¨é€é€šçŸ¥éå¸¸é‡è¦ï¼Œå› ä¸ºå®ƒä»¬:

*   ä¼ é€’ä¸ç”¨æˆ·æ´»åŠ¨æˆ–å…´è¶£ç›¸å…³çš„é‡è¦ä¿¡æ¯ã€æé†’å’Œæ–°é—»
*   é¼“åŠ±ç”¨æˆ·å‚ä¸ä½ çš„åº”ç”¨
*   å±•ç¤ºç‰¹è‰²å†…å®¹
*   æ¨åŠ¨æœ‰é’ˆå¯¹æ€§çš„ç›¸å…³æµé‡ï¼Œæé«˜è½¬åŒ–ç‡
*   ä½¿ç”¨ä¸ªæ€§åŒ–ã€é€‚æ—¶ã€ç›¸å…³çš„å†…å®¹åˆ›å»ºæ— ç¼çš„ç”¨æˆ·ä½“éªŒ

å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œç¾å›½æ™ºèƒ½æ‰‹æœºç”¨æˆ·å¹³å‡æ¯å¤©ä¼šæ”¶åˆ° [**45 æ¡æ¨é€é€šçŸ¥**](https://www.businessofapps.com/marketplace/push-notifications/research/push-notifications-statistics/) ï¼æ ¹æ® [**RubyGarage**](https://rubygarage.org/blog/benefits-of-push-notifications) çš„æ•°æ®ï¼Œå®æ–½æ¨é€é€šçŸ¥çš„ç»„ç»‡æ¯”æ²¡æœ‰å®æ–½çš„ç»„ç»‡æ‹¥æœ‰é«˜ 3 å€çš„å®¢æˆ·ä¿æŒç‡å’Œ 88%çš„å‚ä¸åº¦ã€‚è™½ç„¶åŸºäºè¡Œä¸šã€ä½ç½®ã€[](https://www.braze.com/docs/user_guide/message_building_by_channel/push/types)**ç±»å‹å’Œè®¸å¤šå…¶ä»–å› ç´ ï¼Œæ¨é€é€šçŸ¥é€‰æ‹©åŠ å…¥å’Œç‚¹å‡»ç‡å­˜åœ¨ [**å˜åŒ–**](https://www.businessofapps.com/marketplace/push-notifications/research/push-notifications-statistics/) ï¼Œä½†æ˜¾ç„¶å®ç°æ¨é€é€šçŸ¥çš„ç†ç”±å¾ˆå……åˆ†ã€‚**

**æœ¬æ•™ç¨‹æä¾›äº†å®ç° React æœ¬æœºæ¨é€é€šçŸ¥çš„åˆ†æ­¥è¯´æ˜ã€‚ä½†é¦–å…ˆï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹ä¸€äº›å…ˆå†³æ¡ä»¶ã€‚**

# **å…ˆå†³æ¡ä»¶**

1.  **åˆ›å»ºä¸€ä¸ª [**Sendbird è´¦å·**](https://dashboard.sendbird.com/auth/signup) ã€‚**
2.  **ç¡®ä¿ [**ä»™é¸ŸèŠå¤©**](https://sendbird.com/features/chat-messaging) åœ¨ä½ çš„ React åŸç”Ÿåº”ç”¨ä¸­è¿è¡Œè‰¯å¥½ã€‚**

**è¯·è®°ä½ï¼Œå½“ä»åº”ç”¨ç¨‹åºå‘ Sendbird æœåŠ¡å™¨å‘é€æ¶ˆæ¯æ—¶(é€šè¿‡ JavaScript çš„ [**èŠå¤© SDK**](https://github.com/sendbird/sendbird-chat-sdk-javascript)),æœåŠ¡å™¨ä¸ FCM è¿›è¡Œé€šä¿¡ã€‚ç„¶åï¼ŒFCM å‘ Android è®¾å¤‡å‘é€æ¨é€é€šçŸ¥ï¼Œæˆ–è€…ä¸ APN é€šä¿¡ï¼Œå‘ iOS è®¾å¤‡å‘é€æ¨é€é€šçŸ¥ã€‚**

# **React æœ¬æœºåº”ç”¨ç¨‹åºçš„æ¨é€é€šçŸ¥**

**å¯ä»¥ä½¿ç”¨ç”¨äº JavaScript çš„[**Sendbird Chat SDK**](https://github.com/sendbird/sendbird-chat-sdk-javascript)å‘æ··åˆç§»åŠ¨åº”ç”¨ç”¨æˆ·(Android å’Œ iOS)å‘é€æ¨é€é€šçŸ¥ã€‚ç›®å‰ï¼ŒJavaScript SDK çš„æ¨é€é€šçŸ¥åŠŸèƒ½ä»…ä¸ React Native å…¼å®¹ã€‚æœ¬æ•™ç¨‹æä¾›äº†ä½¿ç”¨ Firebase Cloud Messaging (FCM)å’Œ Sendbird Chat SDK åœ¨ React æœ¬æœºåº”ç”¨ç¨‹åºä¸­å¯ç”¨æ¨é€é€šçŸ¥çš„è¯¦ç»†ä¿¡æ¯ã€‚**

**åœ¨æ·±å…¥å®ç°ç»†èŠ‚ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥è°ˆè°ˆ [**FCM æ¶ˆæ¯**](https://firebase.google.com/docs/cloud-messaging/concept-options) ã€‚æœ‰ä¸¤ç§ç±»å‹çš„ FCM æ¶ˆæ¯:é€šçŸ¥æ¶ˆæ¯å’Œæ•°æ®æ¶ˆæ¯ã€‚æ ¹æ® [**Firebase æ–‡æ¡£**](https://firebase.google.com/docs/cloud-messaging/concept-options) ï¼Œâ€œé€šçŸ¥æ¶ˆæ¯æœ‰ä¸€ç»„é¢„å®šä¹‰çš„ç”¨æˆ·å¯è§çš„é”®å’Œä¸€ä¸ªå¯é€‰çš„è‡ªå®šä¹‰é”®-å€¼å¯¹çš„æ•°æ®è´Ÿè½½ã€‚â€æ•°æ®æ¶ˆæ¯åªåŒ…å«ç”¨æˆ·å®šä¹‰çš„é”®å€¼å¯¹ã€‚Sendbird ä½¿ç”¨æ•°æ®æ¶ˆæ¯ï¼Œå…è®¸å®¢æˆ·ç«¯åº”ç”¨ç¨‹åºåˆ›å»ºç”±è¿™äº›è‡ªå®šä¹‰é”®å€¼å¯¹ç»„æˆçš„è‡ªå®šä¹‰æ¶ˆæ¯æœ‰æ•ˆè´Ÿè½½ã€‚**

**web åº”ç”¨ç¨‹åºä¸æ”¯æŒæ¨é€é€šçŸ¥ã€‚å¦‚æœæ‚¨éœ€è¦ä¸º web åº”ç”¨ç¨‹åºå®ç°æ¨é€é€šçŸ¥ï¼Œæˆ‘ä»¬å»ºè®®ä½¿ç”¨ webhook äº‹ä»¶æ¥ä¸º web åº”ç”¨ç¨‹åºå®ç°æ¨é€é€šçŸ¥ã€‚**

**å¼€å§‹ä¹‹å‰ï¼Œè¯·ç¡®ä¿æ‚¨å¯ä»¥è®¿é—® [**Firebase æ§åˆ¶å°**](https://console.firebase.google.com/) ã€‚è®©æˆ‘ä»¬å¼€å§‹å§ï¼ğŸ’»**

# **æ­¥éª¤ 1:å‘ Sendbird ä»ªè¡¨æ¿æ³¨å†Œ FCM å‡­è¯å’Œ APNs è¯ä¹¦**

**Sendbird æœåŠ¡å™¨éœ€è¦ç”¨äº Android çš„ FCM æœåŠ¡å™¨å¯†é’¥å’Œç”¨äº iOS çš„ APNs è¯ä¹¦æ¥ä¼ é€æ¨é€é€šçŸ¥ã€‚**

**æŒ‰ç…§æœ¬ [**æ•™ç¨‹**](https://sendbird.com/developer/tutorials/implement-android-push-notifications) ä¸­çš„æ­¥éª¤ 1 å’Œ 2 æ³¨å†Œ FCM å‡­è¯ï¼Œå¹¶æŒ‰ç…§ [**æ–‡æ¡£**](https://sendbird.com/docs/chat/v3/ios/guides/push-notifications#2-how-to-register-push-notification-credentials) ä¸­çš„è¯´æ˜å°† APNs è¯ä¹¦æ³¨å†Œåˆ° Sendbird ä»ªè¡¨æ¿ã€‚**

# **æ­¥éª¤ 2:å®‰è£… React Native Firebase æ¨¡å—å¹¶æ·»åŠ é…ç½®æ–‡ä»¶**

**[**React Native Firebase**](https://rnfirebase.io/)æ˜¯å®˜æ–¹æ¨èçš„è½¯ä»¶åŒ…é›†åˆï¼Œä¸º Android å’Œ iOS åº”ç”¨ç¨‹åºä¸Šçš„æ‰€æœ‰ Firebase æœåŠ¡å¸¦æ¥ React åŸç”Ÿæ”¯æŒã€‚æŒ‰ç…§ [**å®˜æ–¹æ–‡æ¡£**](https://rnfirebase.io/) ä¸­çš„è¯´æ˜ï¼Œåœ¨ React åŸç”Ÿé¡¹ç›®ä¸­ä¸º Android é…ç½® FCMï¼Œä¸º iOS é…ç½® APNsã€‚åˆ°è¿™ä¸€æ­¥ç»“æŸæ—¶ï¼Œæ‚¨åº”è¯¥å·²ç»å°† Android å’Œ iOS åº”ç”¨ç¨‹åºæ·»åŠ åˆ° Firebase é¡¹ç›®ä¸­ï¼Œå¹¶å°†å„è‡ªçš„é…ç½®æ–‡ä»¶æ·»åŠ åˆ° React åŸç”Ÿé¡¹ç›®ä¸­ã€‚**

**è¯·å‚è€ƒ React Native Firebase [**é€šçŸ¥**](https://rnfirebase.io/messaging/notifications) é¡µé¢ï¼Œäº†è§£æœ‰å…³æ˜¾ç¤ºå’Œå¤„ç†æ¥è‡ª FCM çš„é€šçŸ¥çš„æ›´å¤šä¿¡æ¯ã€‚**

# **æ­¥éª¤ 3:å‘ Sendbird æœåŠ¡å™¨æ³¨å†Œæ¨é€ä»¤ç‰Œ**

**è¦å‘ç‰¹å®šçš„å®¢æˆ·ç«¯åº”ç”¨ç¨‹åºå‘é€é€šçŸ¥æ¶ˆæ¯ï¼ŒFCM éœ€è¦ç”±å®¢æˆ·ç«¯åº”ç”¨ç¨‹åºå®ä¾‹é¢å‘çš„ç”¨äº Android è®¾å¤‡çš„ FCM æ³¨å†Œä»¤ç‰Œå’Œç”¨äº iOS è®¾å¤‡çš„ APNs è®¾å¤‡ä»¤ç‰Œã€‚å› æ­¤ï¼ŒSendbird æœåŠ¡å™¨è¿˜éœ€è¦æ¯ä¸ªå®¢æˆ·ç«¯åº”ç”¨ç¨‹åºå®ä¾‹çš„æ³¨å†Œä»¤ç‰Œæ¥ä»£è¡¨æ‚¨å‘ FCM å‘é€é€šçŸ¥è¯·æ±‚ã€‚Chat SDK æä¾›äº†ä¸€ä¸ªæ¥å£ï¼Œç”¨äºå‘ Sendbird æœåŠ¡å™¨æ³¨å†Œå’Œæ³¨é”€è¿™ä¸¤ç§ç±»å‹çš„ä»¤ç‰Œã€‚**

**ä¸‹é¢çš„ä»£ç ç‰‡æ®µæ˜¾ç¤ºäº†è®¾å¤‡ä»¤ç‰Œæ³¨å†Œã€‚**

**æ³¨å†Œçš„æ¨é€ä»¤ç‰Œå‡ºç°åœ¨ä»ªè¡¨æ¿ä¸­çš„â€œç”¨æˆ·>ç”¨æˆ· id >èŠå¤©â€ä¸‹:**

**![](img/7084c3f97b839ec18c6ff9206290a36c.png)**

# **æ­¥éª¤ 4:æ¥æ”¶æ¨é€é€šçŸ¥æ¶ˆæ¯**

**ä¸€æ—¦æ³¨å†Œäº†è®¾å¤‡ä»¤ç‰Œï¼Œå®¢æˆ·ç«¯åº”ç”¨ç¨‹åºå®ä¾‹å°±å¯ä»¥æ¥æ”¶å’Œå¤„ç† FCM é€šçŸ¥æ¶ˆæ¯ï¼Œè€Œä¸ç®¡æ˜¯ iOS è¿˜æ˜¯ Android å¹³å°ã€‚å‚è€ƒ React Native Firebase æ–‡æ¡£çš„ [**ç”¨æ³•**](https://rnfirebase.io/messaging/usage#usage) é¡µé¢ï¼Œäº†è§£æ›´å¤šå…³äºå®ç°çš„ä¿¡æ¯ã€‚**

**Sendbird Chat SDK for JavaScript ä¸ä¼šè‡ªåŠ¨æ£€æµ‹åº”ç”¨ç¨‹åºçš„çŠ¶æ€ï¼Œå› æ­¤éœ€è¦æ˜¾å¼è°ƒç”¨ Sendbird SDK æä¾›çš„ **setForegroundState** ()å’Œ **setBackgroundState** ()æ–¹æ³•ã€‚**

**æŸ¥çœ‹ React Native Firebase æ–‡æ¡£ï¼Œäº†è§£ [**æ¥æ”¶æ¶ˆæ¯**](https://rnfirebase.io/messaging/usage#receiving-messages) çš„å¯ç”¨äº‹ä»¶å¤„ç†ç¨‹åºã€‚ä¸‹é¢çš„ä»£ç ç‰‡æ®µæ˜¾ç¤ºäº†æ¥æ”¶åˆ°çš„ FCM æ¶ˆæ¯çš„è§£æã€‚**

**æ³¨æ„:é¢‘é“æ˜¯ Android ç‹¬æœ‰çš„æ¦‚å¿µï¼Œç”¨äºåˆ†ç±»å¹¶å…è®¸ç”¨æˆ·æ§åˆ¶å¦‚ä½•åœ¨ä»–ä»¬çš„è®¾å¤‡ä¸Šå¤„ç†é€šçŸ¥ã€‚**

**ä» FCM æ•°æ®æ¶ˆæ¯è§£æçš„æ•°æ®å¯¹è±¡åŒ…å«ä¸€ç»„é”®å€¼é¡¹ç›®ï¼Œå¦‚ä¸‹é¢çš„ JSON ä»£ç æ‰€ç¤ºã€‚**

# **æ¨é€é€šçŸ¥çš„æ•…éšœæ’é™¤æç¤º**

**æ¨é€é€šçŸ¥çš„æ•…éšœæ’é™¤å¯èƒ½å¾ˆå¤æ‚ï¼›è¿™é‡Œæœ‰ä¸€äº›åšè¿™ä»¶äº‹çš„æŠ€å·§ã€‚**

1.  **ä¸ºäº†è®©å¼€å‘äººå‘˜æ›´å®¹æ˜“è°ƒè¯•å’Œæ’é™¤æ¨é€é€šçŸ¥çš„æ•…éšœï¼Œæˆ‘ä»¬æ„å»ºäº†ä¸€ä¸ªæµ‹è¯•å·¥å…·ï¼Œæ‚¨å¯èƒ½ä¼šå‘ç°å®ƒå¾ˆæœ‰ç”¨ã€‚è¯·å‚è§æœ¬ [**æ•™ç¨‹**](https://sendbird.com/developer/tutorials/mobile-push-notifications-tester) ä»¥äº†è§£å¦‚ä½•ä½¿ç”¨è¯¥å·¥å…·ï¼Œæ‚¨å¯ä»¥é€šè¿‡ [**Sendbird ä»ªè¡¨ç›˜**](https://dashboard.sendbird.com/) è®¿é—®è¯¥å·¥å…·ã€‚**
2.  **æŸ¥çœ‹è¿™ä»½å…¨é¢çš„ [**æŒ‡å—**](https://sendbird.com/developer/tutorials/troubleshooting-android-chat-push-notifications) å¯¹ Android èŠå¤©æ¨é€é€šçŸ¥è¿›è¡Œæ•…éšœè¯Šæ–­ã€‚**
3.  **å¦‚æœè¦è°ƒè¯•æ•…éšœæ¡ä»¶ï¼Œè¯·å‚è€ƒ[ä¸­çš„ **FCM é”™è¯¯ä»£ç ã€‚**](https://firebase.google.com/docs/reference/fcm/rest/v1/ErrorCode)**

# **ç»“è®º**

**å°±è¿™æ ·ç»“æŸäº†ï¼ç°åœ¨ï¼Œæ‚¨å·²ç»çŸ¥é“å¦‚ä½•ä½¿ç”¨ Sendbird Chat ä¸º React æœ¬åœ°åº”ç”¨ç¨‹åºå‘é€æ¨é€é€šçŸ¥ã€‚æœ‰äº†æœ¬æ•™ç¨‹å’Œ [**æ–‡æ¡£**](https://sendbird.com/docs/chat/v3/android/quickstart/send-first-message) çš„æŒ‡å¯¼ï¼Œä½ é©¬ä¸Šå°±å¯ä»¥å‘é€åŠæ—¶ã€ç›¸å…³ã€å¸å¼•äººçš„æ¨é€é€šçŸ¥äº†ï¼**

**æˆ‘ä»¬æ€»æ˜¯åœ¨è¿™é‡Œæä¾›å¸®åŠ©ï¼› [**å¦‚æœæ‚¨æœ‰ä»»ä½•é—®é¢˜ã€æ„è§æˆ–é¡¾è™‘ï¼Œè¯·è”ç³»æˆ‘ä»¬**](https://sendbird.com/contact-us) ã€‚**

**å¿«ä¹æ¨é€é€šçŸ¥å¤§å¦ï¼ğŸ’»**