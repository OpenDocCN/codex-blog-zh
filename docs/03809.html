<html>
<head>
<title>💪Visualizing your Infrastructure-As-Code Azure Bicep templates with the Bicep VS Code extension</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">💪使用Bicep VS代码扩展可视化您的基础架构代码Azure Bicep模板</h1>
<blockquote>原文：<a href="https://medium.com/codex/visualizing-your-infrastructure-as-code-azure-bicep-templates-with-the-bicep-vs-code-extension-e9c757c7b9ff?source=collection_archive---------3-----------------------#2021-09-28">https://medium.com/codex/visualizing-your-infrastructure-as-code-azure-bicep-templates-with-the-bicep-vs-code-extension-e9c757c7b9ff?source=collection_archive---------3-----------------------#2021-09-28</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="6925" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一个图形化的<strong class="ih hj">可视化工具</strong>用于<strong class="ih hj"> Azure二头肌模板</strong>中的资源</p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><p id="af11" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本文中，我们将回顾如何可视化在Bicep模板中定义的资源。</p><h1 id="23d2" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">蓝色二头肌——它来自哪里</h1><p id="fb76" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">Azure Bicep简化了我们在Azure中声明式部署资源的方式。来自Azure PM团队的话:</p><blockquote class="kn"><p id="2909" class="ko kp hi bd kq kr ks kt ku kv kw jc dx translated">“我们希望首次体验Azure或使用Azure作为主要云的客户拥有一流的部署体验。”</p></blockquote><p id="b9fd" class="pw-post-body-paragraph if ig hi ih b ii kx ik il im ky io ip iq kz is it iu la iw ix iy lb ja jb jc hb bi translated">如果你想开始使用azure Bicep，请查看以下文章:</p><ul class=""><li id="8922" class="lc ld hi ih b ii ij im in iq le iu lf iy lg jc lh li lj lk bi translated"><a class="ae ll" href="https://blog.azinsider.net/why-is-azure-bicep-your-next-choice-for-infrastructure-as-code-f10a2b924ca7" rel="noopener ugc nofollow" target="_blank">为什么Azure Bicep是你的下一个代码基础设施选择？</a></li><li id="0982" class="lc ld hi ih b ii lm im ln iq lo iu lp iy lq jc lh li lj lk bi translated"><a class="ae ll" href="https://blog.azinsider.net/azure-bicep-playground-transitioning-from-arm-templates-into-bicep-5c10c864c863" rel="noopener ugc nofollow" target="_blank"> Azure二头肌游戏场:从手臂模板过渡到二头肌</a></li><li id="c5d6" class="lc ld hi ih b ii lm im ln iq lo iu lp iy lq jc lh li lj lk bi translated"><a class="ae ll" href="https://github.com/Azure/bicep/blob/main/docs/installing.md?WT.mc_id=AZ-MVP-5000671" rel="noopener ugc nofollow" target="_blank">安装Azure二头肌</a></li></ul><p id="8521" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一旦你在你的环境中安装了Azure Bicep，是时候使用你的Bicep模板并可视化它们了。</p><h1 id="d11e" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">1.获取Azure Bicep VS代码扩展</h1><p id="535d" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">Bicep VS Code扩展具有许多您期望从另一种语言工具中获得的特性。<a class="ae ll" href="https://marketplace.visualstudio.com/items?itemName=ms-azuretools.vscode-bicep" rel="noopener ugc nofollow" target="_blank">这里</a>可以抢这个扩展。</p><figure class="ls lt lu lv fd lw er es paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="er es lr"><img src="../Images/12aa6908b1697eb9c85688b5ba8276d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xcf00TsYHLy5xFzJqCd0JQ.png"/></div></div><figcaption class="md me et er es mf mg bd b be z dx translated">Azure Bicep Visual Studio代码扩展</figcaption></figure><p id="3903" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该扩展包括一系列有用的功能，如:</p><ul class=""><li id="bf06" class="lc ld hi ih b ii ij im in iq le iu lf iy lg jc lh li lj lk bi translated">确认</li><li id="91f9" class="lc ld hi ih b ii lm im ln iq lo iu lp iy lq jc lh li lj lk bi translated">智能感知</li><li id="c2cc" class="lc ld hi ih b ii lm im ln iq lo iu lp iy lq jc lh li lj lk bi translated">点属性访问</li><li id="e119" class="lc ld hi ih b ii lm im ln iq lo iu lp iy lq jc lh li lj lk bi translated">资源属性名称和属性值</li><li id="5cad" class="lc ld hi ih b ii lm im ln iq lo iu lp iy lq jc lh li lj lk bi translated">列出所有可用的资源类型</li><li id="96f2" class="lc ld hi ih b ii lm im ln iq lo iu lp iy lq jc lh li lj lk bi translated">完成</li><li id="96ae" class="lc ld hi ih b ii lm im ln iq lo iu lp iy lq jc lh li lj lk bi translated">片段</li><li id="fa5b" class="lc ld hi ih b ii lm im ln iq lo iu lp iy lq jc lh li lj lk bi translated">代码导航</li><li id="31da" class="lc ld hi ih b ii lm im ln iq lo iu lp iy lq jc lh li lj lk bi translated">重构</li><li id="4b8f" class="lc ld hi ih b ii lm im ln iq lo iu lp iy lq jc lh li lj lk bi translated">视觉型的人</li></ul><p id="6e6c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个扩展显示了你的二头肌模板的图形预览。该视图将显示官方Azure图标的所有资源，以及资源之间的关系。</p><h1 id="bce0" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated"><strong class="ak"> 2。创作您的二头肌模板</strong></h1><p id="e547" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">一旦安装了Bicep VS扩展，创建一个名为“<em class="mh"> main.bicep </em>”的新Bicep文件。我们将使用以下二头肌模板作为示例:</p><pre class="ls lt lu lv fd mi mj mk ml aw mm bi"><span id="13d6" class="mn jl hi mj b fi mo mp l mq mr">// The name of your Virtual Machine.<br/>param vmName string = 'flowmonVm'</span><span id="3007" class="mn jl hi mj b fi ms mp l mq mr">// Username for the Virtual Machine.<br/>param adminUsername string</span><span id="7644" class="mn jl hi mj b fi ms mp l mq mr">// Type of authentication to use on the Virtual Machine. SSH key is recommended.<br/>param authenticationType string = 'sshPublicKey'</span><span id="0d0a" class="mn jl hi mj b fi ms mp l mq mr">// SSH Key or password for the Virtual Machine. SSH key is recommended.<br/><a class="ae ll" href="http://twitter.com/secure" rel="noopener ugc nofollow" target="_blank">@secure</a>()<br/>param adminPasswordOrKey string</span><span id="5850" class="mn jl hi mj b fi ms mp l mq mr">// Unique DNS Name for the Public IP used to access the Virtual Machine.<br/>param dnsLabelPrefix string = toLower('flowmon-${uniqueString(resourceGroup().id)}')</span><span id="42d5" class="mn jl hi mj b fi ms mp l mq mr">// Location for all resources.<br/>param location string = resourceGroup().location</span><span id="8dd0" class="mn jl hi mj b fi ms mp l mq mr">// The size of the VM.<br/>param vmSize string = 'Standard_B4ms'</span><span id="4e91" class="mn jl hi mj b fi ms mp l mq mr">// Name of the VNET.<br/>param virtualNetworkName string = 'vNet'</span><span id="fe84" class="mn jl hi mj b fi ms mp l mq mr">// Name of the subnet in the virtual network.<br/>param subnetName string = 'Subnet'</span><span id="fb25" class="mn jl hi mj b fi ms mp l mq mr">// Name of the Network Security Group.<br/>param networkSecurityGroupName string = 'SecGroupNet'</span><span id="dcfe" class="mn jl hi mj b fi ms mp l mq mr">var publicIPAddressName = '${vmName}PublicIP'<br/>var networkInterfaceName = '${vmName}Nic'<br/>var subnetRef = '${vnet.id}/subnets/${subnetName}'<br/>var osDiskType = 'Standard_LRS'<br/>var subnetAddressPrefix = '10.5.0.0/24'<br/>var addressPrefix = '10.5.0.0/16'<br/>var linuxConfiguration = {<br/>  disablePasswordAuthentication: true<br/>  ssh: {<br/>    publicKeys: [<br/>      {<br/>        path: '/home/${adminUsername}/.ssh/authorized_keys'<br/>        keyData: adminPasswordOrKey<br/>      }<br/>    ]<br/>  }<br/>}</span><span id="04ae" class="mn jl hi mj b fi ms mp l mq mr">resource nic 'Microsoft.Network/networkInterfaces@2020-06-01' = {<br/>  name: networkInterfaceName<br/>  location: location<br/>  properties: {<br/>    ipConfigurations: [<br/>      {<br/>        name: 'ipconfig1'<br/>        properties: {<br/>          subnet: {<br/>            id: subnetRef<br/>          }<br/>          privateIPAllocationMethod: 'Dynamic'<br/>          publicIPAddress: {<br/>            id: publicIP.id<br/>          }<br/>        }<br/>      }<br/>    ]<br/>    networkSecurityGroup: {<br/>      id: nsg.id<br/>    }<br/>  }<br/>}</span><span id="7380" class="mn jl hi mj b fi ms mp l mq mr">resource nsg 'Microsoft.Network/networkSecurityGroups@2020-06-01' = {<br/>  name: networkSecurityGroupName<br/>  location: location<br/>  properties: {<br/>    securityRules: [<br/>      {<br/>           name: 'SSH'<br/>           properties : {<br/>               protocol : 'Tcp' <br/>               sourcePortRange :  '*'<br/>               destinationPortRange :  '22'<br/>               sourceAddressPrefix :  '*'<br/>               destinationAddressPrefix: '*'<br/>               access:  'Allow'<br/>               priority : 1010<br/>               direction : 'Inbound'<br/>               sourcePortRanges : []<br/>               destinationPortRanges : []<br/>               sourceAddressPrefixes : []<br/>               destinationAddressPrefixes : []<br/>          }<br/>      }<br/>      {<br/>           name : 'HTTPS'<br/>           properties : {<br/>               protocol :  'Tcp'<br/>               sourcePortRange :  '*'<br/>               destinationPortRange :  '443'<br/>               sourceAddressPrefix :  '*'<br/>               destinationAddressPrefix :  '*'<br/>               access :  'Allow'<br/>               priority : 1020<br/>               direction :  'Inbound'<br/>               sourcePortRanges : []<br/>               destinationPortRanges : []<br/>               sourceAddressPrefixes : []<br/>               destinationAddressPrefixes : []<br/>          }<br/>      }<br/>      {<br/>           name :  'Collector'<br/>           properties : {<br/>               protocol :  'Udp'<br/>               sourcePortRange :  '*'<br/>               destinationPortRange :  '3000'<br/>               sourceAddressPrefix :  '*'<br/>               destinationAddressPrefix :  '*'<br/>               access :  'Allow'<br/>               priority : 103<br/>               direction :  'Inbound'<br/>               sourcePortRanges : []<br/>               destinationPortRanges : []<br/>               sourceAddressPrefixes : []<br/>               destinationAddressPrefixes : []<br/>          }<br/>      }<br/>      {<br/>           name :  'ALL'<br/>           properties : {<br/>               protocol :  '*'<br/>               sourcePortRange :  '*'<br/>               destinationPortRange :  '*'<br/>               sourceAddressPrefix :  '*'<br/>               destinationAddressPrefix : '*'<br/>               access :  'Allow'<br/>               priority : 1040<br/>               direction :  'Inbound'<br/>               sourcePortRanges : []<br/>               destinationPortRanges : []<br/>               sourceAddressPrefixes : []<br/>               destinationAddressPrefixes : []<br/>          }<br/>      }<br/>  ]<br/>  }<br/>}</span><span id="d10a" class="mn jl hi mj b fi ms mp l mq mr">resource vnet 'Microsoft.Network/virtualNetworks@2020-06-01' = {<br/>  name: virtualNetworkName<br/>  location: location<br/>  properties: {<br/>    addressSpace: {<br/>      addressPrefixes: [<br/>        addressPrefix<br/>      ]<br/>    }<br/>    subnets: [<br/>      {<br/>        name: subnetName<br/>        properties: {<br/>          addressPrefix: subnetAddressPrefix<br/>          privateEndpointNetworkPolicies: 'Enabled'<br/>          privateLinkServiceNetworkPolicies: 'Enabled'<br/>        }<br/>      }<br/>    ]<br/>  }<br/>}</span><span id="e7de" class="mn jl hi mj b fi ms mp l mq mr">resource publicIP 'Microsoft.Network/publicIPAddresses@2020-06-01' = {<br/>  name: publicIPAddressName<br/>  location: location<br/>  properties: {<br/>    publicIPAllocationMethod: 'Dynamic'<br/>    publicIPAddressVersion: 'IPv4'<br/>    dnsSettings: {<br/>      domainNameLabel: dnsLabelPrefix<br/>    }<br/>    idleTimeoutInMinutes: 4<br/>  }<br/>  sku: {<br/>    name: 'Basic'<br/>  }<br/>}</span><span id="b6bc" class="mn jl hi mj b fi ms mp l mq mr">resource vm 'Microsoft.Compute/virtualMachines@2021-03-01' = {<br/>  name: vmName<br/>  location: location<br/>  properties: {<br/>    hardwareProfile: {<br/>      vmSize: vmSize<br/>    }<br/>    storageProfile: {<br/>      osDisk: {<br/>        createOption: 'FromImage'<br/>        managedDisk: {<br/>          storageAccountType: osDiskType<br/>        }<br/>      }<br/>      imageReference: {<br/>        publisher: 'flowmon'<br/>        offer: 'flowmon_collector'<br/>        sku: 'v1101-byol'<br/>        version: 'latest'<br/>      }<br/>    }<br/>    networkProfile: {<br/>      networkInterfaces: [<br/>        {<br/>          id: nic.id<br/>        }<br/>      ]<br/>    }<br/>    osProfile: {<br/>      computerName: vmName<br/>      adminUsername: adminUsername<br/>      adminPassword: adminPasswordOrKey<br/>      linuxConfiguration: any(authenticationType == 'password' ? null : linuxConfiguration)<br/>    }<br/>    diagnosticsProfile: {<br/>      bootDiagnostics: {<br/>        enabled: true<br/>      }<br/>    }<br/>  }<br/>  plan: {<br/>    name: 'v1101-byol'<br/>    publisher: 'flowmon'<br/>    product: 'flowmon_collector'<br/>  }<br/>}</span><span id="e13d" class="mn jl hi mj b fi ms mp l mq mr">output administratorUsername string = adminUsername</span></pre><p id="985f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上面的Bicep模板为Kemp Flowmon VM创建了一个基于Linux的虚拟机。你可以在这里查看关于这个模板<a class="ae ll" href="https://blog.azinsider.net/how-to-create-a-linux-virtual-machine-with-azure-bicep-template-e22f50f2baea" rel="noopener ugc nofollow" target="_blank">的更多信息。</a></p><p id="4909" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一旦你在本地机器上有了Bicep模板，你就可以在VS代码的右上角点击"<em class="mh"> Visualizer </em>"图标，如下图所示:</p><figure class="ls lt lu lv fd lw er es paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="er es mt"><img src="../Images/79ef47935769e2079fa114db5442e22f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sD7zBZbRUmQBRgPyN9LmOg.png"/></div></div><figcaption class="md me et er es mf mg bd b be z dx translated">Azure二头肌VS代码扩展</figcaption></figure><p id="e0f7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一旦你选择了这个选项，你会在右边看到一个新的面板，里面有你的二头肌模板的可视化。在本例中，我们看到了虚拟机及其相关资源。</p><figure class="ls lt lu lv fd lw er es paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="er es mu"><img src="../Images/1cf437d6d64a5c598de5011888be4dbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*selwBqccnu9MMLDT281pAw.png"/></div></div><figcaption class="md me et er es mf mg bd b be z dx translated">Azure二头肌VS代码扩展</figcaption></figure><p id="313e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个Bicep可视化工具为您的Bicep模板提供了一个很酷的可视化，因为它反映了语言服务器在资源定义方面看到的内容。</p><p id="be64" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">可视化工具基本上只是向您展示这个定义，并且还包括所有的依赖信息，什么与什么对话，以及模块引用在哪里。</p><h1 id="951e" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">3.动态可视化</h1><p id="f5cb" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">现在去你的二头肌模板的左侧面板。您可以向Bicep模板添加或修改资源，当您添加更多资源或修改现有资源时，您将在可视化工具中实时看到渲染。</p><p id="8f32" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，当您创作代码时，Bicep visualizer将不断更新画布中的资源。</p><p id="ebc0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在以下示例中，我们将为虚拟机定义一个新的专用IP地址。您将看到，当我们在Bicep模板中定义资源时，Bicep visualizer会呈现新的私有IP地址。</p><figure class="ls lt lu lv fd lw er es paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="er es mv"><img src="../Images/b2c5877fd1dbec3001d0482ac11bc7ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*fX1yFGys4axp_Pu27OylAg.gif"/></div></div><figcaption class="md me et er es mf mg bd b be z dx translated">天蓝色二头肌可视化</figcaption></figure><h1 id="436b" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">比较手臂模板可视化和二头肌可视化。</h1><p id="cc89" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">虽然Bicep visualizer提供了Bicep模板中定义的资源的良好呈现，但它缺少ARM模板visualizer中的一些功能，如选择特定资源和查看定义细节的能力。</p><p id="0ec6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果能够在Bicep可视化工具中查看资源细节，或者在Bicep模板中突出显示所选资源的代码定义，那肯定会非常有用。</p><p id="76e1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我推荐你试一试，看看对你有没有用。让我知道你的意见和反馈。</p><p id="7108" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae ll" href="http://eepurl.com/gKmLdf" rel="noopener ugc nofollow" target="_blank"> <em class="mh">在此加入</em><strong class="ih hj"><em class="mh">azin sider</em></strong><em class="mh">邮箱列表。</em>T9】</a></p><p id="c415" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="mh">-戴夫·r·</em></p></div></div>    
</body>
</html>