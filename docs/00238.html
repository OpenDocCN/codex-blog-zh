<html>
<head>
<title>19 Things To Consider Before You Create a Pull Request</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">创建拉式请求前需要考虑的19件事</h1>
<blockquote>原文：<a href="https://medium.com/codex/19-things-to-consider-before-you-create-a-pull-request-96b86c982a75?source=collection_archive---------6-----------------------#2021-01-07">https://medium.com/codex/19-things-to-consider-before-you-create-a-pull-request-96b86c982a75?source=collection_archive---------6-----------------------#2021-01-07</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="c087" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">让您的拉动式请求更有成效</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/408ff9c0af3712e355c7287f96781069.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8ELG0a7FoW2yu_UyRaTWrg.jpeg"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated"><a class="ae jn" href="https://unsplash.com/@sigmund?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">西格蒙德</a>在<a class="ae jn" href="https://unsplash.com/s/photos/code?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</figcaption></figure><p id="ed84" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">让你的代码被分析会让人感觉受到侵犯和不舒服。更糟糕的是，审查其他人的代码可能感觉像一个痛苦而模糊的练习，你在寻找问题，甚至不知道从哪里开始。</p><p id="bc44" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">代码评审是软件工程过程中的一个必要部分，因为你一个人不可能发现你写的一段代码中的每一个问题。不过，没关系。即使是世界上最好的篮球运动员也会投篮不中。</p><p id="64ed" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">让他人评审我们的工作可以确保我们以最少的错误向用户交付最好的产品。</p><p id="67e1" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">本文旨在提供一些坚实的要点，您和您的团队可以遵循这些要点来提高工作效率。</p></div><div class="ab cl kk kl gp km" role="separator"><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp"/></div><div class="hb hc hd he hf"><h1 id="35f7" class="kr ks hi bd kt ku kv kw kx ky kz la lb io lc ip ld ir le is lf iu lg iv lh li bi translated">要避免的事情</h1><h2 id="281a" class="lj ks hi bd kt lk ll lm kx ln lo lp lb jx lq lr ld kb ls lt lf kf lu lv lh lw bi translated">1.基本格式器和棉绒</h2><p id="0c4c" class="pw-post-body-paragraph jo jp hi jq b jr lx ij jt ju ly im jw jx lz jz ka kb ma kd ke kf mb kh ki kj hb bi translated">避免讨论静态分析工具可以处理的细节。不要争论细微差别，比如代码格式和是使用<code class="du mc md me mf b">let</code>还是<code class="du mc md me mf b">var</code>。有一个格式化程序和linter可以让你的计算机为你做评论，从而为你的团队节省很多时间。</p><p id="4765" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">总结:代码评审应该尽可能自动化。</p><h2 id="4086" class="lj ks hi bd kt lk ll lm kx ln lo lp lb jx lq lr ld kb ls lt lf kf lu lv lh lw bi translated">2.基本讨论或困惑</h2><p id="84b4" class="pw-post-body-paragraph jo jp hi jq b jr lx ij jt ju ly im jw jx lz jz ka kb ma kd ke kf mb kh ki kj hb bi translated">这些讨论应该在编写代码之前进行。一旦你浇注了混凝土地基，就不要试图争论平面图。</p><p id="6460" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">总结:代码评审应该避免API讨论。</p><h2 id="e3c7" class="lj ks hi bd kt lk ll lm kx ln lo lp lb jx lq lr ld kb ls lt lf kf lu lv lh lw bi translated">3.不明确的提交消息</h2><p id="c212" class="pw-post-body-paragraph jo jp hi jq b jr lx ij jt ju ly im jw jx lz jz ka kb ma kd ke kf mb kh ki kj hb bi translated">提交消息应该清晰，并且应该准确地描述新代码。避免编写如下消息。</p><pre class="iy iz ja jb fd mg mf mh mi aw mj bi"><span id="b60f" class="lj ks hi mf b fi mk ml l mm mn">Changed some crap<br/>damn it<br/>one more to fix this stupid bug</span></pre><p id="f048" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这些都很有趣，令人满意，但是当你在周六早上起床时却没有帮助，因为你在周五晚上推送代码，却不知道当你<code class="du mc md me mf b">git blame</code>提交时坏代码在做什么。编写提交消息，准确描述代码，并包括来自您的问题跟踪系统(如果有)的票据编号。这将使搜索提交日志变得更加容易。</p><h2 id="2f58" class="lj ks hi bd kt lk ll lm kx ln lo lp lb jx lq lr ld kb ls lt lf kf lu lv lh lw bi translated">4.避免公关中的待办事项</h2><p id="ada0" class="pw-post-body-paragraph jo jp hi jq b jr lx ij jt ju ly im jw jx lz jz ka kb ma kd ke kf mb kh ki kj hb bi translated">待办事项注释可以让你和你的工程师同事知道有些事情需要在以后解决。它们表明缺少了什么，不应该让人觉得任务完成了。</p></div><div class="ab cl kk kl gp km" role="separator"><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp"/></div><div class="hb hc hd he hf"><h1 id="b299" class="kr ks hi bd kt ku kv kw kx ky kz la lb io lc ip ld ir le is lf iu lg iv lh li bi translated">要遵循的东西</h1><h2 id="d3bd" class="lj ks hi bd kt lk ll lm kx ln lo lp lb jx lq lr ld kb ls lt lf kf lu lv lh lw bi translated">5.错别字应该改正</h2><p id="e3c8" class="pw-post-body-paragraph jo jp hi jq b jr lx ij jt ju ly im jw jx lz jz ka kb ma kd ke kf mb kh ki kj hb bi translated">尽可能避免吹毛求疵，把这些留给你的linter、编译器和格式化程序。当你做不到的时候，比如在打字错误的情况下，留下一个友好的评论，建议修改。有时候是一些小事造成了很大的不同！</p><h2 id="48cb" class="lj ks hi bd kt lk ll lm kx ln lo lp lb jx lq lr ld kb ls lt lf kf lu lv lh lw bi translated">6.变量名和函数名应该清晰</h2><p id="4b4d" class="pw-post-body-paragraph jo jp hi jq b jr lx ij jt ju ly im jw jx lz jz ka kb ma kd ke kf mb kh ki kj hb bi translated">命名是计算机科学中最难的问题之一。我们都给变量、函数和文件起过令人困惑的名字。如果你读的名字不清楚，建议你的队友一个更清晰的名字。</p><pre class="iy iz ja jb fd mg mf mh mi aw mj bi"><span id="f5a1" class="lj ks hi mf b fi mk ml l mm mn">// This function could be better named as namesToUpperCase<br/>function u(names) {<br/>  // ...<br/>}</span></pre><h2 id="8d4d" class="lj ks hi bd kt lk ll lm kx ln lo lp lb jx lq lr ld kb ls lt lf kf lu lv lh lw bi translated">7.函数应该简短</h2><p id="7beb" class="pw-post-body-paragraph jo jp hi jq b jr lx ij jt ju ly im jw jx lz jz ka kb ma kd ke kf mb kh ki kj hb bi translated">函数应该做一件事！长函数通常意味着它们做得太多。告诉你的队友把这个功能分成多个不同的功能。</p><pre class="iy iz ja jb fd mg mf mh mi aw mj bi"><span id="fb6e" class="lj ks hi mf b fi mk ml l mm mn">// This is both emailing clients and deciding which are active. Should be<br/>// 2 different functions.<br/>function emailClients(clients) {<br/>  clients.forEach(client =&gt; {<br/>    const clientRecord = database.lookup(client);<br/>    if (clientRecord.isActive()) {<br/>      email(client);<br/>    }<br/>  });<br/>}</span></pre><h2 id="3c98" class="lj ks hi bd kt lk ll lm kx ln lo lp lb jx lq lr ld kb ls lt lf kf lu lv lh lw bi translated">8.文件应该是连贯的，最好是简短的</h2><p id="bcad" class="pw-post-body-paragraph jo jp hi jq b jr lx ij jt ju ly im jw jx lz jz ka kb ma kd ke kf mb kh ki kj hb bi translated">就像函数一样，文件应该只包含一件事。一个文件代表一个模块，一个模块应该为你的代码库做一件事情。</p><p id="6d77" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">例如，如果你的模块叫做<code class="du mc md me mf b">fake-name-generator</code>，它应该只负责创建假名字，比如“Keyser sze”如果<code class="du mc md me mf b">fake-name-generator</code>还包括一堆用于查询姓名数据库的实用函数，那么它应该在一个单独的模块中。</p><p id="a631" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">没有规定一个文件应该有多长，但是如果它很长，就像下面这样，并且包含了彼此不相关的函数，那么它可能应该被拆分。</p><pre class="iy iz ja jb fd mg mf mh mi aw mj bi"><span id="e02e" class="lj ks hi mf b fi mk ml l mm mn">// Line 1<br/>import _ from 'lodash';<br/>function generateFakeNames() {<br/>  // ..<br/>}</span><span id="2cb1" class="lj ks hi mf b fi mo ml l mm mn">// Line 1128<br/>function queryRemoteDatabase() {<br/>  // ...<br/>}</span></pre><h2 id="08ce" class="lj ks hi bd kt lk ll lm kx ln lo lp lb jx lq lr ld kb ls lt lf kf lu lv lh lw bi translated">9.复杂的代码应该被注释</h2><p id="4c1f" class="pw-post-body-paragraph jo jp hi jq b jr lx ij jt ju ly im jw jx lz jz ka kb ma kd ke kf mb kh ki kj hb bi translated">如果你给事物起了个好名字，但逻辑仍然混乱，那么是时候做个评论了。</p><pre class="iy iz ja jb fd mg mf mh mi aw mj bi"><span id="5203" class="lj ks hi mf b fi mk ml l mm mn">function leftPad(str, len, ch) {<br/>  str = str + '';<br/>  len = len - str.length;</span><span id="143c" class="lj ks hi mf b fi mo ml l mm mn">while (true) {<br/>    // This needs a comment, why a bitwise and here?<br/>    if (len &amp; 1) pad += ch;<br/>    // This needs a comment, why a bit shift here?<br/>    len &gt;&gt;= 1;<br/>    if (len) ch += ch;<br/>    else break;<br/>  }</span><span id="cb0d" class="lj ks hi mf b fi mo ml l mm mn">return pad + str;<br/>}</span></pre></div><div class="ab cl kk kl gp km" role="separator"><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp"/></div><div class="hb hc hd he hf"><h1 id="f873" class="kr ks hi bd kt ku kv kw kx ky kz la lb io lc ip ld ir le is lf iu lg iv lh li bi translated">考虑副作用</h1><h2 id="cada" class="lj ks hi bd kt lk ll lm kx ln lo lp lb jx lq lr ld kb ls lt lf kf lu lv lh lw bi translated">10.函数应该尽可能的纯净</h2><pre class="iy iz ja jb fd mg mf mh mi aw mj bi"><span id="0807" class="lj ks hi mf b fi mk ml l mm mn">// Global variable is referenced by the following function.<br/>// If we had another function that used this name, now it'd be an array and it<br/>// could break it. Instead it's better to pass in a name parameter<br/>let name = 'Ryan McDermott';</span><span id="900a" class="lj ks hi mf b fi mo ml l mm mn">function splitIntoFirstAndLastName() {<br/>  name = name.split(' ');<br/>}</span><span id="023c" class="lj ks hi mf b fi mo ml l mm mn">splitIntoFirstAndLastName();</span></pre><h2 id="d739" class="lj ks hi bd kt lk ll lm kx ln lo lp lb jx lq lr ld kb ls lt lf kf lu lv lh lw bi translated">11.I/O功能应该处理失败案例</h2><p id="8a95" class="pw-post-body-paragraph jo jp hi jq b jr lx ij jt ju ly im jw jx lz jz ka kb ma kd ke kf mb kh ki kj hb bi translated">任何进行I/O的函数都应该在出错时进行处理。</p><pre class="iy iz ja jb fd mg mf mh mi aw mj bi"><span id="186b" class="lj ks hi mf b fi mk ml l mm mn">function getIngredientsFromFile() {<br/>  const onFulfilled = buffer =&gt; {<br/>    let lines = buffer.split('\n');<br/>    return lines.forEach(line =&gt; &lt;Ingredient ingredient={line} /&gt;);<br/>  };</span><span id="e985" class="lj ks hi mf b fi mo ml l mm mn">// What about when this rejected because of an error? What do we return?<br/>  return readFile('./ingredients.txt').then(onFulfilled);<br/>}</span></pre></div><div class="ab cl kk kl gp km" role="separator"><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp"/></div><div class="hb hc hd he hf"><h1 id="586b" class="kr ks hi bd kt ku kv kw kx ky kz la lb io lc ip ld ir le is lf iu lg iv lh li bi translated">考虑边缘情况</h1><h2 id="b0ca" class="lj ks hi bd kt lk ll lm kx ln lo lp lb jx lq lr ld kb ls lt lf kf lu lv lh lw bi translated">12.应处理空案例</h2><p id="8969" class="pw-post-body-paragraph jo jp hi jq b jr lx ij jt ju ly im jw jx lz jz ka kb ma kd ke kf mb kh ki kj hb bi translated">例如，如果您有一个列表组件，如果您显示一个漂亮的表来显示它的所有数据，一切都很好。你的用户喜欢它，你得到了提升！但是当没有数据返回时会发生什么呢？在空的情况下你显示了什么？你的代码应该对任何可能发生的情况都有弹性。如果你的代码中有不好的事情发生，最终它会发生。</p><h2 id="f06d" class="lj ks hi bd kt lk ll lm kx ln lo lp lb jx lq lr ld kb ls lt lf kf lu lv lh lw bi translated">13.应该处理大案</h2><p id="6836" class="pw-post-body-paragraph jo jp hi jq b jr lx ij jt ju ly im jw jx lz jz ka kb ma kd ke kf mb kh ki kj hb bi translated">在上面的列表中，如果10，000件商品从库存中返回，会发生什么情况？在这种情况下，您需要某种形式的分页或无限滚动。确保总是从数量的角度评估潜在的边缘情况，尤其是当涉及到UI编程时。</p><h2 id="45ab" class="lj ks hi bd kt lk ll lm kx ln lo lp lb jx lq lr ld kb ls lt lf kf lu lv lh lw bi translated">14.用户输入应该受到限制</h2><p id="3a5a" class="pw-post-body-paragraph jo jp hi jq b jr lx ij jt ju ly im jw jx lz jz ka kb ma kd ke kf mb kh ki kj hb bi translated">用户可以输入无限量的数据发送给你。如果一个函数接受任何类型的用户数据，设置限制是很重要的。</p><pre class="iy iz ja jb fd mg mf mh mi aw mj bi"><span id="a004" class="lj ks hi mf b fi mk ml l mm mn">router.route('/message').post((req, res) =&gt; {<br/>  const message = req.body.content;</span><span id="1d3f" class="lj ks hi mf b fi mo ml l mm mn">// What happens if the message is many megabytes of data? Do we want to store<br/>  // that in the database? We should set limits on the size.<br/>  db.save(message);<br/>});</span></pre><h2 id="a24c" class="lj ks hi bd kt lk ll lm kx ln lo lp lb jx lq lr ld kb ls lt lf kf lu lv lh lw bi translated">15.函数应该处理意外的用户输入</h2><p id="d59a" class="pw-post-body-paragraph jo jp hi jq b jr lx ij jt ju ly im jw jx lz jz ka kb ma kd ke kf mb kh ki kj hb bi translated">用户总是会用他们给你的数据给你惊喜。不要期望在用户的请求中总能得到正确类型的数据，甚至是任何数据。<a class="ae jn" href="https://twitter.com/ryconoclast/status/885523459748487169" rel="noopener ugc nofollow" target="_blank">并且不依赖客户端单独验证</a>。</p><pre class="iy iz ja jb fd mg mf mh mi aw mj bi"><span id="83dd" class="lj ks hi mf b fi mk ml l mm mn">router.route('/transfer-money').post((req, res) =&gt; {<br/>  const amount = req.body.amount;<br/>  const from = user.id;<br/>  const to = req.body.to;</span><span id="b68c" class="lj ks hi mf b fi mo ml l mm mn">// What happens if we got a string instead of a number as our amount? This<br/>  // function would fail<br/>  transferMoney(from, to, amount);<br/>});</span></pre></div><div class="ab cl kk kl gp km" role="separator"><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp"/></div><div class="hb hc hd he hf"><h1 id="6b1b" class="kr ks hi bd kt ku kv kw kx ky kz la lb io lc ip ld ir le is lf iu lg iv lh li bi translated">安全性</h1><h2 id="0e99" class="lj ks hi bd kt lk ll lm kx ln lo lp lb jx lq lr ld kb ls lt lf kf lu lv lh lw bi translated">16.XSS应该不可能</h2><p id="1b83" class="pw-post-body-paragraph jo jp hi jq b jr lx ij jt ju ly im jw jx lz jz ka kb ma kd ke kf mb kh ki kj hb bi translated">跨站点脚本(XSS)是web应用程序安全攻击的最大载体之一。当您获取用户数据并将其包含在您的页面中而没有先对其进行适当的清理时，就会发生这种情况。这可能会导致您的站点从远程页面执行源代码。</p><h2 id="2e7f" class="lj ks hi bd kt lk ll lm kx ln lo lp lb jx lq lr ld kb ls lt lf kf lu lv lh lw bi translated">17.个人身份信息(PII)不应泄露</h2><p id="9cb1" class="pw-post-body-paragraph jo jp hi jq b jr lx ij jt ju ly im jw jx lz jz ka kb ma kd ke kf mb kh ki kj hb bi translated">每次接收用户数据时，你都要承担巨大的责任。如果您在URL、分析跟踪中向第三方泄露数据，或者甚至将数据暴露给不应该访问的员工，您将极大地伤害您的用户和您的业务。小心别人的生命！很严重。</p></div><div class="ab cl kk kl gp km" role="separator"><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp"/></div><div class="hb hc hd he hf"><h1 id="334b" class="kr ks hi bd kt ku kv kw kx ky kz la lb io lc ip ld ir le is lf iu lg iv lh li bi translated">最后，测试</h1><h2 id="cf20" class="lj ks hi bd kt lk ll lm kx ln lo lp lb jx lq lr ld kb ls lt lf kf lu lv lh lw bi translated">18.应该测试新代码</h2><p id="0d11" class="pw-post-body-paragraph jo jp hi jq b jr lx ij jt ju ly im jw jx lz jz ka kb ma kd ke kf mb kh ki kj hb bi translated">所有的新代码都应该包含一个测试，不管它是修复了一个错误还是一个新特性。如果是bug修复，应该有测试证明bug已经修复。如果它是一个新特性，那么每个组件都应该进行单元测试，并且应该有一个集成测试来确保该特性与系统的其余部分一起工作。</p><h2 id="a3b6" class="lj ks hi bd kt lk ll lm kx ln lo lp lb jx lq lr ld kb ls lt lf kf lu lv lh lw bi translated">19.测试实际上应该测试函数做的所有事情</h2><p id="3062" class="pw-post-body-paragraph jo jp hi jq b jr lx ij jt ju ly im jw jx lz jz ka kb ma kd ke kf mb kh ki kj hb bi translated">测试应该覆盖一个函数所做的一切，包括边缘情况和它所操作的限制。</p></div><div class="ab cl kk kl gp km" role="separator"><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp"/></div><div class="hb hc hd he hf"><h2 id="df9b" class="lj ks hi bd kt lk ll lm kx ln lo lp lb jx lq lr ld kb ls lt lf kf lu lv lh lw bi translated">这篇文章的灵感来自这个<a class="ae jn" href="https://github.com/ryanmcdermott/code-review-tips#why-review-code" rel="noopener ugc nofollow" target="_blank"> GitHub </a>项目。快乐编码。</h2><h2 id="a4cf" class="lj ks hi bd kt lk ll lm kx ln lo lp lb jx lq lr ld kb ls lt lf kf lu lv lh lw bi translated">感谢阅读！</h2></div></div>    
</body>
</html>