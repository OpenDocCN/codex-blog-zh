<html>
<head>
<title>Build an Automatic Abstractive Text Summarizer in Ten minutes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在十分钟内建立一个自动的抽象文本摘要</h1>
<blockquote>原文：<a href="https://medium.com/codex/build-an-automatic-abstractive-text-summarizer-in-ten-minutes-f15f07e54bae?source=collection_archive---------4-----------------------#2021-09-21">https://medium.com/codex/build-an-automatic-abstractive-text-summarizer-in-ten-minutes-f15f07e54bae?source=collection_archive---------4-----------------------#2021-09-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="79e6" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">使用Python中的变形金刚，火炬，句子片断库。</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/1d68c463ad1a9ee7f93f99af3672cbd9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*OEwOyZoDv_M6nutB"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">梅尔·普尔在<a class="ae jn" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="690f" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">文本摘要</strong>是将长文本缩短为较短文本，同时保留关键元素和含义的过程。手动总结文本会花费很多时间。使用最先进的<strong class="jq hj"> NLP </strong>模型实现流程自动化可能是解决这一问题的办法。这个问题可以用两种方法来解决</p><p id="c96e" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">提取文本摘要</strong>:该方法旨在识别给定文本中最重要的句子，然后将其提取并分组以形成文本的较短版本。</p><p id="a9b0" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">抽象文本摘要</strong>:这种方法旨在创建一个简明扼要的源文本摘要，抓住要点。产生的概要可以包括在原始文本中找不到的附加短语和句子。</p><p id="1519" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我们将使用谷歌的<strong class="jq hj"> PEGASUS </strong>模型来完成手头的任务。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es kk"><img src="../Images/523f37b98d96c26cb663d04afce2dbb9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*d3Ni5stLU7P2Dmji"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated"><a class="ae jn" href="https://unsplash.com/@sdoy1995?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">苏丹欧阳</a>在<a class="ae jn" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="a8e0" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj"> PEGASUS </strong>代表使用提取的间隙句子进行预训练，用于抽象的序列到序列摘要模型。他们设计了一个名为gap句子生成的预训练自我监督目标函数来训练变压器模型。</p><h2 id="f031" class="kl km hi bd kn ko kp kq kr ks kt ku kv jx kw kx ky kb kz la lb kf lc ld le lf bi translated">飞马建筑</h2><p id="d226" class="pw-post-body-paragraph jo jp hi jq b jr lg ij jt ju lh im jw jx li jz ka kb lj kd ke kf lk kh ki kj hb bi translated">飞马采用了<strong class="jq hj">变形金刚</strong>的架构。它使用<strong class="jq hj">编解码器</strong>模型进行<strong class="jq hj"> seq2seq </strong>学习。文本被并行输入<strong class="jq hj">编码器</strong>，产生一个上下文向量。上下文向量只不过是分配给每个单词的一组数字，因为机器无法理解文本。这个向量然后被馈送到<strong class="jq hj">解码器</strong>，解码器对向量进行解码并产生摘要。要了解更多关于变形金刚的知识，你可以阅读这篇文章<a class="ae jn" href="http://jalammar.github.io/illustrated-transformer/" rel="noopener ugc nofollow" target="_blank">“图解变形金刚”，作者是杰伊·阿拉姆马</a></p><p id="2e3e" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">想了解更多关于飞马的信息，可以看看这篇文章。</p><div class="ll lm ez fb ln lo"><a href="https://ai.googleblog.com/2020/06/pegasus-state-of-art-model-for.html" rel="noopener  ugc nofollow" target="_blank"><div class="lp ab dw"><div class="lq ab lr cl cj ls"><h2 class="bd hj fi z dy lt ea eb lu ed ef hh bi translated">PEGASUS:抽象文本摘要的最新模型</h2><div class="lv l"><h3 class="bd b fi z dy lt ea eb lu ed ef dx translated">学生的任务通常是阅读一份文件并编写一份摘要(例如，读书报告)来展示…</h3></div><div class="lw l"><p class="bd b fp z dy lt ea eb lu ed ef dx translated">ai.googleblog.com</p></div></div><div class="lx l"><div class="ly l lz ma mb lx mc jh lo"/></div></div></a></div><p id="5bce" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">以下是我们将要遵循的程序的逐步概要:</p><ol class=""><li id="aad0" class="md me hi jq b jr js ju jv jx mf kb mg kf mh kj mi mj mk ml bi translated">安装所需的库。</li><li id="72d7" class="md me hi jq b jr mm ju mn jx mo kb mp kf mq kj mi mj mk ml bi translated">导入所需的库。</li><li id="2b1e" class="md me hi jq b jr mm ju mn jx mo kb mp kf mq kj mi mj mk ml bi translated">初始化模型。</li><li id="1544" class="md me hi jq b jr mm ju mn jx mo kb mp kf mq kj mi mj mk ml bi translated">向模型提供输入。</li><li id="7ada" class="md me hi jq b jr mm ju mn jx mo kb mp kf mq kj mi mj mk ml bi translated">获取摘要文本。</li></ol><p id="82e7" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">完整的代码可以在<a class="ae jn" href="https://github.com/DhirajPrakash22/Abstractive_text_summarization/blob/main/PegasusDemo.ipynb" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><h1 id="96e8" class="mr km hi bd kn ms mt mu kr mv mw mx kv io my ip ky ir mz is lb iu na iv le nb bi translated">安装所需的库</h1><p id="778d" class="pw-post-body-paragraph jo jp hi jq b jr lg ij jt ju lh im jw jx li jz ka kb lj kd ke kf lk kh ki kj hb bi translated">让我们安装任务所需的所有库。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="nc nd l"/></div></figure><p id="04fb" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">取消对代码的注释，安装所需的库。此代码适用于CPU版本。如果你想在GPU上运行它，访问PyTorch网站并安装它的GPU版本。</p><h1 id="107f" class="mr km hi bd kn ms mt mu kr mv mw mx kv io my ip ky ir mz is lb iu na iv le nb bi translated">导入所需的库</h1><p id="363d" class="pw-post-body-paragraph jo jp hi jq b jr lg ij jt ju lh im jw jx li jz ka kb lj kd ke kf lk kh ki kj hb bi translated">安装完所需的包后，我们需要使用下面几行代码导入它们。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="nc nd l"/></div></figure><p id="92d0" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><code class="du ne nf ng nh b">transformers</code>库为各种任务提供了各种预训练的AI模型。我们使用Pegasus模型进行文本摘要。</p><p id="fe63" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><code class="du ne nf ng nh b">torch</code>是一个开源的机器学习库。它为深度学习提供了广泛的算法。</p><h1 id="4d23" class="mr km hi bd kn ms mt mu kr mv mw mx kv io my ip ky ir mz is lb iu na iv le nb bi translated">初始化模型</h1><p id="ed83" class="pw-post-body-paragraph jo jp hi jq b jr lg ij jt ju lh im jw jx li jz ka kb lj kd ke kf lk kh ki kj hb bi translated">导入所需的库之后，我们就可以初始化模型了。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="nc nd l"/></div></figure><p id="d87b" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我们使用在<strong class="jq hj"> XSUM </strong>数据集上预先训练的模型。</p><p id="48a9" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">XSUM数据集是用于评估抽象文档的数据集。要了解更多关于XSUM的信息，您可以阅读下面的文章。</p><div class="ll lm ez fb ln lo"><a href="https://paperswithcode.com/dataset/xsum" rel="noopener  ugc nofollow" target="_blank"><div class="lp ab dw"><div class="lq ab lr cl cj ls"><h2 class="bd hj fi z dy lt ea eb lu ed ef hh bi translated">带代码的论文- XSum数据集</h2><div class="lv l"><h3 class="bd b fi z dy lt ea eb lu ed ef dx translated">极限摘要(XSum)数据集是用于评估抽象的单文档摘要的数据集…</h3></div><div class="lw l"><p class="bd b fp z dy lt ea eb lu ed ef dx translated">paperswithcode.com</p></div></div><div class="lx l"><div class="ni l lz ma mb lx mc jh lo"/></div></div></a></div><p id="dcc9" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">标记化</strong>是将短语、句子、段落或整个文本文档分割成更小单元的过程。这些较小的单位被称为代币。我们使用飞马座标记器来完成这项任务。</p><p id="4dae" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">使用from_pretrained方法存储和检索模型配置。</p><p id="8d32" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">然后模型被初始化，并可以通过使用模型变量来访问。</p><h1 id="3b47" class="mr km hi bd kn ms mt mu kr mv mw mx kv io my ip ky ir mz is lb iu na iv le nb bi translated">向模型提供输入</h1><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="nc nd l"/></div></figure><p id="1f4d" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj"> src_text </strong>是需要汇总的源文本。您可以将此文本替换为您希望模型汇总的文本。输入不能一次全部输入。我们必须把它分成小批，然后输入模型。然后我们创建另一个名为<strong class="jq hj"> tgt_text </strong>的变量，它将存储模型产生的输出。</p><h1 id="1182" class="mr km hi bd kn ms mt mu kr mv mw mx kv io my ip ky ir mz is lb iu na iv le nb bi translated">获取摘要文本</h1><p id="7f46" class="pw-post-body-paragraph jo jp hi jq b jr lg ij jt ju lh im jw jx li jz ka kb lj kd ke kf lk kh ki kj hb bi translated">在模型总结了文本之后，它被存储在tgt_text变量中。我们可以通过调用打印函数来查看输出。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="nc nd l"/></div></figure><p id="df78" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">您的抽象文本摘要器已经准备好，无需编写数百行代码。我们使用的是模型的预训练版本。如果您需要，还可以针对特定目的对模型进行微调。</p><h1 id="42ec" class="mr km hi bd kn ms mt mu kr mv mw mx kv io my ip ky ir mz is lb iu na iv le nb bi translated">摘要</h1><p id="cce4" class="pw-post-body-paragraph jo jp hi jq b jr lg ij jt ju lh im jw jx li jz ka kb lj kd ke kf lk kh ki kj hb bi translated">下面是我们执行抽象文本摘要的一步一步过程的总结。</p><ol class=""><li id="4b18" class="md me hi jq b jr js ju jv jx mf kb mg kf mh kj mi mj mk ml bi translated">安装了所需的库。</li><li id="992e" class="md me hi jq b jr mm ju mn jx mo kb mp kf mq kj mi mj mk ml bi translated">导入了所需的库。</li><li id="9058" class="md me hi jq b jr mm ju mn jx mo kb mp kf mq kj mi mj mk ml bi translated">已初始化模型。</li><li id="3cd4" class="md me hi jq b jr mm ju mn jx mo kb mp kf mq kj mi mj mk ml bi translated">批量向模型提供输入。</li><li id="d314" class="md me hi jq b jr mm ju mn jx mo kb mp kf mq kj mi mj mk ml bi translated">获得了总结文本。</li></ol><h1 id="add3" class="mr km hi bd kn ms mt mu kr mv mw mx kv io my ip ky ir mz is lb iu na iv le nb bi translated">参考</h1><ul class=""><li id="a885" class="md me hi jq b jr lg ju lh jx nj kb nk kf nl kj nm mj mk ml bi translated">谷歌人工智能博客:PEGASUS:抽象文本摘要的最新模型</li><li id="154f" class="md me hi jq b jr mm ju mn jx mo kb mp kf mq kj nm mj mk ml bi translated"><a class="ae jn" href="https://towardsdatascience.com/pegasus-google-state-of-the-art-abstractive-summarization-model-627b1bbbc5ce" rel="noopener" target="_blank"> PEGASUS:谷歌最先进的抽象摘要模型</a></li><li id="0376" class="md me hi jq b jr mm ju mn jx mo kb mp kf mq kj nm mj mk ml bi translated"><a class="ae jn" href="http://jalammar.github.io/illustrated-transformer/" rel="noopener ugc nofollow" target="_blank">杰伊·阿拉玛的《变形金刚》</a></li><li id="9359" class="md me hi jq b jr mm ju mn jx mo kb mp kf mq kj nm mj mk ml bi translated"><a class="ae jn" href="https://huggingface.co/google/pegasus-xsum" rel="noopener ugc nofollow" target="_blank">抱脸:飞马-XSum </a></li></ul></div></div>    
</body>
</html>