<html>
<head>
<title>How to Limit CPU and Memory Usage in Docker Containers</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何限制Docker容器中CPU和内存的使用</h1>
<blockquote>原文：<a href="https://medium.com/codex/how-to-limit-cpu-and-memory-usage-in-docker-containers-a024b429f55e?source=collection_archive---------1-----------------------#2022-07-20">https://medium.com/codex/how-to-limit-cpu-and-memory-usage-in-docker-containers-a024b429f55e?source=collection_archive---------1-----------------------#2022-07-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/8180a27f4fcfa614f2c49515993d035a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jvurfX0M5SeNWRRQqEufMw.jpeg"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated"><a class="ae hv" href="https://www.freepik.com/free-photo/aerial-view-container-cargo-ship-sea_13180387.htm#query=container&amp;position=12&amp;from_view=search" rel="noopener ugc nofollow" target="_blank"> Freepik </a></figcaption></figure><div class=""/><blockquote class="iv iw ix"><p id="dac3" class="iy iz ja jb b jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw hb bi translated">使用Docker容器隔离进程并保证资源</p></blockquote><h2 id="8581" class="jx jy hy bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">介绍</h2><p id="dd32" class="pw-post-body-paragraph iy iz hy jb b jc kv je jf jg kw ji jj ki kx jm jn km ky jq jr kq kz ju jv jw hb bi translated">Docker容器是在一台主机上隔离进程的好方法。这在运行多个CPU或内存密集型进程时尤其有用，因为它可以确保一个进程不会耗尽其他进程的资源。</p><p id="9a31" class="pw-post-body-paragraph iy iz hy jb b jc jd je jf jg jh ji jj ki jl jm jn km jp jq jr kq jt ju jv jw hb bi translated">还可以限制Docker容器可以使用的CPU或内存量。这有助于防止单个进程使用过多的主机资源，或者保证容器总是有最小量的资源可用。</p><h2 id="e69f" class="jx jy hy bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">CPU限制</h2><p id="c65a" class="pw-post-body-paragraph iy iz hy jb b jc kv je jf jg kw ji jj ki kx jm jn km ky jq jr kq kz ju jv jw hb bi translated">可以使用<code class="du la lb lc ld b">--cpu-period</code> <code class="du la lb lc ld b">--cpu-quota</code>参数设置CPU限制。<code class="du la lb lc ld b">--cpu-period</code>参数以微秒为单位设置CPU周期的长度。<code class="du la lb lc ld b">--cpu-quota</code>参数设置容器在此期间允许使用的周期数。</p><p id="b51d" class="pw-post-body-paragraph iy iz hy jb b jc jd je jf jg jh ji jj ki jl jm jn km jp jq jr kq jt ju jv jw hb bi translated">例如，要将容器限制为使用不超过50%的单个CPU核心，可以使用以下参数:</p><pre class="le lf lg lh fd li ld lj lk aw ll bi"><span id="d98a" class="jx jy hy ld b fi lm ln l lo lp">--cpu-period=50000<br/>--cpu-quota=25000</span></pre><p id="9119" class="pw-post-body-paragraph iy iz hy jb b jc jd je jf jg jh ji jj ki jl jm jn km jp jq jr kq jt ju jv jw hb bi translated">您还可以使用<code class="du la lb lc ld b">--cpus</code>参数来设置一个容器可以使用的最大CPU数量。例如，要将容器限制为使用两个CPU，可以使用以下参数:</p><pre class="le lf lg lh fd li ld lj lk aw ll bi"><span id="82cf" class="jx jy hy ld b fi lm ln l lo lp">--cpus=2</span></pre><h2 id="769d" class="jx jy hy bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">内存限制</h2><p id="5a85" class="pw-post-body-paragraph iy iz hy jb b jc kv je jf jg kw ji jj ki kx jm jn km ky jq jr kq kz ju jv jw hb bi translated">可以使用<code class="du la lb lc ld b">--memory</code>参数设置内存限制。此参数设置容器可以使用的最大内存量，以字节为单位。</p><p id="76a9" class="pw-post-body-paragraph iy iz hy jb b jc jd je jf jg jh ji jj ki jl jm jn km jp jq jr kq jt ju jv jw hb bi translated">例如，要限制容器使用不超过512 MB的内存，可以使用以下参数:</p><pre class="le lf lg lh fd li ld lj lk aw ll bi"><span id="2479" class="jx jy hy ld b fi lm ln l lo lp">--memory=512m</span></pre><p id="3e95" class="pw-post-body-paragraph iy iz hy jb b jc jd je jf jg jh ji jj ki jl jm jn km jp jq jr kq jt ju jv jw hb bi translated">您还可以使用<code class="du la lb lc ld b">--memory-swap</code>参数来设置容器可以使用的最大内存和交换空间。该参数的设置方式与<code class="du la lb lc ld b">--memory</code>参数相同，以字节为单位。</p><p id="f4e7" class="pw-post-body-paragraph iy iz hy jb b jc jd je jf jg jh ji jj ki jl jm jn km jp jq jr kq jt ju jv jw hb bi translated">例如，要限制容器使用不超过512 MB的内存和交换空间，可以使用以下参数:</p><pre class="le lf lg lh fd li ld lj lk aw ll bi"><span id="368b" class="jx jy hy ld b fi lm ln l lo lp">--memory-swap=512m</span></pre><p id="d656" class="pw-post-body-paragraph iy iz hy jb b jc jd je jf jg jh ji jj ki jl jm jn km jp jq jr kq jt ju jv jw hb bi translated"><strong class="jb hz">Docker命令示例:</strong></p><pre class="le lf lg lh fd li ld lj lk aw ll bi"><span id="e371" class="jx jy hy ld b fi lm ln l lo lp">docker run --name my-container --cpu-period=50000 --cpu-quota=25000 --memory=512m my-image</span></pre><p id="7ab7" class="pw-post-body-paragraph iy iz hy jb b jc jd je jf jg jh ji jj ki jl jm jn km jp jq jr kq jt ju jv jw hb bi translated"><strong class="jb hz">示例docker-compose配置:</strong></p><pre class="le lf lg lh fd li ld lj lk aw ll bi"><span id="e0b5" class="jx jy hy ld b fi lm ln l lo lp">version: '3'<br/><br/>services:<br/>  my-service:<br/>    image: my-image<br/>    cpu_period: 50000<br/>    cpu_quota: 25000<br/>    memory: 512m</span></pre><h2 id="b8c1" class="jx jy hy bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">结论</h2><p id="c62b" class="pw-post-body-paragraph iy iz hy jb b jc kv je jf jg kw ji jj ki kx jm jn km ky jq jr kq kz ju jv jw hb bi translated">Docker容器是在一台主机上隔离进程的好方法。可以设置CPU和内存限制，以确保一个进程不会耗尽其他进程的资源，或者保证一个容器总是有最小量的资源可供其使用。</p></div><div class="ab cl lq lr gp ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="hb hc hd he hf"><p id="0eb1" class="pw-post-body-paragraph iy iz hy jb b jc jd je jf jg jh ji jj ki jl jm jn km jp jq jr kq jt ju jv jw hb bi translated"><a class="ae hv" href="https://narasimmantech.com/#/portal/signup" rel="noopener ugc nofollow" target="_blank"> <strong class="jb hz">订阅</strong> </a>我的每周简讯，了解关于Golang、DevOps、Cloud-Native、Linux、Kubernetes等的最新见解。</p><p id="4530" class="pw-post-body-paragraph iy iz hy jb b jc jd je jf jg jh ji jj ki jl jm jn km jp jq jr kq jt ju jv jw hb bi translated">在推特上关注我！</p></div></div>    
</body>
</html>