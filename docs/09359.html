<html>
<head>
<title>How To Use APIs in R Programming</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在R编程中使用API</h1>
<blockquote>原文：<a href="https://medium.com/codex/how-to-use-apis-in-r-programming-a67258597d56?source=collection_archive---------4-----------------------#2022-10-15">https://medium.com/codex/how-to-use-apis-in-r-programming-a67258597d56?source=collection_archive---------4-----------------------#2022-10-15</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/1536eb6516961fbf28d3be5ab5846515.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*nsRK0MpyahLU8lxL"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">作者图片</figcaption></figure><p id="6d3e" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">你想离开CSV俱乐部吗？这个帖子是给你的。</p><p id="5bb2" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在这篇文章中，我将向您展示如何从<strong class="iw hj"> API </strong>中检索数据，并使用它进行分析。</p><p id="181b" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">但是首先，我们需要理解术语<strong class="iw hj"> API </strong>的含义。</p><p id="abcb" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">什么是API？</strong></p><p id="e502" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> API </strong>代表<strong class="iw hj">应用编程接口</strong>，是程序员用来创建外部系统并与之交互的一组命令、函数、协议和对象。</p><p id="e3d9" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">好了，放松点，老虎！不要惊慌。</p><p id="fc84" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">所以对于那些在外面吃饭的人来说，当你去餐馆的时候。</p><p id="54c2" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">餐馆会给你提供他们提供的食物菜单。他们不会让你进入他们的厨房去挑选你想要的任何东西，甚至不会让你知道他们的秘方！</p><p id="735d" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">他们有服务员，你叫服务员去拿你想要的东西，服务员有责任去厨房为你拿。</p><p id="f4b4" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">所以当我们在说<strong class="iw hj"> API </strong>的时候，你的电脑就是你在餐厅，要端上来的食物就是你需要的数据，而餐厅就是服务器。我以为你会在吃完后给小费的那个服务员是API 。</p><p id="d2c9" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">如果你想点菜，服务员会帮你拿。</p><p id="1cf8" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">如果你想要数据，API <strong class="iw hj">会帮你得到。</strong></p><p id="aafc" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我相信现在这些点应该联系起来了。</p><figure class="js jt ju jv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/9c72111d8a17a722d4cddff4fa1a54d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*aVrakEVAiaFyTq3X"/></div></div></figure><p id="e08b" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">API有一个动词，它允许你的计算机与托管数据的服务器通信，其中一些数据超出了本文的范围。</p><p id="92bf" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这些动词被称为请求。</p><p id="1192" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我将只谈论允许你的服务员从餐馆的厨房为你取食物的动词。</p><p id="7531" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">在R中发出API请求</strong></p><p id="e090" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">为了生成一个<strong class="iw hj"> API请求</strong>，我们将需要两个包<code class="du jw jx jy jz b">httr </code>和<code class="du jw jx jy jz b">jsonlite</code>包。</p><pre class="js jt ju jv fd ka jz kb kc aw kd bi"><span id="8631" class="ke kf hi jz b fi kg kh l ki kj">install.packages("httr","jsonlite") <br/>library(httr) <br/>library(jsonlite)</span></pre><p id="518e" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我将使用由不同国家的Covid病例记录组成的API   <em class="kl"> </em>。</p><p id="c9f7" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">第一步是通过指定<strong class="iw hj"> API </strong> URL来发出一个<strong class="iw hj"> GET </strong>请求</p><pre class="js jt ju jv fd ka jz kb kc aw kd bi"><span id="e261" class="ke kf hi jz b fi kg kh l ki kj">response &lt;-GET("https://coronavirus.m.pipedream.net/")</span></pre><p id="693d" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我们应该期待的输出是一个包含从<strong class="iw hj"> API </strong>服务器返回的所有信息的列表。</p><p id="bce1" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这将作为变量<code class="du jw jx jy jz b">response, </code>存储，包含<strong class="iw hj"> API </strong>服务器对我们请求的响应。</p><p id="2f80" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">如果我们要检查可变响应，</p><figure class="js jt ju jv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es km"><img src="../Images/d87137df85c77348cc3267c5bd7fae06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*06olo7TpWqtH0ZfA"/></div></div></figure><p id="3090" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这为我们提供了响应的摘要，正如您可以看到的,<strong class="iw hj"> GET </strong>请求被发送到的URL，以及发出该请求的日期和时间。</p><p id="20b2" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">JSON格式的内容类型、内容大小和状态表明我们的请求是否成功。</p><p id="d2bf" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在这种情况下，数字200表示请求成功。</p><p id="ac98" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">JSON是什么？</strong></p><p id="5377" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">变量response包含一个列表，在这个列表中，我们的数据以一种叫做<strong class="iw hj"> JSON </strong>的原始格式存储。</p><p id="a75f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> JSON </strong>是在<strong class="iw hj"> API </strong>中存储和传输数据的结构，代表Javascript对象符号。</p><p id="c86b" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">JSON 中的值被赋予了<em class="kl">键-值</em>对，如下图所示。</p><figure class="js jt ju jv fd ij er es paragraph-image"><div class="er es kn"><img src="../Images/9140449f11e19002201595034e30348e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/0*qXfWX7uMw49fK37k"/></div></figure><p id="e684" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">您可以使用函数<code class="du jw jx jy jz b">rawToChar</code>访问<strong class="iw hj"> JSON </strong>，该函数将<code class="du jw jx jy jz b">response </code>中的内容转换为<strong class="iw hj"> JSON </strong>格式。</p><figure class="js jt ju jv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ko"><img src="../Images/cf803f49b4b71b65af177a813045f8a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*rjPh1FkbWo0d3Qo7"/></div></div></figure><p id="0ec9" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">很乱对，这才是真正的<strong class="iw hj"> JSON </strong>的样子。</p><p id="e61d" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">将JSON转换为列表结构</strong></p><p id="a93f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">为了方便地操作这些数据，我们需要使用<code class="du jw jx jy jz b">jsonlite</code>包中的<code class="du jw jx jy jz b">fromJSON()</code>函数将其转换成一个列表数据结构。</p><pre class="js jt ju jv fd ka jz kb kc aw kd bi"><span id="03e0" class="ke kf hi jz b fi kg kh l ki kj">data &lt;- fromJSON(rawToChar(response$content)) names(data)</span></pre><figure class="js jt ju jv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kp"><img src="../Images/a1b60152ffbff77f97c29e7b049f6e77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*LjTsy8IAnhV1Dl4k"/></div></div></figure><p id="76d0" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我们感兴趣的数据存储在<code class="du jw jx jy jz b">rawData</code>中，可以通过调用</p><pre class="js jt ju jv fd ka jz kb kc aw kd bi"><span id="5708" class="ke kf hi jz b fi kg kh l ki kj">View(data$rawData)</span></pre><figure class="js jt ju jv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kq"><img src="../Images/906effaf5a5096db8e55d3dedcb13747.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xXe9Js3xmbjZT191"/></div></div></figure><p id="ab1a" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这是我们的数据，您可以看到我们有14个变量，尽管有些变量包含缺失值。</p><p id="0274" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">因为它是一个<strong class="iw hj"> API </strong>，在写这篇文章时，这些是你看到的当前值，数据定期更新，因为你可以探索和看到COVID的发生率和死亡率。</p><p id="9c5f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">从现在开始，您可以像浏览常规CSV一样浏览数据。</p><p id="e5a8" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">结论</strong></p><p id="87c2" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在，你可以向你妈妈解释什么是<strong class="iw hj"> API </strong>，你也可以从<strong class="iw hj"> API </strong>中获取数据，并将其转换成合适的格式进行分析。</p><p id="9cdc" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这只是潜入海洋，一些<strong class="iw hj"> API </strong>更复杂，需要额外的操作来从他们的服务器获取数据。</p><p id="c49f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">但是这已经足够让你开始自己探索各种<strong class="iw hj"> API </strong>了。</p><p id="a1e5" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><a class="ae kk" href="https://github.com/public-apis/public-apis" rel="noopener ugc nofollow" target="_blank">你可以在这个库中找到免费的公共API。</a></p></div><div class="ab cl kr ks gp kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="hb hc hd he hf"><p id="2649" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><em class="kl">原载于2022年10月15日</em><a class="ae kk" href="https://rblogopedia.wordpress.com/2022/10/15/how-to-use-apis-in-r-programming/" rel="noopener ugc nofollow" target="_blank"><em class="kl">【http://rblogopedia.wordpress.com】</em></a><em class="kl">。</em></p></div></div>    
</body>
</html>