<html>
<head>
<title>How to make a Google search bot. GUI automation series I</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何制作一个谷歌搜索机器人？GUI自动化系列I</h1>
<blockquote>原文：<a href="https://medium.com/codex/how-to-make-a-google-search-bot-gui-automation-series-i-9eb5618d3a27?source=collection_archive---------1-----------------------#2021-02-19">https://medium.com/codex/how-to-make-a-google-search-bot-gui-automation-series-i-9eb5618d3a27?source=collection_archive---------1-----------------------#2021-02-19</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><h2 id="9d1f" class="hg hh hi bd b fp hj hk hl hm hn ho dx hp translated" aria-label="kicker paragraph"><a class="ae ge" href="http://medium.com/codex" rel="noopener">法典</a></h2><div class=""/><p id="6f30" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">今天我们将介绍一系列教程。这第一个是初学者友好的，任何人有电脑和互联网连接应该能够通过它。一定要让我知道这个节奏是太慢，太快，信息太多，还是信息不够。我会在接下来的课程中考虑任何反馈。如果你已经安装了Python和PyAutoGUI，并且只想要代码，你可以在我的<a class="ae jm" href="https://github.com/wwidjaja1/GUI" rel="noopener ugc nofollow" target="_blank"> Github </a>上获得这个文件。</p><p id="b368" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">我们这个系列的第一个项目很有趣，如果不是有点傻的话:它可以控制你的鼠标，启动谷歌浏览器，打开一个新标签，输入随机搜索，然后保存一个截图。</p><figure class="jo jp jq jr fd js er es paragraph-image"><div class="er es jn"><img src="../Images/7606fc3cf757ca407ec5cddd6a8bee84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1236/format:webp/1*3RqwUDUOc2rtRcDvTWoNww.png"/></div><figcaption class="jv jw et er es jx jy bd b be z dx translated">维基百科用户“Lordalpha1”的原始指针在谷歌幻灯片中被复制了7次</figcaption></figure><p id="bd58" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">首先，如果你还没有下载Python，你需要下载它。如果有，请跳到“安装PyAutoGUI”一节</p><p id="6894" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">可以直接从官方<a class="ae jm" href="https://www.python.org/downloads/" rel="noopener ugc nofollow" target="_blank">网站</a>下载Python。设置向导应该可以正确安装所有东西，但是为了确保你不会遇到打开IDLE或运行pip install命令这样的问题，我建议你打开YouTube教程，搜索“如何在Mac OS上安装Python”或“如何在Windows 7上安装Python”Python for Windows的默认位置是“程序文件”目录。因此，如果您在那里看到Python文件，那么您可能安装正确。您也可以通过在命令提示符下输入“python”来直接检查，它应该会告诉您版本并启动一个shell。然后，您可以通过键入“quit()”返回常规cmd</p><figure class="jo jp jq jr fd js er es paragraph-image"><div class="er es jz"><img src="../Images/0552fb8000951c794e5373748f954a3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1328/format:webp/1*-4dR89FXWKFi-8v-J5XXCg.png"/></div><figcaption class="jv jw et er es jx jy bd b be z dx translated">键入“python ”,如果您看到类似这样的内容，那么您已经正确安装了</figcaption></figure><p id="e140" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">至于错误信息，谷歌任何出现。通常堆栈溢出上的某个人已经覆盖了它。这个<a class="ae jm" href="https://docs.python.org/3/using/windows.html" rel="noopener ugc nofollow" target="_blank">站点</a>也很适合在Windows上进行故障诊断。对于本教程，我使用的是Windows操作系统，但是如果差异足够大并且很多人问我，我也可以制作Mac操作系统教程。</p><p id="bed8" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">Python安装的常见问题:</p><ol class=""><li id="6489" class="ka kb hi iq b ir is iv iw iz kc jd kd jh ke jl kf kg kh ki bi translated">未设置路径变量。这在旧版本中是个问题，但我相信最新的Python版本会在Windows中自动设置PATH变量。若要设置路径变量，请查看类似于此<a class="ae jm" href="https://datatofish.com/add-python-to-windows-path/" rel="noopener ugc nofollow" target="_blank"> one </a>或此<a class="ae jm" href="https://geek-university.com/python/add-python-to-the-windows-path/" rel="noopener ugc nofollow" target="_blank"> one </a>的教程。</li></ol><h2 id="7398" class="kj kk hi bd kl km kn ko kp kq kr ks kt iz ku kv kw jd kx ky kz jh la lb lc ho bi translated">安装PyAutoGUI</h2><p id="a493" class="pw-post-body-paragraph io ip hi iq b ir ld it iu iv le ix iy iz lf jb jc jd lg jf jg jh lh jj jk jl hb bi translated">好了，现在Python已经安装好了，我们需要安装PyAutoGUI。去软件包网站并遵循他们对你的操作系统的指导。安装Python包通常通过输入“pip install[包名]”来完成它的作用是从本地(如你的计算机或网络)或互联网(通过URL)安装文件。如果你好奇的话，pip官方网站上的<a class="ae jm" href="https://pip.pypa.io/en/stable/reference/pip_install/" rel="noopener ugc nofollow" target="_blank">这里有一个解释。</a></p><p id="c30e" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">常见错误:</p><ol class=""><li id="41f5" class="ka kb hi iq b ir is iv iw iz kc jd kd jh ke jl kf kg kh ki bi translated">Pip不是可识别的命令。这意味着没有安装pip，或者您运行终端窗口的目录不能访问文件中的pip位置。您可能需要在这里手动安装pip<a class="ae jm" href="https://pip.pypa.io/en/stable/installing/" rel="noopener ugc nofollow" target="_blank"/>。</li><li id="5342" class="ka kb hi iq b ir li iv lj iz lk jd ll jh lm jl kf kg kh ki bi translated">"名称错误:未定义名称“pip”. "你试图在Python shell或IDLE中输入这个，而不是在你的计算机终端上。确保您处于cmd模式，并且在Windows上以管理员身份运行。只需点击“开始”图标并输入“cmd”即可打开cmd。当它弹出时，右键单击命令提示符并选择“以管理员身份运行”现在输入您的命令来检查pip的安装和版本</li></ol><figure class="jo jp jq jr fd js er es paragraph-image"><div class="er es ln"><img src="../Images/6139d468335c33e985e3356aca04fdc5.png" data-original-src="https://miro.medium.com/v2/resize:fit:302/format:webp/1*5LoYQGNiXMM0jVRQjcNn3w.png"/></div></figure><p id="f63c" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">现在已经安装了PyAutoGUI，创建一个新文件夹。记住这个文件夹的位置。将该文件夹称为“guiTutorials”</p><p id="76c7" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">在新文件夹中，创建一个新的txt文件(默认情况下可能会在记事本中打开)。在这个新的txt文件中写入任何内容之前，将其保存为“auto searcher . py”——如果您在guiTutorials文件夹中按类型对文件进行排序，它现在应该显示为“Python文件”。如果没有，它很可能被称为“autoSearcher.py.txt”</p><p id="5fba" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">要解决这个问题，请转到文件浏览器中的“查看”选项卡，并确保选中“文件扩展名”框:</p><figure class="jo jp jq jr fd js er es paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="er es lo"><img src="../Images/6f8edc9aa06fbac2fd89fbbc34e4f131.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oQ54_rIDssaj-78oNNiRGA.png"/></div></div></figure><p id="106d" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">现在删除了"。txt ”,它应该显示为Python文件，如下所示:</p><figure class="jo jp jq jr fd js er es paragraph-image"><div class="er es lt"><img src="../Images/11b42c2487101cef8e9cef07e3d7c759.png" data-original-src="https://miro.medium.com/v2/resize:fit:718/format:webp/1*IqsmAol6WpNW-F_Wl3gurQ.png"/></div></figure><p id="ddc8" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">注意，如果“类型”选项卡不可用，只需右键单击“名称”选项卡并从下拉菜单中选择“类型”。</p><p id="dc98" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">现在右击文件名，选择“用空闲编辑”，然后选择“用空闲编辑[版本]”，其中[版本]与您安装的Python版本相匹配。应该会出现一个空的编辑窗口:</p><figure class="jo jp jq jr fd js er es paragraph-image"><div class="er es lu"><img src="../Images/22c0bacf668a8e3b3fb9422ac83b9581.png" data-original-src="https://miro.medium.com/v2/resize:fit:442/format:webp/1*ACY_5Z9fNKOvn7Ng0TlKUQ.png"/></div></figure><p id="a560" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">如果安装所有的软件需要一些时间，不要气馁。这很正常。</p><h2 id="943f" class="kj kk hi bd kl km kn ko kp kq kr ks kt iz ku kv kw jd kx ky kz jh la lb lc ho bi translated">编写代码</h2><p id="bef0" class="pw-post-body-paragraph io ip hi iq b ir ld it iu iv le ix iy iz lf jb jc jd lg jf jg jh lh jj jk jl hb bi translated">从我们之前提到的高级概念开始:“控制你的鼠标，启动谷歌浏览器，打开一个新标签，输入随机搜索，然后保存截图”，我们可以很容易地将描述分成几个步骤:</p><ol class=""><li id="d869" class="ka kb hi iq b ir is iv iw iz kc jd kd jh ke jl kf kg kh ki bi translated">控制鼠标</li><li id="09c7" class="ka kb hi iq b ir li iv lj iz lk jd ll jh lm jl kf kg kh ki bi translated">启动谷歌浏览器</li><li id="7724" class="ka kb hi iq b ir li iv lj iz lk jd ll jh lm jl kf kg kh ki bi translated">打开一个新标签</li><li id="50de" class="ka kb hi iq b ir li iv lj iz lk jd ll jh lm jl kf kg kh ki bi translated">键入随机搜索</li><li id="d54f" class="ka kb hi iq b ir li iv lj iz lk jd ll jh lm jl kf kg kh ki bi translated">截图</li></ol><p id="ba4f" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">现在让我们考虑一下每一步实际需要发生什么。也许我们会发现“隐藏的”我们没有想到的步骤或需求。也许我们会发现有些东西我们并不需要。</p><p id="0a8a" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated"><strong class="iq hs">控制鼠标/触摸板:</strong>鼠标驱动程序是一块硬件代码。另一段代码可以通过win32 API访问它。我们可以自己调用win32或者使用PyAutoGUI的内置方法。在未来的教程中，我们将看到两者的例子。</p><figure class="jo jp jq jr fd js er es paragraph-image"><div class="er es lw"><img src="../Images/132e74fcc49e4d1d62fbae3540d4d897.png" data-original-src="https://miro.medium.com/v2/resize:fit:972/format:webp/1*ymVgeYeZIUReremKDk6mDQ.png"/></div><figcaption class="jv jw et er es jx jy bd b be z dx translated">使用win32api控制鼠标和点击的辅助功能。我最初认为我们需要这个。我们现在没有使用它，但是将来的教程可能会用到！</figcaption></figure><p id="1830" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated"><strong class="iq hs">定义主体</strong>:这个很简单。我们想做一个try/except块(像Java里的try/catch块)。我们的代码将运行“try”部分中的内容，除非KeyBoardInterrupt变为true。此时，运行“except”块中的代码。如果用户按下“中断”键(默认情况下，这是ctrl+c或delete键)，我们将在那里放置一个简单的print和sys.exit()来停止程序。</p><figure class="jo jp jq jr fd js er es paragraph-image"><div class="er es lx"><img src="../Images/e70bbf96cbb577080e7d5077b76e6d62.png" data-original-src="https://miro.medium.com/v2/resize:fit:662/format:webp/1*RBPq0A86mTIDDx0pICSgwQ.png"/></div><figcaption class="jv jw et er es jx jy bd b be z dx translated">我们的主代码放在“try”块中</figcaption></figure><p id="0461" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated"><strong class="iq hs">制作话题清单:</strong>制作话题清单是最简单的部分。只需定义一个名为“topicList”的新数组，然后放入我们想要的任何字符串。以下是我的一个例子:</p><figure class="jo jp jq jr fd js er es paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="er es ly"><img src="../Images/b06a5dd43751205498ba3fc45dd55bc7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nMYDPha_Z1nntiIDmwTXKQ.png"/></div></div><figcaption class="jv jw et er es jx jy bd b be z dx translated">键入任意数量的字符串或短语</figcaption></figure><p id="0748" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">启动谷歌Chrome: 现在这有点有趣了。我们不能在代码中的某个地方声明“启动谷歌浏览器”或“点击浏览器”我们需要定位Chrome在系统中的位置并命令它启动，或者模仿用户会采取的相同动作。让我们模仿用户的动作。既然我们有PyAutoGUI，我们有两种方法可以做到这一点:扫描屏幕上的谷歌浏览器图标，或者:通过“开始”菜单或“Windows”键访问它。由于图标在每个桌面上可能看起来不同(或者甚至在给定时间不存在于屏幕上)，较少出错的方法是使用“Windows”键，因为任何Windows用户都可以使用该键。好了，这一步实际上是"<em class="lv">按下Windows键，键入短语“谷歌浏览器”，然后按下“回车”键。</em>”</p><figure class="jo jp jq jr fd js er es paragraph-image"><div class="er es lz"><img src="../Images/27f71c121876ea2dadf55917014300cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:992/format:webp/1*9B8pqcNmpPhmk0uxmPSxmQ.png"/></div><figcaption class="jv jw et er es jx jy bd b be z dx translated">这三个子步骤之后是用于调试和确认到达第行的打印语句。我增加了延迟，让系统能够跟上。请注意write()函数中0.25秒的延迟。有时电脑打字太快，会漏掉一些字符。此外，这给了一个看起来很酷的打字效果。</figcaption></figure><p id="a5e7" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">现在Chrome已经打开了，我们的下一个任务是打开一个新的标签页。也有可能我们导航到了一个已经打开的Chrome窗口，或者我们重新打开了一个保存的标签页会话。我们正在打开一个新标签，以确保我们不会“覆盖”和搜索已经打开的标签。在Chrome上，这是一个简单的“ctrl + T”快捷键。PyAutoGUI非常酷，因为我们甚至可以用hotkey()函数对这些快捷组合进行编程。然而，我们需要推迟。这是因为电脑按这两个键的速度太快了，以至于它不会记录为单独的按键。使用0.5秒的间隔。</p><figure class="jo jp jq jr fd js er es paragraph-image"><div class="er es ma"><img src="../Images/3a73f9f2fb3327db625c0b566954a2a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:726/format:webp/1*MgQ8T17TfPQnq-2ooubBkA.png"/></div><figcaption class="jv jw et er es jx jy bd b be z dx translated">用快捷键慢慢打开一个新标签页</figcaption></figure><p id="0878" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated"><strong class="iq hs">输入查询:</strong>由于Chrome已经默认谷歌搜索，剩下的就是输入随机搜索。我们可以使用PyAutoGUI.write()从随机字符串数组中选择要输入的字符串，然后点击“enter”进行搜索。通过从0到数组的最后一个索引(数组-1的长度)取一个随机整数来获得这个数组的随机条目。然后我们可以选择一个随机字符串传递给write()函数:</p><figure class="jo jp jq jr fd js er es paragraph-image"><div class="er es mb"><img src="../Images/0ed1019c3d9589138160f1f348e5c114.png" data-original-src="https://miro.medium.com/v2/resize:fit:878/format:webp/1*le6_F4rKNZzpDwfLneNtYA.png"/></div><figcaption class="jv jw et er es jx jy bd b be z dx translated">从列表中随机选择一个主题，然后使用PyAutoGUI进行搜索。</figcaption></figure><p id="5f17" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">现在我们只需要点击回车，然后截图。因为我们正在进行实际的互联网搜索，所以我们想在截图之前延迟一段时间等待结果加载。我为此选择了4秒。我还给了2秒钟时间在Chrome搜索栏中输入查询。⁴</p><figure class="jo jp jq jr fd js er es paragraph-image"><div class="er es mc"><img src="../Images/f5fc08350d5a8e58a4718ec24747be18.png" data-original-src="https://miro.medium.com/v2/resize:fit:488/format:webp/1*HJLCjwW2uDJMCcexWmB-fA.png"/></div><figcaption class="jv jw et er es jx jy bd b be z dx translated">点击回车键，然后保存截图</figcaption></figure><p id="02d4" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">我们将截图存储在一个名为“im1”的变量中然后我们可以使用“保存”功能。但是，我们希望创建唯一的文件字符串，而不是创建一堆im1 (1)、im1 (2)、im1 (3)文件。在单台计算机上运行的每次搜索最有可能具有的一个特征是日期和时间。我们还想包括我们搜索的主题。我们可以通过用datetime库检索时间，并在“save”函数中连接(组合)字符串来完成这两项工作:</p><figure class="jo jp jq jr fd js er es paragraph-image"><div class="er es md"><img src="../Images/76bb502a48510b8ac7bce1f796d19897.png" data-original-src="https://miro.medium.com/v2/resize:fit:1064/format:webp/1*v78ay4Jd2Q055IcPA3D0RQ.png"/></div><figcaption class="jv jw et er es jx jy bd b be z dx translated">我们调用datetime函数，然后将当前时间保存在一个字符串中。我们将主题和时间结合起来，形成一个唯一的文件名。</figcaption></figure><p id="2f7c" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">我们把截图保存到Python代码文件所在的文件夹中，然后退出程序。现在我们完成了！要运行您的程序，请按“f5”或单击“运行”选项卡，然后单击“运行模块”选项。</p><figure class="jo jp jq jr fd js er es paragraph-image"><div class="er es me"><img src="../Images/7d3f5c3fef1cc46ac09bd53269e1d8ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1190/format:webp/1*TQ2-LMI9lva_lzbJ6zoO7Q.png"/></div><figcaption class="jv jw et er es jx jy bd b be z dx translated">一些搜索结果图像会自动以唯一的名称保存</figcaption></figure><p id="67c2" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">和任何代码一样，总有改进的空间。我甚至在这里和Github的评论中提出了一些方法。希望用PyAutoGUI把这个系列做的有趣一点。我可能还会强调一些其他的Python库来增加趣味。如果你想看另一个Python包或编程主题，请告诉我，我可能会考虑为它制作一个新的教程。</p><ol class=""><li id="baaf" class="ka kb hi iq b ir is iv iw iz kc jd kd jh ke jl kf kg kh ki bi translated">如果你很好奇，触摸板的工作原理是因为任何接触它的导电材料都会在某些点改变它的电容(电容是一种类似质量的物理属性)。电容的这些变化被映射到移动命令。你也可以使用一系列的柔性电阻。但是对于另一个教程系列来说，制作触摸板已经足够复杂了。</li><li id="084a" class="ka kb hi iq b ir li iv lj iz lk jd ll jh lm jl kf kg kh ki bi translated">从技术上来说，我们可以。我们需要编写完成这些事情的代码，然后解析用户输入的字符串。这就是命令行的工作方式，如果有很多需求的话，我们可以在将来做一个用户输入/输出终端教程，就像那些文本冒险小游戏一样。</li><li id="d1c9" class="ka kb hi iq b ir li iv lj iz lk jd ll jh lm jl kf kg kh ki bi translated">这实际上也容易出错。如果Google Chrome浏览器没有出现在搜索结果的第一位，那么我们将不会打开正确的程序(例如，如果一个名为“Google Chrome”的文本文件碰巧被突出显示在第一位)</li><li id="7432" class="ka kb hi iq b ir li iv lj iz lk jd ll jh lm jl kf kg kh ki bi translated">随机延迟并不是最好的方法，但是现在很方便。一种更干净的方法是跟踪计算机上的事件或任务，只有当事件条件触发时才运行下一步。</li></ol></div></div>    
</body>
</html>