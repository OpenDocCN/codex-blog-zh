<html>
<head>
<title>The Pragmatic Programmer EP.5 — Imperfect Software</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">实用程序员EP.5 —不完美的软件</h1>
<blockquote>原文：<a href="https://medium.com/codex/the-pragmatic-programmer-ep-5-imperfect-software-ea2239dfd16f?source=collection_archive---------15-----------------------#2022-05-10">https://medium.com/codex/the-pragmatic-programmer-ep-5-imperfect-software-ea2239dfd16f?source=collection_archive---------15-----------------------#2022-05-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="8700" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因为我们永远无法创建完美的软件。因此，我们采用以下技术来确保您将拥有的软件的高质量。</p><h1 id="5064" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">合同设计</h1><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es kb"><img src="../Images/bc03a7abaf4ff8a89bb5a23d88d63a12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RuPr2ORWKBkCgxtKGCl_DA.jpeg"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">由<a class="ae kr" href="https://www.pexels.com/@pixabay/" rel="noopener ugc nofollow" target="_blank"> Pixabay </a>以<a class="ae kr" href="http://www.pexels.com" rel="noopener ugc nofollow" target="_blank">像素</a>拍摄的照片</figcaption></figure><p id="f1c2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">合同是两个或两个以上的人之间达成的协议，尤其是在商业交易中。其中一个是<em class="ks">客户</em>，他雇佣另一个被称为<em class="ks">供应商</em>的人去做一些事情。转到将契约应用到我们的代码上，在创建一个例程之前，我们必须声明包含三个主要部分的契约，正如<a class="ae kr" href="https://en.wikipedia.org/wiki/Bertrand_Meyer" rel="noopener ugc nofollow" target="_blank"> Mayer </a>所描述的:</p><ol class=""><li id="5811" class="kt ku hi ih b ii ij im in iq kv iu kw iy kx jc ky kz la lb bi translated">前置条件:必须为真才能进入例程的条件。</li><li id="a680" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc ky kz la lb bi translated">后置条件:进入例程后必须为真的条件。</li><li id="faac" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc ky kz la lb bi translated">类不变式:从调用者的角度来看，必须始终为真的语句。</li></ol><p id="62f7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你答应打电话给我一个令人满意的先决条件，我会给你一个请后置条件的最终状态。</p><p id="473d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">感谢在<a class="ae kr" href="https://www.win.tue.nl/~wstomv/edu/2ip30/references/design-by-contract/index.html" rel="noopener ugc nofollow" target="_blank"> win.tue.nl </a>上提供以下示例的知识材料:</p><pre class="kc kd ke kf fd lh li lj lk aw ll bi"><span id="6285" class="lm je hi li b fi ln lo l lp lq">Obligations                        Benefits<br/>--------------------------------------------------------------------<br/>Client    Pay entire cost for one month in   Enjoy a low-cost<br/>          advance. Bring only limited        hassle-free all <br/>          baggage and valid passports and    expenses paid vacation.<br/>          visas, etc. Arrive at the airport<br/>          for two hours before the flight <br/>          leaves.<br/><br/>Supplier  Locate, select and book airlines   Make profit on sale <br/>          carrier, auto rental, hotel, etc.  even if client does not <br/>          within required time frame and     show up at the airport <br/>          budget.                            on time and properly<br/>                                             equipped. May even keep<br/>                                             possible partial refund<br/>                                             from hotel etc. in such<br/>                                             cases.</span></pre><p id="991a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面是一个在Eiffel语言中应用DbC的示例:</p><figure class="kc kd ke kf fd kg"><div class="bz dy l di"><div class="lr ls l"/></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">感谢<a class="ae kr" href="https://www.win.tue.nl/~wstomv/edu/2ip30/references/design-by-contract/index.html" rel="noopener ugc nofollow" target="_blank"> win.tue.nl </a></figcaption></figure><h2 id="d691" class="lm je hi bd jf lt lu lv jj lw lx ly jn iq lz ma jr iu mb mc jv iy md me jz mf bi translated">契约式设计(DbC)与测试驱动开发(TDD)</h2><ol class=""><li id="0fc8" class="kt ku hi ih b ii mg im mh iq mi iu mj iy mk jc ky kz la lb bi translated">DbC需要嘲讽，而TDD需要。</li><li id="3146" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc ky kz la lb bi translated">DbC定义了所有成功和失败的案例，而TDD旨在测试一个特定的案例。</li><li id="bebe" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc ky kz la lb bi translated">TDD只执行测试时间，而DbC是永远的，包括设计、开发、部署和维护阶段。</li></ol></div><div class="ab cl ml mm gp mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="hb hc hd he hf"><h1 id="1e05" class="jd je hi bd jf jg ms ji jj jk mt jm jn jo mu jq jr js mv ju jv jw mw jy jz ka bi translated">错误处理</h1><p id="9d17" class="pw-post-body-paragraph if ig hi ih b ii mg ik il im mh io ip iq mx is it iu my iw ix iy mz ja jb jc hb bi translated">每当错误出现时，它肯定是气味的事情发生了。正如上一集所写的，<a class="ae kr" rel="noopener" href="/codex/the-pragmatic-programmer-ep-4-tools-3bf554bccc7c">务实的程序员EP.4 — Tools </a>，仔细阅读了那些错误信息。它想告诉我们一些事情。回到编码，我们可以使用这些技术产生更少的bug。</p><h2 id="3732" class="lm je hi bd jf lt lu lv jj lw lx ly jn iq lz ma jr iu mb mc jv iy md me jz mf bi translated">提出所有可能的情况</h2><figure class="kc kd ke kf fd kg"><div class="bz dy l di"><div class="lr ls l"/></div></figure><p id="7c2f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您想要引发异常，您应该为所有可能发生的情况处理它们。否则，您应该在下面这样做，因为它不会误导真正的错误是什么，并且您不必在添加更多代码时修改异常处理部分。</p><figure class="kc kd ke kf fd kg"><div class="bz dy l di"><div class="lr ls l"/></div></figure><h2 id="e36c" class="lm je hi bd jf lt lu lv jj lw lx ly jn iq lz ma jr iu mb mc jv iy md me jz mf bi translated">提前冲突</h2><p id="1366" class="pw-post-body-paragraph if ig hi ih b ii mg ik il im mh io ip iq mx is it iu my iw ix iy mz ja jb jc hb bi translated">为了避免可能发生的错误，在使用之前验证一些东西是常识。所以，试着尽可能快地把它们踢出去，而不是让它们一直流到最后。</p><figure class="kc kd ke kf fd kg"><div class="bz dy l di"><div class="lr ls l"/></div></figure></div><div class="ab cl ml mm gp mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="hb hc hd he hf"><h1 id="fdde" class="jd je hi bd jf jg ms ji jj jk mt jm jn jo mu jq jr js mv ju jv jw mw jy jz ka bi translated">断言</h1><p id="9aaa" class="pw-post-body-paragraph if ig hi ih b ii mg ik il im mh io ip iq mx is it iu my iw ix iy mz ja jb jc hb bi translated">您可能不知道断言可以用在您的功能代码中，而不仅仅是测试代码中。是的，它可以用来明确地确保存储在变量中的值处于您所期望的状态。让我看看。</p><figure class="kc kd ke kf fd kg"><div class="bz dy l di"><div class="lr ls l"/></div></figure><figure class="kc kd ke kf fd kg"><div class="bz dy l di"><div class="lr ls l"/></div></figure><blockquote class="na nb nc"><p id="9cf7" class="if ig ks ih b ii ij ik il im in io ip nd ir is it ne iv iw ix nf iz ja jb jc hb bi translated">请记住，没有必要从您的产品中删除断言。</p></blockquote><p id="a555" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">始终打开它们，因为它们有助于我们在使用前确保价值。众所周知，一部作品总是共享记忆和其他资源。这意味着完全内存分配很容易发生，而不是在您的个人笔记本电脑上执行。即使您面临由断言引起的性能问题，也不要关闭所有的断言，而是要视具体情况而定。</p></div><div class="ab cl ml mm gp mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="hb hc hd he hf"><h1 id="133d" class="jd je hi bd jf jg ms ji jj jk mt jm jn jo mu jq jr js mv ju jv jw mw jy jz ka bi translated">资源平衡</h1><blockquote class="ng"><p id="0b50" class="nh ni hi bd nj nk nl nm nn no np jc dx translated">在同一个地方释放你所分配的</p></blockquote><figure class="nq nr ns nt nu kg"><div class="bz dy l di"><div class="lr ls l"/></div></figure><p id="27aa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如你在上面看到的代码块，你可能不认为这是正常的。但是，让我们仔细看看。它们在3个函数之间共享一个<strong class="ih hj">文件</strong>变量，并且与<strong class="ih hj">文件</strong>的连接从未关闭。</p><p id="d243" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">作为一个务实的程序员，你应该了解这些资源。你必须释放你已经分配的。为了更容易释放它，我们将<strong class="ih hj">文件</strong>保存在同一个地方，不将它暴露给另一个函数，就像这样:</p><figure class="kc kd ke kf fd kg"><div class="bz dy l di"><div class="lr ls l"/></div></figure><p id="a4f1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您<strong class="ih hj">需要</strong>在不同的地方访问相同的资源，作者提供了两个建议</p><ol class=""><li id="683d" class="kt ku hi ih b ii ij im in iq kv iu kw iy kx jc ky kz la lb bi translated">尝试以与分配资源相反的顺序释放资源<em class="ks"/></li><li id="2d74" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc ky kz la lb bi translated">尝试以相同的顺序分配资源，以避免<a class="ae kr" href="https://en.wikipedia.org/wiki/Deadlock" rel="noopener ugc nofollow" target="_blank">死锁</a>。</li></ol><p id="b4c6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">幸运的是，在面向对象的语言中，<em class="ks">垃圾收集器</em>通常可以在对象超出范围时自动释放，例如Java。</p><p id="7851" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在某些语言中，我们可以使用一个<em class="ks">变量作用域</em>来处理资源，例如C++。同时，在许多语言中，除了还有一个<strong class="ih hj">和一个<strong class="ih hj">最后的</strong>阶段。下面我们来看看:</strong></p><figure class="kc kd ke kf fd kg"><div class="bz dy l di"><div class="lr ls l"/></div></figure><p id="b4ff" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请仔细用一个<strong class="ih hj">最后的</strong>子句写逻辑，让我们想象一下当<strong class="ih hj"> open_file </strong>失败时会发生什么。当然，一个<strong class="ih hj">文件</strong>会在它还没有打开的地方被关闭。所以，应该是这样的:</p><figure class="kc kd ke kf fd kg"><div class="bz dy l di"><div class="lr ls l"/></div></figure></div><div class="ab cl ml mm gp mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="hb hc hd he hf"><h1 id="62e6" class="jd je hi bd jf jg ms ji jj jk mt jm jn jo mu jq jr js mv ju jv jw mw jy jz ka bi translated">快速配速</h1><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es nv"><img src="../Images/11dd2d1197ed9a8853593e5936dd1701.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qXFf7yPuFxapDuKKmrZfoQ.jpeg"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">照片由<a class="ae kr" href="https://www.pexels.com/@daniel-reche-718241/" rel="noopener ugc nofollow" target="_blank">丹尼尔·雷切</a>以<a class="ae kr" href="http://www.pexels.com" rel="noopener ugc nofollow" target="_blank">像素</a>拍摄</figcaption></figure><p id="19c0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">作为一名工程师，我们通常相信我们所看到的，而不是神谕或难以预测的东西。因此，我们只是小步前进并获得反馈，例如，单元测试反馈(告诉你错过了哪一行)、安全性反馈、牛排架反馈、特性反馈等等。</p></div><div class="ab cl ml mm gp mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="hb hc hd he hf"><p id="415f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请注意，上面显示的所有示例都是示例，只是为了强调对概念的理解。它可能被简化理解，而不是正确的语言语法。</p><p id="ab5d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">感谢《实用编程》这本书提供了以上知识，如果你有兴趣阅读这本书，点击<a class="ae kr" href="https://learning.oreilly.com/library/view/the-pragmatic-programmer/9780135956977/" rel="noopener ugc nofollow" target="_blank">此处</a>了解更多详情。</p></div></div>    
</body>
</html>