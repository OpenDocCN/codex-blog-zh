<html>
<head>
<title>Introduction to Model Evaluation Methods in Classification Problems</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">分类问题中的模型评估方法介绍</h1>
<blockquote>原文：<a href="https://medium.com/codex/introduction-to-model-evaluation-methods-in-classification-problems-ceb0a90f6aba?source=collection_archive---------8-----------------------#2021-10-28">https://medium.com/codex/introduction-to-model-evaluation-methods-in-classification-problems-ceb0a90f6aba?source=collection_archive---------8-----------------------#2021-10-28</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="a3ef" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">Python中的应用示例:混淆矩阵、准确度、精确度、召回率和F1分数</h2></div><p id="efe3" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们将试图通过这个故事指出我们如何衡量分类模型和逻辑回归介绍的成功。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es jt"><img src="../Images/df72976bf9663bdb34904e4f63f83ac9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jbAUJ5aMWMnc92cKxggQQA.jpeg"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">詹·西奥多在<a class="ae kj" href="https://unsplash.com/s/photos/predict?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="5854" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">正如<a class="ae kj" href="https://mebaysan.medium.com/introduction-to-model-evaluation-methods-in-regression-models-1b9c1c50f8a0" rel="noopener">前面提到的</a>，我们使用回归模型来预测连续变量。尽管逻辑回归中包含“回归”，我们还是用它来预测分类变量。因此，逻辑回归解决了分类问题。在这个故事中，我使用逻辑回归来获得分类分数。</p><p id="dcf4" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">目标类在目标变量中将有1。例如，如果我们使用<a class="ae kj" href="https://www.kaggle.com/uciml/pima-indians-diabetes-database" rel="noopener ugc nofollow" target="_blank">糖尿病数据集</a>来预测其是否患有糖尿病，那么如果观察值患有糖尿病，则目标变量将为1。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es kk"><img src="../Images/35cd1f800b13ee75fd5cb49a50d92d0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yU5d_TVoTV0wgxkX8ZoEQA.png"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">作者图片</figcaption></figure><h1 id="f451" class="kl km hi bd kn ko kp kq kr ks kt ku kv io kw ip kx ir ky is kz iu la iv lb lc bi translated">混淆矩阵</h1><p id="1a1d" class="pw-post-body-paragraph ix iy hi iz b ja ld ij jc jd le im jf jg lf ji jj jk lg jm jn jo lh jq jr js hb bi translated">我更愿意举个例子来说明这一点。为了说明混淆矩阵是什么，假设:我们有<strong class="iz hj"> 990笔正常交易</strong>和<strong class="iz hj"> 10笔欺诈交易</strong>。我们将创建一个模型来预测交易是否是欺诈。那么模型<strong class="iz hj">将推断出我们已经有的总共10个欺诈交易</strong>中的5个真交易和5个假交易。并且<strong class="iz hj">我们已经有990个非欺诈交易</strong>推断出90个假交易和900个真交易。</p><p id="d167" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">此时，我们创建了一个混淆矩阵。在该矩阵中，行代表实际类别，列代表预测目标变量的预测类别。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es kk"><img src="../Images/eff7d9f78e23e91aeaa6f470e0d1a21f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BjRDEmWOO7t2-yTgV4qnfQ.png"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">作者图片</figcaption></figure><ul class=""><li id="2870" class="li lj hi iz b ja jb jd je jg lk jk ll jo lm js ln lo lp lq bi translated">真正(TP):预测类为1实际上是1。欺诈交易被预测为欺诈交易。所以预测是真的。</li><li id="eeba" class="li lj hi iz b ja lr jd ls jg lt jk lu jo lv js ln lo lp lq bi translated">误报(FP):预测的类1实际上不是1。非欺诈交易被预测为欺诈交易。所以，预测是假的。</li><li id="ad0a" class="li lj hi iz b ja lr jd ls jg lt jk lu jo lv js ln lo lp lq bi translated">假阴性(FN):预测为0的类实际上不是0。该模型预测了真实欺诈交易的非欺诈性。因此，欺诈交易不会被预测为欺诈交易。所以，预测是假的。</li><li id="00c3" class="li lj hi iz b ja lr jd ls jg lt jk lu jo lv js ln lo lp lq bi translated">真阴性(TN):预测类为0实际上是0。该模型预测了非欺诈交易的非欺诈性。所以，预测是真的。</li></ul><p id="ca67" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">有时一些术语可能会令人混淆，如肯定和否定。对我们来说什么是积极的，什么是消极的？如果我们在目标类(1)上工作，我们说正。如果我们在非目标类(0)上工作，我们说负。所以，左栏代表正面，右栏代表负面。</p><blockquote class="lw lx ly"><p id="2673" class="ix iy lz iz b ja jb ij jc jd je im jf ma jh ji jj mb jl jm jn mc jp jq jr js hb bi translated">你可能会问:假阳性(FP)和假阴性(FN)哪个更关键？我可以说假阴性比假阳性更关键。为了说明这一点:我们说非欺诈交易，有人抢劫了一大笔钱。</p></blockquote><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es md"><img src="../Images/44ca055a61a53d7311989533c31f5583.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3h5siK9N1wA6lhsd-39yjw.jpeg"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated"><a class="ae kj" href="https://unsplash.com/@bermixstudio?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Bermix工作室</a>在<a class="ae kj" href="https://unsplash.com/s/photos/fraud?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</figcaption></figure><p id="87ec" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在我们可以继续学习分类模型的度量标准。</p><h2 id="5d99" class="me km hi bd kn mf mg mh kr mi mj mk kv jg ml mm kx jk mn mo kz jo mp mq lb mr bi translated">分类模型的度量标准</h2><p id="e4c7" class="pw-post-body-paragraph ix iy hi iz b ja ld ij jc jd le im jf jg lf ji jj jk lg jm jn jo lh jq jr js hb bi translated">我们有一堆度量标准来衡量分类模型的成功。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es kk"><img src="../Images/209b323c31f23794d473048dced9e512.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uLlxMhYyqiwJCoMF1DN-MA.png"/></div></div></figure><p id="0747" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们看到上面的公式来衡量指标。</p><ul class=""><li id="a29c" class="li lj hi iz b ja jb jd je jg lk jk ll jo lm js ln lo lp lq bi translated"><strong class="iz hj">准确性:</strong>我们正确估计1是1，0是0的成功率是多少？例如，该模型将5个(总共10个)真实欺诈交易估计为欺诈交易，将900个(总共990个)非欺诈交易估计为非欺诈交易。我们将两者相加，并将其分为所有观测值的计数。</li><li id="a6e0" class="li lj hi iz b ja lr jd ls jg lt jk lu jo lv js ln lo lp lq bi translated"><strong class="iz hj"> Precision: </strong>在估计为1的正确值中，我们的成功率是多少？例如，该模型估计5笔交易为欺诈交易，90笔非欺诈交易为欺诈交易。只有5个正确的估计。我们将正确估计的百分比计算为估计值1。</li><li id="ead6" class="li lj hi iz b ja lr jd ls jg lt jk lu jo lv js ln lo lp lq bi translated"><strong class="iz hj">回想一下:</strong>我们在正确估计实际上为1的类的值时，成功的百分比是多少？例如，我们有10笔非欺诈交易。该模型估计5笔交易为欺诈，5笔交易为非欺诈。我们计算真实欺诈交易的百分比，作为正确的估计。</li><li id="202b" class="li lj hi iz b ja lr jd ls jg lt jk lu jo lv js ln lo lp lq bi translated"><strong class="iz hj"> F1-Score: </strong>我们可以说是精度和召回率的调和平均值。</li></ul><h2 id="c1e0" class="me km hi bd kn mf mg mh kr mi mj mk kv jg ml mm kx jk mn mo kz jo mp mq lb mr bi translated">Python中的应用示例</h2><p id="2f8c" class="pw-post-body-paragraph ix iy hi iz b ja ld ij jc jd le im jf jg lf ji jj jk lg jm jn jo lh jq jr js hb bi translated">实际上，我不会深究什么是逻辑回归，以及我们如何使用它。</p><p id="8681" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我将导入我们需要的库。正如我们看到的，我们使用<code class="du ms mt mu mv b">sklearn.metrics</code>来获得测量模型的成功。</p><pre class="ju jv jw jx fd mw mv mx my aw mz bi"><span id="bd12" class="me km hi mv b fi na nb l nc nd">import matplotlib.pyplot as plt<br/>import numpy as np<br/>import pandas as pd<br/>import seaborn as sns<br/>from sklearn.linear_model import LogisticRegression<br/>from sklearn.metrics import confusion_matrix, classification_report, accuracy_score<br/>from sklearn.model_selection import train_test_split<br/>from sklearn.preprocessing import RobustScaler</span></pre><p id="5a30" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我将快速跳过介绍部分，直接创建一个模型。</p><pre class="ju jv jw jx fd mw mv mx my aw mz bi"><span id="2aae" class="me km hi mv b fi na nb l nc nd">df = pd.read_csv('../input/pima-indians-diabetes-database/diabetes.csv')</span><span id="67f0" class="me km hi mv b fi ne nb l nc nd">X = df.drop(['Outcome'],axis=1)<br/>y = df['Outcome']</span><span id="7d5d" class="me km hi mv b fi ne nb l nc nd">robscaler = RobustScaler()<br/>X = robscaler.fit_transform(X)</span><span id="fda8" class="me km hi mv b fi ne nb l nc nd">X_train, X_test, y_train, y_test = train_test_split(X,y, train_size=0.8, random_state=6)</span><span id="ee35" class="me km hi mv b fi ne nb l nc nd">logreg = LogisticRegression()<br/>logreg.fit(X_train, y_train)<br/>y_pred = logreg.predict(X_test)</span><span id="c84d" class="me km hi mv b fi ne nb l nc nd">confusion_matrix(y_test,y_pred) # to get cunfusion matrix<br/>print(classification_report(y_test,y_pred)) # to get mectrics such as precision, recall etc.</span></pre><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es kk"><img src="../Images/03a961e5f45a2796b352c8380663ef4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5QJvDKmH94HA21oiGkcwcw.png"/></div></div></figure><h1 id="cbaa" class="kl km hi bd kn ko kp kq kr ks kt ku kv io kw ip kx ir ky is kz iu la iv lb lc bi translated">最后</h1><p id="0855" class="pw-post-body-paragraph ix iy hi iz b ja ld ij jc jd le im jf jg lf ji jj jk lg jm jn jo lh jq jr js hb bi translated">我知道，这可能是太快跳过，但我不想混淆。我想把重点放在主要话题上，比如什么是衡量标准？Python代码不是主要话题。希望你为自己提取了一些花絮，这是有帮助的。</p><p id="b916" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">你可以得到下面我为你创建的谷歌电子表格。此外，您可以在电子表格旁摆弄混淆矩阵。</p><div class="nf ng ez fb nh ni"><a href="https://docs.google.com/spreadsheets/d/1L0MpyBsrwfpIuKwR-2O7pl4FqFnYtJxI0tpKgMLsFdY/edit?usp=sharing" rel="noopener  ugc nofollow" target="_blank"><div class="nj ab dw"><div class="nk ab nl cl cj nm"><h2 class="bd hj fi z dy nn ea eb no ed ef hh bi translated">分类问题中的模型评估方法介绍</h2><div class="np l"><h3 class="bd b fi z dy nn ea eb no ed ef dx translated">Sheet1预测类类1，类0真实类，类1，真阳性(TP)，假阴性(FN) 5，5，10类…</h3></div><div class="nq l"><p class="bd b fp z dy nn ea eb no ed ef dx translated">docs.google.com</p></div></div><div class="nr l"><div class="ns l nt nu nv nr nw kd ni"/></div></div></a></div><p id="4743" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">还有，你可以得到下面的Kaggle笔记本。</p><div class="nf ng ez fb nh ni"><a href="https://www.kaggle.com/enesbaysan/modelevaluation-methods-in-classification-problems" rel="noopener  ugc nofollow" target="_blank"><div class="nj ab dw"><div class="nk ab nl cl cj nm"><h2 class="bd hj fi z dy nn ea eb no ed ef hh bi translated">分类问题中的模型评估方法</h2><div class="np l"><h3 class="bd b fi z dy nn ea eb no ed ef dx translated">使用Kaggle笔记本探索和运行机器学习代码|使用来自皮马印第安人糖尿病数据库的数据</h3></div><div class="nq l"><p class="bd b fp z dy nn ea eb no ed ef dx translated">www.kaggle.com</p></div></div><div class="nr l"><div class="nx l nt nu nv nr nw kd ni"/></div></div></a></div><p id="43b5" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">亲切的问候。</p></div></div>    
</body>
</html>