<html>
<head>
<title>Using WSL 2 in Enterprises</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在企业中使用WSL 2</h1>
<blockquote>原文：<a href="https://medium.com/codex/using-wsl-2-in-enterprises-d9cef1f60c73?source=collection_archive---------0-----------------------#2021-11-01">https://medium.com/codex/using-wsl-2-in-enterprises-d9cef1f60c73?source=collection_archive---------0-----------------------#2021-11-01</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="ef6c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在企业环境中安装、配置和分发WSL 2</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/75007729117caa487bb01761e090e06f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I1IKPfr1ZVBnAgnnT2MNFg.png"/></div></div></figure><p id="5940" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">用于<strong class="ih hj"> L </strong> inux (WSL)的<strong class="ih hj">W</strong>Windows<strong class="ih hj">S</strong>子系统支持直接在Windows上执行Linux环境，而不需要虚拟机或任何其他类似的设置。与第一个版本相比，使用WSL 2 很多事情变得更容易和更快。但是当在位于企业环境中的系统上运行时，通常会有一些限制，如企业代理、自定义名称服务器或SSL检查。因此，在访问互联网、安装额外的包或使用WSL 2的Visual Studio调试器等之前，必须首先完成一些挑战。本文总结了在企业环境中开始使用WSL 2的一些常见步骤。</p></div><div class="ab cl jq jr gp js" role="separator"><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv"/></div><div class="hb hc hd he hf"><h1 id="a29c" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">安装WSL 2发行版</h1><p id="1cb1" class="pw-post-body-paragraph if ig hi ih b ii kv ik il im kw io ip iq kx is it iu ky iw ix iy kz ja jb jc hb bi translated">在进入特定配置之前，必须在系统上安装WSL 2。微软提供的伟大<a class="ae jp" href="https://docs.microsoft.com/en-us/windows/wsl/install" rel="noopener ugc nofollow" target="_blank">文档涵盖了WSL 2的安装。在新的Windows系统(Windows 10 Build 19041和更高版本或Windows 11)上，这相当容易。</a></p><pre class="je jf jg jh fd la lb lc ld aw le bi"><span id="9d7c" class="lf jy hi lb b fi lg lh l li lj"><em class="lk"># Schema</em><br/>wsl --install -d &lt;&lt;distro&gt;&gt;</span><span id="6277" class="lf jy hi lb b fi ll lh l li lj"><em class="lk"># Install Ubuntu</em><br/>wsl --install -d Ubuntu</span></pre><p id="5afa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您唯一需要做的就是在PowerShell提示符下执行上述命令。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lm"><img src="../Images/77725cfd62c5d2432c5d0670cfd9479f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8TI6JtyAh70m1Rma86gAag.png"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">在Windows 11上安装WSL 2</figcaption></figure><p id="5aa1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在较旧的系统上，还需要执行更多的步骤。它们在<a class="ae jp" href="https://docs.microsoft.com/en-us/windows/wsl/install-manual" rel="noopener ugc nofollow" target="_blank">单独文件</a>中描述。WSL使用的默认发行版是Ubuntu，我们在本文中也使用它。</p><p id="a909" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">默认情况下，该发行版将通过Microsoft Store安装。但在企业环境中，当您尝试访问商店时，可能会受到限制，例如应用程序或防火墙的限制。在这种情况下，可以使用各自的*通过手动过程安装这些发行版。appx文件。要找到您选择的发行版的下载链接，只需查看一下<a class="ae jp" href="https://docs.microsoft.com/en-us/windows/wsl/install-manual#downloading-distributions" rel="noopener ugc nofollow" target="_blank">Microsoft Docs</a>中的链接集合。Ubuntu 20.04可以通过<a class="ae jp" href="https://aka.ms/wslubuntu2004" rel="noopener ugc nofollow" target="_blank">https://aka.ms/wslubuntu2004</a>下载，下载后从windows主机执行安装appx-package。</p><p id="f279" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">此时，您应该能够通过命令行访问WSL 2系统，例如，通过显示所有已安装发行版的列表:</p><pre class="je jf jg jh fd la lb lc ld aw le bi"><span id="8639" class="lf jy hi lb b fi lg lh l li lj">wsl --list</span></pre><p id="5a98" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Windows终端有一个很好的WSL 2集成，可以直接启动一个实例。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lr"><img src="../Images/9806e81d215057afe667e25c583bdc0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UKMsR0BOY8RjoYFdVK1ijQ.jpeg"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">Windows终端— WSL2集成</figcaption></figure></div><div class="ab cl jq jr gp js" role="separator"><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv"/></div><div class="hb hc hd he hf"><h1 id="08c8" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">配置WSL 2发行版</h1><p id="38a8" class="pw-post-body-paragraph if ig hi ih b ii kv ik il im kw io ip iq kx is it iu ky iw ix iy kz ja jb jc hb bi translated">企业环境中的互联网访问通常由代理服务器和自定义名称服务器管理和限制。为了允许WSL 2实例访问互联网，需要一些特殊的设置。下一节将介绍这些步骤。</p><h2 id="7477" class="lf jy hi bd jz ls lt lu kd lv lw lx kh iq ly lz kl iu ma mb kp iy mc md kt me bi translated">处理公司代理服务器</h2><p id="ee0f" class="pw-post-body-paragraph if ig hi ih b ii kv ik il im kw io ip iq kx is it iu ky iw ix iy kz ja jb jc hb bi translated">代理服务器最常见的设置是由环境变量<em class="lk"> http_proxy </em>和<em class="lk"> https_proxy控制的。</em>由于一些工具使用区分大小写的访问，我们必须使用小写和大写来创建变量。</p><p id="1677" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在下面的例子中，我们使用<code class="du mf mg mh lb b"><a class="ae jp" href="http://server.domain:8080" rel="noopener ugc nofollow" target="_blank">http://server.domain:8080</a></code>作为我们的代理服务器。</p><pre class="je jf jg jh fd la lb lc ld aw le bi"><span id="1b4e" class="lf jy hi lb b fi lg lh l li lj"><em class="lk"># Create or edit the global available environment variables</em><br/>sudo nano /etc/environment</span><span id="8c45" class="lf jy hi lb b fi ll lh l li lj"><em class="lk"># Append the following lines and save/exit the file</em><br/>http_proxy=”<em class="lk">http://server.domain:8080</em>”<br/>HTTP_PROXY=”<em class="lk">http://server.domain:8080</em>”</span><span id="7f5c" class="lf jy hi lb b fi ll lh l li lj">https_proxy=”<em class="lk">http://server.domain:8080</em>”<br/>HTTPS_PROXY=”<em class="lk">http://server.domain:8080</em>”</span></pre><p id="26f6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上述配置确实适合许多情况。但是有些工具和场景需要单独设置。比如，如果你想<a class="ae jp" href="https://docs.microsoft.com/en-us/visualstudio/debugger/debug-dotnet-core-in-wsl-2?view=vs-2019" rel="noopener ugc nofollow" target="_blank">调试。使用Visual Studio的WSL 2中的. NET应用程序</a>。该扩展会自动检查并安装缺少的依赖项。如果没有如下所述的<em class="lk"> wget、</em>的额外设置，使用公司代理时安装将会失败。</p><p id="4be4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">卷曲</strong></p><blockquote class="mi"><p id="8981" class="mj mk hi bd ml mm mn mo mp mq mr jc dx translated">Curl是一个命令行工具，用于传输用url语法指定的数据。(<a class="ae jp" href="https://github.com/curl/curl" rel="noopener ugc nofollow" target="_blank">卷曲/卷曲</a>)</p></blockquote><pre class="ms mt mu mv mw la lb lc ld aw le bi"><span id="bf4f" class="lf jy hi lb b fi lg lh l li lj"><em class="lk"># Edit curl configuration</em><br/>sudo nano ~/.curlrc</span><span id="8b44" class="lf jy hi lb b fi ll lh l li lj"><em class="lk"># Add/append the following line and save/exit the file</em><br/>proxy = <em class="lk">http://server.domain:8080</em></span></pre><p id="e76e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> wget </strong></p><blockquote class="mi"><p id="468b" class="mj mk hi bd ml mm mn mo mp mq mr jc dx translated">wget是一个免费的软件包，用于使用HTTP、HTTPS、FTP和FTPS这些最广泛使用的互联网协议来检索文件。(<a class="ae jp" href="https://www.gnu.org/software/wget/" rel="noopener ugc nofollow" target="_blank"> Wget — GNU项目</a>)</p></blockquote><pre class="ms mt mu mv mw la lb lc ld aw le bi"><span id="68bf" class="lf jy hi lb b fi lg lh l li lj"><em class="lk"># Edit wget configuration</em><br/>sudo nano /etc/wgetrc</span><span id="c3c7" class="lf jy hi lb b fi ll lh l li lj"><em class="lk"># Add/append the following line and save/exit the file</em><br/>https_proxy = <em class="lk">http://server.domain:8080</em><br/>http_proxy = <em class="lk">http://server.domain:8080</em></span><span id="1210" class="lf jy hi lb b fi ll lh l li lj">use_proxy = on</span></pre><p id="37f1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> apt </strong></p><blockquote class="mi"><p id="7fa1" class="mj mk hi bd ml mm mn mo mp mq mr jc dx translated">apt命令是一个命令行工具，它与Ubuntu的<em class="mx">高级打包工具</em> (APT)配合使用，执行安装新软件包、升级现有软件包、更新软件包列表索引，甚至升级整个Ubuntu系统等功能。(<a class="ae jp" href="https://ubuntu.com/server/docs/package-management" rel="noopener ugc nofollow" target="_blank">包管理| Ubuntu </a>)</p></blockquote><pre class="ms mt mu mv mw la lb lc ld aw le bi"><span id="c665" class="lf jy hi lb b fi lg lh l li lj"><em class="lk"># Create apt configuration</em><br/>cd /etc/apt/apt.conf.d</span><span id="d62b" class="lf jy hi lb b fi ll lh l li lj">sudo touch proxy.conf<br/>sudo nano proxy.conf</span><span id="07e1" class="lf jy hi lb b fi ll lh l li lj"><em class="lk"># Add the following line and save/exit the file</em><br/>Acquire::http::Proxy "<em class="lk">http://server.domain:8080</em>";<br/>Acquire::https::Proxy "<em class="lk">http://server.domain:8080</em>";</span></pre><h2 id="9fb8" class="lf jy hi bd jz ls lt lu kd lv lw lx kh iq ly lz kl iu ma mb kp iy mc md kt me bi translated"><strong class="ak">考虑定制域名服务器</strong></h2><p id="48c6" class="pw-post-body-paragraph if ig hi ih b ii kv ik il im kw io ip iq kx is it iu ky iw ix iy kz ja jb jc hb bi translated">企业环境中的另一种常见设置是自定义名称服务器。它们被用来代替公共可用的域名，比如8.8.8.8，它代表谷歌提供的域名服务器。</p><p id="5970" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在某些情况下，默认情况下，WSL 2无法解析匹配的配置。在这种情况下，我们必须修改<em class="lk"> /etc/wsl.conf </em>并手动添加定制服务器。为此，只需遵循以下步骤:</p><ol class=""><li id="b523" class="my mz hi ih b ii ij im in iq na iu nb iy nc jc nd ne nf ng bi translated">禁用自动生成resolv.conf</li></ol><pre class="je jf jg jh fd la lb lc ld aw le bi"><span id="f409" class="lf jy hi lb b fi lg lh l li lj"><em class="lk"># Edit the default </em>WSL <em class="lk">configuration</em><br/>sudo nano /etc/wsl.conf</span><span id="27a5" class="lf jy hi lb b fi ll lh l li lj"><em class="lk"># Add the following lines and save/exit the file</em><br/>[network]<br/>generateResolvConf = false</span></pre><p id="2d14" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.关闭并重新启动WSL 2实例</p><pre class="je jf jg jh fd la lb lc ld aw le bi"><span id="342e" class="lf jy hi lb b fi lg lh l li lj"><em class="lk"># Shutdown running instance</em><br/>wsl --shutdown</span><span id="0d36" class="lf jy hi lb b fi ll lh l li lj"><em class="lk"># Restart and enter a new instance</em><br/>wsl</span></pre><p id="307f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3.使用<em class="lk"> /etc/resolv.conf </em>添加特定的DNS名称服务器</p><pre class="je jf jg jh fd la lb lc ld aw le bi"><span id="c91b" class="lf jy hi lb b fi lg lh l li lj"><em class="lk"># Create/Edit the configuration</em><br/>sudo nano /etc/resolv.conf</span><span id="8d3d" class="lf jy hi lb b fi ll lh l li lj"><em class="lk"># Append the setup using the custom nameservers and save/exit the file</em><br/>nameserver &lt;&lt;ip-address&gt;&gt;<br/>nameserver &lt;&lt;ip-address&gt;&gt;</span></pre><p id="1c83" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在某些情况下，编辑过程中可能会出错。您可以通过使用<code class="du mf mg mh lb b">sudo rm /etc/resolv.conf</code>删除文件来解决这个问题</p><h2 id="ffbc" class="lf jy hi bd jz ls lt lu kd lv lw lx kh iq ly lz kl iu ma mb kp iy mc md kt me bi translated">处理SSL检查</h2><p id="55f8" class="pw-post-body-paragraph if ig hi ih b ii kv ik il im kw io ip iq kx is it iu ky iw ix iy kz ja jb jc hb bi translated">完成代理和名称服务器配置后，可能会有另一个步骤，重点是处理SSL检查所需的设置。</p><blockquote class="mi"><p id="a7fc" class="mj mk hi bd ml mm mn mo mp mq mr jc dx translated">SSL检查通过服务器和用户浏览器创建专用的SSL隧道，允许解密和检查传入和传出的HTTPS流量。</p></blockquote><p id="4004" class="pw-post-body-paragraph if ig hi ih b ii nh ik il im ni io ip iq nj is it iu nk iw ix iy nl ja jb jc hb bi translated">在这种情况下，我们必须将相应的证书添加到WSL 2特定的证书存储中。否则，通过HTTPS的连接将由于SSL错误而被阻止。</p><pre class="je jf jg jh fd la lb lc ld aw le bi"><span id="9521" class="lf jy hi lb b fi lg lh l li lj"><em class="lk"># Create a directory for custom root certificates<br/></em>sudo mkdir /usr/local/share/ca-certificates/extra</span><span id="ff1a" class="lf jy hi lb b fi ll lh l li lj"><em class="lk"># Copy the the certificate from local system to WSL2 file system</em>sudo <br/>sudo cp custom.crt /usr/local/share/ca-certificates/extra/custom.crt</span><span id="8d21" class="lf jy hi lb b fi ll lh l li lj"><em class="lk"># Import the custom</em><em class="lk">.crt file<br/></em>sudo dpkg-reconfigure ca-certificates<br/>sudo update-ca-certificates</span></pre><p id="cd09" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从这一点开始，在公司环境中使用WSL 2所需的所有设置都已设置好。但还是有不好的一面。整个设置仅对本地WSL 2实例有效。但是如果设置应该在同事之间共享呢？欲知详情，请阅读下一节。</p></div><div class="ab cl jq jr gp js" role="separator"><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv"/></div><div class="hb hc hd he hf"><h1 id="a1ab" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">构建自己的WSL 2包</h1><p id="fc85" class="pw-post-body-paragraph if ig hi ih b ii kv ik il im kw io ip iq kx is it iu ky iw ix iy kz ja jb jc hb bi translated">在企业环境中，在全球范围内管理和共享设置和工具是最佳实践。对于WSL 2，目前有两种选择。</p><ul class=""><li id="3104" class="my mz hi ih b ii ij im in iq na iu nb iy nc jc nm ne nf ng bi translated">使用WSL 2命令在内部共享映像</li><li id="cfa5" class="my mz hi ih b ii nn im no iq np iu nq iy nr jc nm ne nf ng bi translated">使用<a class="ae jp" href="https://github.com/microsoft/WSL-DistroLauncher" rel="noopener ugc nofollow" target="_blank"> WSL发行版启动器</a>创建特定于企业的发行版</li></ul><p id="f34f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">其他与安全和控制相关的选项仍在开发中。但是，让我们从共享定制的WSL 2映像这个更简单的选项开始，来讨论一下目前可用的可能性。</p><h2 id="831c" class="lf jy hi bd jz ls lt lu kd lv lw lx kh iq ly lz kl iu ma mb kp iy mc md kt me bi translated">使用文件共享来共享WSL 2映像</h2><pre class="je jf jg jh fd la lb lc ld aw le bi"><span id="dd61" class="lf jy hi lb b fi lg lh l li lj">wsl --export Ubuntu CustomizedUbuntu.tar.gz</span></pre><p id="58e6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">之后，导出的映像可以很容易地导入到同一环境中运行WSL2的其他系统中。</p><pre class="je jf jg jh fd la lb lc ld aw le bi"><span id="dbd4" class="lf jy hi lb b fi lg lh l li lj">wsl --import Ubuntu &lt;&lt;path-to-image&gt;&gt;\CustomizedUbuntu.tar.gz</span></pre><p id="6329" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这就是在不同系统间共享预配置的WSL 2实例所要做的全部工作。</p><h2 id="73d8" class="lf jy hi bd jz ls lt lu kd lv lw lx kh iq ly lz kl iu ma mb kp iy mc md kt me bi translated">创建特定于企业的启动器应用程序</h2><p id="7c6a" class="pw-post-body-paragraph if ig hi ih b ii kv ik il im kw io ip iq kx is it iu ky iw ix iy kz ja jb jc hb bi translated">第二个选项侧重于创建一个定制的启动器包，没有上面提到的第一个选项那么容易。它基于GitHub 上的一个项目模板<a class="ae jp" href="https://github.com/microsoft/WSL-DistroLauncher" rel="noopener ugc nofollow" target="_blank">。接下来的步骤包括最小设置。</a></p><p id="9b65" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">克隆存储库</strong></p><p id="1514" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，您必须克隆存储库。该存储库包含Windows Subsystem for Linux (WSL)分发安装程序/启动器应用程序的C++参考实现。因此，除此之外，您还必须确保Visual Studio的C++工作负载安装在您的系统上。</p><div class="ns nt ez fb nu nv"><a href="https://github.com/microsoft/WSL-DistroLauncher.git" rel="noopener  ugc nofollow" target="_blank"><div class="nw ab dw"><div class="nx ab ny cl cj nz"><h2 class="bd hj fi z dy oa ea eb ob ed ef hh bi translated">GitHub-Microsoft/WSL-DistroLauncher:WSL发行版Microsoft Store的示例/参考启动器应用程序…</h2><div class="oc l"><h3 class="bd b fi z dy oa ea eb ob ed ef dx translated">这是Linux (WSL)发行版安装程序/启动程序的Windows子系统的C++参考实现…</h3></div><div class="od l"><p class="bd b fp z dy oa ea eb ob ed ef dx translated">github.com</p></div></div><div class="oe l"><div class="of l og oh oi oe oj jn nv"/></div></div></a></div><p id="a4cd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">包含导出的发行版</strong></p><p id="4e37" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">将之前导出的WSL 2映像作为<code class="du mf mg mh lb b">install.tar.gz</code>复制到<em class="lk"> DistroLauncher-Appx </em>目录中。</p><p id="631b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">重定目标项目</strong></p><p id="0686" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">根据您的特定系统设置(Visual Studio和Windows SDK版本)，您必须在继续构建包之前重新定位这两个项目。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ok"><img src="../Images/4bbe40efcb761f1574f3652cabae15e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1072/format:webp/1*ODxFfKzpj_7R7D-6ICQuBg.png"/></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">使用Visual Studio重定项目目标</figcaption></figure><p id="0984" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">确保为解决方案中的每个项目执行此步骤。</p><p id="fddf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">添加证书签名包</strong></p><p id="151d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Windows要求对生成的包进行签名。因此，必须将CA可信证书应用于appx项目。因此，您必须打开*.appx.manifest文件并导航到标签名<em class="lk">打包</em>。通过<em class="lk">选择证书，可以应用</em>自定义证书，如下图所示。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ol"><img src="../Images/233e5a0f009a7ec157c2bc597aeb1515.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FKbDcVrzWLhXd3BcdqYZdA.jpeg"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">将自定义证书添加到WSL 2发行版启动器</figcaption></figure><p id="b09e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">考虑到所有需要的步骤现在都已完成，我们可以执行初始构建了。在继续进一步定制之前，我们可以使用这个构建来检查所有设置是否正确。</p><p id="73b0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">构建包</strong></p><p id="3950" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了简化构建过程，创建者在存储库根目录下放置了一个名为<code class="du mf mg mh lb b">build.bat</code>的文件。在执行批处理文件之前，检查<code class="du mf mg mh lb b">build.bat</code>中的MSBuild路径是否有效。根据您的系统设置，您必须扩展这个路径列表。现在执行批处理并等待第一个包。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es om"><img src="../Images/16a11262c2a875d019fdcb8067431b4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1382/format:webp/1*91q73jy6oAVQsH4m0h0f1A.png"/></div></figure><p id="f3a1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最终结果是，现在有了一个定制包，可以在您的环境中分发。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es on"><img src="../Images/6a40f4171796fafb8b9145d76246158c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1304/format:webp/1*Q0WEepxw8JZDoz3P87sj0Q.png"/></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">自定义发行版启动器来分发WSL 2包</figcaption></figure></div><div class="ab cl jq jr gp js" role="separator"><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv"/></div><div class="hb hc hd he hf"><h1 id="b0b4" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">包扎</h1><p id="d762" class="pw-post-body-paragraph if ig hi ih b ii kv ik il im kw io ip iq kx is it iu ky iw ix iy kz ja jb jc hb bi translated">在本文中，我向您介绍了与常见企业环境挑战相关的WSL 2设置的具体设置，以及如何在不同的系统之间分配设置。在此基础上，您现在能够构建自己的WSL 2包来满足您的特定需求，并将其分发给企业内的不同系统。</p></div><div class="ab cl jq jr gp js" role="separator"><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv"/></div><div class="hb hc hd he hf"><h1 id="dde5" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">参考</h1><div class="ns nt ez fb nu nv"><a href="https://docs.microsoft.com/en-us/windows/wsl/install" rel="noopener  ugc nofollow" target="_blank"><div class="nw ab dw"><div class="nx ab ny cl cj nz"><h2 class="bd hj fi z dy oa ea eb ob ed ef hh bi translated">安装WSL</h2><div class="oc l"><h3 class="bd b fi z dy oa ea eb ob ed ef dx translated">您必须运行Windows 10版本2004和更高版本(内部版本19041和更高版本)或Windows 11。如果您正在运行一个…</h3></div><div class="od l"><p class="bd b fp z dy oa ea eb ob ed ef dx translated">docs.microsoft.com</p></div></div><div class="oe l"><div class="oo l og oh oi oe oj jn nv"/></div></div></a></div><div class="ns nt ez fb nu nv"><a href="https://docs.microsoft.com/en-us/windows/wsl/install-manual" rel="noopener  ugc nofollow" target="_blank"><div class="nw ab dw"><div class="nx ab ny cl cj nz"><h2 class="bd hj fi z dy oa ea eb ob ed ef hh bi translated">旧版本WSL的手动安装步骤</h2><div class="oc l"><h3 class="bd b fi z dy oa ea eb ob ed ef dx translated">为了简单起见，我们通常建议使用wsl - install来安装Linux的Windows子系统，但是如果您…</h3></div><div class="od l"><p class="bd b fp z dy oa ea eb ob ed ef dx translated">docs.microsoft.com</p></div></div><div class="oe l"><div class="op l og oh oi oe oj jn nv"/></div></div></a></div><div class="ns nt ez fb nu nv"><a href="https://askubuntu.com/questions/73287/how-do-i-install-a-root-certificate" rel="noopener  ugc nofollow" target="_blank"><div class="nw ab dw"><div class="nx ab ny cl cj nz"><h2 class="bd hj fi z dy oa ea eb ob ed ef hh bi translated">如何安装根证书？</h2><div class="oc l"><h3 class="bd b fi z dy oa ea eb ob ed ef dx translated">感谢贡献回答问Ubuntu！请务必回答问题。提供详细信息并分享您的…</h3></div><div class="od l"><p class="bd b fp z dy oa ea eb ob ed ef dx translated">askubuntu.com</p></div></div><div class="oe l"><div class="oq l og oh oi oe oj jn nv"/></div></div></a></div><div class="ns nt ez fb nu nv"><a href="https://docs.microsoft.com/en-us/windows/wsl/enterprise" rel="noopener  ugc nofollow" target="_blank"><div class="nw ab dw"><div class="nx ab ny cl cj nz"><h2 class="bd hj fi z dy oa ea eb ob ed ef hh bi translated">为您的公司设置Linux的Windows子系统</h2><div class="oc l"><h3 class="bd b fi z dy oa ea eb ob ed ef dx translated">作为管理员或经理，您可能要求所有开发人员使用相同的批准软件。这种一致性…</h3></div><div class="od l"><p class="bd b fp z dy oa ea eb ob ed ef dx translated">docs.microsoft.com</p></div></div><div class="oe l"><div class="or l og oh oi oe oj jn nv"/></div></div></a></div></div></div>    
</body>
</html>