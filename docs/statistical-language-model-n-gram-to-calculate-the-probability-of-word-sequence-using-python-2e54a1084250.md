# ç»Ÿè®¡è¯­è¨€æ¨¡å‹:ä½¿ç”¨ Python è®¡ç®—å•è¯åºåˆ—æ¦‚ç‡çš„ N-gramã€‚

> åŸæ–‡ï¼š<https://medium.com/codex/statistical-language-model-n-gram-to-calculate-the-probability-of-word-sequence-using-python-2e54a1084250?source=collection_archive---------1----------------------->

## N-gram åˆ†æ­¥å®æ–½ç»¼åˆæŒ‡å—ã€‚

![](img/f5131047334d0cb40b5779b7db9cc629.png)

T è¿™ç¯‡æ–‡ç« ä»‹ç»äº† n-gram çš„é€æ­¥ python å®ç°ï¼Œä»¥é¢„æµ‹ç»™å®šæ•°æ®é›†çš„ç»™å®šå¥å­çš„æ¦‚ç‡ã€‚æœ¬æ–‡ä¸»è¦ä»‹ç»äº†è¯­è¨€æ¨¡å‹çš„è§£é‡Š **N å…ƒè¯­æ³•**ï¼Œä»¥åŠå®ƒåœ¨ python ä¸­çš„å®ç°ã€‚å®ç°åˆ†ä¸º 11 ä¸ªæ­¥éª¤ï¼Œæ¯ä¸ªæ­¥éª¤éƒ½æœ‰æè¿°å’Œä»£ç ï¼Œåé¢æ˜¯æ¯ä¸ªä»£ç çš„è¾“å‡ºã€‚

# ç›®å½•

*   [*ä»€ä¹ˆæ˜¯è¯­è¨€æ¨¡å‹ï¼Ÿ*](#ab36)
*   [*ä»€ä¹ˆæ˜¯ç»Ÿè®¡è¯­è¨€å»ºæ¨¡ï¼Ÿ*](#ae2e)
*   [*ä»€ä¹ˆæ˜¯ N-gramï¼Ÿ*](#a14c)
*   [*N-gram åœ¨ python ä¸­çš„å®ç°*](#d1c9)

# ä»€ä¹ˆæ˜¯è¯­è¨€æ¨¡å‹ï¼Ÿ

åœ¨è‡ªç„¶è¯­è¨€å¤„ç†ä¸­ï¼Œè¯­è¨€æ¨¡å‹æ˜¯å­—æ¯åºåˆ—çš„æ¦‚ç‡åˆ†å¸ƒã€‚è¯­è¨€æ¨¡å‹åˆ†ææ–‡æœ¬æ•°æ®æ¥è®¡ç®—å•è¯æ¦‚ç‡ã€‚å®ƒä½¿ç”¨ä¸€ç§ç®—æ³•æ¥è§£é‡Šæ•°æ®ï¼Œè¿™ç§ç®—æ³•ä¸ºè‡ªç„¶è¯­è¨€ä¸­çš„ä¸Šä¸‹æ–‡å»ºç«‹è§„åˆ™ã€‚

> è¯­è¨€å»ºæ¨¡æ˜¯ç¡®å®šå•è¯åºåˆ—æ¦‚ç‡çš„è‰ºæœ¯ã€‚è¿™åœ¨è®¸å¤šé¢†åŸŸéƒ½å¾ˆæœ‰ç”¨ï¼ŒåŒ…æ‹¬è¯­éŸ³è¯†åˆ«ã€å…‰å­¦å­—ç¬¦è¯†åˆ«ã€æ‰‹å†™è¯†åˆ«ã€æœºå™¨ç¿»è¯‘å’Œæ‹¼å†™çº æ­£
> 
> â€”â€”è¯­è¨€å»ºæ¨¡çš„ä¸€ç‚¹è¿›å±•ï¼Œ2001 å¹´

# ä»€ä¹ˆæ˜¯ç»Ÿè®¡è¯­è¨€å»ºæ¨¡(SLM)ï¼Ÿ

ç»Ÿè®¡è¯­è¨€å»ºæ¨¡æ—¨åœ¨åˆ›å»ºä¸€ä¸ªèƒ½å¤Ÿå‡†ç¡®ä¼°è®¡è‡ªç„¶è¯­è¨€åˆ†å¸ƒçš„ç»Ÿè®¡è¯­è¨€æ¨¡å‹ã€‚ç»Ÿè®¡è¯­è¨€æ¨¡å‹(SLM)æ˜¯å­—ç¬¦ä¸² S ä¸Šçš„æ¦‚ç‡åˆ†å¸ƒ P(s ),å®ƒè¯•å›¾åæ˜ å­—ç¬¦ä¸² S ä½œä¸ºçŸ­è¯­å‡ºç°çš„é¢‘ç‡ã€‚

# ä»€ä¹ˆæ˜¯ N-gramï¼Ÿ

N-gram æ˜¯ä¸€ç§ç»Ÿè®¡è¯­è¨€æ¨¡å‹ï¼Œå®ƒä¸ºå¥å­å’Œå•è¯åºåˆ—åˆ†é…æ¦‚ç‡ã€‚è¯åºå¯ä»¥æ˜¯ 2 ä¸ªè¯ã€3 ä¸ªè¯ã€4 ä¸ªè¯ç­‰ã€‚æ¯”å¦‚ n å­—ã€‚n å…ƒè¯­æ³•ä¹Ÿè¢«ç§°ä¸º n ä¸ªå•è¯çš„åºåˆ—ã€‚N-gram è¯­è¨€æ¨¡å‹æ˜¯åŸºäºä¸€ç³»åˆ—å•è¯çš„è®¡æ•°æ¥ç¡®å®šæ¦‚ç‡çš„è¯­è¨€æ¨¡å‹ã€‚æ ¹æ®å­—æ•°ç»Ÿè®¡ï¼ŒN-gram å¯ä»¥æ˜¯:

*   T21:åªæœ‰ä¸€ä¸ªå•è¯çš„åºåˆ—
*   **äºŒå…ƒæ¨¡å‹**:ä¸¤ä¸ªå•è¯çš„åºåˆ—
*   **ä¸‰å…ƒç»„**:ä¸‰ä¸ªå­—çš„åºåˆ—

æˆ‘ä»¬ç”¨ä¸€ä¸ªä¾‹å­æ¥ç†è§£ N-gramã€‚è€ƒè™‘ä¸‹é¢çš„å¥å­:

â€œæ— è®ºä½ èµ°åˆ°å“ªé‡Œï¼Œéƒ½è¦ä¿æŒä¹è§‚â€

1-gram(æˆ– unigram)æ˜¯ä¸€ä¸ªå•è¯åºåˆ—ã€‚å¯¹äºä¸Šé¢çš„å¥å­ï¼Œå•å­—å¯ä»¥ç®€å•åœ°æ˜¯:â€œä¿æŒâ€ã€â€œä¼ æ’­â€ã€â€œç§¯æâ€ã€â€œæ— è®ºä½•å¤„â€ã€â€œä½ â€ã€â€œå»â€ã€‚

ä¸€ä¸ª 2-gram(æˆ– bigram)æ˜¯ä¸¤ä¸ªå•è¯çš„å•è¯åºåˆ—ï¼Œåƒâ€œç»§ç»­ä¼ æ’­â€ï¼Œâ€œä¼ æ’­ç§¯æâ€ï¼Œâ€œæ— è®ºä½•å¤„éƒ½æ˜¯ç§¯æçš„â€ï¼Œâ€œæ— è®ºä½ åœ¨å“ªé‡Œâ€ï¼Œæˆ–â€œä½ å»å“ªé‡Œâ€ã€‚ä¸‰å­—æ ¼(æˆ–ä¸‰å…ƒæ ¼)æ˜¯ç”±ä¸‰ä¸ªå•è¯ç»„æˆçš„å•è¯åºåˆ—ï¼Œå¦‚â€œç»§ç»­ä¼ æ’­ç§¯æâ€ã€â€œåœ¨ä»»ä½•åœ°æ–¹ä¼ æ’­ç§¯æâ€ã€â€œæ— è®ºä½ åœ¨å“ªé‡Œéƒ½ç§¯æâ€æˆ–â€œæ— è®ºä½ å»å“ªé‡Œâ€ã€‚

å½“æˆ‘ä»¬ä½¿ç”¨äºŒå…ƒæ¨¡å‹æ¥é¢„æµ‹ä¸‹ä¸€ä¸ªå•è¯çš„æ¡ä»¶æ¦‚ç‡æ—¶ï¼Œæˆ‘ä»¬å› æ­¤åšå‡ºå¦‚ä¸‹è¿‘ä¼¼:

![](img/35a8354e7b22a04914e664dfc60a94d7.png)

ä¸€ä¸ªè¯çš„æ¦‚ç‡åªå–å†³äºå‰ä¸€ä¸ªè¯çš„å‡è®¾å«åš**é©¬å°”å¯å¤«å‡è®¾ã€‚**

ä¸€ç§ä¼°è®¡æ¦‚ç‡çš„ç›´è§‚æ–¹æ³•å«åšæœ€å¤§ä¼¼ç„¶ä¼°è®¡æˆ– MLEã€‚æˆ‘ä»¬é€šè¿‡ä»è¯­æ–™åº“ä¸­è·å–è®¡æ•°ï¼Œå¹¶å¯¹è®¡æ•°è¿›è¡Œå½’ä¸€åŒ–ï¼Œä½¿å®ƒä»¬ä½äº 0 å’Œ 1 ä¹‹é—´ï¼Œä»è€Œè·å¾— n å…ƒæ¨¡å‹å‚æ•°çš„**æœ€å¤§ä¼¼ç„¶ä¼°è®¡**æˆ– **MLE** ä¼°è®¡ã€‚

![](img/c0f79905732a0b57ac5c682c598bce83.png)

# N å…ƒè¯­æ³•åœ¨ Python ä¸­çš„å®ç°

> æ³¨æ„:æˆ‘å·²ç»æä¾›äº† Python ä»£ç åŠå…¶è¾“å‡ºã€‚åœ¨æ–‡ç« çš„æœ€åï¼Œæ‚¨å¯ä»¥æ‰¾åˆ°å®Œæ•´çš„å…¨é•¿ä»£ç 

## ç¬¬ä¸€æ­¥:æ•°æ®è¯­æ–™åº“

åœ¨è¿™ä¸ªå®ç°ä¸­ï¼Œæˆ‘ä»¬ä»ç”¨æˆ·é‚£é‡Œè·å–è¾“å…¥æ•°æ®ã€‚å¯ä»¥è¾“å…¥ python ä¸­ nltk æ¨¡å—æä¾›çš„æ•°æ®é›†ã€‚

```
d=input("Enter corpus = ")
```

è¾“å‡º:

![](img/f9253087429335e6b5b8d14de0777cdc.png)

## ç¬¬äºŒæ­¥:é¢„å¤„ç†

åœ¨è¿™ä¸€æ­¥ä¸­ï¼Œæ•°æ®è¢«è½¬æ¢æˆå°å†™ï¼Œæ ‡ç‚¹ç¬¦å·(è¿™é‡Œæ˜¯å¥ç‚¹ç¬¦å·)è¢«åˆ é™¤ï¼Œä»¥å»é™¤æ•°æ®ä¸­æ— ç”¨çš„éƒ¨åˆ†æˆ–å¹²æ‰°ã€‚è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ eos æ ‡ç­¾æ¥æ ‡è®°å¥å­çš„å¼€å§‹å’Œç»“æŸã€‚

è¾“å‡º:

![](img/8a1f9484b59a7de56d416ac51d9d3b1d.png)

## æ­¥éª¤ 3:æ ‡è®°åŒ–

é¢„å¤„ç†è¿‡çš„æ•°æ®ç°åœ¨è¢«è½¬æ¢æˆä¸€ç³»åˆ—æ ‡è®°ã€‚è¿™äº›æ ‡è®°æœ‰åŠ©äºç†è§£ä¸Šä¸‹æ–‡æˆ–å¼€å‘ NLP çš„æ¨¡å‹ã€‚

è¾“å‡º:

![](img/30f88389a7e81d7c87cfa534be9fecf3.png)

## æ­¥éª¤ 4:è®¡ç®—ä»¤ç‰Œçš„é¢‘ç‡

åœ¨æ­¤æ­¥éª¤ä¸­ï¼Œå®šä¹‰ä¸€ä¸ªç©ºå­—å…¸æ¥ä¿å­˜æ ‡è®°åŒ–æ•°æ®é›†ä¸­æ¯ä¸ªæ ‡è®°çš„é¢‘ç‡ã€‚è¾“å‡ºå±å¹•æˆªå›¾ä¸­æ˜¾ç¤ºäº†ç»™å®šæ•°æ®é›†ä¸­æ¯ä¸ªæ ‡è®°çš„å‡ºç°é¢‘ç‡ã€‚

è¾“å‡º:

![](img/2e16044fa54a6c35c353b0295b1c891f.png)

## ç¬¬äº”æ­¥:ç”Ÿæˆ n å…ƒè¯­æ³•

æ­¥éª¤ 3 ä¸­ç”Ÿæˆçš„æ ‡è®°ç”¨äºç”Ÿæˆ n å…ƒè¯­æ³•ã€‚è¿™é‡Œï¼Œä»£ç ä¸­çš„ k è¡¨ç¤º n-grams ä¸­çš„ nã€‚åœ¨è¿™ä¸ªå®ç°ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨äºŒå…ƒæ¨¡å‹(k=n=2)æ¥è®¡ç®—ä¸€ä¸ªå¥å­çš„æ¦‚ç‡ã€‚

è¾“å‡º:

![](img/9777db8cb3a515f2aa18c385dbaa5799.png)

## ç¬¬å…­æ­¥:è®¡ç®— n-gram çš„é¢‘ç‡

dct1 æ˜¯åŒ…å«æ­¥éª¤ 5 ä¸­ç”Ÿæˆçš„ n å…ƒè¯­æ³•ä½œä¸ºå…³é”®å­—çš„å­—å…¸ã€‚è®¡ç®—æ•°æ®é›†ä¸­æ¯ä¸ª n å…ƒè¯­æ³•çš„é¢‘ç‡ï¼Œå¹¶å°†å…¶ä½œä¸ºå€¼æ·»åŠ åˆ°å­—å…¸ dct1 ä¸­ç›¸åº”çš„ n å…ƒè¯­æ³•é”®ã€‚åœ¨æ¥ä¸‹æ¥çš„æ­¥éª¤ä¸­ï¼Œå°†éœ€è¦è¿™äº›é¢‘ç‡æ¥è®¡ç®—æ¦‚ç‡ã€‚

è¾“å‡º:

![](img/18cfbd433a35d891b33cee6f667fb3bf.png)

## æ­¥éª¤ 7:æ¦‚ç‡è¡¨/äºŒå…ƒè¡¨

åœ¨è¿™ä¸€æ­¥ä¸­è®¡ç®—æ¯ä¸ª n å…ƒæ–‡æ³•çš„æ¦‚ç‡ï¼Œå¹¶å­˜å‚¨åœ¨çŸ©é˜µä¸­(è¿™é‡Œæ˜¯ l)ã€‚è®¡ç®— n-gram æ¦‚ç‡çš„å…¬å¼å¦‚ä¸‹:

![](img/4ae37aa9a98b5cda204d3ed96941cdba.png)

ä¸¾ä¸ªä¾‹å­ï¼Œ

![](img/dbe63f729d211f5c10135fc4facffaea.png)

ç±»ä¼¼åœ°ï¼Œæ¯ä¸ª n-gram çš„æ¦‚ç‡è¢«è®¡ç®—å¹¶å­˜å‚¨åœ¨æ¦‚ç‡è¡¨ refer è¾“å‡ºå›¾åƒä¸­ã€‚è¿™ä¸ªæ¦‚ç‡è¡¨ç”¨äºè®¡ç®—ç»™å®šå•è¯åºåˆ—çš„æ¦‚ç‡ã€‚

è¾“å‡º:

![](img/753a9498844baceaefe6d0f0002c0409.png)

## æ­¥éª¤ 8:è¾“å…¥æ–‡æœ¬æ£€æŸ¥æ¦‚ç‡

æ‹¿ä¸€å¥è¯æ¥è®¡ç®—å®ƒçš„æ¦‚ç‡ã€‚

```
text = input("Enter Text = \n")
```

![](img/bd4b95f8bf3005c1f1d3457b9f31bee0.png)

## æ­¥éª¤ 9:å¯¹ç»™å®šçš„æ–‡æœ¬é‡å¤æ­¥éª¤ 2- 6

ä½¿ç”¨å‰é¢æ­¥éª¤ä¸­åˆ›å»ºçš„å‡½æ•°å¯¹è¾“å…¥æ–‡æœ¬è¿›è¡Œé¢„å¤„ç†ã€æ ‡è®°åŒ–å¹¶ç”Ÿæˆ n å…ƒè¯­æ³•ã€‚

è¾“å‡º:

![](img/c5180f95b7791a15b2528c9b5b605d01.png)

## æ­¥éª¤ 10:è®¡ç®—äºŒå…ƒæ¨¡å‹æ¦‚ç‡

åœ¨è¿™ä¸€æ­¥ä¸­ï¼Œè®¡ç®—æ¯ä¸ª n å…ƒè¯­æ³•çš„æ¦‚ç‡ï¼Œè¿™å°†åœ¨è¿›ä¸€æ­¥çš„æ­¥éª¤ä¸­ä½¿ç”¨ã€‚

è¾“å‡º:

![](img/76779db9eec9098436ffebedf4bc3037.png)

## æ­¥éª¤ 11:è®¡ç®—å•è¯åºåˆ—çš„æ¦‚ç‡

ä½¿ç”¨**æ¦‚ç‡é“¾è§„åˆ™è®¡ç®—å®Œæ•´å•è¯åºåˆ—çš„æ¦‚ç‡ã€‚**

å°†æ¦‚ç‡é“¾è§„åˆ™åº”ç”¨äºå•è¯ï¼Œæˆ‘ä»¬å¾—åˆ°:

![](img/d58cb4bb5f7acd191758978ce1b7248f.png)

è¿™é‡Œï¼Œè®¡ç®—å¥å­çš„æ¦‚ç‡:

**P("æˆ‘ä¸å–œæ¬¢ç»¿è‰²çš„é¸¡è›‹å’Œç«è…¿")**

= P(I | EOS)* P(do | I)* P(not | do)* P(like | not)* P(green | like)* P(eggs | green)* P(and | eggs)* P(ham | and)* P(EOS | ham)

= 2 * 2 * 1 * 1 * 1 * 1 * 1 * 1 * 1 * 1 * 1 * 1 * 1 * 1

= **0.1665**

è¾“å‡º:

![](img/eeca08bfa6ee1d83d37ad75d8c0f0a5d.png)

æˆ‘çš„ GitHub ä¸Šæä¾›äº†å®Œæ•´çš„å®Œæ•´å®ç°:[minak shee 25/è‡ªç„¶è¯­è¨€å¤„ç†(github.com)](https://github.com/Minakshee25/Natural-Language-Processing)ã€‚

æˆ–è€…è®¿é—®ä»¥ä¸‹ Repl å­˜å‚¨åº“:

[](https://replit.com/join/xnuenbxpml-minaksheenaraya) [## é‚€è¯·åœ¨ Replit ä¸Šåˆä½œ

### ä½¿ç”¨ Replit å¤šäººæ¸¸æˆä¸€èµ·ç¼–ç 

replit.com](https://replit.com/join/xnuenbxpml-minaksheenaraya) 

ä½¿ç”¨è¿™äº› n å…ƒè¯­æ³•å’ŒæŸäº›å•è¯åœ¨æŸäº›åºåˆ—ä¸­å‡ºç°çš„æ¦‚ç‡å¯ä»¥æ”¹è¿›è‡ªåŠ¨è¡¥å…¨ç³»ç»Ÿçš„é¢„æµ‹ã€‚åŒæ ·ï¼Œæˆ‘ä»¬ä½¿ç”¨ can NLP å’Œ n-grams æ¥è®­ç»ƒåŸºäºè¯­éŸ³çš„ä¸ªäººåŠ©ç†æœºå™¨äººã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨ 3-gram æˆ– trigram è®­ç»ƒæ¨¡å‹ï¼Œæœºå™¨äººå°†èƒ½å¤Ÿç†è§£å¥å­ä¹‹é—´çš„å·®å¼‚ï¼Œå¦‚â€œæ¸©åº¦æ˜¯å¤šå°‘ï¼Ÿâ€å’Œâ€œè®¾å®šæ¸©åº¦â€

å¸Œæœ›ä½ è§‰å¾—è¿™ç¯‡ä¸­å‹æ–‡ç« æœ‰ç”¨ï¼åšä¸ªå¥½äººï¼Œå¦‚æœåšå®¢å¯¹ä½ æœ‰å¸®åŠ©ï¼Œå°±ä¸ºå®ƒé¼“æŒå§:-)

å…³æ³¨æˆ‘çš„ç±»ä¼¼æ–‡ç« ï¼

> æ‚¨å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼ä¸æˆ‘è”ç³»:
> 
> é¢†è‹±**ğŸ§‘â€ğŸ’¼:[https://www.linkedin.com/in/minakshee-n-408b1a199/](https://www.linkedin.com/in/minakshee-n-408b1a199/)**

**å¦‚æœä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œè¿™é‡Œæœ‰ä¸€äº›ä½ å¯èƒ½å–œæ¬¢çš„æ–‡ç« :**

[](/@minakshee.narayankar2000/error-free-installation-of-owncloud-server-on-windows-10-within-30-minutes-using-wsl-6450c38b1ae0) [## ä½¿ç”¨ WSL åœ¨ 30 åˆ†é’Ÿå†…å°† Owncloud æœåŠ¡å™¨æ— è¯¯åœ°å®‰è£…åˆ° Windows 10 ä¸Šï¼

### Owncloud æœåŠ¡å™¨çš„å®‰è£…å¾ˆç¹çï¼Œä¸æ˜¯å› ä¸ºæ­¥éª¤å†—é•¿ï¼Œè€Œæ˜¯å› ä¸ºå¤§å¤šæ•°å‘½ä»¤éƒ½ä¸å¤Ÿç”¨â€¦

medium.com](/@minakshee.narayankar2000/error-free-installation-of-owncloud-server-on-windows-10-within-30-minutes-using-wsl-6450c38b1ae0)