# 关于数据库索引的思考

> 原文：<https://medium.com/codex/musings-about-database-indexes-8d8a9a354a79?source=collection_archive---------22----------------------->

而不是“标记”；我昨晚刚刚参加了三字节后端开发测试，这是在评估中。

![](img/4973223319fabc772c2f557d5d5914b6.png)

封面图片由*@ zozulinsky via*[*第 20 期*](https://www.twenty20.com/photos/19f9cccb-0cf3-45c5-af4b-977e22bc4c4f/?utm_t20_channel=bl)

永远不要在深夜进行三字节评估。如果你不在耳机里放大声的音乐，你的注意力就会下降，长时间的困倦会让你的理解力变得迟钝，就像一支没有削尖的 2 号铅笔一样光滑。

尽管如此，我做得并不差。事实上，我还不到后端开发人员的第 50 个百分点。但是我的数据库索引技能需要一些反思。

警告:我承认我不擅长处理数据库，虽然我已经掌握了关系数据库理论和基本类型、行/列/键以及 SQL 命名法，但索引对我来说有点高级，所以我们将在这篇文章中尝试浏览它，希望到那时我们都能掌握它们的要点。

另外，在我们开始之前，我想解释一下为什么它们被称为数据库索引而不是索引。这个话题显然非常令人困惑，甚至纳斯达克也写了一篇关于它的文章。从技术上来说，两者都是正确的，因为它们都是单词“index”的复数形式，但是我看到很多页面都在说 indexes，所以在本文中我们将坚持使用它。

TL；DR:“索引”这个词和任何一个词配对在搜索引擎上都排名靠前。一般来说，它在网络上更普遍，但是我们美国人已经习惯于经常说“索引”这个词，以至于我们在所有的技术文档中都写了它们。叹气。

# 那么……DB 索引到底是什么？

既然命名呼哈已经不存在了，让我们把注意力转向关于这个主题的[维基百科](https://en.wikipedia.org/wiki/Database_index)文章:

> “一个**数据库索引**是一个[数据结构](https://en.wikipedia.org/wiki/Data_structure)，它提高了对一个[数据库表](https://en.wikipedia.org/wiki/Table_(database))的数据检索操作的速度，代价是额外的写入和存储空间来维护索引数据结构。索引用于快速定位数据，而不必在每次访问数据库表时搜索数据库表中的每一行。可以使用数据库表的一个或多个[列创建索引，为快速随机](https://en.wikipedia.org/wiki/Column_(database))[查找](https://en.wikipedia.org/wiki/Lookup)和高效访问有序记录提供基础。”

哇哦。让我们把这分解成细节。我们有*“提高数据检索操作的速度”，*，这意味着**索引加速了查询**。但是怎么做呢？为什么不直接提高查表速度呢？

# 数据库索引是如何工作的？

据我所知，索引将整个列存储在内部结构中，读取速度比数据库表本身更快。您可以使用以下 SQL 语句在索引中存储任何需要的列:

```
CREATE INDEX <index_name>
ON <table_name> (column1, column2, ...)
```

这不是通用的语法，确切的命令可能会因所使用的数据库管理系统而异。

它还允许同时索引多个列，从而有可能加快这些列中的值的读取时间。它就像一个迷你表，只包含那些列，但在第一列`column1`上排序。这种排序特性是使整个索引系统工作的关键部分。DB 已经知道某个特定的主键在哪里，因此能够通过另一个“键”找到其余的被过滤的列就可以快速获取整个(被过滤的)行。

您可能不知道这一点，但是主键[已经存储在索引](https://www.codecademy.com/articles/sql-indexes)中，您没有任何额外的编码。

然而，值得注意的是，虽然索引读起来比表快，但是写起来比表慢。因此，不要在经常用新行或新列值更新的表上创建索引。

现在我们知道了什么时候**不**使用索引，让我们看一个演示其实际用途的类比。

# 书籍索引

栈溢出用户 [Sankarganesh Eswaran](https://stackoverflow.com/users/2629588/sankarganesh-eswaran) 给出了一个索引的绝妙例子:

> 经典例子**“书籍中的索引”**
> 
> 假设一本书有 1000 页，分为 10 个章节，每个章节有 100 页。
> 
> 很简单，是吧？
> 
> 现在，假设您想要查找包含单词“**炼金术士**”的特定章节。如果没有索引页，除了浏览整本书/每一章，你别无选择。即:1000 页。
> 
> 这个类比在数据库界被称为**【全表扫描】**。

![](img/d0c85bcb4c774ae54e6cb1e647c3f0d9.png)

来源:[https://stack overflow . com/questions/1108/how-do-how-do-database-indexing-work](https://stackoverflow.com/questions/1108/how-does-database-indexing-work)

> 但是有了索引页，你就知道去哪里了！此外，要查找任何重要的特定章节，你只需要一次又一次地查看索引页。找到匹配的索引后，你可以跳过其余部分，有效地跳到那一章。
> 
> 但是，除了实际的 1000 页，你还需要另外 10 页来显示索引，所以总共 1010 页。

在数据库的情况下，图书索引可以是一个表，其中条目和页码作为列，其他一些元数据列(例如，它是否是另一个条目的子条目)和 ID 主键。但是条目和页码可以单独存储在索引中。由于图书索引中只有一个唯一的条目，所以它也可以用作索引的排序列。

大多数时候，当人们阅读一个主题时，其中一些往往会停留在他们的脑海中，所以在四个月后的下一次三字节测试中(希望你不是在晚上进行！)，您至少会对什么是数据库索引有一个粗略的概念。