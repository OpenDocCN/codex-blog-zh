<html>
<head>
<title>Localization workflow in iOS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">iOS中的本地化工作流程</h1>
<blockquote>原文：<a href="https://medium.com/codex/localization-workflow-in-ios-9f96b7f4388c?source=collection_archive---------3-----------------------#2021-05-01">https://medium.com/codex/localization-workflow-in-ios-9f96b7f4388c?source=collection_archive---------3-----------------------#2021-05-01</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="63df" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">使用SwiftGen和[短语]</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/a5abc6b0040d31a42b4f018f73f9e9ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iA-QP-N18oO-0Vn63I0Gcw.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">照片由<a class="ae jn" href="https://unsplash.com/@lajaxx?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">杰奎琳·布兰德韦恩</a>在<a class="ae jn" href="https://unsplash.com/s/photos/languages?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</figcaption></figure></div><div class="ab cl jo jp gp jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="hb hc hd he hf"><p id="626c" class="pw-post-body-paragraph jv jw hi jx b jy jz ij ka kb kc im kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi kr translated">在本文中，我将向您展示我最喜欢的一个用于iOS应用程序的本地化流程。您可能已经知道，本地化是几乎每个iOS应用程序的重要组成部分，但不幸的是，它通常被推迟到后期阶段，有时为时已晚，因此非常昂贵且难以重构。有了我将要详述的这个流程(以及互联网上的许多其他流程)，就有可能很容易地隔离在本地化方面发生的事情(拉字符串、生成常量文件等等)，并且还使维护更顺利，更容易出错。事不宜迟，我们开始吧。</p></div><div class="ab cl jo jp gp jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="hb hc hd he hf"><h2 id="275d" class="la lb hi bd lc ld le lf lg lh li lj lk ke ll lm ln ki lo lp lq km lr ls lt lu bi translated">设置项目</h2><p id="a80b" class="pw-post-body-paragraph jv jw hi jx b jy lv ij ka kb lw im kd ke lx kg kh ki ly kk kl km lz ko kp kq hb bi translated">[ <em class="ma">如果您已经知道如何本地化iOS项目</em>，请跳到下一步]</p><p id="dfea" class="pw-post-body-paragraph jv jw hi jx b jy jz ij ka kb kc im kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">首先，让我们创建一个新的Xcode项目，并启用base，为此，打开。xcodeproj文件，选择项目并在选项卡Info下选择Use Base Internationalization。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mb"><img src="../Images/1582c3d4f0720384bef33319b794ee18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-7mhFxinbE3HVWzcpkttnw.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">在Xcode项目中启用基本国际化。</figcaption></figure><p id="5c31" class="pw-post-body-paragraph jv jw hi jx b jy jz ij ka kb kc im kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">我们现在可以添加我们想要本地化应用程序的语言。在同一个项目设置中，转到本地化，单击加号按钮并从下拉列表中选择语言。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mc"><img src="../Images/0bd5e3ae1b25c2634a8404808abc52d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-e5zvMjSxkU1uHtn3BWiuA.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">向项目本地化设置中添加语言。</figcaption></figure><p id="0598" class="pw-post-body-paragraph jv jw hi jx b jy jz ij ka kb kc im kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">为了完成项目的基本设置，我们需要添加一个字符串文件，对于本文，我将它命名为<code class="du md me mf mg b">Localizable.strings</code>，它将位于<code class="du md me mf mg b">Resources &gt; Localization &gt; Localizable.strings</code></p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mh"><img src="../Images/2c15f50229b5ed3eb5d50371d0973ffc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T7E7MXzVhet8-dFAwv85Nw.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">Localizable.strings文件位置。</figcaption></figure><p id="3ebc" class="pw-post-body-paragraph jv jw hi jx b jy jz ij ka kb kc im kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">要将我们的Localizable.strings文件实际本地化为之前添加的所有语言，请单击<code class="du md me mf mg b">file &gt; Localize…</code>,当提示出现时，选择所需的语言。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mi"><img src="../Images/14a7fd222cafc135207c280cf6cb814d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YfOK5hjZfIoxTczsK1Ok4A.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">本地化Localizable.strings文件。</figcaption></figure><p id="58a9" class="pw-post-body-paragraph jv jw hi jx b jy jz ij ka kb kc im kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">现在，为了本教程，让我们手动添加一些字符串到我们的Localizable.strings文件，在本文的后面，我们将通过使用<code class="du md me mf mg b">Phrase</code>和一个漂亮的脚本来改进它。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mj"><img src="../Images/aa5d85bf5a1944df31075d72341e20ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SRblG6suHAaO9-kRuYJeHw.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">添加带占位符和不带占位符的本地化字符串。</figcaption></figure></div><div class="ab cl jo jp gp jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="hb hc hd he hf"><h2 id="2c3b" class="la lb hi bd lc ld le lf lg lh li lj lk ke ll lm ln ki lo lp lq km lr ls lt lu bi translated">聚合目标+脚本阶段</h2><p id="6bcb" class="pw-post-body-paragraph jv jw hi jx b jy lv ij ka kb lw im kd ke lx kg kh ki ly kk kl km lz ko kp kq hb bi translated">一旦启用了语言并将可本地化的文件添加到我们的项目中，让我们添加一个称为聚合目标的东西，它将允许我们添加构建阶段脚本(和许多其他东西),使其与主目标分开，主目标通常会增长得非常快。</p><ul class=""><li id="7ac0" class="mk ml hi jx b jy jz kb kc ke mm ki mn km mo kq mp mq mr ms bi translated">转到项目文件。</li><li id="d6ba" class="mk ml hi jx b jy mt kb mu ke mv ki mw km mx kq mp mq mr ms bi translated">单击加号按钮添加新目标。</li><li id="8b57" class="mk ml hi jx b jy mt kb mu ke mv ki mw km mx kq mp mq mr ms bi translated">在“其他”选项卡下，选择“聚合”。</li><li id="8992" class="mk ml hi jx b jy mt kb mu ke mv ki mw km mx kq mp mq mr ms bi translated">命名目标本地化。</li></ul><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es my"><img src="../Images/9b0b179867105c6209291b297d037d9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jRqYU_zIN-pCzHMhEIgKuQ.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">从项目设置中添加新目标。</figcaption></figure><p id="416f" class="pw-post-body-paragraph jv jw hi jx b jy jz ij ka kb kc im kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">现在，我们可以向之前创建的聚合目标添加一个运行脚本。</p><ul class=""><li id="e4b7" class="mk ml hi jx b jy jz kb kc ke mm ki mn km mo kq mp mq mr ms bi translated">转到项目设置。</li><li id="e2c5" class="mk ml hi jx b jy mt kb mu ke mv ki mw km mx kq mp mq mr ms bi translated">选择本地化聚集目标。</li><li id="6f0a" class="mk ml hi jx b jy mt kb mu ke mv ki mw km mx kq mp mq mr ms bi translated">选择“构建阶段”选项卡。</li><li id="39af" class="mk ml hi jx b jy mt kb mu ke mv ki mw km mx kq mp mq mr ms bi translated">添加新的运行脚本阶段。</li><li id="1ad0" class="mk ml hi jx b jy mt kb mu ke mv ki mw km mx kq mp mq mr ms bi translated">添加以下bash代码。</li></ul><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mz na l"/></div></figure><p id="8df0" class="pw-post-body-paragraph jv jw hi jx b jy jz ij ka kb kc im kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">根据<code class="du md me mf mg b">SwiftGen</code>文档，我们可能需要向项目添加一个配置文件(swiftgen-localization.yml ),我们将在其中指定Localizable.strings文件的路径，以及生成的常量文件<code class="du md me mf mg b">L10n.swift</code>的路径</p><pre class="iy iz ja jb fd nb mg nc nd aw ne bi"><span id="d933" class="la lb hi mg b fi nf ng l nh ni">strings:<br/>  inputs: ../Localization/en.lproj/Localizable.strings<br/>  outputs:<br/>    - templateName: structured-swift5<br/>      output: ../Localization/L10n.swift</span></pre><h2 id="bc9c" class="la lb hi bd lc ld le lf lg lh li lj lk ke ll lm ln ki lo lp lq km lr ls lt lu bi translated">是时候建立目标了</h2><p id="9227" class="pw-post-body-paragraph jv jw hi jx b jy lv ij ka kb lw im kd ke lx kg kh ki ly kk kl km lz ko kp kq hb bi translated">编译聚合目标时可能出现的错误可能是文件路径不正确(这种情况我经常遇到)或者SwiftGen没有正确安装在您的计算机上——假设聚合目标已经正确编译，让我们选择主目标并编译它。因为我们还没有对它做任何事情，它不应该显示任何错误。最后，我们可以将L10n.swift文件添加到项目中，这样SwiftGen生成的常量文件对我们的整个项目都是可见的。</p><p id="731f" class="pw-post-body-paragraph jv jw hi jx b jy jz ij ka kb kc im kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">这是一个如何使用<code class="du md me mf mg b">L10n</code>常量文件的快速示例，它根本不是火箭科学，字符串被转换成静态变量，蛇的大小写被转换成骆驼的大小写，字符串占位符如<code class="du md me mf mg b">%s, %d</code>等。被方便地转换成函数中的参数，如下面的代码片段所示。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mz na l"/></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">使用我们创建的L10n.swift常量文件的视图模型。</figcaption></figure></div><div class="ab cl jo jp gp jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="hb hc hd he hf"><h2 id="d705" class="la lb hi bd lc ld le lf lg lh li lj lk ke ll lm ln ki lo lp lq km lr ls lt lu bi translated">用短语管理字符串</h2><p id="0697" class="pw-post-body-paragraph jv jw hi jx b jy lv ij ka kb lw im kd ke lx kg kh ki ly kk kl km lz ko kp kq hb bi translated">为了完成本地化流程，我们需要用实际的字符串填充Localizable.strings文件。在这一步，我使用短语[2],因为它是我作为iOS开发人员使用最多的一个，但是它可以很容易地被任何其他工具所替代，这些工具提供CLI(命令行界面)、curl请求或者只是编写一个脚本来将<code class="du md me mf mg b">.csv</code>转换为<code class="du md me mf mg b">.strings</code>文件。然而，根据我在这个领域的经验，对于与翻译者和设计者工具的协作，短语提供了一个很好的工具。也就是说，这些是我在iOS项目中实现phrase的常规步骤。</p><ul class=""><li id="d309" class="mk ml hi jx b jy jz kb kc ke mm ki mn km mo kq mp mq mr ms bi translated">创建一个短语帐户并创建一个项目。</li><li id="8b78" class="mk ml hi jx b jy mt kb mu ke mv ki mw km mx kq mp mq mr ms bi translated">向项目中添加区域设置和字符串。</li><li id="6a2c" class="mk ml hi jx b jy mt kb mu ke mv ki mw km mx kq mp mq mr ms bi translated">创建一个API令牌从客户端获取短语。</li><li id="de71" class="mk ml hi jx b jy mt kb mu ke mv ki mw km mx kq mp mq mr ms bi translated">在您的计算机上安装短语CLI。</li><li id="4f1f" class="mk ml hi jx b jy mt kb mu ke mv ki mw km mx kq mp mq mr ms bi translated">确保您从网站上复制了<code class="du md me mf mg b">locale_id’s, project_id, and API token</code>并将其粘贴到配置<code class="du md me mf mg b">.yml</code>文件中。(更多详情见<a class="ae jn" href="https://help.phrase.com/help/configuration" rel="noopener ugc nofollow" target="_blank">短语文档</a>)。</li><li id="6a80" class="mk ml hi jx b jy mt kb mu ke mv ki mw km mx kq mp mq mr ms bi translated"><strong class="jx hj">【重要】</strong>向聚合目标添加一个新的运行脚本阶段，就在我们之前创建的阶段之前，并添加行短语pull。</li></ul><p id="9e5b" class="pw-post-body-paragraph jv jw hi jx b jy jz ij ka kb kc im kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">再说一次，Phrase只是一个工具，它为我作为开发人员提供了良好的体验，但对你来说不一定是一样的。如果你的项目比较小，你只想使用电子表格，你可以下载<code class="du md me mf mg b">.csv</code>文件并使用<code class="du md me mf mg b">csv2strings</code>转换工具，或者你甚至可以使用开源翻译工具，这应该不会有太大的区别。</p><blockquote class="nj nk nl"><p id="2c64" class="jv jw ma jx b jy jz ij ka kb kc im kd nm kf kg kh nn kj kk kl no kn ko kp kq hb bi translated">它总是根据您想要使用的工具和您想要实现它的方式而变化，但是不要让它支配您的项目的行为。</p></blockquote></div><div class="ab cl jo jp gp jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="hb hc hd he hf"><h2 id="05a9" class="la lb hi bd lc ld le lf lg lh li lj lk ke ll lm ln ki lo lp lq km lr ls lt lu bi translated">进一步阅读</h2><ul class=""><li id="d4d1" class="mk ml hi jx b jy lv kb lw ke np ki nq km nr kq mp mq mr ms bi translated">[1] <a class="ae jn" href="https://github.com/SwiftGen/SwiftGen" rel="noopener ugc nofollow" target="_blank"> SwiftGen </a></li><li id="aa6a" class="mk ml hi jx b jy mt kb mu ke mv ki mw km mx kq mp mq mr ms bi translated">【2】<a class="ae jn" href="https://phrase.com" rel="noopener ugc nofollow" target="_blank">短语</a></li><li id="7c8c" class="mk ml hi jx b jy mt kb mu ke mv ki mw km mx kq mp mq mr ms bi translated"><a class="ae jn" rel="noopener" href="/lean-localization/ios-localization-tutorial-938231f9f881?source=collection_home---6------0-----------------------"> iOS基础本地化</a></li><li id="c3d3" class="mk ml hi jx b jy mt kb mu ke mv ki mw km mx kq mp mq mr ms bi translated"><a class="ae jn" href="https://www.w3.org/International/questions/qa-i18n" rel="noopener ugc nofollow" target="_blank">本地化与国际化</a></li><li id="e587" class="mk ml hi jx b jy mt kb mu ke mv ki mw km mx kq mp mq mr ms bi translated"><a class="ae jn" href="https://www.linkedin.com/pulse/difference-between-g11n-i18n-t9n-l10n-satish-singh/" rel="noopener ugc nofollow" target="_blank">G11N、I18N、T9N和L10N的区别</a></li></ul></div><div class="ab cl jo jp gp jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="hb hc hd he hf"><p id="e1d8" class="pw-post-body-paragraph jv jw hi jx b jy jz ij ka kb kc im kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated"><em class="ma">感谢阅读。我希望你喜欢这个小教程，如果它对你有用，不要害羞👏关于这篇文章。下次见。</em></p></div></div>    
</body>
</html>