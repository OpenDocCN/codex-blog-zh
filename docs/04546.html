<html>
<head>
<title>From react-i18next to Transifex Native: Migration Guide</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从react-i18到Transifex Native:迁移指南</h1>
<blockquote>原文：<a href="https://medium.com/codex/from-react-i18next-to-transifex-native-migration-guide-3860e96ae8d3?source=collection_archive---------5-----------------------#2021-12-11">https://medium.com/codex/from-react-i18next-to-transifex-native-migration-guide-3860e96ae8d3?source=collection_archive---------5-----------------------#2021-12-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/113ad6bf7b71efde552d925e1eabad2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*33Is0NHVtq0crI61.png"/></div></div></figure><p id="f837" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果您已经使用React-i18将React应用程序<a class="ae jo" href="https://www.transifex.com/blog/2021/what-is-internationalization-i18n-in-software/" rel="noopener ugc nofollow" target="_blank">国际化(i18n) </a>接下来，您很可能会想“为什么要这么麻烦”？如果它玩起来很流畅，那么为什么要换成新的呢？</p><p id="47f1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">首先，当我们谈论React应用程序时，我们可能谈论的是一直在发展的应用程序。新功能不断增加，现有功能不断变化。</p><p id="608e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这意味着您的<a class="ae jo" href="https://www.transifex.com/blog/2021/what-is-localization/" rel="noopener ugc nofollow" target="_blank">本地化</a>框架在维护模式下需要是可承受的，应用小的改变，在整个代码库中传播。从维护的角度来看，Transifex Native React SDK提供了以下优势:</p><ul class=""><li id="8f97" class="jp jq hi is b it iu ix iy jb jr jf js jj jt jn ju jv jw jx bi translated"><strong class="is hj">文件管理减少到零</strong>，因为不需要额外的文件来保存翻译。不需要额外的管理来发送内容进行翻译，并在准备就绪后解析回您的应用程序。或者在需要翻译的字符串中引入新结构时调整自动化。</li><li id="ea19" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx bi translated"><strong class="is hj">将代码从内容、源&amp;翻译</strong>中分离出来，提供更大的灵活性来应用对翻译甚至原始语言文案的更改，而无需您参与额外的部署&amp;发布。</li></ul><p id="085f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">通过Transifex Native React SDK，您还可以获得:</p><ul class=""><li id="ebf9" class="jp jq hi is b it iu ix iy jb jr jf js jj jt jn ju jv jw jx bi translated"><strong class="is hj">更简单的初始化</strong>，通过安装所需的库并将它们包含在您的代码中。</li><li id="c87e" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx bi translated"><strong class="is hj">通用语法</strong>，具有专为本地化需求构建的ICU支持。</li><li id="021f" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx bi translated"><strong class="is hj">与其他web和移动应用程序配合良好</strong>，因为有了Transifex Native，您可以在应用程序和技术之间使用完全相同的内容。</li></ul><p id="ad57" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这种方法的好处是什么？</p><h1 id="7761" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">如何迁移</h1><p id="2b99" class="pw-post-body-paragraph iq ir hi is b it lb iv iw ix lc iz ja jb ld jd je jf le jh ji jj lf jl jm jn hb bi translated">遵循完整的指南来帮助您将react-i18next本地化迁移到<a class="ae jo" href="https://docs.transifex.com/javascript-sdk/localize-react-applications" rel="noopener ugc nofollow" target="_blank">transi fex Native React SDK</a>。</p><h1 id="1ab0" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">初始化的变化</h1><p id="f4c1" class="pw-post-body-paragraph iq ir hi is b it lb iv iw ix lc iz ja jb ld jd je jf le jh ji jj lf jl jm jn hb bi translated">这两种框架都要求你初始化一个全局对象，作为应用程序和本地化能力之间的“网关”。在react-i18next中，它看起来像这样:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="310b" class="lp ke hi ll b fi lq lr l ls lt">import i18n from "i18next";<br/>import { initReactI18next } from "react-i18next";</span><span id="2ec8" class="lp ke hi ll b fi lu lr l ls lt">const resources = {<br/>  en: {<br/>    translation: {<br/>  	'Hello world': 'Hello world',<br/>    },<br/>  },<br/>  el: {<br/>    translation: {<br/>  	'Hello world': 'Καλημέρα κόσμε',<br/>    },<br/>  },<br/>};</span><span id="4abc" class="lp ke hi ll b fi lu lr l ls lt">i18n<br/>  .use(initReactI18next)<br/>  .init({<br/>    resources,<br/>    lng: 'en',<br/>    interpolation: { escapeValue: false },<br/>  });</span></pre><p id="90bf" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这个片段并没有讲述整个故事。翻译的内容(“资源”字段)可以来自各种来源，也可以在初始化后添加。“init”方法还接受更多的参数，并允许您在很大程度上定制体验。</p><p id="d010" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">当迁移到Transifex Native时，您会失去一些灵活性，因为您内容的真实来源始终是在<a class="ae jo" href="https://docs.transifex.com/transifex-native-sdk-overview/hosting-translations" rel="noopener ugc nofollow" target="_blank"> Transifex Native内容交付服务</a>上的内容，作为回报，您最终会得到更简单的内容:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="2f05" class="lp ke hi ll b fi lq lr l ls lt">import { tx } from '@transifex/native';</span><span id="cace" class="lp ke hi ll b fi lu lr l ls lt">tx.init({<br/>  token: '...',<br/>});</span></pre><p id="719d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Transifex Native中还有其他初始化选项，允许您:</p><ol class=""><li id="e4ce" class="jp jq hi is b it iu ix iy jb jr jf js jj jt jn lv jv jw jx bi translated">使用“过滤标签”字段限制您将从Transifex接收的内容</li><li id="8ddb" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn lv jv jw jx bi translated">当“missingPolicy”字段缺少翻译时该怎么办</li><li id="f9e5" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn lv jv jw jx bi translated">当翻译无法通过“错误策略”字段呈现时(例如，由于译者犯了格式错误),该怎么办</li></ol><h1 id="91b2" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">准备代码</h1><p id="2be3" class="pw-post-body-paragraph iq ir hi is b it lb iv iw ix lc iz ja jb ld jd je jf le jh ji jj lf jl jm jn hb bi translated">为了尽量减少不便，您应该用Transifex本机的' t '函数替换react-i18next的' t '函数的调用。</p><p id="93b0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">出发地:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="7568" class="lp ke hi ll b fi lq lr l ls lt">import { useTranslation } from 'react-i18next';</span><span id="85dc" class="lp ke hi ll b fi lu lr l ls lt">function Paragraph() {<br/>  const { t } = useTranslation();<br/>  return &lt;p&gt;{t('Some text')}&lt;/p&gt;;<br/>}</span></pre><p id="ef7f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">到</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="2d9b" class="lp ke hi ll b fi lq lr l ls lt">import { useT } from '@transifex/react';</span><span id="d385" class="lp ke hi ll b fi lu lr l ls lt">function Paragraph() {<br/>  const t = useT();<br/>  return &lt;p&gt;{t('Some text')}&lt;/p&gt;;<br/>}</span></pre><p id="5bc5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">但是，最好使用T型组件:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="15c4" class="lp ke hi ll b fi lq lr l ls lt">import { T} from '@transifex/react';</span><span id="f4ac" class="lp ke hi ll b fi lu lr l ls lt">function Paragraph() {<br/>  return &lt;p&gt;&lt;T _str="Some text" /&gt;&lt;/p&gt;;<br/>}</span></pre><p id="cc45" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">简单的变量插值是用单花括号而不是双花括号完成的。</p><p id="9bcd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">出发地:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="5073" class="lp ke hi ll b fi lq lr l ls lt">import { useTranslation } from 'react-i18next';</span><span id="d554" class="lp ke hi ll b fi lu lr l ls lt">function Paragraph() {<br/>  const { t } = useTranslation();<br/>  return &lt;p&gt;{t('Hello {{username}}', { username: 'Bob' })}&lt;/p&gt;;<br/>}</span></pre><p id="8df9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">收件人:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="5bc1" class="lp ke hi ll b fi lq lr l ls lt">import { T } from '@transifex/react';</span><span id="ca9c" class="lp ke hi ll b fi lu lr l ls lt">function Paragraph() {<br/>  return &lt;p&gt;&lt;T _str="Hello {username}" username="Bob" /&gt;&lt;/p&gt;;<br/>}</span></pre><p id="a36c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对于格式化的内容，你最好用<ut/>替换<trans>。</trans></p><p id="755f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">出发地:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="cd03" class="lp ke hi ll b fi lq lr l ls lt">import { useTranslation, Trans } from 'react-i18next';</span><span id="79f8" class="lp ke hi ll b fi lu lr l ls lt">function Paragraph() {<br/>  const { t } = useTranslation();<br/>  return (<br/>    &lt;Trans t={t}&gt;<br/>  	&lt;p&gt;Some &lt;strong&gt;bold&lt;/strong&gt; text&lt;/p&gt;<br/>    &lt;/Trans&gt;<br/>  );<br/>}</span></pre><p id="e57b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">收件人:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="8e0b" class="lp ke hi ll b fi lq lr l ls lt">import { UT } from '@transifex/react';</span><span id="746d" class="lp ke hi ll b fi lu lr l ls lt">function Paragraph() {<br/>  return &lt;UT _str="&lt;p&gt;Some &lt;strong&gt;bold&lt;/strong&gt; text&lt;/p&gt;" /&gt;;<br/>}</span></pre><h1 id="2732" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">迁移翻译的内容</h1><p id="39cf" class="pw-post-body-paragraph iq ir hi is b it lb iv iw ix lc iz ja jb ld jd je jf le jh ji jj lf jl jm jn hb bi translated">首先，你需要上传你目前的翻译到transifex.com的一个基于文件的项目。在创建了基于<a class="ae jo" href="https://docs.transifex.com/getting-started-as-a-localization-manager/1-set-up-your-projects#create-a-project" rel="noopener ugc nofollow" target="_blank">文件的项目</a>之后，您可以使用transifex-client来帮助上传资源(每个资源一个名称空间):</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="47c1" class="lp ke hi ll b fi lq lr l ls lt"># Install the client<br/>wget https://github.com/transifex/cli/releases/download/v0.3.0/tx-linux-amd64.tar.gz<br/>tar xf tx-linux-amd64.tar.gz tx<br/>rm tx-linux-amd64.tar.gz<br/>mv tx ~/bin</span><span id="8d0d" class="lp ke hi ll b fi lu lr l ls lt"># Set up the mapping to transifex.com<br/>tx init<br/>tx add \<br/>  --organization=... \<br/>  --project=... \<br/>  --resource=translations \<br/>  --file-filter=locales/translations/&lt;lang&gt;.json \<br/>  --type=KEYVALUEJSON \<br/>  locales/translations/en.json<br/>tx add \<br/>  --organization=... \<br/>  --project=... \<br/>  --resource=helpdesk \<br/>  --file-filter=locales/helpdesk/&lt;lang&gt;.json \<br/>  --type=KEYVALUEJSON \<br/>  locales/helpdesk/en.json</span><span id="cb6d" class="lp ke hi ll b fi lu lr l ls lt"># Push the content to transifex<br/>tx push --source --translation --all</span></pre><p id="75ca" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">接下来，您需要<a class="ae jo" href="https://docs.transifex.com/transifex-native-sdk-overview/managing-a-transifex-native-project#create-a-native-project" rel="noopener ugc nofollow" target="_blank">创建一个本地项目</a>。确保您为以后保留了公共和秘密令牌。</p><p id="087e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在将内容推送到新项目之前，您需要:</p><ol class=""><li id="2f70" class="jp jq hi is b it iu ix iy jb jr jf js jj jt jn lv jv jw jx bi translated">将目标语言添加到新项目中</li><li id="3ad6" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn lv jv jw jx bi translated">将两个项目添加到同一个翻译记忆组(TM组)。一个翻译团队在项目间共享翻译知识，并且可以自动填充项目间相似字符串的翻译。</li></ol><p id="9e33" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，在您的本地项目中，使用提取cli将内容推送到transifex.com的本地项目(使用标签作为命名空间，<a class="ae jo" href="https://docs.google.com/document/d/1CxbC17QG2FWFhrbzc9aBooWx4LZBXVTeCUv9KmCJhkg/edit#heading=h.mbdudj7zfut8" rel="noopener ugc nofollow" target="_blank">参见此处</a>):</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="c5e9" class="lp ke hi ll b fi lq lr l ls lt">npm install --save-dev @transifex/cli<br/>npx txjs-cli push --token=... --secret=... src</span></pre><p id="651d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因为我们将两个项目放在同一个TM组中，所以将使用现有的翻译来填充新的。</p><p id="32a3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果您在迁移代码时必须对一些字符串进行微小的修改，那么可以在编辑器中进行填充。即使它们没有被自动填充，部分TM匹配也会作为建议显示在Transifex编辑器中，并使这项工作变得容易。</p><p id="6767" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最后，确保在应用程序启动时初始化“tx”对象，这样就可以开始了！</p><p id="6b89" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一旦一切就绪并开始运行，您就可以删除旧的基于文件的项目并保留新的Transifex Native React项目。</p><p id="d9a6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在您的应用程序已经完全迁移了。您可以使用Transifex Native继续所有即将到来的开发！</p><figure class="lg lh li lj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/01d3f5840cc8227f042390743e115527.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*qlKDRe2dZJENBdkp.png"/></div></div></figure><p id="102b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">想和你的开发伙伴分享一个快速反应本地化指南吗？你可以在这里下载PDF！</p><p id="623b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae jo" href="https://www.transifex.com/blog/2021/from-react-i18next-to-transifex-native-migration-guide/" rel="noopener ugc nofollow" target="_blank">这个帖子最初发布在这个页面</a>。</p></div></div>    
</body>
</html>