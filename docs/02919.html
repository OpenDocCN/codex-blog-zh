<html>
<head>
<title>Controlling your Fire TV with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python控制你的消防电视</h1>
<blockquote>原文：<a href="https://medium.com/codex/controlling-you-fire-tv-with-python-d5e102669066?source=collection_archive---------8-----------------------#2021-08-11">https://medium.com/codex/controlling-you-fire-tv-with-python-d5e102669066?source=collection_archive---------8-----------------------#2021-08-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/fa0974635060ef4ad6e288e56556b0bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ZbjZYXIxfzwAFVyJ"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">格伦·卡斯滕斯-彼得斯在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="6805" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">对于那些喜欢在任何设备上简单地使用python代码控制家中事物的人来说，这应该会让你感兴趣。我个人喜欢所有的智能家居设备，让一切自动化，房子里的遥控器越少越好。因此，在这篇文章中，我将向您展示我如何使用python向我的Fire TV发送与遥控器相同的消息。</p><p id="9c35" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">整个过程依赖于ADB (Android Debug Bridge)调试功能，这在许多Android设备上都可用。在这种情况下，它将允许我们使用python的键码向fire-stick发送信号。</p></div><div class="ab cl jt ju gp jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="hb hc hd he hf"><p id="cae9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因此，作为开始，我们总是需要这个小项目的所有正确的库。</p><figure class="kb kc kd ke fd ij er es paragraph-image"><div class="er es ka"><img src="../Images/5035ad5cb85f72b7ee275be2eed11829.png" data-original-src="https://miro.medium.com/v2/resize:fit:1090/format:webp/1*fEiOSrpdNCfTLFiqSb-cSQ.jpeg"/></div></figure><p id="c9cc" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">缺省情况下，OS库应该是可用的，但是在对adb-shell进行pip安装后，可以访问其他三个包。</p><p id="f673" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们想从创建一个带有初始化函数的fire-stick控制器类开始，如下所示:</p><figure class="kb kc kd ke fd ij er es paragraph-image"><div class="er es kf"><img src="../Images/9106a1429ec322caa27fc769ebe9b8dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:722/format:webp/1*igKfQxWyeX35RH6xE9JYaQ.jpeg"/></div></figure><p id="d50a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">连接到fire-stick需要一个公钥和私钥，这就是包“keygen”派上用场的地方。所以在我们的初始化函数中，我们想首先检查一个键是否已经存在，如果不存在，我们将创建一个新的。这是通过使用if语句来完成的，以检查该文件是否与python文件在同一个目录中，如果不是，将使用“keygen”方法创建一个新的目录。凭证文件需要打开并读入python，然后使用我们导入的函数‘python rsasigner’进行加密，代码现在如下所示:</p><figure class="kb kc kd ke fd ij er es paragraph-image"><div class="er es kg"><img src="../Images/9e41861f0ae80790d269deb1d811063f.png" data-original-src="https://miro.medium.com/v2/resize:fit:816/format:webp/1*ZS3c8dcw7Da4LG9K9F-SGw.jpeg"/></div></figure><p id="2057" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在“init”函数中添加一些“print”函数是很有帮助的，这样可以清楚地知道在运行它时遵循了哪些步骤。</p><p id="9cd4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">下一步是创建到我们的荧光棒的连接。为此，我们将添加一个名为“addDevice”的新方法，它将从“init”函数继承，并接受一个附加参数，即fire-stick的IP地址。这很容易在您的fire TV上找到，请访问:</p><p id="ab86" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">设置→我的Fire TV →关于→网络</p><p id="9cdc" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在屏幕的右边，你可以找到IP地址，并把它作为变量保存在你的代码中。请记住，除非您在您的家庭网络上设置了静态IPV4地址，否则这可能会不时发生变化。</p><p id="9e55" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">所以在我们的新方法中，首先要做的是在adb调试服务器上定义设备，这是使用开始时导入的‘AdbDeviceTcp’函数来完成的。这个函数将接受3个参数:IP地址、一个应该设置为5555的默认端口，以及一个超时持续时间。所以这个方法的开始看起来像这样:</p><figure class="kb kc kd ke fd ij er es paragraph-image"><div class="er es kh"><img src="../Images/af3f9d3225000db311acabdd8a6f70fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1364/format:webp/1*WQR-t-DhnNoqtrlFHskZAw.jpeg"/></div></figure><p id="d9ea" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在我们使用凭据创建连接之前，我们需要确保所有现有的连接都已关闭，而这是使用“try block”最容易做到的。因此，我们将“尝试”关闭一个到fire-stick的现有连接，通过打印“当前没有设备连接”来处理“except ”,并添加一个“else”来创建一个新连接。最后，我们定义和连接的设备需要返回。所以我们的addDevice方法现在看起来像这样:</p><figure class="kb kc kd ke fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ki"><img src="../Images/1c45540b92552b66f03919b9cc2e5f25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1382/format:webp/1*5s4ES1bfFDZVxTv-DLMBGQ.jpeg"/></div></div></figure><p id="110a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">所以现在当我们创建这个类的实例时，我们将能够让它连接到我们的fire-stick，但是此时它没有任何其他交互。因此，我们的下一个任务是创造更多的方法，让我们能够发送命令，如播放/暂停，选择，主页等…</p></div><div class="ab cl jt ju gp jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="hb hc hd he hf"><p id="96e5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">创建一个发送命令的方法非常简单，它试图模仿的所有按钮都遵循相同的模板。以“select”按钮为例，我们首先在类中定义一个名为“select”的方法，该方法继承了从前面的addDevice方法返回的设备。只需一行代码，我们就可以向fire-stick发送命令。该命令类似于:</p><figure class="kb kc kd ke fd ij er es paragraph-image"><div class="er es kj"><img src="../Images/0f0839d80f1f8389eb31444e7aa2274e.png" data-original-src="https://miro.medium.com/v2/resize:fit:794/format:webp/1*sXwoGzEDw-GRKUdoYZ-_7Q.jpeg"/></div></figure><p id="d4e4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">_service(，)方法的两个参数都必须是“b”字符串，这意味着信息以字节形式发送。第一个参数意味着它在adb服务器中发送一个shell命令，第二个参数将使用不同的数字来代替' # '，这些数字具有不同的数字键码来表示远程按钮。关于哪个键码对应哪个按钮的完整列表，你可以访问这个页面:"<a class="ae iu" href="https://gist.github.com/kibotu/76be44aaa1174bdd252a49a1cd7a02f9" rel="noopener ugc nofollow" target="_blank">https://gist . github . com/kibo tu/76be 44 AAA 1174 BDD 252 a 49 a1 CD 7a 02 f 9</a>"</p><p id="d3b7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因此，完整选择方法非常简单:</p><figure class="kb kc kd ke fd ij er es paragraph-image"><div class="er es kk"><img src="../Images/d805f8f7ed8b63998fd60cfce90d7477.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/format:webp/1*eOmPqTKNvZ8IOoXUZWtNNA.jpeg"/></div></figure><p id="7e44" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果需要，您可以为所有按钮添加方法，或者只为您需要的按钮添加方法。</p></div><div class="ab cl jt ju gp jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="hb hc hd he hf"><p id="396e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们的python脚本几乎准备好了，剩下的就是创建这个类的一个实例，并把它连接到你的fire-stick，这非常容易！</p><p id="4e3f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们只需要添加这几行代码:</p><figure class="kb kc kd ke fd ij er es paragraph-image"><div class="er es kf"><img src="../Images/c8ac009a019d26897a49f4c662cae4ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:722/format:webp/1*BYYP3mXqZNo3ObJvwfQNhg.jpeg"/></div></figure><p id="90de" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，当你运行这个代码时，它应该连接到你的fire-stick，应该很容易分辨，因为你的电视上应该有一个弹出窗口，询问你是否希望允许adb连接。你要做的就是选择允许，如果你选择，你可以选择记住这个设备，这种情况下弹出窗口不会再出现。</p><p id="ef11" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">都搞定了！剩下的就是你想出创造性的方法来激活你的遥控按钮的方法。我写了一个脚本，使用手势控制来导航我的荧光棒！选项是无穷无尽的，这只是让你开始尝试python控制firestick的基本框架。我希望你喜欢把这个好好利用！</p></div><div class="ab cl jt ju gp jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="hb hc hd he hf"><p id="91ab" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这是一篇后续文章，向你展示如何使用opencv和mediapipe添加手势控制来控制火棍！</p><p id="4af2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><a class="ae iu" rel="noopener" href="/@tomaclarke16/gesture-control-of-your-firetv-with-python-7d3d6c9a503b">https://medium . com/@ toma Clarke 16/gesture-control-of-your-fire TV-with-python-7 D3 D6 C9 a 503 b</a></p></div></div>    
</body>
</html>