<html>
<head>
<title>Draw SVG shapes in Angular (Polygons).</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ä»¥è§’åº¦(å¤šè¾¹å½¢)ç»˜åˆ¶SVGå½¢çŠ¶ã€‚</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/codex/draw-svg-shapes-in-angular-polygons-897bfb4614fc?source=collection_archive---------1-----------------------#2022-10-14">https://medium.com/codex/draw-svg-shapes-in-angular-polygons-897bfb4614fc?source=collection_archive---------1-----------------------#2022-10-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="f10b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘è§£é‡Šäº†æœ€ä½è¦æ±‚ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å¼€å§‹åœ¨webæµè§ˆå™¨ä¸­ä½¿ç”¨Angularåœ¨SVGå…ƒç´ ä¸­ç»˜åˆ¶å½¢çŠ¶ã€‚æœ¬è´¨ä¸Šï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªå¤„ç†å‘ˆç°é€»è¾‘çš„æŒ‡ä»¤å’Œä¸€ä¸ªå¤„ç†è¡¨ç¤ºé€»è¾‘çš„ç»„ä»¶ã€‚</p><p id="7b03" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†è§£é‡Šå¦‚ä½•åœ¨SVGå…ƒç´ ä¸­ç»˜åˆ¶å¤šè¾¹å½¢å¹¶ä¸ä¹‹äº¤äº’ã€‚</p><h1 id="ab0f" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">ç»˜åˆ¶å¤šè¾¹å½¢</h1><p id="715b" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">å¤šè¾¹å½¢æ˜¯ç”¨æ¥è¡¨ç¤ºè‡³å°‘æœ‰ä¸‰æ¡è¾¹æˆ–ä¸‰ä¸ªç‚¹çš„å›¾å½¢çš„å…ƒç´ ã€‚å¦‚æœæ‚¨çœ‹ä¸€ä¸‹ä»£ç ï¼Œä¸€ä¸ªå¤šè¾¹å½¢å…ƒç´ çœ‹èµ·æ¥åƒè¿™æ ·:</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="b775" class="kp je hi kl b fi kq kr l ks kt">&lt;polygon points="280,118 455,30 496,114 382,170"&gt;&lt;/polygon&gt;</span></pre><p id="ce6f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">å¦‚æœè¦ç”»å¤šè¾¹å½¢ï¼Œå¿…é¡»è¦æœ‰<strong class="ih hj"> <em class="ku">ç‚¹</em> </strong>å±æ€§ï¼Œæ— éå°±æ˜¯ä¸€ç»„ç”¨ç©ºæ ¼åˆ†å‰²çš„åæ ‡ã€‚ä½†æ˜¯æˆ‘ä»¬åœ¨å“ªé‡Œå¯ä»¥æ‰¾åˆ°è¿™äº›åæ ‡å‘¢ï¼Ÿè¿™é‡Œæœ‰ä¸€ä¸ªæ’å›¾ï¼Œè®©æ‚¨èƒ½å¤Ÿæç»˜SVGå…ƒç´ çš„è½´ã€‚</p><figure class="kg kh ki kj fd kw er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es kv"><img src="../Images/0ccc6bcc1156802dc79e5112522ed449.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HJXuIR6HztXSMB4-1SxuBA.png"/></div></div></figure><p id="3b4e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">å› ä¸ºæˆ‘ä»¬æƒ³è¦ç”¨é¼ æ ‡äº¤äº’æ¥ç»˜åˆ¶å¤šè¾¹å½¢ï¼Œæ‰€ä»¥å¯ä»¥æƒ³è±¡åœ¨æ¯æ¬¡é¼ æ ‡ç‚¹å‡»åéƒ½å¯ä»¥æå–åæ ‡ã€‚</p><figure class="kg kh ki kj fd kw er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es ld"><img src="../Images/9157dbf834a96163a7554e04aa635bcd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*9lqGQ2uw0j4V6Mgh23H-lQ.gif"/></div></div><figcaption class="le lf et er es lg lh bd b be z dx translated">ç»˜åˆ¶å¤šè¾¹å½¢</figcaption></figure><p id="ebf4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ç°åœ¨è®©æˆ‘ä»¬å¼€å§‹ç¼–å†™æŒ‡ä»¤å†…éƒ¨çš„é€»è¾‘ã€‚æˆ‘ä¹Ÿå°†ä½¿ç”¨<a class="ae li" href="https://d3js.org/" rel="noopener ugc nofollow" target="_blank"> d3åº“</a>ï¼Œå®ƒå¯¹åˆ›å»ºå…·æœ‰å¤šç§å±æ€§çš„ä¸åŒç±»å‹çš„å½¢çŠ¶æœ‰å¾ˆå¥½çš„æ”¯æŒã€‚</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="2e0b" class="kp je hi kl b fi kq kr l ks kt">@Directive({<br/>  selector: '[appSvg]'<br/>})</span><span id="0d07" class="kp je hi kl b fi lj kr l ks kt">export class SvgDirective {</span><span id="3cd9" class="kp je hi kl b fi lj kr l ks kt">  private points: Array&lt;[number, number]&gt; = [];<br/>  private currentLine?: d3.Selection&lt;SVGLineElement, unknown, null, any&gt;;</span><span id="4675" class="kp je hi kl b fi lj kr l ks kt">  constructor(private elementRef: ElementRef, private renderer: Renderer2) { }</span><span id="df78" class="kp je hi kl b fi lj kr l ks kt">  @HostListener('mousedown', ['$event'])<br/>  onMouseDown(event: MouseEvent): void {<br/>		// Create the polygon only if we have three or more points <br/>    // and we are clicking on the rectangular helping shape<br/>    if ((event.target as HTMLElement).tagName === 'rect' &amp;&amp; this.points.length &gt;= 3) {<br/>      this.createPolygon();<br/>      this.clearHelperShapes();<br/>    } else {<br/>			// Otherwise, create another helping line or rectangular<br/>      this.addHelperShapes(event);<br/>    }<br/>  }</span><span id="5c30" class="kp je hi kl b fi lj kr l ks kt">  @HostListener('mousemove', ['$event'])<br/>  onMouseMove(event: MouseEvent): void {<br/>    let coordinates = this.getMousePosition(event);<br/>    if ((event.target as HTMLElement).tagName === 'rect' &amp;&amp; this.points.length &gt;= 3) {<br/>      this.renderer.setAttribute(event.target, 'stroke', '#0784fa');<br/>    } else {<br/>      let rect: SVGRectElement | null = document.querySelector('rect');<br/>      if (rect) {<br/>        this.renderer.setAttribute(rect, 'stroke', 'transparent');<br/>      }<br/>    }<br/>    // Move line by changing the coordinates<br/>    if (this.currentLine) {<br/>      this.currentLine.attr('x2', coordinates.x).attr('y2', coordinates.y)<br/>    }<br/>  }</span><span id="ffaa" class="kp je hi kl b fi lj kr l ks kt">  /**<br/>   * After each mouse click, we add a point into the array of polygon coordinates<br/>   * and insert the next helping line.<br/>   * @param event Mouse Event<br/>   */<br/>  private addHelperShapes(event: MouseEvent) {<br/>    let coordinates = this.getMousePosition(event);<br/>    this.points.push([coord.x, coord.y]);</span><span id="f3f2" class="kp je hi kl b fi lj kr l ks kt">    if (this.points.length == 1) {<br/>      d3.select(this.elementRef.nativeElement).append('rect')<br/>        .attr('x', coordinates.x - 5)<br/>        .attr('y', coordinates.y - 5)<br/>        .attr('width', '10')<br/>        .attr('height', '10')<br/>        .attr('fill', 'transparent')<br/>        .attr('class', 'help')<br/>    }</span><span id="12e9" class="kp je hi kl b fi lj kr l ks kt">    this.currentLine = d3.select(this.elementRef.nativeElement)<br/>      .insert('line', ':nth-child(1)')<br/>      .attr('x1', coordinates.x)<br/>      .attr('x2', coordinates.x)<br/>      .attr('y1', coordinates.y)<br/>      .attr('y2', coordinates.y)<br/>      .attr('stroke', '#0784fa')<br/>      .attr('class', 'help')<br/>  }</span><span id="ce3f" class="kp je hi kl b fi lj kr l ks kt">	/**<br/>   * Create a polygon shape<br/>   * @param event Mouse Event<br/>   */<br/>  private createPolygon() {<br/>    d3.select(this.elementRef.nativeElement)<br/>      .append("polygon")<br/>      .attr("points", this.points.join(' '))<br/>      .attr("fill", "lightgrey")<br/>      .attr("stroke", "black")<br/>      .attr('stroke-width', '0.2')<br/>  }</span><span id="f7da" class="kp je hi kl b fi lj kr l ks kt">	/**<br/>   * Get the mouse coordinates relative to the SVG element<br/>   * @param event Mouse Event<br/>   */<br/>  private getMousePosition(event: MouseEvent) {<br/>    return {<br/>      x: event.offsetX,<br/>      y: event.offsetY<br/>    }<br/>  }</span><span id="93b8" class="kp je hi kl b fi lj kr l ks kt">	/**<br/>   * Clear the helping lines and rectangular<br/>   * @param event Mouse Event<br/>   */<br/>  private clearHelperShapes() {<br/>    document.querySelectorAll('.help')<br/>    .forEach(element =&gt; {<br/>      element.remove();<br/>    });<br/>    this.points = [];<br/>  }<br/>}</span></pre><h1 id="c077" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">ç§»åŠ¨å¤šè¾¹å½¢</h1><p id="6be2" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">è¦ç§»åŠ¨å¤šè¾¹å½¢ï¼Œä½ éœ€è¦ä¸‰æ ·ä¸œè¥¿:</p><ul class=""><li id="7607" class="lk ll hi ih b ii ij im in iq lm iu ln iy lo jc lp lq lr ls bi translated">ç‚¹çš„å½“å‰åæ ‡ã€‚</li><li id="c838" class="lk ll hi ih b ii lt im lu iq lv iu lw iy lx jc lp lq lr ls bi translated">å…ƒç´ å¼•ç”¨ã€‚</li><li id="a728" class="lk ll hi ih b ii lt im lu iq lv iu lw iy lx jc lp lq lr ls bi translated">é¼ æ ‡çš„å½“å‰åæ ‡ã€‚</li></ul><p id="f8f4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">è¯·è®°ä½ï¼Œä¸ºäº†è¾¾åˆ°é¢„æœŸçš„æ•ˆæœï¼Œæ‚¨åªéœ€è¦åœ¨æŒ‰ä¸‹é¼ æ ‡æ—¶ç§»åŠ¨å¤šè¾¹å½¢ï¼Œå› æ­¤æˆ‘ä»¬æœ‰ä¸€ä¸ªæ‹–æ”¾è¡Œä¸ºã€‚</p><figure class="kg kh ki kj fd kw er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es ld"><img src="../Images/e53cda6a5d384debd62def636588789d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*6mLSeoU3bshX5oK34UJEbQ.gif"/></div></div><figcaption class="le lf et er es lg lh bd b be z dx translated">ç§»åŠ¨å¤šè¾¹å½¢</figcaption></figure><p id="c886" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ç°åœ¨è®©æˆ‘ä»¬æ·±å…¥ç¼–ç </p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="9ef6" class="kp je hi kl b fi kq kr l ks kt">@Component({<br/>  selector: 'app-root',<br/>  template: `&lt;svg appSvg style="border: 1px solid black;" width="1000" height="700" &gt;<br/>  &lt;polygon points="477,175 579,281 407,318" fill="lightgrey" stroke="black" stroke-width="0.2"&gt;&lt;/polygon&gt;<br/>  &lt;/svg&gt;`,<br/>})</span><span id="9adb" class="kp je hi kl b fi lj kr l ks kt">@Directive({<br/>  selector: '[appSvg]'<br/>})</span><span id="682b" class="kp je hi kl b fi lj kr l ks kt">export class SvgDirective {</span><span id="2c35" class="kp je hi kl b fi lj kr l ks kt">  private draggingPoints: number[][] = [];<br/>  private draggingElement?: d3.Selection&lt;SVGPolygonElement, unknown, null, any&gt;;<br/>  private currentPoint: { x: number, y: number } = { x: 0, y: 0 };<br/>  private mousedown = false;<br/>  <br/>  constructor(private elementRef: ElementRef, private renderer: Renderer2) { }</span><span id="7c08" class="kp je hi kl b fi lj kr l ks kt">  @HostListener('mousedown', ['$event'])<br/>  onMouseDown(event: MouseEvent): void {<br/>    this.mousedown = true;<br/>    let coordinates = this.getMousePosition(event);<br/>    let target = (event.target as SVGPolygonElement);<br/>    if (target.tagName === 'polygon') {<br/>      this.currentPoint = coordinates;<br/>      this.draggingElement = d3.select(target);<br/>      this.draggingPoints = this.getPointsFromPolygon();<br/>    }<br/>  }</span><span id="9e04" class="kp je hi kl b fi lj kr l ks kt">  @HostListener('mousemove', ['$event'])<br/>  onMouseMove(event: MouseEvent): void {<br/>    let coordinates = this.getMousePosition(event);<br/>    if (!!this.draggingElement &amp;&amp; this.mousedown) {<br/>        document.body.style.cursor = 'move';<br/>        let x = coordinates.x - this.currentPoint.x;<br/>        let y = coordinates.y - this.currentPoint.y;<br/>        let h = Math.sqrt(Math.pow(x, 2) + Math.pow(y, 2));<br/>        let angle = this.angleFromCoordinates(x, y);<br/>        var newPoints = this.polygonTranslate(this.draggingPoints, angle, h);<br/>        this.draggingElement.attr('points', newPoints.join(" "));<br/>    }<br/>  }</span><span id="535a" class="kp je hi kl b fi lj kr l ks kt">  @HostListener('mouseup', ['$event'])<br/>  onMouseUp(event: MouseEvent): void {<br/>    this.mousedown = false;<br/>    this.draggingElement = undefined;<br/>    this.renderer.setStyle(document.body, 'cursor', 'initial');<br/>  }<br/>  /**<br/>   * Get the angle from two coordinates<br/>   */<br/>  angleFromCoordinates(x: number, y: number) {<br/>    let rad = Math.atan2(y, x)<br/>    var pi = Math.PI<br/>    let angle = Math.round(rad * (180 / pi))</span><span id="2395" class="kp je hi kl b fi lj kr l ks kt">    if (angle &lt; 0) {<br/>      angle = angle + 360<br/>    }<br/>    return angle<br/>  }<br/>  /**<br/>   * Translate current polygon into a new one<br/>   * @param polygon An array of polygon coordinates<br/>   * @param angle The angle created by the polygon and the current mouse position<br/>   * @param distance The distance from the polygon to the mouse position<br/>   * @returns <br/>   */<br/>  polygonTranslate(polygon: number[][], angle: number, distance: number) {<br/>    let p = [];<br/>    for (let i = 0, l = polygon.length; i &lt; l; i++) {<br/>      const r = angle / 180 * Math.PI;<br/>      p[i] = [polygon[i][0] + distance * Math.cos(r), polygon[i][1] + distance * Math.sin(r)];<br/>    }<br/>    return p;<br/>  }<br/>  /**<br/>   * Extract the points of current polygon<br/>   * @param event Mouse events<br/>   */<br/>  getPointsFromPolygon(): number[][] {<br/>    let points: Array&lt;{x: number, y: number}&gt; = this.draggingElement?.property('points');<br/>    let pointsArray = []<br/>    for (let i = 0; i &lt; points.length; i++) {<br/>      pointsArray.push([points[i].x, points[i].y])<br/>    }<br/>    return pointsArray<br/>  }</span><span id="23c3" class="kp je hi kl b fi lj kr l ks kt">  private getMousePosition(event: MouseEvent) {<br/>    return {<br/>      x: event.offsetX,<br/>      y: event.offsetY<br/>    }<br/>  }<br/>}</span></pre><h1 id="8d92" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">åç»­æ­¥éª¤</h1><p id="9712" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">æˆ‘å°†è§£é‡ŠSVGå…ƒç´ ä¸­æ›´å¤šçš„å½¢çŠ¶äº¤äº’ã€‚æ•¬è¯·æœŸå¾…ğŸ™‚</p><p id="03d1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">çœ‹çœ‹å·²ç»å®Œæˆçš„<a class="ae li" href="https://seats.better.network" rel="noopener ugc nofollow" target="_blank">é¡¹ç›®</a>ã€‚</p><p id="aded" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">å¦‚æœä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œè¯·åœ¨LinkedInä¸Šå…³æ³¨æˆ‘ã€‚</p></div></div>    
</body>
</html>