<html>
<head>
<title>Modern Data Platform using Open Source Technologies</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用开源技术的现代数据平台</h1>
<blockquote>原文：<a href="https://medium.com/codex/modern-data-platform-using-open-source-technologies-212ba8273eab?source=collection_archive---------0-----------------------#2021-01-11">https://medium.com/codex/modern-data-platform-using-open-source-technologies-212ba8273eab?source=collection_archive---------0-----------------------#2021-01-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><h2 id="4fef" class="hg hh hi bd b fp hj hk hl hm hn ho dx hp translated" aria-label="kicker paragraph"><a class="ae ge" href="https://medium.com/codex" rel="noopener">法典</a></h2><div class=""/><p id="52f8" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">您是否希望为您的组织构建一个现代化的数据仓库或数据湖？如果是，您应该从头开始构建还是使用市场上现成的？这是一个很难回答的问题。在本文中，我将分享一些关于开源技术的细节，这些技术包括<a class="ae jm" href="https://trino.io/" rel="noopener ugc nofollow" target="_blank"> Trino </a>和<a class="ae jm" href="https://min.io/" rel="noopener ugc nofollow" target="_blank"> MinIO </a>，它们可以用来在本地或公共云上构建这个现代数据仓库。在我的上一篇文章(<a class="ae jm" href="https://tmarvadi.medium.com/how-to-build-a-modern-data-lake-with-minio-db0455eec053" rel="noopener">如何用MinIO </a>构建数据湖)中，我简单地分享了如何建立数据湖的一步一步的过程。这两个功能强大、轻量级且可伸缩的工具提供了如此多的功能。在你决定付钱给一家基于云的数据仓库公司之前，看看它们是值得的。本文将向您介绍Trino和MinIO的概况，并且还涉及到一旦您将它们作为一个数据平台一起实现，它们可以提供的一些特性。</p><figure class="jo jp jq jr fd js er es paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="er es jn"><img src="../Images/157c10034e25a2c1a700a62496d53a9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UGemxMoj7FiqbvRrNlqX3A.jpeg"/></div></div></figure><h1 id="3029" class="jz ka hi bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">Trino是什么？</h1><p id="139a" class="pw-post-body-paragraph io ip hi iq b ir kx it iu iv ky ix iy iz kz jb jc jd la jf jg jh lb jj jk jl hb bi translated">Trino的速度非常快，并且在性能方面得到了大规模验证。它是一个分布式SQL查询引擎，旨在处理异构数据源上的大量数据。它可以执行跨平台查询，这意味着您可以跨位于不同服务器上的多个数据库连接数据，并且它们不需要在同一个数据中心内。它支持结构化和半结构化数据。这为数据分析师和数据科学家提供了优势，因为他们可以随时使用这些数据。</p><p id="5b64" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">Trino架构与MPP(大规模并行处理)数据库管理系统非常相似。</p><figure class="jo jp jq jr fd js er es paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="er es lc"><img src="../Images/74c69c890d25a154f61b7833d0f7c957.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RjFyL16WKY-qOZqYmsJfMw.png"/></div></div><figcaption class="ld le et er es lf lg bd b be z dx translated">特里诺建筑</figcaption></figure><p id="e690" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">它有一个与多个工作节点同步工作的协调节点。当用户向协调器提交他们的SQL查询时，协调器使用定制的查询和执行引擎来解析、计划和调度跨工作节点的分布式查询计划。它旨在支持标准ANSI SQL语义，包括复杂查询、聚合、连接、子查询、窗口函数、非重复计数和近似百分位数。</p><p id="21f2" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">无论您的数据位于何处，Trino都统一允许通过其SQL抽象层访问数据。由于内存中的处理，查询结果的返回速度非常快。中间数据以MPP的方式跨节点进行管道传输，因此它带来了高度交互的查询性能。Trino允许查询数据所在的位置，这适用于NoSQL和SQL数据库。单个查询可以组合来自多个来源的数据，从而允许您分析整个组织的数据。Trino提供了各种各样的连接器，如MySQL、Oracle、SQL Server、Redshift、Kafka、Elasticseach等等(见<a class="ae jm" href="https://trino.io/docs/current/connector.html" rel="noopener ugc nofollow" target="_blank">完整列表</a>)。</p><h1 id="3051" class="jz ka hi bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated"><strong class="ak">什么是MinIO？</strong></h1><p id="672c" class="pw-post-body-paragraph io ip hi iq b ir kx it iu iv ky ix iy iz kz jb jc jd la jf jg jh lb jj jk jl hb bi translated">MinIO是一个高性能的分布式对象存储服务器，它与亚马逊S3兼容。它可以存储照片、视频、日志文件、备份和容器图像等非结构化数据。它可以部署在不同的硬件上。当您将MinIO作为一个集群部署在多个节点中时，它的威力就会释放出来。它被设计成最小和可扩展的。它足够轻，可以与其他应用程序堆栈捆绑在一起。它使用<a class="ae jm" href="https://docs.min.io/docs/minio-erasure-code-quickstart-guide" rel="noopener ugc nofollow" target="_blank">擦除代码</a>和<a class="ae jm" href="https://github.com/minio/minio/blob/master/docs/erasure/README.md#what-is-bit-rot-protection" rel="noopener ugc nofollow" target="_blank">比特腐蚀保护</a>来防止数据损坏和硬件故障。它提供了广泛的认证集成，如Active Directory和Okta。它为所有I/O操作提供了高性能和严格的写后读一致性。它是一个运行在商用服务器上的开源分布式对象存储解决方案。</p><figure class="jo jp jq jr fd js er es paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="er es lh"><img src="../Images/f2cc4bdcae278e008461f0fec91bd70a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*BzJjAuu1egLoEvgQ"/></div></div><figcaption class="ld le et er es lf lg bd b be z dx translated">迷你建筑</figcaption></figure><h1 id="0807" class="jz ka hi bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">Trino + MinIO =现代数据平台</h1><p id="3486" class="pw-post-body-paragraph io ip hi iq b ir kx it iu iv ky ix iy iz kz jb jc jd la jf jg jh lb jj jk jl hb bi translated">Trino和MinIO一起可以创建一个现代数据平台，或者您可以称之为现代数据仓库。MinIO的实现提供了一个存储解决方案，而Trino充当了一台计算机。存储和计算的分离提供了一个无任何中断的可扩展平台。通过这种实现，您可以完全灵活地横向扩展MinIO集群，而不会影响Trino集群，反之亦然。您甚至可以在Kubernetes的公共云平台或托管服务Kubernetes上部署Trino和MinIO，它将为您的数据平台提供终极解决方案。</p><p id="c5cb" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">Trino和MinIO的结合提供了与基于云的数据仓库公司所能提供的基本相似的功能。使用这种设置，您不必担心数据进出成本。它还消除了供应商锁定，并为我们提供了急需的灵活性。如果您的团队中有合适的人员和专业知识，那么探索这些技术是值得的。其好处包括，如果您决定在内部部署数据，您可以将所有数据保存在您的私有云中。</p><p id="83fc" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">下面是一些任意的例子，展示了在使用Trino和MinIO构建数据平台时可以执行的一些操作。</p><ul class=""><li id="2ed0" class="li lj hi iq b ir is iv iw iz lk jd ll jh lm jl ln lo lp lq bi translated">在MinIO桶中的数据文件之上创建一个读取模式。实际上，您可以在各种文件类型上创建读取模式，包括ORC、Parquet、JSON等等。</li></ul><pre class="jo jp jq jr fd lr ls lt lu aw lv bi"><span id="eac9" class="lw ka hi ls b fi lx ly l lz ma">CREATE TABLE datalake.first_schema.customer <br/>(customer_id VARCHAR, <br/> name VARCHAR, <br/> full_name VARCHAR<br/>)<br/>WITH (external_location='s3a://raw-data/',format = 'csv', skip_header_line_count=1);</span></pre><ul class=""><li id="ad2b" class="li lj hi iq b ir is iv iw iz lk jd ll jh lm jl ln lo lp lq bi translated">跨不同的源系统运行查询，而不将任何数据移动到MinIO集群中。有了谓词下推支持，查询的性能将会非常快。</li></ul><pre class="jo jp jq jr fd lr ls lt lu aw lv bi"><span id="fa22" class="lw ka hi ls b fi lx ly l lz ma">SELECT erp_account.id, erp_account_name, sum(crm_customer.amount) <br/>FROM <br/>oracle_erp.erp_schema.account erp_account,   # Oracle<br/>mysql_crm.crm_schema.customer crm_customer,  # MySQL datalake.first_schema.customer csv_customer  # CSV File<br/>WHERE erp_account.cmr_id = crm_customer.id<br/>  AND crm_customer.id = csv_customer.id<br/>GROUP BY erp_account.id, erp_account_name;</span></pre><ul class=""><li id="78c8" class="li lj hi iq b ir is iv iw iz lk jd ll jh lm jl ln lo lp lq bi translated">机器学习插件提供ML功能，可以训练基于支持向量机(SVM)的分类器和回归器，用于使用SQL的监督学习问题。</li></ul><pre class="jo jp jq jr fd lr ls lt lu aw lv bi"><span id="1a47" class="lw ka hi ls b fi lx ly l lz ma">SELECT<br/>classify(features(2.9, 3, 5.1, 1.8), model) AS predicted_label<br/>FROM <br/>(SELECT learn_classifier(species, features(sepal_length, sepal_width, petal_length, petal_width)) AS model <br/>FROM <br/>datalake.data_analytics.iris<br/>) t;</span></pre><ul class=""><li id="5814" class="li lj hi iq b ir is iv iw iz lk jd ll jh lm jl ln lo lp lq bi translated">Trino提供了不同语言的客户端接口如<a class="ae jm" href="https://github.com/trinodb/trino-python-client" rel="noopener ugc nofollow" target="_blank"> Python </a>和<a class="ae jm" href="https://github.com/trinodb/trino-go-client" rel="noopener ugc nofollow" target="_blank"> GO </a>来连接Trino。更多详情请参考他们的<a class="ae jm" href="https://github.com/trinodb" rel="noopener ugc nofollow" target="_blank"> Github </a>。下面是一个使用基本身份验证连接到Trino的Python代码示例。</li></ul><pre class="jo jp jq jr fd lr ls lt lu aw lv bi"><span id="21cd" class="lw ka hi ls b fi lx ly l lz ma">import trino<br/>conn = trino.dbapi.connect(<br/>    host='coordinator url',<br/>    port=8443,<br/>    user='the-user',<br/>    catalog='the-catalog',<br/>    schema='the-schema',<br/>    http_scheme='https',<br/>    auth=trino.auth.BasicAuthentication("principal id", "password"),<br/>)<br/>cur = conn.cursor()<br/>cur.execute('SELECT * FROM system.runtime.nodes')<br/>rows = cur.fetchall()</span></pre><h1 id="5da1" class="jz ka hi bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">结论</h1><p id="43d0" class="pw-post-body-paragraph io ip hi iq b ir kx it iu iv ky ix iy iz kz jb jc jd la jf jg jh lb jj jk jl hb bi translated">在本文中，我分享了两种强大的开源技术的细节——Trino和MinIO。它们共同支持您在内部或公共云上构建现代数据平台。如果您的团队中有合适的资源，我建议考虑这种设置，因为它提供了灵活性和对数据的完全控制。</p><p id="4599" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">如果你有兴趣搭建这个平台，可以参考我上一篇文章的分步基础实现指南(<a class="ae jm" href="https://tmarvadi.medium.com/how-to-build-a-modern-data-lake-with-minio-db0455eec053" rel="noopener">如何用MinIO </a>构建数据湖)。</p><p id="0667" class="pw-post-body-paragraph io ip hi iq b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl hb bi translated">希望这篇文章对你有用。请在下面留下你对这篇文章的评论。</p></div></div>    
</body>
</html>