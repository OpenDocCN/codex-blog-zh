<html>
<head>
<title>A Dog Breed Classifier using CNN</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于CNN的犬种分类器</h1>
<blockquote>原文：<a href="https://medium.com/codex/dog-breed-classifier-using-cnn-4f408d04ff86?source=collection_archive---------18-----------------------#2021-08-08">https://medium.com/codex/dog-breed-classifier-using-cnn-4f408d04ff86?source=collection_archive---------18-----------------------#2021-08-08</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><h1 id="19b9" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated"><strong class="ak">简介:</strong></h1><p id="76d1" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">如果你有一个应用程序来对狗的品种进行分类，以便在你的社交圈里不辜负你对狗的了解，这不是很酷吗？嗯！你来对地方了。</p><p id="7b32" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">在这里，我们将介绍几种图像分类技术，看看它们的效果如何。CNN模型将被喂食狗的图像和人的图像。在狗的情况下，我们的模型将预测它的品种，而如果它遇到人类，它将告诉我们与人类最相似的品种。</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es kg"><img src="../Images/d86a31c28885a8b529de98c9a36942a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:908/format:webp/1*VZzLcBE1JplI3oxa8bT0ZA.jpeg"/></div><figcaption class="ko kp et er es kq kr bd b be z dx translated">图一:你好，胡曼，我是一只柯基。你喜欢我吗！是的，你知道。</figcaption></figure><p id="f435" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">为了开发这样一个模型，我们使用了Kaggle提供的<a class="ae ks" href="https://s3-us-west-1.amazonaws.com/udacity-aind/dog-project/dogImages.zip" rel="noopener ugc nofollow" target="_blank">狗数据集</a>和<a class="ae ks" href="https://s3-us-west-1.amazonaws.com/udacity-aind/dog-project/lfw.zip" rel="noopener ugc nofollow" target="_blank">人类数据集</a>。分为训练(<strong class="jf hj"> 6680 </strong>)、验证(<strong class="jf hj"> 835 </strong>)、测试(<strong class="jf hj"> 836 </strong>)数据集的<strong class="jf hj"> 8351 </strong>张狗图像，以及<strong class="jf hj"> 13233 </strong>张人脸。</p><p id="920b" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">我们将通过下面的步骤，最终实现一个健壮的算法，从人的图像中检测狗，并将它们分类到它们的品种中。</p><p id="99c3" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">为了开发这样一个模型，我们使用了Kaggle提供的狗数据集和人数据集。大约有<strong class="jf hj"> 8351 </strong>张狗的图像，分为训练(6680)、验证(835)和测试(836)数据集，以及大约<strong class="jf hj"> 13233 </strong>张人类图像。</p><p id="d713" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">在训练数据集中，我们有图像数量最多的<strong class="jf hj">阿拉斯加雪橇犬</strong>(<strong class="jf hj">77)</strong>和图像数量最少的Xoloitzcuintli(<strong class="jf hj">26</strong>)&amp;挪威布洪德(<strong class="jf hj"> 26 </strong>)。</p><p id="1efc" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">准确性</strong>恰好是判断我们的模型的正确度量，因为我们的目标是在狗和人脸的情况下正确预测狗的品种，并丢弃不属于该类别的狗和人脸。由于精度符合分子中的<strong class="jf hj">真正比率</strong>和<strong class="jf hj">真负比率</strong>，因此认为模型具有良好的精度是合理的。然而，我们也不希望狗被检测为人/不是狗，反之亦然，这可以使用<strong class="jf hj"> Precision </strong>进行总结，它对更大的<strong class="jf hj">假阳性率进行惩罚。</strong></p><p id="2c16" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">我们将通过下面的步骤，最终实现一个健壮的算法，从人的图像中检测狗，并将它们分类到它们的品种中。</p><ul class=""><li id="c2e0" class="kt ku hi jf b jg kb jk kc jo kv js kw jw kx ka ky kz la lb bi translated"><a class="ae ks" href="https://viewooizm3ck72.udacity-student-workspaces.com/notebooks/dog-project/dog_app.ipynb#step1" rel="noopener ugc nofollow" target="_blank">第一步</a>:探测人类</li><li id="618a" class="kt ku hi jf b jg lc jk ld jo le js lf jw lg ka ky kz la lb bi translated"><a class="ae ks" href="https://viewooizm3ck72.udacity-student-workspaces.com/notebooks/dog-project/dog_app.ipynb#step2" rel="noopener ugc nofollow" target="_blank">第二步</a>:探狗</li><li id="3a7e" class="kt ku hi jf b jg lc jk ld jo le js lf jw lg ka ky kz la lb bi translated"><a class="ae ks" href="https://viewooizm3ck72.udacity-student-workspaces.com/notebooks/dog-project/dog_app.ipynb#step3" rel="noopener ugc nofollow" target="_blank">第三步</a>:创建一个CNN对狗的品种进行分类(从头开始)</li><li id="5f0c" class="kt ku hi jf b jg lc jk ld jo le js lf jw lg ka ky kz la lb bi translated"><a class="ae ks" href="https://viewooizm3ck72.udacity-student-workspaces.com/notebooks/dog-project/dog_app.ipynb#step4" rel="noopener ugc nofollow" target="_blank">步骤4 </a>:使用CNN对狗的品种进行分类(使用迁移学习)</li><li id="baff" class="kt ku hi jf b jg lc jk ld jo le js lf jw lg ka ky kz la lb bi translated"><a class="ae ks" href="https://viewooizm3ck72.udacity-student-workspaces.com/notebooks/dog-project/dog_app.ipynb#step5" rel="noopener ugc nofollow" target="_blank">第五步</a>:创建一个CNN对狗的品种进行分类(使用迁移学习)</li><li id="2b1e" class="kt ku hi jf b jg lc jk ld jo le js lf jw lg ka ky kz la lb bi translated"><a class="ae ks" href="https://viewooizm3ck72.udacity-student-workspaces.com/notebooks/dog-project/dog_app.ipynb#step6" rel="noopener ugc nofollow" target="_blank">步骤6 </a>:最终算法</li><li id="fbd5" class="kt ku hi jf b jg lc jk ld jo le js lf jw lg ka ky kz la lb bi translated"><a class="ae ks" href="https://viewooizm3ck72.udacity-student-workspaces.com/notebooks/dog-project/dog_app.ipynb#step7" rel="noopener ugc nofollow" target="_blank">步骤7 </a>:测试算法</li></ul></div><div class="ab cl lh li gp lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="hb hc hd he hf"><h1 id="0b4d" class="if ig hi bd ih ii lo ik il im lp io ip iq lq is it iu lr iw ix iy ls ja jb jc bi translated">检测人类:</h1><p id="80a8" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">我们将尝试两种不同的算法来检测人脸。OpenCV和MTCNN。该算法识别人脸，并在人脸周围绘制边界框。让我们带您看一下实现过程。</p><p id="814e" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">OpenCV是一个python库，它利用了<a class="ae ks" href="https://docs.opencv.org/master/db/d28/tutorial_cascade_classifier.html" rel="noopener ugc nofollow" target="_blank"> <strong class="jf hj">基于Haar特征的级联分类器</strong> </a>。它使用各种过滤器/内核提取特征，然后应用<strong class="jf hj"> Adaboost算法</strong>来惩罚不好的特征。下面是上述算法的一个实现—</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es lt"><img src="../Images/70866cdb3a50a5831c66bb81d1919e1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:982/format:webp/1*ZGnwo8xOClu_BstUwMMC8w.jpeg"/></div><figcaption class="ko kp et er es kq kr bd b be z dx translated">图2:打开CV实现来检测人脸。</figcaption></figure><p id="01e8" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">OpenCV的Haar-Cascade实现对人类图像的<strong class="jf hj"> 100% </strong>预测正确，而对狗图像的<strong class="jf hj"> 12% </strong>预测不正确。</p><p id="bd3a" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><a class="ae ks" href="https://towardsdatascience.com/how-does-a-face-detection-program-work-using-neural-networks-17896df8e6ff" rel="noopener" target="_blank"> <strong class="jf hj"> MTCNN </strong> </a>(多任务级联卷积网络)是我们将测试的另一个用于检测人脸的分类器。它包括三个卷积网络(P-Net、R-Net和O-Net ),负责其在实时检测中的鲁棒性。</p><p id="64f9" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">让我们回顾一下它的性能，并检查一下它的实现—</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es lu"><img src="../Images/e81fd598cc32ee2c98e27bfc469a10a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:990/format:webp/1*V-X900dLI3dfq5xTlG8uyw.png"/></div><figcaption class="ko kp et er es kq kr bd b be z dx translated">图3:检测人脸的MTCNN实现。</figcaption></figure><p id="bce0" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">现在，我检查了人脸检测的实现。事实证明，MTCNN是检测模糊图像的更好选择。</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es lv"><img src="../Images/efdc9ec544062da89b221976fd44afd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1330/format:webp/1*-fpnstZoQfA-XV8qkZj5cg.png"/></div><figcaption class="ko kp et er es kq kr bd b be z dx translated">图5: MTCNN与OpenCV在人脸检测方面的比较</figcaption></figure><p id="29db" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">然而，当我们在狗的图像上评估MTCNN算法时，数字是不同的—</p><p id="1029" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">尽管它完美地检测到了所有人脸，但大约有<strong class="jf hj"> 23% </strong>的狗图像被检测为人，这比OpenCV实现要大得多。这表明MTCNN中的<strong class="jf hj">假阳性率</strong>比OpenCV中的大。</p></div><div class="ab cl lh li gp lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="hb hc hd he hf"><h1 id="f318" class="if ig hi bd ih ii lo ik il im lp io ip iq lq is it iu lr iw ix iy ls ja jb jc bi translated">检测狗:</h1><p id="faa2" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">为了检测狗，我们将使用一个预先训练好的<a class="ae ks" href="https://towardsdatascience.com/understanding-and-coding-a-resnet-in-keras-446d7ff84d33#:~:text=The%20ResNet%2D50%20model%20consists,over%2023%20million%20trainable%20parameters.&amp;text=Our%20ResNet%2D50%20gets%20to,in%2025%20epochs%20of%20training." rel="noopener" target="_blank"> <strong class="jf hj"> Resnet-50 </strong> </a>模型。这个网络已经在<a class="ae ks" href="https://image-net.org/" rel="noopener ugc nofollow" target="_blank"> ImageNet </a>数据集上进行了训练。因此，我们将通过直接加载模型和权重来利用它。</p><p id="d32d" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">在我们将图像输入Resnet-50模型之前，我们必须将它们(图像的预处理)重新整形为Keras可以接受的张量(一个<strong class="jf hj"> 4D数组)</strong>。</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es lw"><img src="../Images/73f5be79f48b62539957bfb2f73bb56e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1148/format:webp/1*WGp6Dx1oxJCviCQi2NKb8A.png"/></div><figcaption class="ko kp et er es kq kr bd b be z dx translated">图6:预处理图像数据</figcaption></figure><p id="2c1b" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">接下来是预测。即使在进行预测之前，我们也必须对输入图像进行一些额外的处理。感谢<strong class="jf hj"> Keras preprocess_input函数</strong>为我们完成了这项工作。它将RGB图像转换为BGR图像，并附带一些标准化步骤。你可以点击查看完整的步骤<a class="ae ks" href="https://github.com/keras-team/keras/blob/master/keras/applications/imagenet_utils.py" rel="noopener ugc nofollow" target="_blank">。</a></p><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es lx"><img src="../Images/8b83ddea75e43765eb7c43996b672f88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1354/format:webp/1*ayHXUCli477sHm9QHLM94w.png"/></div><figcaption class="ko kp et er es kq kr bd b be z dx translated">图7:预测输入图像的标签。</figcaption></figure><p id="ba0f" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">对应于狗的类别出现在<strong class="jf hj">151–268</strong>之间的索引标签(<a class="ae ks" href="https://gist.github.com/yrevar/942d3a0ac09ec9e5eb3a" rel="noopener ugc nofollow" target="_blank">字典</a>)的连续序列中。所以，如果预测的类标签落在这个范围内，就是狗。</p><p id="92e7" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">Resnet-50型号在这方面的表现相当显著。使用Resnet-50模型，狗和人脸的图像都被正确标记。</p></div><div class="ab cl lh li gp lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="hb hc hd he hf"><h1 id="a57a" class="if ig hi bd ih ii lo ik il im lp io ip iq lq is it iu lr iw ix iy ls ja jb jc bi translated">创建一个CNN对狗的品种进行分类(从头开始):</h1><p id="4b90" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">现在我们有了在图像中检测人类和狗的功能，我们必须设计一种从图像中预测品种的方法。在这里，我们将尝试创建我们的卷积神经网络，并在我们的狗数据集上进行训练。</p><p id="bec7" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">让我们看一下实现和架构。</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="er es ly"><img src="../Images/3c0ae5c8e4482bfd02b47b17ebc49ed8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*epXI-2-h87vy99UeLngiEA.png"/></div></div><figcaption class="ko kp et er es kq kr bd b be z dx translated">图8:狗品种分类器的CNN实现(Scratch)。</figcaption></figure><p id="8ed8" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">我们已经为最初的几个层使用了<strong class="jf hj"> Conv2D </strong>和<strong class="jf hj"> MaxPooling </strong>的组合，随后是<strong class="jf hj">globaveragepool2d</strong>、一个<strong class="jf hj"> Dropout </strong>和一个<strong class="jf hj"> Dense </strong>层。</p><p id="842b" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">我们来看看模型的总结。</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es md"><img src="../Images/675dd4d8a7860e0f508cd6fc9c5bf35d.png" data-original-src="https://miro.medium.com/v2/resize:fit:902/format:webp/1*qP3MW6RzlaCoLjwUocsDRQ.png"/></div><figcaption class="ko kp et er es kq kr bd b be z dx translated">图9:模型总结</figcaption></figure><p id="8a5f" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">请注意，其他突破性模型具有更深的层次，并且是在更大的数据集上训练的。相比之下，上述CNN模型要浅得多，因此预计不会产生合理的准确性。</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="er es me"><img src="../Images/1840d89c866cd213f5a7569a312bcd3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vJqDLV2aPKZAP4nrtE9ObA.png"/></div></div><figcaption class="ko kp et er es kq kr bd b be z dx translated">图10。模型编译</figcaption></figure><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="er es mf"><img src="../Images/0e4c95d41cbf294b00ec261957ed95df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yr58Ff4ZQxRe8j7gT2AabQ.png"/></div></div><figcaption class="ko kp et er es kq kr bd b be z dx translated">图11:模型训练</figcaption></figure><p id="49b5" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">我们已经在25个时期上训练了模型，批次大小为20。使用的优化器是<strong class="jf hj"> rmsprop </strong>。使用该模型获得的准确度和精确度分别为<strong class="jf hj"> 15.5% </strong>和<strong class="jf hj"> 14% </strong>。</p></div><div class="ab cl lh li gp lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="hb hc hd he hf"><h1 id="a54b" class="if ig hi bd ih ii lo ik il im lp io ip iq lq is it iu lr iw ix iy ls ja jb jc bi translated">使用CNN对狗的品种进行分类(使用迁移学习):</h1><p id="5f54" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">上面的模型没有给出一个理想的精度，事实上，甚至没有接近它。谢天谢地，我们有了另一个概念<strong class="jf hj">转移学习</strong>来帮助我们。在这里，我们可以在不牺牲准确性的情况下减少训练时间。这是因为我们只需训练最后几层，并利用已经训练好的CNN模型的权重，在这种情况下，CNN模型是<a class="ae ks" href="https://towardsdatascience.com/step-by-step-vgg16-implementation-in-keras-for-beginners-a833c686ae6c#:~:text=VGG16%20is%20a%20convolution%20neural,vision%20model%20architecture%20till%20date.&amp;text=It%20follows%20this%20arrangement%20of,consistently%20throughout%20the%20whole%20architecture." rel="noopener" target="_blank"> <strong class="jf hj"> VGG-16 </strong> </a></p><p id="2511" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">我们使用VGG-16的最后一层作为我们模型的输入。它被用作作为<strong class="jf hj">下载的特征提取器。npz文件</strong>，它后来被用于训练我们的模型。(注意:您可以在VGG-16的顶层训练您的特征提取器，然后在以后使用它进行训练。)</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es mg"><img src="../Images/8abeccfee69eec67fdbf2ed2cd202e7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/format:webp/1*zmCFMZ8s1WigklFhVsZStg.png"/></div><figcaption class="ko kp et er es kq kr bd b be z dx translated">图13: VGG 16 CNN模型。</figcaption></figure><p id="f8b7" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">VGG16模型的上述实现产生了<strong class="jf hj"> 45.5% </strong>的准确度，远远好于我们自己的CNN模型。</p></div><div class="ab cl lh li gp lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="hb hc hd he hf"><h1 id="9ecf" class="if ig hi bd ih ii lo ik il im lp io ip iq lq is it iu lr iw ix iy ls ja jb jc bi translated">创建一个CNN对狗的品种进行分类(使用迁移学习):</h1><p id="ed71" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">接下来，我们将在为各自架构下载的瓶颈特性上训练更多的模型(<strong class="jf hj"> Resnet-50，InceptionV3) </strong>。就实现而言，它将完全类似于VGG-16模型。区别在于架构。</p><p id="fbd4" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">我们创建了一组函数来构建架构、编译和训练模型，以及报告准确性和热图。</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es mh"><img src="../Images/d472f981b7c80bd82d572d68c30fdd79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1216/format:webp/1*-2PYsI4bpJVd6vxzHtYFnw.png"/></div><figcaption class="ko kp et er es kq kr bd b be z dx translated">图14:构建架构</figcaption></figure><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es mi"><img src="../Images/57639acfd41593ba3f3c9a9a00283472.png" data-original-src="https://miro.medium.com/v2/resize:fit:1156/format:webp/1*YcTWS87LvWAUhoVwq1lPiw.png"/></div><figcaption class="ko kp et er es kq kr bd b be z dx translated">图15:编译和训练模型。</figcaption></figure><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es mj"><img src="../Images/7a3f8484b5e96d7e1d7065eafc9b7c75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1320/format:webp/1*D6419ezSz4i2OgRhpZwY5A.png"/></div><figcaption class="ko kp et er es kq kr bd b be z dx translated">图16:测试模型的准确性。</figcaption></figure><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es mk"><img src="../Images/0c1e052e0c305e526f415811cffbd91e.png" data-original-src="https://miro.medium.com/v2/resize:fit:852/format:webp/1*OhbavtHf4TbdXlhlUIlYGg.png"/></div><figcaption class="ko kp et er es kq kr bd b be z dx translated">图17:犬种预测的Inception V3模型的热图</figcaption></figure><p id="5262" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">所以，我们用<strong class="jf hj"> InceptionV3 </strong>网络来训练我们的模型。从上图可以明显看出，这是一个更好的热图，大部分预测沿着对角线。它产生了81.2%的<strong class="jf hj"/>的准确度和84%的<strong class="jf hj"/>的精确度。</p></div><div class="ab cl lh li gp lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="hb hc hd he hf"><h1 id="8f70" class="if ig hi bd ih ii lo ik il im lp io ip iq lq is it iu lr iw ix iy ls ja jb jc bi translated">最终算法:</h1><p id="c13f" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">我们已经建立了一个人脸检测器、一个狗检测器和一个狗品种分类器。接下来，我们必须将所有这些放入一个算法中，该算法将拍摄图像并预测狗的品种(如果是狗的话),如果是人的话，则预测最相似的品种。</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es ml"><img src="../Images/efaa48c7df439c12454dfe099713c9fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:994/format:webp/1*-q67-fv-DOxwKQJWyNhL8w.png"/></div><figcaption class="ko kp et er es kq kr bd b be z dx translated">图18:狗的品种预测</figcaption></figure><p id="022d" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">这里我们取softmax分类器预测的最大概率对应的指标，报为最终品种。此外，我们绘制了5个顶级犬种的图，以及它们对于给定输入图像的softmax概率。</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es ml"><img src="../Images/eb7ff0b31cc2e78c18f6574e8065e7c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:994/format:webp/1*epyJ1VLhpb9tPYoixHYrIg.png"/></div><figcaption class="ko kp et er es kq kr bd b be z dx translated">图19:最终算法。</figcaption></figure><p id="c3f2" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">上述函数获取一幅输入图像，如果图像是狗和人脸，则通过调用<strong class="jf hj"> final_breed_prediction </strong>方法来预测狗的品种/类似狗的品种。最后，它显示相应的信息。</p></div><div class="ab cl lh li gp lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="hb hc hd he hf"><h1 id="f6c6" class="if ig hi bd ih ii lo ik il im lp io ip iq lq is it iu lr iw ix iy ls ja jb jc bi translated">测试算法:</h1><p id="f87a" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">现在，我们进入了测试模型性能的最后一步。让我们尝试一些图片来验证这一点。</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es mm"><img src="../Images/fffe10334ac6d419dea53a144229452b.png" data-original-src="https://miro.medium.com/v2/resize:fit:986/format:webp/1*vHNzWq5ygA-SA2g9kExgAQ.png"/></div><figcaption class="ko kp et er es kq kr bd b be z dx translated">图20:样本人类图像_1</figcaption></figure><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es mn"><img src="../Images/7d65f855ca403564b1b535c653913506.png" data-original-src="https://miro.medium.com/v2/resize:fit:1022/format:webp/1*gglW09Fp2IdYkOKHDqFFIQ.png"/></div><figcaption class="ko kp et er es kq kr bd b be z dx translated">图21:阿富汗猎犬</figcaption></figure><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es mo"><img src="../Images/5902b6384c7d016c051360938e51ece8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1052/format:webp/1*2I-0PwCHfXUfaV9i4rOEGA.png"/></div><figcaption class="ko kp et er es kq kr bd b be z dx translated">图22:美国水猎犬</figcaption></figure><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es mp"><img src="../Images/0d96f7d3fbbb9bcf35c18d9820dbf9b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1058/format:webp/1*k00neA7ZhcqXb19r_v36tA.png"/></div><figcaption class="ko kp et er es kq kr bd b be z dx translated">图23:卷毛寻回犬</figcaption></figure><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es mq"><img src="../Images/e9e42b718636aae228f41fc5954690c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1082/format:webp/1*nddDqqh8mrAIjKxthD5t8A.png"/></div><figcaption class="ko kp et er es kq kr bd b be z dx translated">图24:样本人类图像_2</figcaption></figure><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es mr"><img src="../Images/430aef2f99b2ce3cc286d4a93a424dd9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1062/format:webp/1*H-RjUzYi4Oz7mV5qeJId3w.png"/></div><figcaption class="ko kp et er es kq kr bd b be z dx translated">图25:彭布罗克威尔士柯基犬</figcaption></figure><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es ms"><img src="../Images/27cf0df1c893a56890c3fac848ee64a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1048/format:webp/1*b2t_nwZPcbBS2d-eA9PmYg.png"/></div><figcaption class="ko kp et er es kq kr bd b be z dx translated">图26:拉布拉多猎犬。</figcaption></figure><p id="5770" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">这里，我们在5幅狗的图像和2幅人的图像上检查了我们的模型的预测。它准确地预测了所有5张狗图片的品种。然而，在人类图片的情况下，预测并不完全令人信服。</p></div><div class="ab cl lh li gp lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="hb hc hd he hf"><h1 id="ca57" class="if ig hi bd ih ii lo ik il im lp io ip iq lq is it iu lr iw ix iy ls ja jb jc bi translated">结论:</h1><p id="c81c" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">我们通过检测人脸和狗的图像开始了这个旅程。然后我们从头开始构建了一个CNN架构，由于我们讨论的原因，它甚至不能很好地执行。接下来，我们测试了基准模型<strong class="jf hj"> VGG16(准确率:45%) </strong>、<strong class="jf hj"> InceptionV3(准确率:82%)、</strong>和<strong class="jf hj"> Resnet50(准确率:81%) </strong>，通过对它们进行针对我们的训练数据提取的瓶颈特征的训练，它们在预测狗品种方面相当不错。</p><p id="4e3c" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">此外，我们还观察到，增加时期的数量并没有改善验证损失。因此，在<strong class="jf hj"> 20次迭代</strong>中，我们可以实现最好的验证损失和准确性。考虑到我们只有<strong class="jf hj"> 6680 </strong>幅训练图像，我们将<strong class="jf hj">的批量大小保持为20，</strong>并且在10的范围内增加或减少不会对我们的准确度产生太大影响。</p><p id="5f9e" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">在CNN架构的情况下，我们观察到增加太多的层不能提高精度。所以我们为我们的最终模型保留了1个全局平均池2d T21层和一个密集的软最大层。它产生了最好的准确性。</p><p id="74ad" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">然而，仍然有改进的余地。最近开发了各种其他先进的人脸检测方法，例如Mask-CNN，它可以降低我们在MTCNN的实现中观察到的<strong class="jf hj">假阳性率</strong>。通过增加训练数据可以使提取的瓶颈特征更加丰富。这不仅有助于增加训练数据，而且将创建更丰富的图像表示，这可能有助于提高准确性。</p><p id="6138" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">无论如何，这是你的犬种分类器，你可以在这里查看完整的实现<a class="ae ks" href="https://github.com/Piyush23Rai/Dog-Breed-Classifier" rel="noopener ugc nofollow" target="_blank"/>。请评论，你对上述策略有何感想，或者你是否找到了更好的策略。在那之前，继续做你可爱的胡曼吧！</p></div></div>    
</body>
</html>