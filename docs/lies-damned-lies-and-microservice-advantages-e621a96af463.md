# 谎言，可恶的谎言，微服务“优势”

> 原文：<https://medium.com/codex/lies-damned-lies-and-microservice-advantages-e621a96af463?source=collection_archive---------3----------------------->

![](img/574f5fd8f2d6c75de7ef26c0f3c3a6bc.png)

是的，是的，我知道，微服务都是炒作。但他们的说法符合现实吗？让我们做一些事实核查。

随便挑一篇不要脸的微服务宣传吧。考虑到已经存在的数量和每天发布的新数量，这并不难。例如，[这个](https://lalverma.medium.com/spring-boot-microservices-learning-through-examples-7b215ef511b8)会很好地服务于目的。它包含以下语句:

> ***微服务提供什么？***
> 
> *随着服务变得越来越小，好处会体现在多个方面*
> 
> 它最大的优点是提高了可维护性。每个服务都相对较小，因此更容易理解、修改和测试。
> 
> 因为每个服务都是独立的，所以您可以自由选择不同的技术栈来进行开发。这消除了对技术的任何长期承诺。
> 
> 由于服务较小，它们可以在相对较短的时间内独立测试。我们不需要等到所有其他模块都通过验证后，再将其推向下一个部署阶段。
> 
> 最好的产品之一是独立部署。这有助于通过持续部署加快交付。软件开发可以更好地组织成更小的自治团队。“小团队”是一个相对的术语。通常由 5-10 人组成。
> 
> 我们的应用程序在容错方面变得更加健壮。如果一个服务宕机，它不会导致其他服务宕机(就像 monolith 应用程序一样)。我们的应用程序仍将继续为其他请求提供更高的可用性。
> 
> 因为服务可以独立部署，所以我们可以根据流量扩大或缩小服务实例。这极大地提高了应用程序的整体可伸缩性和可用性。

下面我们就把这些说法一个一个来分析一下。

> 它最大的优点是提高了可维护性。每个服务都相对较小，因此更容易理解、修改和测试。

听起来合乎逻辑，但我们要记住，这与微服务本身没有什么关系。这是组织开发过程的问题。如果某个组织建立了一个开发过程，那么每个团队将独立地处理服务，但是最终的产品将作为一个整体来构建和部署，可维护性将是完全相同的。但是不会有微服务。哎呀！

> 由于服务较小，它们可以在相对较短的时间内独立测试。我们不需要等到所有其他模块都通过验证后，再将其推向下一个部署阶段。

这与上面的完全一样——这纯粹是一个组织流程的问题，与微服务无关。

> 最好的产品之一是独立部署。这有助于通过持续部署加快交付。软件开发可以更好地组织成更小的自治团队。

独立部署是一个大胆的主张。问题是，这只在少数情况下成立:只有当服务的新版本向后兼容旧版本时。同样，这不是特定于微服务的，例如，通过使用 OSGi 容器来部署服务(或任何其他方式来动态加载/卸载模块/类等),可以实现完全相同的目的。).与微服务不同，OSGi 甚至提供了内置的版本管理，并允许并行部署多个版本，这使得处理不同的场景(例如，在不兼容的服务版本之间过渡)变得更加简单。微服务没有现成的这种功能。

> 我们的应用程序在容错方面变得更加健壮。如果一个服务宕机，它不会导致其他服务宕机(就像 monolith 应用程序一样)。我们的应用程序仍将继续为其他请求提供更高的可用性。

这个经常被重复，也许是最有趣的一个。起初，关于巨石柱的说法是不真实的。应用程序如何处理服务故障是特定于特定实现的。它可能会完全失败或继续运行。通常，如果出现不可恢复的错误，正确设计的应用程序**必须**失败。这可以防止部分工作的应用程序丢失或损坏数据。但是，同样，这是一个设计决定，而不是一个整体的固有属性。出于某种原因，微服务的支持者宣称部分工作的系统“可用”，并声称这是一个优势！一个**部分**工作的系统，可能会损坏或丢失数据，被认为是“可用”的？听起来像是对“可用”一词的自由解释。

> 因为服务可以独立部署，所以我们可以根据流量扩大或缩小服务实例。这极大地提高了应用程序的整体可伸缩性和可用性。

谁决定只能通过*部署*更多实例来扩展服务？即使这对于大多数基于微服务的系统来说是正确的(毕竟，它们是这样设计的)，也有许多其他的扩展方法。例如，应用程序可能会在内部启动同一服务的多个实例。对于整体式解决方案来说，这听起来可能不那么吸引人，但是对于集群解决方案来说，这是一个非常好的方法。此外，集群可以更快地启动/停止服务，每个实例的资源消耗也将更低。有趣的是，如果需要，集群解决方案部署更多实例没有技术限制——这支持第二个维度的扩展。

但这只是关于如何添加实例。让我们进一步检查“可伸缩性和可用性”的说法。看来微服务只能通过启动更多的服务实例来扩展，包括所有相关的费用——多一个容器、多一个运行时、多一个实例来维护、监控、收集日志等。但是还有其他方法来扩展应用程序。例如，一个集群应用程序可以将任务分散到多个集群节点上。任务可以属于一个服务或不同的服务。另一种扩展策略(特别适用于数据网格)——跨包含相关数据的节点启动特定任务的几个实例(所谓的“数据关联”)，并有效地将远程数据访问转变为本地访问！所有这些技术都更加灵活、细粒度和可伸缩。但是微服务只能提出粗糙的、资源密集型的方案——“通过部署新实例来扩展”。
出于某种原因，技术低劣、不灵活、能力有限被标榜为微服务的“优势”。

*原载于 2021 年 7 月 29 日*[*https://dev . to*](https://dev.to/siy/lies-damned-lies-and-microservice-advantages-fko)*。*