<html>
<head>
<title>Implement Kafka Topics Joiner With Golang ğŸ”¥</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ç”¨Golangå®ç°Kafkaä¸»é¢˜JoinerğŸ”¥</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/codex/implement-kafka-topics-joiner-with-golang-f8a9c046fcbe?source=collection_archive---------1-----------------------#2022-09-12">https://medium.com/codex/implement-kafka-topics-joiner-with-golang-f8a9c046fcbe?source=collection_archive---------1-----------------------#2022-09-12</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="02fb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ä½ å¥½ã€‚ä»Šå¤©ï¼Œæˆ‘ä»¬å°†åœ¨Goä¸­æ„å»ºä¸€ä¸ªKafkaç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ã€‚æ³›å‹ï¼ŒGolangçš„ä¸€ä¸ªæ–°ç‰¹æ€§ï¼Œå°†å¯¹æˆ‘ä»¬æœ‰åˆ©ã€‚å½“åœ¨åŒä¸€ä¸Šä¸‹æ–‡ä¸­å¤„ç†å¤šç§ç±»å‹æ—¶ï¼Œæ³›å‹éå¸¸æœ‰ç”¨ã€‚</p><h1 id="23dc" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">å·¥å…·</h1><p id="a3f5" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">è®©æˆ‘ä»¬è¯„ä¼°ä¸€ä¸‹æˆ‘ä»¬çš„éœ€æ±‚ï¼› âœ¨</p><ul class=""><li id="89b7" class="kg kh hi ih b ii ij im in iq ki iu kj iy kk jc kl km kn ko bi translated"><em class="kp">ç å¤´å·¥äºº</em></li><li id="9c32" class="kg kh hi ih b ii kq im kr iq ks iu kt iy ku jc kl km kn ko bi translated"><em class="kp"> Golang 1.18æˆ–æ›´æ–°ç‰ˆæœ¬</em></li></ul><p id="6024" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æˆ‘ä»¬å¯ä»¥è®¾ç½®æˆ‘ä»¬çš„æ–‡ä»¶å¤¹å±‚æ¬¡ç»“æ„ï¼Œå¦‚ä¸‹æ‰€ç¤º:</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="98ca" class="le je hi la b fi lf lg l lh li">- producer<br/>  - producer.go<br/>  - main.go<br/>  - types.go<br/>- consumer<br/>  - main.go<br/>  - types.go<br/>  - connection.go<br/>main.go<br/>.gitignore<br/>config.yaml<br/>docker-compose.yaml</span></pre><p id="6548" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æˆ‘ä»¬å°†å»ºç«‹çš„ç³»ç»Ÿå¦‚ä¸‹:<a class="ae lj" href="https://emojipedia.org/person-lifting-weights/" rel="noopener ugc nofollow" target="_blank">ğŸ‹ï¸ </a></p><figure class="kv kw kx ky fd ll er es paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="er es lk"><img src="../Images/4776446c8bca75ba958ceac4fb5f2efa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*exBcB8vSysqTtpAfEf-9kw.png"/></div></div><figcaption class="ls lt et er es lu lv bd b be z dx translated">golang-Kafka-ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…-åŠ å…¥-ä¸»é¢˜</figcaption></figure><h1 id="39e1" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">å½’æ¡£</h1><p id="45f3" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated"><code class="du lw lx ly la b">docker-compose</code>æ–‡ä»¶åº”è¯¥æ˜¯è¿™æ ·çš„ã€‚å¯¹äºè¿™ä¸ªé¡¹ç›®ï¼Œæˆ‘ä»¬å°†Kowlã€Zookeeperå’ŒKafkaæ·»åŠ åˆ°<code class="du lw lx ly la b">docker-compose</code>æ–‡ä»¶ä¸­ã€‚</p><figure class="kv kw kx ky fd ll"><div class="bz dy l di"><div class="lz ma l"/></div></figure><p id="ddef" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æˆ‘ä»¬ç°åœ¨éœ€è¦ç”¨ä¸€äº›Kowlé…ç½®æ›´æ–°<code class="du lw lx ly la b">config.yaml</code>æ–‡ä»¶ï¼›</p><figure class="kv kw kx ky fd ll"><div class="bz dy l di"><div class="lz ma l"/></div><figcaption class="ls lt et er es lu lv bd b be z dx translated">ç”¨äºkowlçš„é…ç½®æ–‡ä»¶</figcaption></figure><p id="6f3a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">è¿è¡ŒDockerï¼Œåœ¨ä½ å–œæ¬¢çš„ä»»ä½•ç»ˆç«¯è¿›å…¥ä½ çš„é¡¹ç›®æ–‡ä»¶å¤¹ï¼›</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="d539" class="le je hi la b fi lf lg l lh li">docker compose up -d</span></pre><p id="95b1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">å‡ æ¬¡é‡å¯åï¼Œä¸€æ—¦å¡å¤«å¡å‡†å¤‡å¥½äº†ï¼ŒKowlå°±å¯ä»¥åœ¨<code class="du lw lx ly la b">localhost:8080</code>è®¿é—®ä»ªè¡¨ç›˜ã€‚</p><figure class="kv kw kx ky fd ll er es paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="er es mb"><img src="../Images/7c83530da21460f4910111dfb97765e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sUkqcH37jl9IabqtQF1ddw.png"/></div></div></figure><h1 id="9adc" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">ç¼–ç </h1><p id="b248" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">å¥½çš„ã€‚æˆ‘ä»¬å¯ä»¥å¼€å§‹ç¼–ç äº†ã€‚é¦–å…ˆï¼Œæœ‰ä¸¤ä¸ªæˆˆæœ—å¡å¤«å¡å›¾ä¹¦é¦†ã€‚<code class="du lw lx ly la b">segmentio/kafka-go</code>å’Œ<code class="du lw lx ly la b">confluent-kafka-go</code></p><p id="e850" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ä½ å¿…é¡»å®‰è£…Cç¼–è¯‘å™¨ï¼Œå› ä¸ºåˆæµä½¿ç”¨CGOã€‚SegmentIOä¸ä½¿ç”¨CGOï¼›è€Œæ˜¯å¯ä»¥ç›´æ¥ä½¿ç”¨Golangã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†æ¼”ç¤ºå¦‚ä½•ä½¿ç”¨è¿™ä¸¤ä¸ªåº“ã€‚</p><p id="6b48" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ä½ å¯ä»¥åœ¨ä¸»åˆ†æ”¯ä¸­æ‰¾åˆ°åˆæµç”Ÿäº§è€…ï¼Œæˆ‘åœ¨å¦ä¸€ä¸ªåˆ†æ”¯ä¸­æ·»åŠ äº†SegmentIOç”Ÿäº§è€…ï¼›</p><div class="mc md ez fb me mf"><a href="https://github.com/muhammedikinci/go-generics-with-kafka" rel="noopener  ugc nofollow" target="_blank"><div class="mg ab dw"><div class="mh ab mi cl cj mj"><h2 class="bd hj fi z dy mk ea eb ml ed ef hh bi translated">GitHub-muhammedikinci/go-generics-with-Kafka</h2><div class="mm l"><h3 class="bd b fi z dy mk ea eb ml ed ef dx translated">æ­¤æ—¶æ‚¨ä¸èƒ½æ‰§è¡Œè¯¥æ“ä½œã€‚æ‚¨å·²ä½¿ç”¨å¦ä¸€ä¸ªæ ‡ç­¾é¡µæˆ–çª—å£ç™»å½•ã€‚æ‚¨å·²åœ¨å¦ä¸€ä¸ªé€‰é¡¹å¡ä¸­æ³¨é”€ï¼Œæˆ–è€…â€¦</h3></div><div class="mn l"><p class="bd b fp z dy mk ea eb ml ed ef dx translated">github.com</p></div></div><div class="mo l"><div class="mp l mq mr ms mo mt lq mf"/></div></div></a></div><div class="mc md ez fb me mf"><a href="https://github.com/muhammedikinci/go-generics-with-kafka/tree/segmentio-producer" rel="noopener  ugc nofollow" target="_blank"><div class="mg ab dw"><div class="mh ab mi cl cj mj"><h2 class="bd hj fi z dy mk ea eb ml ed ef hh bi translated">GitHub-muhammedikinci/go-generics-with-Kafka at segment io-producer</h2><div class="mm l"><h3 class="bd b fi z dy mk ea eb ml ed ef dx translated">æ­¤æ—¶æ‚¨ä¸èƒ½æ‰§è¡Œè¯¥æ“ä½œã€‚æ‚¨å·²ä½¿ç”¨å¦ä¸€ä¸ªæ ‡ç­¾é¡µæˆ–çª—å£ç™»å½•ã€‚æ‚¨å·²åœ¨å¦ä¸€ä¸ªé€‰é¡¹å¡ä¸­æ³¨é”€ï¼Œæˆ–è€…â€¦</h3></div><div class="mn l"><p class="bd b fp z dy mk ea eb ml ed ef dx translated">github.com</p></div></div><div class="mo l"><div class="mu l mq mr ms mo mt lq mf"/></div></div></a></div><h2 id="471f" class="le je hi bd jf mv mw mx jj my mz na jn iq nb nc jr iu nd ne jv iy nf ng jz nh bi translated">ç”Ÿäº§è€…</h2><p id="b90f" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">å¯¼èˆªåˆ°produceræ–‡ä»¶å¤¹åï¼Œåœ¨ç»ˆç«¯ä¸­è¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼›</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="6c34" class="le je hi la b fi lf lg l lh li">cd producer<br/>go mod init producer<br/>get get github.com/segmentio/kafka-go</span></pre><p id="b269" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æˆ‘ä»¬å°†åœ¨äº§å“ã€ç±»åˆ«å’Œå½¢è±¡ä¹‹é—´å»ºç«‹è”ç³»ã€‚<code class="du lw lx ly la b">types.go</code>æ–‡ä»¶å¦‚ä¸‹æ‰€ç¤º:</p><figure class="kv kw kx ky fd ll"><div class="bz dy l di"><div class="lz ma l"/></div></figure><p id="dab8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">è®©æˆ‘ä»¬åˆ›å»ºæˆ‘ä»¬çš„ä¸»é¢˜å’Œæ•°æ®ã€‚æˆ‘ä»¬åœ¨è¿æ¥å¡å¤«å¡ï¼Œåˆ›é€ æˆ‘ä»¬éœ€è¦çš„ä¸»é¢˜ï¼›</p><figure class="kv kw kx ky fd ll"><div class="bz dy l di"><div class="lz ma l"/></div></figure><p id="96e4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ç°åœ¨æˆ‘ä»¬å¯ä»¥åˆ›å»ºç”Ÿäº§è€…å¯¹è±¡å¹¶åœ¨<code class="du lw lx ly la b">main.go</code>æ–‡ä»¶ä¸­ä½¿ç”¨å®ƒã€‚ç”Ÿäº§è€…å‘æˆ‘ä»¬çš„è¯é¢˜æ¨é€æ¶ˆæ¯ã€‚</p><figure class="kv kw kx ky fd ll"><div class="bz dy l di"><div class="lz ma l"/></div></figure><p id="ceb0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">å½“æˆ‘ä»¬è¿è¡Œç”Ÿäº§è€…æ—¶ï¼›</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="e9b6" class="le je hi la b fi lf lg l lh li">go run .</span></pre><p id="dde6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">å¡å¤«å¡ä¸­çš„ç»“æœä¸€å®šæ˜¯è¿™æ ·çš„:</p><figure class="kv kw kx ky fd ll er es paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="er es ni"><img src="../Images/753567bf14eb5f2391abf663c1f07403.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jRfeRnhwzc7sM7vKqLDp6g.png"/></div></div></figure><p id="562b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æˆ‘ä»¬å°†å¼€å§‹ä¸ºæ¶ˆè´¹è€…ç¼–ç ã€‚æˆ‘ä»¬å°†ä»æˆ‘ä»¬åˆ›å»ºçš„ä¸»é¢˜ä¸­æ¥æ”¶æ¶ˆæ¯ï¼Œç„¶åæˆ‘ä»¬å°†å°è¯•é€šè¿‡å°†å®ƒä»¬ä¸å®ƒä»¬çš„é”®ç›¸å…³è”æ¥åŠ å…¥æ¶ˆæ¯ã€‚æˆ‘è¿˜æƒ³ç›´è§‚åœ°å±•ç¤ºæˆ‘ä»¬æ­£åœ¨åšçš„äº‹æƒ…ã€‚</p><figure class="kv kw kx ky fd ll er es paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="er es nj"><img src="../Images/0c1f2fdf8c7899450da4927d7dadf60a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-cZ_EN7kBUpSnt8SIKLdRQ.png"/></div></div><figcaption class="ls lt et er es lu lv bd b be z dx translated">go-Kafka-join-tutorial-example-d B- structure</figcaption></figure><p id="b762" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æˆ‘ä»¬æœ‰äº§å“ã€å›¾ç‰‡å’Œç±»åˆ«è¡¨ã€‚åœ¨æˆ‘ä»¬çš„æ•°æ®åº“ç»“æ„ä¸­ï¼›ä¸€ä¸ªäº§å“å¯ä»¥æœ‰å¤šå¼ ç…§ç‰‡ã€‚ä½†æ˜¯ï¼Œä¸€ä¸ªäº§å“åªèƒ½æœ‰ä¸€ä¸ªç±»åˆ«ã€‚</p><h2 id="2a18" class="le je hi bd jf mv mw mx jj my mz na jn iq nb nc jr iu nd ne jv iy nf ng jz nh bi translated">æ¶ˆè´¹è€…</h2><p id="ee0a" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">è®©æˆ‘ä»¬å¼€å§‹åˆ›é€ æ¶ˆè´¹è€…å§ï¼</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="4f5d" class="le je hi la b fi lf lg l lh li">cd consumer<br/>go mod init consumer<br/>get get github.com/segmentio/kafka-go</span></pre><p id="4789" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">åœ¨æ¶ˆè´¹è€…ä¸­ï¼Œæˆ‘ä»¬æœ‰ç›¸åŒçš„<code class="du lw lx ly la b">types.go</code>æ–‡ä»¶ã€‚å¯ä»¥ä»åˆ¶ä½œæ–¹å¤åˆ¶&amp;ç²˜è´´è¿‡æ¥ã€‚</p><p id="78b2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æˆ‘åœ¨<code class="du lw lx ly la b">connection.go</code>æ–‡ä»¶ä¸­ç”¨å¦‚ä¸‹çš„æ³›å‹åˆ›å»ºäº†ä¸€ä¸ªæ¶ˆè´¹è€…ç»“æ„</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="08c4" class="le je hi la b fi lf lg l lh li">type Consumer[T comparable] struct {<br/>  reader *kafka.Reader<br/>  dialer *kafka.Dialer<br/>  topic  string<br/>}</span></pre><p id="b94f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æˆ‘ä¸ºæ¶ˆè´¹è€…æ”¾ç½®äº†åä¸ºCreateConnectionçš„æ¥æ”¶å™¨å‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°è¿æ¥åˆ°Kafkaå¹¶è¿”å›ç»™æˆ‘ä»¬readerå¯¹è±¡ã€‚</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="e9ed" class="le je hi la b fi lf lg l lh li">func (c *Consumer[T]) CreateConnection() {<br/>  c.reader = kafka.NewReader(kafka.ReaderConfig{<br/>    Brokers:   []string{"localhost:9092"},<br/>    Topic:     c.topic,<br/>    Partition: 0,<br/>    MinBytes:  10e3, // 10KB<br/>    MaxBytes:  10e6, // 10MB<br/>    MaxWait:   time.Millisecond * 10,<br/>    Dialer:    c.dialer,<br/>  })<br/>  c.reader.SetOffset(0)<br/>}</span></pre><p id="4cdd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æˆ‘åˆ›å»ºäº†å¦ä¸€ä¸ªåä¸ºReadçš„æ¥æ”¶å‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°æœ‰ä¸¤ä¸ªå‚æ•°:</p><ul class=""><li id="6453" class="kg kh hi ih b ii ij im in iq ki iu kj iy kk jc kl km kn ko bi translated">æ¨¡å‹â€”æˆ‘ä»¬çš„æ¡Œå­</li><li id="4b0a" class="kg kh hi ih b ii kq im kr iq ks iu kt iy ku jc kl km kn ko bi translated">å›è°ƒâ€”æˆ‘ä»¬å°†å¦ä¸€ä¸ªè¡¨è¿›ç¨‹ä¼ é€’åˆ°è¿™é‡Œï¼Œç”¨äºåˆå¹¶è¡¨</li></ul><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="2dc8" class="le je hi la b fi lf lg l lh li">func (c *Consumer[T]) Read(model T, callback func(T, error)) {<br/>  for {<br/>    ctx, _ := context.WithTimeout(context.Background(), time.Millisecond*80)<br/>    message, err := c.reader.ReadMessage(ctx)</span><span id="bf80" class="le je hi la b fi nk lg l lh li"><br/>    if err != nil {<br/>      callback(model, err)<br/>      return<br/>    }</span><span id="dc32" class="le je hi la b fi nk lg l lh li">    err = json.Unmarshal(message.Value, &amp;model)<br/>    if err != nil {<br/>      callback(model, err)<br/>      continue<br/>    }<br/>    callback(model, nil)<br/>  }<br/>}</span></pre><p id="e5bf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æˆ‘ä»¬åœ¨å¯»æ‰¾æ–°çš„ä¿¡æ¯ï¼Œç›´åˆ°å¡å¤«å¡çš„è¯­å¢ƒç»“æŸã€‚å½“æ²¡æœ‰æ”¶åˆ°ä»»ä½•æ¶ˆæ¯æ—¶ï¼Œä¸Šä¸‹æ–‡å°†åœ¨80æ¯«ç§’åè¢«ç»ˆæ­¢ã€‚</p><p id="6a86" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æˆ‘ä»¬æ­£åœ¨æ‰“å¼€<code class="du lw lx ly la b">main.go</code>æ–‡ä»¶ï¼Œåˆ›é€ æ¶ˆè´¹è€…è¿æ¥ã€‚</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="9675" class="le je hi la b fi lf lg l lh li">dialer := &amp;kafka.Dialer{<br/>  Timeout:   10 * time.Second,<br/>  DualStack: true,<br/>}</span><span id="52e6" class="le je hi la b fi nk lg l lh li">productConsumer := Consumer[Product]{<br/>  dialer: dialer,<br/>  topic:  "producer-product-table-testing",<br/>}<br/>productConsumer.CreateConnection()</span><span id="a467" class="le je hi la b fi nk lg l lh li">imageConsumer := Consumer[Image]{<br/>  dialer: dialer,<br/>  topic:  "producer-image-table-testing",<br/>}<br/>imageConsumer.CreateConnection()</span><span id="b2e4" class="le je hi la b fi nk lg l lh li">categoryConsumer := Consumer[Category]{<br/>  dialer: dialer,<br/>  topic:  "producer-category-table-testing",<br/>}<br/>categoryConsumer.CreateConnection()</span></pre><p id="6f35" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ç°åœ¨æˆ‘ä»¬å¼€å§‹åœ¨è¿™é‡Œåˆå¹¶æˆ‘ä»¬çš„è¡¨ã€‚æˆ‘å¼€å§‹é˜…è¯»å¡å¤«å¡çš„ä½œå“ï¼›</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="a8d6" class="le je hi la b fi lf lg l lh li">productConsumer.Read(Product{}, func(product Product, err error) {<br/>  collectedProduct := CollectedProduct{<br/>    ID:            product.ID,<br/>    Name:          product.Name,<br/>    Price:         product.Price,<br/>    OriginalPrice: product.OriginalPrice,<br/>    Images:        []string{},<br/>  }</span></pre><p id="aaef" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">åœ¨ç¬¬ä¸€ä¸ªå‚æ•°ä¸­ï¼Œæˆ‘è¯´æˆ‘æƒ³è·å¾—äº§å“å‹å·å’Œå›è°ƒå‚æ•°ï¼Œreadå‡½æ•°å‘æˆ‘ä»¬å‘é€äº§å“æ•°æ®å’Œé”™è¯¯(å¦‚æœæ˜¯)</p><p id="0cd5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">åœ¨å›è°ƒå‡½æ•°ä¸­ï¼Œè¿™ä¸€æ¬¡æˆ‘å¼€å§‹è¯»å–å›¾åƒï¼Œä¹Ÿå¼€å§‹åŠ å…¥ã€‚æˆ‘ä»¬æŠŠæ¥è‡ªå¡å¤«å¡çš„å›¾åƒæ”¾å…¥äº§å“å¯¹è±¡ä¸­</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="b981" class="le je hi la b fi lf lg l lh li">imageConsumer.Read(Image{}, func(image Image, err error) {<br/>  if product.ID == image.ProductID {<br/>    collectedProduct.Images = append(<br/>      collectedProduct.Images, image.URL,<br/>    )<br/>  }<br/>})</span></pre><p id="cad1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æˆ‘ä»¬çš„ä¸»æ–‡ä»¶æœ€åçœ‹èµ·æ¥å¦‚ä¸‹</p><figure class="kv kw kx ky fd ll"><div class="bz dy l di"><div class="lz ma l"/></div></figure><h2 id="f75a" class="le je hi bd jf mv mw mx jj my mz na jn iq nb nc jr iu nd ne jv iy nf ng jz nh bi translated">ç»“æœ</h2><p id="bc1f" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">å¦‚æœæˆ‘ä»¬è¿è¡Œæ¶ˆè´¹è€…ï¼Œç»“æœå°†æ˜¯è¿™æ ·çš„:</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="3b64" class="le je hi la b fi lf lg l lh li">{0 product1 23 34  [<a class="ae lj" href="http://google.com/image1.jpg" rel="noopener ugc nofollow" target="_blank">http://google.com/image1.jpg</a> <a class="ae lj" href="http://google.com/image2.jpg" rel="noopener ugc nofollow" target="_blank">http://google.com/image2.jpg</a>]}<br/>{2 product2 23 34 Category1 [<a class="ae lj" href="http://google.com/image4.jpg" rel="noopener ugc nofollow" target="_blank">http://google.com/image4.jpg</a>]}<br/>{3 product3 23 34 Category3 [<a class="ae lj" href="http://google.com/image5.jpg" rel="noopener ugc nofollow" target="_blank">http://google.com/image5.jpg</a> <a class="ae lj" href="http://google.com/image6.jpg" rel="noopener ugc nofollow" target="_blank">http://google.com/image6.jpg</a> <a class="ae lj" href="http://google.com/image6.jpg" rel="noopener ugc nofollow" target="_blank">http://google.com/image6.jpg</a>]}<br/>{4 product4 23 34 Category1 []}<br/>{5 product5 23 34 Category2 []}<br/>{5 product5 23 34 Category2 []}</span></pre><p id="72e8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æ­£å¦‚ä½ æ‰€çœ‹åˆ°çš„ï¼Œæˆ‘ä»¬åœ¨æ¯ä¸ªå¾ªç¯ä¸­å°†å›¾ç‰‡å’Œåˆ†ç±»ä¸»é¢˜çš„åç§»é‡è®¾ç½®ä¸º0ã€‚è¿™æ„å‘³ç€æ¯ä¸ªäº§å“å¾ªç¯å›¾åƒå’Œç±»åˆ«ä¸»é¢˜éƒ½è¦ä»å¤´å¼€å§‹ã€‚å¦‚æœä¸å¸Œæœ›è¿™æ ·ï¼Œå¯ä»¥ä¸ºæ—§çš„ä¼ é€’æ¶ˆæ¯åˆ›å»ºä¸€ä¸ªç¼“å­˜æœºåˆ¶ã€‚</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="e34b" class="le je hi la b fi lf lg l lh li">imageConsumer.reader.SetOffset(0)<br/>categoryConsumer.reader.SetOffset(0)</span></pre><p id="d384" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æˆ‘ä¸çŸ¥é“è¿™ç§æ–¹å¼æœ‰å¤šé«˜æ•ˆã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘åªå…³æ³¨åˆ›å»ºä¸€ä¸ªä¸»é¢˜åŠ å…¥è€…ç³»ç»Ÿã€‚å¦‚æœä½ æƒ³è¦æ›´å¤šçš„å·¥å…·å’Œæ•ˆç‡ï¼Œæœ€å¥½çš„é€‰æ‹©æ˜¯Kafkaå’ŒJava</p><p id="b5e0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æ„Ÿè°¢é˜…è¯»ï¼ğŸ‘‹</p></div></div>    
</body>
</html>