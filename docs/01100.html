<html>
<head>
<title>Selenium4: A Peek into Chrome DevTools</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">硒元素Chrome开发工具一瞥</h1>
<blockquote>原文：<a href="https://medium.com/codex/selenium4-a-peek-into-chrome-devtools-92bca6de55e0?source=collection_archive---------2-----------------------#2021-04-04">https://medium.com/codex/selenium4-a-peek-into-chrome-devtools-92bca6de55e0?source=collection_archive---------2-----------------------#2021-04-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/2fcf29727d293604f72508a5654fa57e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*WF392hzc4n8LzEGX"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">沙哈达特·拉赫曼在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="9895" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Selenium 4增加了对<a class="ae iu" href="https://chromedevtools.github.io/devtools-protocol/" rel="noopener ugc nofollow" target="_blank">Chrome DevTools API</a>的原生支持。有了这些新的API，我们现在可以监控和拦截HTTP请求和HTTP响应、模拟网络速度、基本身份验证、验证和清除应用程序cookies和缓存、访问控制台日志和性能指标，等等。</p><p id="b5f8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在开始测试之前，我们将初始化devtools会话和webdriver</p><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="jx jy l"/></div></figure><h1 id="4bfd" class="jz ka hi bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated"><strong class="ak"> <em class="kx">监控HTTP请求</em> </strong></h1><p id="3f13" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">为了监视请求，我们需要将事件Network.requestWillBeSent传递给侦听器。当页面将要发送HTTP请求时，将触发此事件。</p><p id="07c0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这之后，我们使用一个监听器监听发送的各种HTTP请求，它们的请求头、post主体、URL等。</p><p id="9166" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们来看一些示例代码:</p><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="jx jy l"/></div></figure><h1 id="be53" class="jz ka hi bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated"><strong class="ak">拦截HTTP响应</strong></h1><p id="fcd7" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">在拦截响应之前，我们将使用Network.responseReceived event。当HTTP响应可用时触发，这样我们就可以监听URL、响应头、响应代码等。要获得响应体，请使用Network.getResponseBody方法</p><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="jx jy l"/></div></figure><h1 id="acdc" class="jz ka hi bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated"><strong class="ak">仿真网络速度</strong></h1><p id="ab45" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">许多人使用手持设备上的web应用程序，如连接到wifi或蜂窝网络的iPads、手机。在不同的网络速度下测试应用程序是很重要的。</p><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="jx jy l"/></div></figure><h1 id="2192" class="jz ka hi bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">注册基本授权</h1><p id="1070" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">使用devtools，我们现在可以直接处理认证，为此我们需要使用方法<a class="ae iu" href="https://chromedevtools.github.io/devtools-protocol/tot/Network/#method-setExtraHTTPHeaders" rel="noopener ugc nofollow" target="_blank">network . setextrahttpheaders</a>。</p><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="jx jy l"/></div></figure><h1 id="95aa" class="jz ka hi bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated"><strong class="ak">阻止网址</strong></h1><p id="0627" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">我们可以在网页加载时阻止某些URL的加载。</p><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="jx jy l"/></div></figure><h1 id="22d5" class="jz ka hi bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">验证Cookies</h1><p id="278f" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">有了chrome开发工具API，我们可以玩浏览器cookies。我们可以清除浏览器cookie，删除所有cookie，获取和设置cookie或cookie。</p><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="jx jy l"/></div></figure><p id="8e31" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">还有其他方法也适用于cookies:</p><ol class=""><li id="655b" class="ld le hi ix b iy iz jc jd jg lf jk lg jo lh js li lj lk ll bi translated"><a class="ae iu" href="https://chromedevtools.github.io/devtools-protocol/tot/Network/#method-deleteCookies" rel="noopener ugc nofollow" target="_blank"> Network.deleteCookies </a>:删除具有匹配名称和URL或域/路径对的浏览器cookies。</li><li id="3260" class="ld le hi ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated"><a class="ae iu" href="https://chromedevtools.github.io/devtools-protocol/tot/Network/#method-getCookies" rel="noopener ugc nofollow" target="_blank"> Network.getCookies </a>:返回当前URL的所有浏览器cookies。根据后端支持，将在cookie字段中返回详细的cookie信息。</li><li id="a1b5" class="ld le hi ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated"><a class="ae iu" href="https://chromedevtools.github.io/devtools-protocol/tot/Network/#method-setCookie" rel="noopener ugc nofollow" target="_blank"> Network.setCookie </a>:用给定的Cookie数据设置一个cookie。</li><li id="9d12" class="ld le hi ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated"><a class="ae iu" href="https://chromedevtools.github.io/devtools-protocol/tot/Network/#method-setCookies" rel="noopener ugc nofollow" target="_blank"> Network.setCookies </a>:设置给定的cookies。</li></ol><h1 id="c2ba" class="jz ka hi bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated"><strong class="ak">覆盖用户代理</strong></h1><p id="c93f" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">有时，我们想测试移动网络应用，这就是用户代理发挥作用的地方。我们可以通过提供移动用户代理将我们的浏览器改为移动浏览器。</p><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="jx jy l"/></div></figure><h1 id="010b" class="jz ka hi bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">加载不安全的网站</h1><p id="7f89" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">使用DevTools，我们可以忽略SSL安全警告。</p><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="jx jy l"/></div></figure><h1 id="0afb" class="jz ka hi bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated"><strong class="ak">捕获控制台日志</strong></h1><p id="846d" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">当应用程序打开时，应用程序发布的控制台错误日志被捕获。</p><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="jx jy l"/></div></figure><h1 id="5df3" class="jz ka hi bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated"><strong class="ak">模拟设备尺寸</strong></h1><p id="828b" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">Web应用程序是为各种平台和设备构建的，如各种尺寸的手机、平板电脑和笔记本电脑。作为测试人员，我们应该在不同的维度上检查应用程序的响应性。</p><p id="1a0c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们可以使用方法emulation . setdevicemetricoverride并将其传递给devTools.send()。该方法需要12个参数，其中4个是强制的，8个是可选的。通过使用executeCdpCommand()，我们可以传递4个强制参数，忽略8个可选参数。</p><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="jx jy l"/></div></figure><h1 id="4537" class="jz ka hi bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">模拟地理位置</h1><p id="f6cb" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">在很多情况下，我们需要测试某些基于位置的功能，比如优惠、基于位置的价格等。对于这些，我们可以使用DevTools API模拟位置。</p><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="jx jy l"/></div></figure><h1 id="9f6b" class="jz ka hi bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">性能指标</h1><p id="1318" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">使用DevTools，我们可以在运行自动化测试的同时获得性能指标。</p><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="jx jy l"/></div></figure><p id="908f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这只是几个例子，Chrome DevTools API提供了更多的工具来增强自动化测试。</p><p id="30ba" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="lr">继续探索！！！</em></p><p id="f661" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="lr">完整项目和更多样本测试可以在我的</em><a class="ae iu" href="https://github.com/attrideepak/selenium-web-automation" rel="noopener ugc nofollow" target="_blank"><em class="lr">github</em></a><em class="lr">上找到。</em></p></div></div>    
</body>
</html>