<html>
<head>
<title>Elo Merchant Category Recommendation-Understand Customer Loyalty</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Elo商户类别推荐-了解客户忠诚度</h1>
<blockquote>原文：<a href="https://medium.com/codex/elo-merchant-category-recommendation-understand-customer-loyalty-f952438e6d17?source=collection_archive---------4-----------------------#2021-02-13">https://medium.com/codex/elo-merchant-category-recommendation-understand-customer-loyalty-f952438e6d17?source=collection_archive---------4-----------------------#2021-02-13</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="50d2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">作者</strong> : <a class="ae jd" href="https://www.linkedin.com/in/praveen-jalaja" rel="noopener ugc nofollow" target="_blank">普拉文·贾拉贾</a></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/ab6758f5d2fb67134a14f29480a287bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j7VK1nA4si1DkIQ5_6hgKw.jpeg"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">信用:<a class="ae jd" href="https://www.google.com/url?sa=i&amp;url=https%3A%2F%2Fkumodot.com%2Fprojects%2FBdq44&amp;psig=AOvVaw1WL26v-guuOlM0ZQ4w-X0y&amp;ust=1613217622115000&amp;source=images&amp;cd=vfe&amp;ved=0CAMQjB1qFwoTCMie9pGm5O4CFQAAAAAdAAAAABAD" rel="noopener ugc nofollow" target="_blank">马塞洛索萨</a></figcaption></figure><p id="bbe6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了更好地了解机器学习世界，建立一个模型将比阅读和在线浏览视频更有帮助。实践是衡量对机器学习概念及其正确应用的理解所必需的。同样，这也是为了更好地了解ML world而进行的动手案例研究之一。因为，这里讨论的案例研究是Kaggle competition Elo商家类别推荐。</p><h2 id="bfa0" class="ju jv hi bd jw jx jy jz ka kb kc kd ke iq kf kg kh iu ki kj kk iy kl km kn ko bi translated">介绍</h2><p id="185e" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">Elo商家分类推荐是一个由Elo提供的Kaggle竞赛。它是巴西最大的支付品牌之一，向客户提供借记卡和信用卡。作为一个支付品牌，为商家提供优惠促销和折扣是一个很好的营销策略。持卡人可以使用各种商家的促销折扣。作为支付品牌，Elo希望通过促销为持卡人提供个性化体验。通过基于用户的支付行为在不同的商家上向用户提供促销，可以增加和丰富用户体验并吸引消费者。</p><p id="d6f7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">两年前，Elo举办了Kaggle竞赛，让参赛者建立一个个性化促销和折扣的解决方案。Elo已经建立了ML模型来理解其他方面，如顾客的食物和购物。这一竞争是为了专门构建模型，该模型可用于发现客户对品牌的忠诚度，以个性化折扣和促销活动。</p><h2 id="3875" class="ju jv hi bd jw jx jy jz ka kb kc kd ke iq kf kg kh iu ki kj kk iy kl km kn ko bi translated"><strong class="ak">概述:</strong></h2><p id="77af" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">关于Elo类别建议的案例研究是通过遵循以下步骤流程完成的:</p><ol class=""><li id="942b" class="ku kv hi ih b ii ij im in iq kw iu kx iy ky jc kz la lb lc bi translated">定义业务问题</li><li id="befe" class="ku kv hi ih b ii ld im le iq lf iu lg iy lh jc kz la lb lc bi translated">机器学习问题公式</li><li id="8500" class="ku kv hi ih b ii ld im le iq lf iu lg iy lh jc kz la lb lc bi translated">探索性数据分析</li><li id="9004" class="ku kv hi ih b ii ld im le iq lf iu lg iy lh jc kz la lb lc bi translated">数据清理</li><li id="53f3" class="ku kv hi ih b ii ld im le iq lf iu lg iy lh jc kz la lb lc bi translated">特征工程</li><li id="657a" class="ku kv hi ih b ii ld im le iq lf iu lg iy lh jc kz la lb lc bi translated">工程特征的探索</li><li id="efa3" class="ku kv hi ih b ii ld im le iq lf iu lg iy lh jc kz la lb lc bi translated">模型结构</li><li id="fa01" class="ku kv hi ih b ii ld im le iq lf iu lg iy lh jc kz la lb lc bi translated">结论。</li></ol></div><div class="ab cl li lj gp lk" role="separator"><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln"/></div><div class="hb hc hd he hf"><h2 id="97b5" class="ju jv hi bd jw jx jy jz ka kb kc kd ke iq kf kg kh iu ki kj kk iy kl km kn ko bi translated">定义业务问题</h2><p id="e900" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">Elo作为一个支付品牌，需要让他们的客户使用他们提供的卡在不同的地方进行支付。所以，换句话说，顾客对品牌的忠诚度是关键。Elo需要留住对品牌有高度忠诚度的客户。这可以通过针对他们的不同促销活动目标来实现。持有Elo支付卡的客户可能有数百万，但该活动必须针对他们，基于他们对Elo品牌的忠诚度。</p><p id="6996" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">例如，一个客户在不同的商户长期使用Elo卡，用户的忠诚度很高。因此，为了留住客户，Elo可以对客户最喜欢或经常使用的商家开展折扣活动。在很大程度上，这些忠诚的客户得到了折扣，并在未来的购买中继续付款。这种个性化带来了许多新客户，并保持了现有的客户。</p><p id="f4de" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">问题是要找到一个能反映持卡人对Elo支付品牌忠诚度的指标。所以，Elo用它来做促销活动的商业决策。因此，Elo可以减少不必要的活动，并专注于需要的区域。</p><h2 id="cd07" class="ju jv hi bd jw jx jy jz ka kb kc kd ke iq kf kg kh iu ki kj kk iy kl km kn ko bi translated">机器学习问题公式</h2><p id="c8b7" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">在机器学习方面，我们需要一个度量来衡量客户的忠诚度。忠诚度得分是Elo品牌给出的一个衡量指标，用于衡量客户对Elo品牌的忠诚度。这些忠诚度得分取决于客户的许多方面。购买历史、使用时间、商家的多样性等。忠诚度得分可以从顾客购买和使用的信息中预测出来。从顾客的购买数据中预测忠诚度得分是我们问题的症结所在。忠诚度得分是应该建立机器学习模型来预测的目标变量。</p><p id="ce9c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">目标变量—忠诚度得分</p><p id="d58d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">输入特征—持卡人的购买历史、使用时间等。</p><p id="3712" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">限制是所提供的数据不是真实的客户数据。由于客户的隐私和法律限制，所提供的数据是虚构和模拟的数据。模拟数据有时会存在人为引起的偏差，这会影响预测模型的性能。识别偏差并在最终模型中加以说明也是解决问题的一部分。</p><h2 id="e882" class="ju jv hi bd jw jx jy jz ka kb kc kd ke iq kf kg kh iu ki kj kk iy kl km kn ko bi translated">探索性数据分析</h2><p id="5fa6" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated"><a class="ae jd" href="https://www.kaggle.com/c/elo-merchant-category-recommendation/data?select=train.csv" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> train.csv </strong> </a> —该csv文件包含客户订购Elo卡的基本信息。train.csv中有六个变量。目标变量(忠诚度得分)用于训练该文件中给出的模型。</p><p id="5a24" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jd" href="https://www.kaggle.com/c/elo-merchant-category-recommendation/data?select=test.csv" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> test.csv </strong> </a> —这是我们测试最终模型的测试数据。除了目标变量之外，它具有与train.csv相同的所有列。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es lp"><img src="../Images/b1659a0b7b5b0fe5b1ac2c5a986be20d.png" data-original-src="https://miro.medium.com/v2/resize:fit:796/format:webp/1*2ULRRZmzt6IZgjWmWnuvjQ.jpeg"/></div><figcaption class="jq jr et er es js jt bd b be z dx translated">train.csv</figcaption></figure><p id="2231" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">训练数据具有目标值，其简单的PDF显示其具有-30左右的异常值，并以平均值0标准化。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lq"><img src="../Images/b3edc9f223b8d8796bbe53cad704b6d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AmIMywW7oOufJjEE_y8eVA.jpeg"/></div></div></figure><p id="40ac" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">目标相对于匿名化特征的类别(特征_1、特征_2、特征_3)的分布互不不同。这表明，在这三个匿名化特征中，目标值对于不同的类别是不偏斜的。我们需要深入挖掘，以建立<strong class="ih hj"> card_id </strong>和目标值之间的关系。并且，目标变量(忠诚度得分)的行为类似于关于<strong class="ih hj"> first_active_month </strong>的阻尼频率图。该卡在2012年至2015年期间活跃，有较大的峰值和谷值，但在2015年之后，目标变为线性并呈上升趋势。这可能是由于在两个时间段之间用卡进行的交易类型不同。</p><p id="64b7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因为，训练和测试的分布几乎相同。因此，在数据转换中没有基于时间的分割。并且，它保证了对测试数据的预测。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es lr"><img src="../Images/57780001402daaa50b75e06953310466.png" data-original-src="https://miro.medium.com/v2/resize:fit:518/format:webp/1*T9bNQD77g_vkEoMaMPepuA.jpeg"/></div></figure><p id="e083" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所有这三个特征的VIF值都远低于10。所以训练数据不存在多重共线性的问题。</p><p id="d663" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jd" href="https://www.kaggle.com/c/elo-merchant-category-recommendation/data?select=historical_transactions.csv" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj">historical _ transactions . csv</strong></a>—这个CSV文件包含14个不同的变量，这些变量与每个客户的交易有关。</p><p id="8966" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">New _ merchants _ transactions . CSV</strong>—它具有与historical_transactions.csv相同的一组列变量，但记录在不同的时间范围内。这包含计算忠诚度积分之前的交易信息。这是客户交易的最新信息。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es ls"><img src="../Images/951b1410d45cc6853b8bfe524819077d.png" data-original-src="https://miro.medium.com/v2/resize:fit:992/format:webp/1*CY7_-luo6mH6pgjPaI9Jyw.jpeg"/></div><figcaption class="jq jr et er es js jt bd b be z dx translated">historical_transactions.csv</figcaption></figure><p id="98a4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">历史和新商户交易数据特征，如类别_1、类别_2、类别_3、分期付款和月份延迟，在相对于目标值的分布上几乎没有差异。而且，没有透露任何关于目标变量与卡片关系的细节。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lt"><img src="../Images/08b23e0cb59b4052034989b07bb13bb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*njDxGBvLr6Ebu5NgS-IuLA.jpeg"/></div></div></figure><p id="7c24" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">关于新商户交易数据的一个重要特征是，其中没有未授权的交易，所有交易的<strong class="ih hj">授权标志</strong>为真。此外，来自交易数据的另一个重要信息是，购买金额被归一化并添加了恒定噪声。因为，它操纵数据识别的操纵技术可以帮助建模。并且在<strong class="ih hj">购买金额</strong>上，历史交易比新商户交易具有更少的异常值，这再次证明交易类型在某些方面是不同的。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lu"><img src="../Images/83d5de979f03f30884017e093e43f0c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*poX0wmhKEd3XnlHUBaXi7A.jpeg"/></div></div></figure><p id="ffd7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">并且，购买日期特征可以揭示交易的固有属性，并且交易是时间相关的，由此设计的特征将在预测中有用。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lv"><img src="../Images/e389bf51d2fa26273a2962061a1c6551.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7EpRdAc24CHUUA-Sd-lH4A.jpeg"/></div></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lw"><img src="../Images/d62e8d42bd29de55bfb2669001e82962.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VJrHZHvogCZHF3a4aSZleQ.jpeg"/></div></div></figure><p id="c045" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上面两个图显示了一周和一小时内购买次数的趋势。我们可以清楚地看到这种模式，工作日的交易量在一周中不断增加，而在周日有所下降。而且，下午到晚上的时间有更高的交易量。而且，一个重要的信息来自交易的时刻，在一天的零时有巨大的峰值。而且，大多数在线零售商的订购交易都发生在一天的最后时刻。这意味着交易不仅有直接卡支付，也有订阅类的在线交易。</p><p id="2b4b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在商户、历史和新商户交易中有许多缺失值，因此必须以直观/有效的方式估算这些缺失值，以便更好地预测。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es lx"><img src="../Images/b92e6c2b22a575cdeb979703390c1620.png" data-original-src="https://miro.medium.com/v2/resize:fit:696/format:webp/1*GiDgf_wdFltPhycK5V0MjQ.jpeg"/></div></figure><p id="eee0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">授权标志的值稍高一些，大约为32，这表明可能存在相关性。所以这个变量需要进一步调查。除了授权标志之外，其余变量看起来并不相关。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ly"><img src="../Images/590efda7007e01e814598420fea3d164.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A0wSn2Ae2Sc87_h-SzYZkw.jpeg"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">招商. csv</figcaption></figure><p id="e18a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从对商家数据的探索中，其具有更多关于商家的数据，这些数据似乎对目标值的预测没有帮助，并且增加了问题的复杂性，因此在本研究中，没有以任何方式使用商家数据来构建模型。</p><p id="ee65" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在对交易、商家和列车数据的探索结束时，交易的给定特征对于目标分数的计算不是大的因素。存在有助于预测目标分数的一个或多个聚集的或设计的特征。利用不同的特征工程技术和市场研究技术，我们必须产生新的特征，这些特征在预测模型中可能非常有用，也可能不太有用。通过实现主要的特征工程思想，我们必须产生特征并在此基础上建立模型。</p><h2 id="5acd" class="ju jv hi bd jw jx jy jz ka kb kc kd ke iq kf kg kh iu ki kj kk iy kl km kn ko bi translated">数据清理</h2><p id="a16d" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">在进入特性工程之前，EDA的一个重要发现是数据文件中存在空值。空值必须在特征工程之前输入。有许多方法可以估算空值。这里，空值的插补是通过基于特征和其他特征的非空值构建的模型来完成的，以预测空值。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="lz ma l"/></div></figure><h2 id="1e3c" class="ju jv hi bd jw jx jy jz ka kb kc kd ke iq kf kg kh iu ki kj kk iy kl km kn ko bi translated">特征工程</h2><p id="d4f4" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated"><strong class="ih hj">一次热编码- </strong>交易数据中的分类特征(类别_3、类别_2、月份滞后)在这些特征的工程特征之前进行一次热编码。</p><p id="6874" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">取消购买金额的匿名化- </strong>正如我们在EDA中所讨论的，购买金额特征通过均值居中和缩放来实现匿名化。借助<a class="ae jd" href="https://www.kaggle.com/raddar" rel="noopener ugc nofollow" target="_blank"> raddar </a>对<a class="ae jd" href="https://www.kaggle.com/raddar/towards-de-anonymizing-the-data-some-insights" rel="noopener ugc nofollow" target="_blank">内核</a>的洞察，购买金额通过除以0.00150265118加497.06去匿名化。</p><p id="acdd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">聚合- </strong>在事务数据中，数据中有数字和类别特征。计算交易数据特征的基本统计数字，如唯一值、平均值、最大值、最小值、总和、标准偏差和偏斜的数量，以便为每个特征上的每个卡id生成单个值。</p><p id="32d0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">日期时间功能- </strong>购买日期功能记录交易的时间戳。除了小时、日、周、月和年的基本统计特征之外，其他特征如</p><ol class=""><li id="4ffd" class="ku kv hi ih b ii ij im in iq kw iu kx iy ky jc kz la lb lc bi translated">交易当天是否为周末。</li><li id="b23a" class="ku kv hi ih b ii ld im le iq lf iu lg iy lh jc kz la lb lc bi translated">购买的平均间隔时间。</li><li id="3f12" class="ku kv hi ih b ii ld im le iq lf iu lg iy lh jc kz la lb lc bi translated">节日采购与否。</li></ol><p id="f9e8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后，将这些特性与所需的统计信息聚合到模型中。</p><p id="e6e4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">除了上述主要特征之外，工程特征的一些比率被计算，如交易数量和日期差异数量之间的计数比率等。</p><p id="53bb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">训练和测试数据与事务的这些设计特征合并。而且，基本时间功能也是从第一个活动月份功能中派生出来的。</p><p id="1b39" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> RFM分析</strong>是一种市场研究方法，使用客户交易的三个衡量标准对其进行分类。</p><ul class=""><li id="a8ea" class="ku kv hi ih b ii ij im in iq kw iu kx iy ky jc mb la lb lc bi translated">R —摄政—自上次交易以来的天数</li><li id="2206" class="ku kv hi ih b ii ld im le iq lf iu lg iy lh jc mb la lb lc bi translated">F —频率—交易的频率</li><li id="0658" class="ku kv hi ih b ii ld im le iq lf iu lg iy lh jc mb la lb lc bi translated">m——货币价值——客户/持卡人所花的钱总数。</li></ul><p id="9a73" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">通过计算RFM指数和RFM分数来了解顾客忠诚度。因此，这里我使用分位数对RFM值进行分类，通过简单的加法RFM得分和串联RFM指数作为特征导出。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="lz ma l"/></div></figure><p id="6286" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，我从交易、训练和测试数据中导出了280个数字特征。这280个特征被输入到模型中用于训练和预测。</p><h2 id="0a55" class="ju jv hi bd jw jx jy jz ka kb kc kd ke iq kf kg kh iu ki kj kk iy kl km kn ko bi translated"><strong class="ak">工程特征探索</strong></h2><p id="2053" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">最后一组工程特征中，有许多具有nan值的特征。在280个要素中，有158个要素包含Nan值。一半以上的特征必须归因于nan值。因为通过建立模型进行插补需要大量内存和时间。简单的插补技术就足够了。在这项研究中，我试验了模式插补和零插补。从其结果来看，将nan值输入为零会产生更好的预测结果。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="lz ma l"/></div></figure><h2 id="5514" class="ju jv hi bd jw jx jy jz ka kb kc kd ke iq kf kg kh iu ki kj kk iy kl km kn ko bi translated"><strong class="ak">模型构建</strong></h2><p id="90c5" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated"><strong class="ih hj">评价指标</strong>-均方根误差。在像Kaggle这样的平台上的竞赛中，评估模型预测的度量是由竞赛提供者自己给出的。</p><p id="d975" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">根据对现有解决方案和内核的研究，线性回归等简单模型，KNN并不能更好地预测目标值。所以，我像GBDT一样跳进了复杂的模型。</p><p id="1e43" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">light GBM</strong>——梯度推进模式是走向解决的第一步。没有超参数调整的LightGBM模型导致较差的RMSE值3.744407。但是通过使用<a class="ae jd" href="https://optuna.readthedocs.io/en/stable/index.html" rel="noopener ugc nofollow" target="_blank"> optuna </a>封装的超参数调谐给出了更好的RMSE值3.61634。<a class="ae jd" href="https://optuna.readthedocs.io/en/stable/index.html" rel="noopener ugc nofollow" target="_blank"> Optuna </a>软件包是一个很棒的超参数优化框架，它提供了比sklearn网格和随机搜索方法更多的优化控制。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="lz ma l"/></div></figure><p id="a790" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> XGBoost </strong> -具有调整的超参数的XGBRegressor模型并不比lightGBM模型更好的RMSE分数，但是在使用GPU的训练中更快。</p><p id="d314" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">叠加</strong>-XGBoost和lightGBM模型预测的简单混合比XGBoost模型预测提高了RMSE评分。然后，使用脊元学习器堆叠两个模型预测。这个具有元学习者的堆叠模型在Kaggle上给出了比所有其他模型预测更好的RMSE分数。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es mc"><img src="../Images/5ef0f8f5d38b4aa008e1468ddc788819.png" data-original-src="https://miro.medium.com/v2/resize:fit:1104/format:webp/1*6VzZBdMd65yVo9xvKcszMg.jpeg"/></div></figure><h2 id="039e" class="ju jv hi bd jw jx jy jz ka kb kc kd ke iq kf kg kh iu ki kj kk iy kl km kn ko bi translated">结论</h2><p id="f312" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">基于XGBoost和lighGBM模型构建的堆叠模型具有脊元学习器，与其他模型相比，给出了更好的Kaggle分数3.61596。这项研究揭示了机器学习模型构建的特征工程方面的真正力量。输入到模型中的训练数据中的几乎所有特征都是工程数据。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es md"><img src="../Images/aa4c6b560790b9e090a5db885dd48d3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WJpgARQ9fE7_KWtI_nBEXA.jpeg"/></div></div></figure><h2 id="ff64" class="ju jv hi bd jw jx jy jz ka kb kc kd ke iq kf kg kh iu ki kj kk iy kl km kn ko bi translated"><strong class="ak">未来工作</strong></h2><ol class=""><li id="7fa4" class="ku kv hi ih b ii kp im kq iq me iu mf iy mg jc kz la lb lc bi translated">包含来自商家数据的工程特征有助于改进模型预测。</li><li id="bbb7" class="ku kv hi ih b ii ld im le iq lf iu lg iy lh jc kz la lb lc bi translated">特征选择可以通过减少不需要的特征所增加的偏差来提高模型的性能。</li></ol></div><div class="ab cl li lj gp lk" role="separator"><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln"/></div><div class="hb hc hd he hf"><h2 id="8150" class="ju jv hi bd jw jx jy jz ka kb kc kd ke iq kf kg kh iu ki kj kk iy kl km kn ko bi translated">参考资料:</h2><ol class=""><li id="436f" class="ku kv hi ih b ii kp im kq iq me iu mf iy mg jc kz la lb lc bi translated"><a class="ae jd" href="https://www.appliedaicourse.com/" rel="noopener ugc nofollow" target="_blank">https://www.appliedaicourse.com/</a></li><li id="d62a" class="ku kv hi ih b ii ld im le iq lf iu lg iy lh jc kz la lb lc bi translated"><a class="ae jd" href="https://www.kaggle.com/brendanhasz/elo-data-cleaning-and-eda" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/Brendan hasz/elo-data-cleaning-and-EDA</a></li><li id="ff8d" class="ku kv hi ih b ii ld im le iq lf iu lg iy lh jc kz la lb lc bi translated"><a class="ae jd" href="https://www.kaggle.com/denzo123/a-closer-look-at-date-variables" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/denzo 123/a-closer-look-at-date-variables</a></li><li id="1d2a" class="ku kv hi ih b ii ld im le iq lf iu lg iy lh jc kz la lb lc bi translated"><a class="ae jd" href="https://towardsdatascience.com/find-your-best-customers-with-customer-segmentation-in-python-61d602f9eee6" rel="noopener" target="_blank">https://towards data science . com/find-your-best-customers-with-customer-segmentation-in-python-61d 602 F9 eee 6</a></li><li id="85f8" class="ku kv hi ih b ii ld im le iq lf iu lg iy lh jc kz la lb lc bi translated">https://www.kaggle.com/raddar/target-true-meaning-revealed<a class="ae jd" href="https://www.kaggle.com/raddar/target-true-meaning-revealed" rel="noopener ugc nofollow" target="_blank"/></li><li id="d641" class="ku kv hi ih b ii ld im le iq lf iu lg iy lh jc kz la lb lc bi translated"><a class="ae jd" href="https://www.kaggle.com/rajeshcv/customer-loyalty-based-on-rfm-analysis" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/rajeshcv/customer-loyalty-based-on-RFM-analysis</a></li><li id="3963" class="ku kv hi ih b ii ld im le iq lf iu lg iy lh jc kz la lb lc bi translated"><a class="ae jd" href="https://www.analyticsvidhya.com/blog/2020/11/hyperparameter-tuning-using-optuna/" rel="noopener ugc nofollow" target="_blank">https://www . analyticsvidhya . com/blog/2020/11/hyperparameter-tuning-using-optuna/</a></li></ol><p id="395f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">GitHub回购:</p><div class="mh mi ez fb mj mk"><a href="https://github.com/praveen-jalaja/Elo-Category-Recommendation" rel="noopener  ugc nofollow" target="_blank"><div class="ml ab dw"><div class="mm ab mn cl cj mo"><h2 class="bd hj fi z dy mp ea eb mq ed ef hh bi translated">pra veen-jalaja/Elo-类别-建议</h2><div class="mr l"><h3 class="bd b fi z dy mp ea eb mq ed ef dx translated">Elo类别推荐Kaggle竞争的案例研究Elo商家类别推荐是一个Kaggle…</h3></div><div class="ms l"><p class="bd b fp z dy mp ea eb mq ed ef dx translated">github.com</p></div></div><div class="mt l"><div class="mu l mv mw mx mt my jo mk"/></div></div></a></div><p id="6bfd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> Linkedin个人资料</strong> : <a class="ae jd" href="https://www.linkedin.com/in/praveen-jalaja/" rel="noopener ugc nofollow" target="_blank"> Praveen Jalaja </a></p></div></div>    
</body>
</html>