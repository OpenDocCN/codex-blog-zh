<html>
<head>
<title>Can Driver Alertness Be Predicted?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">驾驶员的警觉性可以预测吗？</h1>
<blockquote>原文：<a href="https://medium.com/codex/can-driver-alertness-be-predicted-721728e26a67?source=collection_archive---------15-----------------------#2021-07-31">https://medium.com/codex/can-driver-alertness-be-predicted-721728e26a67?source=collection_archive---------15-----------------------#2021-07-31</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="db80" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">使用Python和机器学习算法的驾驶员警觉性分析和预测</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/76253fb70ee5499f4b0862814f5426e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KOVn3bcDw1GIXm3lG7GnWg.jpeg"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">Getty Images上的无系统图片</figcaption></figure><blockquote class="jn jo jp"><p id="1329" class="jq jr js jt b ju jv ij jw jx jy im jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">要查看完整代码，请点击<a class="ae kn" href="https://jovian.ai/herambhd03/zerotogbms-project" rel="noopener ugc nofollow" target="_blank">此处</a>。</p></blockquote></div><div class="ab cl ko kp gp kq" role="separator"><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt"/></div><div class="hb hc hd he hf"><p id="dd2f" class="pw-post-body-paragraph jq jr hi jt b ju jv ij jw jx jy im jz kv kb kc kd kw kf kg kh kx kj kk kl km hb bi translated">根据国家安全委员会(NSC)的数据，每年，疲劳驾驶导致大约<strong class="jt hj"> 100，000起车祸</strong>，<strong class="jt hj"> 71，000起受伤</strong>，以及<strong class="jt hj"> 1，550起死亡</strong>。根据美国汽车协会的数据，疲劳驾驶导致了大约9.5%的车祸。</p><p id="0e7f" class="pw-post-body-paragraph jq jr hi jt b ju jv ij jw jx jy im jz kv kb kc kd kw kf kg kh kx kj kk kl km hb bi translated">我们将设计一个分类器，利用驾驶时获得的数据检测和分类驾驶员是否警觉，并观察影响驾驶时个体警觉性的重要特征。</p><p id="21f2" class="pw-post-body-paragraph jq jr hi jt b ju jv ij jw jx jy im jz kv kb kc kd kw kf kg kh kx kj kk kl km hb bi translated">分类器是一种机器学习算法，它将数据分成一组或多组“类”这些“类”是我们的目标标签/类别，在这种情况下是简单的“是”或“否”,表示驾驶员是否警觉。</p><p id="0dfe" class="pw-post-body-paragraph jq jr hi jt b ju jv ij jw jx jy im jz kv kb kc kd kw kf kg kh kx kj kk kl km hb bi translated"><strong class="jt hj">方法</strong></p><p id="bd1b" class="pw-post-body-paragraph jq jr hi jt b ju jv ij jw jx jy im jz kv kb kc kd kw kf kg kh kx kj kk kl km hb bi translated">该项目使用<em class="js"> Python、Pandas </em>，以及<em class="js"> sklearn </em>、<em class="js"> matplotlib </em>和<em class="js"> seaborn </em>等库对数据进行操作、可视化并进行预测<em class="js">。使用了三种不同的分类器来比较和选择最适合的算法——决策树分类器、随机森林分类器和XGBoost分类器。</em></p><p id="eec3" class="pw-post-body-paragraph jq jr hi jt b ju jv ij jw jx jy im jz kv kb kc kd kw kf kg kh kx kj kk kl km hb bi translated">顾名思义，决策树分类器是一个包含一组决策的树，这些决策是根据数据的行为逐步做出的。在决策树的每一步(称为节点),我们试图在特征上形成一个条件，以分离数据集中包含的所有“类”。</p><p id="40a7" class="pw-post-body-paragraph jq jr hi jt b ju jv ij jw jx jy im jz kv kb kc kd kw kf kg kh kx kj kk kl km hb bi translated">虽然决策树分类器可以提供很好的标签分类，但是更有效的策略是组合用稍微不同的参数训练的几个决策树的结果。这种算法叫做<em class="js">随机森林分类器</em>。这背后的想法是，平均后，每棵树产生的误差将相互抵消。</p><p id="f1ba" class="pw-post-body-paragraph jq jr hi jt b ju jv ij jw jx jy im jz kv kb kc kd kw kf kg kh kx kj kk kl km hb bi translated">XGBoost分类器是一个梯度增强分类器。术语“梯度”指的是算法旨在逐迭代地减少损失函数的事实。“助推”是一种特殊类型的学习技巧，可以将一群弱学习者转变成强学习者。因此，梯度提升分类器将新的预测器拟合到由前一个预测器产生的残余误差，以提高精度。</p><p id="a769" class="pw-post-body-paragraph jq jr hi jt b ju jv ij jw jx jy im jz kv kb kc kd kw kf kg kh kx kj kk kl km hb bi translated">以下是涉及的步骤:</p><ol class=""><li id="8d5d" class="ky kz hi jt b ju jv jx jy kv la kw lb kx lc km ld le lf lg bi translated">下载数据</li><li id="067e" class="ky kz hi jt b ju lh jx li kv lj kw lk kx ll km ld le lf lg bi translated">数据分析和清理</li><li id="aa95" class="ky kz hi jt b ju lh jx li kv lj kw lk kx ll km ld le lf lg bi translated">特征缩放</li><li id="d759" class="ky kz hi jt b ju lh jx li kv lj kw lk kx ll km ld le lf lg bi translated">分成训练集、验证集和测试集</li><li id="c2a9" class="ky kz hi jt b ju lh jx li kv lj kw lk kx ll km ld le lf lg bi translated">训练决策树分类器</li><li id="4da4" class="ky kz hi jt b ju lh jx li kv lj kw lk kx ll km ld le lf lg bi translated">训练随机森林分类器</li><li id="5ea5" class="ky kz hi jt b ju lh jx li kv lj kw lk kx ll km ld le lf lg bi translated">训练梯度增强模型</li></ol><h1 id="f05d" class="lm ln hi bd lo lp lq lr ls lt lu lv lw io lx ip ly ir lz is ma iu mb iv mc md bi translated">下载数据</h1><p id="da51" class="pw-post-body-paragraph jq jr hi jt b ju me ij jw jx mf im jz kv mg kc kd kw mh kg kh kx mi kk kl km hb bi translated">第一步是下载我们打算使用的数据。该数据集可在https://www.kaggle.com/c/stayalert/data?获得select = for train . CSV。使用Jovian的<a class="ae kn" href="https://github.com/JovianML/opendatasets" rel="noopener ugc nofollow" target="_blank"> opendatasets </a>库，我从<a class="ae kn" href="https://www.kaggle.com/stanford-open-policing/stanford-open-policing-project-bundle-2" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>下载了数据。</p><h1 id="43c4" class="lm ln hi bd lo lp lq lr ls lt lu lv lw io lx ip ly ir lz is ma iu mb iv mc md bi translated">数据分析和清理</h1><p id="40d6" class="pw-post-body-paragraph jq jr hi jt b ju me ij jw jx mf im jz kv mg kc kd kw mh kg kh kx mi kk kl km hb bi translated">为了使数据准备好用于机器学习模型，我们必须首先分析它，并删除任何特殊的数据。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mj"><img src="../Images/5b86c5bf2305850e8068aa105dd0e612.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*z2R3INmLIWKTAtGP"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">卢克·切瑟在<a class="ae kn" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mk ml l"/></div></figure><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mk ml l"/></div></figure><p id="1ed0" class="pw-post-body-paragraph jq jr hi jt b ju jv ij jw jx jy im jz kv kb kc kd kw kf kg kh kx kj kk kl km hb bi translated">前两列似乎是关于驱动程序的一些信息。第三列表示驾驶员是否警觉——1表示他/她警觉，0表示他们不警觉。接下来的8列标题是P1，P2，…..，P8代表生理数据。接下来的11列带有标题E1，E2，…..，E11代表环境数据。接下来的11列标题是V1、V2……..V11表示车辆数据。</p><h1 id="7abf" class="lm ln hi bd lo lp lq lr ls lt lu lv lw io lx ip ly ir lz is ma iu mb iv mc md bi translated">特征缩放</h1><p id="fb52" class="pw-post-body-paragraph jq jr hi jt b ju me ij jw jx mf im jz kv mg kc kd kw mh kg kh kx mi kk kl km hb bi translated">由于每列中的值都在变化，我们需要将它们调整为0到1之间的值，以便我们可以比较它们各自的权重，并了解这些参数如何影响驾驶员的警觉性。</p><h1 id="a470" class="lm ln hi bd lo lp lq lr ls lt lu lv lw io lx ip ly ir lz is ma iu mb iv mc md bi translated">培训、验证和测试集</h1><p id="d80c" class="pw-post-body-paragraph jq jr hi jt b ju me ij jw jx mf im jz kv mg kc kd kw mh kg kh kx mi kk kl km hb bi translated">为了训练我们的数据，我们需要一个训练集。为了在以前看不到的数据上测试这个数据，我们将看到它在验证集上的表现。最后，我们将看看测试集，它代表了我们的模型在实际应用中的表现。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mm"><img src="../Images/216b900470edf85fc34979955a6abbc3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NbBWG3Ay1-l4lH6z1XtaeA.jpeg"/></div></div></figure><p id="9a91" class="pw-post-body-paragraph jq jr hi jt b ju jv ij jw jx jy im jz kv kb kc kd kw kf kg kh kx kj kk kl km hb bi translated">训练集有75%的数据，验证集有25%的数据。测试套件已单独提供。</p><h1 id="1133" class="lm ln hi bd lo lp lq lr ls lt lu lv lw io lx ip ly ir lz is ma iu mb iv mc md bi translated">决策树分类器</h1><p id="5ad6" class="pw-post-body-paragraph jq jr hi jt b ju me ij jw jx mf im jz kv mg kc kd kw mh kg kh kx mi kk kl km hb bi translated">我们可以使用sklearn.tree中的DecisionTreeClassifier来训练决策树。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mn"><img src="../Images/632ef3a93cc786e1171de5694ed36460.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*OMTTp_qj_UQ3j4o1NEyZ4g.png"/></div></figure><p id="346f" class="pw-post-body-paragraph jq jr hi jt b ju jv ij jw jx jy im jz kv kb kc kd kw kf kg kh kx kj kk kl km hb bi translated">在决策树中，为了预测给定数据集的类别，算法从树的根节点开始。该算法将根属性的值与记录(真实数据集)属性的值进行比较，并根据比较结果，沿着分支跳转到下一个节点。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mo"><img src="../Images/b875d8459614bce4965790abe8b43d3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kG-Li8kmM9LSiJn-W73sgQ.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">模型的决策树</figcaption></figure><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mk ml l"/></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">这显示了主要影响驾驶员警觉性的特征</figcaption></figure><p id="b882" class="pw-post-body-paragraph jq jr hi jt b ju jv ij jw jx jy im jz kv kb kc kd kw kf kg kh kx kj kk kl km hb bi translated">看来，车辆和环境因素似乎比物理因素对驾驶员的警觉性有更深刻的影响。</p><h1 id="f1db" class="lm ln hi bd lo lp lq lr ls lt lu lv lw io lx ip ly ir lz is ma iu mb iv mc md bi translated">超参数训练和调整</h1><p id="0e05" class="pw-post-body-paragraph jq jr hi jt b ju me ij jw jx mf im jz kv mg kc kd kw mh kg kh kx mi kk kl km hb bi translated">通常，我们不知道最佳的模型架构，因此我们希望能够探索一系列的可能性。<strong class="jt hj">超参数</strong>定义模型架构，搜索理想模型架构的过程称为<em class="js">超参数调整</em>。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mk ml l"/></div></figure><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mk ml l"/></div></figure><p id="4088" class="pw-post-body-paragraph jq jr hi jt b ju jv ij jw jx jy im jz kv kb kc kd kw kf kg kh kx kj kk kl km hb bi translated">为了防止过度拟合训练集并减少验证集的错误，我们可以调整各种超参数，使我们的模型表现更好。</p><p id="22ef" class="pw-post-body-paragraph jq jr hi jt b ju jv ij jw jx jy im jz kv kb kc kd kw kf kg kh kx kj kk kl km hb bi translated">对于决策树分类器，我们在训练集上的准确率为100%，在验证集上的准确率为98.647%，在测试集上的准确率为67.266%。因此，我们可以说决策树分类器不是预测我们结果的最佳模型。</p><h1 id="6ae5" class="lm ln hi bd lo lp lq lr ls lt lu lv lw io lx ip ly ir lz is ma iu mb iv mc md bi translated">随机森林分类器</h1><p id="e234" class="pw-post-body-paragraph jq jr hi jt b ju me ij jw jx mf im jz kv mg kc kd kw mh kg kh kx mi kk kl km hb bi translated">随机森林通过平均/组合几个决策树的结果来工作。我们将使用sklearn.ensemble中的RandomForestClassifier类。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mp"><img src="../Images/7494969a6b625f7cbf4a8c522dc101af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IJpG-sa7nps3-8y6J9AX2g.png"/></div></div></figure><p id="29a2" class="pw-post-body-paragraph jq jr hi jt b ju jv ij jw jx jy im jz kv kb kc kd kw kf kg kh kx kj kk kl km hb bi translated">对于随机森林分类器，我们在训练集上的准确率为100%，在验证集上的准确率为99.398%，在测试集上的准确率为80.198%。随机森林分类器无疑比决策树分类器做得更好。</p><h1 id="cd3b" class="lm ln hi bd lo lp lq lr ls lt lu lv lw io lx ip ly ir lz is ma iu mb iv mc md bi translated">梯度推进模型</h1><p id="1f97" class="pw-post-body-paragraph jq jr hi jt b ju me ij jw jx mf im jz kv mg kc kd kw mh kg kh kx mi kk kl km hb bi translated">术语“梯度”指的是每个决策树被训练的目的是减少来自前一次迭代的损失(类似于梯度下降)。术语“提升”是指训练新模型以改进现有模型的结果的一般技术。为了训练一个GBM，我们可以使用XGBoost库中的XGBRegressor类。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mq"><img src="../Images/3e4e2f84df36f8a9de09db702a90c361.png" data-original-src="https://miro.medium.com/v2/resize:fit:1120/format:webp/1*4LbSvVPFR4ZNi8Jf7gwMBg.png"/></div></figure><p id="2541" class="pw-post-body-paragraph jq jr hi jt b ju jv ij jw jx jy im jz kv kb kc kd kw kf kg kh kx kj kk kl km hb bi translated">对于随机森林分类器，我们在训练集上的准确率为100%，在验证集上的准确率为99.569%，在测试集上的准确率为86.954%。梯度推进模型似乎是最好的选择，因为它产生了更大的准确性，而且计算速度很快！</p><h1 id="5fa1" class="lm ln hi bd lo lp lq lr ls lt lu lv lw io lx ip ly ir lz is ma iu mb iv mc md bi translated">总结和最终想法</h1><p id="baa2" class="pw-post-body-paragraph jq jr hi jt b ju me ij jw jx mf im jz kv mg kc kd kw mh kg kh kx mi kk kl km hb bi translated">基于各种物理、车辆和环境因素，可以以大约87%的准确度预测驾驶员的警觉性！这表明，事实上，使用机器学习分类器来预测驾驶员的警觉性是可能的。</p><p id="e74e" class="pw-post-body-paragraph jq jr hi jt b ju jv ij jw jx jy im jz kv kb kc kd kw kf kg kh kx kj kk kl km hb bi translated"><em class="js">要更详细地了解所有这些步骤，请点击 <em class="js">查看完整的项目笔记本</em> <a class="ae kn" href="https://jovian.ai/herambhd03/zerotogbms-project" rel="noopener ugc nofollow" target="_blank">。</a></em></p></div></div>    
</body>
</html>