<html>
<head>
<title>Computer Vision: OpenCV</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">计算机视觉:OpenCV</h1>
<blockquote>原文：<a href="https://medium.com/codex/computer-vision-opencv-c871fc8a840a?source=collection_archive---------3-----------------------#2021-01-02">https://medium.com/codex/computer-vision-opencv-c871fc8a840a?source=collection_archive---------3-----------------------#2021-01-02</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/9760365daef137a7044d3590c3b8e47e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*mJSRUWquKWRbSgoh"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">雅利安·迪曼在<a class="ae hv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><div class=""/><p id="a803" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">你有没有想过Instagram或脸书是如何帮助我们标记人的？它如何识别不同的人？所以，这个自动标记功能在计算机视觉上起作用。</p><p id="c021" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">简单地说，计算机视觉帮助我们像人类一样识别物体！！</p><p id="0db1" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hz">但是计算机真的能读取图像吗？</strong></p><p id="93be" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">其实答案是否定的！</p><p id="4a35" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">对于彩色图像，有三个通道——红色、绿色和蓝色。每种颜色都有一个矩阵，我们看到的图像是这些通道的组合。在黑白图像的情况下，只有一个具有特定长度和高度的通道。</p><figure class="ju jv jw jx fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es jt"><img src="../Images/07123dc51a6ac9c73df80e1fbd0b3c54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*jf5RKSggAk9s0XWh.jpeg"/></div></div></figure><h1 id="133f" class="jy jz hy bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">OpenCV</h1><p id="effc" class="pw-post-body-paragraph iv iw hy ix b iy kw ja jb jc kx je jf jg ky ji jj jk kz jm jn jo la jq jr js hb bi translated">OpenCV是一个python库，用于Python中的图像和视频处理。它被用于许多实时应用中。</p><h2 id="8116" class="lb jz hy bd ka lc ld le ke lf lg lh ki jg li lj km jk lk ll kq jo lm ln ku lo bi translated">安装OpenCV</h2><pre class="ju jv jw jx fd lp lq lr ls aw lt bi"><span id="58c1" class="lb jz hy lq b fi lu lv l lw lx">pip install opencv</span></pre><h2 id="0f1c" class="lb jz hy bd ka lc ld le ke lf lg lh ki jg li lj km jk lk ll kq jo lm ln ku lo bi translated"><strong class="ak">导入OpenCV </strong></h2><pre class="ju jv jw jx fd lp lq lr ls aw lt bi"><span id="2f00" class="lb jz hy lq b fi lu lv l lw lx">import cv2</span></pre><p id="a9e0" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">读取图像</p><pre class="ju jv jw jx fd lp lq lr ls aw lt bi"><span id="8c8d" class="lb jz hy lq b fi lu lv l lw lx">img = cv2.imread(‘simon.jpg’)</span></pre><p id="5495" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们可以从BGR转换到RGB或任何其他颜色模式</p><pre class="ju jv jw jx fd lp lq lr ls aw lt bi"><span id="08e9" class="lb jz hy lq b fi lu lv l lw lx">new_img = cv2.cvtColor(img,cv2.COLOR_BGR2RGB)</span></pre><p id="eef1" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在让我们看看我们的形象是什么样的！</p><pre class="ju jv jw jx fd lp lq lr ls aw lt bi"><span id="adfa" class="lb jz hy lq b fi lu lv l lw lx">plt.imshow(img)<br/>plt.grid(False)<br/>plt.show()</span></pre><figure class="ju jv jw jx fd hk er es paragraph-image"><div class="er es ly"><img src="../Images/4296964720dc8838d6b2c238c487061f.png" data-original-src="https://miro.medium.com/v2/resize:fit:826/format:webp/1*HOb749KSObJH38pNTrVOmQ.png"/></div></figure><pre class="ju jv jw jx fd lp lq lr ls aw lt bi"><span id="ebf6" class="lb jz hy lq b fi lu lv l lw lx">plt.imshow(new_img)<br/>plt.grid(False)<br/>plt.show()</span></pre><figure class="ju jv jw jx fd hk er es paragraph-image"><div class="er es ly"><img src="../Images/4906f4584a5100e1f999b3ee445ac49d.png" data-original-src="https://miro.medium.com/v2/resize:fit:826/format:webp/1*n5BHZDc-djU43vZ4BB_QnQ.png"/></div></figure><p id="0707" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">下面的代码启动一个有两帧的摄像机，一帧是彩色的，另一帧是黑白的。</p><p id="9cfa" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">当您按下“q”时，您的程序将停止执行！</p><pre class="ju jv jw jx fd lp lq lr ls aw lt bi"><span id="ad8e" class="lb jz hy lq b fi lu lv l lw lx">import cv2</span><span id="524b" class="lb jz hy lq b fi ma lv l lw lx">cap = cv2.VideoCapture(0)</span><span id="c92c" class="lb jz hy lq b fi ma lv l lw lx">while(True):<br/>    ret,frame = cap.read()<br/>    gray_frame = cv2.cvtColor(frame,cv2.COLOR_BGR2GRAY)<br/>    if ret==False:<br/>        continue<br/>    <br/>    cv2.imshow("Video Frame",frame)<br/>    cv2.imshow("Black White",gray_frame)<br/>    # Wait For user input<br/>    key_pressed = cv2.waitKey(1) &amp; 0xFF<br/>    <br/>    if(key_pressed == ord('q')):<br/>        break<br/>cap.release()<br/>cv2.destroyAllWindows()</span></pre><p id="247c" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">以下代码使用了haar cascade预写算法。</p><p id="70fc" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">它编写了一个Python脚本，可以从你的网络摄像头视频流中捕捉图像。然后从图像帧中提取所有人脸(使用haar级联)<br/>最后将人脸信息存储到numpy数组中。</p><pre class="ju jv jw jx fd lp lq lr ls aw lt bi"><span id="73f9" class="lb jz hy lq b fi lu lv l lw lx">import cv2<br/>import numpy as np</span><span id="49b1" class="lb jz hy lq b fi ma lv l lw lx">#Init Camera<br/>cap = cv2.VideoCapture(0)</span><span id="1de2" class="lb jz hy lq b fi ma lv l lw lx"># Face Detection<br/>face_cascade = cv2.CascadeClassifier("haarcascade_frontalface_alt.xml")</span><span id="6259" class="lb jz hy lq b fi ma lv l lw lx">skip = 0<br/>face_data = []<br/>dataset_path = './data/'<br/>file_name = input("Enter the name of the person : ")<br/>while True:<br/> ret,frame = cap.read()</span><span id="50bd" class="lb jz hy lq b fi ma lv l lw lx">if ret==False:<br/>  continue</span><span id="1043" class="lb jz hy lq b fi ma lv l lw lx">gray_frame = cv2.cvtColor(frame,cv2.COLOR_BGR2GRAY)</span><span id="e744" class="lb jz hy lq b fi ma lv l lw lx">faces = face_cascade.detectMultiScale(frame,1.3,5)<br/> if len(faces)==0:<br/>  continue<br/>  <br/> faces = sorted(faces,key=lambda f:f[2]*f[3])</span><span id="c156" class="lb jz hy lq b fi ma lv l lw lx"># Pick the last face (because it is the largest face acc to area(f[2]*f[3]))<br/> for face in faces[-1:]:<br/>  x,y,w,h = face<br/>  cv2.rectangle(frame,(x,y),(x+w,y+h),(0,255,255),2)</span><span id="599e" class="lb jz hy lq b fi ma lv l lw lx">#Extract (Crop out the required face) : Region of Interest<br/>  offset = 10<br/>  face_section = frame[y-offset:y+h+offset,x-offset:x+w+offset]<br/>  face_section = cv2.resize(face_section,(100,100))</span><span id="d5ee" class="lb jz hy lq b fi ma lv l lw lx">skip += 1<br/>  if skip%10==0:<br/>   face_data.append(face_section)<br/>   print(len(face_data))</span><span id="08a4" class="lb jz hy lq b fi ma lv l lw lx">cv2.imshow("Frame",frame)<br/> cv2.imshow("Face Section",face_section)</span><span id="0c76" class="lb jz hy lq b fi ma lv l lw lx">key_pressed = cv2.waitKey(1) &amp; 0xFF<br/> if key_pressed == ord('q'):<br/>  break</span><span id="34d3" class="lb jz hy lq b fi ma lv l lw lx"># Convert our face list array into a numpy array<br/>face_data = np.asarray(face_data)<br/>face_data = face_data.reshape((face_data.shape[0],-1))<br/>print(face_data.shape)</span><span id="9db9" class="lb jz hy lq b fi ma lv l lw lx"># Save this data into file system<br/>np.save(dataset_path+file_name+'.npy',face_data)<br/>print("Data Successfully save at "+dataset_path+file_name+'.npy')</span><span id="bd1d" class="lb jz hy lq b fi ma lv l lw lx">cap.release()<br/>cv2.destroyAllWindows()</span></pre><p id="e0a4" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">1.读取和显示视频流，捕捉图像<br/> 2。检测人脸并显示包围盒(haar cascade) <br/> 3。展平最大的面部图像(灰度)并保存在numpy数组<br/> 4中。对多人重复上述操作，以生成训练数据</p><p id="648f" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，使用这些数据，我们可以使用KNN算法来识别人！！</p><p id="8d4e" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">感谢阅读…</p></div></div>    
</body>
</html>