<html>
<head>
<title>Testing a Smart Contract with HardHat 👷‍♂️</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用HardHat测试智能合同👷‍♂️</h1>
<blockquote>原文：<a href="https://medium.com/codex/testing-a-smart-contract-with-hardhat-%EF%B8%8F-b7edd925891?source=collection_archive---------0-----------------------#2022-02-18">https://medium.com/codex/testing-a-smart-contract-with-hardhat-%EF%B8%8F-b7edd925891?source=collection_archive---------0-----------------------#2022-02-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="3251" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">使用安全帽进行智能合同开发。</em></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/4b8a7bc70f2f5c521c6ecf3b9d74398a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cmQXnOUcR4bVwyiy3fcLmg.jpeg"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">照片由<a class="ae ju" href="https://unsplash.com/@umityildirim?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">üMIT y ldr RM</a>在<a class="ae ju" href="https://unsplash.com/s/photos/construction?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="4685" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">与Truffle一样，HardHat 是用于智能合约开发的最大开发工具之一。我以前用过松露，但没那么多，是时候改变了。</p><p id="c37e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本文中，我将一步一步地解释如何初始化一个新的智能合约项目，以及我们如何使用HardHat来测试它。我们将使用<a class="ae ju" href="https://www.chaijs.com/" rel="noopener ugc nofollow" target="_blank">柴</a>和<a class="ae ju" href="https://docs.ethers.io/v5/" rel="noopener ugc nofollow" target="_blank">醚</a>来轻松测试合同。</p></div><div class="ab cl jv jw gp jx" role="separator"><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka"/></div><div class="hb hc hd he hf"><h1 id="026b" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">初始化安全帽项目</h1><p id="657c" class="pw-post-body-paragraph if ig hi ih b ii la ik il im lb io ip iq lc is it iu ld iw ix iy le ja jb jc hb bi translated">要开始测试，我们首先需要创建一个带有简单智能契约的基本项目。因为HardHat在NPM，启动一个项目就像运行几个命令一样简单。</p><pre class="jf jg jh ji fd lf lg lh li aw lj bi"><span id="7083" class="lk kd hi lg b fi ll lm l ln lo">npm init -y<br/>npm i hardhat --save-dev<br/>npx hardhat <br/>&gt; Create an empty project<br/>npm i --save-dev @nomiclabs/hardhat-ethers ethers @nomiclabs/hardhat-waffle ethereum-waffle chai</span></pre><p id="029c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当你运行HardHat时，它会寻找<code class="du lp lq lr lg b">hardhat.config.js</code>中的所有东西，它甚至可以光着身子运行。在这里，你可以定义你要使用的网络、任务和插件。</p><p id="8efb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因为我们将在测试中使用柴和乙醚，所以我们也需要添加它们。我们还需要在配置文件的顶部添加<code class="du lp lq lr lg b">Hardhat-waffle</code>。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="ls lt l"/></div></figure></div><div class="ab cl jv jw gp jx" role="separator"><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka"/></div><div class="hb hc hd he hf"><h1 id="8a29" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">测试智能合同</h1><p id="4385" class="pw-post-body-paragraph if ig hi ih b ii la ik il im lb io ip iq lc is it iu ld iw ix iy le ja jb jc hb bi translated">在测试之前，我们需要做的第一件事是创建一个简单的智能契约。创建一个名为<code class="du lp lq lr lg b">contracts</code>的文件夹，在里面创建一个智能合同。我会叫我的<code class="du lp lq lr lg b">Test.sol</code>。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="ls lt l"/></div></figure><p id="e79e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">它有两个功能，我们可以很容易地进行测试。如果您想测试这些函数，您可以创建更复杂的函数，但是对于本文，我将保持简单。</p><p id="6c7e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有了这个小契约，我们可以通过运行<code class="du lp lq lr lg b">npx hardhat compile</code>来编译它。这将需要一段时间，并创建一些新文件，我们现在不必担心。</p><p id="0cce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">确保配置文件和实体文件中的实体版本一致。</em></p><h2 id="b88e" class="lk kd hi bd ke lu lv lw ki lx ly lz km iq ma mb kq iu mc md ku iy me mf ky mg bi translated">创建测试</h2><p id="bffb" class="pw-post-body-paragraph if ig hi ih b ii la ik il im lb io ip iq lc is it iu ld iw ix iy le ja jb jc hb bi translated">我们需要创建一个名为<code class="du lp lq lr lg b">test</code>的新文件夹，其中我们将创建一个<code class="du lp lq lr lg b">Test.js</code>文件，该文件将使用Chai和Ethers来测试我们的简单智能契约。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="ls lt l"/></div></figure><p id="ebc7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">测试中的前三行创建了我们的<code class="du lp lq lr lg b">contract</code>对象。正如您在第11行和第12行看到的，这是我们将用来调用函数的实际对象。</p><p id="4618" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">测试中的最后两行检查结果是否等于我们的预期结果，在这种情况下，我们期待<code class="du lp lq lr lg b">6 + 6 = 12</code>和<code class="du lp lq lr lg b">6 — 6 = 0</code>。这是正确的。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es mh"><img src="../Images/9a5f0c4335627a0b2c6b18cea6430c8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:562/format:webp/1*cOZgX6CxIS7q7ZaLfeipNA.png"/></div></figure><p id="8636" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们的测试顺利完成。但是我们可能想更新一下我们的<code class="du lp lq lr lg b">Test.js</code>。如果我们多写几个测试，我们不希望每次都必须部署智能契约，我们可以使用<code class="du lp lq lr lg b">beforeEach</code>让它更漂亮一点。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="ls lt l"/></div></figure><p id="13ba" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们可以在每次测试前自动签订合同，而不必每次都重复这三行。</p></div><div class="ab cl jv jw gp jx" role="separator"><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka"/></div><div class="hb hc hd he hf"><h1 id="c5e0" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">结论</h1><p id="b35a" class="pw-post-body-paragraph if ig hi ih b ii la ik il im lb io ip iq lc is it iu ld iw ix iy le ja jb jc hb bi translated">这是使用HardHat测试智能合约的基础。如果你想了解更多，你可以点击这里查看官方文件<a class="ae ju" href="https://hardhat.org/tutorial/testing-contracts.html" rel="noopener ugc nofollow" target="_blank"/>。在部署之前，一定要确保彻底测试不可变的智能协定。</p><p id="ced8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">非常感谢您的阅读，祝您度过美好的一天。</p><p id="6a24" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae ju" href="https://mbvissers.medium.com/membership" rel="noopener">支持我支持Medium，成为会员</a>。它帮了我很大的忙，它不会额外花费你，你可以阅读尽可能多的中等文章！</p><p id="8d61" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在<a class="ae ju" href="https://twitter.com/0xmbvissers" rel="noopener ugc nofollow" target="_blank"> Twitter </a>和<a class="ae ju" href="https://gm.xyz/u/mbvissers.eth" rel="noopener ugc nofollow" target="_blank"> gm.xyz </a>上关注我。</p><p id="1e06" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这里查看我是<a class="ae ju" href="https://kangaroomob.io/" rel="noopener ugc nofollow" target="_blank">的开发人员的项目</a>。</p><p id="1d52" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在Polygon上查看我最新的<a class="ae ju" href="https://www.pixel-pizzas.com/" rel="noopener ugc nofollow" target="_blank"> NFT作品集</a>。</p></div></div>    
</body>
</html>