<html>
<head>
<title>How to build a REST API with TypeScript using Deno, Opine and DenoDb</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Deno、Opine和DenoDb用TypeScript构建REST API</h1>
<blockquote>原文：<a href="https://medium.com/codex/how-to-build-a-rest-api-with-typescript-using-deno-opine-and-denodb-82e1411298a?source=collection_archive---------21-----------------------#2022-04-09">https://medium.com/codex/how-to-build-a-rest-api-with-typescript-using-deno-opine-and-denodb-82e1411298a?source=collection_archive---------21-----------------------#2022-04-09</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/027bd97a7289ee90c769cbe01208d09a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*TTynWUVYh3f23kxH"/></div></div></figure><p id="25cb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这些天我开始学习TypeScript，我对Deno感兴趣，“Deno是一个简单、现代、安全的JavaScript和Typescript运行时，它使用V8并内置于Rust中。”。我很好奇如何用它构建一个REST API。我真正喜欢的框架是Opine，“从ExpressJS移植而来的快速、极简的web框架。”根据它的文件。</p><p id="2a59" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在本教程中，我们将使用Deno构建一个REST API，Opine作为web框架，DenoDB作为ORM。</p><p id="ab2a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们将开始定义我们的模型。我将使用DenoDB教程中的相同模型。</p><p id="95f6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">要求:</strong></p><ul class=""><li id="aa65" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated">Deno安装在你的机器上(你可以从<a class="ae jx" href="https://deno.land/" rel="noopener ugc nofollow" target="_blank">这里</a>安装)。</li><li id="3fb0" class="jo jp hi is b it jy ix jz jb ka jf kb jj kc jn jt ju jv jw bi translated">了解面向对象的基本概念(类、方法、实例)。</li></ul><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="3bd7" class="km kn hi ki b fi ko kp l kq kr">-----OpineApi<br/>       |------model<br/>       |      |-----Flight.ts<br/>       |------router<br/>       |      |-----Routers.ts<br/>       |------app.ts<br/>       |------db.ts</span></pre><p id="04b8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们在API目录中创建一个模型文件夹，并创建一个模型文件。</p><p id="c9e0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> Flight.ts </strong></p><figure class="kd ke kf kg fd ij"><div class="bz dy l di"><div class="ks kt l"/></div></figure><p id="a917" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在Flight.ts中，我们需要从DenoDB导入数据类型和模型类，然后创建一个Flight类，它继承了模型类的属性和方法。然后，我们将表命名为“flights ”,并将时间戳标记为true，这将显示我们何时创建行以及何时更新行。</p><p id="0e9c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然后，我们定义我们的模型的字段及其数据类型，在这种情况下:id、出发、目的地和飞行持续时间，如果我们不指定飞行持续时间，它将默认显示2.5。</p><p id="2639" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">之后，我们在API目录中创建一个文件，我们将在这个目录中连接数据库。我打算使用SQLite，但是DenoDB支持PostgreSQL、MySQL、MariaDB和MongoDB。</p><p id="cf0f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> db.ts </strong></p><figure class="kd ke kf kg fd ij"><div class="bz dy l di"><div class="ks kt l"/></div></figure><p id="0588" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们需要从Deno Db导入数据库和SQLite3Connector，从模型文件导入Flight类。</p><p id="8cc8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们创建一个不可变变量来存储SQLite连接器的实例，并指定SQL文件的路径。然后我们创建一个不可变的变量来存储一个数据库类的实例，连接我们的数据库，之后，我们将它链接到模型。</p><p id="0ebf" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，我们在API目录中创建一个路由器文件夹，并创建一个文件来对路由器进行编程。</p><p id="b279" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">路由器. ts </strong></p><figure class="kd ke kf kg fd ij"><div class="bz dy l di"><div class="ks kt l"/></div></figure><p id="3532" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们的第一个路由器是用来获取数据库中的所有航班。我们需要创建一个opine实例，然后使用get方法。我们将一个不可变的变量声明为flights，以存储我们可以通过方法all()访问的所有航班，该方法来自Flight类继承的模型类。然后它发送一个JSON作为响应。如果有错误，它将发送一条错误消息。</p><figure class="kd ke kf kg fd ij"><div class="bz dy l di"><div class="ks kt l"/></div></figure><p id="1a65" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">该路由器将通过其“id”获得航班。我们使用飞行课程中的“where”方法。<a class="ae jx" href="http://req.params.id" rel="noopener ugc nofollow" target="_blank"> req.params.id </a>'是opine中从路径中检索id参数的方法。如果路径中没有指定id的航班，它将发送消息“未找到航班”。如果有航班，它将把请求体作为JSON发送。</p><figure class="kd ke kf kg fd ij"><div class="bz dy l di"><div class="ks kt l"/></div></figure><p id="5c29" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这个路由器中，我们使用create方法来发布请求正文。如果发布成功，它将发送状态代码“200”和作为响应发布的正文。</p><figure class="kd ke kf kg fd ij"><div class="bz dy l di"><div class="ks kt l"/></div></figure><p id="0f24" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了进行更新，我们使用了与预订航班几乎相同的代码。不同的是，我们使用的是update方法。</p><p id="9b2b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">同样的事情也适用于从数据库中删除行。我们使用Flight类中的delete方法。这些方法来自DenoDb。代码删除其id在路径中指定的行。</p><figure class="kd ke kf kg fd ij"><div class="bz dy l di"><div class="ks kt l"/></div></figure><p id="f7af" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">应用程序</strong></p><figure class="kd ke kf kg fd ij"><div class="bz dy l di"><div class="ks kt l"/></div></figure><p id="fcf8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这个文件是服务器执行的地方。我们创建一个opine实例，使用“listen”方法并传递API将要使用的端口。' db.sync()'用于同步数据库。</p><p id="a8de" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了运行服务器，我们需要在我们的终端中编写这个，因为Deno在默认情况下是安全的:</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="42b9" class="km kn hi ki b fi ko kp l kq kr">deno run --allow-net --allow-write --allow-read app.ts</span></pre><p id="3e89" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果你对其他包有什么推荐，如何提高我的代码，我的英语，什么都可以；请留言或通过<a class="ae jx" href="https://twitter.com/Carlos_marcv" rel="noopener ugc nofollow" target="_blank"> Twitter </a>或<a class="ae jx" href="https://www.linkedin.com/in/carlos-marcano-a2135a134/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>联系我。</p><p id="c84b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">源代码是<a class="ae jx" href="https://github.com/carlosm27/opine_api" rel="noopener ugc nofollow" target="_blank">这里</a></p><p id="9517" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">参考资料:</p><ul class=""><li id="059b" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated"><a class="ae jx" href="https://deno.land/manual" rel="noopener ugc nofollow" target="_blank"> Deno手动</a></li><li id="b7f5" class="jo jp hi is b it jy ix jz jb ka jf kb jj kc jn jt ju jv jw bi translated"><a class="ae jx" href="https://github.com/cmorten/opine/blob/main/.github/API/api.md" rel="noopener ugc nofollow" target="_blank">意见文件</a></li><li id="427b" class="jo jp hi is b it jy ix jz jb ka jf kb jj kc jn jt ju jv jw bi translated"><a class="ae jx" href="https://eveningkid.com/denodb-docs/docs/getting-started" rel="noopener ugc nofollow" target="_blank"> DenoDb文档</a></li></ul></div><div class="ab cl ku kv gp kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="hb hc hd he hf"><p id="0ed5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="lb">最初发布于</em><a class="ae jx" href="https://carlosmv.hashnode.dev/how-to-build-a-rest-api-with-typescript-using-deno-opine-and-denodb" rel="noopener ugc nofollow" target="_blank"><em class="lb">https://Carlos mv . hash node . dev</em></a><em class="lb">。</em></p></div></div>    
</body>
</html>