<html>
<head>
<title>Introducing Elucid, A GraphQL Error Detector For the Rest of Us</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">向我们介绍Elucid，一个GraphQL错误检测器</h1>
<blockquote>原文：<a href="https://medium.com/codex/introducing-elucid-a-graphql-error-detector-for-the-rest-of-us-1edd161bc38a?source=collection_archive---------13-----------------------#2021-08-18">https://medium.com/codex/introducing-elucid-a-graphql-error-detector-for-the-rest-of-us-1edd161bc38a?source=collection_archive---------13-----------------------#2021-08-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="1acd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">GraphQL做了很多很棒的事情，但是它并没有让通过HTTP发送的请求的错误检测变得特别容易。<a class="ae je" href="https://www.elucid.dev" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj"><em class="jd"/></strong></a><em class="jd">想改变这一点。</em></p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es jf"><img src="../Images/7d54c27e9ea4b29aad306409b3a725c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TM56xyJYTik4OgYIocTxOQ.jpeg"/></div></div></figure><h1 id="1c6f" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">问题是</h1><p id="1986" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">自从GraphQL在2015年公开发布以来，越来越多的软件开发人员转向脸书的开源查询语言来支持他们的API游戏。GraphQL的灵活性和提供精确响应的潜力意味着开发人员需要的数据更少。这在一个对复杂、丰富和动态移动计算的期望越来越高的时代尤为重要，在这个时代，传输的每个字节都要根据时间和使用情况进行权衡。</p><p id="44f5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然而，伴随着所有这些潜力而来的是更多的复杂性。作为比较，考虑GraphQL API正在取代的现有RESTful API架构。在这种配置下，客户端向特定的URL发出HTTP请求(“GET”、“POST”、“PUT”或“DELETE”)，该URL可能类似于“https://www . example . com/users/{ username }”。web地址的最后一部分是后端端点，客户端可以在这里查询给定用户的信息。如果客户机错误地请求关于一个不存在的用户的信息，并且在服务器的数据库中找不到这个用户，那么服务器很容易在它的响应中返回一个4xx错误代码，向客户机表明它发出了一个错误的请求。</p><p id="2e75" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">就其本质而言，GraphQL往往会给这个过程带来麻烦:您的公式化GraphQL查询(很可能)是作为标准HTTP协议“POST”请求的一部分发送的，但它们都去往同一个地方:单个GraphQL端点。服务器将用一个JSON响应对象来响应发送到这个位置的任何请求。我说“很可能”通过HTTP发送，因为GraphQL是传输层不可知的。虽然它经常出现在通过HTTP提供服务的领域中，但是在GraphQL规范中没有任何关于GraphQL应该如何处理的内容，例如，在HTTP响应中设置状态代码，因为GraphQL本身并不是HTTP的替代品，也可以很容易地通过WebSockets提供服务。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es ku"><img src="../Images/7487cc7b3f46111a28c1895318f1503d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ULITHErCZzYdqxLtlP1qDw.png"/></div></div><figcaption class="kv kw et er es kx ky bd b be z dx translated">来源:<a class="ae je" href="https://www.cosmicjs.com/blog/graphql-vs-rest-a-quick-guide" rel="noopener ugc nofollow" target="_blank">https://www.cosmicjs.com/blog/graphql-vs-rest-a-quick-guide</a></figcaption></figure><p id="d6d1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这么说吧:如果你问它一个问题，而GraphQL的回答是，“我找不到你要找的东西”，甚至“你问我的问题没有任何意义”，就GraphQL而言，这是一次成功的交互，也是一次完全有效的回应。对于习惯于传统RESTful范式的客户端开发人员来说，这有点令人失望，因为通常依赖服务器设置的响应状态代码来通知客户端应用程序应该如何处理收到的响应。通过替换RESTful API的静态、显式架构，GraphQL增加了希望与之交互的开发人员的概念复杂性，因为现在他们的负担是以他们以前不必担心的方式理解响应。</p><p id="cd84" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">除了缺乏现成的状态代码操作，错误消息还可能变得模糊不清，因为当“null”响应字段是服务器中不存在的查询数据点的结果，而不是错误查询的结果，甚至是GraphQL安装部分的内部服务器错误时，这一点并不总是很清楚。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es kz"><img src="../Images/c4e32bf56819325dfba64b036dd43d58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*SGj7JxBpBM_ugPsc"/></div></div><figcaption class="kv kw et er es kx ky bd b be z dx translated">一个自鸣得意的绝地图书馆员像对待GraphQL一样不透明地处理着欧比-万的搜索请求。</figcaption></figure><p id="44bf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，使用GraphQL的这一方面已经为人所知很长时间了，市场上有很多现有的产品都包含了针对基于HTTP的GraphQL实现的某种版本的错误处理。一个是Apollo，它是一个强大的全功能平台，将自己定位为一个完整的数据管理解决方案；Relay，脸书的早期产品，为React应用而构建；和Hasura，一个用于数据库的“实时GraphQL API引擎”,等等。这些都是经过市场检验的、健壮的、非常有用的工具。那我们为什么决定自己做呢？</p><p id="3cdc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们希望构建一些东西，不需要像Apollo那样选择客户端和服务器之间的整个网络层生态系统，也不需要像Relay那样固执己见地看待如何处理服务器的响应。我们只是想要一些轻便、直接、容易起飞的东西。它不像是一个你必须采用的完整框架，更像是一个插件，让开发人员在与GraphQL服务器通信时更容易、更直观。我们知道我们将构建扩展graphql.js功能的代码，graphql . js是面向希望在graph QL领域工作的Javascript开发人员的简单的“香草”客户端。</p><p id="0b83" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从那以后，我们开始着手解决这个问题，在GraphQL和错误行为方面的大量文章的指导下，我们建立了一个测试环境，并探索了尽可能多的可能的错误场景。我们创建了一个“错误分类”来跟踪如何重现我们的错误，以及它们如何在从服务器发回的响应中表现出来。由此，我们讨论了如何对有用的错误处理语言进行逆向工程，以及何时改变与响应一起返回的默认200 OK状态代码，以使它们更符合RESTful状态编码。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es kz"><img src="../Images/da80cf235a2092938f068cff4e824ef6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7UX0A44ML_coOO_Y"/></div></div></figure><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es kz"><img src="../Images/c3bb4b17c9310ad7f5bbb1ea87cfc8d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*KqAP1wsQBRvUNr8O"/></div></div><figcaption class="kv kw et er es kx ky bd b be z dx translated">当我们试图全面理解与GraphQL服务器对话时潜在的错误出现点时，我们的一些工作文档。</figcaption></figure><p id="c02c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这个阶段，我们必须决定是直接在graphql.js上构建，还是引导express-graphql，这是graphql官方文档中推荐的一个流行的包，作为一种轻松启动和运行graphql服务器的方法。构建在express-graphql之上的一个明显的缺点是将我们的潜在用户锁定在使用express来处理他们的服务器设置。结果是，express-graphql已经带有内置逻辑，可以识别许多可能导致4xx响应的常见错误请求，因此我们可以将精力集中在它尚未处理的问题上。后来，我们可以扩展Elucid的能力，使其包含express-graphql所处理的内容，使我们的工具更加不可知。鉴于Express如此受欢迎，这在目前看来是一个公平的交易。</p><p id="399b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">尽管Express-graphql提供了可选的定制错误处理配置，但是它有一个默认的方式来处理它检测到的错误。此外，它为扩展提供了空间，这意味着我们可以为通过express-graphql错误检查的响应定义一些额外的后处理行为。在那里，我们可以通过定制的<code class="du lb lc ld le b">euclid()</code>函数开发错误发现和处理的第二层。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es lf"><img src="../Images/b940f0ae8e07092b7ddce262738f5e9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*v57QEjTQtBUKT6-Y"/></div></div><figcaption class="kv kw et er es kx ky bd b be z dx translated">这就是神奇的地方:就在您自己的GraphQL服务器设置中。</figcaption></figure><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es lg"><img src="../Images/b56e058f8ab434446fbf3ec1fcf60f14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xIp0eR46EG0Y0CSz"/></div></div><figcaption class="kv kw et er es kx ky bd b be z dx translated">深入了解Elucid的逻辑。</figcaption></figure><p id="9093" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们相信Elucid是目前GraphQL的Javascript实现中最简单的错误检测库。在未来，我们希望消除Elucid对express-graphql的依赖，使其成为真正独立的解决方案。我们希望您尝试一下，并发现它有助于照亮您自己项目的前进道路。</p><p id="e7f8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="jd">登陆</em></strong><a class="ae je" href="https://www.elucid.dev" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj"><em class="jd">www . Elucid . dev</em></strong></a>访问Elucid在线</p><p id="367e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="jd">有兴趣投稿或查看Elucid的代码？访问</em></strong><a class="ae je" href="https://github.com/oslabs-beta/Elucid" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj"><em class="jd">Github</em></strong></a><strong class="ih hj"><em class="jd">项目页面。</em>T13】</strong></p></div><div class="ab cl lh li gp lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="hb hc hd he hf"><p id="7eec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="jd">团队洗脱液是:</em> </strong></p><p id="325e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">Khayal Alasgarov:</em><a class="ae je" href="https://www.linkedin.com/in/khayal-alasgaroff/" rel="noopener ugc nofollow" target="_blank"><em class="jd">LinkedIn</em></a><em class="jd">|</em><a class="ae je" href="https://github.com/Alasgaroff" rel="noopener ugc nofollow" target="_blank"><em class="jd">Github</em></a></p><p id="d57d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">邬君梅</em> <a class="ae je" href="https://www.linkedin.com/in/viv-wu/" rel="noopener ugc nofollow" target="_blank"> <em class="jd">领英</em></a><em class="jd">|</em><a class="ae je" href="https://github.com/vw-in-github" rel="noopener ugc nofollow" target="_blank"><em class="jd">Github</em></a></p><p id="b27f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">斯潘塞深圳</em><a class="ae je" href="https://www.linkedin.com/in/spencer-szu" rel="noopener ugc nofollow" target="_blank"><em class="jd">LinkedIn</em></a><em class="jd">|</em><a class="ae je" href="https://github.com/Szuay" rel="noopener ugc nofollow" target="_blank"><em class="jd">Github</em></a></p><p id="41a5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">乔瓦尼雅各布奇</em> <a class="ae je" href="https://www.linkedin.com/in/gioiacobucci" rel="noopener ugc nofollow" target="_blank"> <em class="jd">领英</em></a><em class="jd">|</em><a class="ae je" href="https://github.com/garyiacobucci" rel="noopener ugc nofollow" target="_blank"><em class="jd">Github</em></a></p></div></div>    
</body>
</html>