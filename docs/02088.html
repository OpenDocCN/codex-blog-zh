<html>
<head>
<title>Set Up Django with Postgres, Nginx, and Gunicorn on Ubuntu 20.04</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Ubuntu 20.04上用Postgres、Nginx和Gunicorn设置Django</h1>
<blockquote>原文：<a href="https://medium.com/codex/set-up-django-with-postgres-nginx-and-gunicorn-on-ubuntu-20-04-a56c6a2f4675?source=collection_archive---------6-----------------------#2021-06-29">https://medium.com/codex/set-up-django-with-postgres-nginx-and-gunicorn-on-ubuntu-20-04-a56c6a2f4675?source=collection_archive---------6-----------------------#2021-06-29</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/4353566b4d3ca71164846443567d035f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l24lNB97Oy3EIAtjw2kWrw.jpeg"/></div></div></figure><h1 id="9d7d" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">介绍</h1><p id="5750" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">Django是一个开源的Python框架，可用于部署Python应用程序。它附带了一个开发服务器，用于在本地系统中测试您的Python代码。如果您想在生产环境中部署Python应用程序，那么您将需要一个强大且更安全的web服务器。在这种情况下，您可以使用Gunicorn作为WSGI HTTP服务器，使用Nginx作为代理服务器，以健壮的性能安全地为您的应用程序提供服务。</p><h1 id="6935" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">先决条件</h1><ul class=""><li id="bf8f" class="km kn hi jq b jr js jv jw jz ko kd kp kh kq kl kr ks kt ku bi translated">运行Ubuntu 20.04的服务器。</li><li id="4a66" class="km kn hi jq b jr kv jv kw jz kx kd ky kh kz kl kr ks kt ku bi translated">指向您的服务器IP的有效域名。</li><li id="d320" class="km kn hi jq b jr kv jv kw jz kx kd ky kh kz kl kr ks kt ku bi translated">您的服务器上配置了超级用户密码。</li></ul><h1 id="24d1" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">安装所需的软件包</h1><p id="12c8" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">首先，您需要在服务器上安装Nginx和其他Python依赖项。您可以使用以下命令安装所有软件包:</p><p id="93c0" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated"><code class="du lf lg lh li b">apt-get install python3-pip python3-dev libpq-dev curl nginx -y</code></p><p id="4377" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">安装完所有软件包后，启动Nginx服务，并使其能够在系统重启时启动:</p><p id="9f12" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated"><code class="du lf lg lh li b">systemctl start nginx</code></p><p id="231e" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated"><code class="du lf lg lh li b">systemctl enable nginx</code></p><h1 id="bf13" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">安装和配置PostgreSQL</h1><p id="9652" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">接下来，您需要在您的服务器上安装PostgreSQL服务器。您可以使用以下命令安装它:</p><p id="b16c" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated"><code class="du lf lg lh li b">apt-get install postgresql postgresql-contrib -y</code></p><p id="eb76" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">安装完成后，使用以下命令登录到PostgreSQL shell:</p><pre class="lj lk ll lm fd ln li lo lp aw lq bi"><span id="e9c0" class="lr ir hi li b fi ls lt l lu lv">su - postgres<br/>psql</span></pre><p id="169d" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">接下来，使用以下命令为Django创建一个数据库和用户:</p><pre class="lj lk ll lm fd ln li lo lp aw lq bi"><span id="47bd" class="lr ir hi li b fi ls lt l lu lv">CREATE DATABASE <br/>	djangodb;<br/>CREATE USER <br/>	djangouser <br/>	WITH PASSWORD 'password';</span></pre><p id="6a1c" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">接下来，使用以下命令授予一些必需的角色:</p><pre class="lj lk ll lm fd ln li lo lp aw lq bi"><span id="05a3" class="lr ir hi li b fi ls lt l lu lv">ALTER ROLE djangouser <br/>	SET client_encoding <br/>	TO 'utf8';<br/>ALTER ROLE djangouser <br/>	SET default_transaction_isolation <br/>	TO 'read committed';<br/>ALTER ROLE djangouser <br/>	SET timezone <br/>	TO 'UTC';<br/>GRANT ALL PRIVILEGES <br/>	ON DATABASE djangodb <br/>	TO djangouser;</span></pre><p id="81ad" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">接下来，使用以下命令退出PostgreSQL shell:</p><p id="eea9" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated"><code class="du lf lg lh li b">\qexit</code></p><h1 id="4ec3" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">创建一个Python虚拟环境</h1><p id="7a4a" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">接下来，您需要为Django项目创建一个Python虚拟环境。</p><p id="5e10" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">首先，将PIP包升级到最新版本:</p><pre class="lj lk ll lm fd ln li lo lp aw lq bi"><span id="8ec9" class="lr ir hi li b fi ls lt l lu lv">pip3 install --upgrade pip</span></pre><p id="bfce" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">接下来，使用以下命令安装virtualenv软件包:</p><pre class="lj lk ll lm fd ln li lo lp aw lq bi"><span id="7139" class="lr ir hi li b fi ls lt l lu lv">pip3 install virtualenv</span></pre><p id="d895" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">接下来，使用以下命令为Django项目创建一个目录:</p><pre class="lj lk ll lm fd ln li lo lp aw lq bi"><span id="d29d" class="lr ir hi li b fi ls lt l lu lv">mkdir ~/django_project</span></pre><p id="1b12" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">接下来，将目录更改为django_project，并创建一个django虚拟环境:</p><pre class="lj lk ll lm fd ln li lo lp aw lq bi"><span id="5394" class="lr ir hi li b fi ls lt l lu lv">cd ~/django_project<br/>virtualenv djangoenv</span></pre><p id="a1a6" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">接下来，激活Django虚拟环境:</p><pre class="lj lk ll lm fd ln li lo lp aw lq bi"><span id="f249" class="lr ir hi li b fi ls lt l lu lv">source djangoenv/bin/activate</span></pre><p id="7ee4" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">接下来，使用以下命令安装Django、Gunicorn和其他包:</p><pre class="lj lk ll lm fd ln li lo lp aw lq bi"><span id="43c3" class="lr ir hi li b fi ls lt l lu lv">pip install django gunicorn psycopg2-binary</span></pre><h1 id="467e" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">安装和配置Django</h1><p id="90a8" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">接下来，运行以下命令来创建Django项目:</p><pre class="lj lk ll lm fd ln li lo lp aw lq bi"><span id="e1dd" class="lr ir hi li b fi ls lt l lu lv">django-admin.py startproject django_project ~/django_project</span></pre><p id="dcf2" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">接下来，编辑settings.py并定义您的数据库设置:</p><pre class="lj lk ll lm fd ln li lo lp aw lq bi"><span id="29b7" class="lr ir hi li b fi ls lt l lu lv">nano ~/django_project/django_project/settings.py</span></pre><p id="9bcd" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">查找并更改以下行:</p><pre class="lj lk ll lm fd ln li lo lp aw lq bi"><span id="238d" class="lr ir hi li b fi ls lt l lu lv">ALLOWED_HOSTS = ['django.example.com', 'localhost']<br/>DATABASES = {  <br/>	'default': {     <br/>		'ENGINE': 'django.db.backends.postgresql_psycopg2',       <br/>		'NAME': 'djangodb',       <br/>		'USER': 'djangouser',        <br/>		'PASSWORD': 'password',        <br/>		'HOST': 'localhost',       <br/>		'PORT': '',    <br/>	}<br/>}<br/>STATIC_URL = '/static/'<br/>import os<br/>STATIC_ROOT = os.path.join(BASE_DIR, 'static/')</span></pre><p id="4adf" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">保存并关闭文件，然后将初始数据库模式迁移到PostgreSQL数据库:</p><pre class="lj lk ll lm fd ln li lo lp aw lq bi"><span id="49a1" class="lr ir hi li b fi ls lt l lu lv">./manage.py makemigrations<br/>./manage.py migrate</span></pre><p id="b1f6" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">接下来，使用以下命令创建一个管理员用户:</p><pre class="lj lk ll lm fd ln li lo lp aw lq bi"><span id="6d67" class="lr ir hi li b fi ls lt l lu lv">./manage.py createsuperuser</span></pre><p id="b48b" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">如下所示设置您的管理员用户名和密码:</p><pre class="lj lk ll lm fd ln li lo lp aw lq bi"><span id="d604" class="lr ir hi li b fi ls lt l lu lv">Username (leave blank to use 'root'): admin<br/>Email address: admin@example.com<br/>Password: <br/>Password (again): <br/>Superuser created successfully.</span></pre><p id="76f3" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">接下来，将所有静态内容收集到目录中</p><pre class="lj lk ll lm fd ln li lo lp aw lq bi"><span id="0faf" class="lr ir hi li b fi ls lt l lu lv">./manage.py collectstatic</span></pre><h1 id="ec33" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">测试Django开发服务器</h1><p id="ffa8" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">现在，使用以下命令启动Django开发服务器:</p><pre class="lj lk ll lm fd ln li lo lp aw lq bi"><span id="8606" class="lr ir hi li b fi ls lt l lu lv">./manage.py runserver 0.0.0.0:8000</span></pre><p id="3527" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">您应该会看到以下输出:</p><pre class="lj lk ll lm fd ln li lo lp aw lq bi"><span id="5412" class="lr ir hi li b fi ls lt l lu lv">Watching for file changes with StatReloader<br/>Performing system checks...<br/>System check identified no issues (0 silenced).<br/>June 22, 2021 - 11:15:57<br/>Django version 3.2.4, using settings 'django_project.settings'<br/>Starting development server at http://0.0.0.0:8000/<br/>Quit the server with CONTROL-C.</span></pre><p id="40f2" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">现在，打开您的网络浏览器，使用URL【http://django.example.com:8000/admin/. T2】访问您的Django应用程序，您将被重定向到Django登录页面:</p><figure class="lj lk ll lm fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lx"><img src="../Images/3e0732d1d6025aa9c6dcec51f6456a08.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*cKTlMGZyfW9a9czy.png"/></div></div></figure><p id="2592" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">提供您的管理员用户名和密码，然后点击登录。您应该在下一页看到Django仪表板:</p><figure class="lj lk ll lm fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lx"><img src="../Images/7979f7b64cf8117fa48315f293ca1b2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*WFVN4Mqb7fZ8gzCO.png"/></div></div></figure><p id="7578" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">现在，回到您的终端，按CTRL + C停止Django开发服务器。</p><h1 id="b3df" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">测试Gunicorn</h1><p id="050d" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">接下来，你需要测试Gunicorn是否能为Django服务。您可以使用以下命令启动Gunicorn服务器:</p><pre class="lj lk ll lm fd ln li lo lp aw lq bi"><span id="15b2" class="lr ir hi li b fi ls lt l lu lv">gunicorn --bind 0.0.0.0:8000 django_project.wsgi</span></pre><p id="3a7f" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">如果一切正常，您应该得到以下输出:</p><pre class="lj lk ll lm fd ln li lo lp aw lq bi"><span id="7320" class="lr ir hi li b fi ls lt l lu lv">[2021-06-22 11:20:02 +0000] [11820] [INFO] Starting gunicorn 20.1.0<br/>[2021-06-22 11:20:02 +0000] [11820] [INFO] Listening at: http://0.0.0.0:8000 (11820)<br/>[2021-06-22 11:20:02 +0000] [11820] [INFO] Using worker: sync<br/>[2021-06-22 11:20:02 +0000] [11822] [INFO] Booting worker with pid: 11822</span></pre><p id="f6fa" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">按下<strong class="jq hj"> CTRL + C </strong>停止Gunicorn服务器。</p><p id="c02c" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">接下来，使用以下命令停用Python虚拟环境:</p><pre class="lj lk ll lm fd ln li lo lp aw lq bi"><span id="b963" class="lr ir hi li b fi ls lt l lu lv">deactivate</span></pre><h1 id="05f0" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">为Gunicorn创建一个Systemd服务文件</h1><p id="beb2" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">为Gunicorn创建一个<code class="du lf lg lh li b">systemd</code>服务文件来启动和停止Django应用服务器是一个好主意。</p><p id="e285" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">为此，使用以下命令创建一个套接字文件:</p><pre class="lj lk ll lm fd ln li lo lp aw lq bi"><span id="6ccd" class="lr ir hi li b fi ls lt l lu lv">nano /etc/systemd/system/gunicorn.socket</span></pre><p id="d776" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">添加以下几行:</p><pre class="lj lk ll lm fd ln li lo lp aw lq bi"><span id="a789" class="lr ir hi li b fi ls lt l lu lv">[Unit]<br/>Description=gunicorn socket<br/>[Socket]ListenStream=/run/gunicorn.sock<br/>[Install]<br/>WantedBy=sockets.target</span></pre><p id="7837" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">保存并关闭文件，然后为Gunicorn创建一个服务文件:</p><pre class="lj lk ll lm fd ln li lo lp aw lq bi"><span id="3b0a" class="lr ir hi li b fi ls lt l lu lv">nano /etc/systemd/system/gunicorn.service</span></pre><p id="fe95" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">添加以下与Django项目路径匹配的行:</p><pre class="lj lk ll lm fd ln li lo lp aw lq bi"><span id="f7a7" class="lr ir hi li b fi ls lt l lu lv">[Unit]<br/>Description=gunicorn daemon<br/>Requires=gunicorn.socket<br/>After=network.target<br/>[Service]<br/>User=root<br/>Group=www-data<br/>WorkingDirectory=/root/django_project<br/>ExecStart=/root/django_project/djangoenv/bin/gunicorn --access-logfile - --workers 3 --bind <br/>unix:/run/gunicorn.sock          django_project.wsgi:application<br/>[Install]<br/>WantedBy=multi-user.target</span></pre><p id="7e25" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">保存并关闭文件，然后为Django项目目录设置适当的权限:</p><pre class="lj lk ll lm fd ln li lo lp aw lq bi"><span id="7fd2" class="lr ir hi li b fi ls lt l lu lv">chown -R www-data:root ~/django_project</span></pre><p id="67e8" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">接下来，使用以下命令重新加载<code class="du lf lg lh li b">systemd</code>守护进程:</p><pre class="lj lk ll lm fd ln li lo lp aw lq bi"><span id="44e1" class="lr ir hi li b fi ls lt l lu lv">systemctl daemon-reload</span></pre><p id="a23c" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">接下来，启动Gunicorn服务，并使其能够在系统重启时启动:</p><pre class="lj lk ll lm fd ln li lo lp aw lq bi"><span id="b883" class="lr ir hi li b fi ls lt l lu lv">systemctl start gunicorn.socket<br/>systemctl enable gunicorn.socket</span></pre><p id="f246" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">要检查Gunicorn的状态，请运行以下命令:</p><pre class="lj lk ll lm fd ln li lo lp aw lq bi"><span id="30b3" class="lr ir hi li b fi ls lt l lu lv">systemctl status gunicorn.socket</span></pre><p id="483d" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">您应该得到以下输出:</p><pre class="lj lk ll lm fd ln li lo lp aw lq bi"><span id="f0bc" class="lr ir hi li b fi ls lt l lu lv">● gunicorn.socket - gunicorn socket     <br/>Loaded: loaded (/etc/systemd/system/gunicorn.socket; enabled; vendor preset: enabled)     <br/>Active: active (running) since Tue 2021-06-22 12:05:05 UTC; 3min 7s ago   Triggers: ● gunicorn.service     <br/>Listen: /run/gunicorn.sock (Stream)     <br/>CGroup: /system.slice/gunicorn.socket<br/>Jun 22 12:05:05 django systemd[1]: Listening on gunicorn socket.</span></pre><h1 id="8846" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">将Nginx配置为Gunicorn应用程序的反向代理</h1><p id="ef16" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">接下来，您需要将Nginx配置为反向代理，以服务于Gunicorn应用服务器。</p><p id="7884" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">为此，创建一个Nginx配置文件:</p><pre class="lj lk ll lm fd ln li lo lp aw lq bi"><span id="3255" class="lr ir hi li b fi ls lt l lu lv">nano /etc/nginx/conf.d/django.conf</span></pre><p id="6fe1" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">添加以下几行:</p><pre class="lj lk ll lm fd ln li lo lp aw lq bi"><span id="9123" class="lr ir hi li b fi ls lt l lu lv">server {  <br/>	listen 80;     <br/>	server_name django.example.com;    <br/>	location = /favicon.ico { access_log off; log_not_found off; }    <br/>	location /static/ {         <br/>		root /root/django_project;     <br/>	}    <br/>	location / {         <br/>		include proxy_params;         <br/>		proxy_pass http://unix:/run/gunicorn.sock;     <br/>	}<br/>}</span></pre><p id="c0af" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">保存并关闭文件，然后验证Nginx是否存在任何配置错误:</p><pre class="lj lk ll lm fd ln li lo lp aw lq bi"><span id="d5bc" class="lr ir hi li b fi ls lt l lu lv">nginx -t</span></pre><p id="803b" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">输出:</p><pre class="lj lk ll lm fd ln li lo lp aw lq bi"><span id="fedc" class="lr ir hi li b fi ls lt l lu lv">nginx: the configuration file /etc/nginx/nginx.conf syntax is ok<br/>nginx: configuration file /etc/nginx/nginx.conf test is successful</span></pre><p id="f899" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">最后，重启Nginx服务以应用更改:</p><pre class="lj lk ll lm fd ln li lo lp aw lq bi"><span id="be74" class="lr ir hi li b fi ls lt l lu lv">systemctl restart nginx</span></pre><p id="4809" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">现在，您可以使用URL<a class="ae lw" href="http://django.example.com/admin." rel="noopener ugc nofollow" target="_blank">http://django.example.com/admin.</a>访问Django应用程序</p><h1 id="fd4b" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">结论</h1><p id="4019" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">在上面的指南中，您学习了如何使用Gunicorn和Nginx作为反向代理来部署Django应用程序。现在，您可以在生产环境中使用这种设置来部署安全和高性能的Python应用程序。</p><p id="ced5" class="pw-post-body-paragraph jo jp hi jq b jr la jt ju jv lb jx jy jz lc kb kc kd ld kf kg kh le kj kk kl hb bi translated">Gerry Sabar的专题图片:<a class="ae lw" href="https://gerrysabar.medium.com/deploying-django-3-nginx-postgre-to-ubuntu-18-04-vps-220c529b588" rel="noopener">https://gerrysabar . medium . com/deploying-django-3-nginx-postgre-to-Ubuntu-18-04-VPS-220 c 529 b 588</a>"</p></div></div>    
</body>
</html>