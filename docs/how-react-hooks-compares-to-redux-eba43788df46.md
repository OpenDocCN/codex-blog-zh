# hooks 如何简化 React 应用程序中的数据获取

> 原文：<https://medium.com/codex/how-react-hooks-compares-to-redux-eba43788df46?source=collection_archive---------2----------------------->

## [抄本](http://medium.com/codex)

![](img/348a9ee4caa51bc409ef50a47c178e59.png)

我是一名软件工程师，从事 react 工作已经四年多了。我仍然记得用`React.createClass`创建我的第一个 react 应用。我很快就被`state`和`props`的想法吸引住了。我坚信这是一种天才的 UI 表现方式。我很高兴我选择 react 作为主要的 UI 库，并坚持使用它。

但有一件事我从未真正完全领会——那就是全球状态管理库的作用。不要误会我的意思，我曾经用过所有值得注意的解决方案，比如 Redux、MobX、Unstated 等等。但是我一直对他们的方法和实现有疑问。抛开所有的顾虑和疑虑，我和 redux 合作到现在已经三年多了。我已经用 redux 编写了大尺寸的 react 应用程序，我可以很舒服地说我对 redux 了如指掌。

Redux 是一个很好的工具，并且很好地服务于这个目的，我绝不反对它。我只想分享我对它的爱恨情仇，以及 react hooks 如何简化我的前端应用程序中常见的重复出现的模式。

我们都知道 redux 因为过于罗嗦而名声不好。这在开始时可能感觉还好，但随着应用程序的发展，你会开始注意到一些问题，比如为同类任务写太多样板文件。有时很难决定什么`state`进入 redux 存储，什么存在于 react 组件中，例如 spinner 的加载状态等等。随着应用程序的增长，单一状态对象也在增长，变得非常复杂，很难维护。在我看来，redux 还通过引入诸如 reducers、thunks、sagas、middlewares 等概念增加了认知开销。所有这些都不是 redux 特有的，这些问题都有解决方案，但是我觉得在我转向 hooks 之前分享一下我的想法是很重要的。

最近，我开始研究新的 react hooks API，并决定通过完全使用 hooks 编写视图/屏幕来尝试一下。我明确决定不在这个视图中使用 redux。我使用 react 挂钩的第一件事是最常见和重复的场景——进行 API 调用。这是一个组件做的最简单和最常见的事情，在 redux 中有数百种方法可以做到。通常，您会在组件挂载时`dispatch`执行一个操作。您将设置一些状态来指示数据正在加载，以便您可以在 UI 上显示加载微调器。然后，异步地将接收到的数据或错误设置为状态，并更新标记，如`isLoading`、`isErrored`等。如果您想进行长时间轮询或某种出错重试策略，这很快就会变得很麻烦。所有这些逻辑通常都与组件生命周期相关联，很难在多个组件之间轻松共享这种通用功能。

Hooks 相当优雅地解决了这个问题(*我不打算解释它们是如何工作的*)。我编写了一个钩子来完成这个任务，我惊讶地发现获取数据、在请求发生时显示加载微调器以及处理错误(如果有的话)是多么容易。没有涉及全局状态，没有动作(和类型常量)，没有 sagas(和生成器函数和不必要的函数，如[调用](https://redux-saga.js.org/docs/api/#callfn-args))或 thunks。一切都是独立的，很容易理解。我真的很喜欢这样一个事实，我不必在几个地方为我的一个 API 调用定义多个状态——所有的东西都在一个地方，在钩子内部，在组件的本地。下面是我的钩子的代码:

使用 react 挂钩读取加载和错误状态的数据

它使用`useState`和`useEffect`挂钩。它有三个状态变量，即`data`、`isLoading`、`error`。如果组件卸载，它将取消网络调用，这很简单。在我看来，很明显，这个钩子比相同东西的 redux 实现要好。它是一个函数，负责一件事——不像 redux 实现，它是在动作和 reducers 之间共享的。

## 我已经为这个用例发布了一个钩子。它支持 api 调用、出错重试和轮询:[https://github.com/zaingz/use-axios-hooks](https://github.com/zaingz/use-axios-hooks)

我希望这篇文章对你有所帮助，并让你感兴趣。请分享，鼓掌，评论。我真的很期待你的反馈和想法。