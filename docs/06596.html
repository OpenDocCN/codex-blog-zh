<html>
<head>
<title>FaceBot 2.0 — Using 2.42" OLEDs over I2C with MicroPython</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">FaceBot 2.0 —在I2C上使用2.42英寸OLEDs和MicroPython</h1>
<blockquote>原文：<a href="https://medium.com/codex/facebot-2-0-using-2-42-oleds-over-i2c-with-micropython-923230fc2472?source=collection_archive---------8-----------------------#2022-05-03">https://medium.com/codex/facebot-2-0-using-2-42-oleds-over-i2c-with-micropython-923230fc2472?source=collection_archive---------8-----------------------#2022-05-03</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="498b" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">我们的新一代STEM教学机器人配有大显示屏，更容易连接，功能更强大。</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/bf55d00a556a4e34097d00ba544aae8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q2WwU9KRW7KgwtfxpfbS0w.jpeg"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">2.42英寸有机发光二极管显示器由一个4线I2C接口驱动，带有一根额外的复位线。作者照片。</figcaption></figure><p id="e59b" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在2019年1月的<a class="ae kj" href="https://www.instructables.com/FaceBot/" rel="noopener ugc nofollow" target="_blank">日，我们当地的CoderDojo俱乐部发布了我们的第一款低成本(40美元)机器人，它可以在明亮的有机发光二极管显示器上绘制人脸。然而，这些机器人很难安装和编程。这篇博客将向您展示我们的下一代Python驱动的FaceBot如何使用一个Grove连接器和一根额外的复位线来工作。</a></p><h2 id="56d8" class="kk kl hi bd km kn ko kp kq kr ks kt ku jw kv kw kx ka ky kz la ke lb lc ld le bi translated">FaceBot 1.0的背景</h2><p id="db2c" class="pw-post-body-paragraph jn jo hi jp b jq lf ij js jt lg im jv jw lh jy jz ka li kc kd ke lj kg kh ki hb bi translated">我们的学生喜欢机器人！他们非常擅长让学生在无意中学习计算思维的同时获得乐趣。尽管市场上有数百种机器人，但很少有足够强大和足够低成本的机器人来驱动一个完整的128X64有机发光二极管显示器。他们较旧的Arduino处理器受到2K内存的限制，无法满足图形编程的需求。</p><p id="477f" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">虽然我们确实让FaceBot 1.0工作了，但它有几个挑战:</p><ol class=""><li id="e339" class="lk ll hi jp b jq jr jt ju jw lm ka ln ke lo ki lp lq lr ls bi translated"><strong class="jp hj">有限的内存</strong>—Arduino Nano只有微不足道的2K内存，这意味着图形帧缓冲区占用了大部分内存。</li><li id="ea57" class="lk ll hi jp b jq lt jt lu jw lv ka lw ke lx ki lp lq lr ls bi translated"><strong class="jp hj">有限的CPU能力</strong>——我们旧的Arduinos只有一个单核CPU，运行速度缓慢，为16 Mhz。</li><li id="89d1" class="lk ll hi jp b jq lt jt lu jw lv ka lw ke lx ki lp lq lr ls bi translated"><strong class="jp hj">古老的C编程— </strong>学生被要求学习历史上重要但现在不受欢迎的C语言。</li><li id="76cc" class="lk ll hi jp b jq lt jt lu jw lv ka lw ke lx ki lp lq lr ls bi translated"><strong class="jp hj">缓慢的编译/链接/测试周期</strong> —每次学生想要测试他们的代码时，都必须编译和下载C程序。这对小程序来说没问题，但是随着我们的程序越来越大，开发周期会变慢。</li><li id="99af" class="lk ll hi jp b jq lt jt lu jw lv ka lw ke lx ki lp lq lr ls bi translated"><strong class="jp hj">小型OLED太难阅读</strong> —小型0.96英寸低成本(4美元)OLED太小，无法近距离阅读。当你的机器人在地板上，而你是站着的时候，显示可读性是一个问题。</li><li id="303c" class="lk ll hi jp b jq lt jt lu jw lv ka lw ke lx ki lp lq lr ls bi translated"><strong class="jp hj">更大的OLED太难连接</strong>——可爱的<a class="ae kj" href="https://www.ebay.com/sch/i.html?_from=R40&amp;_trksid=p2334524.m570.l1313&amp;_nkw=2.42%22+oled+128*64+ssd1309+display+SPI+I2C&amp;_sacat=0&amp;LH_TitleDesc=0&amp;_odkw=2.42%22+oled+128*64+ssd1309+display&amp;_osacat=0" rel="noopener ugc nofollow" target="_blank"> 2.42英寸OLED</a>价格约为18美元，需要七根电线使用<a class="ae kj" href="https://en.wikipedia.org/wiki/Serial_Peripheral_Interface" rel="noopener ugc nofollow" target="_blank"> SPI </a>连接。这些占用了我们微控制器上的大量I/O引脚。</li></ol><p id="4e66" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">我们了解到我们的学生喜欢这些机器人，喜欢在机器人上画脸，尽管有这些缺点。我们经常故意给他们非常沉闷的脸，并挑战他们用新的创造性的方式来画这些脸。</p><p id="6ddf" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">这里有一个简单的机器人面部图像样本，来自2021年的一篇研究论文:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ly"><img src="../Images/9b144a1596b87aaa09d9ce3fc0fee0da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B2wpUoUQgFEEQ_22UNbozg.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">九种情绪的面部结构样本。这张图片取自《对混合面孔机器人的情感反应》一文，并翻译成《消费者社交机器人》。我们的“快乐”机器人倾向于在没有碰撞的情况下向前行驶。即将与墙壁相撞的机器人可能会表现出“惊讶”的表情。</figcaption></figure><h2 id="2530" class="kk kl hi bd km kn ko kp kq kr ks kt ku jw kv kw kx ka ky kz la ke lb lc ld le bi translated">FaceBot 2.0的目标</h2><p id="8e55" class="pw-post-body-paragraph jn jo hi jp b jq lf ij js jt lg im jv jw lh jy jz ka li kc kd ke lj kg kh ki hb bi translated">考虑到这些限制，我们希望设计我们的下一代儿童友好型低成本FaceBot，使其具有以下特征:</p><ol class=""><li id="2580" class="lk ll hi jp b jq jr jt ju jw lm ka ln ke lo ki lp lq lr ls bi translated">它必须100%用Python(微控制器的技术MicroPython)编程。这是我们的孩子喜欢的流行编程语言。</li><li id="caee" class="lk ll hi jp b jq lt jt lu jw lv ka lw ke lx ki lp lq lr ls bi translated">它应该限制焊接和连接的数量。</li><li id="938f" class="lk ll hi jp b jq lt jt lu jw lv ka lw ke lx ki lp lq lr ls bi translated">它应该有足够的内存来支持128X64单色显示器的帧缓冲区。</li><li id="ce2b" class="lk ll hi jp b jq lt jt lu jw lv ka lw ke lx ki lp lq lr ls bi translated">它应该支持可爱的有机发光二极管显示器，并尽量减少电线的数量。</li></ol><h2 id="2cac" class="kk kl hi bd km kn ko kp kq kr ks kt ku jw kv kw kx ka ky kz la ke lb lc ld le bi translated">Raspberry Pi Pico和Cytron Maker Pi RP2040</h2><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lz"><img src="../Images/8e008ec2d8acd0d7f6ec3e089bf60ecc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*x_EJvIf7JZ2nbg6r"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">这张照片是Cytron制造商Pi RP2040，带有七个Grove连接器，没有显示屏。这个机器人是我们面部机器人的基础。我们面临的挑战是连接SPI显示器占用了三个完整的连接器，并导致未使用的连接。</figcaption></figure><p id="ed79" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">2021年1月，我们惊讶地发现Raspberry Pi基金会发布了他们的RP2040处理器和Pico板。它不仅有足够的内存(264K)，而且可以直接用Python编程。这些处理器也快得多(比旧的16 MHz Arduino Nano快133 MHz)，使它们有足够的能力在脸上绘制复杂的图形。双核还提供了专用整个内核的可能性，以便在不中断传感器读数的情况下保持显示最新。它非常适合我们的FaceBot 2.0。</p><p id="5592" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">几个月后，Cytron推出了一款基于RP2040的机器人控制器板，将电机驱动器和电源管理直接集成在一块板上，成本仅为9.99美元。我回顾了2021年8月在<a class="ae kj" href="https://dmccreary.medium.com/the-cytron-maker-pi-rp2040-robotics-board-b1dc7f0eab34" rel="noopener">的这块板。看到价格不到10美元、完全集成、功能丰富的主板真是太棒了。任何在机器人控制器上花费超过10美元的人都需要看看这个板！</a></p><h2 id="41e6" class="kk kl hi bd km kn ko kp kq kr ks kt ku jw kv kw kx ka ky kz la ke lb lc ld le bi translated">将SPI连接到Cytron板Grove连接器</h2><p id="994b" class="pw-post-body-paragraph jn jo hi jp b jq lf ij js jt lg im jv jw lh jy jz ka li kc kd ke lj kg kh ki hb bi translated">我们确实将OLEDs连接到了这个主板上，但是有一个大问题——DIY more提供的主板的默认连接器。CC 所需<strong class="jp hj">七根</strong>电线！一根用于GND，一根用于VCC，五根数据线。这导致我们用光了三个Grove连接器。这是低效的，并且限制了我们留在机器人上的自由连接器的数量。我们很沮丧！如此接近，但还远远没有实现我们的FaceBot 2.0的愿景！</p><h2 id="5647" class="kk kl hi bd km kn ko kp kq kr ks kt ku jw kv kw kx ka ky kz la ke lb lc ld le bi translated">失败的企业向I2C转化</h2><p id="eb18" class="pw-post-body-paragraph jn jo hi jp b jq lf ij js jt lg im jv jw lh jy jz ka li kc kd ke lj kg kh ki hb bi translated">有机发光二极管显示器的背面有将板从默认SPI转换为使用更简单的4线I2C接口的说明。但是，尽管我努力了几个小时，我还是无法让SPI接口与我们的Raspberry Pi Pico或Cytron Maker Pi RP2040板配合工作。我会严格按照说明进行操作，但每次我这样做时，基本的i2c扫描仪都会空空如也。我尝试将CS、DC和RES信号连接到不同的位置，但没有成功。我不知道是我的硬件坏了，还是我的电线没有正确连接，或者是I2C的Python驱动程序与主板不兼容。当我将逻辑分析仪连接到线路上时，我可以看到数据和时钟信号都进入显示器，但我无法显示任何内容。</p><h2 id="f780" class="kk kl hi bd km kn ko kp kq kr ks kt ku jw kv kw kx ka ky kz la ke lb lc ld le bi translated">一个朋友的小小帮助</h2><p id="214c" class="pw-post-body-paragraph jn jo hi jp b jq lf ij js jt lg im jv jw lh jy jz ka li kc kd ke lj kg kh ki hb bi translated">然后在三月初，我向一个我称之为WP的朋友表达了我的沮丧。WP也有一个兄弟有一些不错的调试能力。他们订购了类似的零件，有一天我收到一封电子邮件，告诉我他们终于让它工作了！虽然他们不能像我们其他较小的有机发光二极管显示器一样使用标准的4线Grove连接器，但他们可以通过向显示器添加一条额外的复位线来让它工作。</p><h2 id="dec5" class="kk kl hi bd km kn ko kp kq kr ks kt ku jw kv kw kx ka ky kz la ke lb lc ld le bi translated">解决方案:I2C + 1</h2><p id="ac6b" class="pw-post-body-paragraph jn jo hi jp b jq lf ij js jt lg im jv jw lh jy jz ka li kc kd ke lj kg kh ki hb bi translated">我们使用该设备的问题是，当显示器通电时，我们没有重置显示器驱动程序。这是因为大多数其他I2C设备只需要四根线:GND、VCC、数据和时钟。当设备通电时，它们是“智能”的，因为它们在通电后仅几毫秒就将自己复位到已知的开始。DIYMORE有机发光二极管设备要求我们总是在上电后和显示器使用前拉高复位引脚。完成这项工作的MicroPython代码如下所示。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ma"><img src="../Images/c294c15068758cbd2d130986889b7a3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9gFn78IvR3nYYSE2ysU9sQ.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">启动有机发光二极管显示的示例MicroPython代码。第6–9行用于在显示器醒来接收I2C数据流之前复位显示器。图片由作者提供。</figcaption></figure><p id="39a7" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">虽然我们可以使用另一个Grove连接器来完成这一重置，但我们还有另一个选择。也就是说，只需将RESET引脚连接到Maker Pi RP2040板角落的伺服跳线。我们只需要一件简单的女性套衫！只要你的机器人没有使用所有四个伺服电机，我们就可以了！</p><h2 id="f56c" class="kk kl hi bd km kn ko kp kq kr ks kt ku jw kv kw kx ka ky kz la ke lb lc ld le bi translated">关于如何移动电路板背面电阻的详细信息</h2><p id="4b37" class="pw-post-body-paragraph jn jo hi jp b jq lf ij js jt lg im jv jw lh jy jz ka li kc kd ke lj kg kh ki hb bi translated">这个项目的一个挑战是移动DIYMORE板后面的跳线需要烙铁、精细的运动技能和稳定的手。以下是我们需要做出的更改的摘要:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mb"><img src="../Images/61c44544bfc32c966be8fc3aadfde557.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C12pAwQ1_krfOUNao8PFoA.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">我们对DIYMORE有机发光二极管显示器进行了三项更改，将其从SPI转换为I2C。这张图片取自YouTube上<a class="ae kj" href="https://www.youtube.com/channel/UCjVos-XiTG6qZL4bPPRLEsA" rel="noopener ugc nofollow" target="_blank"> retrofriends </a>提供的视频。</figcaption></figure><p id="1ab0" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">YouTube上的用户retrofriends提供了一段视频，展示了这些步骤:</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mc md l"/></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">视频显示了如何更改跳线设置，将有机发光二极管从SPI出厂设置转换为使用I2C接口。感谢YouTube频道retrofriends提供指导。</figcaption></figure><p id="5f8a" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">我们现在终于实现了我们对FaceBot 2.0的低成本和易于连接的界面的愿景。</p><h2 id="2279" class="kk kl hi bd km kn ko kp kq kr ks kt ku jw kv kw kx ka ky kz la ke lb lc ld le bi translated">以对朋友的感激结束</h2><p id="ea67" class="pw-post-body-paragraph jn jo hi jp b jq lf ij js jt lg im jv jw lh jy jz ka li kc kd ke lj kg kh ki hb bi translated">回顾这个项目，我意识到，如果我更有耐心，花时间阅读SSD1309芯片的数据手册，我可能已经从理论上解决了这个问题。但是，也许我永远也想不出来！这件事教会我的是，在你的人际网络中拥有一群拥有正确技能和经验的好朋友来补充你自己的技能，会比试图自己做所有事情让你在实现目标的道路上走得更远。</p><p id="5eb1" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">我只想对WP和他的兄弟表示衷心的感谢和感激，感谢他们帮助了我们的小CoderDojo俱乐部。我希望其他教孩子如何编码的人能从这项工作中受益。</p><h2 id="b0b5" class="kk kl hi bd km kn ko kp kq kr ks kt ku jw kv kw kx ka ky kz la ke lb lc ld le bi translated">更多探索</h2><p id="b048" class="pw-post-body-paragraph jn jo hi jp b jq lf ij js jt lg im jv jw lh jy jz ka li kc kd ke lj kg kh ki hb bi translated">你可以在CoderDojoTC微型网站上找到更多关于我们的<a class="ae kj" href="https://www.coderdojotc.org/python/trinket/00-introduction/" rel="noopener ugc nofollow" target="_blank">初级Python </a>、<a class="ae kj" href="https://www.coderdojotc.org/micropython/" rel="noopener ugc nofollow" target="_blank"> MicroPython </a>和我们新一代低成本<a class="ae kj" href="https://www.coderdojotc.org/micropython/robots/01-intro/" rel="noopener ugc nofollow" target="_blank">机器人</a>的信息。请在LinkedIn或我的博客上关注我，关注我们未来的FaceBot 2.0课程。</p></div></div>    
</body>
</html>