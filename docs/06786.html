<html>
<head>
<title>Configure FreeRADIUS to use MySql on Linux.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">配置FreeRADIUS在Linux上使用MySql。</h1>
<blockquote>原文：<a href="https://medium.com/codex/configure-freeradius-to-use-mysql-on-linux-95fa546cc3a7?source=collection_archive---------2-----------------------#2022-05-13">https://medium.com/codex/configure-freeradius-to-use-mysql-on-linux-95fa546cc3a7?source=collection_archive---------2-----------------------#2022-05-13</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/9079e68a51a306395e323da726b58e38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wSUxvlgkMdcVdT8h_1JfpA.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">马库斯·斯皮斯克在<a class="ae iu" href="https://unsplash.com/s/photos/authentication?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="7f53" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">由于工作原因，我不得不在Linux服务器上配置FreeRADIUS(Ubuntu和Red Hat ),这花费了我很多时间来获得所有的信息来完成这个任务。因此，我想用我收集的所有信息写一个介绍性的指南，以便为应该完成同样任务的人减轻工作负担。</p><h2 id="8b7f" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">什么是FreeRADIUS？</h2><p id="69bb" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated"><strong class="ix hj"> FreeRADIUS </strong>是RADIUS的开源实现，RADIUS是用于AAA的IETF协议(<a class="ae iu" href="https://networkradius.com/blog/security/authorization-authorized-personnel-only/index.html" rel="noopener ugc nofollow" target="_blank">授权</a>、<a class="ae iu" href="https://networkradius.com/blog/security/authentication-is-it-really-you-part-1-of-our-3-part-series/index.html" rel="noopener ugc nofollow" target="_blank">认证</a>和<a class="ae iu" href="https://networkradius.com/blog/security/accounting-keeping-track-of-it-all-part-3-of-our-3-part-series/index.html" rel="noopener ugc nofollow" target="_blank">记账</a>)。更多信息可以在FreeRADIUS网站上找到，在那里你可以找到<a class="ae iu" href="https://freeradius.org/documentation/#getting_started" rel="noopener ugc nofollow" target="_blank">整个文档</a>以及<a class="ae iu" href="https://wiki.freeradius.org/guide/Getting%20Started" rel="noopener ugc nofollow" target="_blank">快速启动指南</a>来快速启动你的RADIUS服务器。</p><h2 id="04f1" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">安装。</h2><p id="dba3" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">基于Linux Debian和基于Centos的FreeRADIUS的安装和配置略有不同。这主要是因为您可以在不同的文件夹中找到配置文件。</p><p id="8120" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">以下指南是为RHEL8和Ubuntu 20.04.3 LTS版编写的。对于每一步，您都可以找到适用于Ubuntu和Red Hat的指令(如果未指定，则意味着这两种环境下的指令是相同的)。</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="abc7" class="jt ju hi ky b fi lc ld l le lf">#Installation on Ubuntu<br/>apt-get install freeradius freeradius-mysql freeradius-utils</span><span id="07f1" class="jt ju hi ky b fi lg ld l le lf">#Installation on RedHat<br/>yum install freeradius freeradius-utils freeradius-mysql freeradius-perl</span></pre><h2 id="d531" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">安装MySQL服务器。</h2><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="4d0f" class="jt ju hi ky b fi lc ld l le lf">#RedHat<br/>yum install mysql-server</span><span id="71a7" class="jt ju hi ky b fi lg ld l le lf">#Ubuntu<br/>apt-install mysql-server</span></pre><h2 id="c776" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">启动MySQL服务器</h2><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="55dd" class="jt ju hi ky b fi lc ld l le lf">#RedHat<br/>service mysqld start</span><span id="69c8" class="jt ju hi ky b fi lg ld l le lf">#Ubuntu<br/>systemctl start mysql.service</span></pre><h2 id="b347" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">MySQL服务器配置。</h2><p id="a40b" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">默认情况下，<strong class="ix hj"> FreeRADIUS </strong>从配置文件中读取记账和认证信息。如果您想设置FreeRADIUS从一个<strong class="ix hj"> MySQL </strong>数据库中读取信息，请使用以下步骤。</p><p id="332a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">首先，运行工具来配置安全安装</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="2e6e" class="jt ju hi ky b fi lc ld l le lf">mysql_secure_installation</span></pre><p id="fe30" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">根据用户/密码和安全性方面的需要，回答以下问题。我的情况，回答如下。</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="c23b" class="jt ju hi ky b fi lc ld l le lf">Enter current password <strong class="ky hj">for</strong> <!-- -->root (enter <strong class="ky hj">for</strong> <!-- -->none): ENTER</span><span id="30de" class="jt ju hi ky b fi lg ld l le lf">Set root password? [Y/n] y</span><span id="f9c9" class="jt ju hi ky b fi lg ld l le lf">New password: Enter password</span><span id="fb3b" class="jt ju hi ky b fi lg ld l le lf">Re-enter <strong class="ky hj">new</strong> <!-- -->password: Repeat password</span><span id="3a2c" class="jt ju hi ky b fi lg ld l le lf">Remove anonymous users? [Y/n]: Y</span><span id="d677" class="jt ju hi ky b fi lg ld l le lf">Disallow root login remotely? [Y/n]: Y</span><span id="9609" class="jt ju hi ky b fi lg ld l le lf">Remove test database and access to it? [Y/n]: Y</span><span id="a999" class="jt ju hi ky b fi lg ld l le lf">Reload privilege tables now? [Y/n]: Y</span></pre><p id="9da2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，我们必须创建radius数据库。它是指FreeRADIUS从其中读取会计和授权信息的数据库。首先，我们登录MySQL并创建一个数据库，我们称之为<strong class="ix hj"><em class="lh"/></strong>。密码下面是您在上一步中配置的用于访问MySQL的root密码。</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="4f38" class="jt ju hi ky b fi lc ld l le lf">mysql -uroot -ppassworddatabase</span><span id="048f" class="jt ju hi ky b fi lg ld l le lf">mysql&gt; CREATE DATABASE radius;</span><span id="f2d7" class="jt ju hi ky b fi lg ld l le lf">mysql&gt; exit;</span></pre><p id="9d77" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">一旦我们有了数据库，我们必须创建所需的表。这可能很乏味，但幸运的是，FreeRADIUS MySQL包包含创建这些表的查询和模式。要导入架构并填充radius DB，请运行以下命令。</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="fb05" class="jt ju hi ky b fi lc ld l le lf">#Reh Hat<br/>mysql -uroot -ppassword radius &lt; /etc/raddb/mods-config/sql/main/mysql/schema.sql</span><span id="62a6" class="jt ju hi ky b fi lg ld l le lf">#Ubuntu<br/>mysql -uroot -ppassword radius &lt; /etc/freeradius/3.0/mods-config/sql/main/mysql/schema.sql</span></pre><p id="c689" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在我们必须启用<strong class="ix hj"> <em class="lh"> sql </em> </strong>模块，这可以通过在<strong class="ix hj"> <em class="lh"> sql </em> </strong>模块之间创建一个软链接来完成，该模块位于文件夹mods-available和文件夹mods-enabled上。</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="6119" class="jt ju hi ky b fi lc ld l le lf">#Red Hat<br/>ln -s /etc/raddb/mods-available/sql /etc/raddb/mods-enabled/</span><span id="077f" class="jt ju hi ky b fi lg ld l le lf">#Ubuntu<br/>ln -s /etc/freeradius/3.0/mods-available/sql /etc/freeradius/3.0/mods-enabled/</span></pre><p id="01e1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了配置FreeRADIUS以使用我们刚刚创建的RADIUS数据库，我们必须编辑两个文件:</p><ul class=""><li id="b01b" class="li lj hi ix b iy iz jc jd jg lk jk ll jo lm js ln lo lp lq bi translated">/etc/raddb/mods下的文件<strong class="ix hj"><em class="lh">SQL</em></strong>——可用(Red Hat上)和/etc/freeradius/3.0/mods下的文件——可用(Ubuntu上)</li><li id="ba75" class="li lj hi ix b iy lr jc ls jg lt jk lu jo lv js ln lo lp lq bi translated">文件<strong class="ix hj"> <em class="lh">默认</em> </strong>在/etc/raddb/sites-enabled下(在Red Hat上)和/etc/freeradius/3.0/sites-enabled下(在Ubuntu上)</li></ul><p id="1576" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们从第一个文件开始。这里，我们必须配置FreeRADIUS连接到RADIUS数据库所需的信息。关于这个文件的一些提示。与FreeRADIUS的许多配置文件一样，这个文件比下面的文件长得多，因为所有的配置文件都有许多被注释掉的行，这些行主要是关于配置的提示。这里有很多解释，我建议你看看这些评论，了解如何配置你的服务器。它们真的很有用，很有解释力。</p><p id="86f7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">下面只是一个摘要，其中包含了您需要更改的主要信息。关于这个文件的一些提示。</p><ul class=""><li id="2e57" class="li lj hi ix b iy iz jc jd jg lk jk ll jo lm js ln lo lp lq bi translated">密码字段是您在上面的一些步骤中配置的MySQL密码。</li><li id="27ac" class="li lj hi ix b iy lr jc ls jg lt jk lu jo lv js ln lo lp lq bi translated">作为驱动和方言，你得配置MySQL。这通知FreeRADIUS您正在使用MySQL作为SQL数据库。</li><li id="2b6e" class="li lj hi ix b iy lr jc ls jg lt jk lu jo lv js ln lo lp lq bi translated"><strong class="ix hj"><em class="lh">radius _ db = " radius "</em></strong>是指FreeRADIUS要使用一个叫做<strong class="ix hj"><em class="lh">【radius】</em></strong>的MySQL数据库，就是我们之前配置的那个。因此，如果您使用了另一个名称，请相应地更改下面的文件。</li><li id="a740" class="li lj hi ix b iy lr jc ls jg lt jk lu jo lv js ln lo lp lq bi translated"><strong class="ix hj"><em class="lh">client _ table = " nas "</em></strong>通知FreeRADIUS关于NAS客户端的信息在一个名为<strong class="ix hj"> <em class="lh"> "nas "的表中。</em> </strong></li><li id="8472" class="li lj hi ix b iy lr jc ls jg lt jk lu jo lv js ln lo lp lq bi translated">如果下面的信息有注释，请取消注释。</li></ul><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="433e" class="jt ju hi ky b fi lc ld l le lf">sql {</span><span id="6230" class="jt ju hi ky b fi lg ld l le lf">driver = "rlm_sql_mysql"</span><span id="d301" class="jt ju hi ky b fi lg ld l le lf">dialect = "mysql"</span><span id="b5da" class="jt ju hi ky b fi lg ld l le lf"># Connection info:</span><span id="e561" class="jt ju hi ky b fi lg ld l le lf">server = "localhost"</span><span id="a74d" class="jt ju hi ky b fi lg ld l le lf">port = 3306</span><span id="97bd" class="jt ju hi ky b fi lg ld l le lf">login = "radius"</span><span id="f151" class="jt ju hi ky b fi lg ld l le lf">password = "radiuspassword"</span><span id="e764" class="jt ju hi ky b fi lg ld l le lf"># Database table configuration <strong class="ky hj">for</strong> <!-- -->everything except Oracle</span><span id="ef25" class="jt ju hi ky b fi lg ld l le lf">radius_db = "radius"</span><span id="3be4" class="jt ju hi ky b fi lg ld l le lf">}</span><span id="9309" class="jt ju hi ky b fi lg ld l le lf">read_clients = yes</span><span id="6c04" class="jt ju hi ky b fi lg ld l le lf">client_table = “nas”</span></pre><p id="012d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">第二个文件通知FreeRADIUS使用数据库或配置文件来查找有关授权和记帐的信息。默认情况下，sql标记被注释掉(因为默认情况下，FreeRADIUS使用配置文件进行所有关于记帐、授权等操作)。因此，取消authorize、accounting、post-auth、session部分下的sql标记的注释。您应该得到类似下面的文件。</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="104d" class="jt ju hi ky b fi lc ld l le lf">authorize {</span><span id="46b9" class="jt ju hi ky b fi lg ld l le lf">.....</span><span id="3d0c" class="jt ju hi ky b fi lg ld l le lf">sql</span><span id="835c" class="jt ju hi ky b fi lg ld l le lf">....</span><span id="93e0" class="jt ju hi ky b fi lg ld l le lf">}</span><span id="7ec8" class="jt ju hi ky b fi lg ld l le lf">accounting {</span><span id="980a" class="jt ju hi ky b fi lg ld l le lf">......</span><span id="f7c2" class="jt ju hi ky b fi lg ld l le lf">sql</span><span id="aaf0" class="jt ju hi ky b fi lg ld l le lf">....</span><span id="72b8" class="jt ju hi ky b fi lg ld l le lf">}</span><span id="9494" class="jt ju hi ky b fi lg ld l le lf">post-auth {</span><span id="fd85" class="jt ju hi ky b fi lg ld l le lf">......</span><span id="b569" class="jt ju hi ky b fi lg ld l le lf">sql</span><span id="6040" class="jt ju hi ky b fi lg ld l le lf">....</span><span id="128b" class="jt ju hi ky b fi lg ld l le lf">}</span><span id="20c7" class="jt ju hi ky b fi lg ld l le lf">session{</span><span id="743b" class="jt ju hi ky b fi lg ld l le lf">......</span><span id="f2f8" class="jt ju hi ky b fi lg ld l le lf">sql</span><span id="b3c6" class="jt ju hi ky b fi lg ld l le lf">.....}</span></pre><p id="d0a4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在我的情况下，当我试图启动FreeRADIUS时，我有一个SSL证书找不到的错误。要避免这个错误，只需取消/etc/raddb/mods-enabled(在Red Hat上)和/etc/freeradius/3.0/MODS-enabled(在Ubuntu上)下的文件<strong class="ix hj"> sql </strong>中与TLS加密相关的部分的注释即可。</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="82b9" class="jt ju hi ky b fi lc ld l le lf">mysql {</span><span id="cabc" class="jt ju hi ky b fi lg ld l le lf"># If any of the files below are set, TLS encryption is enabled</span><span id="f7a9" class="jt ju hi ky b fi lg ld l le lf">tls {</span><span id="ef46" class="jt ju hi ky b fi lg ld l le lf">#ca_file = "/etc/ssl/certs/my_ca.crt"</span><span id="abda" class="jt ju hi ky b fi lg ld l le lf">#ca_path = "/etc/ssl/certs/"</span><span id="4756" class="jt ju hi ky b fi lg ld l le lf">#certificate_file = "/etc/ssl/certs/private/client.crt"</span><span id="279c" class="jt ju hi ky b fi lg ld l le lf">#private_key_file = "/etc/ssl/certs/private/client.key"</span><span id="74a1" class="jt ju hi ky b fi lg ld l le lf">#cipher = "...."</span><span id="a65a" class="jt ju hi ky b fi lg ld l le lf">#tls_required = yes</span><span id="1259" class="jt ju hi ky b fi lg ld l le lf">#tls_check_cert = no</span><span id="821b" class="jt ju hi ky b fi lg ld l le lf">#tls_check_cert_cn = no</span><span id="2fb5" class="jt ju hi ky b fi lg ld l le lf">}</span><span id="0412" class="jt ju hi ky b fi lg ld l le lf"># If yes, (or auto and libmysqlclient reports warnings are</span><span id="ac49" class="jt ju hi ky b fi lg ld l le lf"># available), will retrieve and log additional warnings from</span><span id="0872" class="jt ju hi ky b fi lg ld l le lf"># the server <strong class="ky hj">if</strong> <!-- -->an error has occured. Defaults to 'auto'</span><span id="5940" class="jt ju hi ky b fi lg ld l le lf">warnings = auto</span><span id="6085" class="jt ju hi ky b fi lg ld l le lf">}</span></pre><h2 id="6d75" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">开始FreeRADIUS。</h2><p id="50df" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">要在调试模式下启动Freeradius，请运行以下命令:</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="5304" class="jt ju hi ky b fi lc ld l le lf">#Red Hat<br/>radiusd -X</span><span id="a244" class="jt ju hi ky b fi lg ld l le lf">#Ubuntu<br/>freeradius -X</span></pre><p id="1575" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">大多数时候，每次我运行上面的命令，我都会遇到一个错误，默认端口已经被使用。当FreeRADIUS守护程序已经启动时，会发生这种情况。在这种情况下，使用以下命令终止守护程序</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="6c0c" class="jt ju hi ky b fi lc ld l le lf">pkill radiusd</span></pre><p id="08b8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">再试一次。</p><h2 id="49b4" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">测试配置。</h2><p id="7acb" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">为了测试radius服务器是否收到认证请求，我们可以使用FreeRADIUS实用程序提供的<strong class="ix hj"> <em class="lh"> radtest </em> </strong>工具。</p><p id="3830" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最初，您可以使用下面的命令测试本地主机。</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="ce4d" class="jt ju hi ky b fi lc ld l le lf">radtest testing password 127.0.0.1<!-- --> <!-- -->0<!-- --> <!-- -->testing123</span></pre><p id="dad8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">上面的命令可以这样理解。认证为<strong class="ix hj">测试/密码</strong>的用户向本地主机发送认证请求(<strong class="ix hj"> 127.0.0.1 </strong>)。另外两个参数是NAS端口(通常为零。我认为您在这里放什么并不重要)和<strong class="ix hj"> testing123 </strong>是NAS客户端将用于向Radius服务器验证自身的密码。</p><p id="650a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果Radius服务器回复访问接受消息，这意味着您的配置有效，否则您必须仔细检查调试日志中的消息。</p><p id="4098" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这个默认用户<strong class="ix hj"> testing/password </strong>通常是预配置的，但如果不是，请检查/etc/freeradius/3.0/MODS-config/files(Ubuntu)或/etc/raddb/MODS-config/files(Red Hat)中的文件<strong class="ix hj"> accounting </strong>。在最顶端，您应该会看到这样一个条目</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="6463" class="jt ju hi ky b fi lc ld l le lf">testing Cleartext-Password := "password"</span></pre><p id="09e2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果注释了，请将其取消注释。</p><h2 id="f962" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">填充表格。</h2><p id="5d44" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">现在，我们想测试FreeRADIUS是否允许对从MySQL数据库读取信息的用户进行身份验证。为此，首先我们必须在radius数据库中填充我们的表。</p><p id="ccc6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Radius服务器从NAS客户端接收身份验证请求。NAS客户端必须向Radius服务器进行身份验证，提供其IP地址和身份验证密码。</p><p id="f3c3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Radius服务器检查从NAS提供的信息是否与包含在<strong class="ix hj"> nas </strong>表中的信息相匹配。</p><p id="15a9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">要填充NAS表，请运行以下命令:</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="7e1c" class="jt ju hi ky b fi lc ld l le lf">mysql -uroot -ppassworddatabase radius</span><span id="910b" class="jt ju hi ky b fi lg ld l le lf">mysql&gt; INSERT INTO  nas VALUES (NULL ,  '10.10.10.1',  'nas client name',  'other', NULL ,  'passwordnas', NULL , NULL ,  'RADIUS Client nas1');</span></pre><p id="395c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">上表中NAS名称为<strong class="ix hj">‘NAS Client’</strong>，IP地址为<strong class="ix hj"> 10.10.10.1 </strong>，认证密码为’<strong class="ix hj">password NAS</strong>，‘<strong class="ix hj">RADIUS Client NAS 1</strong>只是一个描述。</p><p id="f9ab" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然后Radius服务器检查用户是否被授权使用网络。为此，它检查Radius认证消息中包含的信息是否与<strong class="ix hj"> radcheck </strong>表中包含的信息相匹配。</p><p id="59c2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">要填充<strong class="ix hj"> radcheck </strong>表，运行以下命令:</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="6f75" class="jt ju hi ky b fi lc ld l le lf">mysql -uroot -ppassworddatabase radius</span><span id="91ca" class="jt ju hi ky b fi lg ld l le lf">mysql&gt; INSERT INTO radcheck VALUES (NULL , 'user1', 'Cleartext-Password', ':=', 'passworduser1');</span></pre><p id="2489" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在本例中，我们配置了一个名为“<strong class="ix hj"> user1 </strong>”的用户，其密码为“<em class="lh"> passworduser1 </em>”。</p><p id="5751" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果用户获得授权，Radius服务器会回复一条身份验证接受消息，然后检查授权后操作。特定用户的post授权操作包含在表<strong class="ix hj"> radreply </strong>中。</p><p id="bf39" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">例如，在我们的例子中，我们希望Radius服务器为用户分配一个静态IP地址。为此，我们使用Framed-IP-Address属性。</p><p id="6577" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">要填充表<strong class="ix hj"> radreply </strong>运行以下命令</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="28c8" class="jt ju hi ky b fi lc ld l le lf">mysql -uroot -ppassworddatabase radius</span><span id="ab04" class="jt ju hi ky b fi lg ld l le lf">mysql&gt; INSERT INTO radreply VALUES (NULL , 'user1', 'Framed-IP-Address', ':=', '10.10.10.2');</span></pre><p id="2ba2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">根据该条目，如果用户“<strong class="ix hj">用户1 </strong>被授权访问网络，他应该会收到IP地址<strong class="ix hj"> 10.10.10.2 </strong>。</p><p id="50be" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因此，现在我们可以使用与之前相同的<strong class="ix hj"> radtest </strong>命令来测试我们的配置，但是要针对我们刚刚在数据库中配置的用户进行调整。</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="44b0" class="jt ju hi ky b fi lc ld l le lf">radtest user1 passworduser1 127.0.0.1<!-- --> <!-- -->0<!-- --> <!-- -->passwordnas</span></pre><p id="54a4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果配置有效，您应该会收到一条消息Access-Accept和另一条分配了IP地址的消息。</p><h2 id="6ab2" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">启动FreeRADIUS守护程序。</h2><p id="d1a2" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">现在，如果一切正常，并且您想要启动FreeRADIUS as服务，请运行以下命令:</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="0d57" class="jt ju hi ky b fi lc ld l le lf">#Ubuntu<br/>systemctl start freeradius.service</span><span id="b354" class="jt ju hi ky b fi lg ld l le lf">#Red Hat<br/>service radiusd start</span></pre><p id="00d5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">来源。</strong></p><p id="fd64" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我在这里找到了非常有用的信息:</p><div class="lw lx ez fb ly lz"><a href="https://draculaservers.com/tutorials/freeradius-centos-7-mysql/" rel="noopener  ugc nofollow" target="_blank"><div class="ma ab dw"><div class="mb ab mc cl cj md"><h2 class="bd hj fi z dy me ea eb mf ed ef hh bi translated">使用MySQL / MariaDB - Dracula服务器在CentOS 7上安装和配置FreeRADIUS教程</h2><div class="mg l"><h3 class="bd b fi z dy me ea eb mf ed ef dx translated">什么是FreeRADIUS？FreeRADIUS是最受欢迎的开源RADIUS服务器。它支持所有常见的身份验证…</h3></div><div class="mh l"><p class="bd b fp z dy me ea eb mf ed ef dx translated">draculaservers.com</p></div></div><div class="mi l"><div class="mj l mk ml mm mi mn io lz"/></div></div></a></div><div class="lw lx ez fb ly lz"><a href="https://wiki.freeradius.org/guide/Getting-Started" rel="noopener  ugc nofollow" target="_blank"><div class="ma ab dw"><div class="mb ab mc cl cj md"><h2 class="bd hj fi z dy me ea eb mf ed ef hh bi translated">入门指南</h2><div class="mg l"><h3 class="bd b fi z dy me ea eb mf ed ef dx translated">本页介绍如何执行FreeRADIUS的初始配置。它假定您对Unix系统有基本的了解…</h3></div><div class="mh l"><p class="bd b fp z dy me ea eb mf ed ef dx translated">wiki.freeradius.org</p></div></div></div></a></div></div></div>    
</body>
</html>