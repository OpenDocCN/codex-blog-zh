<html>
<head>
<title>⚡Using Infrastructure-As-Code (ARM templates) to deploy MOVEit in Azure</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Azure中部署MOVEit的⚡Using基础设施代码(ARM模板)</h1>
<blockquote>原文：<a href="https://medium.com/codex/using-infrastructure-as-code-arm-templates-to-deploy-moveit-in-azure-7b2e7e4aae18?source=collection_archive---------4-----------------------#2021-10-02">https://medium.com/codex/using-infrastructure-as-code-arm-templates-to-deploy-moveit-in-azure-7b2e7e4aae18?source=collection_archive---------4-----------------------#2021-10-02</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="0b3c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">学习部署全功能的MOVEit自动化解决方案。</p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><p id="dc9a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">本文的目标是展示如何使用ARM模板利用基础设施即代码在Azure中部署MOVEit解决方案。</p><h1 id="3415" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">什么是MOVEit？</h1><p id="1133" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">Progress MOVEit Automation是一款托管文件传输(MFT)自动化软件，运行在Azure或您首选的云提供商的虚拟机之上。它提供了以下好处:</p><ul class=""><li id="ce8c" class="kn ko hi ih b ii ij im in iq kp iu kq iy kr jc ks kt ku kv bi translated">无需任何编程技能，轻松自动化多步骤、基于逻辑的工作流程</li><li id="8674" class="kn ko hi ih b ii kw im kx iq ky iu kz iy la jc ks kt ku kv bi translated">授权的业务线管理员可以监控、安排和运行自动化文件传输任务</li><li id="22f1" class="kn ko hi ih b ii kw im kx iq ky iu kz iy la jc ks kt ku kv bi translated">端到端数据加密和经确认的安全性，符合内部政策和法规要求</li><li id="c118" class="kn ko hi ih b ii kw im kx iq ky iu kz iy la jc ks kt ku kv bi translated">RESTful API和PowerShell脚本支持与第三方应用的灵活集成</li><li id="0609" class="kn ko hi ih b ii kw im kx iq ky iu kz iy la jc ks kt ku kv bi translated">该控制面板能够对关键MOVEit自动化功能进行主动、一目了然的洞察</li></ul><p id="17f4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">本文的主要目的是使用ARM模板来自动化该解决方案的部署过程。让我们从先决条件开始。</p><h2 id="5d06" class="lb jl hi bd jm lc ld le jq lf lg lh ju iq li lj jy iu lk ll kc iy lm ln kg lo bi translated">部署MOVEit的先决条件。</h2><ul class=""><li id="28b2" class="kn ko hi ih b ii ki im kj iq lp iu lq iy lr jc ks kt ku kv bi translated">有效的Azure订阅</li><li id="6259" class="kn ko hi ih b ii kw im kx iq ky iu kz iy la jc ks kt ku kv bi translated">拥有所有者或贡献者角色的Azure用户</li><li id="a87c" class="kn ko hi ih b ii kw im kx iq ky iu kz iy la jc ks kt ku kv bi translated">SMTP中继。SMTP电子邮件服务器能够接受来自Azure中运行的虚拟机的出站电子邮件。您可以在部署后配置SMTP。</li></ul><p id="9a8c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们创作我们的ARM模板。</p><p id="cb62" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将开始定义参数。</p><h1 id="1c3c" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">1.MOVEit ARM模板—参数</h1><p id="b084" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">该解决方案运行在虚拟机之上，因此我们将定义以下参数:</p><ul class=""><li id="b007" class="kn ko hi ih b ii ij im in iq kp iu kq iy kr jc ks kt ku kv bi translated">位置</li><li id="1b50" class="kn ko hi ih b ii kw im kx iq ky iu kz iy la jc ks kt ku kv bi translated">虚拟机大小</li><li id="cf54" class="kn ko hi ih b ii kw im kx iq ky iu kz iy la jc ks kt ku kv bi translated">管理员用户名和密码</li><li id="343f" class="kn ko hi ih b ii kw im kx iq ky iu kz iy la jc ks kt ku kv bi translated">客户姓名</li><li id="4c11" class="kn ko hi ih b ii kw im kx iq ky iu kz iy la jc ks kt ku kv bi translated">公司名称</li><li id="8175" class="kn ko hi ih b ii kw im kx iq ky iu kz iy la jc ks kt ku kv bi translated">客户电子邮件</li><li id="1e29" class="kn ko hi ih b ii kw im kx iq ky iu kz iy la jc ks kt ku kv bi translated">电话</li><li id="bdf0" class="kn ko hi ih b ii kw im kx iq ky iu kz iy la jc ks kt ku kv bi translated">城市</li><li id="3b03" class="kn ko hi ih b ii kw im kx iq ky iu kz iy la jc ks kt ku kv bi translated">状态</li><li id="4e27" class="kn ko hi ih b ii kw im kx iq ky iu kz iy la jc ks kt ku kv bi translated">国家</li><li id="a89c" class="kn ko hi ih b ii kw im kx iq ky iu kz iy la jc ks kt ku kv bi translated">系统管理员密码</li><li id="e2d4" class="kn ko hi ih b ii kw im kx iq ky iu kz iy la jc ks kt ku kv bi translated">电子邮件至</li><li id="5c73" class="kn ko hi ih b ii kw im kx iq ky iu kz iy la jc ks kt ku kv bi translated">电子邮件发件人</li><li id="a0c4" class="kn ko hi ih b ii kw im kx iq ky iu kz iy la jc ks kt ku kv bi translated">SMTP端口</li><li id="d70a" class="kn ko hi ih b ii kw im kx iq ky iu kz iy la jc ks kt ku kv bi translated">SMTP用户名和密码</li></ul><p id="1a22" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面的代码显示了ARM模板的参数部分的定义:</p><pre class="ls lt lu lv fd lw lx ly lz aw ma bi"><span id="8dda" class="lb jl hi lx b fi mb mc l md me">"parameters": {<br/>        "location": {<br/>            "type": "string"<br/>        },<br/>        "virtualMachineSize": {<br/>            "type": "string"<br/>        },<br/>        "adminUsername": {<br/>            "type": "string"<br/>        },<br/>        "adminPassword": {<br/>            "type": "securestring"<br/>        },<br/>        "mi_sysadminPassword": {<br/>            "type": "securestring"<br/>        },<br/>        "mi_emailTo": {<br/>            "type": "string"<br/>        },<br/>        "mi_emailFrom": {<br/>            "type": "string"<br/>        },<br/>        "mi_smtpHost": {<br/>            "type": "string"<br/>        },<br/>        "mi_smtpPort": {<br/>            "type": "string"<br/>        },<br/>        "mi_smtpUsername": {<br/>            "type": "string"<br/>        },<br/>        "mi_smtpPassword": {<br/>            "type": "securestring"<br/>        },<br/>        "ci_custFirstName": {<br/>            "type": "string"<br/>        },<br/>        "ci_custLastName": {<br/>            "type": "string"<br/>        },<br/>        "ci_custCompanyName": {<br/>            "type": "string"<br/>        },<br/>        "ci_custEmail": {<br/>            "type": "string"<br/>        },<br/>        "ci_custPhone": {<br/>            "type": "string"<br/>        },<br/>        "ci_custCity": {<br/>            "type": "string",<br/>            "defaultValue": ""<br/>        },<br/>        "ci_custState": {<br/>            "type": "string",<br/>            "defaultValue": ""<br/>        },<br/>        "ci_custCountry": {<br/>            "type": "string",<br/>            "defaultValue": ""<br/>        }<br/>    },</span></pre><p id="3ed7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请注意，我们使用“<em class="mf"> secureString </em>”来传递部署中的密码/机密和敏感数据。这些机密不会存储在部署历史记录中，也不会被记录。</p><p id="d2a1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们将定义要使用的变量。</p><h1 id="b050" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">2.MOVEit ARM模板—变量</h1><p id="1609" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">在ARM模板的变量部分，我们将包括以下内容:</p><ul class=""><li id="c861" class="kn ko hi ih b ii ij im in iq kp iu kq iy kr jc ks kt ku kv bi translated">虚拟机名称</li><li id="1563" class="kn ko hi ih b ii kw im kx iq ky iu kz iy la jc ks kt ku kv bi translated">虚拟网络名称</li><li id="91db" class="kn ko hi ih b ii kw im kx iq ky iu kz iy la jc ks kt ku kv bi translated">网络接口名称</li><li id="0115" class="kn ko hi ih b ii kw im kx iq ky iu kz iy la jc ks kt ku kv bi translated">网络安全组名称</li><li id="9b7d" class="kn ko hi ih b ii kw im kx iq ky iu kz iy la jc ks kt ku kv bi translated">地址前缀</li><li id="f0ce" class="kn ko hi ih b ii kw im kx iq ky iu kz iy la jc ks kt ku kv bi translated">子网名称</li><li id="cc1a" class="kn ko hi ih b ii kw im kx iq ky iu kz iy la jc ks kt ku kv bi translated">子网前缀</li><li id="6cf8" class="kn ko hi ih b ii kw im kx iq ky iu kz iy la jc ks kt ku kv bi translated">公共IP地址名称</li><li id="3449" class="kn ko hi ih b ii kw im kx iq ky iu kz iy la jc ks kt ku kv bi translated">公共IP地址类型</li><li id="ff0b" class="kn ko hi ih b ii kw im kx iq ky iu kz iy la jc ks kt ku kv bi translated">发布者名称</li><li id="b72d" class="kn ko hi ih b ii kw im kx iq ky iu kz iy la jc ks kt ku kv bi translated">提供</li><li id="e91b" class="kn ko hi ih b ii kw im kx iq ky iu kz iy la jc ks kt ku kv bi translated">库存单位</li><li id="5fef" class="kn ko hi ih b ii kw im kx iq ky iu kz iy la jc ks kt ku kv bi translated">版本</li><li id="3be9" class="kn ko hi ih b ii kw im kx iq ky iu kz iy la jc ks kt ku kv bi translated">图像参考</li><li id="1551" class="kn ko hi ih b ii kw im kx iq ky iu kz iy la jc ks kt ku kv bi translated">计划</li></ul><p id="f5b3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面的代码显示了ARM模板的变量部分的定义:</p><pre class="ls lt lu lv fd lw lx ly lz aw ma bi"><span id="4a65" class="lb jl hi lx b fi mb mc l md me">"variables": {<br/>        "virtualMachineName": "MIA",<br/>        "virtualNetworkName": "vnet1",<br/>        "networkInterfaceName": "nic1",<br/>        "networkSecurityGroupName": "nsg1",<br/>        "addressPrefix": "10.5.0.0/16",<br/>        "subnetName": "subnet1",<br/>        "subnetPrefix": "10.5.0.0/24",<br/>        "publicIpAddressName": "publicip1",<br/>        "publicIpAddressType": "dynamic",<br/>        "myPublisher": "progresssoftwarecorporation",<br/>        "myOffer": "moveit-automation-vm",<br/>        "mySKU": "moveit-automation-starter",<br/>        "myVersion": "latest",<br/>        "myImageReference": {<br/>            "publisher": "[variables('myPublisher')]",<br/>            "offer": "[variables('myOffer')]",<br/>            "sku": "[variables('mySKU')]",<br/>            "version": "[variables('myVersion')]"<br/>        },<br/>        "myPlan": {<br/>            "name": "[variables('mySKU')]",<br/>            "product": "[variables('myOffer')]",<br/>            "publisher": "[variables('myPublisher')]"<br/>        }<br/>    },</span></pre><p id="6e03" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，我们将定义资源。</p><h1 id="800a" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">3.MOVEit ARM模板—资源</h1><p id="2482" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">在ARM模板的资源部分，我们将使用具有外部范围的嵌套模板来定义部署。</p><p id="aaff" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面的代码显示了ARM模板的资源部分的定义:</p><pre class="ls lt lu lv fd lw lx ly lz aw ma bi"><span id="6b09" class="lb jl hi lx b fi mb mc l md me">"resources": [<br/>        {<br/>            "name": "pid-f4ddf0e0-b9cf-4104-860f-2b39bda08d19-partnercenter",<br/>            "type": "Microsoft.Resources/deployments",<br/>            "apiVersion": "2020-10-01",<br/>            "properties": {<br/>                "mode": "Incremental",<br/>                "template": {<br/>                    "$schema": "<a class="ae mg" href="https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#" rel="noopener ugc nofollow" target="_blank">https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#</a>",<br/>                    "contentVersion": "1.0.0.0",<br/>                    "resources": []<br/>                }<br/>            }<br/>        },<br/>        {<br/>            "name": "[variables('virtualMachineName')]",<br/>            "type": "Microsoft.Compute/virtualMachines",<br/>            "apiVersion": "2019-12-01",<br/>            "plan": "[variables('myPlan')]",<br/>            "location": "[parameters('location')]",<br/>            "dependsOn": [<br/>                "[concat('Microsoft.Network/networkInterfaces/', variables('networkInterfaceName'))]"<br/>            ],<br/>            "properties": {<br/>                "osProfile": {<br/>                    "computerName": "[variables('virtualMachineName')]",<br/>                    "adminUsername": "[parameters('adminUsername')]",<br/>                    "adminPassword": "[parameters('adminPassword')]",<br/>                    "windowsConfiguration": {<br/>                        "provisionVmAgent": "true"<br/>                    }<br/>                },<br/>                "hardwareProfile": {<br/>                    "vmSize": "[parameters('virtualMachineSize')]"<br/>                },<br/>                "storageProfile": {<br/>                    "imageReference": "[variables('myImageReference')]",<br/>                    "osDisk": {<br/>                        "name": "[variables('virtualMachineName')]",<br/>                        "createOption": "FromImage",<br/>                        "managedDisk": {<br/>                            "storageAccountType": "Standard_LRS"<br/>                        }<br/>                    }<br/>                },<br/>                "networkProfile": {<br/>                    "networkInterfaces": [<br/>                        {<br/>                            "id": "[resourceId('Microsoft.Network/networkInterfaces', variables('networkInterfaceName'))]"<br/>                        }<br/>                    ]<br/>                }<br/>            },<br/>            "resources": [<br/>                {<br/>                    "apiVersion": "2018-06-01",<br/>                    "type": "extensions",<br/>                    "name": "CustomScriptExtension",<br/>                    "location": "[parameters('location')]",<br/>                    "dependsOn": [<br/>                        "[concat('Microsoft.Compute/virtualMachines/', variables('virtualMachineName'))]"<br/>                    ],<br/>                    "tags": {<br/>                        "displayName": "config-app"<br/>                    },<br/>                    "properties": {<br/>                        "publisher": "Microsoft.Compute",<br/>                        "type": "CustomScriptExtension",<br/>                        "typeHandlerVersion": "1.8",<br/>                        "autoUpgradeMinorVersion": true,<br/>                        "protectedSettings": {<br/>                            "commandToExecute": "[concat ('C:\\Deploy\\PreMIBoot.exe', ' -app mia -vmSize ', base64(parameters('virtualMachineSize')), ' -mi_emailTo ',  base64(parameters('mi_emailTo')), ' -mi_emailFrom ', base64(parameters('mi_emailFrom')), ' -mi_smtpHost ', base64(parameters('mi_smtpHost')), ' -mi_smtpPort ', base64(parameters('mi_smtpPort')), ' -mi_smtpUsername ', base64(parameters('mi_smtpUsername')), ' -mi_smtpPassword ', base64(parameters('mi_smtpPassword')), ' -mi_sysadminPassword ', base64(parameters('mi_sysadminPassword')),  ' -ci_custFirstName ', base64(parameters('ci_custFirstName')), ' -ci_custLastName ', base64(parameters('ci_custLastName')), ' -ci_custCompanyName ', base64(parameters('ci_custCompanyName')), ' -ci_custEmail ', base64(parameters('ci_custEmail')), ' -ci_custPhone ', base64(parameters('ci_custPhone')), ' -ci_custCity ', base64(parameters('ci_custCity')), ' -ci_custState ', base64(parameters('ci_custState')), ' -ci_custCountry ', base64(parameters('ci_custCountry')))]"<br/>                        }<br/>                    }<br/>                }<br/>            ]<br/>        },<br/>        {<br/>            "name": "[variables('virtualNetworkName')]",<br/>            "type": "Microsoft.Network/virtualNetworks",<br/>            "apiVersion": "2018-11-01",<br/>            "location": "[parameters('location')]",<br/>            "properties": {<br/>                "addressSpace": {<br/>                    "addressPrefixes": [<br/>                        "[variables('addressPrefix')]"<br/>                    ]<br/>                },<br/>                "subnets": [<br/>                    {<br/>                        "name": "[variables('subnetName')]",<br/>                        "properties": {<br/>                            "addressPrefix": "[variables('subnetPrefix')]"<br/>                        }<br/>                    }<br/>                ]<br/>            }<br/>        },<br/>        {<br/>            "name": "[variables('networkInterfaceName')]",<br/>            "type": "Microsoft.Network/networkInterfaces",<br/>            "apiVersion": "2018-11-01",<br/>            "location": "[parameters('location')]",<br/>            "dependsOn": [<br/>                "[resourceId('Microsoft.Network/publicIPAddresses', variables('publicIPAddressName'))]",<br/>                "[resourceId('Microsoft.Network/virtualNetworks', variables('virtualNetworkName'))]",<br/>                "[resourceId('Microsoft.Network/networkSecurityGroups', variables('networkSecurityGroupName'))]"<br/>            ],<br/>            "properties": {<br/>                "ipConfigurations": [<br/>                    {<br/>                        "name": "ipconfig1",<br/>                        "properties": {<br/>                            "subnet": {<br/>                                "id": "[resourceId('Microsoft.Network/virtualNetworks/subnets', variables('virtualNetworkName'), variables('subnetName'))]"<br/>                            },<br/>                            "privateIPAllocationMethod": "Dynamic",<br/>                            "publicIpAddress": {<br/>                                "id": "[resourceId('Microsoft.Network/publicIpAddresses', variables('publicIpAddressName'))]"<br/>                            }<br/>                        }<br/>                    }<br/>                ],<br/>                "networkSecurityGroup": {<br/>                    "id": "[resourceId('Microsoft.Network/networkSecurityGroups', variables('networkSecurityGroupName'))]"<br/>                }<br/>            }<br/>        },<br/>        {<br/>            "name": "[variables('publicIpAddressName')]",<br/>            "type": "Microsoft.Network/publicIpAddresses",<br/>            "apiVersion": "2018-11-01",<br/>            "location": "[parameters('location')]",<br/>            "properties": {<br/>                "publicIpAllocationMethod": "[variables('publicIpAddressType')]"<br/>            }<br/>        },<br/>        {<br/>            "name": "[variables('networkSecurityGroupName')]",<br/>            "type": "Microsoft.Network/networkSecurityGroups",<br/>            "apiVersion": "2018-11-01",<br/>            "location": "[parameters('location')]",<br/>            "properties": {<br/>                "securityRules": [<br/>                    {<br/>                        "name": "default-allow-rdp",<br/>                        "properties": {<br/>                            "priority": 1000,<br/>                            "sourceAddressPrefix": "*",<br/>                            "protocol": "Tcp",<br/>                            "destinationPortRange": "3389",<br/>                            "access": "Allow",<br/>                            "direction": "Inbound",<br/>                            "sourcePortRange": "*",<br/>                            "destinationAddressPrefix": "*"<br/>                        }<br/>                    },<br/>                    {<br/>                        "name": "HTTP-In",<br/>                        "properties": {<br/>                            "priority": 1010,<br/>                            "sourceAddressPrefix": "*",<br/>                            "protocol": "Tcp",<br/>                            "destinationPortRange": "80",<br/>                            "access": "Allow",<br/>                            "direction": "Inbound",<br/>                            "sourcePortRange": "*",<br/>                            "destinationAddressPrefix": "*"<br/>                        }<br/>                    },<br/>                    {<br/>                        "name": "HTTPS-In",<br/>                        "properties": {<br/>                            "priority": 1020,<br/>                            "sourceAddressPrefix": "*",<br/>                            "protocol": "Tcp",<br/>                            "destinationPortRange": "443",<br/>                            "access": "Allow",<br/>                            "direction": "Inbound",<br/>                            "sourcePortRange": "*",<br/>                            "destinationAddressPrefix": "*"<br/>                        }<br/>                    },<br/>                    {<br/>                        "name": "SSH-In",<br/>                        "properties": {<br/>                            "priority": 1030,<br/>                            "sourceAddressPrefix": "*",<br/>                            "protocol": "Tcp",<br/>                            "destinationPortRange": "22",<br/>                            "access": "Allow",<br/>                            "direction": "Inbound",<br/>                            "sourcePortRange": "*",<br/>                            "destinationAddressPrefix": "*"<br/>                        }<br/>                    },<br/>                    {<br/>                        "name": "FTP-In",<br/>                        "properties": {<br/>                            "priority": 1040,<br/>                            "sourceAddressPrefix": "*",<br/>                            "protocol": "Tcp",<br/>                            "destinationPortRange": "21",<br/>                            "access": "Allow",<br/>                            "direction": "Inbound",<br/>                            "sourcePortRange": "*",<br/>                            "destinationAddressPrefix": "*"<br/>                        }<br/>                    },<br/>                    {<br/>                        "name": "FTP-Implicit-In",<br/>                        "properties": {<br/>                            "priority": 1050,<br/>                            "sourceAddressPrefix": "*",<br/>                            "protocol": "Tcp",<br/>                            "destinationPortRange": "990",<br/>                            "access": "Allow",<br/>                            "direction": "Inbound",<br/>                            "sourcePortRange": "*",<br/>                            "destinationAddressPrefix": "*"<br/>                        }<br/>                    },<br/>                    {<br/>                        "name": "FTP-Data-In",<br/>                        "properties": {<br/>                            "priority": 1060,<br/>                            "sourceAddressPrefix": "*",<br/>                            "protocol": "Tcp",<br/>                            "destinationPortRange": "3000-3100",<br/>                            "access": "Allow",<br/>                            "direction": "Inbound",<br/>                            "sourcePortRange": "*",<br/>                            "destinationAddressPrefix": "*"<br/>                        }<br/>                    },<br/>                    {<br/>                        "name": "FTP-Explicit-CC-In",<br/>                        "properties": {<br/>                            "priority": 1070,<br/>                            "sourceAddressPrefix": "*",<br/>                            "protocol": "Tcp",<br/>                            "destinationPortRange": "10021",<br/>                            "access": "Allow",<br/>                            "direction": "Inbound",<br/>                            "sourcePortRange": "*",<br/>                            "destinationAddressPrefix": "*"<br/>                        }<br/>                    },<br/>                    {<br/>                        "name": "FTP-Implicit-CC-In",<br/>                        "properties": {<br/>                            "priority": 1080,<br/>                            "sourceAddressPrefix": "*",<br/>                            "protocol": "Tcp",<br/>                            "destinationPortRange": "10990",<br/>                            "access": "Allow",<br/>                            "direction": "Inbound",<br/>                            "sourcePortRange": "*",<br/>                            "destinationAddressPrefix": "*"<br/>                        }<br/>                    }<br/>                ]<br/>            }<br/>        }<br/>    ],</span></pre><p id="0036" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">注意在上面的代码中，我们定义了虚拟机及其属性，包括操作系统配置文件、硬件配置文件、存储和网络配置文件。</p><p id="8b52" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后，我们包括运行自定义脚本扩展的扩展，并引用网络组件和公共IP地址。</p><p id="fb90" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，我们定义网络安全组，并为RDP、入站HTTP(S)、入站SSH和FTP添加安全规则。</p><p id="c1c5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在参考资料部分之后，我们为管理员用户名定义了一个输出。</p><pre class="ls lt lu lv fd lw lx ly lz aw ma bi"><span id="11f8" class="lb jl hi lx b fi mb mc l md me">"outputs": {<br/>        "adminUsername": {<br/>            "type": "string",<br/>            "value": "[parameters('adminUsername')]"<br/>        }<br/>    }</span></pre><h1 id="a0ab" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">4.MOVEit完整手臂模板</h1><p id="c29d" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">下面的代码展示了完整的ARM模板。</p><pre class="ls lt lu lv fd lw lx ly lz aw ma bi"><span id="f536" class="lb jl hi lx b fi mb mc l md me">{<br/>    "$schema": "<a class="ae mg" href="https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#" rel="noopener ugc nofollow" target="_blank">https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#</a>",<br/>    "contentVersion": "1.0.0.0",<br/>    "parameters": {<br/>        "location": {<br/>            "type": "string"<br/>        },<br/>        "virtualMachineSize": {<br/>            "type": "string"<br/>        },<br/>        "adminUsername": {<br/>            "type": "string"<br/>        },<br/>        "adminPassword": {<br/>            "type": "securestring"<br/>        },<br/>        "mi_sysadminPassword": {<br/>            "type": "securestring"<br/>        },<br/>        "mi_emailTo": {<br/>            "type": "string"<br/>        },<br/>        "mi_emailFrom": {<br/>            "type": "string"<br/>        },<br/>        "mi_smtpHost": {<br/>            "type": "string"<br/>        },<br/>        "mi_smtpPort": {<br/>            "type": "string"<br/>        },<br/>        "mi_smtpUsername": {<br/>            "type": "string"<br/>        },<br/>        "mi_smtpPassword": {<br/>            "type": "securestring"<br/>        },<br/>        "ci_custFirstName": {<br/>            "type": "string"<br/>        },<br/>        "ci_custLastName": {<br/>            "type": "string"<br/>        },<br/>        "ci_custCompanyName": {<br/>            "type": "string"<br/>        },<br/>        "ci_custEmail": {<br/>            "type": "string"<br/>        },<br/>        "ci_custPhone": {<br/>            "type": "string"<br/>        },<br/>        "ci_custCity": {<br/>            "type": "string",<br/>            "defaultValue": ""<br/>        },<br/>        "ci_custState": {<br/>            "type": "string",<br/>            "defaultValue": ""<br/>        },<br/>        "ci_custCountry": {<br/>            "type": "string",<br/>            "defaultValue": ""<br/>        }<br/>    },<br/>    "variables": {<br/>        "virtualMachineName": "MIA",<br/>        "virtualNetworkName": "vnet1",<br/>        "networkInterfaceName": "nic1",<br/>        "networkSecurityGroupName": "nsg1",<br/>        "addressPrefix": "10.5.0.0/16",<br/>        "subnetName": "subnet1",<br/>        "subnetPrefix": "10.5.0.0/24",<br/>        "publicIpAddressName": "publicip1",<br/>        "publicIpAddressType": "dynamic",<br/>        "myPublisher": "progresssoftwarecorporation",<br/>        "myOffer": "moveit-automation-vm",<br/>        "mySKU": "moveit-automation-starter",<br/>        "myVersion": "latest",<br/>        "myImageReference": {<br/>            "publisher": "[variables('myPublisher')]",<br/>            "offer": "[variables('myOffer')]",<br/>            "sku": "[variables('mySKU')]",<br/>            "version": "[variables('myVersion')]"<br/>        },<br/>        "myPlan": {<br/>            "name": "[variables('mySKU')]",<br/>            "product": "[variables('myOffer')]",<br/>            "publisher": "[variables('myPublisher')]"<br/>        }<br/>    },<br/>    "resources": [<br/>        {<br/>            "name": "pid-f4ddf0e0-b9cf-4104-860f-2b39bda08d19-partnercenter",<br/>            "type": "Microsoft.Resources/deployments",<br/>            "apiVersion": "2020-10-01",<br/>            "properties": {<br/>                "mode": "Incremental",<br/>                "template": {<br/>                    "$schema": "<a class="ae mg" href="https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#" rel="noopener ugc nofollow" target="_blank">https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#</a>",<br/>                    "contentVersion": "1.0.0.0",<br/>                    "resources": []<br/>                }<br/>            }<br/>        },<br/>        {<br/>            "name": "[variables('virtualMachineName')]",<br/>            "type": "Microsoft.Compute/virtualMachines",<br/>            "apiVersion": "2019-12-01",<br/>            "plan": "[variables('myPlan')]",<br/>            "location": "[parameters('location')]",<br/>            "dependsOn": [<br/>                "[concat('Microsoft.Network/networkInterfaces/', variables('networkInterfaceName'))]"<br/>            ],<br/>            "properties": {<br/>                "osProfile": {<br/>                    "computerName": "[variables('virtualMachineName')]",<br/>                    "adminUsername": "[parameters('adminUsername')]",<br/>                    "adminPassword": "[parameters('adminPassword')]",<br/>                    "windowsConfiguration": {<br/>                        "provisionVmAgent": "true"<br/>                    }<br/>                },<br/>                "hardwareProfile": {<br/>                    "vmSize": "[parameters('virtualMachineSize')]"<br/>                },<br/>                "storageProfile": {<br/>                    "imageReference": "[variables('myImageReference')]",<br/>                    "osDisk": {<br/>                        "name": "[variables('virtualMachineName')]",<br/>                        "createOption": "FromImage",<br/>                        "managedDisk": {<br/>                            "storageAccountType": "Standard_LRS"<br/>                        }<br/>                    }<br/>                },<br/>                "networkProfile": {<br/>                    "networkInterfaces": [<br/>                        {<br/>                            "id": "[resourceId('Microsoft.Network/networkInterfaces', variables('networkInterfaceName'))]"<br/>                        }<br/>                    ]<br/>                }<br/>            },<br/>            "resources": [<br/>                {<br/>                    "apiVersion": "2018-06-01",<br/>                    "type": "extensions",<br/>                    "name": "CustomScriptExtension",<br/>                    "location": "[parameters('location')]",<br/>                    "dependsOn": [<br/>                        "[concat('Microsoft.Compute/virtualMachines/', variables('virtualMachineName'))]"<br/>                    ],<br/>                    "tags": {<br/>                        "displayName": "config-app"<br/>                    },<br/>                    "properties": {<br/>                        "publisher": "Microsoft.Compute",<br/>                        "type": "CustomScriptExtension",<br/>                        "typeHandlerVersion": "1.8",<br/>                        "autoUpgradeMinorVersion": true,<br/>                        "protectedSettings": {<br/>                            "commandToExecute": "[concat ('C:\\Deploy\\PreMIBoot.exe', ' -app mia -vmSize ', base64(parameters('virtualMachineSize')), ' -mi_emailTo ',  base64(parameters('mi_emailTo')), ' -mi_emailFrom ', base64(parameters('mi_emailFrom')), ' -mi_smtpHost ', base64(parameters('mi_smtpHost')), ' -mi_smtpPort ', base64(parameters('mi_smtpPort')), ' -mi_smtpUsername ', base64(parameters('mi_smtpUsername')), ' -mi_smtpPassword ', base64(parameters('mi_smtpPassword')), ' -mi_sysadminPassword ', base64(parameters('mi_sysadminPassword')),  ' -ci_custFirstName ', base64(parameters('ci_custFirstName')), ' -ci_custLastName ', base64(parameters('ci_custLastName')), ' -ci_custCompanyName ', base64(parameters('ci_custCompanyName')), ' -ci_custEmail ', base64(parameters('ci_custEmail')), ' -ci_custPhone ', base64(parameters('ci_custPhone')), ' -ci_custCity ', base64(parameters('ci_custCity')), ' -ci_custState ', base64(parameters('ci_custState')), ' -ci_custCountry ', base64(parameters('ci_custCountry')))]"<br/>                        }<br/>                    }<br/>                }<br/>            ]<br/>        },<br/>        {<br/>            "name": "[variables('virtualNetworkName')]",<br/>            "type": "Microsoft.Network/virtualNetworks",<br/>            "apiVersion": "2018-11-01",<br/>            "location": "[parameters('location')]",<br/>            "properties": {<br/>                "addressSpace": {<br/>                    "addressPrefixes": [<br/>                        "[variables('addressPrefix')]"<br/>                    ]<br/>                },<br/>                "subnets": [<br/>                    {<br/>                        "name": "[variables('subnetName')]",<br/>                        "properties": {<br/>                            "addressPrefix": "[variables('subnetPrefix')]"<br/>                        }<br/>                    }<br/>                ]<br/>            }<br/>        },<br/>        {<br/>            "name": "[variables('networkInterfaceName')]",<br/>            "type": "Microsoft.Network/networkInterfaces",<br/>            "apiVersion": "2018-11-01",<br/>            "location": "[parameters('location')]",<br/>            "dependsOn": [<br/>                "[resourceId('Microsoft.Network/publicIPAddresses', variables('publicIPAddressName'))]",<br/>                "[resourceId('Microsoft.Network/virtualNetworks', variables('virtualNetworkName'))]",<br/>                "[resourceId('Microsoft.Network/networkSecurityGroups', variables('networkSecurityGroupName'))]"<br/>            ],<br/>            "properties": {<br/>                "ipConfigurations": [<br/>                    {<br/>                        "name": "ipconfig1",<br/>                        "properties": {<br/>                            "subnet": {<br/>                                "id": "[resourceId('Microsoft.Network/virtualNetworks/subnets', variables('virtualNetworkName'), variables('subnetName'))]"<br/>                            },<br/>                            "privateIPAllocationMethod": "Dynamic",<br/>                            "publicIpAddress": {<br/>                                "id": "[resourceId('Microsoft.Network/publicIpAddresses', variables('publicIpAddressName'))]"<br/>                            }<br/>                        }<br/>                    }<br/>                ],<br/>                "networkSecurityGroup": {<br/>                    "id": "[resourceId('Microsoft.Network/networkSecurityGroups', variables('networkSecurityGroupName'))]"<br/>                }<br/>            }<br/>        },<br/>        {<br/>            "name": "[variables('publicIpAddressName')]",<br/>            "type": "Microsoft.Network/publicIpAddresses",<br/>            "apiVersion": "2018-11-01",<br/>            "location": "[parameters('location')]",<br/>            "properties": {<br/>                "publicIpAllocationMethod": "[variables('publicIpAddressType')]"<br/>            }<br/>        },<br/>        {<br/>            "name": "[variables('networkSecurityGroupName')]",<br/>            "type": "Microsoft.Network/networkSecurityGroups",<br/>            "apiVersion": "2018-11-01",<br/>            "location": "[parameters('location')]",<br/>            "properties": {<br/>                "securityRules": [<br/>                    {<br/>                        "name": "default-allow-rdp",<br/>                        "properties": {<br/>                            "priority": 1000,<br/>                            "sourceAddressPrefix": "*",<br/>                            "protocol": "Tcp",<br/>                            "destinationPortRange": "3389",<br/>                            "access": "Allow",<br/>                            "direction": "Inbound",<br/>                            "sourcePortRange": "*",<br/>                            "destinationAddressPrefix": "*"<br/>                        }<br/>                    },<br/>                    {<br/>                        "name": "HTTP-In",<br/>                        "properties": {<br/>                            "priority": 1010,<br/>                            "sourceAddressPrefix": "*",<br/>                            "protocol": "Tcp",<br/>                            "destinationPortRange": "80",<br/>                            "access": "Allow",<br/>                            "direction": "Inbound",<br/>                            "sourcePortRange": "*",<br/>                            "destinationAddressPrefix": "*"<br/>                        }<br/>                    },<br/>                    {<br/>                        "name": "HTTPS-In",<br/>                        "properties": {<br/>                            "priority": 1020,<br/>                            "sourceAddressPrefix": "*",<br/>                            "protocol": "Tcp",<br/>                            "destinationPortRange": "443",<br/>                            "access": "Allow",<br/>                            "direction": "Inbound",<br/>                            "sourcePortRange": "*",<br/>                            "destinationAddressPrefix": "*"<br/>                        }<br/>                    },<br/>                    {<br/>                        "name": "SSH-In",<br/>                        "properties": {<br/>                            "priority": 1030,<br/>                            "sourceAddressPrefix": "*",<br/>                            "protocol": "Tcp",<br/>                            "destinationPortRange": "22",<br/>                            "access": "Allow",<br/>                            "direction": "Inbound",<br/>                            "sourcePortRange": "*",<br/>                            "destinationAddressPrefix": "*"<br/>                        }<br/>                    },<br/>                    {<br/>                        "name": "FTP-In",<br/>                        "properties": {<br/>                            "priority": 1040,<br/>                            "sourceAddressPrefix": "*",<br/>                            "protocol": "Tcp",<br/>                            "destinationPortRange": "21",<br/>                            "access": "Allow",<br/>                            "direction": "Inbound",<br/>                            "sourcePortRange": "*",<br/>                            "destinationAddressPrefix": "*"<br/>                        }<br/>                    },<br/>                    {<br/>                        "name": "FTP-Implicit-In",<br/>                        "properties": {<br/>                            "priority": 1050,<br/>                            "sourceAddressPrefix": "*",<br/>                            "protocol": "Tcp",<br/>                            "destinationPortRange": "990",<br/>                            "access": "Allow",<br/>                            "direction": "Inbound",<br/>                            "sourcePortRange": "*",<br/>                            "destinationAddressPrefix": "*"<br/>                        }<br/>                    },<br/>                    {<br/>                        "name": "FTP-Data-In",<br/>                        "properties": {<br/>                            "priority": 1060,<br/>                            "sourceAddressPrefix": "*",<br/>                            "protocol": "Tcp",<br/>                            "destinationPortRange": "3000-3100",<br/>                            "access": "Allow",<br/>                            "direction": "Inbound",<br/>                            "sourcePortRange": "*",<br/>                            "destinationAddressPrefix": "*"<br/>                        }<br/>                    },<br/>                    {<br/>                        "name": "FTP-Explicit-CC-In",<br/>                        "properties": {<br/>                            "priority": 1070,<br/>                            "sourceAddressPrefix": "*",<br/>                            "protocol": "Tcp",<br/>                            "destinationPortRange": "10021",<br/>                            "access": "Allow",<br/>                            "direction": "Inbound",<br/>                            "sourcePortRange": "*",<br/>                            "destinationAddressPrefix": "*"<br/>                        }<br/>                    },<br/>                    {<br/>                        "name": "FTP-Implicit-CC-In",<br/>                        "properties": {<br/>                            "priority": 1080,<br/>                            "sourceAddressPrefix": "*",<br/>                            "protocol": "Tcp",<br/>                            "destinationPortRange": "10990",<br/>                            "access": "Allow",<br/>                            "direction": "Inbound",<br/>                            "sourcePortRange": "*",<br/>                            "destinationAddressPrefix": "*"<br/>                        }<br/>                    }<br/>                ]<br/>            }<br/>        }<br/>    ],<br/>    "outputs": {<br/>        "adminUsername": {<br/>            "type": "string",<br/>            "value": "[parameters('adminUsername')]"<br/>        }<br/>    }<br/>}</span></pre><p id="4b5b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们将处理参数文件来引用部署中的所有值，而不是在部署时手动传递它们。</p><h1 id="d260" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">5.MOVEit参数文件</h1><p id="a374" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">在参数文件中，我们将定义解决方案的所有实际值。这包括步骤1中定义的所有参数列表。</p><p id="c5c5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="mf">重要提示:</em></p><ul class=""><li id="bb02" class="kn ko hi ih b ii ij im in iq kp iu kq iy kr jc ks kt ku kv bi translated">虚拟机的用户名应该是'<em class="mf"> miadmin' </em></li><li id="8680" class="kn ko hi ih b ii kw im kx iq ky iu kz iy la jc ks kt ku kv bi translated">您可以对SMTP服务器使用不同的配置</li></ul><p id="f1f4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面的代码显示了参数文件的定义。</p><pre class="ls lt lu lv fd lw lx ly lz aw ma bi"><span id="cbcf" class="lb jl hi lx b fi mb mc l md me">{<br/>    "$schema": "<a class="ae mg" href="https://schema.management.azure.com/schemas/2015-01-01/deploymentParameters.json#" rel="noopener ugc nofollow" target="_blank">https://schema.management.azure.com/schemas/2015-01-01/deploymentParameters.json#</a>",<br/>    "contentVersion": "1.0.0.0",<br/>    "parameters": {<br/>        "location": {<br/>            "value": "westus2"<br/>        },<br/>        "virtualMachineSize": {<br/>            "value": "Standard_DS2_v2"<br/>        },<br/>        "adminUsername": {<br/>            "value": "miadmin"<br/>        },<br/>        "adminPassword": {<br/>            "value": "YourPassword"<br/>        },<br/>        "ci_custFirstName": {<br/>            "value": "dave"<br/>        },<br/>        "ci_custLastName": {<br/>            "value": "rendon"<br/>        },<br/>        "ci_custCompanyName": {<br/>            "value": "kemp"<br/>        },<br/>        "ci_custEmail": {<br/>            "value": "<a class="ae mg" href="mailto:drendon@kemp.ax" rel="noopener ugc nofollow" target="_blank">Y</a>ourMailAddress"<br/>        },<br/>        "ci_custPhone": {<br/>            "value": "34729220191"<br/>        },<br/>        "ci_custCity": {<br/>            "value": "NYC"<br/>        },<br/>        "ci_custState": {<br/>            "value": "NYC"<br/>        },<br/>        "ci_custCountry": {<br/>            "value": "United States"<br/>        },<br/>        "mi_sysadminPassword": {<br/>            "value": "YourPassword"<br/>        },<br/>        "mi_emailTo": {<br/>            "value": "<a class="ae mg" href="mailto:drendon@kemp.ax" rel="noopener ugc nofollow" target="_blank">Y</a>ourMailAddress"<br/>        },<br/>        "mi_emailFrom": {<br/>            "value": "<a class="ae mg" href="mailto:drendon@kemp.ax" rel="noopener ugc nofollow" target="_blank">Y</a>ourMailAddress"<br/>        },<br/>        "mi_smtpHost": {<br/>            "value": "smtp.office365.com"<br/>        },<br/>        "mi_smtpPort": {<br/>            "value": "587"<br/>        },<br/>        "mi_smtpUsername": {<br/>            "value": "<a class="ae mg" href="mailto:drendon@kemp.ax" rel="noopener ugc nofollow" target="_blank">Y</a>ourMailAddress"<br/>        },<br/>        "mi_smtpPassword": {<br/>            "value": "YourPassword"<br/>        }<br/>    }<br/>}</span></pre><p id="95a9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们将继续部署该解决方案。</p><h1 id="02ea" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">6.使用ARM模板部署MOVEit</h1><p id="5ccb" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">在部署此解决方案之前，我们必须接受虚拟机映像的法律条款。</p><p id="568d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要阅读并接受法律条款，您可以使用PowerShell通过下面的cmdlet接受条款和条件:</p><pre class="ls lt lu lv fd lw lx ly lz aw ma bi"><span id="680f" class="lb jl hi lx b fi mb mc l md me">Get-AzMarketplaceTerms `<br/>-Publisher 'progresssoftwarecorporation' `<br/>-Product 'moveit-automation-vm' `<br/>-Name 'moveit-automation-starter' |<br/>Set-AzMarketplaceTerms -Accept</span></pre><p id="f0a1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下图显示了上述命令的输出。</p><figure class="ls lt lu lv fd mi er es paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="er es mh"><img src="../Images/2d6f4f106832b7f5d8c6bc5dd647395b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tM6clkRWQZSbrEZYRA3LMQ.png"/></div></div><figcaption class="mp mq et er es mr ms bd b be z dx translated">Azure Marketplace条款— MOVEit</figcaption></figure><p id="adf5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一旦我们接受法律条款，我们将部署ARM模板。</p><p id="902a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在此部署之前，我们创建了一个名为“MOVEit”的资源组。</p><p id="ad3b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将使用下面的cmdlet来验证和部署ARM模板。</p><pre class="ls lt lu lv fd lw lx ly lz aw ma bi"><span id="2b3f" class="lb jl hi lx b fi mb mc l md me">$date = Get-Date -Format "MM-dd-yyyy"<br/>$deploymentName = "AzInsiderDeployment"+"$date"</span><span id="29ee" class="lb jl hi lx b fi mt mc l md me">New-AzResourceGroupDeployment -Name $deploymentName -ResourceGroupName MOVEit -TemplateFile .\azuredeploy.json -TemplateParameterFile .\azuredeploy.parameters.json -c</span></pre><p id="039e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">注意，我们使用标志-c来验证具有假设功能的ARM模板。你可以在这里阅读更多关于假设T4的内容。</p><p id="39a7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下图显示了ARM模板的验证过程。</p><figure class="ls lt lu lv fd mi er es paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="er es mu"><img src="../Images/e7365a44a6796a452d3af583867f5c10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sv_oY_v8wYyj7TFCCg_Ydg.png"/></div></div><figcaption class="mp mq et er es mr ms bd b be z dx translated">使用WhatIF — MOVEit进行ARM模板验证</figcaption></figure><p id="64e8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如您在上面的图像中看到的，假设操作将让您看到如果您部署模板，资源将如何变化。现在，我们将确认部署的执行。</p><p id="2265" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下图显示了部署操作的输出。</p><figure class="ls lt lu lv fd mi er es paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="er es mv"><img src="../Images/66dc27c6c762ca5f0016d8a6618ec06b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xpE5uSGkLFB98wYqZVzPYw.png"/></div></div><figcaption class="mp mq et er es mr ms bd b be z dx translated">MOVEit — ARM模板部署输出</figcaption></figure><p id="010a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">此解决方案的部署大约需要14分钟，因为它将部署资源并执行自定义脚本。</p><figure class="ls lt lu lv fd mi er es paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="er es mw"><img src="../Images/e7486f296f7e42784c901bcf0ea6a201.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X8mkl6gKY4p_OWeoxZrNCw.png"/></div></div><figcaption class="mp mq et er es mr ms bd b be z dx translated">MOVEit — ARM模板部署</figcaption></figure><p id="a718" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们可以使用<a class="ae mg" href="http://HTTPS://VMPublicIPAddress." rel="noopener ugc nofollow" target="_blank"> HTTPS://VMPublicIPAddress访问虚拟机。</a></p><figure class="ls lt lu lv fd mi er es paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="er es mx"><img src="../Images/eeb0397d7ea0c1b7477e9d3d7d9f25fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YEutessz36qXv4i7NEwBIg.png"/></div></div><figcaption class="mp mq et er es mr ms bd b be z dx translated">MOVEit —虚拟机访问</figcaption></figure><p id="e244" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后，您应该会看到初始仪表板</p><figure class="ls lt lu lv fd mi er es paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="er es my"><img src="../Images/dd80e94c5d108760c86aa81c01ca229f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qWmP1D9ya2fjCaqUc_GxZA.png"/></div></div><figcaption class="mp mq et er es mr ms bd b be z dx translated">移动自动化</figcaption></figure><p id="237e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">希望这能让您更好地理解如何使用ARM模板部署MOVEit。</p><p id="40af" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae mg" href="http://eepurl.com/gKmLdf" rel="noopener ugc nofollow" target="_blank"> <em class="mf">在此加入</em><strong class="ih hj"><em class="mf">azin sider</em></strong><em class="mf">邮箱列表。</em> </a></p><p id="1a83" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="mf">-戴夫·r</em></p></div></div>    
</body>
</html>