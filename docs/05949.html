<html>
<head>
<title>It’s not Python VS SQL for Data Analysis. They are in a love relationship!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">它不是用于数据分析的Python VS SQL。他们处于恋爱关系中！</h1>
<blockquote>原文：<a href="https://medium.com/codex/its-not-python-vs-sql-for-data-analysis-they-are-in-a-love-relationship-6e8d434a166b?source=collection_archive---------7-----------------------#2022-04-04">https://medium.com/codex/its-not-python-vs-sql-for-data-analysis-they-are-in-a-love-relationship-6e8d434a166b?source=collection_archive---------7-----------------------#2022-04-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/668ed36d0551ebc10c9bd674aee31ab7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*8CokY18GxbUwQIts"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><a class="ae iu" href="https://unsplash.com/@kellysikkema?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">凯利·西克马</a>在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">号航天飞机</a>上拍摄的照片</figcaption></figure><p id="4e33" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最终目标是使用最适合你工作的工具。但通常将一些工具(如SQL和Python)结合使用是有意义的。两者在很多方面都有很大的不同(这也将在下面的文本中讨论)，但是这并不意味着您必须在两者之间进行选择来完成您的分析任务。恰恰相反，它们可以很好地相互补充。</p><p id="5f6d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">但是，首先让我们快速了解一下关于数据分析任务的Python和SQL。</p><h2 id="8ae6" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated"><strong class="ak">蟒蛇</strong></h2><p id="f5e5" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">Python是一种通用编程语言。事实上，它将这一定义推向了极致。实际上，Python在现实世界中被用于几乎所有的东西，包括数据分析。而且，Python几乎可以在任何地方运行。在您的本地机器上，在服务器上，甚至在分布式系统上。</p><p id="f6d5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这可以通过可以导入的不同包来实现。出于数据分析的目的，最突出的一个无疑是熊猫，因为它为您提供了许多工具来处理基于表格格式的数据。这种方式也在其他各种包中实现，比如veax。此外，数据分析的任务可以使用类似PySpark或Dask的工具分布到多个系统中。这使得Python也适用于大数据分析。</p><p id="5c75" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">与SQL形成鲜明对比的是，Python还能够使用API、Web废弃和其他方式来收集数据。因此，包含不同的数据源非常灵活。</p><h2 id="2479" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">结构化查询语言</h2><p id="abb1" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">SQL是与关系数据库中的数据交互的查询语言。这是这种语言的唯一用例，但是它以一种非常有说服力的方式实现了它。它非常适合这个目的，40多年来它一直是事实上的标准，这在计算机科学中是一个很长的时间。</p><p id="7696" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">但也有一些局限性。SQL只能在数据库中使用，许多数据驱动的用例，如机器学习和复杂的统计，可以通过像Python这样的编程语言更好地实现。</p><p id="5abd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">另一个区别是，即使SQL运行在来自不同供应商的各种数据库系统上(它们可能有完全不同的用途，比如OLTP或OLAP)，SQL在任何地方看起来几乎都是相同的。当然，不同的供应商对SQL标准语法做了一些补充，但在任何地方都非常相似。这与事实有很大不同，Python代码看起来可能非常不同，这取决于使用的是哪个包。这个事实使得SQL非常容易使用。</p><h2 id="52c1" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">其中一个就足够了</h2><p id="8129" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">所以在我的标题中，我陈述了SQL和Python除了它们所有的不同之外，还有一种爱的关系。但是有一些主题，它们中的每一个都可以自己很好地工作。</p><p id="96b5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">就像在现实世界中一样，在任何良好的关系中，你都应该为自己做一些你的伴侣不喜欢的事情。</p><p id="f42c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">对于<strong class="ix hj"> SQL </strong>，例如:</p><ul class=""><li id="ae34" class="ku kv hi ix b iy iz jc jd jg kw jk kx jo ky js kz la lb lc bi translated">数据仓库中的查询</li><li id="a63a" class="ku kv hi ix b iy ld jc le jg lf jk lg jo lh js kz la lb lc bi translated">为数据仓库中的分析准备数据</li></ul><p id="3195" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这个不完整列表的要点有什么共同点？每项任务都是在数据库中单独完成的。这就是SQL的闪光点，不需要额外的工具。</p><p id="f4f7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">对于<strong class="ix hj"> Python </strong>来说，列表是这样的:</p><ul class=""><li id="5396" class="ku kv hi ix b iy iz jc jd jg kw jk kx jo ky js kz la lb lc bi translated">对csv文件进行一次性分析</li><li id="3778" class="ku kv hi ix b iy ld jc le jg lf jk lg jo lh js kz la lb lc bi translated">在不保存数据的情况下从API分析数据</li><li id="bda3" class="ku kv hi ix b iy ld jc le jg lf jk lg jo lh js kz la lb lc bi translated">从csv文件实现机器学习模型</li></ul><p id="e58c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">同样，这些列表项有什么共同点？没有与持久层(数据库)的联系，因此不需要SQL。</p><h1 id="6804" class="li ju hi bd jv lj lk ll jz lm ln lo kd lp lq lr kg ls lt lu kj lv lw lx km ly bi translated">两者都需要对方</h1><p id="2da5" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">我想现在您已经知道这是怎么回事了——Python需要帮助才能从数据库中获取数据并保存到数据库中。当SQL必须与它的数据库之外的东西交互时，它需要帮助。</p><p id="35cf" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">即使你自己做一些事情，每段工作关系的基础是一起做你们都喜欢的事情。</p><h2 id="0df6" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">他们是如何联系的</h2><p id="a7b1" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">Python作为两者之间的连接。有很多方法可以访问数据库中的数据。最常见的可能是使用SQLAlchemy包。pandas可以直接使用这个SQLAlachemy连接将SQL查询中所有需要的数据接收到dataframe中。</p><p id="be9b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">通常数据库不会给你直接连接它们的可能性。它被抽象在一个API后面，这对Python连接到数据源来说仍然没有问题。</p><h2 id="8578" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">在ETL/ELT中最适合您的地方进行分析</h2><p id="53e2" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">从一个系统收集数据，并使用ETL管道将其加载到目标数据库中，这可能是每个数据工程师最常见的任务。这就是Python经常被用作源数据系统和目标系统之间的粘合剂的地方。从API和Webscrapping获取数据是由Python完成的。使用PySpark之类的工具对非常复杂的逻辑或大数据规模进行转换和分析也非常适合Python。</p><p id="7be1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">以下架构模式是在Azure中构建的，但在不同的云提供商那里看起来非常相似。基本上，您可以在Databricks(托管spark环境)中使用Pyspark，或者在Azure函数(无服务器函数)中使用pandas来转换数据。然后可以将转换后的数据加载到Synapse(数据仓库)或任何其他数据库中。</p><figure class="ma mb mc md fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lz"><img src="../Images/7a4ad02d7ab8ac94f96dc9519eff318f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rm9MuuuGY1oXANaRy_4pIQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">使用Azure堆栈的现代数据环境的架构</figcaption></figure><p id="802f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在这就是伟大的关系出现的地方。您可以决定不同的分析任务在哪里最适合。通常，使用Python，您应该进行复杂的统计。这些结果可以在进行其余的转换时生成。之后，您可以将数据(包括您的统计数据)加载到您的数据仓库中，以执行其他特别分析。</p><h2 id="978a" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated"><strong class="ak">机器学习/数据科学</strong></h2><p id="d4d9" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">训练/推理是另一项任务，两种工具可以很好地协同工作。您的ML解决方案中使用的数据通常由数据库提供。您可以简单地从数据库中查询所有需要的数据，并在Python代码中完成所有繁重的工作。</p><p id="23f4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">更好的方法是使用合适的SQL查询来获得您真正需要的数据。如前所述，SQL是定义所需数据的一种非常有效的方式。事实上，如果您使用好的查询，其中可以利用索引，您可以提高整个解决方案的性能。</p><h2 id="de5a" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">结论</h2><p id="6daf" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">我希望你喜欢这篇文章。我的主要目标是为您提供一些关于SQL和Python如何以有益的方式协同工作的想法。另外，要提醒你的是，每种工具都有它的优点和缺点。与指环王不同，没有一个工具可以统治所有的工具，通常最好是结合你的工具的优点来弥补它们的缺点。</p></div></div>    
</body>
</html>