<html>
<head>
<title>JavaScript Discord Bot Tutorial — Code a Discord Bot And Host it for Free</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript不和谐机器人教程——编写一个不和谐机器人并免费托管它</h1>
<blockquote>原文：<a href="https://medium.com/codex/javascript-discord-bot-tutorial-code-a-discord-bot-and-host-it-for-free-25ea5314fd77?source=collection_archive---------2-----------------------#2021-09-15">https://medium.com/codex/javascript-discord-bot-tutorial-code-a-discord-bot-and-host-it-for-free-25ea5314fd77?source=collection_archive---------2-----------------------#2021-09-15</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/4b7476d06d821bece4f4cdbe5ba5670d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Srvk1yL24D-JTgce"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">亚历山大·沙托夫在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="705c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">本教程将向您展示如何使用JavaScript和Node.js完全在云中构建自己的Discord bot。</p><p id="e574" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">你不需要在你的电脑上安装任何东西，你也不需要支付任何费用来托管你的机器人。</p><p id="b7ca" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们将使用许多工具，包括Discord API、Node.js库和一个名为<a class="ae iu" href="https://www.repl.it/" rel="noopener ugc nofollow" target="_blank"> Repl.it </a>的云计算平台。</p><p id="14f2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果你更愿意使用Python而不是JavaScript来编写你的discord bot，<a class="ae iu" href="https://www.freecodecamp.org/news/create-a-discord-bot-with-python/" rel="noopener ugc nofollow" target="_blank">阅读本教程而不是</a>。</p></div><div class="ab cl jt ju gp jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="hb hc hd he hf"><h1 id="3675" class="ka kb hi bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">如何创建一个不和谐机器人帐户</h1><p id="7eec" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">为了使用Node.js库和Discord API，我们必须首先创建一个Discord Bot帐户。</p><p id="055e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">以下是创建不和谐机器人账户的步骤。</p><p id="8227" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">1.确保您登录了<a class="ae iu" href="https://discord.com/" rel="noopener ugc nofollow" target="_blank"> Discord网站</a>。</p><p id="4361" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">2.导航到<a class="ae iu" href="https://discord.com/developers/applications" rel="noopener ugc nofollow" target="_blank">应用程序页面</a>。</p><p id="c397" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">3.单击“新建应用程序”按钮。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div class="er es ld"><img src="../Images/aaa680114ba8c3a90e62105e142d64bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1026/format:webp/1*eMUHP7CaknuH0oSgdHorDQ.png"/></div></figure><p id="b930" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">4.为应用程序命名，然后单击“创建”</p><figure class="le lf lg lh fd ij er es paragraph-image"><div class="er es li"><img src="../Images/f23b7420c6980901fc3c25a683838855.png" data-original-src="https://miro.medium.com/v2/resize:fit:904/format:webp/1*nh9ivLx-OcYZaQ_v3OHAuQ.png"/></div></figure><p id="5d45" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">5.转到“机器人”选项卡，然后单击“添加机器人”。你必须通过点击“是，做它！”来确认</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lj"><img src="../Images/e6799a0599ce7ce568a9b9290e0398f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xd_frvy-kkICRfSrwCL4KA.png"/></div></div></figure><p id="2323" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">保留<strong class="ix hj">公共Bot </strong>(选中)和<strong class="ix hj">需要OAuth2代码授权</strong>(未选中)的默认设置。</p><p id="b968" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">您的机器人已经创建。下一步是复制令牌。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lk"><img src="../Images/395fc7ef8dec6faa10c5a8c182dc27af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*CFSZaHUbCPEGNEO_.png"/></div></div></figure><p id="ca2d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这个令牌是你的机器人的密码，所以不要与任何人分享。它可以让某人登录你的机器人，做各种坏事。</p><p id="9fe4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果令牌意外被共享，您可以重新生成令牌。</p></div><div class="ab cl jt ju gp jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="hb hc hd he hf"><h1 id="e7de" class="ka kb hi bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">如何邀请你的机器人加入服务器</h1><p id="9a66" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">现在你必须让你的机器人用户进入服务器。为此，您应该为它创建一个邀请URL。</p><p id="4bd7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">转到“OAuth2”选项卡。然后在“scopes”部分选择“bot”。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ll"><img src="../Images/0a088077f6fe04a79aded5cd227a33a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ojA7m-2BMxGK8mxj.png"/></div></div></figure><p id="e4f5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在选择你想要的权限。我们的机器人将主要使用短信，所以我们不需要太多的权限。你可能需要更多，这取决于你想让你的机器人做什么。小心“管理员”权限。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ll"><img src="../Images/e08b9de93b4a86dd994f300cc7f4ccae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*QnrNAOQvWhorVeWf.png"/></div></div></figure><p id="8ed9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">选择适当的权限后，单击权限上方的“复制”按钮。这将复制一个可用于将机器人添加到服务器的URL。</p><p id="fff6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">将URL粘贴到您的浏览器中，选择要邀请机器人的服务器，然后单击“授权”。</p><p id="bc28" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">要添加bot，您的帐户需要“管理服务器”权限。</p><p id="1b7b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在您已经创建了机器人用户，我们将开始为机器人编写Python代码。</p></div><div class="ab cl jt ju gp jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="hb hc hd he hf"><h1 id="7864" class="ka kb hi bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">如何用discord.js库编写一个基本的Discord Bot</h1><p id="ba21" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">我们将使用discord.js节点库来编写机器人代码。discord.js是discord的API包装器，使得在Node.js / JavaScript中创建Discord bot更加容易。</p><h1 id="3f12" class="ka kb hi bd kc kd lm kf kg kh ln kj kk kl lo kn ko kp lp kr ks kt lq kv kw kx bi translated">如何创建Repl并安装discord.js</h1><p id="d082" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">您可以在本地计算机上使用任何代码编辑器开发bot。然而，在本教程中，我们将使用Repl.it，因为它将使任何人都更容易理解。它是一个在线IDE，你可以在你的网络浏览器中使用。</p><p id="6d1d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">首先转到<a class="ae iu" href="https://repl.it/" rel="noopener ugc nofollow" target="_blank"> Repl.it </a>。创建一个新的Repl并选择“Node.js”作为语言。这意味着编程语言将是JavaScript。</p><p id="d8f4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">要使用discord.js库，只需在<code class="du lr ls lt lu b">main.js</code>的顶部添加<code class="du lr ls lt lu b">const Discord = require("discord.js");</code>即可。当您按下“运行”按钮时，它将自动安装这个依赖项。</p><h1 id="4c03" class="ka kb hi bd kc kd lm kf kg kh ln kj kk kl lo kn ko kp lp kr ks kt lq kv kw kx bi translated">如何为你的机器人设置不和谐事件</h1><p id="b656" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">discord.js围绕着事件的概念。一个事件是你听了然后做出反应的事情。例如，当一个消息发生时，您将收到一个关于它的事件，您可以对其进行响应。</p><p id="c582" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们制作一个回复特定消息的机器人。这个简单的机器人代码直接取自discord.js文档。我们将在以后增加更多的功能。</p><p id="22b1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">将这段代码添加到main.js中。我将很快解释所有这些代码的作用。</p><pre class="le lf lg lh fd lv lu lw lx aw ly bi"><span id="8ecb" class="lz kb hi lu b fi ma mb l mc md">const Discord = require("discord.js")<br/>const client = new Discord.Client()<br/><br/>client.on("ready", () =&gt; {<br/>  console.log(`Logged in as ${client.user.tag}!`)<br/>})<br/><br/>client.on("message", msg =&gt; {<br/>  if (msg.content === "ping") {<br/>    msg.reply("pong");<br/>  }<br/>})<br/><br/>client.login(process.env.TOKEN)</span></pre><p id="8cf9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">当你在Discord上创建你的机器人用户时，你复制了一个令牌。现在我们将创建一个<code class="du lr ls lt lu b">.env</code>文件来存储令牌。</p><p id="44bb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><code class="du lr ls lt lu b">.env</code>文件用于声明环境变量。在Repl.it上，你创建的大多数文件对任何人都可见，但<code class="du lr ls lt lu b">.env</code>文件只对你可见。查看公共repl的其他人将看不到<code class="du lr ls lt lu b">.env</code>文件的内容。</p><p id="db8b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因此，如果您在Repl.it上进行开发，只需在一个<code class="du lr ls lt lu b">.env</code>文件中包含私有信息，如令牌或密钥。</p><p id="42fd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">点击“添加文件”按钮，创建一个名为<code class="du lr ls lt lu b">.env</code>的文件。</p><p id="4429" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在文件中添加以下行，包括您之前复制的实际令牌:</p><pre class="le lf lg lh fd lv lu lw lx aw ly bi"><span id="03ae" class="lz kb hi lu b fi ma mb l mc md">TOKEN=[paste token here]</span></pre><p id="41f2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在让我们来看看每一行代码在你的不和谐机器人代码中做了什么。</p><p id="5a05" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">第一行导入discord.js库。接下来，我们创建一个<code class="du lr ls lt lu b"><a class="ae iu" href="https://discordpy.readthedocs.io/en/latest/api.html#discord.Client" rel="noopener ugc nofollow" target="_blank">Client</a></code>的实例。这是与不和谐的联系。</p><p id="4c09" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><code class="du lr ls lt lu b">client.on()</code>用于检查事件。它接受一个事件名，然后在事件发生时调用一个回调函数。在这段代码中，当bot准备好开始使用时，将调用<code class="du lr ls lt lu b">ready</code>事件。然后，当Discord服务器有新消息时，就会调用<code class="du lr ls lt lu b">message</code>事件。</p><p id="7033" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">代码检查<code class="du lr ls lt lu b"><a class="ae iu" href="https://discordpy.readthedocs.io/en/latest/api.html#discord.Message.content" rel="noopener ugc nofollow" target="_blank">msg.content</a></code>是否等于<code class="du lr ls lt lu b">'ping'</code>。如果是，那么机器人回复<code class="du lr ls lt lu b">'pong'</code>给频道。</p><p id="f8ad" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在bot已经设置好了，最后一行代码使用登录令牌运行bot。它从out <code class="du lr ls lt lu b">.env</code>文件中获取令牌。</p><p id="17b8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们有机器人的代码，所以现在我们只需要运行它。</p><h1 id="d16e" class="ka kb hi bd kc kd lm kf kg kh ln kj kk kl lo kn ko kp lp kr ks kt lq kv kw kx bi translated">如何运行这个机器人</h1><p id="1c09" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">现在单击顶部的run按钮，在repl.it中运行您的bot。</p><p id="c114" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在去你的不和谐房间输入“ping”。你的机器人应该返回“乓”。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es me"><img src="../Images/79125c82d67985d0c36e3e583d858c04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*glPMJ1R15Bc6-ePh.png"/></div></div></figure></div><div class="ab cl jt ju gp jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="hb hc hd he hf"><h1 id="45c8" class="ka kb hi bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">如何改进Bot</h1><p id="423f" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">现在我们有了一个基本的机器人，我们将改进它。之所以叫“鼓励Bot”是有原因的。</p><p id="6a68" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">每当有人发送包含悲伤或沮丧词语的消息时，这个机器人就会回复一条鼓励的消息。</p><p id="189f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">任何人都可以添加鼓励消息供机器人使用，用户提交的消息将存储在Repl.it数据库中。</p><p id="71e4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">当有人在聊天中键入消息“$inspire”时，该机器人还会从API中返回随机的灵感引用。</p><p id="a2d5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们将从添加“$inspire”功能开始。</p><h1 id="0fa4" class="ka kb hi bd kc kd lm kf kg kh ln kj kk kl lo kn ko kp lp kr ks kt lq kv kw kx bi translated">如何给机器人添加励志名言</h1><p id="0e14" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">我们将从一个名为zenquotes.io的API中获得启发性的报价。我们需要导入node-fetch模块，添加一个<code class="du lr ls lt lu b">getQuote()</code>函数，并更新我们的bot代码以调用该函数。</p><p id="8ecc" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">下面是更新后的代码。在代码之后，我将解释新的部分。</p><pre class="le lf lg lh fd lv lu lw lx aw ly bi"><span id="0624" class="lz kb hi lu b fi ma mb l mc md">const Discord = require("discord.js")<br/>const fetch = require("node-fetch")<br/>const client = new Discord.Client()</span><span id="2984" class="lz kb hi lu b fi mf mb l mc md">function getQuote() {<br/>  return fetch("https://zenquotes.io/api/random")<br/>    .then(res =&gt; {<br/>      return res.json()<br/>      })<br/>    .then(data =&gt; {<br/>      return data[0]["q"] + " -" + data[0]["a"]<br/>    })<br/>}</span><span id="4817" class="lz kb hi lu b fi mf mb l mc md">client.on("ready", () =&gt; {<br/>  console.log(`Logged in as ${client.user.tag}!`)<br/>})</span><span id="1f6b" class="lz kb hi lu b fi mf mb l mc md">client.on("message", msg =&gt; {<br/>  if (msg.author.bot) return<br/>    <br/>  if (msg.content === "$inspire") {<br/>    getQuote().then(quote =&gt; msg.channel.send(quote))<br/>  }<br/>})</span><span id="212b" class="lz kb hi lu b fi mf mb l mc md">client.login(process.env.TOKEN)</span></pre><p id="6a13" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们现在必须导入<code class="du lr ls lt lu b">node-fetch</code>模块。这个模块允许我们的代码发出HTTP请求，从API获取数据。</p><p id="2e10" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这个功能非常简单。首先，它使用节点获取模块从API URL请求数据。API会返回一个随机的启发性引用。如果当前的API停止工作，可以很容易地重写这个函数，从不同的API获取报价。</p><p id="607d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然后，该函数将响应从API转换为JSON，并创建一个要返回的字符串。通过反复试验，我知道了如何将JSON中的引用转换成我想要的字符串格式。引号作为字符串从函数中返回。</p><p id="186a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">代码中更新的最后一部分接近末尾。先前它寻找“ping”消息。现在它在寻找“$inspire”。它不是返回“pong ”,而是用<code class="du lr ls lt lu b">getQuote()</code>获取报价并返回报价。我们使用<code class="du lr ls lt lu b">msg.channel.send()</code>将消息发送到通道。此外，代码检查消息是否来自机器人本身，如果是，它离开函数，因此它不做任何事情。</p><p id="83c1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">此时，您可以运行您的代码并进行测试。</p><h1 id="80e6" class="ka kb hi bd kc kd lm kf kg kh ln kj kk kl lo kn ko kp lp kr ks kt lq kv kw kx bi translated">如何给机器人添加鼓励信息</h1><p id="2c3f" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">现在，我们将实现这样一个功能，当用户发布一条带有悲伤字眼的消息时，机器人会以鼓励性的消息做出响应。</p><h1 id="1a31" class="ka kb hi bd kc kd lm kf kg kh ln kj kk kl lo kn ko kp lp kr ks kt lq kv kw kx bi translated">如何给机器人加上悲伤的字眼</h1><p id="5b2e" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">首先，我们需要创建一个数组，其中包含机器人将会响应的悲伤词。</p><p id="42ca" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在<code class="du lr ls lt lu b">client</code>变量被创建后添加下面一行:</p><p id="409e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><code class="du lr ls lt lu b">sadWords = ["sad", "depressed", "unhappy", "angry", "miserable"]</code></p><p id="a05c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">请随意在列表中添加更多的单词。</p><h1 id="f00c" class="ka kb hi bd kc kd lm kf kg kh ln kj kk kl lo kn ko kp lp kr ks kt lq kv kw kx bi translated">如何给机器人添加鼓励信息</h1><p id="5057" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">现在，我们将添加一系列鼓励性的消息，机器人将对此做出响应。</p><p id="d867" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在您创建的<code class="du lr ls lt lu b">sadWords</code>列表后添加以下数组:</p><pre class="le lf lg lh fd lv lu lw lx aw ly bi"><span id="8c3d" class="lz kb hi lu b fi ma mb l mc md">encouragements = [<br/>  "Cheer up!",<br/>  "Hang in there.",<br/>  "You are a great person / bot!"<br/>]</span></pre><p id="d1a3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">像以前一样，您可以随意向数组中添加更多您选择的短语。我现在只使用三个项目，因为稍后我们将为用户添加更多鼓励机器人使用的短语的能力。</p><h1 id="6547" class="ka kb hi bd kc kd lm kf kg kh ln kj kk kl lo kn ko kp lp kr ks kt lq kv kw kx bi translated">如何回复邮件</h1><p id="b77e" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">现在我们需要更新我们的bot来使用我们创建的两个列表。</p><p id="2992" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在我们将更新<code class="du lr ls lt lu b">message</code>函数来检查所有消息，看它们是否包含来自<code class="du lr ls lt lu b">sadWords</code>列表的单词。如果发现一个悲伤的单词，机器人会随机发送一条鼓励的消息。</p><p id="e558" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">以下是更新后的代码:</p><pre class="le lf lg lh fd lv lu lw lx aw ly bi"><span id="7597" class="lz kb hi lu b fi ma mb l mc md">client.on("message", msg =&gt; {<br/>  if (msg.content === "$inspire") {<br/>    getQuote().then(quote =&gt; msg.channel.send(quote))<br/>  }</span><span id="6410" class="lz kb hi lu b fi mf mb l mc md">  if (sadWords.some(word =&gt; msg.content.includes(word))) {<br/>    const encouragement = encouragements[Math.floor(Math.random() * encouragements.length)]<br/>    msg.reply(encouragement)<br/>  }</span><span id="dbc1" class="lz kb hi lu b fi mf mb l mc md">})</span></pre><p id="52f5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这是测试机器人的好时机。你现在知道的足够多了，可以创建你自己的机器人了。但是接下来您将学习如何实现更高级的特性，以及如何使用Repl.it数据库存储数据。</p><h1 id="794d" class="ka kb hi bd kc kd lm kf kg kh ln kj kk kl lo kn ko kp lp kr ks kt lq kv kw kx bi translated">如何启用用户提交的邮件</h1><p id="d8b6" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">该机器人是完全功能性的，但现在让我们有可能从不和谐的权利更新机器人。当机器人检测到一个悲伤的单词时，用户应该能够添加更多鼓励的消息。</p><p id="475f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们将使用Repl。它是一个内置的数据库，用来存储用户提交的消息。这个数据库是内置于每个repl中的键值存储。</p><p id="ef44" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在代码顶部的其他导入语句下，添加:</p><pre class="le lf lg lh fd lv lu lw lx aw ly bi"><span id="4b91" class="lz kb hi lu b fi ma mb l mc md">const Database = require("@replit/database")<br/>const db = new Database()</span></pre><p id="5b31" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这将允许我们使用Repl.it数据库。当您运行代码时，Repl.it应该会自动安装数据库模块。如果由于某种原因没有，您可能需要进入Shell选项卡(不是控制台)并键入“npm install @replit/database”。</p><p id="2c0c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在创建了数组<code class="du lr ls lt lu b">encouragements</code>之后，插入以下代码，以便在需要时将激励添加到数据库中:</p><pre class="le lf lg lh fd lv lu lw lx aw ly bi"><span id="3138" class="lz kb hi lu b fi ma mb l mc md">db.get("encouragements").then(encouragements =&gt; {<br/>  if (!encouragements || encouragements.length &lt; 1) {<br/>    db.set("encouragements", starterEncouragements)<br/>  }  <br/>})</span></pre><p id="8dd6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">同样，将顶部的<code class="du lr ls lt lu b">encouragements</code>数组重命名为<code class="du lr ls lt lu b">starterEncouragements</code>。</p><p id="a5f2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">用户将能够添加自定义的鼓励消息，让机器人直接从Discord聊天中使用。在我们为bot添加新命令之前，让我们创建两个助手函数，它们将向数据库添加自定义消息并删除它们。</p><p id="caa8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在<code class="du lr ls lt lu b">getQuote()</code>函数后添加以下代码:</p><pre class="le lf lg lh fd lv lu lw lx aw ly bi"><span id="7ee0" class="lz kb hi lu b fi ma mb l mc md">function updateEncouragements(encouragingMessage) {<br/>  db.get("encouragements").then(encouragements =&gt; {<br/>    encouragements.push([encouragingMessage])<br/>    db.set("encouragements", encouragements)<br/>  })<br/>}</span><span id="49b0" class="lz kb hi lu b fi mf mb l mc md">function deleteEncouragment(index) {<br/>  db.get("encouragements").then(encouragements =&gt; {<br/>    if (encouragements.length &gt; index) {<br/>      encouragements.splice(index, 1)<br/>      db.set("encouragements", encouragements)<br/>    }<br/>  })<br/>}</span></pre><p id="63ee" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><code class="du lr ls lt lu b">updateEncouragements()</code>该函数接受一条鼓励性的消息作为参数。</p><p id="6969" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">首先，它从数据库中获得“鼓励”。然后，它将新的鼓励添加到数组中，并将更新后的数组存储回数据库中的“鼓励”键下。</p><p id="0527" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><code class="du lr ls lt lu b">deleteEncouragement()</code>函数接受一个索引作为参数。</p><p id="212a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">它从存储在“鼓励”键下的数据库中获取鼓励列表。如果长度大于索引，则删除该索引处的列表项。最后，更新后的列表被存储回数据库中的“鼓励”键下。</p><p id="bf2b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">以下是<code class="du lr ls lt lu b">message</code>功能的更新代码。在代码之后，我将解释新的部分。</p><pre class="le lf lg lh fd lv lu lw lx aw ly bi"><span id="bac7" class="lz kb hi lu b fi ma mb l mc md">client.on("message", msg =&gt; {<br/>  if (msg.content === "$inspire") {<br/>    getQuote().then(quote =&gt; msg.channel.send(quote))<br/>  }</span><span id="8b88" class="lz kb hi lu b fi mf mb l mc md">  <br/>  if (sadWords.some(word =&gt; msg.content.includes(word))) {<br/>    db.get("encouragements").then(encouragements =&gt; {<br/>      const encouragement = encouragements[Math.floor(Math.random() * encouragements.length)]<br/>      msg.reply(encouragement)<br/>    })<br/>  }</span><span id="3d25" class="lz kb hi lu b fi mf mb l mc md">  if (msg.content.startsWith("$new")) {<br/>    encouragingMessage = msg.content.split("$new ")[1]<br/>    updateEncouragements(encouragingMessage)<br/>    msg.channel.send("New encouraging message added.")<br/>  }</span><span id="2068" class="lz kb hi lu b fi mf mb l mc md">  if (msg.content.startsWith("$del")) {<br/>    index = parseInt(msg.content.split("$del ")[1])<br/>    deleteEncouragment(index)<br/>    msg.channel.send("Encouraging message deleted.")<br/>  }<br/>})</span></pre><p id="0d28" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">悲伤的话部分已经更新，以使用来自数据库的鼓励信息，因此用户提交的信息可以使用。</p><p id="c6a0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">下一段新代码用于向数据库添加新的用户提交的消息。如果不和谐信息以“$new”开头，那么“$new”之后的文本将被用作新的鼓励信息。</p><p id="4005" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">代码<code class="du lr ls lt lu b">msg.content.split('$new ')[1]</code>从“$new”命令中分离出消息，并将该消息存储在一个变量中。在那行代码中，记下<code class="du lr ls lt lu b">'$new '</code>中的空格。我们想要空间之后的一切。</p><p id="3233" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们用新消息调用<code class="du lr ls lt lu b">updateEncouragements</code> helper函数，然后bot向discord chat发送一条消息，确认消息已被添加。</p><p id="b87b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">第三个新的部分(在上面代码的末尾)检查新的Discord消息是否以“$del”开头。这是从数据库的“鼓励”列表中删除项目的命令。</p><p id="ff19" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">索引是从以“$del”开始的Discord消息中分离出来的。然后调用<code class="du lr ls lt lu b">deleteEncouragement()</code>函数传入要删除的索引。更新后的鼓励列表被加载到<code class="du lr ls lt lu b">encouragements</code>变量中，然后机器人发送一条消息来改变当前列表。</p></div><div class="ab cl jt ju gp jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="hb hc hd he hf"><h1 id="2e32" class="ka kb hi bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">最终Bot功能</h1><p id="3191" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">机器人应该工作，所以这是一个很好的时间来测试它。我们现在将添加一些最后的功能。</p><p id="5537" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们将增加从Discord获取用户提交的消息列表的能力，并且我们将增加关闭和打开机器人是否响应悲伤话语的能力。</p><p id="1f62" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我会给你完整的程序最终代码，然后我会讨论代码下面的更新。</p><pre class="le lf lg lh fd lv lu lw lx aw ly bi"><span id="0a07" class="lz kb hi lu b fi ma mb l mc md">const Discord = require("discord.js")<br/>const fetch = require("node-fetch")<br/>const Database = require("@replit/database")</span><span id="0143" class="lz kb hi lu b fi mf mb l mc md">const db = new Database()<br/>const client = new Discord.Client()</span><span id="a4e9" class="lz kb hi lu b fi mf mb l mc md">const sadWords = ["sad", "depressed", "unhappy", "angry", "miserable"]</span><span id="c3d0" class="lz kb hi lu b fi mf mb l mc md">const starterEncouragements = [<br/>  "Cheer up!",<br/>  "Hang in there.",<br/>  "You are a great person / bot!"<br/>]</span><span id="eb70" class="lz kb hi lu b fi mf mb l mc md">db.get("encouragements").then(encouragements =&gt; {<br/>  console.log(encouragements)<br/>  if (!encouragements || encouragements.length &lt; 1) {<br/>    db.set("encouragements", starterEncouragements)<br/>  }  <br/>})</span><span id="10d8" class="lz kb hi lu b fi mf mb l mc md">db.get("responding").then(value =&gt; {<br/>  if (value == null) {<br/>    db.set("responding", true)<br/>  }  <br/>})</span><span id="91b8" class="lz kb hi lu b fi mf mb l mc md">function getQuote() {<br/>  return fetch("https://zenquotes.io/api/random")<br/>    .then(res =&gt; {<br/>      return res.json()<br/>      })<br/>    .then(data =&gt; {<br/>      return data[0]["q"] + " -" + data[0]["a"]<br/>    })<br/>}</span><span id="e28b" class="lz kb hi lu b fi mf mb l mc md">function updateEncouragements(encouragingMessage) {<br/>  db.get("encouragements").then(encouragements =&gt; {<br/>    encouragements.push([encouragingMessage])<br/>    db.set("encouragements", encouragements)<br/>  })<br/>}</span><span id="94c6" class="lz kb hi lu b fi mf mb l mc md">function deleteEncouragment(index) {<br/>  db.get("encouragements").then(encouragements =&gt; {<br/>    if (encouragements.length &gt; index) {<br/>      encouragements.splice(index, 1)<br/>      db.set("encouragements", encouragements)<br/>    }<br/>  })<br/>}</span><span id="8035" class="lz kb hi lu b fi mf mb l mc md">client.on("ready", () =&gt; {<br/>  console.log(`Logged in as ${client.user.tag}!`)<br/>})</span><span id="d01e" class="lz kb hi lu b fi mf mb l mc md">client.on("message", msg =&gt; {<br/>  if (msg.content === "$inspire") {<br/>    getQuote().then(quote =&gt; msg.channel.send(quote))<br/>  }</span><span id="7a28" class="lz kb hi lu b fi mf mb l mc md">  db.get("responding").then(responding =&gt; {<br/>    if (responding &amp;&amp; sadWords.some(word =&gt; msg.content.includes(word))) {<br/>      db.get("encouragements").then(encouragements =&gt; {<br/>        const encouragement = encouragements[Math.floor(Math.random() * encouragements.length)]<br/>        msg.reply(encouragement)<br/>      })<br/>    }<br/>  })</span><span id="8828" class="lz kb hi lu b fi mf mb l mc md">  if (msg.content.startsWith("$new")) {<br/>    encouragingMessage = msg.content.split("$new ")[1]<br/>    updateEncouragements(encouragingMessage)<br/>    msg.channel.send("New encouraging message added.")<br/>  }</span><span id="9dd5" class="lz kb hi lu b fi mf mb l mc md">  if (msg.content.startsWith("$del")) {<br/>    index = parseInt(msg.content.split("$del ")[1])<br/>    deleteEncouragment(index)<br/>    msg.channel.send("Encouraging message deleted.")<br/>  }</span><span id="41a8" class="lz kb hi lu b fi mf mb l mc md">  if (msg.content.startsWith("$list")) {<br/>    db.get("encouragements").then(encouragements =&gt; {<br/>      msg.channel.send(encouragements)<br/>    })<br/>  }<br/>    <br/>  if (msg.content.startsWith("$responding")) {<br/>    value = msg.content.split("$responding ")[1]</span><span id="fb32" class="lz kb hi lu b fi mf mb l mc md">    if (value.toLowerCase() == "true") {<br/>      db.set("responding", true)<br/>      msg.channel.send("Responding is on.")<br/>    } else {<br/>      db.set("responding", false)<br/>      msg.channel.send("Responding is off.")<br/>    }<br/>  }<br/>})</span><span id="b27c" class="lz kb hi lu b fi mf mb l mc md">client.login(process.env.TOKEN)</span></pre><p id="5d75" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">添加到代码中的第一个部分位于<code class="du lr ls lt lu b">starterEncouragements</code>列表的正下方:</p><pre class="le lf lg lh fd lv lu lw lx aw ly bi"><span id="60ae" class="lz kb hi lu b fi ma mb l mc md">db.get("responding").then(value =&gt; {<br/>  if (value == null) {<br/>    db.set("responding", true)<br/>  }  <br/>})</span></pre><p id="5d19" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们在数据库中创建一个名为“responding”的新键，并将其设置为“true”。我们将用它来决定机器人是否应该回应悲伤的话语。因为即使在程序停止运行后，数据库仍被保存，所以我们只在新键不存在时才创建它。</p><p id="1431" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">代码的下一个新部分在响应悲伤词的部分，现在在if语句中。机器人只会回应悲伤的话，如果<code class="du lr ls lt lu b">db.get("responding") = true</code>。更新这个值的能力在下一节之后。</p><p id="4efd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">接下来，在让机器人响应“$del”命令的代码之后，有一个新代码在作为不和谐消息发送时响应“$list”命令。</p><p id="3967" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">机器人会将鼓励列表作为不和谐消息发送出去。</p><p id="65c4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">接下来是最后一个新部分。这段代码让机器人响应“$responding”命令。此命令接受“true”或“false”参数。下面是一个用法示例:“$responding true”。</p><p id="90cc" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">代码首先使用<code class="du lr ls lt lu b">value = msg.content.split("$responding ")[1]</code>完成参数(像以前一样，注意<code class="du lr ls lt lu b">"$responding "</code>中的空格)。然后有一个if/else语句适当地设置数据库中的“responding”键，并向Discord发回一个通知消息。如果参数不为“真”，则代码假定为“假”。</p><p id="032f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">机器人的代码完成了！你现在可以运行这个机器人并进行测试。但是还有一个更重要的步骤，我们将在下面讨论。</p></div><div class="ab cl jt ju gp jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="hb hc hd he hf"><h1 id="588d" class="ka kb hi bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">如何设置Bot持续运行</h1><p id="4ba4" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">如果您在repl.it中运行您的bot，然后关闭它正在运行的选项卡，您的bot将停止运行。</p><p id="7223" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">但是有两种方法可以让你的机器人持续运行，甚至在你关闭浏览器之后。</p><p id="194e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">第一种方法也是最简单的方法是在Repl.it中注册一个付费计划。他们最便宜的付费计划叫做黑客计划，它包括五个永远在线的Repl。</p><p id="d279" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">使用此链接可免费获得三个月(限前1000人):【https://repl.it/claim?code=tryalwayson2103<a class="ae iu" href="https://repl.it/claim?code=tryalwayson2103" rel="noopener ugc nofollow" target="_blank"/></p><p id="bdf9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">一旦您注册了该计划，请打开您的Repl并单击顶部的名称。然后选择“始终开启”选项。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mh"><img src="../Images/f7ce4ed2c28888cea74310db392fad9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*2-87bm-XjEqw4oTJ.png"/></div></div></figure><p id="22b3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">还有另一种方法可以让你的代码运行在自由层，但是有点复杂。Repl.it将继续运行web服务器，即使在选项卡关闭后。但是，即使是网络服务器也只能在没有任何用途的情况下运行一个小时。</p><p id="a71a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">以下是回复文件中的内容:</p><blockquote class="mi mj mk"><p id="a454" class="iv iw mg ix b iy iz ja jb jc jd je jf ml jh ji jj mm jl jm jn mn jp jq jr js hb bi translated"><em class="hi">一旦部署，服务器将继续在后台运行，甚至在您关闭浏览器选项卡之后。服务器将保持唤醒和活动状态，直到它发出最后一个请求一个小时后，它将进入休眠阶段。休眠的repls一收到另一个请求就会被唤醒；不需要重新运行repl。但是，如果您对服务器进行了更改，您将需要重新启动repl，以便看到这些更改反映在live版本中。</em></p></blockquote><p id="8ab8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了保持机器人持续运行，我们将在https://uptimerobot.com/<a class="ae iu" href="https://uptimerobot.com/" rel="noopener ugc nofollow" target="_blank">使用另一项名为Uptime Robot的免费服务。</a></p><p id="f60a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Uptime Robot可以设置为每5分钟ping repl . it上的bot web服务器。随着不断的ping，机器人将永远不会进入睡眠阶段，只会继续运行。</p><p id="91ca" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因此，我们还需要做两件事来让我们的机器人持续运行:</p><ol class=""><li id="f99e" class="mo mp hi ix b iy iz jc jd jg mq jk mr jo ms js mt mu mv mw bi translated">在repl.it中创建一个web服务器</li><li id="414b" class="mo mp hi ix b iy mx jc my jg mz jk na jo nb js mt mu mv mw bi translated">设置正常运行时间机器人持续ping网络服务器。</li></ol><h1 id="a030" class="ka kb hi bd kc kd lm kf kg kh ln kj kk kl lo kn ko kp lp kr ks kt lq kv kw kx bi translated">如何在repl.it中创建Web服务器</h1><p id="b2ac" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">创建一个web服务器比你想象的要简单。</p><p id="8bbc" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为此，在您的项目中创建一个名为<code class="du lr ls lt lu b">server.js</code>的新文件。</p><p id="de69" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然后添加以下代码:</p><pre class="le lf lg lh fd lv lu lw lx aw ly bi"><span id="2d49" class="lz kb hi lu b fi ma mb l mc md">const express = require("express")</span><span id="4f0d" class="lz kb hi lu b fi mf mb l mc md">const server = express()</span><span id="23e4" class="lz kb hi lu b fi mf mb l mc md">server.all("/", (req, res) =&gt; {<br/>  res.send("Bot is running!")<br/>})</span><span id="61ba" class="lz kb hi lu b fi mf mb l mc md">function keepAlive() {<br/>  server.listen(3000, () =&gt; {<br/>    console.log("Server is ready.")<br/>  })<br/>}</span><span id="a452" class="lz kb hi lu b fi mf mb l mc md">module.exports = keepAlive</span></pre><p id="f458" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这段代码中，我们使用express启动一个web服务器。服务器返回“Bot正在运行！”任何参观过它的人。服务器将在一个独立于我们的机器人的线程上运行。我们不会在这里讨论所有的事情，因为其余的都与我们的机器人无关。</p><p id="8422" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在我们只需要机器人来运行这个网络服务器。</p><p id="98f2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在<code class="du lr ls lt lu b">index.js</code>的顶部添加下面一行来导入服务器。</p><pre class="le lf lg lh fd lv lu lw lx aw ly bi"><span id="57ce" class="lz kb hi lu b fi ma mb l mc md">const keepAlive = require("./server")</span></pre><p id="9aa9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">要在运行<code class="du lr ls lt lu b">index.js</code>时启动web服务器，在bot运行之前添加下面一行作为倒数第二行。</p><p id="5d81" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><code class="du lr ls lt lu b">keepAlive()</code></p><p id="0066" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">添加完这段代码后，当您在repl.it上运行bot时，将会打开一个新的web服务器窗口。显示了web服务器的URL。复制URL，以便在下一节中使用。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ll"><img src="../Images/465fccc38d7eda081d10e4ce4dfbe392.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Fbv8sHCTezm0hmm8.png"/></div></div></figure><h1 id="807d" class="ka kb hi bd kc kd lm kf kg kh ln kj kk kl lo kn ko kp lp kr ks kt lq kv kw kx bi translated">如何设置正常运行时间机器人</h1><p id="717e" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">现在我们需要设置Uptime Robot每五分钟ping一次web服务器。这将导致bot持续运行。</p><p id="eac4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在<a class="ae iu" href="https://uptimerobot.com/" rel="noopener ugc nofollow" target="_blank">https://uptimerobot.com/</a>上创建一个免费账户。</p><p id="01c3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">登录到您的帐户后，单击“添加新显示器”。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nc"><img src="../Images/5c49b8a1c005b0b82eda7729816684ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*EvXRc04dzRYoZhY6.png"/></div></div></figure><p id="3ef9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">对于新的监视器，选择“HTTP(s)”作为监视器类型，并随意命名。然后，从repl.it中粘贴您的web服务器的URL。最后，单击“创建监视器”。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nd"><img src="../Images/756e00ff1b56c7ef6ea69b590807a01d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*xBMck-0pV1xoP42r.png"/></div></div></figure><p id="17a1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们完了！现在，机器人将持续运行，因此人们可以随时在Repl.it上与它进行交互。</p></div><div class="ab cl jt ju gp jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="hb hc hd he hf"><h1 id="74a7" class="ka kb hi bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">结论</h1><p id="6811" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">您现在知道如何用JavaScript创建一个Discord bot，并在云中持续运行它。</p><p id="45d2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">discord.js库还可以做很多其他的事情。因此，如果你想给Discord机器人更多的功能，你的下一步就是查看discord.js的文档</p></div><div class="ab cl jt ju gp jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="hb hc hd he hf"><p id="c826" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">你也可以阅读我的朋友<a class="ne nf ge" href="https://medium.com/u/e1ddaee057c5?source=post_page-----25ea5314fd77--------------------------------" rel="noopener" target="_blank">jrpotodev</a>写的大约5个你今天可以开始编码的项目。</p><div class="ng nh ez fb ni nj"><a href="https://levelup.gitconnected.com/5-more-projects-you-can-start-coding-today-c232a232b2f6" rel="noopener  ugc nofollow" target="_blank"><div class="nk ab dw"><div class="nl ab nm cl cj nn"><h2 class="bd hj fi z dy no ea eb np ed ef hh bi translated">今天你可以开始编码的另外5个项目</h2><div class="nq l"><h3 class="bd b fi z dy no ea eb np ed ef dx translated">有时候最好的学习方法是实践，所以这里有5个项目想法可以帮助你开始。</h3></div><div class="nr l"><p class="bd b fp z dy no ea eb np ed ef dx translated">levelup.gitconnected.com</p></div></div><div class="ns l"><div class="nt l nu nv nw ns nx io nj"/></div></div></a></div></div><div class="ab cl jt ju gp jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="hb hc hd he hf"><p id="0acd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果您不是会员，请考虑通过以下链接注册帮助支持作者:</p><div class="ng nh ez fb ni nj"><a href="https://crunchyknuckles.medium.com/membership" rel="noopener follow" target="_blank"><div class="nk ab dw"><div class="nl ab nm cl cj nn"><h2 class="bd hj fi z dy no ea eb np ed ef hh bi translated">用我的推荐链接加入媒体</h2><div class="nq l"><h3 class="bd b fi z dy no ea eb np ed ef dx translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="nr l"><p class="bd b fp z dy no ea eb np ed ef dx translated">crunchyknuckles.medium.com</p></div></div><div class="ns l"><div class="ny l nu nv nw ns nx io nj"/></div></div></a></div></div><div class="ab cl jt ju gp jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="hb hc hd he hf"><p id="f4e2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我写的其他一些关于编程的文章:</p><div class="ng nh ez fb ni nj"><a href="https://enlear.academy/top-5-games-to-develop-as-a-beginner-ce81802826d3" rel="noopener  ugc nofollow" target="_blank"><div class="nk ab dw"><div class="nl ab nm cl cj nn"><h2 class="bd hj fi z dy no ea eb np ed ef hh bi translated">作为初学者开发的前5个游戏</h2><div class="nq l"><h3 class="bd b fi z dy no ea eb np ed ef dx translated">新手游戏开发者必须尝试的5款游戏</h3></div><div class="nr l"><p class="bd b fp z dy no ea eb np ed ef dx translated">enlear .学院</p></div></div><div class="ns l"><div class="nz l nu nv nw ns nx io nj"/></div></div></a></div><div class="ng nh ez fb ni nj"><a href="https://javascript.plainenglish.io/10-awesome-javascript-libraries-you-should-try-out-in-2021-34ee431cd341" rel="noopener  ugc nofollow" target="_blank"><div class="nk ab dw"><div class="nl ab nm cl cj nn"><h2 class="bd hj fi z dy no ea eb np ed ef hh bi translated">2021年你应该尝试的10个超棒的JavaScript库</h2><div class="nq l"><h3 class="bd b fi z dy no ea eb np ed ef dx translated">JavaScript是网络上最流行的语言之一。尽管它最初只是为网页开发的…</h3></div><div class="nr l"><p class="bd b fp z dy no ea eb np ed ef dx translated">javascript.plainenglish.io</p></div></div><div class="ns l"><div class="oa l nu nv nw ns nx io nj"/></div></div></a></div><div class="ng nh ez fb ni nj"><a rel="noopener follow" target="_blank" href="/geekculture/how-to-send-emails-from-a-form-in-react-emailjs-6cdd21bb4190"><div class="nk ab dw"><div class="nl ab nm cl cj nn"><h2 class="bd hj fi z dy no ea eb np ed ef hh bi translated">如何从React (EmailJS)中的表单发送电子邮件</h2><div class="nq l"><h3 class="bd b fi z dy no ea eb np ed ef dx translated">介绍</h3></div><div class="nr l"><p class="bd b fp z dy no ea eb np ed ef dx translated">medium.com</p></div></div><div class="ns l"><div class="ob l nu nv nw ns nx io nj"/></div></div></a></div></div></div>    
</body>
</html>