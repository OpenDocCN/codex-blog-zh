<html>
<head>
<title>Spring Boot &amp; Redis</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Spring Boot-雷迪斯公司</h1>
<blockquote>原文：<a href="https://medium.com/codex/spring-boot-redis-54e7c9ea3cee?source=collection_archive---------2-----------------------#2022-11-23">https://medium.com/codex/spring-boot-redis-54e7c9ea3cee?source=collection_archive---------2-----------------------#2022-11-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div class="er es hg"><img src="../Images/b7c401b22c304da7ad9453670a6b8fd7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1386/format:webp/1*oq_h-SBW5a4XjB053dfpVg.jpeg"/></div></figure><div class=""/><p id="3e8d" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在本文中，我们将讨论Redis以及如何通过Spring Boot应用程序连接到它。</p><h1 id="6caa" class="jk jl hp bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">Redis是什么？</h1><p id="92e4" class="pw-post-body-paragraph im in hp io b ip ki ir is it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj hb bi translated">数百万开发者使用<a class="ae kn" href="https://github.com/redis/redis" rel="noopener ugc nofollow" target="_blank"> Redis </a>作为开源的内存数据存储、数据库、缓存、流媒体引擎和消息代理。Redis经常被称为数据结构T4服务器。换句话说，这意味着Redis提供了基本的命令，TCP套接字可以将这些命令用作服务器-客户端方法来访问和修改数据结构。因此，许多进程可以共享对相同数据结构的访问，并在需要时更改它们。</p><figure class="kp kq kr ks fd hk"><div class="bz dy l di"><div class="kt ku l"/></div></figure><h2 id="4e2a" class="kv jl hp bd jm kw kx ky jq kz la lb ju ix lc ld jy jb le lf kc jf lg lh kg li bi translated">何时使用Redis</h2><p id="9754" class="pw-post-body-paragraph im in hp io b ip ki ir is it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj hb bi translated">Redis有不同的已知用例，您可以在这里找到其中一些用例，并对其进行简单描述:</p><p id="26fe" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hq">实时数据存储</strong></p><figure class="kp kq kr ks fd hk er es paragraph-image"><div class="er es hg"><img src="../Images/76852c1f60933ac1db460a9d509938b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1386/format:webp/1*ZvgfcaEvDfrSNiqwV70f-A.png"/></div></figure><p id="72cc" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">拥有大量需要实时存储和处理的数据正成为企业的日常挑战。一般来说，实时数据库是一种数据存储，创建它是为了实时收集、处理和/或丰富输入的数据点序列，就像数据流一样，通常是在数据创建后立即进行。使用Redis，您可以为要求低延迟和高吞吐量的实时应用程序创建数据基础设施。</p><p id="7b32" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hq">缓存和会话存储</strong></p><figure class="kp kq kr ks fd hk er es paragraph-image"><div class="er es hg"><img src="../Images/d95823a167d89e4cfe4e5a8005eb0007.png" data-original-src="https://miro.medium.com/v2/resize:fit:1386/format:webp/1*NiW6tJhPI5ctUo3OMhxqxQ.png"/></div></figure><p id="6f69" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">依赖高延迟系统的应用程序的另一个常见问题是需要快速缓存和交付数据。由于Redis的速度，它是缓存数据库查询、复杂计算、API请求和会话状态的最佳选择。</p><p id="8a4c" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hq">流媒体和信息服务</strong></p><figure class="kp kq kr ks fd hk er es paragraph-image"><div class="er es hg"><img src="../Images/08927108f055ee9c185af230d0b52c78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1386/format:webp/1*lUMyDpFBCp2V4QtS3kpevg.png"/></div></figure><p id="b132" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在组织中传输数据并使其可用于系统中的不同组件一直是一项挑战。Redis的流数据类型支持消息传递、事件源、通知和高速数据接收。</p><p id="0ae0" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">Redis的用例不仅仅是我们提到的例子，但是在本文中，我们主要关注实时数据存储用例，下面使用Spring Boot的例子将展示如何使用它。</p><h1 id="1282" class="jk jl hp bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">开始吧</h1><p id="eae9" class="pw-post-body-paragraph im in hp io b ip ki ir is it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj hb bi translated">在这个简单的例子中，您将学习如何建立到Redis服务器的连接并执行一些基本任务，比如输入数据和从Redis读取数据。安装Redis非常简单，你可以在这里找到安装指南。</p><h2 id="6883" class="kv jl hp bd jm kw kx ky jq kz la lb ju ix lc ld jy jb le lf kc jf lg lh kg li bi translated">属国</h2><p id="9bb0" class="pw-post-body-paragraph im in hp io b ip ki ir is it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj hb bi translated">Redis相关的库是Spring数据包的一部分，它使得使用数据访问技术、关系和非关系数据库、map-reduce框架和基于云的数据服务变得容易。您有两种方法来处理相关的依赖关系。您可以使用<code class="du lj lk ll lm b">spring-boot-starter-data-redis</code>，它将准备好所有必要的依赖项。</p><pre class="kp kq kr ks fd ln lm lo bn lp lq bi"><span id="dfaf" class="lr jl hp lm b be ls lt l lu lv">&lt;dependency&gt;     <br/>    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;<br/>    &lt;artifactId&gt;spring-boot-starter-data-redis&lt;/artifactId&gt; <br/>&lt;/dependency&gt;</span></pre><p id="5b03" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">另一种方法是使用<code class="du lj lk ll lm b">spring-data-redis</code>，这样您就可以灵活地选择底层的连接器驱动程序实现。</p><pre class="kp kq kr ks fd ln lm lo bn lp lq bi"><span id="6b69" class="lr jl hp lm b be ls lt l lu lv">&lt;dependency&gt;<br/>    &lt;groupId&gt;org.springframework.data&lt;/groupId&gt;<br/>    &lt;artifactId&gt;spring-data-redis&lt;/artifactId&gt;<br/>&lt;/dependency&gt;</span></pre><p id="804e" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在，您可以选择首选的连接器驱动程序作为不同的依赖项，如下所示:目前，Spring Data Redis使用的底层库有两个选项。</p><h2 id="1e4d" class="kv jl hp bd jm kw kx ky jq kz la lb ju ix lc ld jy jb le lf kc jf lg lh kg li bi translated">杰迪斯</h2><p id="25f4" class="pw-post-body-paragraph im in hp io b ip ki ir is it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj hb bi translated"><a class="ae kn" href="https://github.com/redis/jedis" rel="noopener ugc nofollow" target="_blank"> Jedis </a>是Redis的Java客户端，为性能和易用性而设计，也用于<code class="du lj lk ll lm b">spring-boot-starter-data-redis</code>。它帮助您创建一个连接池，并使用它与Redis通信。</p><pre class="kp kq kr ks fd ln lm lo bn lp lq bi"><span id="68d3" class="lr jl hp lm b be ls lt l lu lv">&lt;dependency&gt;     <br/>    &lt;groupId&gt;redis.clients&lt;/groupId&gt;   <br/>    &lt;artifactId&gt;jedis&lt;/artifactId&gt;    <br/>&lt;/dependency&gt;</span></pre><h2 id="05dc" class="kv jl hp bd jm kw kx ky jq kz la lb ju ix lc ld jy jb le lf kc jf lg lh kg li bi translated"><strong class="ak">生菜</strong></h2><p id="3326" class="pw-post-body-paragraph im in hp io b ip ki ir is it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj hb bi translated"><a class="ae kn" href="https://github.com/lettuce-io/lettuce-core" rel="noopener ugc nofollow" target="_blank">莴苣</a>是一个可伸缩的、线程安全的Redis客户端，支持同步、异步和反应式使用。</p><pre class="kp kq kr ks fd ln lm lo bn lp lq bi"><span id="b42c" class="lr jl hp lm b be ls lt l lu lv">&lt;dependency&gt;<br/>    &lt;groupId&gt;io.lettuce&lt;/groupId&gt;<br/>    &lt;artifactId&gt;lettuce-core&lt;/artifactId&gt;<br/>&lt;/dependency&gt;</span></pre><h2 id="f259" class="kv jl hp bd jm kw kx ky jq kz la lb ju ix lc ld jy jb le lf kc jf lg lh kg li bi translated">杰迪斯VS莴苣</h2><p id="4919" class="pw-post-body-paragraph im in hp io b ip ki ir is it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj hb bi translated">目前，并非所有连接器都支持所有Redis特性。当调用底层库不支持的连接API上的方法时，会抛出一个<code class="du lj lk ll lm b">UnsupportedOperationException</code>。以下概述解释了各个Redis连接器支持的功能:</p><figure class="kp kq kr ks fd hk er es paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="er es hg"><img src="../Images/24614d768f8cd8d229f98af1356158fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1386/format:webp/1*WSN7Pp_hb5pQ6YfPcAqPxQ.png"/></div></div></figure><h2 id="140f" class="kv jl hp bd jm kw kx ky jq kz la lb ju ix lc ld jy jb le lf kc jf lg lh kg li bi translated">连接Redis</h2><p id="4da5" class="pw-post-body-paragraph im in hp io b ip ki ir is it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj hb bi translated">默认情况下，使用Spring Boot启动器也会添加Jedis依赖项。使用Redis和Spring时，通过IoC容器连接到Redis存储是最初的任务之一。这需要使用Java连接器来完成，不管您有什么库。</p><p id="1c02" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><code class="du lj lk ll lm b">org.springframework.data.redis.connection</code>包中的<code class="du lj lk ll lm b">RedisConnection</code>和<code class="du lj lk ll lm b">RedisConnectionFactory</code>接口可用于检索Redis的活动连接。</p><p id="b6a1" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><code class="du lj lk ll lm b">RedisConnection</code>，它管理与Redis后端的通信，为Redis通信提供基本的构建块，并自动将底层连接库异常转换为Spring的可靠DAO异常层次。</p><p id="e83a" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">为了创建<code class="du lj lk ll lm b">RedisConnection</code>，你可以使用<code class="du lj lk ll lm b">RedisConnectionFactory</code>。使用<code class="du lj lk ll lm b">RedisConnectionFactory</code>最简单的方法是通过IoC容器配置适当的连接，并将其注入目标类。</p><p id="55a6" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">如果您有一个简单的Redis独立实例在运行，您可以使用<code class="du lj lk ll lm b">RedisStandaloneConfiguration</code>来准备<code class="du lj lk ll lm b">JedisConnectionFactory</code>，只需在构造函数中传递服务器的IP地址或主机名以及端口号。</p><pre class="kp kq kr ks fd ln lm lo bn lp lq bi"><span id="e9ff" class="lr jl hp lm b be ls lt l lu lv">@Configuration<br/>public class RedisConfiguration {<br/><br/>    @Bean<br/>    public JedisConnectionFactory jedisConnectionFactory() {<br/>        RedisStandaloneConfiguration redisConfiguration = new RedisStandaloneConfiguration("192.168.0.80", 6379);<br/>        return new JedisConnectionFactory(redisConfiguration);<br/>    }<br/><br/>}</span></pre><h2 id="7242" class="kv jl hp bd jm kw kx ky jq kz la lb ju ix lc ld jy jb le lf kc jf lg lh kg li bi translated">重模板</h2><p id="fbbe" class="pw-post-body-paragraph im in hp io b ip ki ir is it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj hb bi translated"><code class="du lj lk ll lm b">RedisTemplate</code>及其容器包<code class="du lj lk ll lm b">org.springframework.data.redis.core</code>，被广大用户使用。它是Redis交互的高级抽象，处理序列化和连接管理。</p><pre class="kp kq kr ks fd ln lm lo bn lp lq bi"><span id="4111" class="lr jl hp lm b be ls lt l lu lv">@Configuration<br/>public class RedisConfiguration {<br/><br/>    @Bean<br/>    public JedisConnectionFactory jedisConnectionFactory() {<br/>        RedisStandaloneConfiguration redisConfiguration = new RedisStandaloneConfiguration("192.168.0.80", 6379);<br/>        return new JedisConnectionFactory(redisConfiguration);<br/>    }<br/><br/>    @Bean<br/>    public RedisTemplate&lt;String, Object&gt; redisTemplate() {<br/>        RedisTemplate&lt;String, Object&gt; template = new RedisTemplate&lt;&gt;();<br/>        template.setConnectionFactory(jedisConnectionFactory());<br/>        return template;<br/>    }<br/><br/>}</span></pre><p id="f432" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">设置好JedisConnectionFactory和RedisTemplate之后，就可以开始在Redis中处理数据了。但是，如果您熟悉存储库，甚至有一种使用Redis的简单方法。利用存储库可以无缝地读取和操作Redis散列中的域对象。</p><p id="af8f" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">就像下面的例子，你可以简单地使用Spring Data Redis实现域实体。</p><pre class="kp kq kr ks fd ln lm lo bn lp lq bi"><span id="5012" class="lr jl hp lm b be ls lt l lu lv">@RedisHash("Student")<br/>public class Student implements Serializable {<br/>    private String id;<br/>    private String name;<br/>    private Integer age;<br/>}</span></pre><p id="378a" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在我们有了一个负责存储和检索的组件，我们可以通过扩展<code class="du lj lk ll lm b">CrudRepository</code>接口来创建我们的存储库。</p><pre class="kp kq kr ks fd ln lm lo bn lp lq bi"><span id="8bee" class="lr jl hp lm b be ls lt l lu lv">public interface StudentRepository extends CrudRepository&lt;Student, String&gt; {<br/>}</span></pre><p id="83d6" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><code class="du lj lk ll lm b">CrudRepository</code>将提供基本的CRUD操作，以处理如下示例:</p><ul class=""><li id="9985" class="ma mb hp io b ip iq it iu ix mc jb md jf me jj mf mg mh mi bi translated">保存(学生学生)；</li><li id="8495" class="ma mb hp io b ip mj it mk ix ml jb mm jf mn jj mf mg mh mi bi translated">findById(字符串id)；</li><li id="7dd1" class="ma mb hp io b ip mj it mk ix ml jb mm jf mn jj mf mg mh mi bi translated">count()；</li><li id="31de" class="ma mb hp io b ip mj it mk ix ml jb mm jf mn jj mf mg mh mi bi translated">删除(学生学生)；</li></ul><p id="5eec" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">是时候创建您的服务类、注入存储库并开始使用Redis了，就像下面的示例代码一样:</p><pre class="kp kq kr ks fd ln lm lo bn lp lq bi"><span id="cea8" class="lr jl hp lm b be ls lt l lu lv">@Service<br/>public class StudentService {<br/><br/>    @Autowired<br/>    StudentRepository studentRepository;<br/><br/>    public Student addStudent(Student student){<br/>        return studentRepository.save(student);<br/>    }<br/><br/>    public List&lt;Student&gt; getStudents(){<br/>        List&lt;Student&gt; list = new ArrayList&lt;Student&gt;();<br/>        studentRepository.findAll().forEach( i -&gt; {<br/>            list.add(i);<br/>        });<br/>        return list;<br/>    }<br/><br/>}</span></pre><p id="25a8" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">使用模型对象，您可以简单地插入记录进行散列，并按预期读取它们。</p><p id="bb7c" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">当然，在从Redis中读取和检索数据的过程中涉及到很多细节，但是这个例子可以让您对整个库是如何工作的有一个基本的了解。</p></div><div class="ab cl mo mp gp mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="hb hc hd he hf"><p id="ea42" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">希望这篇文章对你有帮助，请鼓掌支持我👏为了这个故事。如果你不知道它是如何工作的，它就像这样:</p><figure class="kp kq kr ks fd hk er es paragraph-image"><div class="er es mv"><img src="../Images/2a19a406941f6b1291729b823980ae34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*O0NsAaAstdfp2z-m.gif"/></div></figure><p id="4374" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">或者在这里给我买杯<a class="ae kn" href="https://www.buymeacoffee.com/fpashaee" rel="noopener ugc nofollow" target="_blank">咖啡！</a></p></div></div>    
</body>
</html>