<html>
<head>
<title>How to Build an Offline GPS Tracker Using LoRa (for Mac OS)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用LoRa(Mac OS)建立离线GPS跟踪器</h1>
<blockquote>原文：<a href="https://medium.com/codex/how-to-build-an-offline-gps-tracker-using-lora-for-mac-os-21e359c8ebc9?source=collection_archive---------2-----------------------#2020-12-30">https://medium.com/codex/how-to-build-an-offline-gps-tracker-using-lora-for-mac-os-21e359c8ebc9?source=collection_archive---------2-----------------------#2020-12-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/72505279572d41c478b74fe0d7c4549d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*r9dsU8_gvtmrpOL8"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">由<a class="ae hv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae hv" href="https://unsplash.com/@mael_balland?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Mael BALLAND </a>拍摄的照片</figcaption></figure><div class=""/><p id="c5ba" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这篇文章中，我将详细描述使用LoRa建立你自己的离线GPS追踪器的所有必要步骤，而不需要互联网接入。您将能够在本地谷歌地图文件上显示模块的实时位置，并在本地文本文件中存储GPS数据(纬度、经度、高度、速度和一些其他指标)，以供参考和随后的路线绘制(例如通过<a class="ae hv" href="https://www.google.com/earth/outreach/learn/importing-global-positioning-systems-gps-data-in-google-earth/" rel="noopener ugc nofollow" target="_blank">谷歌地球</a>！).</p><p id="30ac" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hz">目录</strong></p><ol class=""><li id="4188" class="jt ju hy ix b iy iz jc jd jg jv jk jw jo jx js jy jz ka kb bi translated">项目背景</li><li id="7f77" class="jt ju hy ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated">硬件要求</li><li id="fee8" class="jt ju hy ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated">软件要求</li><li id="4631" class="jt ju hy ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated">未来的改进和参考</li></ol></div><div class="ab cl kh ki gp kj" role="separator"><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km"/></div><div class="hb hc hd he hf"><h1 id="6a2c" class="ko kp hy bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated"><strong class="ak">背景</strong></h1><p id="68d6" class="pw-post-body-paragraph iv iw hy ix b iy lm ja jb jc ln je jf jg lo ji jj jk lp jm jn jo lq jq jr js hb bi translated">几年前，我买了一个学徒的S 15e模型飞机(见下文),我在纽约长岛南部飞行。我喜欢做翻滚和空翻，但我喜欢升级它。在增加了更大的轮子之后，我决定用一个安装在机翼顶部的廉价相机和一个旧的模拟监视器把水上飞机变成一个FPV平台。我会让它飞得足够高，从一个方向看佩科尼克湾，然后转过身，从另一个方向看大西洋。有一天，我太专注于风景，我的眼睛离开飞机很长时间，以至于看不到它。我转向我的FPV监视器，但它逐渐充满了越来越多的静电干扰，直到我完全失去了信号。在花了几天的时间开车绕着田野跑了几英里后，我再也没有找到它。</p><figure class="ls lt lu lv fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lr"><img src="../Images/cb864c6618832af610540010a8f82462.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*3wg-e0Kmcq8aTbyq.jpg"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated"><em class="lw">学徒S 15e。资料来源:flite test</em><a class="ae hv" href="https://www.flitetest.com/articles/e-flite-apprentice-s-15e" rel="noopener ugc nofollow" target="_blank">https://www.flitetest.com/articles/e-flite-apprentice-s-15e</a></figcaption></figure><p id="8d21" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">经过一番自我反省，我决定再买一架飞机——学徒STS T1，它是最初的学徒S 15e的更新版本。我经常驾驶它在同一个场地飞行，但只是用视线。我想回到FPV，但是在没有安全保障的情况下，我觉得这样做还不够舒服。我有一个想法，要制造一个GPS追踪器，在飞行期间放在飞机上，但很快就遇到了问题——即如何远程实时传输GPS数据。蓝牙和WiFi都不能满足它，但经过一些初步的研究，我遇到了<a class="ae hv" href="https://lora-alliance.org/" rel="noopener ugc nofollow" target="_blank"> LoRa </a>，它方便地代表“远程”。本质上，它是一种用于远距离传输少量数据的机制。它经常被用在农场上，用来监测超过1000公里的农业数据.你不能用它来播放电影，但是它可以很好地发送字节的数字数据。从而催生了这个项目！</p><p id="7085" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">无论你是想为航模还是其他应用建立你的GPS跟踪系统，我希望这个指南能帮助你实现你的目标！</p></div><div class="ab cl kh ki gp kj" role="separator"><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km"/></div><div class="hb hc hd he hf"><h1 id="cb6e" class="ko kp hy bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated"><strong class="ak">硬件</strong></h1><h2 id="3466" class="lx kp hy bd kq ly lz ma ku mb mc md ky jg me mf lc jk mg mh lg jo mi mj lk mk bi translated"><strong class="ak">架构概述</strong></h2><p id="9c0d" class="pw-post-body-paragraph iv iw hy ix b iy lm ja jb jc ln je jf jg lo ji jj jk lp jm jn jo lq jq jr js hb bi translated">如下图所示，该GPS追踪器可使用以下硬件元件和连接器构建，按以下顺序连接(左侧为Tx，右侧为Rx):</p><figure class="ls lt lu lv fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ml"><img src="../Images/48c43317e4d3994b8c9e49b97d8f5cb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CG7fuKhibf0v-ofeA8Eqyw.png"/></div></div></figure><h2 id="7314" class="lx kp hy bd kq ly lz ma ku mb mc md ky jg me mf lc jk mg mh lg jo mi mj lk mk bi translated"><strong class="ak">材料清单</strong></h2><ol class=""><li id="6b04" class="jt ju hy ix b iy lm jc ln jg mm jk mn jo mo js jy jz ka kb bi translated"><a class="ae hv" href="https://www.amazon.com/gp/product/B07HJ49VN8/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=B07HJ49VN8&amp;linkCode=as2&amp;tag=techblogs0e-20&amp;linkId=8990e79cd61f5d44202b424993bbeb1d" rel="noopener ugc nofollow" target="_blank"> LoRa ESP32模块(2件装)</a></li><li id="63de" class="jt ju hy ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated">便携式手机充电器，比如这个<a class="ae hv" href="https://www.amazon.com/gp/product/B00KG45W08/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=B00KG45W08&amp;linkCode=as2&amp;tag=techblogs0e-20&amp;linkId=a5260a77dba2c5e1c7d09f6261d6b576" rel="noopener ugc nofollow" target="_blank"/>(不需要昂贵的电池，因为即使是便宜的电池也会比飞机电池耐用得多)</li><li id="d7c0" class="jt ju hy ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated">USB转Micro USB线，像<a class="ae hv" href="https://www.amazon.com/gp/product/B003YKX6WM/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=B003YKX6WM&amp;linkCode=as2&amp;tag=techblogs0e-20&amp;linkId=7e1b2dbc6c6402f9b1a63a8845332295" rel="noopener ugc nofollow" target="_blank">这个</a>(一定要选支持数据传输的，不只是充电！)</li><li id="f761" class="jt ju hy ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated"><a class="ae hv" href="https://www.amazon.com/gp/product/B07P8YMVNT/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=B07P8YMVNT&amp;linkCode=as2&amp;tag=techblogs0e-20&amp;linkId=1696dbbbd3086cfc4d6cd425b471d48c" rel="noopener ugc nofollow" target="_blank"> GPS模块</a></li><li id="b62e" class="jt ju hy ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated">【Arduino或Raspberry Pi的试验板跳线(你不需要所有120根线。我发现这些品种很有用，而且它们很便宜！)</li></ol><h2 id="c9bb" class="lx kp hy bd kq ly lz ma ku mb mc md ky jg me mf lc jk mg mh lg jo mi mj lk mk bi translated"><strong class="ak">模块连接</strong></h2><p id="c5f8" class="pw-post-body-paragraph iv iw hy ix b iy lm ja jb jc ln je jf jg lo ji jj jk lp jm jn jo lq jq jr js hb bi translated">如上图所示，这些硬件元件通过三种方法之一连接:LoRa、USB或GPIO。当然，LoRa收发器通过LoRa无线信号连接。其余部分按如下方式连接:</p><ul class=""><li id="0d98" class="jt ju hy ix b iy iz jc jd jg jv jk jw jo jx js mp jz ka kb bi translated">便携式充电器→ (USB转微型USB) → LoRa发射器</li><li id="b2f3" class="jt ju hy ix b iy kc jc kd jg ke jk kf jo kg js mp jz ka kb bi translated">GPS模块→ (GPIO) → LoRa发射器</li><li id="6fd1" class="jt ju hy ix b iy kc jc kd jg ke jk kf jo kg js mp jz ka kb bi translated">LoRa接收器→(微型USB转USB) →计算机</li></ul><p id="0bcc" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">对于GPIO连接，确保将GPS模块连接到相应的LoRa发射器:</p><figure class="ls lt lu lv fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mq"><img src="../Images/5ecd67a58edcbce0aa82af6a4ba0e2af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XQJxVRetZdQMukh3y9gmPw.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">GPS和LoRa发射器模块之间的GPIO连接</figcaption></figure><ul class=""><li id="a325" class="jt ju hy ix b iy iz jc jd jg jv jk jw jo jx js mp jz ka kb bi translated">GND是接地引脚，需要连接到LoRa发射器模块上的GND引脚。</li><li id="d95c" class="jt ju hy ix b iy kc jc kd jg ke jk kf jo kg js mp jz ka kb bi translated">VCC为模块供电。您可以直接将其连接到LoRa发射器上的5V引脚。</li><li id="3e66" class="jt ju hy ix b iy kc jc kd jg ke jk kf jo kg js mp jz ka kb bi translated">TxD(发射器)引脚用于串行通信，应连接到LoRa发射器上的Rx GPIO端口。我用的是16号针。</li><li id="0677" class="jt ju hy ix b iy kc jc kd jg ke jk kf jo kg js mp jz ka kb bi translated">RxD(接收器)引脚用于串行通信，应连接到LoRa发射器上的Tx GPIO端口。我用了17号针。</li></ul><p id="2ca0" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">此时，您应该已经正确设置了所有的硬件，并准备好编码了！</p><p id="105b" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="mr">注意:在设置和测试期间，LoRa发射器可以由120V交流电源适配器供电，以延长电池寿命。两个LoRa收发器都可以通过使用USB转Micro USB电缆进行编程，就像</em> <a class="ae hv" href="https://www.amazon.com/gp/product/B003YKX6WM/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=B003YKX6WM&amp;linkCode=as2&amp;tag=techblogs0e-20&amp;linkId=7e1b2dbc6c6402f9b1a63a8845332295" rel="noopener ugc nofollow" target="_blank"> <em class="mr">这个</em> </a> <em class="mr">。</em></p><p id="694c" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="mr">免责声明:以上是亚马逊联盟链接，将有助于支持我的项目，无需额外费用。</em></p></div><div class="ab cl kh ki gp kj" role="separator"><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km"/></div><div class="hb hc hd he hf"><h1 id="f283" class="ko kp hy bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated"><strong class="ak">软件</strong></h1><p id="218f" class="pw-post-body-paragraph iv iw hy ix b iy lm ja jb jc ln je jf jg lo ji jj jk lp jm jn jo lq jq jr js hb bi translated">完成这个项目需要三个不同的软件文件:LoRa发射器Arduino代码、LoRa接收器Arduino代码和一个用于操作GPS数据的Python脚本。所有这些文件都可以从我的<a class="ae hv" href="https://github.com/DanielWestrich/GPS" rel="noopener ugc nofollow" target="_blank"> GitHub库</a>下载。此外，你还需要一个文本编辑器来运行Python脚本(我在终端中使用了<a class="ae hv" href="https://www.sublimetext.com/" rel="noopener ugc nofollow" target="_blank"> Sublime Text </a>，以及用于LoRa模块的<a class="ae hv" href="https://www.arduino.cc/en/guide/macOSX" rel="noopener ugc nofollow" target="_blank"> Arduino IDE </a>。</p><p id="56e8" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">下面的链接对我起草自己的代码很有帮助:</p><ul class=""><li id="339c" class="jt ju hy ix b iy iz jc jd jg jv jk jw jo jx js mp jz ka kb bi translated"><a class="ae hv" href="https://www.aeq-web.com/heltec-esp32-lora-arduino-ide-setup-and-test/" rel="noopener ugc nofollow" target="_blank"> Arduino发射器和接收器代码</a></li><li id="dcc1" class="jt ju hy ix b iy kc jc kd jg ke jk kf jo kg js mp jz ka kb bi translated"><a class="ae hv" href="https://github.com/Chams123456/Arduino_to_python/blob/master/DHT11_Arduino_to_Python.py" rel="noopener ugc nofollow" target="_blank"> Arduino串行监视器到Python转换器</a></li><li id="8054" class="jt ju hy ix b iy kc jc kd jg ke jk kf jo kg js mp jz ka kb bi translated"><a class="ae hv" href="https://www.geeksforgeeks.org/python-plotting-google-map-using-gmplot-package/" rel="noopener ugc nofollow" target="_blank"> Python谷歌地图绘图仪</a></li></ul><h2 id="ea5c" class="lx kp hy bd kq ly lz ma ku mb mc md ky jg me mf lc jk mg mh lg jo mi mj lk mk bi translated"><strong class="ak">提示和技巧</strong></h2><p id="77a3" class="pw-post-body-paragraph iv iw hy ix b iy lm ja jb jc ln je jf jg lo ji jj jk lp jm jn jo lq jq jr js hb bi translated">要运行Arduino代码，您需要执行以下操作:</p><ul class=""><li id="0998" class="jt ju hy ix b iy iz jc jd jg jv jk jw jo jx js mp jz ka kb bi translated">将“esp32”板添加到可用Arduino板和相关库的列表中，以写入该板。此处的说明<a class="ae hv" href="https://heltec-automation-docs.readthedocs.io/en/latest/esp32+arduino/quick_start.html" rel="noopener ugc nofollow" target="_blank">为</a>。</li><li id="15dd" class="jt ju hy ix b iy kc jc kd jg ke jk kf jo kg js mp jz ka kb bi translated">将以下Arduino库添加到IDE中:“LoRa”、“U8g2”、“EspSoftwareSerial”、“Heltec ESP32”、“TinyGPS”、“SPI”。此处的说明<a class="ae hv" href="https://www.aeq-web.com/heltec-esp32-lora-arduino-ide-setup-and-test/" rel="noopener ugc nofollow" target="_blank">为</a>。</li><li id="97d3" class="jt ju hy ix b iy kc jc kd jg ke jk kf jo kg js mp jz ka kb bi translated">确保在Arduino IDE设置和串行监视器窗口中将波特率设置为9600。</li><li id="a029" class="jt ju hy ix b iy kc jc kd jg ke jk kf jo kg js mp jz ka kb bi translated">在Arduino IDE中选择“WiFi Kit 32”作为主板，而不是LoRa命名的主板。</li><li id="5a18" class="jt ju hy ix b iy kc jc kd jg ke jk kf jo kg js mp jz ka kb bi translated">将端口设置为“/dev/cu。Arduino IDE中的SLAB_USBtoUART。</li></ul><p id="21a4" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">要运行Python代码，您需要包含以下导入语句:</p><ul class=""><li id="7804" class="jt ju hy ix b iy iz jc jd jg jv jk jw jo jx js mp jz ka kb bi translated">导入csv</li><li id="1cb4" class="jt ju hy ix b iy kc jc kd jg ke jk kf jo kg js mp jz ka kb bi translated">导入时间</li><li id="5a49" class="jt ju hy ix b iy kc jc kd jg ke jk kf jo kg js mp jz ka kb bi translated">导入数学</li><li id="1066" class="jt ju hy ix b iy kc jc kd jg ke jk kf jo kg js mp jz ka kb bi translated">导入编解码器</li><li id="2e2a" class="jt ju hy ix b iy kc jc kd jg ke jk kf jo kg js mp jz ka kb bi translated">导入序列</li><li id="b69b" class="jt ju hy ix b iy kc jc kd jg ke jk kf jo kg js mp jz ka kb bi translated">导入gmplot</li><li id="6dd4" class="jt ju hy ix b iy kc jc kd jg ke jk kf jo kg js mp jz ka kb bi translated">导入webbrowser</li><li id="133d" class="jt ju hy ix b iy kc jc kd jg ke jk kf jo kg js mp jz ka kb bi translated">从日期时间导入日期时间</li><li id="52f0" class="jt ju hy ix b iy kc jc kd jg ke jk kf jo kg js mp jz ka kb bi translated">从bs4导入BeautifulSoup</li><li id="8573" class="jt ju hy ix b iy kc jc kd jg ke jk kf jo kg js mp jz ka kb bi translated">从selenium导入web驱动程序</li><li id="dbaa" class="jt ju hy ix b iy kc jc kd jg ke jk kf jo kg js mp jz ka kb bi translated">从webdriver_manager.chrome导入ChromeDriverManager</li></ul><p id="3d38" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">一旦你下载了上面的包并相应地设置了环境变量，你应该能够通过USB发送Arduino脚本(TX和RX)到LoRa模块。一旦打开电源，LoRa模块将自动运行这些Arduino脚本。因此，只需将TX模块插入电池(如上图所示)，将RX模块插入电脑，然后通过终端运行Python脚本。该脚本将自动打开并定期刷新一个谷歌浏览器窗口，所以一旦运行就不需要与它互动！</p><p id="b48b" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">就是这样！我真的希望你喜欢这个项目的建设，并希望它能为你省去一些麻烦。如果你遇到任何问题或者对我的设计有任何改进，请在评论区告诉我。接下来，我需要在我的飞机上安装GPS追踪器，敬请关注！</p><p id="a62e" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="mr">附:如果你想通过物联网将你的GPS模块连接到互联网，作为一个物联网设备，我推荐你使用</em> <a class="ae hv" href="https://yves-debeer.medium.com/build-your-own-lora-gps-tracker-59d1870097d0" rel="noopener"> <em class="mr">伊夫的文章</em> </a> <em class="mr">。</em></p></div></div>    
</body>
</html>