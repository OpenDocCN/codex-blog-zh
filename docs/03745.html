<html>
<head>
<title>What is Association Rule Learning? An Applied Example in Python: Basket Analysis and Product Offering</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">什么是关联规则学习？Python中的一个应用实例:购物篮分析和产品提供</h1>
<blockquote>原文：<a href="https://medium.com/codex/what-is-association-rule-learning-abd4a76144d8?source=collection_archive---------1-----------------------#2021-09-21">https://medium.com/codex/what-is-association-rule-learning-abd4a76144d8?source=collection_archive---------1-----------------------#2021-09-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="94bc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这个故事中，我们将尝试涵盖什么是关联规则学习，我将用Python演示一个应用示例。还有，我会在Kaggle里分享代码。您可以通过以下链接访问Kaggle笔记本:</p><div class="jd je ez fb jf jg"><a href="https://www.kaggle.com/enesbaysan/association-rule-learning-in-python" rel="noopener  ugc nofollow" target="_blank"><div class="jh ab dw"><div class="ji ab jj cl cj jk"><h2 class="bd hj fi z dy jl ea eb jm ed ef hh bi translated">Python中的关联规则学习</h2><div class="jn l"><h3 class="bd b fi z dy jl ea eb jm ed ef dx translated">使用Kaggle笔记本探索和运行机器学习代码|使用来自UCI在线零售II数据集的数据</h3></div><div class="jo l"><p class="bd b fp z dy jl ea eb jm ed ef dx translated">www.kaggle.com</p></div></div><div class="jp l"><div class="jq l jr js jt jp ju jv jg"/></div></div></a></div><h1 id="31f4" class="jw jx hi bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">什么是关联规则学习？</h1><p id="9bc8" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated">关联规则学习是一种基于规则的机器学习技术，用于发现模式(关系、结构等)。)在数据集中。通过学习这些模式，我们将能够向顾客提供一些商品。对于产品，我们将使用Apriori算法。</p><figure class="la lb lc ld fd le er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es kz"><img src="../Images/1f098ff506356623635efbb2eceb5cd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sIZGOcMe3UNWMJWNWqp4rA.jpeg"/></div></div><figcaption class="lk ll et er es lm ln bd b be z dx translated">由<a class="ae lo" href="https://unsplash.com/@cardmapr?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> CardMapr </a>在<a class="ae lo" href="https://unsplash.com/s/photos/shopping-cart-analysis?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h2 id="6a33" class="lp jx hi bd jy lq lr ls kc lt lu lv kg iq lw lx kk iu ly lz ko iy ma mb ks mc bi translated">什么是Apriori算法</h2><p id="f972" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated">在这种学习技术中，我们使用Apriori算法来提取与目标项目的关联。有时我们可以将这种技术视为购物车分析。</p><p id="3f4a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">它有以下3个指标:</p><ul class=""><li id="8d1f" class="md me hi ih b ii ij im in iq mf iu mg iy mh jc mi mj mk ml bi translated">Support(X，Y) = Freq(X，Y) / N</li><li id="36d0" class="md me hi ih b ii mm im mn iq mo iu mp iy mq jc mi mj mk ml bi translated">置信度(X，Y) =频率(X，Y) /频率(X)</li><li id="253f" class="md me hi ih b ii mm im mn iq mo iu mp iy mq jc mi mj mk ml bi translated">升力=支撑(X，Y) /(支撑(X) *支撑(Y))</li></ul><p id="ec18" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">支持度是指同时观察X和Y的概率</p><p id="bdad" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">信心是指当X卖出时观察到Y的概率</p><p id="95da" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">升力是指当X被买入时，买入Y的概率增加升力倍。</p><blockquote class="mr ms mt"><p id="444f" class="if ig mu ih b ii ij ik il im in io ip mv ir is it mw iv iw ix mx iz ja jb jc hb bi translated">在大型项目中，识别“什么是购物车”可能是一个挑战。</p></blockquote><h2 id="abf3" class="lp jx hi bd jy lq lr ls kc lt lu lv kg iq lw lx kk iu ly lz ko iy ma mb ks mc bi translated">Apriori算法的一个例子</h2><figure class="la lb lc ld fd le er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es my"><img src="../Images/0496a571112b7eeabca12bdc4547d2b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rHcAgMz7BOIkajX7OH733Q.png"/></div></div><figcaption class="lk ll et er es lm ln bd b be z dx translated">作者图片</figcaption></figure><p id="75a5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以看到上面Apriori算法的一个简单例子。</p><p id="d737" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这个例子中，对于apriori算法，我们假设面包是X，牛奶是Y。</p><ul class=""><li id="382a" class="md me hi ih b ii ij im in iq mf iu mg iy mh jc mi mj mk ml bi translated">Support(Bread)将给出包含Bread的事务计数与总事务计数的比率。</li><li id="1d81" class="md me hi ih b ii mm im mn iq mo iu mp iy mq jc mi mj mk ml bi translated">Support(Milk)将给出包含Milk的事务计数与总事务计数的比率。</li><li id="cb7d" class="md me hi ih b ii mm im mn iq mo iu mp iy mq jc mi mj mk ml bi translated">Support(Bread，Milk)将给出包含面包和牛奶的事务计数与总事务计数的比率。</li><li id="e0aa" class="md me hi ih b ii mm im mn iq mo iu mp iy mq jc mi mj mk ml bi translated">置信度(面包，牛奶)将给出包含面包和牛奶的事务计数与包含面包的事务计数的比率。</li><li id="161c" class="md me hi ih b ii mm im mn iq mo iu mp iy mq jc mi mj mk ml bi translated">Lift(Bread，Milk)将得出包含面包和牛奶的事务数与包含面包的事务数之比乘以包含牛奶的事务数。</li><li id="beca" class="md me hi ih b ii mm im mn iq mo iu mp iy mq jc mi mj mk ml bi translated">我们可以说，如果买了面包，按照上述过程，我们出售牛奶的概率增加了1倍以上。</li></ul><h1 id="2ce9" class="jw jx hi bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">Python中的一个应用实例</h1><p id="f936" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated">在我们的例子中，我们将使用<a class="ae lo" href="https://www.kaggle.com/nathaniel/uci-online-retail-ii-data-set" rel="noopener ugc nofollow" target="_blank">这个</a>数据集。还有，你可以从<a class="ae lo" href="https://archive.ics.uci.edu/ml/datasets/Online+Retail+II" rel="noopener ugc nofollow" target="_blank">这里</a>得到。如前所述，我会解释这个故事中代码的含义。你可以在<a class="ae lo" href="https://www.kaggle.com/enesbaysan/association-rule-learning-in-python" rel="noopener ugc nofollow" target="_blank"> Kaggle笔记本</a>中找到没有解释的公正代码。</p><p id="6d8c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可以在以下几行中找到数据集的列含义:</p><ul class=""><li id="150d" class="md me hi ih b ii ij im in iq mf iu mg iy mh jc mi mj mk ml bi translated">发票:发票编号。如果这个号码以“C”开头，就意味着这个交易取消了。</li><li id="e4ac" class="md me hi ih b ii mm im mn iq mo iu mp iy mq jc mi mj mk ml bi translated">库存代码:产品代码</li><li id="e58d" class="md me hi ih b ii mm im mn iq mo iu mp iy mq jc mi mj mk ml bi translated">描述:产品名称</li><li id="b84d" class="md me hi ih b ii mm im mn iq mo iu mp iy mq jc mi mj mk ml bi translated">数量:产品数量</li><li id="4eae" class="md me hi ih b ii mm im mn iq mo iu mp iy mq jc mi mj mk ml bi translated">发票日期:交易日期</li><li id="59d5" class="md me hi ih b ii mm im mn iq mo iu mp iy mq jc mi mj mk ml bi translated">价格:单个产品价格</li><li id="ab09" class="md me hi ih b ii mm im mn iq mo iu mp iy mq jc mi mj mk ml bi translated">CustomerID:唯一的客户号</li><li id="b721" class="md me hi ih b ii mm im mn iq mo iu mp iy mq jc mi mj mk ml bi translated">国家:客户的国家名称</li></ul><h2 id="6e86" class="lp jx hi bd jy lq lr ls kc lt lu lv kg iq lw lx kk iu ly lz ko iy ma mb ks mc bi translated">安装库</h2><p id="dba5" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated">我将使用<code class="du mz na nb nc b">openpyxl</code>读取excel文件，使用<code class="du mz na nb nc b">mlxtend</code>使用apriori算法并提取规则。</p><pre class="la lb lc ld fd nd nc ne nf aw ng bi"><span id="8646" class="lp jx hi nc b fi nh ni l nj nk">!pip install openpyxl</span><span id="fde2" class="lp jx hi nc b fi nl ni l nj nk">!pip install mlxtend</span></pre><h2 id="e3b7" class="lp jx hi bd jy lq lr ls kc lt lu lv kg iq lw lx kk iu ly lz ko iy ma mb ks mc bi translated">获取数据集</h2><p id="4599" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated">我将导入从excel文件中读取数据所需的库。</p><pre class="la lb lc ld fd nd nc ne nf aw ng bi"><span id="5970" class="lp jx hi nc b fi nh ni l nj nk">import pandas as pd<br/>from mlxtend.frequent_patterns import apriori, association_rules</span><span id="2fce" class="lp jx hi nc b fi nl ni l nj nk">raw_data = pd.read_excel('../online_retail_II.xlsx',sheet_name='Year 2010-2011')</span></pre><h2 id="66c1" class="lp jx hi bd jy lq lr ls kc lt lu lv kg iq lw lx kk iu ly lz ko iy ma mb ks mc bi translated">准备数据集</h2><p id="6c37" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated">我来准备数据集。我将筛选出发票列中包含“C”的条目等。这个过程我之前做过很多次。你可以从我之前的故事中看出这其中的意义。我为这个过程写了下面这个函数。我准备了数据帧，并将其赋给一个新变量<code class="du mz na nb nc b">df</code>。</p><pre class="la lb lc ld fd nd nc ne nf aw ng bi"><span id="0541" class="lp jx hi nc b fi nh ni l nj nk">def prepare_retail(dataframe):<br/>    <em class="mu"># preparing dataset</em><br/>    dataframe.dropna(inplace=True)<br/>    dataframe = dataframe[~dataframe["Invoice"].str.contains("C", na=False)]<br/>    dataframe = dataframe[dataframe["Quantity"] &gt; 0]<br/>    dataframe = dataframe[dataframe["Price"] &gt; 0]<br/>    return dataframe</span><span id="3954" class="lp jx hi nc b fi nl ni l nj nk">df = prepare_retail(raw_data)</span></pre><h2 id="d712" class="lp jx hi bd jy lq lr ls kc lt lu lv kg iq lw lx kk iu ly lz ko iy ma mb ks mc bi translated">创建先验数据结构</h2><p id="d79c" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated">我需要下面的结构(数据透视表)来使用apriori算法。</p><figure class="la lb lc ld fd le er es paragraph-image"><div class="er es nm"><img src="../Images/e02ab712fb981ee6b2fdfdc259f784ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:876/format:webp/1*FGi0IrQ7iZUK10kxtPkoXQ.png"/></div></figure><p id="d5c2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">行代表交易(发票、购物车等。)和列代表产品。我们代表哪个交易(发票，购物车等。)包含哪些产品为二进制。如果产品在发票中，交集单元格将为“1”。如果不是，则为“0”。</p><p id="370d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为此，我将创建一个带有<code class="du mz na nb nc b">id</code>参数的函数。如果id参数为True，它将使用StockCode列创建数据透视表。如果为False，它将使用产品名称创建数据透视表。</p><pre class="la lb lc ld fd nd nc ne nf aw ng bi"><span id="f204" class="lp jx hi nc b fi nh ni l nj nk">def create_apriori_datastructure(dataframe, id=False):<br/>    if id:<br/>        grouped = germany_df.groupby(<br/>            ['Invoice', 'StockCode'], as_index=False).agg({'Quantity': 'sum'})<br/>        apriori_datastructure = pd.pivot(data=grouped, index='Invoice', columns='StockCode', values='Quantity').fillna(<br/>            0).applymap(lambda x: 1 if x &gt; 0 else 0)<br/>        return apriori_datastructure<br/>    else:<br/>        grouped = germany_df.groupby(<br/>            ['Invoice', 'Description'], as_index=False).agg({'Quantity': 'sum'})<br/>        apriori_datastructure = pd.pivot(data=grouped, index='Invoice', columns='Description', values='Quantity').fillna(<br/>            0).applymap(lambda x: 1 if x &gt; 0 else 0)<br/>        return apriori_datastructure</span></pre><p id="b24a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用这个函数后，我会得到如下的结果数据帧。</p><figure class="la lb lc ld fd le er es paragraph-image"><div class="er es nn"><img src="../Images/b720a8034815e8b7530258951fc71f77.png" data-original-src="https://miro.medium.com/v2/resize:fit:950/format:webp/1*r_ya5HXF45p_Vep9Pvm_aw.png"/></div></figure><h2 id="f9dd" class="lp jx hi bd jy lq lr ls kc lt lu lv kg iq lw lx kk iu ly lz ko iy ma mb ks mc bi translated">选择基于德国的发票</h2><p id="6cc5" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated">在这个例子中，我想基于德国的数据工作。这样，我可以节省时间并获得更好的性能。</p><pre class="la lb lc ld fd nd nc ne nf aw ng bi"><span id="2a61" class="lp jx hi nc b fi nh ni l nj nk">germany_df = df[df['Country'] == 'Germany'] <br/><br/>germany_df.head()</span></pre><figure class="la lb lc ld fd le er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es my"><img src="../Images/61cab194cb2e7dc3e7f45ce617e7d053.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oEiTY6z58Ct_D3Axp9fgPQ.png"/></div></div></figure><h2 id="cdd2" class="lp jx hi bd jy lq lr ls kc lt lu lv kg iq lw lx kk iu ly lz ko iy ma mb ks mc bi translated">获取先验数据结构</h2><p id="cef4" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated">我将使用上面创建的函数来获得apriori算法数据结构。</p><pre class="la lb lc ld fd nd nc ne nf aw ng bi"><span id="21cf" class="lp jx hi nc b fi nh ni l nj nk">germany_apriori_df = create_apriori_datastructure(germany_df,True)</span><span id="7f66" class="lp jx hi nc b fi nl ni l nj nk">germany_apriori_df.head() <em class="mu"># Invoice-Product matrix (apriori data structure)</em></span></pre><figure class="la lb lc ld fd le er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es no"><img src="../Images/59dfec55e6ef76142fa95501f1bf6c32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZiliS9m4briKaiDGQWoUng.png"/></div></div></figure><h2 id="48a2" class="lp jx hi bd jy lq lr ls kc lt lu lv kg iq lw lx kk iu ly lz ko iy ma mb ks mc bi translated">学习规则(关联规则学习)</h2><p id="0a3b" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated">我将创建一个用于提取关联规则的函数。实际上，我们不需要为每个进程创建函数，但是我想如果我为每个进程创建函数，它们会更清晰。</p><p id="128b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个函数有两个参数。<code class="du mz na nb nc b">apriori_df</code>是数据帧，即先验数据结构。我们说通过使用<code class="du mz na nb nc b">min_support</code>,可以以最小0.01的概率一起销售的产品应该出现。每种产品一起出售的概率。我们将通过使用<code class="du mz na nb nc b">apriori</code>函数来应用apriori算法。然后我们将使用<code class="du mz na nb nc b">association_rules</code>函数提取关联规则。</p><pre class="la lb lc ld fd nd nc ne nf aw ng bi"><span id="c107" class="lp jx hi nc b fi nh ni l nj nk">def get_rules(apriori_df, min_support=0.01):<br/>    frequent_itemsets = apriori(apriori_df, min_support=min_support, use_colnames=True)</span><span id="6c49" class="lp jx hi nc b fi nl ni l nj nk">    rules = association_rules(frequent_itemsets, metric="support", min_threshold=min_support)</span><span id="6dba" class="lp jx hi nc b fi nl ni l nj nk">    return rules</span><span id="5e78" class="lp jx hi nc b fi nl ni l nj nk">germany_rules = get_rules(germany_apriori_df)</span><span id="3632" class="lp jx hi nc b fi nl ni l nj nk">germany_rules.head()</span></pre><p id="009b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如我们在下面看到的，我们使用提取的规则创建的新数据帧有一些我们还不知道的列。</p><figure class="la lb lc ld fd le er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es np"><img src="../Images/1d6e0b65b25004b0e9b264009720c327.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IYbrFiDsWhEqPWvpUCO-Qg.png"/></div></div></figure><p id="5148" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">别担心，我在下面解释了它们:</p><ul class=""><li id="ecce" class="md me hi ih b ii ij im in iq mf iu mg iy mh jc mi mj mk ml bi translated">前因-&gt;第一个产品(我们假设首先售出的产品)</li><li id="bb27" class="md me hi ih b ii mm im mn iq mo iu mp iy mq jc mi mj mk ml bi translated">结果-&gt;下一个产品(我们假设在第一个产品之后销售的产品)</li><li id="5f07" class="md me hi ih b ii mm im mn iq mo iu mp iy mq jc mi mj mk ml bi translated">先行支持-&gt;观察第一个产品的概率</li><li id="3374" class="md me hi ih b ii mm im mn iq mo iu mp iy mq jc mi mj mk ml bi translated">后续支持-&gt;观察下一个产品的概率</li><li id="f2a5" class="md me hi ih b ii mm im mn iq mo iu mp iy mq jc mi mj mk ml bi translated">支持-&gt;一起观察下一个产品(结果)和第一个产品(前提)的概率</li><li id="47f6" class="md me hi ih b ii mm im mn iq mo iu mp iy mq jc mi mj mk ml bi translated">置信度-&gt;在销售第一批产品时观察到下一批产品的概率</li><li id="8e19" class="md me hi ih b ii mm im mn iq mo iu mp iy mq jc mi mj mk ml bi translated">提升-&gt;当卖出第一件产品时，卖出下一件产品的可能性会增加一个提升系数。</li><li id="c0d9" class="md me hi ih b ii mm im mn iq mo iu mp iy mq jc mi mj mk ml bi translated">杠杆-&gt;类似于提升，但杠杆倾向于优先于更高的支撑值。如果我们已经有了升力值，我们应该避免使用它。</li><li id="30a5" class="md me hi ih b ii mm im mn iq mo iu mp iy mq jc mi mj mk ml bi translated">信念-&gt;观察前因而不观察后果的概率</li></ul><h2 id="781b" class="lp jx hi bd jy lq lr ls kc lt lu lv kg iq lw lx kk iu ly lz ko iy ma mb ks mc bi translated">创建一些实用函数</h2><p id="bcb2" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated">我将创建一个使用产品id获取产品名称的函数。</p><pre class="la lb lc ld fd nd nc ne nf aw ng bi"><span id="78c0" class="lp jx hi nc b fi nh ni l nj nk">def get_item_name(dataframe, stock_code):<br/>    if type(stock_code) != list:<br/>        product_name = dataframe[dataframe["StockCode"] == stock_code][["Description"]].values[0].tolist()<br/>        return product_name<br/>    else:<br/>        product_names = [dataframe[dataframe["StockCode"] == product][["Description"]].values[0].tolist()[0] for product <strong class="nc hj">in</strong> stock_code]<br/>        return product_names</span></pre><p id="a1a2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我要去测试一下。</p><pre class="la lb lc ld fd nd nc ne nf aw ng bi"><span id="d2ff" class="lp jx hi nc b fi nh ni l nj nk">get_item_name(germany_df,10125)</span></pre><figure class="la lb lc ld fd le er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es np"><img src="../Images/89ee11ead4bf0b60b3f0aa8a4ff3d067.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IzNmuv35-r8TDqihHGsRzA.png"/></div></div></figure><p id="9f99" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我将创建另一个有用的函数。我们将看到购物车中的产品以及与之相关的推荐产品。</p><pre class="la lb lc ld fd nd nc ne nf aw ng bi"><span id="0d52" class="lp jx hi nc b fi nh ni l nj nk">def get_golden_shot(target_id,dataframe,rules):<br/>    target_product = get_item_name(dataframe,target_id)[0]<br/>    recomended_product_ids = recommend_products(rules, target_id)<br/>    recomended_product_names = get_item_name(dataframe,recommend_products(rules, target_id))<br/>    print(f'Target Product ID (which is in the cart): <strong class="nc hj">{</strong>target_id<strong class="nc hj">}\n</strong>Product Name: <strong class="nc hj">{</strong>target_product<strong class="nc hj">}</strong>')<br/>    print(f'Recommended Products: <strong class="nc hj">{</strong>recomended_product_ids<strong class="nc hj">}\n</strong>Product Names: <strong class="nc hj">{</strong>recomended_product_names<strong class="nc hj">}</strong>')</span></pre><h2 id="65f7" class="lp jx hi bd jy lq lr ls kc lt lu lv kg iq lw lx kk iu ly lz ko iy ma mb ks mc bi translated">推荐产品</h2><p id="50f1" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated">我将创建另一个函数来模拟推荐过程。其实我们会在这个功能里做一个推荐。</p><pre class="la lb lc ld fd nd nc ne nf aw ng bi"><span id="c088" class="lp jx hi nc b fi nh ni l nj nk">def recommend_products(rules_df, product_id, rec_count=5):<br/>    sorted_rules = rules_df.sort_values('lift', ascending=False) <br/><em class="mu"># we are sorting the rules dataframe by using "lift" metric</em><br/>    recommended_products = [] <br/><br/>    for i, product <strong class="nc hj">in</strong> sorted_rules["antecedents"].items(): <br/>        for j <strong class="nc hj">in</strong> list(product):  <br/>            if j == product_id:  <br/>                recommended_products.append(<br/>                    list(sorted_rules.iloc[i]["consequents"]))<br/>                <br/>    recommended_products = list({item for item_list <strong class="nc hj">in</strong> recommended_products for item <strong class="nc hj">in</strong> item_list}) <br/><br/>    return recommended_products[:rec_count]</span></pre><p id="a2a8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你可以在Kaggle笔记本中看到对上述功能的深入解释。这里我就不深解释了。只要知道这一点，我们上面编码的函数通过使用提升度量对保存关联规则的数据帧进行排序。然后它过滤出包含<code class="du mz na nb nc b">product_id</code>参数的条目，并从结果列中收集相关产品，并将它们添加到<code class="du mz na nb nc b">recommended_list</code>中，然后该函数最终返回为推荐产品创建的推荐产品。</p><h2 id="4e7e" class="lp jx hi bd jy lq lr ls kc lt lu lv kg iq lw lx kk iu ly lz ko iy ma mb ks mc bi translated">让我们做一些推荐</h2><p id="b342" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated">我将创建一些产品id来模拟这种情况。</p><pre class="la lb lc ld fd nd nc ne nf aw ng bi"><span id="038b" class="lp jx hi nc b fi nh ni l nj nk"><em class="mu"># simulating some products like they are in cart</em><br/>TARGET_PRODUCT_ID_1 = 21987<br/>TARGET_PRODUCT_ID_2 = 23235<br/>TARGET_PRODUCT_ID_3 = 22747</span></pre><p id="e102" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我可以通过使用我们在上面创建的查看产品名称的函数来查看目标产品的名称。</p><pre class="la lb lc ld fd nd nc ne nf aw ng bi"><span id="d35f" class="lp jx hi nc b fi nh ni l nj nk">get_item_name(germany_df, [TARGET_PRODUCT_ID_1,TARGET_PRODUCT_ID_2, TARGET_PRODUCT_ID_3])</span></pre><figure class="la lb lc ld fd le er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es nq"><img src="../Images/8b01fad4fcc314aed064bd3c6225406c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0n6hV-TiMrL939-o62aMNA.png"/></div></div></figure><p id="a885" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我正在执行测试的推荐功能。</p><figure class="la lb lc ld fd le er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es nr"><img src="../Images/36b1cd9deb55be57be785225451cc54b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mNYA2ek-xpWljCA1c84D2A.png"/></div></div></figure><h1 id="ffb9" class="jw jx hi bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">最后</h1><p id="2a44" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated">希望你喜欢这个。我尽力了。如前所述，您可以在Kaggle笔记本中看到所有代码。</p><p id="4022" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">诚挚的问候</p></div></div>    
</body>
</html>