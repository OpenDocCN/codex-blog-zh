<html>
<head>
<title>Building a Tinder-like swiping interface in Flutter</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Flutter中构建类似火绒的滑动界面</h1>
<blockquote>原文：<a href="https://medium.com/codex/building-a-tinder-like-swiping-interface-in-flutter-5a799901df74?source=collection_archive---------3-----------------------#2022-06-14">https://medium.com/codex/building-a-tinder-like-swiping-interface-in-flutter-5a799901df74?source=collection_archive---------3-----------------------#2022-06-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="5650" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">TL；DR:如果你只对滑动功能感兴趣，你可以直接跳到<a class="ae jd" href="#2201" rel="noopener ugc nofollow">这里</a>，或者在<a class="ae jd" href="https://github.com/florianabel/swiping-interface" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上查看最终项目。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/bdff69b6d1391b0dd76c8a977e303e2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*LIRP8M6UUYNVpoiW"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">照片由<a class="ae jd" href="https://unsplash.com/@sanjaymehra?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">桑杰·梅赫拉</a>在<a class="ae jd" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><h1 id="ced2" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated"><strong class="ak">简介</strong></h1><p id="362e" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">在这篇文章中，你将一步一步地被引导使用Flutter框架开发一个类似tinder的滑动界面。</p><p id="e117" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我喜欢这个界面的简单性，它允许用户很容易地决定是支持还是反对卡片上列出的选择。这对于需要简单的是/否选择过程的所有类型的应用程序都是有用的。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es kx"><img src="../Images/995adf1870e4a6209e28af3be7c2cc97.png" data-original-src="https://miro.medium.com/v2/resize:fit:468/1*uLdgrew0t1r373A0V5B0iA.gif"/></div></figure><h1 id="2c7d" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">颤振框架</h1><p id="8707" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">因为这个界面最适合在移动设备上使用，而且我的目标是跨不同平台的可重用性，所以我决定在Google的Flutter框架中构建这个项目。它提供了开发多平台应用程序的功能，这些应用程序可以在Android和Apple手机、平板电脑上使用，甚至可以从单个代码库开发web应用程序。</p><h1 id="82d3" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated"><strong class="ak">使用的元素</strong></h1><p id="914f" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">在这个项目中构建刷卡界面的主要组件是:</p><ul class=""><li id="b60b" class="ky kz hi ih b ii ij im in iq la iu lb iy lc jc ld le lf lg bi translated"><a class="ae jd" href="https://api.flutter.dev/flutter/widgets/Container-class.html" rel="noopener ugc nofollow" target="_blank">集装箱</a></li><li id="462a" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated"><a class="ae jd" href="https://api.flutter.dev/flutter/widgets/Expanded-class.html" rel="noopener ugc nofollow" target="_blank">展开</a></li><li id="6cd0" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated"><a class="ae jd" href="https://api.flutter.dev/flutter/widgets/LayoutBuilder-class.html" rel="noopener ugc nofollow" target="_blank">附属建筑</a></li><li id="7f42" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated"><a class="ae jd" href="https://api.flutter.dev/flutter/widgets/Draggable-class.html" rel="noopener ugc nofollow" target="_blank">可拖动</a></li></ul><p id="6516" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">此外，我们将使用<a class="ae jd" href="https://api.dart.dev/stable/2.17.3/dart-convert/dart-convert-library.html" rel="noopener ugc nofollow" target="_blank"> dart:convert库</a>和<a class="ae jd" href="https://docs.flutter.dev/development/data-and-backend/json#serializing-json-inside-model-classes" rel="noopener ugc nofollow" target="_blank">模型类序列化</a>来读取和解码一些JSON数据，以便填充要刷卡的profile卡。</p><h1 id="ef0e" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated"><strong class="ak">设置</strong></h1><p id="4e94" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated"><em class="lm">请注意，本文假设您已经预先设置了颤振开发环境。如果你以前没有使用过Flutter，你可以在他们的官方网站上找到大量关于如何开始构建自己的应用程序的免费资源，</em> <a class="ae jd" href="https://docs.flutter.dev/get-started/install" rel="noopener ugc nofollow" target="_blank"> <em class="lm">这里</em> </a> <em class="lm">。</em></p><h2 id="4390" class="ln jv hi bd jw lo lp lq ka lr ls lt ke iq lu lv ki iu lw lx km iy ly lz kq ma bi translated">创建颤振项目</h2><p id="4d2a" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated"><em class="lm">设置Flutter项目模板的过程略有不同，这取决于您正在使用的IDE。为了使它最好地可访问并独立于任何IDE，我将在本文的所有步骤中使用终端。</em></p><p id="d37b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们从在我们的终端中设置一个Flutter模板项目开始:</p><pre class="jf jg jh ji fd mb mc md me aw mf bi"><span id="4c59" class="ln jv hi mc b fi mg mh l mi mj">flutter create swiping_interface<br/>cd swiping_interface</span></pre><p id="d46b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，让我们清理模板项目，构建我们的应用程序的主框架。'<strong class="ih hj"> lib/main.dart </strong>内部:</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="mk ml l"/></div><figcaption class="jq jr et er es js jt bd b be z dx translated">应用程序框架</figcaption></figure><h1 id="1c69" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated"><strong class="ak">导入资产</strong></h1><p id="6b98" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">为了在屏幕上显示一些漂亮的简介卡片，我们需要数据来填充这些卡片。对于这个项目，我们将把一些配置文件图片和附加的配置文件信息作为JSON本地存储在applications assets文件夹中。</p><h2 id="5f38" class="ln jv hi bd jw lo lp lq ka lr ls lt ke iq lu lv ki iu lw lx km iy ly lz kq ma bi translated">创建文件夹结构</h2><p id="7c84" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">在我们的应用程序文件夹中，让我们创建一个名为“资产”的新文件夹，并在资产文件夹中创建另一个名为“json”和“profilepictures”的文件夹。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es mm"><img src="../Images/eaab2f43c86f9406d098dadec7c262c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:792/format:webp/1*FNiIvYYayuEVv7-kp8u5pg.png"/></div></figure><h2 id="fd4c" class="ln jv hi bd jw lo lp lq ka lr ls lt ke iq lu lv ki iu lw lx km iy ly lz kq ma bi translated">添加个人资料图片</h2><p id="b128" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">对于个人资料图片，我去<a class="ae jd" href="https://www.pexels.com/" rel="noopener ugc nofollow" target="_blank"> Pexels </a>，抓了几张合适的个人资料图片，放到“个人资料图片”文件夹中。</p><h2 id="15fa" class="ln jv hi bd jw lo lp lq ka lr ls lt ke iq lu lv ki iu lw lx km iy ly lz kq ma bi translated">添加配置文件数据</h2><p id="156e" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">在“json”文件夹中，我们可以创建一个“profiles.json ”,如下所示:</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="mk ml l"/></div></figure><h2 id="31ff" class="ln jv hi bd jw lo lp lq ka lr ls lt ke iq lu lv ki iu lw lx km iy ly lz kq ma bi translated">使数据在您的应用程序中可用</h2><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="mk ml l"/></div></figure><p id="1b85" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在pubspec.yaml的“flutter”部分，我们添加了一个“assets”部分，告诉Flutter哪些文件夹可以在应用程序中用作资产。关于这个话题的更多信息可以在<a class="ae jd" href="https://docs.flutter.dev/development/ui/assets-and-images" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><h1 id="9395" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">应用程序布局</h1><p id="c819" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">现在是时候在屏幕上展示更多了。让我们从一个基本的应用大纲开始。</p><h2 id="0fba" class="ln jv hi bd jw lo lp lq ka lr ls lt ke iq lu lv ki iu lw lx km iy ly lz kq ma bi translated">材料部件和安全区</h2><p id="f698" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">我们添加了一个<a class="ae jd" href="https://api.flutter.dev/flutter/material/Material-class.html" rel="noopener ugc nofollow" target="_blank">材质小部件</a>用于一些基本的样式，以及一个<a class="ae jd" href="https://api.flutter.dev/flutter/widgets/SafeArea-class.html" rel="noopener ugc nofollow" target="_blank">安全区域</a>来确保我们的应用程序不会超出不安全的边界，比如轻推。此外，让我们添加一个基本的<a class="ae jd" href="https://api.flutter.dev/flutter/widgets/Container-class.html" rel="noopener ugc nofollow" target="_blank">容器</a>来保存布局中的所有元素。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="mk ml l"/></div></figure><h2 id="aea3" class="ln jv hi bd jw lo lp lq ka lr ls lt ke iq lu lv ki iu lw lx km iy ly lz kq ma bi translated">容器样式和基本布局</h2><p id="77e5" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">现在是时候给这个容器填充一些样式和它的第一个生命了，把它放在屏幕的中央，给它一个白色的背景。在内部，我们定义了一个包含三个子部件的列:</p><ul class=""><li id="1aa9" class="ky kz hi ih b ii ij im in iq la iu lb iy lc jc ld le lf lg bi translated">一个装标志的容器</li><li id="0b41" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">我们最终要刷的卡</li><li id="5f23" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">保存导航的另一个容器</li></ul><p id="348e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由于“SwipeCard()”尚未定义，您的IDE可能会在此阶段显示一个错误。我们将在下一节中解决这个问题。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="mk ml l"/></div></figure><p id="22a2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面你可以看到完整的“main.dart”文件。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="mk ml l"/></div></figure><h1 id="b181" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">构建卡片布局</h1><p id="6abb" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">在上一节中，我们使用了一个尚未定义的“SwipeCard()”小部件。让我们首先在“lib”文件夹中创建另一个文件，并将其命名为“swipe_card.dart”。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es mn"><img src="../Images/1411fddb8e4f623576e01e18cdd8d9f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:784/format:webp/1*g9AamBfbeRZz4877GBRJ6g.png"/></div></figure><p id="cbba" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这个文件中，我们将为一个用户的配置文件构建我们的卡片界面。</p><h2 id="8275" class="ln jv hi bd jw lo lp lq ka lr ls lt ke iq lu lv ki iu lw lx km iy ly lz kq ma bi translated">基本布局</h2><p id="a6c8" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">首先，我们为卡片创建一个基本布局，然后我们将在接下来的步骤中开始设计它的样式。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="mk ml l"/></div></figure><p id="4494" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我们的main.dart文件中，我们导入了SwipeCard小部件，所以Flutter实际上可以访问它。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="mk ml l"/></div></figure><h2 id="401f" class="ln jv hi bd jw lo lp lq ka lr ls lt ke iq lu lv ki iu lw lx km iy ly lz kq ma bi translated">显示个人资料图片</h2><p id="0140" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">它可能看起来不怎么样，但我们已经为构建我们的界面和滑动功能奠定了基础。现在让我们继续在屏幕上画些东西:</p><p id="d268" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，我们将一个<a class="ae jd" href="https://api.flutter.dev/flutter/painting/BoxDecoration-class.html" rel="noopener ugc nofollow" target="_blank"> BoxDecoration </a>小部件添加到容器的装饰属性中，这给了我们添加背景图片和一些漂亮的圆角的可能性。</p><p id="a6ea" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然而，由于<a class="ae jd" href="https://api.flutter.dev/flutter/widgets/Container-class.html" rel="noopener ugc nofollow" target="_blank">容器</a>窗口小部件默认继承了其子窗口小部件的大小，并且我们在这里没有子窗口小部件，所以我们在屏幕上看不到太多。因此，我们在容器周围添加了一个<a class="ae jd" href="https://api.flutter.dev/flutter/widgets/Expanded-class.html" rel="noopener ugc nofollow" target="_blank">扩展的</a>小部件，使其填满所有可用空间。</p><p id="1999" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，为了让这张卡片看起来更漂亮，我们还增加了一些页边空白。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="mk ml l"/></div></figure><p id="0d2b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="lm">如果你往回看一点，你会发现到目前为止我们为SafeArea占据了一些空间，顶部60像素的logo容器和底部60像素的导航容器。因此，我们的SwipeCard小部件现在将填充剩余的可用空间。</em></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es mo"><img src="../Images/71a55ca488b3ed94da647d8047bf84e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:702/format:webp/1*I7fjfUjYl1ckFPFiM7xOyA.png"/></div><figcaption class="jq jr et er es js jt bd b be z dx translated">应用程序布局，顶部是徽标容器，中间是SwipeCard，底部是导航容器</figcaption></figure><h1 id="490b" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">使SwipeCard可重复使用并向其中添加更多数据</h1><p id="c6a5" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">正如你可能已经注意到的，在最后一步中，我们已经对背景图片的路径进行了硬编码。这使得我们无法在其他配置文件中重用我们的小部件。</p><h2 id="2a1d" class="ln jv hi bd jw lo lp lq ka lr ls lt ke iq lu lv ki iu lw lx km iy ly lz kq ma bi translated">使小部件可重用</h2><p id="e205" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">首先，让我们添加一些类变量并调整我们的构造函数。这样，我们可以将必要的信息传递到我们的小部件中，并使其可重用。我们正在定义:</p><ul class=""><li id="aa85" class="ky kz hi ih b ii ij im in iq la iu lb iy lc jc ld le lf lg bi translated">身份证明（identification）</li><li id="5407" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">用户名</li><li id="76c0" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">用户年龄</li><li id="67dd" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">用户描述</li><li id="f1bd" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">profileImageSrc</li></ul><p id="00bf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如您所见，图像的路径不再是硬编码的，而是依赖于传递给小部件的路径。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="mk ml l"/></div></figure><p id="9921" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">稍后，我们将使用之前在JSON文件中定义的数据来填充这个小部件。现在，当我们在“main.dart”中调用它时，我们将手动填充它。因此，请调整“main.dart”中的<em class="lm"> SwipeCard() </em>,如下所示:</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="mk ml l"/></div></figure><p id="9a8e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="lm">如果一切顺利，你的应用程序应该仍然像以前一样运行，看起来也完全一样。</em></p><h2 id="3b0e" class="ln jv hi bd jw lo lp lq ka lr ls lt ke iq lu lv ki iu lw lx km iy ly lz kq ma bi translated">向布局添加附加信息</h2><p id="b848" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">对于附加信息，我们将添加一个容器、一个列和两个带有某种样式的子元素。</p><ul class=""><li id="b267" class="ky kz hi ih b ii ij im in iq la iu lb iy lc jc ld le lf lg bi translated">该列的第一个子列显示用户名和用户年龄</li><li id="57ce" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">该列的第二个子列显示用户描述。确保添加溢出属性，以便用户的描述不会溢出可用的屏幕大小。</li></ul><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="mk ml l"/></div></figure><p id="b90a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="lm">如果你在</em> <strong class="ih hj"> <em class="lm">颜色控件</em> </strong> <em class="lm">上收到一个错误，你可能仍然在导入</em><strong class="ih hj"><em class="lm">‘flutter/widgets . dart’</em></strong><em class="lm">而不是</em><strong class="ih hj"><em class="lm">‘flutter/material . dart’</em></strong><em class="lm">，只要调整那行就可以了。</em></p><p id="72e2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在你的布局应该是这样的:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es mo"><img src="../Images/e07844e42a623b0f343c87a8f15dbb9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:702/format:webp/1*EcXxvfIh1-gMUoekQLhw0A.png"/></div><figcaption class="jq jr et er es js jt bd b be z dx translated">滑动界面的最终布局</figcaption></figure><h1 id="89a3" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">构建滑动功能</h1><p id="4ca8" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">在我们完成布局后，现在是时候给我们的界面添加一些功能了。</p><p id="83f8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了浏览一堆档案，我们需要一些东西:</p><ul class=""><li id="c89b" class="ky kz hi ih b ii ij im in iq la iu lb iy lc jc ld le lf lg bi translated">一堆我们可以浏览的资料</li><li id="de96" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">一种向左和向右刷我们的个人资料卡并在下面露出卡片的方法</li><li id="4b67" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">一些容器来理解滑动手势和之后做什么</li></ul><h2 id="0570" class="ln jv hi bd jw lo lp lq ka lr ls lt ke iq lu lv ki iu lw lx km iy ly lz kq ma bi translated">滑动界面容器</h2><p id="4f2a" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">我们将创建一个新的有状态小部件，它保存所有必要的信息，并跟踪向用户显示什么。</p><p id="3b3a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这篇文章中，我不打算讨论无状态和有状态小部件的细节。如果这个概念对你来说比较新或者不清楚，请更深入的看一下 <a class="ae jd" href="https://docs.flutter.dev/development/ui/interactive" rel="noopener ugc nofollow" target="_blank"> <em class="lm">这里</em> </a> <em class="lm">。</em></p><p id="b26f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，我们创建一个新文件‘swipe _ interface . dart’，并为我们的有状态小部件建立基础。目前，我们使用以前构建的SwipeCard小部件作为唯一的子部件，并用新创建的SwipingInterface替换main.dart中的SwipeCard。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="mk ml l"/></div></figure><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="mk ml l"/></div><figcaption class="jq jr et er es js jt bd b be z dx translated">用SwipeInterface()替换了SwipeCard()，swipe interface()又将SwipeCard()作为子小部件</figcaption></figure><h2 id="b2f4" class="ln jv hi bd jw lo lp lq ka lr ls lt ke iq lu lv ki iu lw lx km iy ly lz kq ma bi translated">从我们的档案中填充一叠档案卡。JSON文件</h2><p id="56fd" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">我们已经使SwipeCard小部件可重用，但是我们用来填充它的数据仍然是硬编码的。让我们改变一下，从我们的JSON文件中创建一个概要文件列表，然后我们可以用它来用数据填充SwipeCard。</p><p id="2f8b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们正在创建一个名为“profile.dart”的新文件来保存profile类。在这个类中，我们将创建一个工厂构造函数来从JSON数据构建一个Profile对象:</p><p id="53f0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="lm">关于工厂构造器的更多信息，可以在这里阅读</em><a class="ae jd" rel="noopener" href="/nerd-for-tech/factory-constructor-in-dart-part-1-1bbdf0d0f7f0"><em class="lm"/></a><em class="lm">关于JSON和在Flutter中序列化的更多信息，可以在这里阅读</em><a class="ae jd" href="https://docs.flutter.dev/development/data-and-backend/json" rel="noopener ugc nofollow" target="_blank"><em class="lm"/></a><em class="lm">。</em></p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="mk ml l"/></div></figure><p id="da52" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有了这个Profile类，我们现在可以很容易地从JSON数据中创建Profile对象。这就是我们要在SwipeInterface中做的事情，或者实际上我们要创建一个配置文件对象列表。</p><p id="1e30" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在SwipeInterfaceState内部，我们处于:</p><ul class=""><li id="e478" class="ky kz hi ih b ii ij im in iq la iu lb iy lc jc ld le lf lg bi translated">定义一个Profile类型列表，我们手动地用两个条目预先填充它(稍后将详细介绍)。</li><li id="1667" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">定义一个函数，从assets中的profiles.json文件加载数据，然后从中创建一个概要文件列表，最后用它更新我们的profiles变量。</li><li id="7b04" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">从构造函数中调用这个函数，获取数据并在小部件构建时创建我们的配置文件列表。</li></ul><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="mk ml l"/></div></figure><p id="a287" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，我们将使用配置文件列表中的数据替换SwipeCard的硬编码数据。因为我们正在处理一个数据列表，我们需要一个计数器来指示应该加载哪个概要文件。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="mk ml l"/></div></figure><p id="2518" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们根据计数器从配置文件列表中填充SwipeCard小部件。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="mk ml l"/></div></figure><p id="9ca5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这里你可以看到完整的参考文件:</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="mk ml l"/></div></figure><p id="19ac" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们的应用程序应该从您定义的JSON文件中加载所有数据，并在屏幕上显示第一个条目。</p><h2 id="2201" class="ln jv hi bd jw lo lp lq ka lr ls lt ke iq lu lv ki iu lw lx km iy ly lz kq ma bi translated">将刷卡功能添加到一叠个人信息卡中</h2><p id="2138" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">现在我们已经有了所有的构建模块，是时候使用<a class="ae jd" href="https://api.flutter.dev/flutter/widgets/Draggable-class.html" rel="noopener ugc nofollow" target="_blank"> Draggable </a>和<a class="ae jd" href="https://api.flutter.dev/flutter/widgets/LayoutBuilder-class.html" rel="noopener ugc nofollow" target="_blank"> LayoutBuilder </a>小部件最终添加滑动交互了，这些小部件涵盖了许多开箱即用的所需功能。</p><ul class=""><li id="8a30" class="ky kz hi ih b ii ij im in iq la iu lb iy lc jc ld le lf lg bi translated">可拖动的小部件可以在屏幕上拖动，并显示不同的状态，以便对拖动过程给出反馈。</li><li id="0c67" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">LayoutBuilder小部件提供其父级的约束，因此可用于根据父级的大小设置约束。</li></ul><p id="fd5b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，我们将用一个LayoutBuilder替换静态SwipeCard小部件，它返回一个可拖动的小部件。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="mk ml l"/></div></figure><p id="bad0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Draggable有很多属性。其中三个表示正在使用的不同UI元素:</p><ul class=""><li id="6926" class="ky kz hi ih b ii ij im in iq la iu lb iy lc jc ld le lf lg bi translated">反馈→被拖动的元素(对我们来说，这是当前的个人资料卡)。</li><li id="cf5c" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">childWhenDragging →显示在小部件原始位置的元素(对我们来说，这是隐藏在当前配置文件卡片下的卡片)。</li><li id="5c42" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">子元素→在拖动过程开始之前最初显示的元素(对我们来说，这是当前的概要文件卡)。</li></ul><p id="9754" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于反馈属性，我们将把SwipeCard包装在一个SizedBox小部件中。这使我们有可能根据LayoutBuilder提供的约束来定义它的高度和宽度属性。我们需要这样做是因为似乎有一个 <a class="ae jd" href="https://github.com/flutter/flutter/issues/39406" rel="noopener ugc nofollow" target="_blank"> <em class="lm">持续bug </em> </a> <em class="lm">带反馈属性，不提供约束，渲染后也不更新。</em></p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="mk ml l"/></div></figure><p id="2f00" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，您的应用程序看起来很可能是这样的:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es mo"><img src="../Images/8b7558671d02a3af69c53de6247bc5e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:702/format:webp/1*cjYkA6Or5M-bGZWQMOQryA.png"/></div></figure><p id="7908" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里的问题是基于扩展的小部件，它目前尽可能地扩展了SwipeCard。因为我们现在使用LayoutBuilder来包装我们的Draggable和SwipeCards，所以我们需要在LayoutBuilder周围使用扩展的小部件。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="mk ml l"/></div></figure><p id="a1e1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们已经可以随心所欲地刷个人资料卡了，唯一缺少的是某种利用刷手势的逻辑。</p><p id="2654" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="lm">注意:在这里你可以看到，反馈卡的样式与原来的不同。这很可能也是由前面提到的bug引起的。</em></p><h2 id="b490" class="ln jv hi bd jw lo lp lq ka lr ls lt ke iq lu lv ki iu lw lx km iy ly lz kq ma bi translated">构建逻辑以利用滑动手势</h2><p id="78c7" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">我们希望应用程序注意到用户“喜欢”或“不喜欢”某个配置文件，对该信息做任何它应该做的事情，然后显示堆栈中的下一个配置文件。</p><p id="f9a9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Draggable有一个我们可以利用的名为“onDragEnd”的回调函数。一旦拖动运动完成，它就会被调用，并向我们提供x和y方向的偏移(dx和d y)。</p><p id="961a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将检查x方向的偏移(dx ),如果它超出了定义的阈值，我们将调用适当的函数来处理它。</p><p id="b2af" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，让我们定义一个阈值和一些方法:</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="mk ml l"/></div></figure><p id="72bd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，在Draggable内部，让我们调用onDragEnd并传递dx:</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="mk ml l"/></div></figure><p id="b0fc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这里，您可以看到SwipeInterface小部件的最终版本:</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="mk ml l"/></div></figure><h1 id="959f" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">结论</h1><p id="9f67" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">现在，你可以为你自己的滑动界面感到骄傲，内置在Flutter中。它并不完美，仍有一些棱角。我相信有更多/不同的方式来建立这个，有些可能比其他人更适合，这也取决于你对你的项目的具体要求。我希望它能给你一个试验这种类型界面的良好开端，并且你能在它的基础上进行构建。</p><p id="cd3a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我很乐意听听你的经历和/或你会在哪里采取另一种方式来建立这种关系。请随时在评论区或在<a class="ae jd" href="https://twitter.com/florian_abel_" rel="noopener ugc nofollow" target="_blank">Twitter</a>(<a class="ae jd" href="https://twitter.com/florian_abel_" rel="noopener ugc nofollow" target="_blank">@ Florian _ Abel _</a>)联系我。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es kx"><img src="../Images/995adf1870e4a6209e28af3be7c2cc97.png" data-original-src="https://miro.medium.com/v2/resize:fit:468/1*uLdgrew0t1r373A0V5B0iA.gif"/></div></figure></div></div>    
</body>
</html>