<html>
<head>
<title>How to detect outliers using interquartile range (IQR) and what to do after finding them?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用四分位距(IQR)检测异常值，以及找到异常值后该做什么？</h1>
<blockquote>原文：<a href="https://medium.com/codex/how-to-detect-outliers-using-interquartile-range-iqr-and-what-to-do-after-finding-them-b2d6936605ed?source=collection_archive---------7-----------------------#2022-10-28">https://medium.com/codex/how-to-detect-outliers-using-interquartile-range-iqr-and-what-to-do-after-finding-them-b2d6936605ed?source=collection_archive---------7-----------------------#2022-10-28</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="67aa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在现实世界中，我们的数据并不像网上一些人在数据分析教程中承诺的那样整齐。通常，我们会发现一些距离其中心太远的数据点，称为离群值。在本帖中，我们将尝试使用IQR方法来检测样本数据集中的异常值，并讨论找到异常值后该做什么。听起来对你来说足够有趣？:D</p><p id="d930" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">像往常一样，我们将使用Google Sheets，这样我们可以很容易地理解一般概念，并且您可以使用您喜欢的工具来实现这些方法，比如R、Python或任何其他工具。</p><blockquote class="jd"><p id="ab58" class="je jf hi bd jg jh ji jj jk jl jm jc dx translated">在统计学中，<strong class="ak">异常值</strong>是与其他观察值显著不同的数据点。— <a class="ae jn" href="https://en.wikipedia.org/wiki/Outlier" rel="noopener ugc nofollow" target="_blank">维基百科</a></p></blockquote><p id="094d" class="pw-post-body-paragraph if ig hi ih b ii jo ik il im jp io ip iq jq is it iu jr iw ix iy js ja jb jc hb bi translated">让我们来看看样本数据集，我们将使用它作为离群点检测的材料<a class="ae jn" href="https://docs.google.com/spreadsheets/d/1rFhuXOsQ7CP0ZZl0fc_vDGQ6Btj2OPN-ssBcQSyVxz0/edit?usp=sharing" rel="noopener ugc nofollow" target="_blank">这里是</a>。这个样本数据中的所有名字都是随机的。如果你在这里找到了你的名字，并不意味着我告诉了所有人你现在的薪水。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div class="er es jt"><img src="../Images/68b4f32a1012d158730334703a537cfc.png" data-original-src="https://miro.medium.com/v2/resize:fit:848/format:webp/1*FSFVbNYabCoZUbFMa63ZUw.png"/></div><figcaption class="kb kc et er es kd ke bd b be z dx translated">图一。数据由26名雇员组成，带有一年的工资数字。</figcaption></figure><p id="7d54" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">假设我们在人事部门工作。我们想知道这家公司的平均工资是多少。我们应该怎么做才能得到“正确”的数字？让我们尝试直接从第<code class="du kf kg kh ki b">salary_in_usd</code>列计算平均值和中值。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div class="er es kj"><img src="../Images/2396c0e5537ff8ffcd5c3ea67b6e89e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:884/format:webp/1*vXIwEXYBNlyxp-o_wA1zdQ.png"/></div><figcaption class="kb kc et er es kd ke bd b be z dx translated">图二。数据由上述数据集中的平均值和中值组成。</figcaption></figure><p id="aa30" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如我们所看到的，平均值和中值之间的差异相当大，平均值是中值的两倍多。当我们的数据集有异常值时，通常会发生这种情况。 就数学计算而言，上面的平均值是正确的，因为145，179.12美元x 26名员工等于公司支付的工资总和，3，774，657美元。但就公司支付的普通工资值而言，这是不正确的，我们应该使用中间值，而不是65，758.50美元。</p></div><div class="ab cl kl km gp kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="hb hc hd he hf"><h1 id="969e" class="ks kt hi bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">四分位数间距(IQR)</h1><p id="e607" class="pw-post-body-paragraph if ig hi ih b ii lq ik il im lr io ip iq ls is it iu lt iw ix iy lu ja jb jc hb bi translated">我们可以使用IQR来检测异常值，IQR是Q3和Q1之间的范围。我们将使用1.5 IQR来排除我们安全假设为异常值的数据点，异常值的定义如下:</p><blockquote class="lv lw lx"><p id="3d60" class="if ig kk ih b ii ij ik il im in io ip ly ir is it lz iv iw ix ma iz ja jb jc hb bi translated">IQR = Q3 - Q1 <br/> Q3是四分位数3(百分位数75)，Q1是四分位数1(百分位数25)。</p></blockquote><figure class="ju jv jw jx fd jy er es paragraph-image"><div class="er es mb"><img src="../Images/79c8987fee123f8edf5ad04416082413.png" data-original-src="https://miro.medium.com/v2/resize:fit:972/format:webp/1*Y27KlfC1sTheNrywDdwl-w.png"/></div><figcaption class="kb kc et er es kd ke bd b be z dx translated">图3。数据包括Q1、Q3、IQR和1.5 IQR。</figcaption></figure><p id="54fd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我们得到1.5 IQR的值之后，我们应该在使用这种方法决定哪些数据点被识别为异常值之前进行最后的计算。非常简单，我们只需要得到一个<code class="du kf kg kh ki b">lower_fence</code>和<code class="du kf kg kh ki b">higher_fence</code>，它们可以这样计算:</p><blockquote class="lv lw lx"><p id="1b01" class="if ig kk ih b ii ij ik il im in io ip ly ir is it lz iv iw ix ma iz ja jb jc hb bi translated">lower _ fence = Q1–1.5 iqr<br/>higher _ fence = Q3+1.5 iqr</p></blockquote><figure class="ju jv jw jx fd jy er es paragraph-image"><div class="er es mc"><img src="../Images/fd58563a6cec53ac18752f4e05674d90.png" data-original-src="https://miro.medium.com/v2/resize:fit:976/format:webp/1*jAOdK-buEOyDqMo_T9UZhg.png"/></div><figcaption class="kb kc et er es kd ke bd b be z dx translated">图4。数据由lower_fence和higher_fence组成，用于检测异常值。</figcaption></figure><blockquote class="jd"><p id="8688" class="je jf hi bd jg jh md me mf mg mh jc dx translated">使用上图中提到的标准，我们可以很容易地判定导演Zeus的<code class="du kf kg kh ki b">salary_in_usd</code>值是一个异常值。</p></blockquote><p id="c7f5" class="pw-post-body-paragraph if ig hi ih b ii jo ik il im jp io ip iq jq is it iu jr iw ix iy js ja jb jc hb bi translated">很简单，对吧？在这种情况下，我们只有26行数据，这就是为什么我们可以很容易地确定只有主管Zeus是异常值。假设我们的数据集中有500，000行，我们必须自动检测，我们可以使用类似的函数，但您可以尝试即兴发挥，以满足我们的独特需求。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div class="er es mi"><img src="../Images/a73358dd5640d26fbf7631e4a76bbf24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1176/format:webp/1*laLRQwRgs0VLRNEnjENBGQ.png"/></div><figcaption class="kb kc et er es kd ke bd b be z dx translated">图5。数据由使用lower_fence和higher_fence的异常值检测组成。</figcaption></figure><p id="27e8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们知道主管Zeus的薪金值是一个异常值，我们可以尝试重新计算平均值和中值，排除该值。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div class="er es mj"><img src="../Images/c41a5b5c752d1e27b86b8a94f4a366c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1330/format:webp/1*j9v_kEO2cC0U914DP9lvkQ.png"/></div><figcaption class="kb kc et er es kd ke bd b be z dx translated">图6。数据由剔除异常值前后的比较组成。</figcaption></figure><p id="66c9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这看起来比我们以前的平均值好多了。但是，我们仍然可以看到平均值和中值之间的差异很大，65，000美元和101，000美元，即使在我们去除了异常值之后。<strong class="ih hj"> <em class="kk">当这样的事情发生时，意味着我们的数据有了聚类。</em> </strong>是什么意思？我们不能不先对数据进行聚类就直接计算平均值和中值。</p><p id="30cd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我想你们已经意识到我们的数据集中有一个变量<code class="du kf kg kh ki b">role</code>。也许它影响了我们的平均值和中值。让我们把数据集分成<code class="du kf kg kh ki b">staff_only</code>和<code class="du kf kg kh ki b">manager_only</code>。请在此查看数据<a class="ae jn" href="https://docs.google.com/spreadsheets/d/1rFhuXOsQ7CP0ZZl0fc_vDGQ6Btj2OPN-ssBcQSyVxz0/edit#gid=825192888&amp;range=A1:I23" rel="noopener ugc nofollow" target="_blank">。</a></p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="ml mm di mn bf mo"><div class="er es mk"><img src="../Images/9d9ff1f4df392fd525ef23a541f81f53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hG32uKXyMmEPyo6Bziru7g.png"/></div></div><figcaption class="kb kc et er es kd ke bd b be z dx translated">图7。数据由仅员工和仅经理的平均值和中值组成。</figcaption></figure><p id="d034" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们正在谈话。每个“群”的平均值和中间值没有太大的差异，我们可以假设使用上面的平均数作为公司支付给员工的美元平均工资是安全的。</p><blockquote class="jd"><p id="738d" class="je jf hi bd jg jh ji jj jk jl jm jc dx translated">对于职位为“<code class="du kf kg kh ki b">staff’</code>的员工，薪酬约为6.4万美元，<code class="du kf kg kh ki b">manager'</code>约为22万美元。总的来说，该公司为每位员工支付了10.1万美元。听起来很公平！</p></blockquote></div><div class="ab cl kl km gp kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="hb hc hd he hf"><h1 id="8e67" class="ks kt hi bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated"><strong class="ak">总结</strong></h1><ol class=""><li id="9c1b" class="mp mq hi ih b ii lq im lr iq mr iu ms iy mt jc mu mv mw mx bi translated">离群点检测是数据清理的一部分，在开始做数据分析之前，我们必须将它作为一个常规。</li><li id="2525" class="mp mq hi ih b ii my im mz iq na iu nb iy nc jc mu mv mw mx bi translated">检测异常值的最简单方法之一是使用IQR得到<code class="du kf kg kh ki b">lower_fence</code>和<code class="du kf kg kh ki b">higher_fence</code>来排除异常值。</li><li id="bb6c" class="mp mq hi ih b ii my im mz iq na iu nb iy nc jc mu mv mw mx bi translated">如果我们仍然发现平均值和中值之间有任何显著差异，这意味着我们的数据中有聚类，如果我们根据聚类分割数据以获得更准确的信息或见解，效果会更好。</li><li id="ff7a" class="mp mq hi ih b ii my im mz iq na iu nb iy nc jc mu mv mw mx bi translated">对于如何检测异常值的其他参考，有许多方法可能更准确，这取决于数据集的特征。</li><li id="18eb" class="mp mq hi ih b ii my im mz iq na iu nb iy nc jc mu mv mw mx bi translated">只有当数据集不太大时，上述所有步骤才有可能在Google Sheets中完成。当我们面对更大规模的数据集时，我们必须尝试使用编程语言(如R、Python或其他能够满足数据集规模的工具)来计算它们。</li><li id="b4fc" class="mp mq hi ih b ii my im mz iq na iu nb iy nc jc mu mv mw mx bi translated">在这种情况下，我们仅通过使用理由<strong class="ih hj">排除了主管Zeus的工资值，“这是一个异常值，它使平均值显著正向倾斜，这就是为什么我们必须删除它”</strong>。在某些情况下，我们无法做到这一点，因为并非每个离群值都是坏数据点。让我们试着另找时间谈论它。</li></ol></div><div class="ab cl kl km gp kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="hb hc hd he hf"><p id="4bdd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我希望这篇文章对您有用，并让您有兴趣自己尝试一下，这样您就可以自己获得经验，并在现实世界的案例中实现这种异常值检测方法。像往常一样，如果你对我有任何意见或批评，请不要犹豫回复这篇文章，或者通过我的LinkedIn个人资料联系我。感谢你阅读这篇文章！</p></div></div>    
</body>
</html>