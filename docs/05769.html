<html>
<head>
<title>Spring Boot Internationalization — i18n</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Spring Boot国际化— i18n</h1>
<blockquote>原文：<a href="https://medium.com/codex/spring-boot-internationalization-i18n-d4a53494e7b9?source=collection_archive---------5-----------------------#2022-03-28">https://medium.com/codex/spring-boot-internationalization-i18n-d4a53494e7b9?source=collection_archive---------5-----------------------#2022-03-28</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div class="er es hg"><img src="../Images/eed99d10dfa5080df004e5c7b2e8be55.png" data-original-src="https://miro.medium.com/v2/resize:fit:1386/format:webp/1*IEjqXnnedKARX0g34Au75g.jpeg"/></div></figure><div class=""/><h1 id="65fb" class="im in hp bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">配置</h1><p id="ba20" class="pw-post-body-paragraph jk jl hp jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated">任何web应用程序的一个基本要求是能够支持多种语言并具有本地化的消息。为了在默认情况下实现这一点，Spring Boot在类路径的根目录下寻找一个<code class="du ki kj kk kl b">messages.properties</code>资源包。</p><figure class="km kn ko kp fd hk er es paragraph-image"><div class="er es hg"><img src="../Images/5970ee8f58c2e0d76c4f45825b715a02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1386/format:webp/1*2iMQeFN7FdeJLR5CilJLRA.png"/></div></figure><p id="be48" class="pw-post-body-paragraph jk jl hp jm b jn kq jp jq jr kr jt ju jv ks jx jy jz kt kb kc kd ku kf kg kh hb bi translated">这些文件包含需要多语言支持的每个文本的一组键值行，如下例所示:</p><p id="20c9" class="pw-post-body-paragraph jk jl hp jm b jn kq jp jq jr kr jt ju jv ks jx jy jz kt kb kc kd ku kf kg kh hb bi translated"><strong class="jm hq"> message.properties </strong></p><pre class="km kn ko kp fd kv kl kw kx aw ky bi"><span id="8108" class="kz in hp kl b fi la lb l lc ld"><strong class="kl hq">welcome</strong>=Hello! this is a test message!<strong class="kl hq"><br/>lang.change</strong>=Change the language<strong class="kl hq"><br/>lang.eng</strong>=English<strong class="kl hq"><br/>lang.fr</strong>=French</span></pre><p id="cbbf" class="pw-post-body-paragraph jk jl hp jm b jn kq jp jq jr kr jt ju jv ks jx jy jz kt kb kc kd ku kf kg kh hb bi translated"><strong class="jm hq"> message_fr.properties </strong></p><pre class="km kn ko kp fd kv kl kw kx aw ky bi"><span id="bacb" class="kz in hp kl b fi la lb l lc ld"><strong class="kl hq">welcome</strong>=Bonjour! Ceci est un message test!<strong class="kl hq"><br/>lang.change</strong>=Changer la langue<strong class="kl hq"><br/>lang.eng</strong>=English<strong class="kl hq"><br/>lang.fr</strong>=French</span></pre><p id="7c29" class="pw-post-body-paragraph jk jl hp jm b jn kq jp jq jr kr jt ju jv ks jx jy jz kt kb kc kd ku kf kg kh hb bi translated">当然，有几个类似于<code class="du ki kj kk kl b">basename</code>的属性，您可以使用<code class="du ki kj kk kl b">application.properties</code>或<code class="du ki kj kk kl b">application.yaml</code>中的<code class="du ki kj kk kl b">spring.messages</code>名称空间来更改资源包配置。</p><pre class="km kn ko kp fd kv kl kw kx aw ky bi"><span id="1d43" class="kz in hp kl b fi la lb l lc ld"><strong class="kl hq">spring.messages.basename=</strong>messages, i18n.list<br/><strong class="kl hq">spring.messages.fallback-to-system-locale=</strong>false</span></pre><h1 id="0b76" class="im in hp bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">消息检索</h1><p id="07c0" class="pw-post-body-paragraph jk jl hp jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated">有几种方法可以使用资源包文件中提供的键来获得正确的本地化消息。你可以明确地提到语言环境类型并使用<code class="du ki kj kk kl b">ResourceBundleMessageSource</code>，或者你可以使用一个更有效、功能更强的语言环境<code class="du ki kj kk kl b">LocaleResolver</code>。</p><h2 id="190f" class="kz in hp bd io le lf lg is lh li lj iw jv lk ll ja jz lm ln je kd lo lp ji lq bi translated">ResourceBundleMessageSource</h2><p id="ab9f" class="pw-post-body-paragraph jk jl hp jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated">从资源包中获取相关消息的最简单方法是使用<code class="du ki kj kk kl b">ResourceBundleMessageSource</code>。</p><pre class="km kn ko kp fd kv kl kw kx aw ky bi"><span id="fcc0" class="kz in hp kl b fi la lb l lc ld">@Component<br/><strong class="kl hq">public class </strong>ApplicationConfiguration {<br/><br/>    @Autowired<br/>    ResourceBundleMessageSource <strong class="kl hq">messageSource</strong>;<br/><br/>    @PostConstruct<br/>    <strong class="kl hq">public void </strong>init(){<br/>        String <strong class="kl hq">welcome = messageSource</strong>.getMessage(<strong class="kl hq">"welcome"</strong>, <strong class="kl hq">null</strong>, Locale.<strong class="kl hq"><em class="lr">FRANCE</em></strong>));<br/>    }<br/><br/>}</span></pre><p id="1ca1" class="pw-post-body-paragraph jk jl hp jm b jn kq jp jq jr kr jt ju jv ks jx jy jz kt kb kc kd ku kf kg kh hb bi translated">上面的代码将导致在欢迎字符串中设置法语版的欢迎键消息。</p><h2 id="3ebb" class="kz in hp bd io le lf lg is lh li lj iw jv lk ll ja jz lm ln je kd lo lp ji lq bi translated">LocaleResolver</h2><p id="b60c" class="pw-post-body-paragraph jk jl hp jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated">另一种确定当前使用的语言环境的方法是使用<code class="du ki kj kk kl b">LocaleResolver</code>。这个接口有不同的实现，根据会话、cookies、<em class="lr"> Accept-Language </em>头或固定值来确定当前的语言环境。</p><p id="6cfa" class="pw-post-body-paragraph jk jl hp jm b jn kq jp jq jr kr jt ju jv ks jx jy jz kt kb kc kd ku kf kg kh hb bi translated"><strong class="jm hq"> FixedLocaleResolver: </strong>该实现主要用于调试目的，您将总是在项目应用程序属性文件中设置一种固定的语言</p><pre class="km kn ko kp fd kv kl kw kx aw ky bi"><span id="d5fd" class="kz in hp kl b fi la lb l lc ld">@Bean<br/><strong class="kl hq">public </strong>LocaleResolver localeResolver() {<br/>   FixedLocaleResolver lr = <strong class="kl hq">new </strong>FixedLocaleResolver();<br/>   lr.setDefaultLocale(Locale.<strong class="kl hq"><em class="lr">US</em></strong>);<br/>   <strong class="kl hq">return </strong>lr;<br/>}</span></pre><p id="ccd7" class="pw-post-body-paragraph jk jl hp jm b jn kq jp jq jr kr jt ju jv ks jx jy jz kt kb kc kd ku kf kg kh hb bi translated"><strong class="jm hq">accepthederlocaleresolver:</strong>对于web应用程序，其中一个选项是在请求上使用“accept-language”HTTP头。这个实现将从HTTP status头中获取值并应用它。</p><pre class="km kn ko kp fd kv kl kw kx aw ky bi"><span id="6880" class="kz in hp kl b fi la lb l lc ld">@Bean<br/><strong class="kl hq">public </strong>LocaleResolver localeResolver() {<br/>   AcceptHeaderLocaleResolver lr = <strong class="kl hq">new </strong>AcceptHeaderLocaleResolver();<br/>   lr.setDefaultLocale(Locale.<strong class="kl hq"><em class="lr">US</em></strong>);<br/>   <strong class="kl hq">return </strong>lr;<br/>}</span></pre><p id="9345" class="pw-post-body-paragraph jk jl hp jm b jn kq jp jq jr kr jt ju jv ks jx jy jz kt kb kc kd ku kf kg kh hb bi translated">web应用程序的另一种方法是使用会话为访问应用程序的用户获取本地。在此实现中，该值将存储在会话中，并在会话的生存期内可用。</p><pre class="km kn ko kp fd kv kl kw kx aw ky bi"><span id="8279" class="kz in hp kl b fi la lb l lc ld">@Bean<br/><strong class="kl hq">public </strong>LocaleResolver localeResolver() {<br/>    SessionLocaleResolver lr = <strong class="kl hq">new </strong>SessionLocaleResolver();<br/>    lr.setDefaultLocale(Locale.<strong class="kl hq"><em class="lr">US</em></strong>);<br/>    <strong class="kl hq">return </strong>lr;<br/>}</span></pre><p id="974f" class="pw-post-body-paragraph jk jl hp jm b jn kq jp jq jr kr jt ju jv ks jx jy jz kt kb kc kd ku kf kg kh hb bi translated"><strong class="jm hq">CookieLocaleResolver:</strong>Cookies也是另一个可以实现的选项。它们存储在用户的机器上，并且只要浏览器cookies没有被用户清除，一旦被解析，被解析的区域设置数据将持续存在，甚至在会话之间。</p><pre class="km kn ko kp fd kv kl kw kx aw ky bi"><span id="1405" class="kz in hp kl b fi la lb l lc ld">@Bean<br/><strong class="kl hq">public </strong>LocaleResolver localeResolver() {<br/>    CookieLocaleResolver lr = <strong class="kl hq">new </strong>CookieLocaleResolver();<br/>    lr.setDefaultLocale(Locale.<strong class="kl hq"><em class="lr">US</em></strong>);<br/>    <strong class="kl hq">return </strong>lr;<br/>}</span></pre><p id="d7eb" class="pw-post-body-paragraph jk jl hp jm b jn kq jp jq jr kr jt ju jv ks jx jy jz kt kb kc kd ku kf kg kh hb bi translated"><strong class="jm hq">注意:<strong class="jm hq"> SessionLocaleResolver </strong>和<strong class="jm hq"> CookieLocaleResolver </strong>的</strong>我们需要一个拦截器来获取用户发送的首选语言的参数，并将其存储在会话或cookie中。多亏了spring，这已经完成了，don，你可以使用<code class="du ki kj kk kl b">LocaleChangeInterceptor</code>，只需传递属性名来设置区域。</p><pre class="km kn ko kp fd kv kl kw kx aw ky bi"><span id="e86d" class="kz in hp kl b fi la lb l lc ld">@Bean<br/>public WebMvcConfigurer configurer(){<br/>     return new WebMvcConfigurerAdapter() {<br/>     @Override<br/>     public void addInterceptors (InterceptorRegistry registry) {<br/>        <strong class="kl hq">LocaleChangeInterceptor l = new LocaleChangeInterceptor();<br/>        l.setParamName("localeParmName");<br/>        registry.addInterceptor(l);</strong><br/>       }<br/>    };<br/>}</span></pre></div><div class="ab cl ls lt gp lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="hb hc hd he hf"><p id="9b74" class="pw-post-body-paragraph jk jl hp jm b jn kq jp jq jr kr jt ju jv ks jx jy jz kt kb kc kd ku kf kg kh hb bi translated">希望这篇文章对你有所帮助，请支持我，为这个故事鼓掌。如果你不知道事情是这样的:</p><figure class="km kn ko kp fd hk er es paragraph-image"><div class="er es lz"><img src="../Images/132f582a8bfb627acd6e41cb2efa0af1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*-fs7c8JDLyZxmDW0.gif"/></div></figure><p id="7378" class="pw-post-body-paragraph jk jl hp jm b jn kq jp jq jr kr jt ju jv ks jx jy jz kt kb kc kd ku kf kg kh hb bi translated">或者在这里给我买杯咖啡<a class="ae ma" href="https://www.buymeacoffee.com/fpashaee" rel="noopener ugc nofollow" target="_blank">！</a></p></div></div>    
</body>
</html>