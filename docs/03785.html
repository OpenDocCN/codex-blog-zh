<html>
<head>
<title>Facial Landmark Detection Algorithms</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">面部标志检测算法</h1>
<blockquote>原文：<a href="https://medium.com/codex/facial-landmark-detection-algorithms-5b2d2a12adaf?source=collection_archive---------0-----------------------#2021-09-26">https://medium.com/codex/facial-landmark-detection-algorithms-5b2d2a12adaf?source=collection_archive---------0-----------------------#2021-09-26</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/857ffe1dd20c7bd42e9142687c7c50a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kmu_t1iNbOipwozjxCG6og.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">来源:latesttechnicalreviews.com</figcaption></figure><p id="f203" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">面部标志检测算法有助于自动识别面部图像上或视频中的面部关键标志点的位置。关键标志点通常包括像鼻尖、眼角、眉毛和下巴尖这样的面部区域。面部标志检测的一些应用是面部交换、头部姿态检测、检测面部姿态、注视方向等。</p><p id="da18" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">地标检测分两步进行。</p><ol class=""><li id="db7c" class="js jt hi iw b ix iy jb jc jf ju jj jv jn jw jr jx jy jz ka bi translated"><strong class="iw hj">人脸检测</strong></li></ol><p id="8b1b" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">人脸检测从图像中定位人脸，并根据检测到的人脸的边界矩形的坐标返回一个值。</p><p id="d9df" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">2.<strong class="iw hj">地标检测</strong></p><p id="5cf5" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在检测到人脸后，我们已经遍历了包围矩形内的关键点。</p><h1 id="8cd4" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">算法的分类</h1><p id="9ecb" class="pw-post-body-paragraph iu iv hi iw b ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn ld jp jq jr hb bi translated">根据面部外观和面部形状模式，面部标志检测算法分为三种。</p><p id="5a01" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这里，面部外观指的是面部标志周围或整个面部区域中的独特像素强度模式，而面部形状模式指的是由标志位置及其空间关系定义的面部形状的模式。</p><p id="75dd" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">地标检测算法的三个主要类别是:</p><ol class=""><li id="5c25" class="js jt hi iw b ix iy jb jc jf ju jj jv jn jw jr jx jy jz ka bi translated">整体方法</li><li id="b394" class="js jt hi iw b ix le jb lf jf lg jj lh jn li jr jx jy jz ka bi translated">约束局部模型(CLM)方法</li><li id="5f35" class="js jt hi iw b ix le jb lf jf lg jj lh jn li jr jx jy jz ka bi translated">回归方法</li></ol><p id="1169" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">整体方法明确地对整体面部外观和整体面部形状模式进行建模。</p><p id="db61" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">clm依赖于明确的局部面部外观和明确的全局面部形状模式。</p><p id="62eb" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">基于回归的方法使用整体或局部外观信息，并且它们可以隐含地嵌入全局面部形状模式用于联合界标检测。</p><p id="2a40" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">一些最近的方法结合了深度学习模型和全局3D形状模型用于地标检测。</p><h1 id="a0f9" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated"><strong class="ak">热门车型</strong></h1><p id="51e5" class="pw-post-body-paragraph iu iv hi iw b ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn ld jp jq jr hb bi translated">在本文中，我们将讨论一些用于面部标志检测的流行模型。OpenCV的面部地标API叫做Facemark。它有三种不同的实现:FacemarkKazemi(回归树的集成模型)、FacemarkAAM(主动外观模型)和FacemarkLBF(局部二元特征)。但是，目前，我们只有一个可用的训练模型(FacemarkLBF ), python支持还不支持这些模型。</p><h2 id="c590" class="lj kc hi bd kd lk ll lm kh ln lo lp kl jf lq lr kp jj ls lt kt jn lu lv kx lw bi translated">LBF模型</h2><p id="7b54" class="pw-post-body-paragraph iu iv hi iw b ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn ld jp jq jr hb bi translated">FacemarkLBF模型从每个面返回68个地标，这些地标存储在点的向量中。因为我们可以在一帧中找到多张脸，所以我们必须传递一个点的向量来存储界标。下面给出了使用LBF模型进行地标检测的示例C++代码。</p><figure class="ly lz ma mb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lx"><img src="../Images/1e47177d42f5e0decd1a4db41a088536.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W7zMu6-ip1T0E2Z5vNrXgg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">源代码:learnopencv.com</figcaption></figure><p id="a2e7" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> Dlib型号</strong></p><p id="a36e" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">Dlib库中包含人脸检测和地标检测功能。DLib人脸检测使用直方图导向方法(HOG ),地标检测基于卡泽米模型。它从一张脸上返回不同的68个特征点。下图展示了一张脸上这68个点的位置。</p><figure class="ly lz ma mb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mc"><img src="../Images/fc83520e4e008c9861c3eaeb5d8680c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FMfytu1wKOD2WCd-SiFLqQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">DLib面部标志点。(来源:PyImageSearch)</figcaption></figure><p id="5efb" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">Dlib包括一个预先构建的人脸标志检测模型，名为shape _ predictor _ 68 _ face marks . dat。我们只是直接访问该模型并创建一个对象。下面分享使用Dlib模型进行面部地标检测的样例代码。</p><figure class="ly lz ma mb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lx"><img src="../Images/beb90a56217249dd6821479c682a84f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DyV5LUrJ3EDU3GknV_HA6w.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">源代码:DLib面部标志检测</figcaption></figure><p id="6136" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> MTCNN型号</strong></p><p id="b567" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">MTCNN代表多任务级联卷积网络。它是一个使用深度学习架构的联合人脸检测和地标检测模型。该结构由P-Net、R-Net和O-Net三个卷积神经网络组成。</p><p id="d770" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">P-Net的名字来源于提议网络。它在12×12大小的框架中寻找人脸。这个网络的任务是快速产生结果。</p><p id="68fd" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">R-Net的名字来源于refine network。它的结构比P-Net更深。所有来自前一个网络P-Net的候选人都被馈送到R-Net。P-Net在这里拒绝了大量的候选人。</p><p id="abbd" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">输出网络或简称O-Net返回边界框(面部区域)和面部标志位置。</p><p id="54d5" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">MTCNN的架构如下图所示。</p><figure class="ly lz ma mb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es md"><img src="../Images/dc96fb59983b8d4feb8e1c4db5cef250.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RN01cLTyAT2Tre-OpnKn-g.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">MTCNN架构(参考文献:[1])</figcaption></figure><p id="41d8" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">MTCNN模型检测五个面部标志，即左眼、右眼、鼻子和两个嘴角。与其他模型相比，MTCNN模型的人脸检测得分较高，但速度较低。下面给出了MTCNN的一个示例实现。</p><figure class="ly lz ma mb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lx"><img src="../Images/7cb6a332a3303a6dc5f5038d4d8ccff4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xWUpVu_-8mREh5CSBItmug.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">基于MTCNN的地标检测</figcaption></figure><p id="bd49" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> Mediapipe型号</strong></p><p id="d454" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">Mediapipe <strong class="iw hj"> </strong>是Google为计算机视觉任务开发的跨平台库。Mediapipe python库使用整体模型来检测面部和手部标志。这个整体模型产生468个面部标志、21个左手标志和21个右手标志。可以通过指定所需地标的索引来访问各个地标。不幸的是，mediapipe库现在只支持视频流元素，不支持静态图像。示例代码附在下面。</p><figure class="ly lz ma mb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lx"><img src="../Images/7955822667beeaaae06fbe224e1732e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0LT8HAGkbVfzRJPZd2ze9A.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">媒体管道面部标志检测</figcaption></figure><p id="0b13" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">相当多的软件包是为人脸检测而构建的。其中一些用于探测和地标定位。但是仍然没有一个出色的性能模型。面部检测和地标定位的挑战如下:</p><ol class=""><li id="c5b1" class="js jt hi iw b ix iy jb jc jf ju jj jv jn jw jr jx jy jz ka bi translated">不同的面部表情和头部姿势</li><li id="e2e5" class="js jt hi iw b ix le jb lf jf lg jj lh jn li jr jx jy jz ka bi translated">照明等各种环境条件</li><li id="bd42" class="js jt hi iw b ix le jb lf jf lg jj lh jn li jr jx jy jz ka bi translated">其他物体造成的面部遮挡或极端头部姿势造成的自遮挡</li></ol><p id="b66c" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">考虑到这些因素，这方面的研究工作正在取得进展。让我们等待…</p><h1 id="1776" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">参考</h1><p id="29ad" class="pw-post-body-paragraph iu iv hi iw b ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn ld jp jq jr hb bi translated">特别鸣谢pyimagesearchUniversity，learnopencv</p><ol class=""><li id="231b" class="js jt hi iw b ix iy jb jc jf ju jj jv jn jw jr jx jy jz ka bi translated">基于多任务级联卷积网络的人脸检测和对齐算法张，，，IEEE高级会员，于桥，IEEE高级会员</li></ol><p id="2c14" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">2.Python中的MTCNN深度人脸检测</p></div></div>    
</body>
</html>