<html>
<head>
<title>You Won’t See This Python Operator Too Often in Your Life!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">你这辈子不会太经常看到这个Python操作者了！</h1>
<blockquote>原文：<a href="https://medium.com/codex/you-wont-see-this-python-operator-very-often-in-your-life-e954870243f1?source=collection_archive---------8-----------------------#2021-10-25">https://medium.com/codex/you-wont-see-this-python-operator-very-often-in-your-life-e954870243f1?source=collection_archive---------8-----------------------#2021-10-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/7ceffaa9f3bf417e57ad4b54758e4736.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*7tkOdL5KCffbA4QpxI6zsA.gif"/></div></figure><p id="aec2" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">你好，你好吗？今天我要写的是Python的<strong class="io hj"> <em class="jk">最不为人知的</em> </strong>(还有<strong class="io hj"> <em class="jk">有争议的</em> </strong>)运算符之一，也是让吉多·范罗森从<strong class="io hj"> BDFL </strong> ( <em class="jk">仁慈的终身独裁者</em>)的位置上下台的运算符。我将简要介绍它的工作原理和性能，然后我们将看几个使用场景。到本文结束时，您应该对该操作符做什么以及何时应用它有一个很好的概念。</p><p id="54e8" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">让我们看一个简单的程序。</p></div><div class="ab cl jl jm gp jn" role="separator"><span class="jo bw bk jp jq jr"/><span class="jo bw bk jp jq jr"/><span class="jo bw bk jp jq"/></div><div class="hb hc hd he hf"><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="234a" class="kb kc hi jx b fi kd ke l kf kg">print(myval = 10)</span></pre></div><div class="ab cl jl jm gp jn" role="separator"><span class="jo bw bk jp jq jr"/><span class="jo bw bk jp jq jr"/><span class="jo bw bk jp jq"/></div><div class="hb hc hd he hf"><p id="7114" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">当我试图打印上面的程序时，出现了一条错误消息，说“TypeError:'myval '是print()的无效关键字参数。”它证明了我没有关键字参数“myval”。当然，如果我传递的参数是print()函数的一部分，那么结果将与我期望的不同。</p><p id="7bfe" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">但是，你瞧，海象操作员<strong class="io hj"><em class="jk"/></strong>来拯救世界了。Walrus是我们将在本文中看到的操作符。海象运营商的做法略有不同。</p><h2 id="76a9" class="kb kc hi bd kh ki kj kk kl km kn ko kp ix kq kr ks jb kt ku kv jf kw kx ky kz bi translated">海象操作员</h2></div><div class="ab cl jl jm gp jn" role="separator"><span class="jo bw bk jp jq jr"/><span class="jo bw bk jp jq jr"/><span class="jo bw bk jp jq"/></div><div class="hb hc hd he hf"><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="88f8" class="kb kc hi jx b fi kd ke l kf kg">print(myval := 10)</span></pre></div><div class="ab cl jl jm gp jn" role="separator"><span class="jo bw bk jp jq jr"/><span class="jo bw bk jp jq jr"/><span class="jo bw bk jp jq"/></div><div class="hb hc hd he hf"><p id="2d72" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我将在赋值操作符前添加冒号“:”。然后我的屏幕上印了10。这基本上是同时返还和分配。</p><p id="4d1e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">海象操作员之所以这么叫，是因为它看起来有点像海象的眼睛和长牙。</p><figure class="js jt ju jv fd ij er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es la"><img src="../Images/546a6226195235cfc7a74c266818da1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Ik1UB6uWF794C4GT"/></div></div><figcaption class="lf lg et er es lh li bd b be z dx translated">海象— <a class="ae lj" href="https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fwww.gannett-cdn.com%2Fpresto%2F2019%2F09%2F24%2FUSAT%2F49d17e0e-3831-40c4-8230-fc5ccbafce94-GettyImages-508404787.jpg%3Fcrop%3D3804%2C2140%2Cx0%2Cy390%26width%3D3200%26height%3D1680%26fit%3Dbounds&amp;f=1&amp;nofb=1" rel="noopener ugc nofollow" target="_blank">来源</a></figcaption></figure><h2 id="13e0" class="kb kc hi bd kh ki kj kk kl km kn ko kp ix kq kr ks jb kt ku kv jf kw kx ky kz bi translated">要记住的事情</h2><p id="7522" class="pw-post-body-paragraph im in hi io b ip lk ir is it ll iv iw ix lm iz ja jb ln jd je jf lo jh ji jj hb bi translated">我想给你一些一般性的建议，告诉你当新特性<strong class="io hj"><em class="jk"/></strong>被引入一门语言、一个框架或者其他什么的时候，你应该有怎样的心态。避免这种非黑即白的想法，你实际上是在说我会一直用那个或者我永远不会用那个。想想它的特点，看看它的优点和缺点。</p><p id="cc51" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">你现在必须意识到这个特性是在Python 3.8中引入的，所以如果你出于某种原因使用它，它将<strong class="io hj"> <em class="jk">与Python 3.7和更低版本的</em> </strong>不兼容，当然，很多程序员，尤其是对Python语言的每个小特性都不太感兴趣的初学者或中间用户，可能不理解你的代码或你到底在做什么，所以对一些人来说， <strong class="io hj"> <em class="jk">可读性</em> </strong>在你使用walrus操作符的时候会是一个问题，因为它不是最受欢迎和使用最广泛的操作符，所以这一点要记住。</p><p id="0854" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">它不会增加任何你没有它就无法完成的事情，所以它不是你必须做的事情。它只是一个<strong class="io hj"> <em class="jk">新方法</em> </strong>做事，它可以帮你减少代码。</p><h2 id="9572" class="kb kc hi bd kh ki kj kk kl km kn ko kp ix kq kr ks jb kt ku kv jf kw kx ky kz bi translated">实施例1</h2><p id="90f5" class="pw-post-body-paragraph im in hi io b ip lk ir is it ll iv iw ix lm iz ja jb ln jd je jf lo jh ji jj hb bi translated">让我们看看第一个例子，在这个例子中，walrus操作符非常有用。在基于命令行的应用程序中，我们经常会遇到一些动态的用户输入，我们需要对其进行处理，例如在猜数字游戏、菜单或hangman游戏中，或者基本上在我们有一些反复执行的应用程序中，我们有不断关联的用户输入。</p><p id="60d0" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">让我们看看下面这个没有walrus operator的程序:</p></div><div class="ab cl jl jm gp jn" role="separator"><span class="jo bw bk jp jq jr"/><span class="jo bw bk jp jq jr"/><span class="jo bw bk jp jq"/></div><div class="hb hc hd he hf"><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="58ba" class="kb kc hi jx b fi kd ke l kf kg">done = False</span><span id="28ce" class="kb kc hi jx b fi lp ke l kf kg">while not done:<br/>    user_input = input("Enter something ('q' to quit): ")<br/>    <br/>    if user_input == 'q':<br/>        done = True<br/>    else:<br/>        print(f"You entered {user_input}")</span></pre><p id="8442" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">输出:</strong></p><p id="1a63" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">输入某物(' q '退出):Hi <br/>你输入Hi <br/>输入某物(' q '退出):Hello <br/>你输入Hello <br/>输入某物(' q '退出):q</p><p id="0008" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在的问题是我们有很多不必要的东西，我们可以用不同的方式去做。例如，如果我们可以直接检查while头中的终止条件，我们就不需要布尔值。没有walrus运算符时，修改后的代码如下所示:</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="de8d" class="kb kc hi jx b fi kd ke l kf kg">while input("Enter something ('q' to quit): ") != 'q':<br/>    user_input = input("Enter something: ")<br/>    print(f"You entered {user_input}")</span></pre><p id="0aa6" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">输出:</strong></p><p id="e89a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">输入某物(' q '退出):Hi <br/>输入某物:Hi <br/>你输入Hi <br/>输入某物(' q '退出):hello<br/>输入某物:hello<br/>你输入hello<br/>输入某物(' q '退出):q</p><p id="6492" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">然而，这减少了代码行，但我仍然需要<strong class="io hj"> <em class="jk">处理user_input </em> </strong>，所以我需要存储输入的任何内容，如果头中没有walrus操作符，我就无法做到这一点。</p><p id="d621" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在让我们使用walrus操作符尝试相同的逻辑:</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="4ff2" class="kb kc hi jx b fi kd ke l kf kg">while (user_input := input("Enter something ('q' to quit): "))!='q':<br/>    print(f"You entered {user_input}")</span></pre><p id="42f4" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">输出:</strong></p><p id="a579" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">输入某物(' q '退出):Hi <br/>你输入Hi <br/>输入某物(' q '退出):hello<br/>你输入hello<br/>输入某物(' q '退出):1 q</p></div><div class="ab cl jl jm gp jn" role="separator"><span class="jo bw bk jp jq jr"/><span class="jo bw bk jp jq jr"/><span class="jo bw bk jp jq"/></div><div class="hb hc hd he hf"><p id="d4c5" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在这种情况下，我们只需要两行代码，少了一个if语句和一个变量。</p><h2 id="e23b" class="kb kc hi bd kh ki kj kk kl km kn ko kp ix kq kr ks jb kt ku kv jf kw kx ky kz bi translated">实施例2</h2><p id="f261" class="pw-post-body-paragraph im in hi io b ip lk ir is it ll iv iw ix lm iz ja jb ln jd je jf lo jh ji jj hb bi translated">使用walrus运算符的另一个例子是在列表理解中。我们不仅可以使用它使它漂亮或花哨，而且还可以使用它提高执行速度，减少执行时间。假设我们有一个数字列表，我们有处理数字的函数。这只是一个简单的函数，但作为一个复杂的算法，它需要大量的时间来得出结果。所以，如果我传递一个数字，我需要3到5秒才能得到结果。</p></div><div class="ab cl jl jm gp jn" role="separator"><span class="jo bw bk jp jq jr"/><span class="jo bw bk jp jq jr"/><span class="jo bw bk jp jq"/></div><div class="hb hc hd he hf"><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="d416" class="kb kc hi jx b fi kd ke l kf kg">numbers = [5, 6, 13, 53, 191, 9, 35, 456, 201]</span><span id="f1cf" class="kb kc hi jx b fi lp ke l kf kg">def complicated_algorithm(num):<br/>    return ((num * 12) / 2) + 3<br/>    <br/>my_result = [complicated_algorithm(x) for x in numbers complicated_algorithm(x) &lt; 100]</span></pre></div><div class="ab cl jl jm gp jn" role="separator"><span class="jo bw bk jp jq jr"/><span class="jo bw bk jp jq jr"/><span class="jo bw bk jp jq"/></div><div class="hb hc hd he hf"><p id="aaa8" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们可以看到这样的问题，我们调用了两次参数个数相同的函数，但不是每次都调用，因为我只在满足条件的情况下执行complexized _ algorithm(x)(在for循环之前)，如果满足条件，我必须再次调用函数，因为我没有存储结果。因为这是一个复杂的算法，我们不想因为过于频繁地调用这个函数而浪费大量的时间。</p><p id="61a6" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">所以我们能做的是，使用海象算子。我们可以保存if语句中complexified _ algorithm(x)的结果，并使用该结果将结果添加到数组中，而不是调用该函数两次。</p></div><div class="ab cl jl jm gp jn" role="separator"><span class="jo bw bk jp jq jr"/><span class="jo bw bk jp jq jr"/><span class="jo bw bk jp jq"/></div><div class="hb hc hd he hf"><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="b14d" class="kb kc hi jx b fi kd ke l kf kg">numbers = [5, 6, 13, 53, 191, 9, 35, 456, 201]</span><span id="a5be" class="kb kc hi jx b fi lp ke l kf kg">def complicated_algorithm(num):<br/>    return ((num * 12) / 2) + 3</span><span id="9e22" class="kb kc hi jx b fi lp ke l kf kg">my_result = [result for x in numbers if (result := complicated_algorithm(x)) &lt; 100]</span></pre></div><div class="ab cl jl jm gp jn" role="separator"><span class="jo bw bk jp jq jr"/><span class="jo bw bk jp jq jr"/><span class="jo bw bk jp jq"/></div><div class="hb hc hd he hf"><p id="bc8c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">如果x小于100，Walrus操作符将处理它，因为它已经计算了全部结果，只是为了查看它是否小于100。为了避免浪费这个计算，我可以将结果保存在result变量中，然后将其作为结果插入到列表中。</p><p id="74ab" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在需要经常调用函数的复杂算法中使用这种walrus算子，可以减少执行时间，提高执行速度。我们来到了文章的结尾。很高兴坚持使用这篇文章。</p><h2 id="a7cf" class="kb kc hi bd kh ki kj kk kl km kn ko kp ix kq kr ks jb kt ku kv jf kw kx ky kz bi translated">结论</h2><p id="79c6" class="pw-post-body-paragraph im in hi io b ip lk ir is it ll iv iw ix lm iz ja jb ln jd je jf lo jh ji jj hb bi translated">在本文中，我们讨论了什么是walrus操作符，它的语法，以及如何使用它。在许多想要减少代码行数的场景中，walrus操作符就派上了用场。值得注意的是，没有括号 的海象运算符<strong class="io hj"> <em class="jk">会导致语法问题。为了防止歧义和误解，在某些情况下避免使用walrus操作符。</em></strong></p><h1 id="f913" class="lq kc hi bd kh lr ls lt kl lu lv lw kp lx ly lz ks ma mb mc kv md me mf ky mg bi translated">最后做的事</h1><p id="f88a" class="pw-post-body-paragraph im in hi io b ip lk ir is it ll iv iw ix lm iz ja jb ln jd je jf lo jh ji jj hb bi translated">希望你喜欢它并且学到了新的东西如果是这样，<em class="jk">一拍手👏而一跟着就会是</em> <strong class="io hj"> <em class="jk">🤩可行走的🤩</em></strong><em class="jk"/>有助于Medium推广这篇文章，让其他人也能阅读。<em class="jk">我是Jagajith，下一集再来抓你。</em></p><p id="9008" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">灵感来自:<a class="ae lj" href="https://www.youtube.com/watch?v=Ydn83ajuqX8" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/watch?v=Ydn83ajuqX8</a></p></div></div>    
</body>
</html>