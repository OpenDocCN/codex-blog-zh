<html>
<head>
<title>Managed and Unmanaged Code — Key Differences</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">托管和非托管代码—主要区别</h1>
<blockquote>原文：<a href="https://medium.com/codex/managed-and-unmanaged-code-key-differences-22fe9a7b3808?source=collection_archive---------10-----------------------#2021-05-18">https://medium.com/codex/managed-and-unmanaged-code-key-differences-22fe9a7b3808?source=collection_archive---------10-----------------------#2021-05-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/fb949e115318e99cdb45261752ccde68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aj1S9aIMj-l5oBTK_IYEsQ.jpeg"/></div></div></figure><p id="04ca" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这是我们之前关于不安全代码的博客的延续。在这篇博客中，我们将了解C#中托管代码和非托管代码的主要区别。非托管代码只不过是不安全的代码。</p><p id="4a91" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">回想一下，在C#中，代码通常是在。NET框架。CLR帮助运行代码，并提供各种服务来简化开发过程。由CLR控制的所有代码都被称为托管代码，而使用unsafe关键字编写的程序部分被称为非托管代码。这些都超出了CLR的控制范围。NET框架。</p><p id="87ae" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">目录</strong></p><ol class=""><li id="a38e" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated">C#中什么是托管代码？</li><li id="b586" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">托管代码的执行</li><li id="2593" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">托管代码的优势</li><li id="fb76" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">托管代码的缺点</li><li id="4ee0" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">什么是C#中的非托管代码？</li><li id="08d8" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">非托管代码的执行</li><li id="67c9" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">非托管代码的优势</li><li id="acad" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">非托管代码的缺点</li><li id="744d" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">托管代码和非托管代码之间的区别</li><li id="d378" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">结论</li></ol><h1 id="d503" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">C#中什么是托管代码？</h1><p id="6c8c" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">正如我们在开始时所看到的，使用。NET framework被称为托管代码。换句话说，它是在C#中直接执行的代码。托管代码的运行时环境为程序员提供了各种服务。提供的服务有异常处理、垃圾收集、类型检查等。上述服务自动提供给程序员。除了上述服务，运行时环境还提供内存分配、对象处理、对象创建等。</p><h1 id="0776" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">托管代码的执行</h1><p id="7e63" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">托管代码总是由CLR编译成一种称为MSIL的中间语言，然后创建代码的可执行文件。当程序员运行可执行程序时，源代码中的中间语言(MSIL)由名为“实时编译器”的编译器编译。在这里，整个过程是在运行时环境下进行的，因此运行时环境是程序工作背后的原因。</p><h1 id="c80d" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">托管代码的优势</h1><ul class=""><li id="a1f9" class="jo jp hi is b it la ix lb jb lf jf lg jj lh jn li ju jv jw bi translated">代码的安全性得到了提高，因为我们使用了运行时环境，它通过检查内存缓冲区来防止缓冲区溢出。</li><li id="9460" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn li ju jv jw bi translated">垃圾收集是自动实现的。</li><li id="90ba" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn li ju jv jw bi translated">还提供了动态类型检查或运行时类型检查</li><li id="0707" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn li ju jv jw bi translated">运行时环境也做引用检查。它检查对象的参考点是否有效，还检查复制对象是否存在。</li></ul><h1 id="3c04" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">托管代码的缺点</h1><ul class=""><li id="d228" class="jo jp hi is b it la ix lb jb lf jf lg jj lh jn li ju jv jw bi translated">不能直接分配内存。</li><li id="c985" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn li ju jv jw bi translated">在托管代码中，无法获得对CPU体系结构的低级访问。</li></ul><h1 id="d87a" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">什么是C#中的非托管代码？</h1><p id="240b" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">非托管代码也称为不安全代码。非托管代码依赖于计算机体系结构，因为它面向处理器体系结构。在C#中，管理堆栈、分配和释放内存等活动。由CLR负责，因此这些活动超出了程序员的权限。程序员告诉编译器，当他/她使用关键字“不安全”时，代码的管理将由他/她来完成。然而，如果程序员编写了糟糕的代码，可能会发生像内存泄漏这样的问题。</p><h1 id="44e2" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">非托管代码的执行</h1><p id="f020" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">为了执行非托管代码，C#中使用包装类。在C#中，非托管代码由操作系统直接执行。通常，非托管或不安全代码的可执行文件以二进制映像的形式加载到内存中。代码的执行步骤可以在上图中看到。</p><h1 id="1124" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">非托管代码的优势</h1><ul class=""><li id="d6d5" class="jo jp hi is b it la ix lb jb lf jf lg jj lh jn li ju jv jw bi translated">不安全代码增加了程序的稳定性和性能</li><li id="8446" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn li ju jv jw bi translated">提供了对编程器的低级访问</li><li id="bbe0" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn li ju jv jw bi translated">不安全代码提供了与内存交互的媒介</li></ul><h1 id="79f0" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">非托管代码的缺点</h1><ul class=""><li id="6969" class="jo jp hi is b it la ix lb jb lf jf lg jj lh jn li ju jv jw bi translated">不为应用程序提供安全性</li><li id="e613" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn li ju jv jw bi translated">程序员必须进行异常处理</li><li id="3f80" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn li ju jv jw bi translated">没有垃圾收集的自动实现</li><li id="cb14" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn li ju jv jw bi translated">使用不安全的代码可能会导致在绕过类型检查时出现错误。</li></ul><h1 id="42f2" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">托管代码和非托管代码的区别？</h1><figure class="lk ll lm ln fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lj"><img src="../Images/8c1a43c36343db67caf23f40657ca537.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xoIixDyGXR_jy6wf"/></div></div></figure><ul class=""><li id="f79b" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn li ju jv jw bi translated">托管代码是由。而非托管或不安全代码由操作系统执行。</li><li id="2188" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn li ju jv jw bi translated">托管代码为代码提供安全性，而未损坏的代码会产生安全威胁。</li><li id="750f" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn li ju jv jw bi translated">在不安全或非托管代码中，unsafe修饰符用于编写代码块，而在不安全代码块之外编写的任何其他代码都是托管代码。</li><li id="87a4" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn li ju jv jw bi translated">内存缓冲区溢出问题不会发生在托管代码中，因为它由运行时环境处理，但这些问题会发生在非托管代码中。</li><li id="81d3" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn li ju jv jw bi translated">运行时服务在托管代码中提供，而在非托管代码中不提供。</li><li id="ca54" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn li ju jv jw bi translated">源代码首先转换为中间语言，然后在托管代码中转换为本机语言，而在非托管代码中则直接转换为本机语言。</li><li id="090b" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn li ju jv jw bi translated">非托管代码提供低级访问，而托管代码不提供这种访问。</li><li id="ee3b" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn li ju jv jw bi translated">在不安全或非托管代码中，unsafe修饰符用于编写代码块，而在不安全代码块之外编写的任何其他代码都是托管代码。</li></ul><h1 id="0849" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">结论</h1><p id="68bd" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">本文让您深入了解C#中的托管和非托管代码。本文演示了每种代码的执行流程，这有助于您理解在开发任何类型的应用程序时如何正确使用这些代码。</p></div><div class="ab cl lo lp gp lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="hb hc hd he hf"><p id="4eab" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="lv">原载于</em><a class="ae lw" href="https://www.partech.nl/nl/publicaties/2021/03/managed-and-unmanaged-code---key-differences" rel="noopener ugc nofollow" target="_blank"><em class="lv">https://www . partech . nl</em></a><em class="lv">。</em></p></div></div>    
</body>
</html>