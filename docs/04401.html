<html>
<head>
<title>Detect Failing Servers on a Network using Anomaly Detection!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ä½¿ç”¨å¼‚å¸¸æ£€æµ‹æ¥æ£€æµ‹ç½‘ç»œä¸Šçš„æ•…éšœæœåŠ¡å™¨ï¼</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/codex/detect-failing-servers-on-a-network-using-anomaly-detection-1c447bc8a46a?source=collection_archive---------6-----------------------#2021-11-28">https://medium.com/codex/detect-failing-servers-on-a-network-using-anomaly-detection-1c447bc8a46a?source=collection_archive---------6-----------------------#2021-11-28</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/2169402578c79ab6fb73f9e36756d2d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vjysj1MwVIUTyP8up7Ujgg.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><a class="ae iu" href="https://zindpublic.blob.core.windows.net/public/uploads/blog_post/image/17/big_thumb_4d7a83bc-af4a-4912-81b2-8b95d4b08322.jpg" rel="noopener ugc nofollow" target="_blank">æ¥æº</a></figcaption></figure><p id="cad6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">å¤§å®¶å¥½ï¼ä½ è¿‡å¾—æ€ä¹ˆæ ·ï¼Ÿåœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†è®¨è®ºå¼‚å¸¸æ£€æµ‹ï¼Œå¹¶å‘æ‚¨å±•ç¤ºå¦‚ä½•åº”ç”¨å®ƒæ¥æ£€æµ‹ç½‘ç»œä¸Šå‡ºç°æ•…éšœçš„æœåŠ¡å™¨ã€‚æ‰€ä»¥ï¼Œäº‹ä¸å®œè¿Ÿï¼Œæˆ‘ä»¬å¼€å§‹å§ã€‚</p><h2 id="2bca" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">å¼‚å¸¸æ£€æµ‹</h2><p id="f404" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">å¼‚å¸¸æ£€æµ‹æ˜¯æŒ‡å‘ç°<strong class="ix hj">ä¸å¯»å¸¸çš„äº‹æƒ…ã€äº‹ä»¶æˆ–è§‚å¯Ÿç»“æœ</strong>ï¼Œè¿™äº›äº‹æƒ…ã€äº‹ä»¶æˆ–è§‚å¯Ÿç»“æœä¼šå¼•èµ·å…³æ³¨ï¼Œå› ä¸ºå®ƒä»¬ä¸å…¶ä»–æ•°æ®æœ‰å¾ˆå¤§å·®å¼‚ã€‚</p><h2 id="d716" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">å•†ä¸šä¸–ç•Œä¸­å¼‚å¸¸æ£€æµ‹çš„ä¾‹å­</h2><ul class=""><li id="4100" class="kt ku hi ix b iy ko jc kp jg kv jk kw jo kx js ky kz la lb bi translated">å…¥ä¾µæ£€æµ‹ï¼Œä¾‹å¦‚è¯†åˆ«ç½‘ç»œæµé‡ä¸­çš„å¥‡æ€ªæ¨¡å¼(è¿™å¯èƒ½æ˜¯é»‘å®¢æ”»å‡»çš„ä¿¡å·)ã€‚</li><li id="f211" class="kt ku hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated">åŒ»é™¢å¥åº·ç›‘æ§ç³»ç»Ÿã€‚</li><li id="7466" class="kt ku hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated">é“¶è¡Œä¿¡ç”¨å¡äº¤æ˜“ä¸­çš„æ¬ºè¯ˆæ£€æµ‹ã€‚</li><li id="d05b" class="kt ku hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated">æ“ä½œç¯å¢ƒä¸­çš„æ•…éšœæ£€æµ‹ã€‚</li><li id="cd1d" class="kt ku hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated">æ£€æµ‹äº’è”ç½‘ä¸Šçš„å‡æ–°é—»å’Œé”™è¯¯ä¿¡æ¯ã€‚</li><li id="bb9a" class="kt ku hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated">è¡Œä¸šæŸå®³æ£€æµ‹ã€‚</li><li id="c947" class="kt ku hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated">å®‰å…¨å’Œç›‘æ§ã€‚</li></ul><p id="2ff7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†ä½¿ç”¨é«˜æ–¯æ¨¡å‹æ¥æ£€æµ‹å¼‚å¸¸çš„ä¾‹å­ã€‚æˆ‘å°†ä»2Dæ•°æ®é›†å¼€å§‹ã€‚åœ¨æ•°æ®é›†ä¸Šï¼Œæˆ‘å°†æ‹Ÿåˆé«˜æ–¯åˆ†å¸ƒï¼Œç„¶åæ‰¾å‡ºå¼‚å¸¸ã€‚</p><p id="1679" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">è®©æˆ‘ä»¬å¯¼å…¥å¿…è¦çš„åŒ…:</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="3268" class="jt ju hi lm b fi lq lr l ls lt">import numpy as np<br/>import pandas as pd<br/>import matplotlib.pyplot as plt<br/>from scipy.io import loadmat</span></pre><p id="0f4c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">è®©æˆ‘ä»¬å¿«é€ŸåŠ è½½æ•°æ®é›†å¹¶å°†å…¶å¯è§†åŒ–ï¼Œ</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="26ab" class="jt ju hi lm b fi lq lr l ls lt">mat = loadmat('ex8data1.mat')<br/>X = mat['X']<br/>Xval = mat['Xval']<br/>yval = mat['yval']</span><span id="72da" class="jt ju hi lm b fi lu lr l ls lt">plt.scatter(X[:, 0], X[:, 1], marker='x', alpha=0.5)<br/>plt.xlim(0,30)<br/>plt.ylim(0,30)<br/>plt.xlabel("Latency (ms)")<br/>plt.ylabel("Throughput (mb/s)")</span></pre><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es lv"><img src="../Images/24294fccf521ecb499ac800cf2aeffdd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1012/format:webp/1*8_qErfGuC9ZN6mjuR29rpA.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">è¾“å‡º</figcaption></figure><p id="f8ad" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">æˆ‘ä»¬ä½¿ç”¨<strong class="ix hj">å»¶è¿Ÿ</strong>å’Œ<strong class="ix hj">ååé‡</strong>æ¥æ£€æµ‹ç½‘ç»œä¸Šçš„æ•…éšœæœåŠ¡å™¨ï¼Œå› ä¸ºæˆ‘ä»¬æ­£åœ¨å¯»æ‰¾å®ƒä»¬ã€‚æˆ‘ä»¬å¯ä»¥ä»ä¸Šé¢çš„è¾“å‡ºä¸­æ³¨æ„åˆ°å®ƒæœ‰ä¸€äº›å¼‚å¸¸ã€‚åœ¨æœ¬æ–‡çš„æœ€åï¼Œæˆ‘ä»¬ä¼šå‘ç°è¿™æ ·çš„å¼‚å¸¸ã€‚</p><p id="c3a6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">æˆ‘ä½¿ç”¨é«˜æ–¯æ¨¡å‹æ¥å‘ç°å¼‚å¸¸ï¼Œå¦‚æœä½ æ“…é•¿ç»Ÿè®¡ï¼Œä½ å¯ä»¥è·³è¿‡ä¸‹ä¸€éƒ¨åˆ†ã€‚å¦‚æœä½ å·²ç»<strong class="ix hj">å¿˜è®°</strong>ä»€ä¹ˆæ˜¯<strong class="ix hj">é«˜æ–¯åˆ†å¸ƒ</strong>ï¼Œæˆ–è€…ä½ ä¸çŸ¥é“å®ƒæ˜¯ä»€ä¹ˆï¼Œé‚£å°±ç»§ç»­è¯»ä¸‹å»ã€‚è€Œä¸”ä½ ä¸éœ€è¦äº†è§£å¤ªå¤šå°±å¯ä»¥ä½¿ç”¨å®ƒï¼Œä¹Ÿä¸éœ€è¦è®°ä½å…¬å¼ã€‚æ‰€ä»¥ä¸ç”¨æ‹…å¿ƒã€‚</p><h2 id="869d" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">é«˜æ–¯åˆ†å¸ƒ(æ­£æ€åˆ†å¸ƒ)</h2><p id="52fa" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">æ¯”å¦‚è¯´x âˆˆ â„ï¼Œå¦‚æœxæ˜¯ä¸€ä¸ªå‡å€¼ä¸º<strong class="ix hj">Î¼ï¼Œæ–¹å·®ä¸º<strong class="ix hj">Ïƒçš„åˆ†å¸ƒé«˜æ–¯ã€‚</strong></strong></p><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es lw"><img src="../Images/94fe5eddce27145aa99d108fa0de949a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1384/format:webp/1*DZjr7GZeWiPJ4oAtF5ulqQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">è¯¯å·®æ›²çº¿</figcaption></figure><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es lx"><img src="../Images/870b2187f4931f1050d79df074988706.png" data-original-src="https://miro.medium.com/v2/resize:fit:886/format:webp/1*9ThLyIKtfOkkQEMOseBL2w.png"/></div></figure><p id="3521" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">ä»ä¸Šé¢çš„å…¬å¼æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œè¦ç»˜åˆ¶é«˜æ–¯æ›²çº¿ï¼Œæˆ‘ä»¬éœ€è¦<strong class="ix hj"> Î¼ </strong>å’Œ<strong class="ix hj"> Ïƒ </strong>æ¥å¯»æ‰¾<strong class="ix hj">å‚æ•°</strong>ï¼Œ</p><p id="9f54" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">å‡è®¾æ•°æ®é›†åŒ…å«{xâ½ â¾ã€xâ½ â¾ã€â€¦ã€xâ½áµâ¾}ã€xâ½â±â¾ âˆˆ â„.</p><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es ly"><img src="../Images/a898cfb6994b7a1cd115dc72c7a59d7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1282/format:webp/1*_Bpkhvzr5QmYasEg3BruKA.png"/></div></figure><p id="0861" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">è¿™é‡Œæ©™è‰²Xä»£è¡¨æ•°æ®ç‚¹ï¼ŒÎ¼æ˜¯è¿™äº›æ•°æ®ç‚¹çš„å¹³å‡å€¼ï¼Œæ–¹å·®æ˜¯è¿™äº›ç‚¹çš„æ ‡å‡†åå·®ã€‚è®¡ç®—å¹³å‡å€¼å’Œæ–¹å·®çš„å…¬å¼å¦‚ä¸‹:</p><h2 id="0f7e" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">å‚æ•°ä¼°è®¡</h2><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lz"><img src="../Images/6e76bf4cfb7e21f7d24d5615526d6683.png" data-original-src="https://miro.medium.com/v2/resize:fit:550/format:webp/1*Ue7zLfVkEwGbAHtrtExo8g.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">å‡å€¼å’Œæ–¹å·®</figcaption></figure><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="97d3" class="jt ju hi lm b fi lq lr l ls lt">def estimateGaussian(X):<br/>    m, n = X.shape<br/>    mu = (1/m) * np.sum(X, axis=0)<br/>    sigma2 = (1/m) * np.sum((X - mu)**2, axis=0)<br/>    return mu, sigma2</span></pre><p id="872f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">æˆ‘ä»¬ä½¿ç”¨å¯†åº¦ä¼°è®¡æ¥å‘ç°å¼‚å¸¸ã€‚</p><h2 id="5b52" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">å¯†åº¦ä¼°è®¡</h2><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ma"><img src="../Images/2c8068b598162db5140bc6a8aa585d3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q0HGoZ_hA2_JkUCyEureJA.png"/></div></div></figure><p id="4208" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">æˆ‘ä»¬é€šè¿‡å°†é«˜æ–¯æ›²çº¿å…¬å¼ä¸­çš„æ¯ä¸ªæ•°æ®ç‚¹ä»£å…¥æ‰€å¾—åˆ°çš„å€¼ç›¸ä¹˜å¾—åˆ°p(x)ã€‚å¤§å†™Ï€è¡¨ç¤ºä»xâ‚åˆ°xâ‚™.å–å„æ•°æ®ç‚¹çš„<strong class="ix hj">ä¹˜ç§¯</strong></p><h2 id="6e1e" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">åŸºäºé«˜æ–¯åˆ†å¸ƒçš„å¼‚å¸¸æ£€æµ‹ç®—æ³•</h2><ol class=""><li id="8bee" class="kt ku hi ix b iy ko jc kp jg kv jk kw jo kx js mb kz la lb bi translated">é€‰æ‹©åŠŸèƒ½xáµ¢ï¼›ä½ è®¤ä¸ºå¯èƒ½é¢„ç¤ºç€åå¸¸çš„ä¾‹å­ã€‚</li><li id="f50c" class="kt ku hi ix b iy lc jc ld jg le jk lf jo lg js mb kz la lb bi translated">æ‹Ÿåˆå‚æ•°Î¼â‚ï¼Œâ€¦ï¼ŒÎ¼â‚™å’ŒÏƒâ‚ï¼Œâ€¦ï¼ŒÏƒâ‚™</li></ol><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es mc"><img src="../Images/87c52edc48f1c4aaa94a56f7cbf0d736.png" data-original-src="https://miro.medium.com/v2/resize:fit:570/format:webp/1*LMEViJX-n8KRa6OzarTMeQ.png"/></div></figure><p id="127d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">3.ç»™å®šæ–°ç¤ºä¾‹xï¼Œè®¡ç®—p(x):</p><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es md"><img src="../Images/4e6cff98d63d14fbc9f0ae60f1d5c4c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/1*-J8cUECOx4uzl7n4SnDVPA.png"/></div></figure><p id="a63f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">4.å¼‚å¸¸è‹¥p(x) &lt; Îµ(threshold).</p><h2 id="7939" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">Algorithm Evaluation</h2><ol class=""><li id="6ce4" class="kt ku hi ix b iy ko jc kp jg kv jk kw jo kx js mb kz la lb bi translated">Fit the model p(x) on training set {xâ½Â¹â¾, xâ½Â²â¾, â€¦, xâ½áµâ¾}.</li><li id="f64b" class="kt ku hi ix b iy lc jc ld jg le jk lf jo lg js mb kz la lb bi translated">On a cross validation / test set example x, predict</li></ol><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es me"><img src="../Images/906fcf2db6eaacfbd5c6eb0970fef704.png" data-original-src="https://miro.medium.com/v2/resize:fit:804/format:webp/1*WO-x9Jqv9NrHj1YRDSxRWg.png"/></div></figure><p id="b07d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">3. Possible evaluation metrics:</p><ul class=""><li id="7222" class="kt ku hi ix b iy iz jc jd jg mf jk mg jo mh js ky kz la lb bi translated">(True, false) positive and negative,</li><li id="9caf" class="kt ku hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated">Precision / Recall</li><li id="b310" class="kt ku hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated">F1 Score</li></ul><p id="a4c3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">4. We can also use cross validation set to choose parameter Îµ.</p><p id="d793" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Sometimes, it is hard for gaussian distribution to find anomalies. So, we are going to use <strong class="ix hj"> <em class="mi">å¤šå…ƒé«˜æ–¯åˆ†å¸ƒ</em> </strong>ã€‚</p><h2 id="4bb8" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">å¤šå…ƒé«˜æ–¯åˆ†å¸ƒ</h2><p id="25c9" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">åœ¨è¿™é¡¹æŠ€æœ¯ä¸­ï¼Œæˆ‘ä»¬ä¸é‡‡å–p(xâ‚)ï¼Œâ€¦ç­‰ã€‚ï¼Œåˆ†å¼€ã€‚å–è€Œä»£ä¹‹çš„æ˜¯æˆ‘ä»¬ä¸€æ¬¡å°±å¾—åˆ°p(x)ã€‚</p><ul class=""><li id="9664" class="kt ku hi ix b iy iz jc jd jg mf jk mg jo mh js ky kz la lb bi translated">å‡è®¾x âˆˆ â„ï¼Œä¸è¦æ¨¡ä»¿p(xâ‚)ï¼Œâ€¦ç­‰ç­‰ã€‚ï¼Œåˆ†å¼€ã€‚</li><li id="182d" class="kt ku hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated">å‹å·p(x)ä¸€æ°”å‘µæˆã€‚</li><li id="4477" class="kt ku hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated">å‚æ•°:Î¼ âˆˆ â„â¿ï¼ŒÏƒâˆˆâ„â¿Ë£â¿ï¼›è¿™é‡ŒÏƒä»£è¡¨<strong class="ix hj">åæ–¹å·®çŸ©é˜µ</strong>ï¼Œç§°ä¸º<strong class="ix hj">èµ„æœ¬é€‚é©¬ã€‚</strong></li></ul><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es mj"><img src="../Images/002932437dfd225a3057008bc9e01188.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/format:webp/1*HoG0AzOgFjLmZaOUWdVb_A.png"/></div></figure><h2 id="aceb" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">ç®—æ³•</h2><ol class=""><li id="6866" class="kt ku hi ix b iy ko jc kp jg kv jk kw jo kx js mb kz la lb bi translated">é€šè¿‡è®¾ç½®æ¥æ‹Ÿåˆæ¨¡å‹p(x ):</li></ol><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es mk"><img src="../Images/a61d56370363231f9d3d541a08465493.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/1*uOhKt6_6duxWGPjevCcBxQ.png"/></div></figure><p id="f509" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">2.ç»™å®šä¸€ä¸ªæ–°çš„ä¾‹å­xï¼Œè®¡ç®—p(x)ã€‚</p><p id="326e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">3.æ ‡å¿—ä¸€ä¸ªå¼‚å¸¸å¦‚æœp(x) </p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="4173" class="jt ju hi lm b fi lq lr l ls lt">def multivariateGaussian(X, mu, sigma2):<br/>    k = len(mu)<br/>    sigma2 = np.diag(sigma2)<br/>    X = X - mu.T<br/>    p = 1/ ((2*np.pi)**(k/2) * (np.linalg.det(sigma2)**0.5)) * np.exp( -0.5 * np.sum(X @ np.linalg.pinv(sigma2) * X, axis=1))<br/>    return p</span><span id="a68b" class="jt ju hi lm b fi lu lr l ls lt">mu, sigma2 = estimateGaussian(X)<br/>p = multivariateGaussian(X, mu, sigma2)</span><span id="81c7" class="jt ju hi lm b fi lu lr l ls lt"># Visualize Distribution</span><span id="12e9" class="jt ju hi lm b fi lu lr l ls lt">plt.figure(figsize=(8,6))<br/>plt.scatter(X[:,0], X[:,1],marker="x")<br/>X1, X2 = np.meshgrid(np.linspace(0, 35, num=71), np.linspace(0, 35, num=71))<br/>p2 = multivariateGaussian(np.column_stack((X1.flatten().reshape(-1, 1), X2.flatten().reshape(-1, 1))), mu, sigma2)<br/>contour_level = np.power(10, np.array([np.arange(-20, 0, 3, dtype=np.float)]))[0]<br/>plt.contour(X1, X2, p2.reshape(X1.shape), contour_level)<br/>plt.xlim(0,35)<br/>plt.ylim(0,35)<br/>plt.xlabel("Latency (ms)")<br/>plt.ylabel("Throughput (mb/s)")</span></pre><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es ml"><img src="../Images/4503a9898af46119d4fc4da6e346e91f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1296/format:webp/1*yJgGbwqDrrtA-QORi4PHFQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">Output</figcaption></figure><p id="2dc0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">From the above output, we can see that it has done some pretty distribution.</p><p id="c2ba" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Now that we have calculated the Gaussian Distribution parameters, we can explore which examples have a very high probability and which examples have a very low probability given this distribution. The examples with a low likelihood are more likely to be anomalies. Selecting a threshold based on a cross validation set is one method for determining whether examples are anomalies.</p><h2 id="cc52" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">Select Threshold</h2><p id="e892" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">I am not going in too detail about how to select threshold. So, I will give a link to the video, if you want to know more about it.</p><p id="2a5a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><a class="ae iu" href="https://www.youtube.com/watch?v=k1JGvqr56Yk&amp;list=PLLssT5z_DsK-h9vYZkQkYNWcItqhlRJLN&amp;index=66" rel="noopener ugc nofollow" target="_blank"> <strong class="ix hj">é“¾æ¥1 </strong> </a>ï¼Œ<a class="ae iu" href="https://www.youtube.com/watch?v=wGw6R8AbcuI&amp;list=PLLssT5z_DsK-h9vYZkQkYNWcItqhlRJLN&amp;index=67" rel="noopener ugc nofollow" target="_blank"> <strong class="ix hj">é“¾æ¥2 </strong> </a>ï¼Œ<a class="ae iu" href="https://www.youtube.com/watch?v=W5meQnGACGo&amp;list=PLLssT5z_DsK-h9vYZkQkYNWcItqhlRJLN&amp;index=68" rel="noopener ugc nofollow" target="_blank"> <strong class="ix hj">é“¾æ¥3 </strong> </a>ï¼Œ<a class="ae iu" href="https://www.youtube.com/watch?v=5T77nG7YJhk&amp;list=PLLssT5z_DsK-h9vYZkQkYNWcItqhlRJLN&amp;index=69" rel="noopener ugc nofollow" target="_blank"> <strong class="ix hj">é“¾æ¥4 </strong> </a></p><p id="621a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">æˆ‘ä»¬ä½¿ç”¨äº¤å‰éªŒè¯é›†ï¼Œå…¶ä¸­æ ‡ç­¾y=1å¯¹åº”äºå¼‚å¸¸ç¤ºä¾‹ï¼Œy=0å¯¹åº”äºæ­£å¸¸ç¤ºä¾‹ã€‚å¯¹äºæ¯ä¸ªäº¤å‰éªŒè¯çš„ä¾‹å­ï¼Œæˆ‘ä»¬è®¡ç®—p(x_cvâ½â±â¾).æ‰€æœ‰å¯èƒ½æ€§çš„å‘é‡è¢«ä¼ é€’åˆ°ä¸€ä¸ªå‡½æ•°ä¸­ï¼Œç›¸åº”çš„æ ‡ç­¾ä¹Ÿè¢«ä¼ é€’åˆ°è¯¥å‡½æ•°ä¸­ï¼Œè¯¥å‡½æ•°è¿”å›ä¸¤ä¸ªå€¼Îµå’ŒF1 scoreã€‚</p><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es mm"><img src="../Images/136e38e3b3ca7cc13fa520dca9ce52e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1014/format:webp/1*pgqiuvbfDm46H0zQjd_46w.png"/></div></figure><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="5858" class="jt ju hi lm b fi lq lr l ls lt">def selectThreshold(yval, pval):<br/>    bestEpsilon = 0<br/>    bestF1 = 0<br/>    step = (max(pval) - min(pval))/1000<br/>    epi_range = np.arange(min(pval), max(pval), step)<br/>    for epsilon in epi_range:<br/>        <br/>        predictions = (pval &lt; epsilon).reshape(-1, 1)<br/>        <br/>        true_positive = np.sum(predictions[yval==1]==1)<br/>        false_positive = np.sum(predictions[yval==0]==1)<br/>        false_negative = np.sum(predictions[yval==1]==0)<br/>        <br/>        precision = true_positive / (true_positive + false_positive)<br/>        recall = true_positive / (true_positive + false_negative)<br/>        <br/>        F1 = (2*precision*recall)/(precision + recall)<br/>        <br/>        if F1 &gt; bestF1:<br/>            bestF1 = F1<br/>            bestEpsilon = epsilon<br/>    return bestEpsilon,  bestF1</span><span id="86fe" class="jt ju hi lm b fi lu lr l ls lt">pval = multivariateGaussian(Xval, mu, sigma2)<br/>epsilon, F1 = selectThreshold(yval, pval)<br/>print("Best epsilon found using cross-validation:",epsilon)<br/>print("Best F1 on Cross Validation Set:",F1)</span></pre><p id="eb9f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">é€‰æ‹©å¥½é˜ˆå€¼åï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ•°æ®é›†ä¸­çš„æ•…éšœæœåŠ¡å™¨ã€‚</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="da0e" class="jt ju hi lm b fi lq lr l ls lt">plt.figure(figsize=(8,6))<br/><br/>plt.scatter(X[:,0],X[:,1],marker="x")<br/><br/>X1,X2 = np.meshgrid(np.linspace(0,35,num=70),np.linspace(0,35,num=70))<br/>p2 = multivariateGaussian(np.hstack((X1.flatten()[:,np.newaxis],X2.flatten()[:,np.newaxis])), mu, sigma2)<br/>contour_level = 10**np.array([np.arange(-20,0,3,dtype=np.float)])[0]<br/>plt.contour(X1,X2,p2[:,np.newaxis].reshape(X1.shape),contour_level)<br/><br/>outliers = np.nonzero(p&lt;epsilon)[0]<br/>plt.scatter(X[outliers,0],X[outliers,1],marker ="o",facecolor="none",edgecolor="r",s=70)<br/><br/>plt.xlim(0,35)<br/>plt.ylim(0,35)<br/>plt.xlabel("Latency (ms)")<br/>plt.ylabel("Throughput (mb/s)")</span></pre><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es md"><img src="../Images/d3b2652cef6e352d090811e33b450f75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/1*0d-TSN9PgJlWAasBhHnANw.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">è¾“å‡º</figcaption></figure><h2 id="9089" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">å¥–é‡‘éƒ¨åˆ†</h2><p id="5d85" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">åœ¨è¿™ä¸ªé¢å¤–çš„éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†åœ¨ä¸€ä¸ªæ›´çœŸå®ã€æ›´å›°éš¾çš„æ•°æ®é›†ä¸Šè¿è¡Œå¼‚å¸¸æ£€æµ‹ç®—æ³•ã€‚åœ¨è¯¥æ•°æ®é›†ä¸­ï¼Œæ¯ä¸ªç¤ºä¾‹ç”±11ä¸ªç‰¹å¾æè¿°ï¼Œæ•è·è®¡ç®—æœºæœåŠ¡å™¨çš„æ›´å¤šå±æ€§ã€‚</p><p id="7b1b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">è®©æˆ‘ä»¬åŠ è½½æ•°æ®é›†å¹¶è·å¾—å‚æ•°Î¼å’ŒÏƒ:</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="bc84" class="jt ju hi lm b fi lq lr l ls lt">mat2 = loadmat("ex8data2.mat")<br/>X2 = mat2["X"]<br/>Xval2 = mat2["Xval"]<br/>yval2 = mat2["yval"]</span><span id="7950" class="jt ju hi lm b fi lu lr l ls lt">mu2, sigma2_2 = estimateGaussian(X2)</span></pre><p id="b79f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">ç°åœ¨ï¼Œè®©æˆ‘ä»¬å°†é«˜æ–¯åˆ†å¸ƒæ‹Ÿåˆåˆ°æˆ‘ä»¬çš„æ•°æ®é›†ï¼Œå¹¶æ£€æµ‹å…¶ä¸­çš„å¼‚å¸¸æ•°é‡:</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="0cf5" class="jt ju hi lm b fi lq lr l ls lt">p3 = multivariateGaussian(X2, mu2, sigma2_2)<br/><br/>pval2 = multivariateGaussian(Xval2, mu2, sigma2_2)<br/><br/>epsilon2, F1_2 = selectThreshold(yval2, pval2)<br/>print("Best epsilon found using cross-validation:",epsilon2)<br/>print("Best F1 on Cross Validation Set:",F1_2)<br/>print("# Outliers found:",np.sum(p3&lt;epsilon2))</span></pre><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es mn"><img src="../Images/800ac97f0b82d1ba3fdf2a9204ed73e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1290/format:webp/1*TcWdUGiu9ICYKcU0Wd77pQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">è¾“å‡º</figcaption></figure><p id="c6d5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">å®ƒåœ¨æˆ‘ä»¬çš„æ•°æ®é›†ä¸­å‘ç°äº†117å°æ•…éšœæœåŠ¡å™¨ã€‚åœ¨æ–°çš„ä¾‹å­xä¸­ï¼Œå®ƒéå¸¸å–„äºå‘ç°ã€‚</p><h2 id="a789" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">ç»“è®º</h2><p id="ea6e" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆäº†è§£ä»€ä¹ˆæ˜¯å¼‚å¸¸æ£€æµ‹ï¼Œç„¶åæ·±å…¥ç ”ç©¶é«˜æ–¯åˆ†å¸ƒï¼Œæˆ‘ä»¬å‘ç°äº†ä¸€ç§æ¯”é«˜æ–¯åˆ†å¸ƒæ›´å¼ºå¤§çš„å¤šå…ƒé«˜æ–¯åˆ†å¸ƒ(MGD ),æˆ‘ä»¬å°†å…¶æ‹Ÿåˆåˆ°æˆ‘ä»¬çš„æ•°æ®é›†ï¼Œä¹‹åæˆ‘ä»¬æ‰¾åˆ°äº†ä¸€ä¸ªå¥½çš„é˜ˆå€¼å¹¶å¯è§†åŒ–æˆ‘ä»¬çš„å¼‚å¸¸ã€‚åœ¨æˆ‘ä»¬çš„å¥–é‡‘éƒ¨åˆ†ï¼Œæˆ‘ä»¬æ‹Ÿåˆæˆ‘ä»¬çš„æ•°æ®é›†ï¼Œæœ‰æ¯”ä»¥å‰æ›´å¤æ‚çš„æ•°æ®é›†ï¼Œä½¿ç”¨MGDã€‚æœ€åï¼Œæˆ‘ä»¬åœ¨æ•°æ®é›†ä¸­æ‰¾åˆ°äº†ä¸€äº›ç¦»ç¾¤ç‚¹ã€‚æ•°æ®é›†å’Œæœ€ç»ˆä»£ç ä¸Šä¼ åˆ°Githubã€‚</p><p id="35d3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">ç‚¹å‡»æŸ¥çœ‹<a class="ae iu" href="https://github.com/jagajith23/Andrew-Ng-s-Machine-Learning-in-Python/tree/gh-pages/Anomaly%20Detection%20%26%20Recommender%20System" rel="noopener ugc nofollow" target="_blank">ã€‚</a></p><h1 id="82e4" class="mo ju hi bd jv mp mq mr jz ms mt mu kd mv mw mx kg my mz na kj nb nc nd km ne bi translated">å¦‚æœä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œé‚£ä¹ˆçœ‹çœ‹æˆ‘ä»¥å‰åœ¨è¿™ä¸ªç³»åˆ—ä¸­å…³äº</h1><h2 id="b506" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">1.<a class="ae iu" rel="noopener" href="/@jagajith23/what-is-machine-learning-daeac9a2ceca">ä»€ä¹ˆæ˜¯æœºå™¨å­¦ä¹ ï¼Ÿ</a></h2><h2 id="01ca" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">2.<a class="ae iu" rel="noopener" href="/codex/what-are-the-types-of-machine-learning-53360b7db8b4">æœºå™¨å­¦ä¹ æœ‰å“ªäº›ç±»å‹ï¼Ÿ</a></h2><h2 id="1fa7" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">3.<a class="ae iu" rel="noopener" href="/codex/linear-regression-on-single-variable-f35e6a73dab6">ä¸€å…ƒçº¿æ€§å›å½’</a></h2><h2 id="00a1" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">4.<a class="ae iu" rel="noopener" href="/codex/linear-regression-on-multiple-variables-1893e4d940b1">å¤šå…ƒçº¿æ€§å›å½’</a></h2><h2 id="0c3c" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">5.<a class="ae iu" rel="noopener" href="/codex/logistic-regression-eee2fd028ffd">é€»è¾‘å›å½’</a></h2><h2 id="a934" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">6.<a class="ae iu" rel="noopener" href="/@jagajith23/what-are-neural-networks-3a0965e2ebfb">ä»€ä¹ˆæ˜¯ç¥ç»ç½‘ç»œï¼Ÿ</a></h2><h2 id="b309" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">7.<a class="ae iu" rel="noopener" href="/codex/digit-classifier-using-neural-networks-ad17749a8f00">ä½¿ç”¨ç¥ç»ç½‘ç»œçš„æ•°å­—åˆ†ç±»å™¨</a></h2><h2 id="64d0" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">8.<a class="ae iu" rel="noopener" href="/codex/image-compression-with-k-means-clustering-48e989055729">åˆ©ç”¨Kå‡å€¼èšç±»çš„å›¾åƒå‹ç¼©</a></h2><h2 id="8b7f" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">9.<a class="ae iu" rel="noopener" href="/codex/dimensionality-reduction-on-face-using-pca-e3fec3bb4cee">ä½¿ç”¨PCAå¯¹äººè„¸è¿›è¡Œé™ç»´</a></h2><h1 id="1fc6" class="mo ju hi bd jv mp mq mr jz ms mt mu kd mv mw mx kg my mz na kj nb nc nd km ne bi translated">æœ€ååšçš„äº‹</h1><p id="b98d" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">å¦‚æœä½ å–œæ¬¢æˆ‘çš„æ–‡ç« ï¼Œè¯·é¼“æŒğŸ‘ä¸€ä¸ªè¿½éšè€…å°†ä¼šæ˜¯â¤ï¸freeï¸â¤ï¸and è¿™æœ‰åŠ©äºåª’ä½“æ¨å¹¿è¿™ç¯‡æ–‡ç« ï¼Œä»¥ä¾¿å…¶ä»–äººèƒ½å¤Ÿé˜…è¯»å®ƒã€‚<em class="mi">æˆ‘æ˜¯Jagajithï¼Œä¸‹ä¸€é›†å†æ¥æŠ“ä½ ã€‚</em></p></div></div>    
</body>
</html>