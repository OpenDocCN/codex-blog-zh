<html>
<head>
<title>Detect Failing Servers on a Network using Anomaly Detection!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用异常检测来检测网络上的故障服务器！</h1>
<blockquote>原文：<a href="https://medium.com/codex/detect-failing-servers-on-a-network-using-anomaly-detection-1c447bc8a46a?source=collection_archive---------6-----------------------#2021-11-28">https://medium.com/codex/detect-failing-servers-on-a-network-using-anomaly-detection-1c447bc8a46a?source=collection_archive---------6-----------------------#2021-11-28</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/2169402578c79ab6fb73f9e36756d2d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vjysj1MwVIUTyP8up7Ujgg.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><a class="ae iu" href="https://zindpublic.blob.core.windows.net/public/uploads/blog_post/image/17/big_thumb_4d7a83bc-af4a-4912-81b2-8b95d4b08322.jpg" rel="noopener ugc nofollow" target="_blank">来源</a></figcaption></figure><p id="cad6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">大家好！你过得怎么样？在本文中，我将讨论异常检测，并向您展示如何应用它来检测网络上出现故障的服务器。所以，事不宜迟，我们开始吧。</p><h2 id="2bca" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">异常检测</h2><p id="f404" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">异常检测是指发现<strong class="ix hj">不寻常的事情、事件或观察结果</strong>，这些事情、事件或观察结果会引起关注，因为它们与其他数据有很大差异。</p><h2 id="d716" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">商业世界中异常检测的例子</h2><ul class=""><li id="4100" class="kt ku hi ix b iy ko jc kp jg kv jk kw jo kx js ky kz la lb bi translated">入侵检测，例如识别网络流量中的奇怪模式(这可能是黑客攻击的信号)。</li><li id="f211" class="kt ku hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated">医院健康监控系统。</li><li id="7466" class="kt ku hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated">银行信用卡交易中的欺诈检测。</li><li id="d05b" class="kt ku hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated">操作环境中的故障检测。</li><li id="cd1d" class="kt ku hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated">检测互联网上的假新闻和错误信息。</li><li id="bb9a" class="kt ku hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated">行业损害检测。</li><li id="c947" class="kt ku hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated">安全和监控。</li></ul><p id="2ff7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在本文中，我将使用高斯模型来检测异常的例子。我将从2D数据集开始。在数据集上，我将拟合高斯分布，然后找出异常。</p><p id="1679" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们导入必要的包:</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="3268" class="jt ju hi lm b fi lq lr l ls lt">import numpy as np<br/>import pandas as pd<br/>import matplotlib.pyplot as plt<br/>from scipy.io import loadmat</span></pre><p id="0f4c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们快速加载数据集并将其可视化，</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="26ab" class="jt ju hi lm b fi lq lr l ls lt">mat = loadmat('ex8data1.mat')<br/>X = mat['X']<br/>Xval = mat['Xval']<br/>yval = mat['yval']</span><span id="72da" class="jt ju hi lm b fi lu lr l ls lt">plt.scatter(X[:, 0], X[:, 1], marker='x', alpha=0.5)<br/>plt.xlim(0,30)<br/>plt.ylim(0,30)<br/>plt.xlabel("Latency (ms)")<br/>plt.ylabel("Throughput (mb/s)")</span></pre><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es lv"><img src="../Images/24294fccf521ecb499ac800cf2aeffdd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1012/format:webp/1*8_qErfGuC9ZN6mjuR29rpA.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">输出</figcaption></figure><p id="f8ad" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们使用<strong class="ix hj">延迟</strong>和<strong class="ix hj">吞吐量</strong>来检测网络上的故障服务器，因为我们正在寻找它们。我们可以从上面的输出中注意到它有一些异常。在本文的最后，我们会发现这样的异常。</p><p id="c3a6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我使用高斯模型来发现异常，如果你擅长统计，你可以跳过下一部分。如果你已经<strong class="ix hj">忘记</strong>什么是<strong class="ix hj">高斯分布</strong>，或者你不知道它是什么，那就继续读下去。而且你不需要了解太多就可以使用它，也不需要记住公式。所以不用担心。</p><h2 id="869d" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">高斯分布(正态分布)</h2><p id="52fa" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">比如说x ∈ ℝ，如果x是一个均值为<strong class="ix hj">μ，方差为<strong class="ix hj">σ的分布高斯。</strong></strong></p><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es lw"><img src="../Images/94fe5eddce27145aa99d108fa0de949a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1384/format:webp/1*DZjr7GZeWiPJ4oAtF5ulqQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">误差曲线</figcaption></figure><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es lx"><img src="../Images/870b2187f4931f1050d79df074988706.png" data-original-src="https://miro.medium.com/v2/resize:fit:886/format:webp/1*9ThLyIKtfOkkQEMOseBL2w.png"/></div></figure><p id="3521" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">从上面的公式我们可以看出，要绘制高斯曲线，我们需要<strong class="ix hj"> μ </strong>和<strong class="ix hj"> σ </strong>来寻找<strong class="ix hj">参数</strong>，</p><p id="9f54" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">假设数据集包含{x⁽ ⁾、x⁽ ⁾、…、x⁽ᵐ⁾}、x⁽ⁱ⁾ ∈ ℝ.</p><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es ly"><img src="../Images/a898cfb6994b7a1cd115dc72c7a59d7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1282/format:webp/1*_Bpkhvzr5QmYasEg3BruKA.png"/></div></figure><p id="0861" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这里橙色X代表数据点，μ是这些数据点的平均值，方差是这些点的标准偏差。计算平均值和方差的公式如下:</p><h2 id="0f7e" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">参数估计</h2><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lz"><img src="../Images/6e76bf4cfb7e21f7d24d5615526d6683.png" data-original-src="https://miro.medium.com/v2/resize:fit:550/format:webp/1*Ue7zLfVkEwGbAHtrtExo8g.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">均值和方差</figcaption></figure><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="97d3" class="jt ju hi lm b fi lq lr l ls lt">def estimateGaussian(X):<br/>    m, n = X.shape<br/>    mu = (1/m) * np.sum(X, axis=0)<br/>    sigma2 = (1/m) * np.sum((X - mu)**2, axis=0)<br/>    return mu, sigma2</span></pre><p id="872f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们使用密度估计来发现异常。</p><h2 id="5b52" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">密度估计</h2><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ma"><img src="../Images/2c8068b598162db5140bc6a8aa585d3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q0HGoZ_hA2_JkUCyEureJA.png"/></div></div></figure><p id="4208" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们通过将高斯曲线公式中的每个数据点代入所得到的值相乘得到p(x)。大写π表示从x₁到xₙ.取各数据点的<strong class="ix hj">乘积</strong></p><h2 id="6e1e" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">基于高斯分布的异常检测算法</h2><ol class=""><li id="8bee" class="kt ku hi ix b iy ko jc kp jg kv jk kw jo kx js mb kz la lb bi translated">选择功能xᵢ；你认为可能预示着反常的例子。</li><li id="f50c" class="kt ku hi ix b iy lc jc ld jg le jk lf jo lg js mb kz la lb bi translated">拟合参数μ₁，…，μₙ和σ₁，…，σₙ</li></ol><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es mc"><img src="../Images/87c52edc48f1c4aaa94a56f7cbf0d736.png" data-original-src="https://miro.medium.com/v2/resize:fit:570/format:webp/1*LMEViJX-n8KRa6OzarTMeQ.png"/></div></figure><p id="127d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">3.给定新示例x，计算p(x):</p><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es md"><img src="../Images/4e6cff98d63d14fbc9f0ae60f1d5c4c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/1*-J8cUECOx4uzl7n4SnDVPA.png"/></div></figure><p id="a63f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">4.异常若p(x) &lt; ε(threshold).</p><h2 id="7939" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">Algorithm Evaluation</h2><ol class=""><li id="6ce4" class="kt ku hi ix b iy ko jc kp jg kv jk kw jo kx js mb kz la lb bi translated">Fit the model p(x) on training set {x⁽¹⁾, x⁽²⁾, …, x⁽ᵐ⁾}.</li><li id="f64b" class="kt ku hi ix b iy lc jc ld jg le jk lf jo lg js mb kz la lb bi translated">On a cross validation / test set example x, predict</li></ol><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es me"><img src="../Images/906fcf2db6eaacfbd5c6eb0970fef704.png" data-original-src="https://miro.medium.com/v2/resize:fit:804/format:webp/1*WO-x9Jqv9NrHj1YRDSxRWg.png"/></div></figure><p id="b07d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">3. Possible evaluation metrics:</p><ul class=""><li id="7222" class="kt ku hi ix b iy iz jc jd jg mf jk mg jo mh js ky kz la lb bi translated">(True, false) positive and negative,</li><li id="9caf" class="kt ku hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated">Precision / Recall</li><li id="b310" class="kt ku hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated">F1 Score</li></ul><p id="a4c3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">4. We can also use cross validation set to choose parameter ε.</p><p id="d793" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Sometimes, it is hard for gaussian distribution to find anomalies. So, we are going to use <strong class="ix hj"> <em class="mi">多元高斯分布</em> </strong>。</p><h2 id="4bb8" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">多元高斯分布</h2><p id="25c9" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">在这项技术中，我们不采取p(x₁)，…等。，分开。取而代之的是我们一次就得到p(x)。</p><ul class=""><li id="9664" class="kt ku hi ix b iy iz jc jd jg mf jk mg jo mh js ky kz la lb bi translated">假设x ∈ ℝ，不要模仿p(x₁)，…等等。，分开。</li><li id="182d" class="kt ku hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated">型号p(x)一气呵成。</li><li id="4477" class="kt ku hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated">参数:μ ∈ ℝⁿ，σ∈ℝⁿˣⁿ；这里σ代表<strong class="ix hj">协方差矩阵</strong>，称为<strong class="ix hj">资本适马。</strong></li></ul><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es mj"><img src="../Images/002932437dfd225a3057008bc9e01188.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/format:webp/1*HoG0AzOgFjLmZaOUWdVb_A.png"/></div></figure><h2 id="aceb" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">算法</h2><ol class=""><li id="6866" class="kt ku hi ix b iy ko jc kp jg kv jk kw jo kx js mb kz la lb bi translated">通过设置来拟合模型p(x ):</li></ol><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es mk"><img src="../Images/a61d56370363231f9d3d541a08465493.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/1*uOhKt6_6duxWGPjevCcBxQ.png"/></div></figure><p id="f509" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">2.给定一个新的例子x，计算p(x)。</p><p id="326e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">3.标志一个异常如果p(x) </p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="4173" class="jt ju hi lm b fi lq lr l ls lt">def multivariateGaussian(X, mu, sigma2):<br/>    k = len(mu)<br/>    sigma2 = np.diag(sigma2)<br/>    X = X - mu.T<br/>    p = 1/ ((2*np.pi)**(k/2) * (np.linalg.det(sigma2)**0.5)) * np.exp( -0.5 * np.sum(X @ np.linalg.pinv(sigma2) * X, axis=1))<br/>    return p</span><span id="a68b" class="jt ju hi lm b fi lu lr l ls lt">mu, sigma2 = estimateGaussian(X)<br/>p = multivariateGaussian(X, mu, sigma2)</span><span id="81c7" class="jt ju hi lm b fi lu lr l ls lt"># Visualize Distribution</span><span id="12e9" class="jt ju hi lm b fi lu lr l ls lt">plt.figure(figsize=(8,6))<br/>plt.scatter(X[:,0], X[:,1],marker="x")<br/>X1, X2 = np.meshgrid(np.linspace(0, 35, num=71), np.linspace(0, 35, num=71))<br/>p2 = multivariateGaussian(np.column_stack((X1.flatten().reshape(-1, 1), X2.flatten().reshape(-1, 1))), mu, sigma2)<br/>contour_level = np.power(10, np.array([np.arange(-20, 0, 3, dtype=np.float)]))[0]<br/>plt.contour(X1, X2, p2.reshape(X1.shape), contour_level)<br/>plt.xlim(0,35)<br/>plt.ylim(0,35)<br/>plt.xlabel("Latency (ms)")<br/>plt.ylabel("Throughput (mb/s)")</span></pre><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es ml"><img src="../Images/4503a9898af46119d4fc4da6e346e91f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1296/format:webp/1*yJgGbwqDrrtA-QORi4PHFQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">Output</figcaption></figure><p id="2dc0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">From the above output, we can see that it has done some pretty distribution.</p><p id="c2ba" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Now that we have calculated the Gaussian Distribution parameters, we can explore which examples have a very high probability and which examples have a very low probability given this distribution. The examples with a low likelihood are more likely to be anomalies. Selecting a threshold based on a cross validation set is one method for determining whether examples are anomalies.</p><h2 id="cc52" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">Select Threshold</h2><p id="e892" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">I am not going in too detail about how to select threshold. So, I will give a link to the video, if you want to know more about it.</p><p id="2a5a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><a class="ae iu" href="https://www.youtube.com/watch?v=k1JGvqr56Yk&amp;list=PLLssT5z_DsK-h9vYZkQkYNWcItqhlRJLN&amp;index=66" rel="noopener ugc nofollow" target="_blank"> <strong class="ix hj">链接1 </strong> </a>，<a class="ae iu" href="https://www.youtube.com/watch?v=wGw6R8AbcuI&amp;list=PLLssT5z_DsK-h9vYZkQkYNWcItqhlRJLN&amp;index=67" rel="noopener ugc nofollow" target="_blank"> <strong class="ix hj">链接2 </strong> </a>，<a class="ae iu" href="https://www.youtube.com/watch?v=W5meQnGACGo&amp;list=PLLssT5z_DsK-h9vYZkQkYNWcItqhlRJLN&amp;index=68" rel="noopener ugc nofollow" target="_blank"> <strong class="ix hj">链接3 </strong> </a>，<a class="ae iu" href="https://www.youtube.com/watch?v=5T77nG7YJhk&amp;list=PLLssT5z_DsK-h9vYZkQkYNWcItqhlRJLN&amp;index=69" rel="noopener ugc nofollow" target="_blank"> <strong class="ix hj">链接4 </strong> </a></p><p id="621a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们使用交叉验证集，其中标签y=1对应于异常示例，y=0对应于正常示例。对于每个交叉验证的例子，我们计算p(x_cv⁽ⁱ⁾).所有可能性的向量被传递到一个函数中，相应的标签也被传递到该函数中，该函数返回两个值ε和F1 score。</p><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es mm"><img src="../Images/136e38e3b3ca7cc13fa520dca9ce52e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1014/format:webp/1*pgqiuvbfDm46H0zQjd_46w.png"/></div></figure><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="5858" class="jt ju hi lm b fi lq lr l ls lt">def selectThreshold(yval, pval):<br/>    bestEpsilon = 0<br/>    bestF1 = 0<br/>    step = (max(pval) - min(pval))/1000<br/>    epi_range = np.arange(min(pval), max(pval), step)<br/>    for epsilon in epi_range:<br/>        <br/>        predictions = (pval &lt; epsilon).reshape(-1, 1)<br/>        <br/>        true_positive = np.sum(predictions[yval==1]==1)<br/>        false_positive = np.sum(predictions[yval==0]==1)<br/>        false_negative = np.sum(predictions[yval==1]==0)<br/>        <br/>        precision = true_positive / (true_positive + false_positive)<br/>        recall = true_positive / (true_positive + false_negative)<br/>        <br/>        F1 = (2*precision*recall)/(precision + recall)<br/>        <br/>        if F1 &gt; bestF1:<br/>            bestF1 = F1<br/>            bestEpsilon = epsilon<br/>    return bestEpsilon,  bestF1</span><span id="86fe" class="jt ju hi lm b fi lu lr l ls lt">pval = multivariateGaussian(Xval, mu, sigma2)<br/>epsilon, F1 = selectThreshold(yval, pval)<br/>print("Best epsilon found using cross-validation:",epsilon)<br/>print("Best F1 on Cross Validation Set:",F1)</span></pre><p id="eb9f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">选择好阈值后，我们可以看到数据集中的故障服务器。</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="da0e" class="jt ju hi lm b fi lq lr l ls lt">plt.figure(figsize=(8,6))<br/><br/>plt.scatter(X[:,0],X[:,1],marker="x")<br/><br/>X1,X2 = np.meshgrid(np.linspace(0,35,num=70),np.linspace(0,35,num=70))<br/>p2 = multivariateGaussian(np.hstack((X1.flatten()[:,np.newaxis],X2.flatten()[:,np.newaxis])), mu, sigma2)<br/>contour_level = 10**np.array([np.arange(-20,0,3,dtype=np.float)])[0]<br/>plt.contour(X1,X2,p2[:,np.newaxis].reshape(X1.shape),contour_level)<br/><br/>outliers = np.nonzero(p&lt;epsilon)[0]<br/>plt.scatter(X[outliers,0],X[outliers,1],marker ="o",facecolor="none",edgecolor="r",s=70)<br/><br/>plt.xlim(0,35)<br/>plt.ylim(0,35)<br/>plt.xlabel("Latency (ms)")<br/>plt.ylabel("Throughput (mb/s)")</span></pre><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es md"><img src="../Images/d3b2652cef6e352d090811e33b450f75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/1*0d-TSN9PgJlWAasBhHnANw.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">输出</figcaption></figure><h2 id="9089" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">奖金部分</h2><p id="5d85" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">在这个额外的部分，我们将在一个更真实、更困难的数据集上运行异常检测算法。在该数据集中，每个示例由11个特征描述，捕获计算机服务器的更多属性。</p><p id="7b1b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们加载数据集并获得参数μ和σ:</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="bc84" class="jt ju hi lm b fi lq lr l ls lt">mat2 = loadmat("ex8data2.mat")<br/>X2 = mat2["X"]<br/>Xval2 = mat2["Xval"]<br/>yval2 = mat2["yval"]</span><span id="7950" class="jt ju hi lm b fi lu lr l ls lt">mu2, sigma2_2 = estimateGaussian(X2)</span></pre><p id="b79f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，让我们将高斯分布拟合到我们的数据集，并检测其中的异常数量:</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="0cf5" class="jt ju hi lm b fi lq lr l ls lt">p3 = multivariateGaussian(X2, mu2, sigma2_2)<br/><br/>pval2 = multivariateGaussian(Xval2, mu2, sigma2_2)<br/><br/>epsilon2, F1_2 = selectThreshold(yval2, pval2)<br/>print("Best epsilon found using cross-validation:",epsilon2)<br/>print("Best F1 on Cross Validation Set:",F1_2)<br/>print("# Outliers found:",np.sum(p3&lt;epsilon2))</span></pre><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es mn"><img src="../Images/800ac97f0b82d1ba3fdf2a9204ed73e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1290/format:webp/1*TcWdUGiu9ICYKcU0Wd77pQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">输出</figcaption></figure><p id="c6d5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">它在我们的数据集中发现了117台故障服务器。在新的例子x中，它非常善于发现。</p><h2 id="a789" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">结论</h2><p id="ea6e" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">在本文中，我们首先了解什么是异常检测，然后深入研究高斯分布，我们发现了一种比高斯分布更强大的多元高斯分布(MGD ),我们将其拟合到我们的数据集，之后我们找到了一个好的阈值并可视化我们的异常。在我们的奖金部分，我们拟合我们的数据集，有比以前更复杂的数据集，使用MGD。最后，我们在数据集中找到了一些离群点。数据集和最终代码上传到Github。</p><p id="35d3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">点击查看<a class="ae iu" href="https://github.com/jagajith23/Andrew-Ng-s-Machine-Learning-in-Python/tree/gh-pages/Anomaly%20Detection%20%26%20Recommender%20System" rel="noopener ugc nofollow" target="_blank">。</a></p><h1 id="82e4" class="mo ju hi bd jv mp mq mr jz ms mt mu kd mv mw mx kg my mz na kj nb nc nd km ne bi translated">如果你喜欢这篇文章，那么看看我以前在这个系列中关于</h1><h2 id="b506" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">1.<a class="ae iu" rel="noopener" href="/@jagajith23/what-is-machine-learning-daeac9a2ceca">什么是机器学习？</a></h2><h2 id="01ca" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">2.<a class="ae iu" rel="noopener" href="/codex/what-are-the-types-of-machine-learning-53360b7db8b4">机器学习有哪些类型？</a></h2><h2 id="1fa7" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">3.<a class="ae iu" rel="noopener" href="/codex/linear-regression-on-single-variable-f35e6a73dab6">一元线性回归</a></h2><h2 id="00a1" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">4.<a class="ae iu" rel="noopener" href="/codex/linear-regression-on-multiple-variables-1893e4d940b1">多元线性回归</a></h2><h2 id="0c3c" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">5.<a class="ae iu" rel="noopener" href="/codex/logistic-regression-eee2fd028ffd">逻辑回归</a></h2><h2 id="a934" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">6.<a class="ae iu" rel="noopener" href="/@jagajith23/what-are-neural-networks-3a0965e2ebfb">什么是神经网络？</a></h2><h2 id="b309" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">7.<a class="ae iu" rel="noopener" href="/codex/digit-classifier-using-neural-networks-ad17749a8f00">使用神经网络的数字分类器</a></h2><h2 id="64d0" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">8.<a class="ae iu" rel="noopener" href="/codex/image-compression-with-k-means-clustering-48e989055729">利用K均值聚类的图像压缩</a></h2><h2 id="8b7f" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">9.<a class="ae iu" rel="noopener" href="/codex/dimensionality-reduction-on-face-using-pca-e3fec3bb4cee">使用PCA对人脸进行降维</a></h2><h1 id="1fc6" class="mo ju hi bd jv mp mq mr jz ms mt mu kd mv mw mx kg my mz na kj nb nc nd km ne bi translated">最后做的事</h1><p id="b98d" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">如果你喜欢我的文章，请鼓掌👏一个追随者将会是❤️free️❤️and 这有助于媒体推广这篇文章，以便其他人能够阅读它。<em class="mi">我是Jagajith，下一集再来抓你。</em></p></div></div>    
</body>
</html>