<html>
<head>
<title>Use Functions, Not Conditionals, While Awaiting Data in a React Component</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在React组件中等待数据时，使用函数，而不是条件</h1>
<blockquote>原文：<a href="https://medium.com/codex/use-functions-not-conditionals-while-awaiting-data-in-a-react-component-20dcdced8120?source=collection_archive---------3-----------------------#2021-10-17">https://medium.com/codex/use-functions-not-conditionals-while-awaiting-data-in-a-react-component-20dcdced8120?source=collection_archive---------3-----------------------#2021-10-17</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/ab0d775d16d9697b6b84fdd44dc0043f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q9iKYn-x3Fsu0ohQat5Scw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">Aphinya Dechalert的“机器人想要功能机器的口香糖”</figcaption></figure><p id="0e1d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果您已经找到了这篇文章的方法，那么您可能正在努力避免React组件中的所有东西被破坏，因为它正在等待对<code class="du jt ju jv jw b">fetch</code>请求的响应。</p><p id="61a5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">假设你正在开发一个简单的博客应用程序。您设置了一个名为<code class="du jt ju jv jw b">PostsContainer</code>的组件，它带有一个从后端获取帖子的<code class="du jt ju jv jw b">useEffect</code>。在几毫秒的提取运行时间内，<code class="du jt ju jv jw b">PostsContainer</code>将开始渲染，它调用的任何子组件也是如此。怎么不让它破？</p><p id="6e73" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">好吧，如果你是一个训练营的学生或者像我一样的刚毕业的学生，你的老师可能已经教过你在你的回报中设置一个条件。像这样:</p><pre class="jx jy jz ka fd kb jw kc kd aw ke bi"><span id="315a" class="kf kg hi jw b fi kh ki l kj kk">export default function PostsContainer() {<br/>  const [posts, setPosts] = useState([])<br/>  useEffect(() =&gt; {<br/>   <em class="kl"> // fetch posts and set state</em><br/>  }<br/>  <em class="kl">// other stuff</em><br/>  return (<br/>    {posts.length === 0 ? &lt;h1&gt;Loading...&lt;/h1&gt; :<br/>      <em class="kl">// what you actually want on the DOM</em></span></pre><p id="be24" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">太好了。那会有用的。但是<code class="du jt ju jv jw b"><em class="kl">// other stuff</em></code>呢？如果您需要遍历这些帖子并在渲染之前对它们做任何事情，该怎么办？你<em class="kl">做</em>需要做的事！</p><figure class="jx jy jz ka fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/29a32fd12288966d89f1c65a19fad204.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G4NnKLgO3uioVlNBSa9cag.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">我们讨论的是JavaScript，不是Python，但是概念是一样的</figcaption></figure><p id="6c99" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">嗯，根据你所学的，你可以为你需要做的每件事设定相同的条件:</p><pre class="jx jy jz ka fd kb jw kc kd aw ke bi"><span id="82e4" class="kf kg hi jw b fi kh ki l kj kk">let filteredPosts = []<br/>if (posts.length &gt; 0) {<br/>  filteredPosts = posts.filter(post =&gt; {<br/>    <em class="kl">// whatever you want to filter by</em></span></pre><p id="fcc6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这可能完成了工作，但是很混乱，容易出现意想不到的错误。也不是很<em class="kl">干</em>。你将一行接一行地编写<code class="du jt ju jv jw b">if (thing)</code>或<code class="du jt ju jv jw b">let thing = {}</code>的版本。最糟糕的是，它仍然可能破坏您的代码。如果您正在测试一个深度嵌套数组的长度，而这个数组在您的获取操作返回一个响应并且您的状态更新之前根本不存在，那该怎么办呢？你需要多么精心地设计你的空变量来防止一切在等待的几毫秒内崩溃？</p><p id="04b0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">所以这里有一个更好的办法。不要把这些写成条件句。把它们写成函数:</strong></p><pre class="jx jy jz ka fd kb jw kc kd aw ke bi"><span id="78a9" class="kf kg hi jw b fi kh ki l kj kk">const filteredPosts = () =&gt; posts.filter(post =&gt; <em class="kl">// etc.</em></span></pre><p id="06ff" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然后，在你的返回中调用这些函数。</p><p id="d374" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在第一个例子中你应该写<code class="du jt ju jv jw b">&lt;div&gt;{filteredPosts}&lt;/div&gt;</code>，现在用神奇的香蕉写<code class="du jt ju jv jw b">&lt;div&gt;{filteredPosts()}&lt;/div&gt;</code>来调用它。这样，函数内部的逻辑只有在你点击return语句中的那一行时才会运行，只有在<code class="du jt ju jv jw b">posts.length &gt; 0</code>的情况下才会运行。</p><figure class="jx jy jz ka fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es km"><img src="../Images/7f6ad011f1603309dd320454bd81cc06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*311R5bwmvjL2umIvYynjaQ.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">(<a class="ae iu" href="http://texturetaddka.com/ripe-yellow-banana-textures" rel="noopener ugc nofollow" target="_blank">来源</a>)</figcaption></figure><p id="59f7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">万岁！</p></div></div>    
</body>
</html>