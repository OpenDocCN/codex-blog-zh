<html>
<head>
<title>How to Create Your Own Helper Functions in Laravel</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Laravel中创建自己的助手函数</h1>
<blockquote>原文：<a href="https://medium.com/codex/how-to-create-your-own-helper-functions-in-laravel-d1515f950a45?source=collection_archive---------5-----------------------#2021-07-03">https://medium.com/codex/how-to-create-your-own-helper-functions-in-laravel-d1515f950a45?source=collection_archive---------5-----------------------#2021-07-03</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/fc302e8debdd257e0fb68de9be3a0ef1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*gxE3xRLw3WGjXcPY.png"/></div></div></figure><h1 id="0a11" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">介绍</h1><p id="9359" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">助手函数在您的<a class="ae km" href="https://laravel.com" rel="noopener ugc nofollow" target="_blank"> Laravel </a>项目中非常有用。它们有助于以一种干净简单的方式简化项目中的代码。Laravel自带许多<a class="ae km" href="https://laravel.com/docs/8.x/helpers#miscellaneous-method-list" rel="noopener ugc nofollow" target="_blank">辅助函数</a>，例如<code class="du kn ko kp kq b">dd()</code>、<code class="du kn ko kp kq b">abort()</code>和<code class="du kn ko kp kq b">session()</code>。但是随着您的项目开始增长，您可能会发现您想要添加自己的项目。</p><p id="f92a" class="pw-post-body-paragraph jo jp hi jq b jr kr jt ju jv ks jx jy jz kt kb kc kd ku kf kg kh kv kj kk kl hb bi translated">在本文中，我们将看看如何在我们的Laravel项目中创建和使用我们自己的定制PHP助手函数。</p><h1 id="b198" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">创建助手函数</h1><p id="32a2" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">要添加我们自己的助手函数，我们需要首先创建一个新的PHP文件来放置它们。因此，让我们在我们的<code class="du kn ko kp kq b">app</code>文件夹中创建一个<code class="du kn ko kp kq b">helpers.php</code>文件。顺便说一下，这个位置实际上取决于个人喜好。我见过的另一个放置文件的常见地方是在一个<code class="du kn ko kp kq b">app/Helpers/helpers.php</code>文件中。所以，选择一个你认为最适合你的目录是你自己的事。</p><p id="e2da" class="pw-post-body-paragraph jo jp hi jq b jr kr jt ju jv ks jx jy jz kt kb kc kd ku kf kg kh kv kj kk kl hb bi translated">现在，我们已经得到了我们的文件，我们可以添加我们的助手函数。作为本文的基本示例，我们将创建一个超级简单的函数，将分钟转换为小时。</p><p id="accf" class="pw-post-body-paragraph jo jp hi jq b jr kr jt ju jv ks jx jy jz kt kb kc kd ku kf kg kh kv kj kk kl hb bi translated">让我们像这样将函数添加到我们的<code class="du kn ko kp kq b">helpers.php</code>文件中:</p><pre class="kw kx ky kz fd la kq lb lc aw ld bi"><span id="b3ed" class="le ir hi kq b fi lf lg l lh li">&lt;?php<br/>  <br/>if (! function_exists('seconds_to_hours')) {<br/>    function seconds_to_hours(int $seconds): float<br/>    {<br/>        return $seconds / 3600;<br/>    }<br/>}</span></pre><p id="568b" class="pw-post-body-paragraph jo jp hi jq b jr kr jt ju jv ks jx jy jz kt kb kc kd ku kf kg kh kv kj kk kl hb bi translated">正如你在上面的例子中看到的，函数本身非常简单。然而，您可能会注意到的一件事是，函数名是以蛇形书写的(例如，seconds_to_hours ),而不是像您通常在类中看到的方法名那样以骆驼形书写的(例如，secondsToHours)。您不一定要使用snake case来定义函数名，但是您会发现所有的Laravel辅助函数都是这样编写的。因此，我可能会建议使用这种格式，以便您可以遵循预期的典型标准和格式。不过这完全取决于你。</p><p id="b7e0" class="pw-post-body-paragraph jo jp hi jq b jr kr jt ju jv ks jx jy jz kt kb kc kd ku kf kg kh kv kj kk kl hb bi translated">您可能已经注意到的另一件事是，我们将函数名包装在一个“if”语句中。这是为了防止我们意外地重新声明任何已经注册的同名帮助者。例如，假设我们正在使用一个已经注册了<code class="du kn ko kp kq b">seconds_to_hours()</code>函数的包，这将阻止我们用相同的名字注册我们自己的函数。为了解决这个问题，我们可以简单地改变我们自己函数的名字来避免任何冲突。</p><p id="1354" class="pw-post-body-paragraph jo jp hi jq b jr kr jt ju jv ks jx jy jz kt kb kc kd ku kf kg kh kv kj kk kl hb bi translated">同样重要的是，在创建辅助函数时，要记住它们只能用作辅助函数。它们并不是真的用来执行任何业务逻辑，而是帮助你整理你的代码。当然，您可以向它们添加复杂的逻辑，但是如果这是您想要做的事情，我可能会建议您考虑一下代码是否更适合其他地方，例如服务类、操作类或特征。</p><h1 id="7900" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">注册助手功能</h1><p id="8d8a" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">现在我们已经创建了我们的助手文件，我们需要注册它以便我们可以使用我们的新函数。要做到这一点，我们可以更新我们的<code class="du kn ko kp kq b">composer.json</code>文件，这样我们的文件就可以在每次请求时被加载，并且可供使用。这是可能的，因为Laravel在<code class="du kn ko kp kq b">public/index.php</code>文件中包含了<a class="ae km" href="https://getcomposer.org/" rel="noopener ugc nofollow" target="_blank"> Composer </a>类加载器。</p><p id="95da" class="pw-post-body-paragraph jo jp hi jq b jr kr jt ju jv ks jx jy jz kt kb kc kd ku kf kg kh kv kj kk kl hb bi translated">在您的<code class="du kn ko kp kq b">composer.json</code>文件中，您应该有这样一个部分:</p><pre class="kw kx ky kz fd la kq lb lc aw ld bi"><span id="be07" class="le ir hi kq b fi lf lg l lh li">"autoload": {<br/>    "psr-4": {<br/>        "App\\": "app/",<br/>        "Database\\Factories\\": "database/factories/",<br/>        "Database\\Seeders\\": "database/seeders/"<br/>    }<br/>},</span></pre><p id="e69b" class="pw-post-body-paragraph jo jp hi jq b jr kr jt ju jv ks jx jy jz kt kb kc kd ku kf kg kh kv kj kk kl hb bi translated">在本节中，我们只需添加以下几行，让Composer知道您想要加载文件:</p><pre class="kw kx ky kz fd la kq lb lc aw ld bi"><span id="8e9f" class="le ir hi kq b fi lf lg l lh li">"files": [<br/>    "app/helpers.php"<br/>],</span></pre><p id="de8b" class="pw-post-body-paragraph jo jp hi jq b jr kr jt ju jv ks jx jy jz kt kb kc kd ku kf kg kh kv kj kk kl hb bi translated">您的<code class="du kn ko kp kq b">composer.json</code>文件的<code class="du kn ko kp kq b">autoload</code>部分现在应该是这样的:</p><pre class="kw kx ky kz fd la kq lb lc aw ld bi"><span id="8eea" class="le ir hi kq b fi lf lg l lh li">"autoload": {<br/>    "files": [<br/>        "app/helpers.php"<br/>    ],<br/>    "psr-4": {<br/>        "App\\": "app/",<br/>        "Database\\Factories\\": "database/factories/",<br/>        "Database\\Seeders\\": "database/seeders/"<br/>    }<br/>},</span></pre><p id="19e3" class="pw-post-body-paragraph jo jp hi jq b jr kr jt ju jv ks jx jy jz kt kb kc kd ku kf kg kh kv kj kk kl hb bi translated">现在我们已经手动更新了<code class="du kn ko kp kq b">composer.json</code>文件，我们需要运行以下命令来转储我们的自动加载文件并创建一个新文件:</p><pre class="kw kx ky kz fd la kq lb lc aw ld bi"><span id="74b1" class="le ir hi kq b fi lf lg l lh li">composer dump-autoload</span></pre><h1 id="2b0c" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">使用助手功能</h1><p id="b642" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">恭喜你！您的助手函数现在应该已经设置好了，可以使用了。要使用它，您只需使用:</p><pre class="kw kx ky kz fd la kq lb lc aw ld bi"><span id="4fdb" class="le ir hi kq b fi lf lg l lh li">seconds_to_hours(331);</span></pre><p id="8f89" class="pw-post-body-paragraph jo jp hi jq b jr kr jt ju jv ks jx jy jz kt kb kc kd ku kf kg kh kv kj kk kl hb bi translated">因为它被注册为一个全局函数，这意味着你可以在很多地方使用它，比如你的控制器，服务类，甚至其他的帮助函数。我最喜欢助手功能的部分是能够在你的刀片视图中使用它们。例如，让我们想象一下，我们有一个包含一个与我们的新函数做同样事情的<code class="du kn ko kp kq b">secondsToHours()</code>方法的<code class="du kn ko kp kq b">TimeServiceClass</code>。如果我们要在我们的刀片视图中使用服务类，我们可能需要做这样的事情:</p><pre class="kw kx ky kz fd la kq lb lc aw ld bi"><span id="a6e5" class="le ir hi kq b fi lf lg l lh li">{{ \App\Services\TimeService::secondsToHours(331) }}</span></pre><p id="8875" class="pw-post-body-paragraph jo jp hi jq b jr kr jt ju jv ks jx jy jz kt kb kc kd ku kf kg kh kv kj kk kl hb bi translated">可以想象，如果在一个页面的多个地方使用这种方法，可能会让你的视图变得有些混乱。</p><h1 id="996d" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">更进一步</h1><p id="cf13" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">现在，我们已经看到了如何注册和使用助手，我们将看看如何才能更进一步。随着时间的推移，随着Laravel项目的增长，您可能会发现有大量的助手都在一个文件中。可以想象，这个文件可能开始看起来有点杂乱无章。因此，我们可能要考虑将我们的功能拆分到单独的文件中。</p><p id="4c15" class="pw-post-body-paragraph jo jp hi jq b jr kr jt ju jv ks jx jy jz kt kb kc kd ku kf kg kh kv kj kk kl hb bi translated">为了文章的方便，我们假设在我们的<code class="du kn ko kp kq b">app/helpers.php</code>文件中有很多帮助者；有些与金钱有关，有些与时间有关，有些与用户设置有关。我们可以从将这些函数分解成单独的文件开始，比如:<code class="du kn ko kp kq b">app/Helpers/money.php</code>、<code class="du kn ko kp kq b">app/Helpers/time.php</code>和<code class="du kn ko kp kq b">app/Helpers/settings.php</code>。这意味着我们现在可以删除我们的<code class="du kn ko kp kq b">app/helpers.php</code>文件，因为我们不再需要它了。</p><p id="ccc0" class="pw-post-body-paragraph jo jp hi jq b jr kr jt ju jv ks jx jy jz kt kb kc kd ku kf kg kh kv kj kk kl hb bi translated">之后，我们可以用与之前类似的方式更新我们的<code class="du kn ko kp kq b">composer.json</code>文件，这样它现在可以加载我们的3个新文件:</p><pre class="kw kx ky kz fd la kq lb lc aw ld bi"><span id="88c5" class="le ir hi kq b fi lf lg l lh li">"autoload": {<br/>    "files": [<br/>        "app/Helpers/money.php",<br/>        "app/Helpers/settings.php",<br/>        "app/Helpers/time.php",<br/>    ],<br/>    "psr-4": {<br/>        "App\\": "app/",<br/>        "Database\\Factories\\": "database/factories/",<br/>        "Database\\Seeders\\": "database/seeders/"<br/>    }<br/>},</span></pre><p id="e7d2" class="pw-post-body-paragraph jo jp hi jq b jr kr jt ju jv ks jx jy jz kt kb kc kd ku kf kg kh kv kj kk kl hb bi translated">我们需要记住通过运行以下命令再次转储Composer自动加载文件:</p><pre class="kw kx ky kz fd la kq lb lc aw ld bi"><span id="1dda" class="le ir hi kq b fi lf lg l lh li">composer dump-autoload</span></pre><p id="4c1d" class="pw-post-body-paragraph jo jp hi jq b jr kr jt ju jv ks jx jy jz kt kb kc kd ku kf kg kh kv kj kk kl hb bi translated">现在，您应该能够继续使用您的函数，并受益于它们被分割成逻辑上分离的文件。</p><h1 id="9436" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">结论</h1><p id="ecd8" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">希望本文已经向您展示了如何为您的Laravel项目创建和注册您自己的PHP助手函数。请记住，不要使用它们来执行复杂的业务逻辑，而应该更多地将它们视为整理少量代码的一种方式。</p><p id="3be8" class="pw-post-body-paragraph jo jp hi jq b jr kr jt ju jv ks jx jy jz kt kb kc kd ku kf kg kh kv kj kk kl hb bi translated">如果你喜欢读这篇文章，并且觉得它很有用，请随意注册我的简讯，这样我每次发表新文章时你都会收到通知。</p><p id="2e42" class="pw-post-body-paragraph jo jp hi jq b jr kr jt ju jv ks jx jy jz kt kb kc kd ku kf kg kh kv kj kk kl hb bi translated">继续建造令人敬畏的东西！🚀</p></div><div class="ab cl lj lk gp ll" role="separator"><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo"/></div><div class="hb hc hd he hf"><p id="5987" class="pw-post-body-paragraph jo jp hi jq b jr kr jt ju jv ks jx jy jz kt kb kc kd ku kf kg kh kv kj kk kl hb bi translated"><em class="lq">最初发表于</em><a class="ae km" href="https://ashallendesign.co.uk/blog/how-to-create-your-own-helper-functions-in-laravel" rel="noopener ugc nofollow" target="_blank"><em class="lq">https://ashallendesign.co.uk</em></a><em class="lq">。</em></p></div></div>    
</body>
</html>