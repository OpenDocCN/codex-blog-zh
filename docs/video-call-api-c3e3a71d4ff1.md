# å¦‚ä½•ä½¿ç”¨è§†é¢‘é€šè¯ API æ­å»ºè§†é¢‘é€šè¯ç›´æ’­ app

> åŸæ–‡ï¼š<https://medium.com/codex/video-call-api-c3e3a71d4ff1?source=collection_archive---------8----------------------->

## æœ¬æ–‡å°†ä»‹ç»å¦‚ä½•ä½¿ç”¨ ZEGOCLOUD çš„è§†é¢‘é€šè¯ API å’Œ firebase æ¥æ„å»ºä¸€ä¸ªè§†é¢‘é€šè¯ç›´æ’­ app

![](img/272d9c98a495169e0eda8bb46e231a8c.png)

## ä»‹ç»

éšç€è®¾å¤‡æ€§èƒ½å’Œç½‘ç»œè´¨é‡çš„ä¸æ–­æå‡ï¼Œè¶Šæ¥è¶Šå¤šçš„éŸ³è§†é¢‘é€šè¯åœºæ™¯å¾—åˆ°åº”ç”¨ï¼Œè§†é¢‘é€šè¯ API ä¹Ÿå¾—åˆ°è¶Šæ¥è¶Šå¤šçš„åº”ç”¨ã€‚

è§†é¢‘é€šè¯ API å¯ä»¥æä¾›å“ªäº›èƒ½åŠ›ï¼Ÿ

éšç€è§†é¢‘é€šè¯ API çš„éœ€æ±‚è¶Šæ¥è¶Šå¤§ï¼Œæä¾›è§†é¢‘é€šè¯ API çš„å…¬å¸ä¹Ÿè¶Šæ¥è¶Šå¤šï¼Œä½†æä¾›çš„åŠŸèƒ½å¤§åŒå°å¼‚ã€‚

è§†é¢‘å‘¼å« API æä¾›çš„åŠŸèƒ½ä¸»è¦åŒ…æ‹¬:

1.  é€šè¯é‚€è¯·
2.  è¯­éŸ³å’Œè§†é¢‘é€šè¯
3.  ç¦»çº¿æ¨é€åŠŸèƒ½
4.  å‘¼å«ç”¨æˆ·ç•Œé¢å’Œäº¤äº’

ä¸‹é¢æ˜¯ä½¿ç”¨ ZEGOCLOUD çš„è§†é¢‘é€šè¯ API æ­å»ºçš„è§†é¢‘é€šè¯ç›´æ’­ appã€‚

![](img/df6316f2a41f56299ecb21122fbec7d2.png)

## ZEGOCLOUD çš„è§†é¢‘é€šè¯ API æ˜¯ä»€ä¹ˆï¼Ÿ

ZEGOCLOUD çš„è§†é¢‘è°ƒç”¨ API é‡‡ç”¨åˆ†å±‚æ¶æ„ã€‚è¯¦æƒ…å¦‚ä¸‹å›¾æ‰€ç¤º:

![](img/e7fa75acb5dd49be34ff8271cf9d8f14.png)

ZEGOCLOUD çš„è§†é¢‘è°ƒç”¨ API ä¸ºä½ æä¾›äº†ä¸¤ç§ä¸åŒçš„ SDK:`CallUIKit`å’Œ`Call SDK`ã€‚

`CallUIKit`:æä¾›å®Œæ•´çš„è§†é¢‘ç›´æ’­é€šè¯ UIï¼Œåªéœ€è¦è°ƒç”¨é€šè¯ç•Œé¢ï¼Œåœ¨éœ€è¦å®Œæˆé€šè¯è¿‡ç¨‹çš„åœ°æ–¹æŒ‚æœºç•Œé¢å³å¯ã€‚

`Call SDK`:æä¾›è§†é¢‘ç›´æ’­é€šè¯çš„åº•å±‚é€»è¾‘ï¼Œå¦‚éŸ³è§†é¢‘ç®¡ç†ã€é€šè¯ç®¡ç†ã€ç½‘ç»œçŠ¶æ€ç®¡ç†ç­‰ã€‚ä½ åªéœ€è¦ä¸“æ³¨äºä¸Šå±‚è‡ªå®šä¹‰ UI çš„å®ç°ï¼Œè°ƒç”¨ç›¸åº”çš„äº¤äº’æ¥å£å°±å¯ä»¥å®Œæˆè°ƒç”¨è¿‡ç¨‹ã€‚

## å¦‚ä½•ä½¿ç”¨ ZEGOCLOUD çš„è§†é¢‘é€šè¯ API

## ç¬¬ä¸€æ­¥ã€‚åˆ›å»ºä¸€ä¸ª ZEGOCLOUD å¸æˆ·

*   åœ¨ [ZEGOCLOUD å®˜æ–¹](https://www.zegocloud.com/account/signup?_source=medium&article=25)åˆ›å»ºè´¦å·ã€‚

![](img/4bb7bebbd4b686d8875d83284f375d56.png)

## ç¬¬äºŒæ­¥ã€‚åˆ›å»ºæ–°é¡¹ç›®

*   åœ¨ [ZEGOCLOUD ç®¡ç†æ§åˆ¶å°](https://console.zegocloud.com?_source=medium&article=25)ä¸­åˆ›å»ºä¸€ä¸ªé¡¹ç›®ã€‚

![](img/62e7b23751558dd96ebd6703afeb3ad5.png)

## ç¬¬ä¸‰æ­¥ã€‚åˆ›å»ºä¸€ä¸ª Firebase é¡¹ç›®

åœ¨ [Firebase æ§åˆ¶å°](https://console.firebase.google.com/)ä¸­åˆ›å»ºä¸€ä¸ª Firebase é¡¹ç›®ã€‚æ›´å¤šè¯¦æƒ…ï¼Œè¯·å‚è§ [Firebase æ–‡æ¡£](https://firebase.google.com/docs/functions/get-started)ã€‚

![](img/f0d042e03ee8c66a69e3ea7f75022f38.png)

## ç¬¬å››æ­¥ã€‚éƒ¨ç½² Firebase äº‘åŠŸèƒ½

ZEGO Call é»˜è®¤ä½¿ç”¨ Firebase Cloud å‡½æ•°ä½œä¸ºä¸šåŠ¡æœåŠ¡å™¨ï¼Œæˆ‘ä»¬å»ºè®®æ‚¨åœ¨é›†æˆ ZEGOCall SDK ä¹‹å‰æ¿€æ´»å¹¶éƒ¨ç½²å®ƒã€‚

1.  åœ¨ Firebase ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„å®æ—¶æ•°æ®åº“ã€‚

![](img/f1da5336474ace0b14dd870bae9b6de9.png)

1.  é€šè¿‡æ·»åŠ ä»¥ä¸‹å†…å®¹æ¥ç¼–è¾‘å®æ—¶æ•°æ®åº“çš„è§„åˆ™:

```
{
  "rules": {
        ".read": "auth.uid != null",
        ".write": "auth.uid != null",
  }
}
```

![](img/318d720cfa1eccce62b7cf8f6d995174.png)

1.  é€šè¿‡ npm å®‰è£… CLIã€‚

*   `npm install -g firebase-tools`

![](img/b94291eb2e0cb0d092abcd82e7ea1cb9.png)

1.  è¿è¡Œ`firebase login`é€šè¿‡æµè§ˆå™¨ç™»å½•å¹¶éªŒè¯ firebase å·¥å…·ã€‚

![](img/8b20ee12113b2df7e9e568fb8955186f.png)

1.  è¿è¡Œ`firebase init functions`ã€‚è¯¥å·¥å…·ä¸ºæ‚¨æä¾›äº†å®‰è£… npm ä¾èµ–é¡¹çš„é€‰é¡¹ã€‚å¦‚æœæ‚¨æƒ³ä»¥å¦ä¸€ç§æ–¹å¼ç®¡ç†ä¾èµ–é¡¹ï¼Œæ‹’ç»æ˜¯å®‰å…¨çš„ï¼Œä½†æ˜¯å¦‚æœæ‚¨æ‹’ç»ï¼Œæ‚¨éœ€è¦åœ¨æ¨¡æ‹Ÿæˆ–éƒ¨ç½²æ‚¨çš„åŠŸèƒ½ä¹‹å‰è¿è¡Œ npm installã€‚

![](img/6b51ea4a4edbe2b4dcbd1f521a3af092.png)

1.  ä¸‹è½½[äº‘å‡½æ•°ç¤ºä¾‹ä»£ç ](https://github.com/ZEGOCLOUD/call_firebase_funcitons)ã€‚

![](img/25b57532ed669735af57cfdb8f58ee9c.png)

1.  å°†ç¤ºä¾‹ä»£ç ä¸­çš„`firebase.json`ã€`functions\index.js`æ–‡ä»¶å’Œ`functions\token04`æ–‡ä»¶å¤¹å¤åˆ¶åˆ°æ‚¨çš„äº‘å‡½æ•°é¡¹ç›®ä¸­ï¼Œè¦†ç›–åŒåæ–‡ä»¶ã€‚

![](img/c11f7b081314058c6f34f73d28c5ec8a.png)![](img/45d96a980ac339cf2396d9853e8f8c57.png)

1.  ä¿®æ”¹`index.js`æ–‡ä»¶ï¼Œæ­£ç¡®å¡«å†™ä» [ZEGOCLOUD ç®¡ç†æ§åˆ¶å°](https://console.zegocloud.com?_source=medium&article=25)è·å¾—çš„ AppID å’Œ ServerSecretã€‚

![](img/40304d6428ac38fcfaa8940cd0897bc1.png)

1.  åœ¨ Firebase CLI ä¸­ï¼Œè¿è¡Œ`firebase deploy --only functions`å‘½ä»¤æ¥éƒ¨ç½²äº‘åŠŸèƒ½ã€‚

![](img/6480b1829d2b0e081c6849969e13825e.png)

## ç¬¬äº”æ­¥ã€‚å°†æ–‡ä»¶å¤åˆ¶åˆ°é¡¹ç›®ä¸­

è¦å°† ZEGOCallUIKit ä¸ CocoaPods è‡ªåŠ¨é›†æˆï¼Œè¯·æ‰§è¡Œä»¥ä¸‹æ“ä½œ:

1.  ä¸‹è½½[ç¤ºä¾‹ä»£ç ](https://codestore.zegocloud.com/project/2)ï¼Œå¹¶å°†`ZEGOCallUIKit`å’Œ`ZEGOCall`æ–‡ä»¶å¤¹å¤åˆ¶åˆ°æ‚¨çš„é¡¹ç›®ç›®å½•ä¸­(å¦‚æœæ‚¨æ²¡æœ‰é¡¹ç›®ï¼Œè¯·åˆ›å»ºä¸€ä¸ªæ–°é¡¹ç›®)ã€‚

![](img/31434e58cf914ad1377ceb58cae61b3c.png)

1.  æ‰“å¼€ç»ˆç«¯ï¼Œå¯¼èˆªåˆ°æ‚¨çš„é¡¹ç›®ç›®å½•ï¼Œè¿è¡Œ`pod init`å‘½ä»¤åˆ›å»ºä¸€ä¸ª`Podfile`ï¼Œç„¶åå°†ä»¥ä¸‹å†…å®¹æ·»åŠ åˆ°æ–‡ä»¶ä¸­ã€‚

*   `pod 'ZegoExpressEngine' pod 'FirebaseAuth' pod 'GoogleSignIn' pod 'Firebase/Database' pod 'Firebase/Analytics' pod 'Firebase/Crashlytics' pod 'Firebase/Messaging' pod 'Firebase/Functions'`

![](img/e0b25d748db0ff0afdf3c46628a635c9.png)

1.  åœ¨ç»ˆç«¯ä¸­ï¼Œå¯¼èˆªåˆ° Podfile æ‰€åœ¨çš„ç›®å½•ï¼Œè¿è¡Œ`pod install`å‘½ä»¤ã€‚

*   `pod install`

1.  é‡å¯ Xcodeï¼Œæ‰“å¼€æ–°ç”Ÿæˆçš„ã€‚å·¥ä½œåŒºæ–‡ä»¶ã€‚

## ç¬¬å…­æ­¥ã€‚æ·»åŠ æƒé™

å¯ä»¥æ ¹æ®éœ€è¦è®¾ç½®æƒé™ã€‚

1.  æ‰“å¼€ Xcodeï¼Œé€‰æ‹©ç›®æ ‡å¯¹è±¡ï¼Œç„¶åç‚¹å‡»**ä¿¡æ¯>è‡ªå®šä¹‰ iOS ç›®æ ‡å±æ€§**ã€‚

![](img/2719d9c05db016fbd0bdbf80cb15a3b7.png)

1.  ç‚¹å‡»**æ·»åŠ æŒ‰é’®(+)** æ·»åŠ æ‘„åƒå¤´å’Œéº¦å…‹é£æƒé™ã€‚

*   `Privacy-Camera Usage Description`
*   `Privacy-Microphone Usage Description`

![](img/e66ca48d7c4c926790933c5b8251b5fb.png)

1.  é€‰æ‹©ç›®æ ‡é¡¹ç›®ï¼Œé€‰æ‹©**æ ‡å¿—&èƒ½åŠ›>èƒ½åŠ›**ï¼Œæœç´¢**åå°æ¨¡å¼**å¹¶åŒå‡»ã€‚

![](img/9d7fdff900d7e967b910aae55416eb9c.png)

1.  åœ¨**èƒŒæ™¯æ¨¡å¼**ä¸­æ£€æŸ¥ä»¥ä¸‹é€‰é¡¹ã€‚

![](img/29f4cb2dd108e4b61502e295e60fabed.png)

1.  å¯ç”¨**æ¨é€é€šçŸ¥**åŠŸèƒ½ã€‚

![](img/93181f5cf4e0223be52f69996f7d9d96.png)

1.  ä¸‹è½½ firebase çš„é…ç½®æ–‡ä»¶**Google service-info . plist**ï¼Œå¹¶å°†å…¶æ·»åŠ åˆ°æ‚¨çš„é¡¹ç›®ä¸­ã€‚è¦è·å–é…ç½®æ–‡ä»¶ï¼Œè¯·å‚è€ƒ[å¦‚ä½•è·å–é…ç½®æ–‡ä»¶ï¼Ÿ](https://firebase.google.com/docs/ios/setup#add-config-file)ã€‚

![](img/86dcca456ba83a38cd4ec031126863ad.png)![](img/0c88d01e41c52a6e39f3d1bca9997745.png)

1.  è®¾ç½® **URL ç±»å‹**:ç”¨**Google service-info . plist**æ–‡ä»¶ä¸­çš„ **REVERSED_CLIENT_ID** å­—æ®µå¡«å†™ **URL æ–¹æ¡ˆ**ã€‚

![](img/60eebe727cf221b1295bc6cc2eaa9468.png)

## åˆå§‹åŒ– ZEGOCallUIKit

è¦åˆå§‹åŒ– ZEGOCallUIKitï¼Œè·å–`CallManager`å®ä¾‹ï¼Œä¼ é€’é¡¹ç›®çš„ AppIDã€‚

è¦æ¥æ”¶å›è°ƒï¼Œå°†ç›¸åº”çš„`delegate`è®¾ç½®ä¸º`self`ã€‚

## ç”¨æˆ·ç™»å½•

ZEGO Call è¿˜ä¸æä¾›ç”¨æˆ·ç®¡ç†åŠŸèƒ½ã€‚æ‚¨éœ€è¦è®©ç”¨æˆ·ç™»å½• Firebaseï¼Œç„¶åè°ƒç”¨`setLocalUser`æ–¹æ³•ï¼Œæ ¹æ®ç™»å½•ç»“æœå°†ç”¨æˆ·ä¿¡æ¯è®¾ç½®ä¸º CallUIKitã€‚

Firebase æä¾›äº†å¤šç§ç™»å½•èº«ä»½éªŒè¯æ¨¡å¼ã€‚ä¸‹é¢ä»¥ Google ç™»å½•ä¸ºä¾‹ã€‚
æ›´å¤šæ¨¡å¼è¯·å‚è€ƒ [Firebase å®˜æ–¹](https://firebase.google.com/docs/auth/where-to-start)ã€‚

## è·å¾—ä»£å¸

ZEGO Call ä½¿ç”¨ RTC SDK å®ç°è¯­éŸ³å’Œè§†é¢‘é€šè¯åŠŸèƒ½ã€‚ä¸»å«ç”¨æˆ·å’Œè¢«å«ç”¨æˆ·åŠ å…¥åŒä¸€ä¸ªæˆ¿é—´ï¼Œå¹¶ä¸”åœ¨å‘¼å«æ¥é€šæ—¶å¼€å§‹æµå‘å¸ƒå’Œæµæ’­æ”¾ã€‚å› æ­¤ï¼Œè¦è¿›è¡Œå‡ºç«™è°ƒç”¨ï¼Œæ‚¨éœ€è¦ä¸º RTC SDK æä¾›ä¸€ä¸ªä»¤ç‰Œè¿›è¡ŒéªŒè¯ã€‚æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è§[ä½¿ç”¨ä»¤ç‰Œè¿›è¡Œè®¤è¯](#11648)ã€‚

åœ¨å‘å‡ºæˆ–æ¥å—å‡ºç«™å‘¼å«ä¹‹å‰ï¼Œæ‚¨éœ€è¦ä» Firebase Cloud å‡½æ•°è·å–ä¸€ä¸ªä»¤ç‰Œã€‚

ä¸º`CallManager`çš„ Token å±æ€§è®¾ç½®ä¸€ä¸ªä»¤ç‰Œï¼Œå®ç°`TokenProvider`çš„ä»£ç†æ‹¥æœ‰çš„å›è°ƒ`getRTCToken`ã€‚

## æ‹¨æ‰“å‡ºç«™ç”µè¯

è¦è¿›è¡Œå‡ºç«™è¯­éŸ³å‘¼å«ï¼Œè°ƒç”¨`callUser`æ–¹æ³•å¹¶å°†`type`å‚æ•°è®¾ç½®ä¸º`CallType.voice`ã€‚

è¦è¿›è¡Œå‡ºç«™è§†é¢‘å‘¼å«ï¼Œè°ƒç”¨`callUser`æ–¹æ³•å¹¶å°†`type`å‚æ•°è®¾ç½®ä¸º`CallType.video`ã€‚

å‘å‡ºå‘¼å«åï¼ŒCallUIKit ä¼šè‡ªåŠ¨ä¸ºè¢«å«æ–¹å’Œä¸»å«æ–¹æ˜¾ç¤ºå½“å‰çŠ¶æ€çš„ UI(éœ€è¦é›†æˆ CallUIKit)ï¼Œæ‚¨å¯ä»¥åœ¨ UI ä¸Šè¿›è¡Œè¿›ä¸€æ­¥çš„æ“ä½œã€‚

*   å½“è°ƒç”¨æ–¹è°ƒç”¨æ–¹æ³•è¿›è¡Œè°ƒç”¨æ—¶ï¼Œå°†æ˜¾ç¤ºä»¥ä¸‹å†…å®¹(ä¸ºäº†ä¾¿äºè¯´æ˜ï¼Œè¿›è¡Œè¯­éŸ³è°ƒç”¨)

![](img/143f48e2176fdb9a4377cccc158aadb7.png)

*   å½“è¢«å«æ–¹æ”¶åˆ°æ¥ç”µæ—¶ï¼Œä¼šå¼¹å‡ºä»¥ä¸‹é»‘è‰²æç¤º(ä»¥è¯­éŸ³å‘¼å«ä¸ºä¾‹)

![](img/00d3844a3ac1e59fced039f0c3bc0bfe.png)

## ä¸Šä¼ æ—¥å¿—

å½“æ‚¨åœ¨ä½¿ç”¨æ‚¨çš„ app æ—¶é‡åˆ°é—®é¢˜ï¼Œè°ƒç”¨`uploadLog`æ–¹æ³•ä¸Šä¼ æ—¥å¿—ï¼Œä»¥ä¾¿æˆ‘ä»¬æ›´å¿«åœ°å®šä½å’Œå¸®åŠ©æ‚¨ã€‚

## å–æ¶ˆåˆå§‹åŒ– ZEGOCallUIKit

åœ¨ä½¿ç”¨å®Œ ZEGO è°ƒç”¨åï¼Œè°ƒç”¨`unInit`æ–¹æ³•æ¥å–æ¶ˆ SDK çš„åˆå§‹åŒ–ã€‚

[ä¸ ZEGOCLOUD ç­¾çº¦](https://console.zegocloud.com/account/signup?_source=medium&article=25)ï¼Œæ¯æœˆå…è´¹è·å¾—**10000 åˆ†é’Ÿ**ã€‚

# ä½ çŸ¥é“å—ï¼ŸğŸ‘

```
You can give up to **50 Claps** for an article?**Tap and hold the clap button** for a few seconds.**Follow me** to learn more technical knowledge.Thank you for reading :)
```

## äº†è§£æ›´å¤šä¿¡æ¯

è¿™æ˜¯ç°åœºæŠ€æœ¯æ–‡ç« ä¹‹ä¸€ã€‚æ¬¢è¿é˜…è¯»å…¶ä»–æ–‡ç« :

[](https://faun.pub/how-to-build-an-android-video-call-app-with-firebase-realtime-database-af76c2b202d9) [## å¦‚ä½•ä½¿ç”¨ firebase å®æ—¶æ•°æ®åº“æ„å»º Android è§†é¢‘é€šè¯åº”ç”¨ç¨‹åº

### æœ¬æ–‡å°†å¸®åŠ©æ‚¨å¿«é€Ÿæ„å»ºä¸€ä¸ªè§†é¢‘/éŸ³é¢‘é€šè¯åº”ç”¨ç¨‹åº

faun.pub](https://faun.pub/how-to-build-an-android-video-call-app-with-firebase-realtime-database-af76c2b202d9) [](https://faun.pub/how-to-build-a-clubhouse-clone-app-with-android-and-zegocloud-a-social-audio-app-development-cb4059e361b0) [## å¦‚ä½•ç”¨ Android å’Œ ZEGOCLOUD æ„å»ºä¸€ä¸ªä¿±ä¹éƒ¨ä¼šæ‰€å…‹éš†åº”ç”¨â€”â€”ä¸€ä¸ªç¤¾äº¤éŸ³é¢‘åº”ç”¨å¼€å‘

### æœ¬æ–‡è§£é‡Šäº†å¦‚ä½•ä½¿ç”¨ ZEGOCLOUD ZEGOLiveAudioRoom SDK å¿«é€Ÿå…‹éš†ä¸€ä¸ªä¿±ä¹éƒ¨åº”ç”¨ç¨‹åº

faun.pub](https://faun.pub/how-to-build-a-clubhouse-clone-app-with-android-and-zegocloud-a-social-audio-app-development-cb4059e361b0) [](https://faun.pub/using-ios-callkit-7ffd260e80d4) [## å¦‚ä½•ç”¨ iOS CallKit å’Œ ZEGOCLOUD å®ç°ä¸€ä¸ªè§†é¢‘é€šè¯ app

faun.pub](https://faun.pub/using-ios-callkit-7ffd260e80d4) [](https://faun.pub/video-api-fcd2bcbe24f7) [## ä½ äº†è§£è§†é¢‘ API å—ï¼Ÿ

### è¿™ç¯‡æ–‡ç« æè¿°äº†ä»€ä¹ˆæ˜¯è§†é¢‘ APIï¼Ÿè§†é¢‘ API å¦‚ä½•ä¿è¯éŸ³è§†é¢‘çš„æµç•…ä¼ è¾“ï¼Ÿ

faun.pub](https://faun.pub/video-api-fcd2bcbe24f7) [](https://faun.pub/super-live-chat-136dfa19f96f) [## å¦‚ä½•å®ç°è¶…çº§å®æ—¶èŠå¤©:ä½ åº”è¯¥çŸ¥é“çš„ 3 ç§æ–¹æ³•

faun.pub](https://faun.pub/super-live-chat-136dfa19f96f)