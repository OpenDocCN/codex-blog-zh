<html>
<head>
<title>Introduction to Hovertemplate in Plotly Graphs</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Plotly图中的Hovertemplate简介</h1>
<blockquote>原文：<a href="https://medium.com/codex/introduction-to-hovertemplate-in-plotly-graphs-e658c1b4a335?source=collection_archive---------0-----------------------#2021-10-21">https://medium.com/codex/introduction-to-hovertemplate-in-plotly-graphs-e658c1b4a335?source=collection_archive---------0-----------------------#2021-10-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="e9c8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以及如何使用“自定义数据”的示例</p><p id="8463" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本文中，我们将尝试指出Plotly中的hovertemplate是什么，我们如何使用它，以及如何向hover template添加自定义数据。实际上，我会做两个例子，一个是饼状图，一个是条形图。我们将在本文中讨论以下内容:</p><ul class=""><li id="ef1b" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">如何为基于百分比的图表(饼图等)自定义hovertemplate？)</li><li id="5259" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">如何为非基于百分比的图表(条形图、折线图等)自定义hovertemplate？)</li><li id="80f6" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">如何在hovertemplate中使用自定义数据</li></ul><p id="ec75" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你可以在这里获得更多细节<a class="ae jr" href="https://plotly.com/python/hover-text-and-formatting/" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="9a91" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，如果你想通过做例子来继续这篇文章，你应该安装一些Python包。</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="c2ef" class="kb kc hi jx b fi kd ke l kf kg">!pip install pandas<br/>!pip install numpy<br/>!pip install seaborn<br/>!pip install plotly</span></pre><p id="de2c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们用Pandas和NumPy来玩数据，用Seaborn来获取数据，用Plotly来可视化数据。</p><h1 id="8b89" class="kh kc hi bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">介绍</h1><p id="c856" class="pw-post-body-paragraph if ig hi ih b ii le ik il im lf io ip iq lg is it iu lh iw ix iy li ja jb jc hb bi translated">我将导入我们将使用的包。</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="bc92" class="kb kc hi jx b fi kd ke l kf kg">import pandas as pd<br/>import numpy as np<br/>import seaborn as sns<br/>from plotly import graph_objects as go<br/>from plotly import express as px</span></pre><p id="1ebc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们需要得到数据。我们使用来自Seaborn的<strong class="ih hj"> tips </strong>数据集。</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="5db5" class="kb kc hi jx b fi kd ke l kf kg">df = sns.load_dataset('tips')</span></pre><p id="3313" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我正在创建一个简单的饼图。您可以通过执行下面的命令获得相同的图表。当您将鼠标悬停在饼图的一部分上时，可以看到悬停文本。</p><figure class="js jt ju jv fd lk er es paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="er es lj"><img src="../Images/741ea8c3a35499ac1ec8643cbbb76bec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h7c3mY0GNNyYX_ntQsstiA.png"/></div></div></figure><p id="d945" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您刚才看到的文本是由hovertemplate创建的。在hovertemplate中，我们可以设置我们想要看到的内容。</p><h1 id="9fa0" class="kh kc hi bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">悬停模板</h1><p id="aa73" class="pw-post-body-paragraph if ig hi ih b ii le ik il im lf io ip iq lg is it iu lh iw ix iy li ja jb jc hb bi translated">在hovertemplate中，我们可以使用HTML标签。我们需要为这个属性创建一个模板。为此，我们使用<code class="du lr ls lt jx b">update_traces</code>方法。</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="201d" class="kb kc hi jx b fi kd ke l kf kg">fig = px.pie(data_frame=df,names='day',values='total_bill')</span><span id="810c" class="kb kc hi jx b fi lu ke l kf kg">fig.update_traces(hovertemplate='HELLO WORLD!')</span></pre><p id="d3a5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们向<strong class="ih hj"> update_traces </strong>方法中的<strong class="ih hj"> hovertemplate </strong>参数发送一个模板。现在，当我们悬停在一块馅饼上时，我们只会看到“你好，世界！”。因为我们只发送了一个字符串。</p><p id="d814" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这一点要注意。模板参数在这里从基于百分比的(饼图等)改变。)图表以非百分比为基础(条形图、折线图等。)图表。</p><h2 id="ec6f" class="kb kc hi bd ki lv lw lx km ly lz ma kq iq mb mc ku iu md me ky iy mf mg lc mh bi translated">基于百分比的图表的悬停模板</h2><p id="7390" class="pw-post-body-paragraph if ig hi ih b ii le ik il im lf io ip iq lg is it iu lh iw ix iy li ja jb jc hb bi translated">在hovertemplate中，如果我们想使用像“x”、“y”、“label”或“values”这样的图形参数，我们需要在hovertemplate字符串中对它们进行格式化。</p><p id="0261" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们在下面看到一个创建饼图的例子。我们可以在hovertemplate中使用这些参数(名称、值)。</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="e602" class="kb kc hi jx b fi kd ke l kf kg">fig = px.pie(data_frame=df,names='day',values='total_bill')</span></pre><p id="df16" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我要创建一个字符串变量。我应该用<code class="du lr ls lt jx b">%{parameter}</code>样式格式化。</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="eb4e" class="kb kc hi jx b fi kd ke l kf kg">hovertemp = "&lt;b&gt;Day: &lt;/b&gt; %{label} &lt;br&gt;"<br/>hovertemp += "&lt;b&gt;Total Bill: &lt;/b&gt; %{value}"</span></pre><p id="c0a5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如上所述，我们需要使用<code class="du lr ls lt jx b">update_traces</code>方法来应用这个模板。</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="7759" class="kb kc hi jx b fi kd ke l kf kg">hovertemp = "&lt;b&gt;Day: &lt;/b&gt; %{label} &lt;br&gt;"<br/>hovertemp += "&lt;b&gt;Total Bill: &lt;/b&gt; %{value}"</span><span id="6592" class="kb kc hi jx b fi lu ke l kf kg">fig = px.pie(data_frame=df,names='day',values='total_bill')<br/>fig.update_traces(hovertemplate=hovertemp)</span></pre><p id="e5c0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，当您将鼠标悬停在一块饼图上时，您将看到一个动态创建的字符串。</p><figure class="js jt ju jv fd lk er es paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="er es mi"><img src="../Images/a819046e7455fee071cf53c3650c737b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qLWaPm6Foa-YZdKA9kSdcQ.png"/></div></div></figure><h2 id="15cb" class="kb kc hi bd ki lv lw lx km ly lz ma kq iq mb mc ku iu md me ky iy mf mg lc mh bi translated">非基于百分比的图表的悬停模板</h2><p id="9448" class="pw-post-body-paragraph if ig hi ih b ii le ik il im lf io ip iq lg is it iu lh iw ix iy li ja jb jc hb bi translated">与之前基于百分比的图表不同，我们应该稍微更改一下模板参数。</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="34c2" class="kb kc hi jx b fi kd ke l kf kg">grouped = df.groupby('day',as_index=False).agg({'total_bill':'sum'})</span><span id="fb3e" class="kb kc hi jx b fi lu ke l kf kg">hovertemp = "&lt;b&gt;Day: &lt;/b&gt; %{x} &lt;br&gt;"<br/>hovertemp += "&lt;b&gt;Total Bill: &lt;/b&gt; %{y}"</span><span id="9436" class="kb kc hi jx b fi lu ke l kf kg">fig = px.bar(data_frame=grouped,x='day',y='total_bill',barmode='group')<br/>fig.update_traces(hovertemplate=hovertemp)</span></pre><p id="f358" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我用<code class="du lr ls lt jx b">x</code>更改了<code class="du lr ls lt jx b">label</code>以访问数据组的名称，用<code class="du lr ls lt jx b">y</code>更改了<code class="du lr ls lt jx b">values</code>以访问数据组的值。</p><figure class="js jt ju jv fd lk er es paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="er es mi"><img src="../Images/fe9b12dbc1e34c0262e68c7faa0b6ede.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zwsrm5kEYsB73qk6Og6xLQ.png"/></div></div></figure><h1 id="87e3" class="kh kc hi bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">Plotly图形中的自定义数据</h1><p id="2644" class="pw-post-body-paragraph if ig hi ih b ii le ik il im lf io ip iq lg is it iu lh iw ix iy li ja jb jc hb bi translated">我们知道我们只能在图表中添加2个数据点。x和Y或名称和值。但是我们可以通过使用<code class="du lr ls lt jx b">custom_data</code>属性发送其他数据点。它需要一个列表。</p><p id="0b14" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我在分组过程中补充了另一点。我会把小费的总数加到图表上。</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="d698" class="kb kc hi jx b fi kd ke l kf kg">grouped = df.groupby('day',as_index=False).agg({'total_bill':'sum','tip':'sum'})</span></pre><p id="7575" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们必须通过使用如下的<code class="du lr ls lt jx b">custom_data</code>属性来证明这一点。</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="6535" class="kb kc hi jx b fi kd ke l kf kg">fig = px.bar(data_frame=grouped,x='day',y='total_bill',custom_data=[grouped['tip']])</span></pre><p id="611c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果我们想使用定制数据，我们应该在hovertemplate字符串中使用列表符号。<strong class="ih hj"> customdata[0] </strong>表示总小费金额。</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="eff2" class="kb kc hi jx b fi kd ke l kf kg">grouped = df.groupby('day',as_index=False).agg({'total_bill':'sum','tip':'sum'})</span><span id="84b2" class="kb kc hi jx b fi lu ke l kf kg">hovertemp = "&lt;b&gt;Day: &lt;/b&gt; %{x} &lt;br&gt;"<br/>hovertemp += "&lt;b&gt;Total Bill: &lt;/b&gt; %{y} &lt;br&gt;"<br/>hovertemp += "&lt;b&gt;Total Tip: &lt;/b&gt; %{customdata[0]}"</span><span id="364a" class="kb kc hi jx b fi lu ke l kf kg">fig = px.bar(data_frame=grouped,x='day',y='total_bill',custom_data=[grouped['tip']])<br/>fig.update_traces(hovertemplate=hovertemp)</span></pre><figure class="js jt ju jv fd lk er es paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="er es lj"><img src="../Images/b4cf9d29fa5540bb8f1ffb92e905ad97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CMNwsNXImbW6nB_4P54r8g.png"/></div></div></figure><h1 id="5201" class="kh kc hi bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">最后</h1><p id="585a" class="pw-post-body-paragraph if ig hi ih b ii le ik il im lf io ip iq lg is it iu lh iw ix iy li ja jb jc hb bi translated">希望这是有帮助的，你喜欢它。您可以从以下位置访问代码:</p><div class="mj mk ez fb ml mm"><a href="https://www.kaggle.com/enesbaysan/hovertemplateandcustomdatainplotly" rel="noopener  ugc nofollow" target="_blank"><div class="mn ab dw"><div class="mo ab mp cl cj mq"><h2 class="bd hj fi z dy mr ea eb ms ed ef hh bi translated">HovertemplateAndCustomdataInPlotly</h2><div class="mt l"><h3 class="bd b fi z dy mr ea eb ms ed ef dx translated">使用Kaggle笔记本探索和运行机器学习代码|使用来自无附加数据源的数据</h3></div><div class="mu l"><p class="bd b fp z dy mr ea eb ms ed ef dx translated">www.kaggle.com</p></div></div><div class="mv l"><div class="mw l mx my mz mv na lp mm"/></div></div></a></div><p id="8e19" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">亲切的问候。</p></div></div>    
</body>
</html>